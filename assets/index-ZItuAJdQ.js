const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-BI18dRaT.js","assets/webworkerAll-BmilryU9.js","assets/colorToUniform-X4kJgE7L.js","assets/CanvasPool-LCb9WiZX.js","assets/getBatchSamplersUniformGroup-DH--ddzP.js","assets/WebGPURenderer-CzDNaKdr.js","assets/SharedSystems-ChCQnW-_.js","assets/WebGLRenderer-BgztYrGy.js"])))=>i.map(i=>d[i]);
var Y0=Object.defineProperty;var c0=et=>{throw TypeError(et)};var q0=(et,_,_e)=>_ in et?Y0(et,_,{enumerable:!0,configurable:!0,writable:!0,value:_e}):et[_]=_e;var Jn=(et,_,_e)=>q0(et,typeof _!="symbol"?_+"":_,_e),Cp=(et,_,_e)=>_.has(et)||c0("Cannot "+_e);var Hs=(et,_,_e)=>(Cp(et,_,"read from private field"),_e?_e.call(et):_.get(et)),Rp=(et,_,_e)=>_.has(et)?c0("Cannot add the same private member more than once"):_ instanceof WeakSet?_.add(et):_.set(et,_e),Lu=(et,_,_e,tt)=>(Cp(et,_,"write to private field"),tt?tt.call(et,_e):_.set(et,_e),_e),Pp=(et,_,_e)=>(Cp(et,_,"access private method"),_e);(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const nt of document.querySelectorAll('link[rel="modulepreload"]'))tt(nt);new MutationObserver(nt=>{for(const rt of nt)if(rt.type==="childList")for(const it of rt.addedNodes)it.tagName==="LINK"&&it.rel==="modulepreload"&&tt(it)}).observe(document,{childList:!0,subtree:!0});function _e(nt){const rt={};return nt.integrity&&(rt.integrity=nt.integrity),nt.referrerPolicy&&(rt.referrerPolicy=nt.referrerPolicy),nt.crossOrigin==="use-credentials"?rt.credentials="include":nt.crossOrigin==="anonymous"?rt.credentials="omit":rt.credentials="same-origin",rt}function tt(nt){if(nt.ep)return;nt.ep=!0;const rt=_e(nt);fetch(nt.href,rt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(et){return et&&et.__esModule&&Object.prototype.hasOwnProperty.call(et,"default")?et.default:et}function getAugmentedNamespace(et){if(et.__esModule)return et;var _=et.default;if(typeof _=="function"){var _e=function tt(){return this instanceof tt?Reflect.construct(_,arguments,this.constructor):_.apply(this,arguments)};_e.prototype=_.prototype}else _e={};return Object.defineProperty(_e,"__esModule",{value:!0}),Object.keys(et).forEach(function(tt){var nt=Object.getOwnPropertyDescriptor(et,tt);Object.defineProperty(_e,tt,nt.get?nt:{enumerable:!0,get:function(){return et[tt]}})}),_e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(et){return et===null||typeof et!="object"?null:(et=z$1&&et[z$1]||et["@@iterator"],typeof et=="function"?et:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(et,_,_e){this.props=et,this.context=_,this.refs=D$1,this.updater=_e||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(et,_){if(typeof et!="object"&&typeof et!="function"&&et!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,et,_,"setState")};E$1.prototype.forceUpdate=function(et){this.updater.enqueueForceUpdate(this,et,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(et,_,_e){this.props=et,this.context=_,this.refs=D$1,this.updater=_e||B$1}var H$2=G$1.prototype=new F;H$2.constructor=G$1;C$1(H$2,E$1.prototype);H$2.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$2={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$2(et,_,_e){var tt,nt={},rt=null,it=null;if(_!=null)for(tt in _.ref!==void 0&&(it=_.ref),_.key!==void 0&&(rt=""+_.key),_)J.call(_,tt)&&!L$1.hasOwnProperty(tt)&&(nt[tt]=_[tt]);var st=arguments.length-2;if(st===1)nt.children=_e;else if(1<st){for(var ot=Array(st),at=0;at<st;at++)ot[at]=arguments[at+2];nt.children=ot}if(et&&et.defaultProps)for(tt in st=et.defaultProps,st)nt[tt]===void 0&&(nt[tt]=st[tt]);return{$$typeof:l$2,type:et,key:rt,ref:it,props:nt,_owner:K$2.current}}function N$2(et,_){return{$$typeof:l$2,type:et.type,key:_,ref:et.ref,props:et.props,_owner:et._owner}}function O$1(et){return typeof et=="object"&&et!==null&&et.$$typeof===l$2}function escape$1(et){var _={"=":"=0",":":"=2"};return"$"+et.replace(/[=:]/g,function(_e){return _[_e]})}var P$1=/\/+/g;function Q$1(et,_){return typeof et=="object"&&et!==null&&et.key!=null?escape$1(""+et.key):_.toString(36)}function R$1(et,_,_e,tt,nt){var rt=typeof et;(rt==="undefined"||rt==="boolean")&&(et=null);var it=!1;if(et===null)it=!0;else switch(rt){case"string":case"number":it=!0;break;case"object":switch(et.$$typeof){case l$2:case n$2:it=!0}}if(it)return it=et,nt=nt(it),et=tt===""?"."+Q$1(it,0):tt,I$1(nt)?(_e="",et!=null&&(_e=et.replace(P$1,"$&/")+"/"),R$1(nt,_,_e,"",function(at){return at})):nt!=null&&(O$1(nt)&&(nt=N$2(nt,_e+(!nt.key||it&&it.key===nt.key?"":(""+nt.key).replace(P$1,"$&/")+"/")+et)),_.push(nt)),1;if(it=0,tt=tt===""?".":tt+":",I$1(et))for(var st=0;st<et.length;st++){rt=et[st];var ot=tt+Q$1(rt,st);it+=R$1(rt,_,_e,ot,nt)}else if(ot=A$1(et),typeof ot=="function")for(et=ot.call(et),st=0;!(rt=et.next()).done;)rt=rt.value,ot=tt+Q$1(rt,st++),it+=R$1(rt,_,_e,ot,nt);else if(rt==="object")throw _=String(et),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(et).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.");return it}function S$2(et,_,_e){if(et==null)return et;var tt=[],nt=0;return R$1(et,tt,"","",function(rt){return _.call(_e,rt,nt++)}),tt}function T$1(et){if(et._status===-1){var _=et._result;_=_(),_.then(function(_e){(et._status===0||et._status===-1)&&(et._status=1,et._result=_e)},function(_e){(et._status===0||et._status===-1)&&(et._status=2,et._result=_e)}),et._status===-1&&(et._status=0,et._result=_)}if(et._status===1)return et._result.default;throw et._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$2};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(et,_,_e){S$2(et,function(){_.apply(this,arguments)},_e)},count:function(et){var _=0;return S$2(et,function(){_++}),_},toArray:function(et){return S$2(et,function(_){return _})||[]},only:function(et){if(!O$1(et))throw Error("React.Children.only expected to receive a single React element child.");return et}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(et,_,_e){if(et==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+et+".");var tt=C$1({},et.props),nt=et.key,rt=et.ref,it=et._owner;if(_!=null){if(_.ref!==void 0&&(rt=_.ref,it=K$2.current),_.key!==void 0&&(nt=""+_.key),et.type&&et.type.defaultProps)var st=et.type.defaultProps;for(ot in _)J.call(_,ot)&&!L$1.hasOwnProperty(ot)&&(tt[ot]=_[ot]===void 0&&st!==void 0?st[ot]:_[ot])}var ot=arguments.length-2;if(ot===1)tt.children=_e;else if(1<ot){st=Array(ot);for(var at=0;at<ot;at++)st[at]=arguments[at+2];tt.children=st}return{$$typeof:l$2,type:et.type,key:nt,ref:rt,props:tt,_owner:it}};react_production_min.createContext=function(et){return et={$$typeof:u$1,_currentValue:et,_currentValue2:et,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},et.Provider={$$typeof:t$1,_context:et},et.Consumer=et};react_production_min.createElement=M$2;react_production_min.createFactory=function(et){var _=M$2.bind(null,et);return _.type=et,_};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(et){return{$$typeof:v$2,render:et}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(et){return{$$typeof:y$1,_payload:{_status:-1,_result:et},_init:T$1}};react_production_min.memo=function(et,_){return{$$typeof:x$1,type:et,compare:_===void 0?null:_}};react_production_min.startTransition=function(et){var _=V$1.transition;V$1.transition={};try{et()}finally{V$1.transition=_}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(et,_){return U$1.current.useCallback(et,_)};react_production_min.useContext=function(et){return U$1.current.useContext(et)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(et){return U$1.current.useDeferredValue(et)};react_production_min.useEffect=function(et,_){return U$1.current.useEffect(et,_)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(et,_,_e){return U$1.current.useImperativeHandle(et,_,_e)};react_production_min.useInsertionEffect=function(et,_){return U$1.current.useInsertionEffect(et,_)};react_production_min.useLayoutEffect=function(et,_){return U$1.current.useLayoutEffect(et,_)};react_production_min.useMemo=function(et,_){return U$1.current.useMemo(et,_)};react_production_min.useReducer=function(et,_,_e){return U$1.current.useReducer(et,_,_e)};react_production_min.useRef=function(et){return U$1.current.useRef(et)};react_production_min.useState=function(et){return U$1.current.useState(et)};react_production_min.useSyncExternalStore=function(et,_,_e){return U$1.current.useSyncExternalStore(et,_,_e)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q(et,_,_e){var tt,nt={},rt=null,it=null;_e!==void 0&&(rt=""+_e),_.key!==void 0&&(rt=""+_.key),_.ref!==void 0&&(it=_.ref);for(tt in _)m$2.call(_,tt)&&!p$2.hasOwnProperty(tt)&&(nt[tt]=_[tt]);if(et&&et.defaultProps)for(tt in _=et.defaultProps,_)nt[tt]===void 0&&(nt[tt]=_[tt]);return{$$typeof:k$1,type:et,key:rt,ref:it,props:nt,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler$2={exports:{}},scheduler_production_min$2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(et){function _(Lt,Ot){var Nt=Lt.length;Lt.push(Ot);e:for(;0<Nt;){var zt=Nt-1>>>1,Ht=Lt[zt];if(0<nt(Ht,Ot))Lt[zt]=Ot,Lt[Nt]=Ht,Nt=zt;else break e}}function _e(Lt){return Lt.length===0?null:Lt[0]}function tt(Lt){if(Lt.length===0)return null;var Ot=Lt[0],Nt=Lt.pop();if(Nt!==Ot){Lt[0]=Nt;e:for(var zt=0,Ht=Lt.length,qt=Ht>>>1;zt<qt;){var Gt=2*(zt+1)-1,Xt=Lt[Gt],Zt=Gt+1,Qt=Lt[Zt];if(0>nt(Xt,Nt))Zt<Ht&&0>nt(Qt,Xt)?(Lt[zt]=Qt,Lt[Zt]=Nt,zt=Zt):(Lt[zt]=Xt,Lt[Gt]=Nt,zt=Gt);else if(Zt<Ht&&0>nt(Qt,Nt))Lt[zt]=Qt,Lt[Zt]=Nt,zt=Zt;else break e}}return Ot}function nt(Lt,Ot){var Nt=Lt.sortIndex-Ot.sortIndex;return Nt!==0?Nt:Lt.id-Ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var rt=performance;et.unstable_now=function(){return rt.now()}}else{var it=Date,st=it.now();et.unstable_now=function(){return it.now()-st}}var ot=[],at=[],lt=1,ct=null,ht=3,ut=!1,ft=!1,dt=!1,pt=typeof setTimeout=="function"?setTimeout:null,mt=typeof clearTimeout=="function"?clearTimeout:null,vt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(Lt){for(var Ot=_e(at);Ot!==null;){if(Ot.callback===null)tt(at);else if(Ot.startTime<=Lt)tt(at),Ot.sortIndex=Ot.expirationTime,_(ot,Ot);else break;Ot=_e(at)}}function _t(Lt){if(dt=!1,yt(Lt),!ft)if(_e(ot)!==null)ft=!0,$t(St);else{var Ot=_e(at);Ot!==null&&Yt(_t,Ot.startTime-Lt)}}function St(Lt,Ot){ft=!1,dt&&(dt=!1,mt(Mt),Mt=-1),ut=!0;var Nt=ht;try{for(yt(Ot),ct=_e(ot);ct!==null&&(!(ct.expirationTime>Ot)||Lt&&!Ct());){var zt=ct.callback;if(typeof zt=="function"){ct.callback=null,ht=ct.priorityLevel;var Ht=zt(ct.expirationTime<=Ot);Ot=et.unstable_now(),typeof Ht=="function"?ct.callback=Ht:ct===_e(ot)&&tt(ot),yt(Ot)}else tt(ot);ct=_e(ot)}if(ct!==null)var qt=!0;else{var Gt=_e(at);Gt!==null&&Yt(_t,Gt.startTime-Ot),qt=!1}return qt}finally{ct=null,ht=Nt,ut=!1}}var bt=!1,Et=null,Mt=-1,Tt=5,wt=-1;function Ct(){return!(et.unstable_now()-wt<Tt)}function Rt(){if(Et!==null){var Lt=et.unstable_now();wt=Lt;var Ot=!0;try{Ot=Et(!0,Lt)}finally{Ot?It():(bt=!1,Et=null)}}else bt=!1}var It;if(typeof vt=="function")It=function(){vt(Rt)};else if(typeof MessageChannel<"u"){var Dt=new MessageChannel,Ft=Dt.port2;Dt.port1.onmessage=Rt,It=function(){Ft.postMessage(null)}}else It=function(){pt(Rt,0)};function $t(Lt){Et=Lt,bt||(bt=!0,It())}function Yt(Lt,Ot){Mt=pt(function(){Lt(et.unstable_now())},Ot)}et.unstable_IdlePriority=5,et.unstable_ImmediatePriority=1,et.unstable_LowPriority=4,et.unstable_NormalPriority=3,et.unstable_Profiling=null,et.unstable_UserBlockingPriority=2,et.unstable_cancelCallback=function(Lt){Lt.callback=null},et.unstable_continueExecution=function(){ft||ut||(ft=!0,$t(St))},et.unstable_forceFrameRate=function(Lt){0>Lt||125<Lt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Tt=0<Lt?Math.floor(1e3/Lt):5},et.unstable_getCurrentPriorityLevel=function(){return ht},et.unstable_getFirstCallbackNode=function(){return _e(ot)},et.unstable_next=function(Lt){switch(ht){case 1:case 2:case 3:var Ot=3;break;default:Ot=ht}var Nt=ht;ht=Ot;try{return Lt()}finally{ht=Nt}},et.unstable_pauseExecution=function(){},et.unstable_requestPaint=function(){},et.unstable_runWithPriority=function(Lt,Ot){switch(Lt){case 1:case 2:case 3:case 4:case 5:break;default:Lt=3}var Nt=ht;ht=Lt;try{return Ot()}finally{ht=Nt}},et.unstable_scheduleCallback=function(Lt,Ot,Nt){var zt=et.unstable_now();switch(typeof Nt=="object"&&Nt!==null?(Nt=Nt.delay,Nt=typeof Nt=="number"&&0<Nt?zt+Nt:zt):Nt=zt,Lt){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=Nt+Ht,Lt={id:lt++,callback:Ot,priorityLevel:Lt,startTime:Nt,expirationTime:Ht,sortIndex:-1},Nt>zt?(Lt.sortIndex=Nt,_(at,Lt),_e(ot)===null&&Lt===_e(at)&&(dt?(mt(Mt),Mt=-1):dt=!0,Yt(_t,Nt-zt))):(Lt.sortIndex=Ht,_(ot,Lt),ft||ut||(ft=!0,$t(St))),Lt},et.unstable_shouldYield=Ct,et.unstable_wrapCallback=function(Lt){var Ot=ht;return function(){var Nt=ht;ht=Ot;try{return Lt.apply(this,arguments)}finally{ht=Nt}}}})(scheduler_production_min$2);scheduler$2.exports=scheduler_production_min$2;var schedulerExports$1=scheduler$2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports$1;function p$1(et){for(var _="https://reactjs.org/docs/error-decoder.html?invariant="+et,_e=1;_e<arguments.length;_e++)_+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified React error #"+et+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(et,_){ha(et,_),ha(et+"Capture",_)}function ha(et,_){for(ea[et]=_,et=0;et<_.length;et++)da.add(_[et])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(et){return ja.call(ma,et)?!0:ja.call(la,et)?!1:ka.test(et)?ma[et]=!0:(la[et]=!0,!1)}function pa(et,_,_e,tt){if(_e!==null&&_e.type===0)return!1;switch(typeof _){case"function":case"symbol":return!0;case"boolean":return tt?!1:_e!==null?!_e.acceptsBooleans:(et=et.toLowerCase().slice(0,5),et!=="data-"&&et!=="aria-");default:return!1}}function qa(et,_,_e,tt){if(_===null||typeof _>"u"||pa(et,_,_e,tt))return!0;if(tt)return!1;if(_e!==null)switch(_e.type){case 3:return!_;case 4:return _===!1;case 5:return isNaN(_);case 6:return isNaN(_)||1>_}return!1}function v$1(et,_,_e,tt,nt,rt,it){this.acceptsBooleans=_===2||_===3||_===4,this.attributeName=tt,this.attributeNamespace=nt,this.mustUseProperty=_e,this.propertyName=et,this.type=_,this.sanitizeURL=rt,this.removeEmptyString=it}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(et){z[et]=new v$1(et,0,!1,et,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(et){var _=et[0];z[_]=new v$1(_,1,!1,et[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(et){z[et]=new v$1(et,2,!1,et.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(et){z[et]=new v$1(et,2,!1,et,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(et){z[et]=new v$1(et,3,!1,et.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(et){z[et]=new v$1(et,3,!0,et,null,!1,!1)});["capture","download"].forEach(function(et){z[et]=new v$1(et,4,!1,et,null,!1,!1)});["cols","rows","size","span"].forEach(function(et){z[et]=new v$1(et,6,!1,et,null,!1,!1)});["rowSpan","start"].forEach(function(et){z[et]=new v$1(et,5,!1,et.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(et){return et[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(et){var _=et.replace(ra,sa);z[_]=new v$1(_,1,!1,et,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(et){var _=et.replace(ra,sa);z[_]=new v$1(_,1,!1,et,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(et){var _=et.replace(ra,sa);z[_]=new v$1(_,1,!1,et,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(et){z[et]=new v$1(et,1,!1,et.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(et){z[et]=new v$1(et,1,!1,et.toLowerCase(),null,!0,!0)});function ta(et,_,_e,tt){var nt=z.hasOwnProperty(_)?z[_]:null;(nt!==null?nt.type!==0:tt||!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(qa(_,_e,nt,tt)&&(_e=null),tt||nt===null?oa(_)&&(_e===null?et.removeAttribute(_):et.setAttribute(_,""+_e)):nt.mustUseProperty?et[nt.propertyName]=_e===null?nt.type===3?!1:"":_e:(_=nt.attributeName,tt=nt.attributeNamespace,_e===null?et.removeAttribute(_):(nt=nt.type,_e=nt===3||nt===4&&_e===!0?"":""+_e,tt?et.setAttributeNS(tt,_,_e):et.setAttribute(_,_e))))}var ua$1=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(et){return et===null||typeof et!="object"?null:(et=Ja&&et[Ja]||et["@@iterator"],typeof et=="function"?et:null)}var A=Object.assign,La;function Ma(et){if(La===void 0)try{throw Error()}catch(_e){var _=_e.stack.trim().match(/\n( *(at )?)/);La=_&&_[1]||""}return`
`+La+et}var Na=!1;function Oa(et,_){if(!et||Na)return"";Na=!0;var _e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_)if(_=function(){throw Error()},Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(at){var tt=at}Reflect.construct(et,[],_)}else{try{_.call()}catch(at){tt=at}et.call(_.prototype)}else{try{throw Error()}catch(at){tt=at}et()}}catch(at){if(at&&tt&&typeof at.stack=="string"){for(var nt=at.stack.split(`
`),rt=tt.stack.split(`
`),it=nt.length-1,st=rt.length-1;1<=it&&0<=st&&nt[it]!==rt[st];)st--;for(;1<=it&&0<=st;it--,st--)if(nt[it]!==rt[st]){if(it!==1||st!==1)do if(it--,st--,0>st||nt[it]!==rt[st]){var ot=`
`+nt[it].replace(" at new "," at ");return et.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",et.displayName)),ot}while(1<=it&&0<=st);break}}}finally{Na=!1,Error.prepareStackTrace=_e}return(et=et?et.displayName||et.name:"")?Ma(et):""}function Pa(et){switch(et.tag){case 5:return Ma(et.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return et=Oa(et.type,!1),et;case 11:return et=Oa(et.type.render,!1),et;case 1:return et=Oa(et.type,!0),et;default:return""}}function Qa(et){if(et==null)return null;if(typeof et=="function")return et.displayName||et.name||null;if(typeof et=="string")return et;switch(et){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof et=="object")switch(et.$$typeof){case Ca:return(et.displayName||"Context")+".Consumer";case Ba:return(et._context.displayName||"Context")+".Provider";case Da:var _=et.render;return et=et.displayName,et||(et=_.displayName||_.name||"",et=et!==""?"ForwardRef("+et+")":"ForwardRef"),et;case Ga:return _=et.displayName||null,_!==null?_:Qa(et.type)||"Memo";case Ha:_=et._payload,et=et._init;try{return Qa(et(_))}catch{}}return null}function Ra(et){var _=et.type;switch(et.tag){case 24:return"Cache";case 9:return(_.displayName||"Context")+".Consumer";case 10:return(_._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return et=_.render,et=et.displayName||et.name||"",_.displayName||(et!==""?"ForwardRef("+et+")":"ForwardRef");case 7:return"Fragment";case 5:return _;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(_);case 8:return _===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _}return null}function Sa(et){switch(typeof et){case"boolean":case"number":case"string":case"undefined":return et;case"object":return et;default:return""}}function Ta(et){var _=et.type;return(et=et.nodeName)&&et.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function Ua(et){var _=Ta(et)?"checked":"value",_e=Object.getOwnPropertyDescriptor(et.constructor.prototype,_),tt=""+et[_];if(!et.hasOwnProperty(_)&&typeof _e<"u"&&typeof _e.get=="function"&&typeof _e.set=="function"){var nt=_e.get,rt=_e.set;return Object.defineProperty(et,_,{configurable:!0,get:function(){return nt.call(this)},set:function(it){tt=""+it,rt.call(this,it)}}),Object.defineProperty(et,_,{enumerable:_e.enumerable}),{getValue:function(){return tt},setValue:function(it){tt=""+it},stopTracking:function(){et._valueTracker=null,delete et[_]}}}}function Va(et){et._valueTracker||(et._valueTracker=Ua(et))}function Wa(et){if(!et)return!1;var _=et._valueTracker;if(!_)return!0;var _e=_.getValue(),tt="";return et&&(tt=Ta(et)?et.checked?"true":"false":et.value),et=tt,et!==_e?(_.setValue(et),!0):!1}function Xa(et){if(et=et||(typeof document<"u"?document:void 0),typeof et>"u")return null;try{return et.activeElement||et.body}catch{return et.body}}function Ya(et,_){var _e=_.checked;return A({},_,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_e??et._wrapperState.initialChecked})}function Za(et,_){var _e=_.defaultValue==null?"":_.defaultValue,tt=_.checked!=null?_.checked:_.defaultChecked;_e=Sa(_.value!=null?_.value:_e),et._wrapperState={initialChecked:tt,initialValue:_e,controlled:_.type==="checkbox"||_.type==="radio"?_.checked!=null:_.value!=null}}function ab(et,_){_=_.checked,_!=null&&ta(et,"checked",_,!1)}function bb(et,_){ab(et,_);var _e=Sa(_.value),tt=_.type;if(_e!=null)tt==="number"?(_e===0&&et.value===""||et.value!=_e)&&(et.value=""+_e):et.value!==""+_e&&(et.value=""+_e);else if(tt==="submit"||tt==="reset"){et.removeAttribute("value");return}_.hasOwnProperty("value")?cb(et,_.type,_e):_.hasOwnProperty("defaultValue")&&cb(et,_.type,Sa(_.defaultValue)),_.checked==null&&_.defaultChecked!=null&&(et.defaultChecked=!!_.defaultChecked)}function db(et,_,_e){if(_.hasOwnProperty("value")||_.hasOwnProperty("defaultValue")){var tt=_.type;if(!(tt!=="submit"&&tt!=="reset"||_.value!==void 0&&_.value!==null))return;_=""+et._wrapperState.initialValue,_e||_===et.value||(et.value=_),et.defaultValue=_}_e=et.name,_e!==""&&(et.name=""),et.defaultChecked=!!et._wrapperState.initialChecked,_e!==""&&(et.name=_e)}function cb(et,_,_e){(_!=="number"||Xa(et.ownerDocument)!==et)&&(_e==null?et.defaultValue=""+et._wrapperState.initialValue:et.defaultValue!==""+_e&&(et.defaultValue=""+_e))}var eb=Array.isArray;function fb(et,_,_e,tt){if(et=et.options,_){_={};for(var nt=0;nt<_e.length;nt++)_["$"+_e[nt]]=!0;for(_e=0;_e<et.length;_e++)nt=_.hasOwnProperty("$"+et[_e].value),et[_e].selected!==nt&&(et[_e].selected=nt),nt&&tt&&(et[_e].defaultSelected=!0)}else{for(_e=""+Sa(_e),_=null,nt=0;nt<et.length;nt++){if(et[nt].value===_e){et[nt].selected=!0,tt&&(et[nt].defaultSelected=!0);return}_!==null||et[nt].disabled||(_=et[nt])}_!==null&&(_.selected=!0)}}function gb(et,_){if(_.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A({},_,{value:void 0,defaultValue:void 0,children:""+et._wrapperState.initialValue})}function hb(et,_){var _e=_.value;if(_e==null){if(_e=_.children,_=_.defaultValue,_e!=null){if(_!=null)throw Error(p$1(92));if(eb(_e)){if(1<_e.length)throw Error(p$1(93));_e=_e[0]}_=_e}_==null&&(_=""),_e=_}et._wrapperState={initialValue:Sa(_e)}}function ib(et,_){var _e=Sa(_.value),tt=Sa(_.defaultValue);_e!=null&&(_e=""+_e,_e!==et.value&&(et.value=_e),_.defaultValue==null&&et.defaultValue!==_e&&(et.defaultValue=_e)),tt!=null&&(et.defaultValue=""+tt)}function jb(et){var _=et.textContent;_===et._wrapperState.initialValue&&_!==""&&_!==null&&(et.value=_)}function kb(et){switch(et){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(et,_){return et==null||et==="http://www.w3.org/1999/xhtml"?kb(_):et==="http://www.w3.org/2000/svg"&&_==="foreignObject"?"http://www.w3.org/1999/xhtml":et}var mb,nb=function(et){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_,_e,tt,nt){MSApp.execUnsafeLocalFunction(function(){return et(_,_e,tt,nt)})}:et}(function(et,_){if(et.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in et)et.innerHTML=_;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+_.valueOf().toString()+"</svg>",_=mb.firstChild;et.firstChild;)et.removeChild(et.firstChild);for(;_.firstChild;)et.appendChild(_.firstChild)}});function ob(et,_){if(_){var _e=et.firstChild;if(_e&&_e===et.lastChild&&_e.nodeType===3){_e.nodeValue=_;return}}et.textContent=_}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(et){qb.forEach(function(_){_=_+et.charAt(0).toUpperCase()+et.substring(1),pb[_]=pb[et]})});function rb(et,_,_e){return _==null||typeof _=="boolean"||_===""?"":_e||typeof _!="number"||_===0||pb.hasOwnProperty(et)&&pb[et]?(""+_).trim():_+"px"}function sb(et,_){et=et.style;for(var _e in _)if(_.hasOwnProperty(_e)){var tt=_e.indexOf("--")===0,nt=rb(_e,_[_e],tt);_e==="float"&&(_e="cssFloat"),tt?et.setProperty(_e,nt):et[_e]=nt}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(et,_){if(_){if(tb[et]&&(_.children!=null||_.dangerouslySetInnerHTML!=null))throw Error(p$1(137,et));if(_.dangerouslySetInnerHTML!=null){if(_.children!=null)throw Error(p$1(60));if(typeof _.dangerouslySetInnerHTML!="object"||!("__html"in _.dangerouslySetInnerHTML))throw Error(p$1(61))}if(_.style!=null&&typeof _.style!="object")throw Error(p$1(62))}}function vb(et,_){if(et.indexOf("-")===-1)return typeof _.is=="string";switch(et){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(et){return et=et.target||et.srcElement||window,et.correspondingUseElement&&(et=et.correspondingUseElement),et.nodeType===3?et.parentNode:et}var yb=null,zb=null,Ab=null;function Bb(et){if(et=Cb(et)){if(typeof yb!="function")throw Error(p$1(280));var _=et.stateNode;_&&(_=Db(_),yb(et.stateNode,et.type,_))}}function Eb(et){zb?Ab?Ab.push(et):Ab=[et]:zb=et}function Fb(){if(zb){var et=zb,_=Ab;if(Ab=zb=null,Bb(et),_)for(et=0;et<_.length;et++)Bb(_[et])}}function Gb(et,_){return et(_)}function Hb(){}var Ib=!1;function Jb(et,_,_e){if(Ib)return et(_,_e);Ib=!0;try{return Gb(et,_,_e)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(et,_){var _e=et.stateNode;if(_e===null)return null;var tt=Db(_e);if(tt===null)return null;_e=tt[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(tt=!tt.disabled)||(et=et.type,tt=!(et==="button"||et==="input"||et==="select"||et==="textarea")),et=!tt;break e;default:et=!1}if(et)return null;if(_e&&typeof _e!="function")throw Error(p$1(231,_,typeof _e));return _e}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(et,_,_e,tt,nt,rt,it,st,ot){var at=Array.prototype.slice.call(arguments,3);try{_.apply(_e,at)}catch(lt){this.onError(lt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(et){Ob=!0,Pb=et}};function Tb(et,_,_e,tt,nt,rt,it,st,ot){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(et,_,_e,tt,nt,rt,it,st,ot){if(Tb.apply(this,arguments),Ob){if(Ob){var at=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=at)}}function Vb(et){var _=et,_e=et;if(et.alternate)for(;_.return;)_=_.return;else{et=_;do _=et,_.flags&4098&&(_e=_.return),et=_.return;while(et)}return _.tag===3?_e:null}function Wb(et){if(et.tag===13){var _=et.memoizedState;if(_===null&&(et=et.alternate,et!==null&&(_=et.memoizedState)),_!==null)return _.dehydrated}return null}function Xb(et){if(Vb(et)!==et)throw Error(p$1(188))}function Yb(et){var _=et.alternate;if(!_){if(_=Vb(et),_===null)throw Error(p$1(188));return _!==et?null:et}for(var _e=et,tt=_;;){var nt=_e.return;if(nt===null)break;var rt=nt.alternate;if(rt===null){if(tt=nt.return,tt!==null){_e=tt;continue}break}if(nt.child===rt.child){for(rt=nt.child;rt;){if(rt===_e)return Xb(nt),et;if(rt===tt)return Xb(nt),_;rt=rt.sibling}throw Error(p$1(188))}if(_e.return!==tt.return)_e=nt,tt=rt;else{for(var it=!1,st=nt.child;st;){if(st===_e){it=!0,_e=nt,tt=rt;break}if(st===tt){it=!0,tt=nt,_e=rt;break}st=st.sibling}if(!it){for(st=rt.child;st;){if(st===_e){it=!0,_e=rt,tt=nt;break}if(st===tt){it=!0,tt=rt,_e=nt;break}st=st.sibling}if(!it)throw Error(p$1(189))}}if(_e.alternate!==tt)throw Error(p$1(190))}if(_e.tag!==3)throw Error(p$1(188));return _e.stateNode.current===_e?et:_}function Zb(et){return et=Yb(et),et!==null?$b(et):null}function $b(et){if(et.tag===5||et.tag===6)return et;for(et=et.child;et!==null;){var _=$b(et);if(_!==null)return _;et=et.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(et){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,et,void 0,(et.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(et){return et>>>=0,et===0?32:31-(pc(et)/qc|0)|0}var rc=64,sc=4194304;function tc(et){switch(et&-et){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return et&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return et&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return et}}function uc(et,_){var _e=et.pendingLanes;if(_e===0)return 0;var tt=0,nt=et.suspendedLanes,rt=et.pingedLanes,it=_e&268435455;if(it!==0){var st=it&~nt;st!==0?tt=tc(st):(rt&=it,rt!==0&&(tt=tc(rt)))}else it=_e&~nt,it!==0?tt=tc(it):rt!==0&&(tt=tc(rt));if(tt===0)return 0;if(_!==0&&_!==tt&&!(_&nt)&&(nt=tt&-tt,rt=_&-_,nt>=rt||nt===16&&(rt&4194240)!==0))return _;if(tt&4&&(tt|=_e&16),_=et.entangledLanes,_!==0)for(et=et.entanglements,_&=tt;0<_;)_e=31-oc(_),nt=1<<_e,tt|=et[_e],_&=~nt;return tt}function vc(et,_){switch(et){case 1:case 2:case 4:return _+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(et,_){for(var _e=et.suspendedLanes,tt=et.pingedLanes,nt=et.expirationTimes,rt=et.pendingLanes;0<rt;){var it=31-oc(rt),st=1<<it,ot=nt[it];ot===-1?(!(st&_e)||st&tt)&&(nt[it]=vc(st,_)):ot<=_&&(et.expiredLanes|=st),rt&=~st}}function xc(et){return et=et.pendingLanes&-1073741825,et!==0?et:et&1073741824?1073741824:0}function yc(){var et=rc;return rc<<=1,!(rc&4194240)&&(rc=64),et}function zc(et){for(var _=[],_e=0;31>_e;_e++)_.push(et);return _}function Ac(et,_,_e){et.pendingLanes|=_,_!==536870912&&(et.suspendedLanes=0,et.pingedLanes=0),et=et.eventTimes,_=31-oc(_),et[_]=_e}function Bc(et,_){var _e=et.pendingLanes&~_;et.pendingLanes=_,et.suspendedLanes=0,et.pingedLanes=0,et.expiredLanes&=_,et.mutableReadLanes&=_,et.entangledLanes&=_,_=et.entanglements;var tt=et.eventTimes;for(et=et.expirationTimes;0<_e;){var nt=31-oc(_e),rt=1<<nt;_[nt]=0,tt[nt]=-1,et[nt]=-1,_e&=~rt}}function Cc(et,_){var _e=et.entangledLanes|=_;for(et=et.entanglements;_e;){var tt=31-oc(_e),nt=1<<tt;nt&_|et[tt]&_&&(et[tt]|=_),_e&=~nt}}var C=0;function Dc(et){return et&=-et,1<et?4<et?et&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(et,_){switch(et){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(_.pointerId)}}function Tc(et,_,_e,tt,nt,rt){return et===null||et.nativeEvent!==rt?(et={blockedOn:_,domEventName:_e,eventSystemFlags:tt,nativeEvent:rt,targetContainers:[nt]},_!==null&&(_=Cb(_),_!==null&&Fc(_)),et):(et.eventSystemFlags|=tt,_=et.targetContainers,nt!==null&&_.indexOf(nt)===-1&&_.push(nt),et)}function Uc(et,_,_e,tt,nt){switch(_){case"focusin":return Lc=Tc(Lc,et,_,_e,tt,nt),!0;case"dragenter":return Mc=Tc(Mc,et,_,_e,tt,nt),!0;case"mouseover":return Nc=Tc(Nc,et,_,_e,tt,nt),!0;case"pointerover":var rt=nt.pointerId;return Oc.set(rt,Tc(Oc.get(rt)||null,et,_,_e,tt,nt)),!0;case"gotpointercapture":return rt=nt.pointerId,Pc.set(rt,Tc(Pc.get(rt)||null,et,_,_e,tt,nt)),!0}return!1}function Vc(et){var _=Wc(et.target);if(_!==null){var _e=Vb(_);if(_e!==null){if(_=_e.tag,_===13){if(_=Wb(_e),_!==null){et.blockedOn=_,Ic(et.priority,function(){Gc(_e)});return}}else if(_===3&&_e.stateNode.current.memoizedState.isDehydrated){et.blockedOn=_e.tag===3?_e.stateNode.containerInfo:null;return}}}et.blockedOn=null}function Xc(et){if(et.blockedOn!==null)return!1;for(var _=et.targetContainers;0<_.length;){var _e=Yc(et.domEventName,et.eventSystemFlags,_[0],et.nativeEvent);if(_e===null){_e=et.nativeEvent;var tt=new _e.constructor(_e.type,_e);wb=tt,_e.target.dispatchEvent(tt),wb=null}else return _=Cb(_e),_!==null&&Fc(_),et.blockedOn=_e,!1;_.shift()}return!0}function Zc(et,_,_e){Xc(et)&&_e.delete(_)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(et,_){et.blockedOn===_&&(et.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(et){function _(nt){return ad(nt,et)}if(0<Kc.length){ad(Kc[0],et);for(var _e=1;_e<Kc.length;_e++){var tt=Kc[_e];tt.blockedOn===et&&(tt.blockedOn=null)}}for(Lc!==null&&ad(Lc,et),Mc!==null&&ad(Mc,et),Nc!==null&&ad(Nc,et),Oc.forEach(_),Pc.forEach(_),_e=0;_e<Qc.length;_e++)tt=Qc[_e],tt.blockedOn===et&&(tt.blockedOn=null);for(;0<Qc.length&&(_e=Qc[0],_e.blockedOn===null);)Vc(_e),_e.blockedOn===null&&Qc.shift()}var cd=ua$1.ReactCurrentBatchConfig,dd=!0;function ed(et,_,_e,tt){var nt=C,rt=cd.transition;cd.transition=null;try{C=1,fd(et,_,_e,tt)}finally{C=nt,cd.transition=rt}}function gd(et,_,_e,tt){var nt=C,rt=cd.transition;cd.transition=null;try{C=4,fd(et,_,_e,tt)}finally{C=nt,cd.transition=rt}}function fd(et,_,_e,tt){if(dd){var nt=Yc(et,_,_e,tt);if(nt===null)hd(et,_,tt,id,_e),Sc(et,tt);else if(Uc(nt,et,_,_e,tt))tt.stopPropagation();else if(Sc(et,tt),_&4&&-1<Rc.indexOf(et)){for(;nt!==null;){var rt=Cb(nt);if(rt!==null&&Ec(rt),rt=Yc(et,_,_e,tt),rt===null&&hd(et,_,tt,id,_e),rt===nt)break;nt=rt}nt!==null&&tt.stopPropagation()}else hd(et,_,tt,null,_e)}}var id=null;function Yc(et,_,_e,tt){if(id=null,et=xb(tt),et=Wc(et),et!==null)if(_=Vb(et),_===null)et=null;else if(_e=_.tag,_e===13){if(et=Wb(_),et!==null)return et;et=null}else if(_e===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;et=null}else _!==et&&(et=null);return id=et,null}function jd(et){switch(et){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var et,_=ld,_e=_.length,tt,nt="value"in kd?kd.value:kd.textContent,rt=nt.length;for(et=0;et<_e&&_[et]===nt[et];et++);var it=_e-et;for(tt=1;tt<=it&&_[_e-tt]===nt[rt-tt];tt++);return md=nt.slice(et,1<tt?1-tt:void 0)}function od(et){var _=et.keyCode;return"charCode"in et?(et=et.charCode,et===0&&_===13&&(et=13)):et=_,et===10&&(et=13),32<=et||et===13?et:0}function pd(){return!0}function qd(){return!1}function rd(et){function _(_e,tt,nt,rt,it){this._reactName=_e,this._targetInst=nt,this.type=tt,this.nativeEvent=rt,this.target=it,this.currentTarget=null;for(var st in et)et.hasOwnProperty(st)&&(_e=et[st],this[st]=_e?_e(rt):rt[st]);return this.isDefaultPrevented=(rt.defaultPrevented!=null?rt.defaultPrevented:rt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _e=this.nativeEvent;_e&&(_e.preventDefault?_e.preventDefault():typeof _e.returnValue!="unknown"&&(_e.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var _e=this.nativeEvent;_e&&(_e.stopPropagation?_e.stopPropagation():typeof _e.cancelBubble!="unknown"&&(_e.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(et){return et.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(et){return et.relatedTarget===void 0?et.fromElement===et.srcElement?et.toElement:et.fromElement:et.relatedTarget},movementX:function(et){return"movementX"in et?et.movementX:(et!==yd&&(yd&&et.type==="mousemove"?(wd=et.screenX-yd.screenX,xd=et.screenY-yd.screenY):xd=wd=0,yd=et),wd)},movementY:function(et){return"movementY"in et?et.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(et){return"clipboardData"in et?et.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(et){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(et):(et=Od[et])?!!_[et]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(et){if(et.key){var _=Md[et.key]||et.key;if(_!=="Unidentified")return _}return et.type==="keypress"?(et=od(et),et===13?"Enter":String.fromCharCode(et)):et.type==="keydown"||et.type==="keyup"?Nd[et.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(et){return et.type==="keypress"?od(et):0},keyCode:function(et){return et.type==="keydown"||et.type==="keyup"?et.keyCode:0},which:function(et){return et.type==="keypress"?od(et):et.type==="keydown"||et.type==="keyup"?et.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(et){return"deltaX"in et?et.deltaX:"wheelDeltaX"in et?-et.wheelDeltaX:0},deltaY:function(et){return"deltaY"in et?et.deltaY:"wheelDeltaY"in et?-et.wheelDeltaY:"wheelDelta"in et?-et.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(et,_){switch(et){case"keyup":return $d.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(et){return et=et.detail,typeof et=="object"&&"data"in et?et.data:null}var ie=!1;function je(et,_){switch(et){case"compositionend":return he(_);case"keypress":return _.which!==32?null:(fe=!0,ee);case"textInput":return et=_.data,et===ee&&fe?null:et;default:return null}}function ke(et,_){if(ie)return et==="compositionend"||!ae&&ge(et,_)?(et=nd(),md=ld=kd=null,ie=!1,et):null;switch(et){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return de&&_.locale!=="ko"?null:_.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(et){var _=et&&et.nodeName&&et.nodeName.toLowerCase();return _==="input"?!!le[et.type]:_==="textarea"}function ne(et,_,_e,tt){Eb(tt),_=oe(_,"onChange"),0<_.length&&(_e=new td("onChange","change",null,_e,tt),et.push({event:_e,listeners:_}))}var pe=null,qe=null;function re(et){se(et,0)}function te(et){var _=ue(et);if(Wa(_))return et}function ve(et,_){if(et==="change")return _}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(et){if(et.propertyName==="value"&&te(qe)){var _=[];ne(_,qe,et,xb(et)),Jb(re,_)}}function Ce(et,_,_e){et==="focusin"?(Ae(),pe=_,qe=_e,pe.attachEvent("onpropertychange",Be)):et==="focusout"&&Ae()}function De(et){if(et==="selectionchange"||et==="keyup"||et==="keydown")return te(qe)}function Ee(et,_){if(et==="click")return te(_)}function Fe(et,_){if(et==="input"||et==="change")return te(_)}function Ge(et,_){return et===_&&(et!==0||1/et===1/_)||et!==et&&_!==_}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(et,_){if(He(et,_))return!0;if(typeof et!="object"||et===null||typeof _!="object"||_===null)return!1;var _e=Object.keys(et),tt=Object.keys(_);if(_e.length!==tt.length)return!1;for(tt=0;tt<_e.length;tt++){var nt=_e[tt];if(!ja.call(_,nt)||!He(et[nt],_[nt]))return!1}return!0}function Je(et){for(;et&&et.firstChild;)et=et.firstChild;return et}function Ke(et,_){var _e=Je(et);et=0;for(var tt;_e;){if(_e.nodeType===3){if(tt=et+_e.textContent.length,et<=_&&tt>=_)return{node:_e,offset:_-et};et=tt}e:{for(;_e;){if(_e.nextSibling){_e=_e.nextSibling;break e}_e=_e.parentNode}_e=void 0}_e=Je(_e)}}function Le(et,_){return et&&_?et===_?!0:et&&et.nodeType===3?!1:_&&_.nodeType===3?Le(et,_.parentNode):"contains"in et?et.contains(_):et.compareDocumentPosition?!!(et.compareDocumentPosition(_)&16):!1:!1}function Me(){for(var et=window,_=Xa();_ instanceof et.HTMLIFrameElement;){try{var _e=typeof _.contentWindow.location.href=="string"}catch{_e=!1}if(_e)et=_.contentWindow;else break;_=Xa(et.document)}return _}function Ne(et){var _=et&&et.nodeName&&et.nodeName.toLowerCase();return _&&(_==="input"&&(et.type==="text"||et.type==="search"||et.type==="tel"||et.type==="url"||et.type==="password")||_==="textarea"||et.contentEditable==="true")}function Oe(et){var _=Me(),_e=et.focusedElem,tt=et.selectionRange;if(_!==_e&&_e&&_e.ownerDocument&&Le(_e.ownerDocument.documentElement,_e)){if(tt!==null&&Ne(_e)){if(_=tt.start,et=tt.end,et===void 0&&(et=_),"selectionStart"in _e)_e.selectionStart=_,_e.selectionEnd=Math.min(et,_e.value.length);else if(et=(_=_e.ownerDocument||document)&&_.defaultView||window,et.getSelection){et=et.getSelection();var nt=_e.textContent.length,rt=Math.min(tt.start,nt);tt=tt.end===void 0?rt:Math.min(tt.end,nt),!et.extend&&rt>tt&&(nt=tt,tt=rt,rt=nt),nt=Ke(_e,rt);var it=Ke(_e,tt);nt&&it&&(et.rangeCount!==1||et.anchorNode!==nt.node||et.anchorOffset!==nt.offset||et.focusNode!==it.node||et.focusOffset!==it.offset)&&(_=_.createRange(),_.setStart(nt.node,nt.offset),et.removeAllRanges(),rt>tt?(et.addRange(_),et.extend(it.node,it.offset)):(_.setEnd(it.node,it.offset),et.addRange(_)))}}for(_=[],et=_e;et=et.parentNode;)et.nodeType===1&&_.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof _e.focus=="function"&&_e.focus(),_e=0;_e<_.length;_e++)et=_[_e],et.element.scrollLeft=et.left,et.element.scrollTop=et.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(et,_,_e){var tt=_e.window===_e?_e.document:_e.nodeType===9?_e:_e.ownerDocument;Te||Qe==null||Qe!==Xa(tt)||(tt=Qe,"selectionStart"in tt&&Ne(tt)?tt={start:tt.selectionStart,end:tt.selectionEnd}:(tt=(tt.ownerDocument&&tt.ownerDocument.defaultView||window).getSelection(),tt={anchorNode:tt.anchorNode,anchorOffset:tt.anchorOffset,focusNode:tt.focusNode,focusOffset:tt.focusOffset}),Se&&Ie(Se,tt)||(Se=tt,tt=oe(Re,"onSelect"),0<tt.length&&(_=new td("onSelect","select",null,_,_e),et.push({event:_,listeners:tt}),_.target=Qe)))}function Ve(et,_){var _e={};return _e[et.toLowerCase()]=_.toLowerCase(),_e["Webkit"+et]="webkit"+_,_e["Moz"+et]="moz"+_,_e}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(et){if(Xe[et])return Xe[et];if(!We[et])return et;var _=We[et],_e;for(_e in _)if(_.hasOwnProperty(_e)&&_e in Ye)return Xe[et]=_[_e];return et}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(et,_){df.set(et,_),fa(_,[et])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(et,_,_e){var tt=et.type||"unknown-event";et.currentTarget=_e,Ub(tt,_,void 0,et),et.currentTarget=null}function se(et,_){_=(_&4)!==0;for(var _e=0;_e<et.length;_e++){var tt=et[_e],nt=tt.event;tt=tt.listeners;e:{var rt=void 0;if(_)for(var it=tt.length-1;0<=it;it--){var st=tt[it],ot=st.instance,at=st.currentTarget;if(st=st.listener,ot!==rt&&nt.isPropagationStopped())break e;nf(nt,st,at),rt=ot}else for(it=0;it<tt.length;it++){if(st=tt[it],ot=st.instance,at=st.currentTarget,st=st.listener,ot!==rt&&nt.isPropagationStopped())break e;nf(nt,st,at),rt=ot}}}if(Qb)throw et=Rb,Qb=!1,Rb=null,et}function D(et,_){var _e=_[of];_e===void 0&&(_e=_[of]=new Set);var tt=et+"__bubble";_e.has(tt)||(pf(_,et,2,!1),_e.add(tt))}function qf(et,_,_e){var tt=0;_&&(tt|=4),pf(_e,et,tt,_)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(et){if(!et[rf]){et[rf]=!0,da.forEach(function(_e){_e!=="selectionchange"&&(mf.has(_e)||qf(_e,!1,et),qf(_e,!0,et))});var _=et.nodeType===9?et:et.ownerDocument;_===null||_[rf]||(_[rf]=!0,qf("selectionchange",!1,_))}}function pf(et,_,_e,tt){switch(jd(_)){case 1:var nt=ed;break;case 4:nt=gd;break;default:nt=fd}_e=nt.bind(null,_,_e,et),nt=void 0,!Lb||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(nt=!0),tt?nt!==void 0?et.addEventListener(_,_e,{capture:!0,passive:nt}):et.addEventListener(_,_e,!0):nt!==void 0?et.addEventListener(_,_e,{passive:nt}):et.addEventListener(_,_e,!1)}function hd(et,_,_e,tt,nt){var rt=tt;if(!(_&1)&&!(_&2)&&tt!==null)e:for(;;){if(tt===null)return;var it=tt.tag;if(it===3||it===4){var st=tt.stateNode.containerInfo;if(st===nt||st.nodeType===8&&st.parentNode===nt)break;if(it===4)for(it=tt.return;it!==null;){var ot=it.tag;if((ot===3||ot===4)&&(ot=it.stateNode.containerInfo,ot===nt||ot.nodeType===8&&ot.parentNode===nt))return;it=it.return}for(;st!==null;){if(it=Wc(st),it===null)return;if(ot=it.tag,ot===5||ot===6){tt=rt=it;continue e}st=st.parentNode}}tt=tt.return}Jb(function(){var at=rt,lt=xb(_e),ct=[];e:{var ht=df.get(et);if(ht!==void 0){var ut=td,ft=et;switch(et){case"keypress":if(od(_e)===0)break e;case"keydown":case"keyup":ut=Rd;break;case"focusin":ft="focus",ut=Fd;break;case"focusout":ft="blur",ut=Fd;break;case"beforeblur":case"afterblur":ut=Fd;break;case"click":if(_e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=Vd;break;case $e:case af:case bf:ut=Hd;break;case cf:ut=Xd;break;case"scroll":ut=vd;break;case"wheel":ut=Zd;break;case"copy":case"cut":case"paste":ut=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=Td}var dt=(_&4)!==0,pt=!dt&&et==="scroll",mt=dt?ht!==null?ht+"Capture":null:ht;dt=[];for(var vt=at,yt;vt!==null;){yt=vt;var _t=yt.stateNode;if(yt.tag===5&&_t!==null&&(yt=_t,mt!==null&&(_t=Kb(vt,mt),_t!=null&&dt.push(tf(vt,_t,yt)))),pt)break;vt=vt.return}0<dt.length&&(ht=new ut(ht,ft,null,_e,lt),ct.push({event:ht,listeners:dt}))}}if(!(_&7)){e:{if(ht=et==="mouseover"||et==="pointerover",ut=et==="mouseout"||et==="pointerout",ht&&_e!==wb&&(ft=_e.relatedTarget||_e.fromElement)&&(Wc(ft)||ft[uf]))break e;if((ut||ht)&&(ht=lt.window===lt?lt:(ht=lt.ownerDocument)?ht.defaultView||ht.parentWindow:window,ut?(ft=_e.relatedTarget||_e.toElement,ut=at,ft=ft?Wc(ft):null,ft!==null&&(pt=Vb(ft),ft!==pt||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(ut=null,ft=at),ut!==ft)){if(dt=Bd,_t="onMouseLeave",mt="onMouseEnter",vt="mouse",(et==="pointerout"||et==="pointerover")&&(dt=Td,_t="onPointerLeave",mt="onPointerEnter",vt="pointer"),pt=ut==null?ht:ue(ut),yt=ft==null?ht:ue(ft),ht=new dt(_t,vt+"leave",ut,_e,lt),ht.target=pt,ht.relatedTarget=yt,_t=null,Wc(lt)===at&&(dt=new dt(mt,vt+"enter",ft,_e,lt),dt.target=yt,dt.relatedTarget=pt,_t=dt),pt=_t,ut&&ft)t:{for(dt=ut,mt=ft,vt=0,yt=dt;yt;yt=vf(yt))vt++;for(yt=0,_t=mt;_t;_t=vf(_t))yt++;for(;0<vt-yt;)dt=vf(dt),vt--;for(;0<yt-vt;)mt=vf(mt),yt--;for(;vt--;){if(dt===mt||mt!==null&&dt===mt.alternate)break t;dt=vf(dt),mt=vf(mt)}dt=null}else dt=null;ut!==null&&wf(ct,ht,ut,dt,!1),ft!==null&&pt!==null&&wf(ct,pt,ft,dt,!0)}}e:{if(ht=at?ue(at):window,ut=ht.nodeName&&ht.nodeName.toLowerCase(),ut==="select"||ut==="input"&&ht.type==="file")var St=ve;else if(me(ht))if(we)St=Fe;else{St=De;var bt=Ce}else(ut=ht.nodeName)&&ut.toLowerCase()==="input"&&(ht.type==="checkbox"||ht.type==="radio")&&(St=Ee);if(St&&(St=St(et,at))){ne(ct,St,_e,lt);break e}bt&&bt(et,ht,at),et==="focusout"&&(bt=ht._wrapperState)&&bt.controlled&&ht.type==="number"&&cb(ht,"number",ht.value)}switch(bt=at?ue(at):window,et){case"focusin":(me(bt)||bt.contentEditable==="true")&&(Qe=bt,Re=at,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ct,_e,lt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ct,_e,lt)}var Et;if(ae)e:{switch(et){case"compositionstart":var Mt="onCompositionStart";break e;case"compositionend":Mt="onCompositionEnd";break e;case"compositionupdate":Mt="onCompositionUpdate";break e}Mt=void 0}else ie?ge(et,_e)&&(Mt="onCompositionEnd"):et==="keydown"&&_e.keyCode===229&&(Mt="onCompositionStart");Mt&&(de&&_e.locale!=="ko"&&(ie||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&ie&&(Et=nd()):(kd=lt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),bt=oe(at,Mt),0<bt.length&&(Mt=new Ld(Mt,et,null,_e,lt),ct.push({event:Mt,listeners:bt}),Et?Mt.data=Et:(Et=he(_e),Et!==null&&(Mt.data=Et)))),(Et=ce?je(et,_e):ke(et,_e))&&(at=oe(at,"onBeforeInput"),0<at.length&&(lt=new Ld("onBeforeInput","beforeinput",null,_e,lt),ct.push({event:lt,listeners:at}),lt.data=Et))}se(ct,_)})}function tf(et,_,_e){return{instance:et,listener:_,currentTarget:_e}}function oe(et,_){for(var _e=_+"Capture",tt=[];et!==null;){var nt=et,rt=nt.stateNode;nt.tag===5&&rt!==null&&(nt=rt,rt=Kb(et,_e),rt!=null&&tt.unshift(tf(et,rt,nt)),rt=Kb(et,_),rt!=null&&tt.push(tf(et,rt,nt))),et=et.return}return tt}function vf(et){if(et===null)return null;do et=et.return;while(et&&et.tag!==5);return et||null}function wf(et,_,_e,tt,nt){for(var rt=_._reactName,it=[];_e!==null&&_e!==tt;){var st=_e,ot=st.alternate,at=st.stateNode;if(ot!==null&&ot===tt)break;st.tag===5&&at!==null&&(st=at,nt?(ot=Kb(_e,rt),ot!=null&&it.unshift(tf(_e,ot,st))):nt||(ot=Kb(_e,rt),ot!=null&&it.push(tf(_e,ot,st)))),_e=_e.return}it.length!==0&&et.push({event:_,listeners:it})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(et){return(typeof et=="string"?et:""+et).replace(xf,`
`).replace(yf,"")}function Af(et,_,_e){if(_=zf(_),zf(et)!==_&&_e)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(et,_){return et==="textarea"||et==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(et){return Hf.resolve(null).then(et).catch(If)}:Ff;function If(et){setTimeout(function(){throw et})}function Kf(et,_){var _e=_,tt=0;do{var nt=_e.nextSibling;if(et.removeChild(_e),nt&&nt.nodeType===8)if(_e=nt.data,_e==="/$"){if(tt===0){et.removeChild(nt),bd(_);return}tt--}else _e!=="$"&&_e!=="$?"&&_e!=="$!"||tt++;_e=nt}while(_e);bd(_)}function Lf(et){for(;et!=null;et=et.nextSibling){var _=et.nodeType;if(_===1||_===3)break;if(_===8){if(_=et.data,_==="$"||_==="$!"||_==="$?")break;if(_==="/$")return null}}return et}function Mf(et){et=et.previousSibling;for(var _=0;et;){if(et.nodeType===8){var _e=et.data;if(_e==="$"||_e==="$!"||_e==="$?"){if(_===0)return et;_--}else _e==="/$"&&_++}et=et.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(et){var _=et[Of];if(_)return _;for(var _e=et.parentNode;_e;){if(_=_e[uf]||_e[Of]){if(_e=_.alternate,_.child!==null||_e!==null&&_e.child!==null)for(et=Mf(et);et!==null;){if(_e=et[Of])return _e;et=Mf(et)}return _}et=_e,_e=et.parentNode}return null}function Cb(et){return et=et[Of]||et[uf],!et||et.tag!==5&&et.tag!==6&&et.tag!==13&&et.tag!==3?null:et}function ue(et){if(et.tag===5||et.tag===6)return et.stateNode;throw Error(p$1(33))}function Db(et){return et[Pf]||null}var Sf=[],Tf=-1;function Uf(et){return{current:et}}function E(et){0>Tf||(et.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(et,_){Tf++,Sf[Tf]=et.current,et.current=_}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(et,_){var _e=et.type.contextTypes;if(!_e)return Vf;var tt=et.stateNode;if(tt&&tt.__reactInternalMemoizedUnmaskedChildContext===_)return tt.__reactInternalMemoizedMaskedChildContext;var nt={},rt;for(rt in _e)nt[rt]=_[rt];return tt&&(et=et.stateNode,et.__reactInternalMemoizedUnmaskedChildContext=_,et.__reactInternalMemoizedMaskedChildContext=nt),nt}function Zf(et){return et=et.childContextTypes,et!=null}function $f(){E(Wf),E(H$1)}function ag(et,_,_e){if(H$1.current!==Vf)throw Error(p$1(168));G(H$1,_),G(Wf,_e)}function bg(et,_,_e){var tt=et.stateNode;if(_=_.childContextTypes,typeof tt.getChildContext!="function")return _e;tt=tt.getChildContext();for(var nt in tt)if(!(nt in _))throw Error(p$1(108,Ra(et)||"Unknown",nt));return A({},_e,tt)}function cg(et){return et=(et=et.stateNode)&&et.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G(H$1,et),G(Wf,Wf.current),!0}function dg(et,_,_e){var tt=et.stateNode;if(!tt)throw Error(p$1(169));_e?(et=bg(et,_,Xf),tt.__reactInternalMemoizedMergedChildContext=et,E(Wf),E(H$1),G(H$1,et)):E(Wf),G(Wf,_e)}var eg=null,fg=!1,gg=!1;function hg(et){eg===null?eg=[et]:eg.push(et)}function ig(et){fg=!0,hg(et)}function jg(){if(!gg&&eg!==null){gg=!0;var et=0,_=C;try{var _e=eg;for(C=1;et<_e.length;et++){var tt=_e[et];do tt=tt(!0);while(tt!==null)}eg=null,fg=!1}catch(nt){throw eg!==null&&(eg=eg.slice(et+1)),ac(fc,jg),nt}finally{C=_,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(et,_){kg[lg++]=ng,kg[lg++]=mg,mg=et,ng=_}function ug(et,_,_e){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=et;var tt=rg;et=sg;var nt=32-oc(tt)-1;tt&=~(1<<nt),_e+=1;var rt=32-oc(_)+nt;if(30<rt){var it=nt-nt%5;rt=(tt&(1<<it)-1).toString(32),tt>>=it,nt-=it,rg=1<<32-oc(_)+nt|_e<<nt|tt,sg=rt+et}else rg=1<<rt|_e<<nt|tt,sg=et}function vg(et){et.return!==null&&(tg(et,1),ug(et,1,0))}function wg(et){for(;et===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;et===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(et,_){var _e=Bg(5,null,null,0);_e.elementType="DELETED",_e.stateNode=_,_e.return=et,_=et.deletions,_===null?(et.deletions=[_e],et.flags|=16):_.push(_e)}function Cg(et,_){switch(et.tag){case 5:var _e=et.type;return _=_.nodeType!==1||_e.toLowerCase()!==_.nodeName.toLowerCase()?null:_,_!==null?(et.stateNode=_,xg=et,yg=Lf(_.firstChild),!0):!1;case 6:return _=et.pendingProps===""||_.nodeType!==3?null:_,_!==null?(et.stateNode=_,xg=et,yg=null,!0):!1;case 13:return _=_.nodeType!==8?null:_,_!==null?(_e=qg!==null?{id:rg,overflow:sg}:null,et.memoizedState={dehydrated:_,treeContext:_e,retryLane:1073741824},_e=Bg(18,null,null,0),_e.stateNode=_,_e.return=et,et.child=_e,xg=et,yg=null,!0):!1;default:return!1}}function Dg(et){return(et.mode&1)!==0&&(et.flags&128)===0}function Eg(et){if(I){var _=yg;if(_){var _e=_;if(!Cg(et,_)){if(Dg(et))throw Error(p$1(418));_=Lf(_e.nextSibling);var tt=xg;_&&Cg(et,_)?Ag(tt,_e):(et.flags=et.flags&-4097|2,I=!1,xg=et)}}else{if(Dg(et))throw Error(p$1(418));et.flags=et.flags&-4097|2,I=!1,xg=et}}}function Fg(et){for(et=et.return;et!==null&&et.tag!==5&&et.tag!==3&&et.tag!==13;)et=et.return;xg=et}function Gg(et){if(et!==xg)return!1;if(!I)return Fg(et),I=!0,!1;var _;if((_=et.tag!==3)&&!(_=et.tag!==5)&&(_=et.type,_=_!=="head"&&_!=="body"&&!Ef(et.type,et.memoizedProps)),_&&(_=yg)){if(Dg(et))throw Hg(),Error(p$1(418));for(;_;)Ag(et,_),_=Lf(_.nextSibling)}if(Fg(et),et.tag===13){if(et=et.memoizedState,et=et!==null?et.dehydrated:null,!et)throw Error(p$1(317));e:{for(et=et.nextSibling,_=0;et;){if(et.nodeType===8){var _e=et.data;if(_e==="/$"){if(_===0){yg=Lf(et.nextSibling);break e}_--}else _e!=="$"&&_e!=="$!"&&_e!=="$?"||_++}et=et.nextSibling}yg=null}}else yg=xg?Lf(et.stateNode.nextSibling):null;return!0}function Hg(){for(var et=yg;et;)et=Lf(et.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(et){zg===null?zg=[et]:zg.push(et)}var Kg=ua$1.ReactCurrentBatchConfig;function Lg(et,_,_e){if(et=_e.ref,et!==null&&typeof et!="function"&&typeof et!="object"){if(_e._owner){if(_e=_e._owner,_e){if(_e.tag!==1)throw Error(p$1(309));var tt=_e.stateNode}if(!tt)throw Error(p$1(147,et));var nt=tt,rt=""+et;return _!==null&&_.ref!==null&&typeof _.ref=="function"&&_.ref._stringRef===rt?_.ref:(_=function(it){var st=nt.refs;it===null?delete st[rt]:st[rt]=it},_._stringRef=rt,_)}if(typeof et!="string")throw Error(p$1(284));if(!_e._owner)throw Error(p$1(290,et))}return et}function Mg(et,_){throw et=Object.prototype.toString.call(_),Error(p$1(31,et==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":et))}function Ng(et){var _=et._init;return _(et._payload)}function Og(et){function _(mt,vt){if(et){var yt=mt.deletions;yt===null?(mt.deletions=[vt],mt.flags|=16):yt.push(vt)}}function _e(mt,vt){if(!et)return null;for(;vt!==null;)_(mt,vt),vt=vt.sibling;return null}function tt(mt,vt){for(mt=new Map;vt!==null;)vt.key!==null?mt.set(vt.key,vt):mt.set(vt.index,vt),vt=vt.sibling;return mt}function nt(mt,vt){return mt=Pg(mt,vt),mt.index=0,mt.sibling=null,mt}function rt(mt,vt,yt){return mt.index=yt,et?(yt=mt.alternate,yt!==null?(yt=yt.index,yt<vt?(mt.flags|=2,vt):yt):(mt.flags|=2,vt)):(mt.flags|=1048576,vt)}function it(mt){return et&&mt.alternate===null&&(mt.flags|=2),mt}function st(mt,vt,yt,_t){return vt===null||vt.tag!==6?(vt=Qg(yt,mt.mode,_t),vt.return=mt,vt):(vt=nt(vt,yt),vt.return=mt,vt)}function ot(mt,vt,yt,_t){var St=yt.type;return St===ya?lt(mt,vt,yt.props.children,_t,yt.key):vt!==null&&(vt.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Ha&&Ng(St)===vt.type)?(_t=nt(vt,yt.props),_t.ref=Lg(mt,vt,yt),_t.return=mt,_t):(_t=Rg(yt.type,yt.key,yt.props,null,mt.mode,_t),_t.ref=Lg(mt,vt,yt),_t.return=mt,_t)}function at(mt,vt,yt,_t){return vt===null||vt.tag!==4||vt.stateNode.containerInfo!==yt.containerInfo||vt.stateNode.implementation!==yt.implementation?(vt=Sg(yt,mt.mode,_t),vt.return=mt,vt):(vt=nt(vt,yt.children||[]),vt.return=mt,vt)}function lt(mt,vt,yt,_t,St){return vt===null||vt.tag!==7?(vt=Tg(yt,mt.mode,_t,St),vt.return=mt,vt):(vt=nt(vt,yt),vt.return=mt,vt)}function ct(mt,vt,yt){if(typeof vt=="string"&&vt!==""||typeof vt=="number")return vt=Qg(""+vt,mt.mode,yt),vt.return=mt,vt;if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case va:return yt=Rg(vt.type,vt.key,vt.props,null,mt.mode,yt),yt.ref=Lg(mt,null,vt),yt.return=mt,yt;case wa:return vt=Sg(vt,mt.mode,yt),vt.return=mt,vt;case Ha:var _t=vt._init;return ct(mt,_t(vt._payload),yt)}if(eb(vt)||Ka(vt))return vt=Tg(vt,mt.mode,yt,null),vt.return=mt,vt;Mg(mt,vt)}return null}function ht(mt,vt,yt,_t){var St=vt!==null?vt.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return St!==null?null:st(mt,vt,""+yt,_t);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:return yt.key===St?ot(mt,vt,yt,_t):null;case wa:return yt.key===St?at(mt,vt,yt,_t):null;case Ha:return St=yt._init,ht(mt,vt,St(yt._payload),_t)}if(eb(yt)||Ka(yt))return St!==null?null:lt(mt,vt,yt,_t,null);Mg(mt,yt)}return null}function ut(mt,vt,yt,_t,St){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return mt=mt.get(yt)||null,st(vt,mt,""+_t,St);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case va:return mt=mt.get(_t.key===null?yt:_t.key)||null,ot(vt,mt,_t,St);case wa:return mt=mt.get(_t.key===null?yt:_t.key)||null,at(vt,mt,_t,St);case Ha:var bt=_t._init;return ut(mt,vt,yt,bt(_t._payload),St)}if(eb(_t)||Ka(_t))return mt=mt.get(yt)||null,lt(vt,mt,_t,St,null);Mg(vt,_t)}return null}function ft(mt,vt,yt,_t){for(var St=null,bt=null,Et=vt,Mt=vt=0,Tt=null;Et!==null&&Mt<yt.length;Mt++){Et.index>Mt?(Tt=Et,Et=null):Tt=Et.sibling;var wt=ht(mt,Et,yt[Mt],_t);if(wt===null){Et===null&&(Et=Tt);break}et&&Et&&wt.alternate===null&&_(mt,Et),vt=rt(wt,vt,Mt),bt===null?St=wt:bt.sibling=wt,bt=wt,Et=Tt}if(Mt===yt.length)return _e(mt,Et),I&&tg(mt,Mt),St;if(Et===null){for(;Mt<yt.length;Mt++)Et=ct(mt,yt[Mt],_t),Et!==null&&(vt=rt(Et,vt,Mt),bt===null?St=Et:bt.sibling=Et,bt=Et);return I&&tg(mt,Mt),St}for(Et=tt(mt,Et);Mt<yt.length;Mt++)Tt=ut(Et,mt,Mt,yt[Mt],_t),Tt!==null&&(et&&Tt.alternate!==null&&Et.delete(Tt.key===null?Mt:Tt.key),vt=rt(Tt,vt,Mt),bt===null?St=Tt:bt.sibling=Tt,bt=Tt);return et&&Et.forEach(function(Ct){return _(mt,Ct)}),I&&tg(mt,Mt),St}function dt(mt,vt,yt,_t){var St=Ka(yt);if(typeof St!="function")throw Error(p$1(150));if(yt=St.call(yt),yt==null)throw Error(p$1(151));for(var bt=St=null,Et=vt,Mt=vt=0,Tt=null,wt=yt.next();Et!==null&&!wt.done;Mt++,wt=yt.next()){Et.index>Mt?(Tt=Et,Et=null):Tt=Et.sibling;var Ct=ht(mt,Et,wt.value,_t);if(Ct===null){Et===null&&(Et=Tt);break}et&&Et&&Ct.alternate===null&&_(mt,Et),vt=rt(Ct,vt,Mt),bt===null?St=Ct:bt.sibling=Ct,bt=Ct,Et=Tt}if(wt.done)return _e(mt,Et),I&&tg(mt,Mt),St;if(Et===null){for(;!wt.done;Mt++,wt=yt.next())wt=ct(mt,wt.value,_t),wt!==null&&(vt=rt(wt,vt,Mt),bt===null?St=wt:bt.sibling=wt,bt=wt);return I&&tg(mt,Mt),St}for(Et=tt(mt,Et);!wt.done;Mt++,wt=yt.next())wt=ut(Et,mt,Mt,wt.value,_t),wt!==null&&(et&&wt.alternate!==null&&Et.delete(wt.key===null?Mt:wt.key),vt=rt(wt,vt,Mt),bt===null?St=wt:bt.sibling=wt,bt=wt);return et&&Et.forEach(function(Rt){return _(mt,Rt)}),I&&tg(mt,Mt),St}function pt(mt,vt,yt,_t){if(typeof yt=="object"&&yt!==null&&yt.type===ya&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:e:{for(var St=yt.key,bt=vt;bt!==null;){if(bt.key===St){if(St=yt.type,St===ya){if(bt.tag===7){_e(mt,bt.sibling),vt=nt(bt,yt.props.children),vt.return=mt,mt=vt;break e}}else if(bt.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Ha&&Ng(St)===bt.type){_e(mt,bt.sibling),vt=nt(bt,yt.props),vt.ref=Lg(mt,bt,yt),vt.return=mt,mt=vt;break e}_e(mt,bt);break}else _(mt,bt);bt=bt.sibling}yt.type===ya?(vt=Tg(yt.props.children,mt.mode,_t,yt.key),vt.return=mt,mt=vt):(_t=Rg(yt.type,yt.key,yt.props,null,mt.mode,_t),_t.ref=Lg(mt,vt,yt),_t.return=mt,mt=_t)}return it(mt);case wa:e:{for(bt=yt.key;vt!==null;){if(vt.key===bt)if(vt.tag===4&&vt.stateNode.containerInfo===yt.containerInfo&&vt.stateNode.implementation===yt.implementation){_e(mt,vt.sibling),vt=nt(vt,yt.children||[]),vt.return=mt,mt=vt;break e}else{_e(mt,vt);break}else _(mt,vt);vt=vt.sibling}vt=Sg(yt,mt.mode,_t),vt.return=mt,mt=vt}return it(mt);case Ha:return bt=yt._init,pt(mt,vt,bt(yt._payload),_t)}if(eb(yt))return ft(mt,vt,yt,_t);if(Ka(yt))return dt(mt,vt,yt,_t);Mg(mt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,vt!==null&&vt.tag===6?(_e(mt,vt.sibling),vt=nt(vt,yt),vt.return=mt,mt=vt):(_e(mt,vt),vt=Qg(yt,mt.mode,_t),vt.return=mt,mt=vt),it(mt)):_e(mt,vt)}return pt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(et){var _=Wg.current;E(Wg),et._currentValue=_}function bh(et,_,_e){for(;et!==null;){var tt=et.alternate;if((et.childLanes&_)!==_?(et.childLanes|=_,tt!==null&&(tt.childLanes|=_)):tt!==null&&(tt.childLanes&_)!==_&&(tt.childLanes|=_),et===_e)break;et=et.return}}function ch(et,_){Xg=et,Zg=Yg=null,et=et.dependencies,et!==null&&et.firstContext!==null&&(et.lanes&_&&(dh=!0),et.firstContext=null)}function eh(et){var _=et._currentValue;if(Zg!==et)if(et={context:et,memoizedValue:_,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=et,Xg.dependencies={lanes:0,firstContext:et}}else Yg=Yg.next=et;return _}var fh=null;function gh(et){fh===null?fh=[et]:fh.push(et)}function hh(et,_,_e,tt){var nt=_.interleaved;return nt===null?(_e.next=_e,gh(_)):(_e.next=nt.next,nt.next=_e),_.interleaved=_e,ih(et,tt)}function ih(et,_){et.lanes|=_;var _e=et.alternate;for(_e!==null&&(_e.lanes|=_),_e=et,et=et.return;et!==null;)et.childLanes|=_,_e=et.alternate,_e!==null&&(_e.childLanes|=_),_e=et,et=et.return;return _e.tag===3?_e.stateNode:null}var jh=!1;function kh(et){et.updateQueue={baseState:et.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(et,_){et=et.updateQueue,_.updateQueue===et&&(_.updateQueue={baseState:et.baseState,firstBaseUpdate:et.firstBaseUpdate,lastBaseUpdate:et.lastBaseUpdate,shared:et.shared,effects:et.effects})}function mh(et,_){return{eventTime:et,lane:_,tag:0,payload:null,callback:null,next:null}}function nh(et,_,_e){var tt=et.updateQueue;if(tt===null)return null;if(tt=tt.shared,K$1&2){var nt=tt.pending;return nt===null?_.next=_:(_.next=nt.next,nt.next=_),tt.pending=_,ih(et,_e)}return nt=tt.interleaved,nt===null?(_.next=_,gh(tt)):(_.next=nt.next,nt.next=_),tt.interleaved=_,ih(et,_e)}function oh(et,_,_e){if(_=_.updateQueue,_!==null&&(_=_.shared,(_e&4194240)!==0)){var tt=_.lanes;tt&=et.pendingLanes,_e|=tt,_.lanes=_e,Cc(et,_e)}}function ph(et,_){var _e=et.updateQueue,tt=et.alternate;if(tt!==null&&(tt=tt.updateQueue,_e===tt)){var nt=null,rt=null;if(_e=_e.firstBaseUpdate,_e!==null){do{var it={eventTime:_e.eventTime,lane:_e.lane,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null};rt===null?nt=rt=it:rt=rt.next=it,_e=_e.next}while(_e!==null);rt===null?nt=rt=_:rt=rt.next=_}else nt=rt=_;_e={baseState:tt.baseState,firstBaseUpdate:nt,lastBaseUpdate:rt,shared:tt.shared,effects:tt.effects},et.updateQueue=_e;return}et=_e.lastBaseUpdate,et===null?_e.firstBaseUpdate=_:et.next=_,_e.lastBaseUpdate=_}function qh(et,_,_e,tt){var nt=et.updateQueue;jh=!1;var rt=nt.firstBaseUpdate,it=nt.lastBaseUpdate,st=nt.shared.pending;if(st!==null){nt.shared.pending=null;var ot=st,at=ot.next;ot.next=null,it===null?rt=at:it.next=at,it=ot;var lt=et.alternate;lt!==null&&(lt=lt.updateQueue,st=lt.lastBaseUpdate,st!==it&&(st===null?lt.firstBaseUpdate=at:st.next=at,lt.lastBaseUpdate=ot))}if(rt!==null){var ct=nt.baseState;it=0,lt=at=ot=null,st=rt;do{var ht=st.lane,ut=st.eventTime;if((tt&ht)===ht){lt!==null&&(lt=lt.next={eventTime:ut,lane:0,tag:st.tag,payload:st.payload,callback:st.callback,next:null});e:{var ft=et,dt=st;switch(ht=_,ut=_e,dt.tag){case 1:if(ft=dt.payload,typeof ft=="function"){ct=ft.call(ut,ct,ht);break e}ct=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=dt.payload,ht=typeof ft=="function"?ft.call(ut,ct,ht):ft,ht==null)break e;ct=A({},ct,ht);break e;case 2:jh=!0}}st.callback!==null&&st.lane!==0&&(et.flags|=64,ht=nt.effects,ht===null?nt.effects=[st]:ht.push(st))}else ut={eventTime:ut,lane:ht,tag:st.tag,payload:st.payload,callback:st.callback,next:null},lt===null?(at=lt=ut,ot=ct):lt=lt.next=ut,it|=ht;if(st=st.next,st===null){if(st=nt.shared.pending,st===null)break;ht=st,st=ht.next,ht.next=null,nt.lastBaseUpdate=ht,nt.shared.pending=null}}while(!0);if(lt===null&&(ot=ct),nt.baseState=ot,nt.firstBaseUpdate=at,nt.lastBaseUpdate=lt,_=nt.shared.interleaved,_!==null){nt=_;do it|=nt.lane,nt=nt.next;while(nt!==_)}else rt===null&&(nt.shared.lanes=0);rh|=it,et.lanes=it,et.memoizedState=ct}}function sh(et,_,_e){if(et=_.effects,_.effects=null,et!==null)for(_=0;_<et.length;_++){var tt=et[_],nt=tt.callback;if(nt!==null){if(tt.callback=null,tt=_e,typeof nt!="function")throw Error(p$1(191,nt));nt.call(tt)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(et){if(et===th)throw Error(p$1(174));return et}function yh(et,_){switch(G(wh,_),G(vh,et),G(uh,th),et=_.nodeType,et){case 9:case 11:_=(_=_.documentElement)?_.namespaceURI:lb(null,"");break;default:et=et===8?_.parentNode:_,_=et.namespaceURI||null,et=et.tagName,_=lb(_,et)}E(uh),G(uh,_)}function zh(){E(uh),E(vh),E(wh)}function Ah(et){xh(wh.current);var _=xh(uh.current),_e=lb(_,et.type);_!==_e&&(G(vh,et),G(uh,_e))}function Bh(et){vh.current===et&&(E(uh),E(vh))}var L=Uf(0);function Ch(et){for(var _=et;_!==null;){if(_.tag===13){var _e=_.memoizedState;if(_e!==null&&(_e=_e.dehydrated,_e===null||_e.data==="$?"||_e.data==="$!"))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if(_.flags&128)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===et)break;for(;_.sibling===null;){if(_.return===null||_.return===et)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var Dh=[];function Eh(){for(var et=0;et<Dh.length;et++)Dh[et]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua$1.ReactCurrentDispatcher,Gh=ua$1.ReactCurrentBatchConfig,Hh=0,M$1=null,N$1=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p$1(321))}function Mh(et,_){if(_===null)return!1;for(var _e=0;_e<_.length&&_e<et.length;_e++)if(!He(et[_e],_[_e]))return!1;return!0}function Nh(et,_,_e,tt,nt,rt){if(Hh=rt,M$1=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,Fh.current=et===null||et.memoizedState===null?Oh:Ph,et=_e(tt,nt),Jh){rt=0;do{if(Jh=!1,Kh=0,25<=rt)throw Error(p$1(301));rt+=1,O=N$1=null,_.updateQueue=null,Fh.current=Qh,et=_e(tt,nt)}while(Jh)}if(Fh.current=Rh,_=N$1!==null&&N$1.next!==null,Hh=0,O=N$1=M$1=null,Ih=!1,_)throw Error(p$1(300));return et}function Sh(){var et=Kh!==0;return Kh=0,et}function Th(){var et={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M$1.memoizedState=O=et:O=O.next=et,O}function Uh(){if(N$1===null){var et=M$1.alternate;et=et!==null?et.memoizedState:null}else et=N$1.next;var _=O===null?M$1.memoizedState:O.next;if(_!==null)O=_,N$1=et;else{if(et===null)throw Error(p$1(310));N$1=et,et={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O===null?M$1.memoizedState=O=et:O=O.next=et}return O}function Vh(et,_){return typeof _=="function"?_(et):_}function Wh(et){var _=Uh(),_e=_.queue;if(_e===null)throw Error(p$1(311));_e.lastRenderedReducer=et;var tt=N$1,nt=tt.baseQueue,rt=_e.pending;if(rt!==null){if(nt!==null){var it=nt.next;nt.next=rt.next,rt.next=it}tt.baseQueue=nt=rt,_e.pending=null}if(nt!==null){rt=nt.next,tt=tt.baseState;var st=it=null,ot=null,at=rt;do{var lt=at.lane;if((Hh&lt)===lt)ot!==null&&(ot=ot.next={lane:0,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),tt=at.hasEagerState?at.eagerState:et(tt,at.action);else{var ct={lane:lt,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null};ot===null?(st=ot=ct,it=tt):ot=ot.next=ct,M$1.lanes|=lt,rh|=lt}at=at.next}while(at!==null&&at!==rt);ot===null?it=tt:ot.next=st,He(tt,_.memoizedState)||(dh=!0),_.memoizedState=tt,_.baseState=it,_.baseQueue=ot,_e.lastRenderedState=tt}if(et=_e.interleaved,et!==null){nt=et;do rt=nt.lane,M$1.lanes|=rt,rh|=rt,nt=nt.next;while(nt!==et)}else nt===null&&(_e.lanes=0);return[_.memoizedState,_e.dispatch]}function Xh(et){var _=Uh(),_e=_.queue;if(_e===null)throw Error(p$1(311));_e.lastRenderedReducer=et;var tt=_e.dispatch,nt=_e.pending,rt=_.memoizedState;if(nt!==null){_e.pending=null;var it=nt=nt.next;do rt=et(rt,it.action),it=it.next;while(it!==nt);He(rt,_.memoizedState)||(dh=!0),_.memoizedState=rt,_.baseQueue===null&&(_.baseState=rt),_e.lastRenderedState=rt}return[rt,tt]}function Yh(){}function Zh(et,_){var _e=M$1,tt=Uh(),nt=_(),rt=!He(tt.memoizedState,nt);if(rt&&(tt.memoizedState=nt,dh=!0),tt=tt.queue,$h(ai.bind(null,_e,tt,et),[et]),tt.getSnapshot!==_||rt||O!==null&&O.memoizedState.tag&1){if(_e.flags|=2048,bi(9,ci.bind(null,_e,tt,nt,_),void 0,null),Q===null)throw Error(p$1(349));Hh&30||di(_e,_,nt)}return nt}function di(et,_,_e){et.flags|=16384,et={getSnapshot:_,value:_e},_=M$1.updateQueue,_===null?(_={lastEffect:null,stores:null},M$1.updateQueue=_,_.stores=[et]):(_e=_.stores,_e===null?_.stores=[et]:_e.push(et))}function ci(et,_,_e,tt){_.value=_e,_.getSnapshot=tt,ei(_)&&fi(et)}function ai(et,_,_e){return _e(function(){ei(_)&&fi(et)})}function ei(et){var _=et.getSnapshot;et=et.value;try{var _e=_();return!He(et,_e)}catch{return!0}}function fi(et){var _=ih(et,1);_!==null&&gi(_,et,1,-1)}function hi(et){var _=Th();return typeof et=="function"&&(et=et()),_.memoizedState=_.baseState=et,et={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:et},_.queue=et,et=et.dispatch=ii.bind(null,M$1,et),[_.memoizedState,et]}function bi(et,_,_e,tt){return et={tag:et,create:_,destroy:_e,deps:tt,next:null},_=M$1.updateQueue,_===null?(_={lastEffect:null,stores:null},M$1.updateQueue=_,_.lastEffect=et.next=et):(_e=_.lastEffect,_e===null?_.lastEffect=et.next=et:(tt=_e.next,_e.next=et,et.next=tt,_.lastEffect=et)),et}function ji(){return Uh().memoizedState}function ki(et,_,_e,tt){var nt=Th();M$1.flags|=et,nt.memoizedState=bi(1|_,_e,void 0,tt===void 0?null:tt)}function li$1(et,_,_e,tt){var nt=Uh();tt=tt===void 0?null:tt;var rt=void 0;if(N$1!==null){var it=N$1.memoizedState;if(rt=it.destroy,tt!==null&&Mh(tt,it.deps)){nt.memoizedState=bi(_,_e,rt,tt);return}}M$1.flags|=et,nt.memoizedState=bi(1|_,_e,rt,tt)}function mi(et,_){return ki(8390656,8,et,_)}function $h(et,_){return li$1(2048,8,et,_)}function ni(et,_){return li$1(4,2,et,_)}function oi(et,_){return li$1(4,4,et,_)}function pi(et,_){if(typeof _=="function")return et=et(),_(et),function(){_(null)};if(_!=null)return et=et(),_.current=et,function(){_.current=null}}function qi(et,_,_e){return _e=_e!=null?_e.concat([et]):null,li$1(4,4,pi.bind(null,_,et),_e)}function ri(){}function si(et,_){var _e=Uh();_=_===void 0?null:_;var tt=_e.memoizedState;return tt!==null&&_!==null&&Mh(_,tt[1])?tt[0]:(_e.memoizedState=[et,_],et)}function ti(et,_){var _e=Uh();_=_===void 0?null:_;var tt=_e.memoizedState;return tt!==null&&_!==null&&Mh(_,tt[1])?tt[0]:(et=et(),_e.memoizedState=[et,_],et)}function ui(et,_,_e){return Hh&21?(He(_e,_)||(_e=yc(),M$1.lanes|=_e,rh|=_e,et.baseState=!0),_):(et.baseState&&(et.baseState=!1,dh=!0),et.memoizedState=_e)}function vi(et,_){var _e=C;C=_e!==0&&4>_e?_e:4,et(!0);var tt=Gh.transition;Gh.transition={};try{et(!1),_()}finally{C=_e,Gh.transition=tt}}function wi(){return Uh().memoizedState}function xi(et,_,_e){var tt=yi(et);if(_e={lane:tt,action:_e,hasEagerState:!1,eagerState:null,next:null},zi(et))Ai(_,_e);else if(_e=hh(et,_,_e,tt),_e!==null){var nt=R();gi(_e,et,tt,nt),Bi(_e,_,tt)}}function ii(et,_,_e){var tt=yi(et),nt={lane:tt,action:_e,hasEagerState:!1,eagerState:null,next:null};if(zi(et))Ai(_,nt);else{var rt=et.alternate;if(et.lanes===0&&(rt===null||rt.lanes===0)&&(rt=_.lastRenderedReducer,rt!==null))try{var it=_.lastRenderedState,st=rt(it,_e);if(nt.hasEagerState=!0,nt.eagerState=st,He(st,it)){var ot=_.interleaved;ot===null?(nt.next=nt,gh(_)):(nt.next=ot.next,ot.next=nt),_.interleaved=nt;return}}catch{}finally{}_e=hh(et,_,nt,tt),_e!==null&&(nt=R(),gi(_e,et,tt,nt),Bi(_e,_,tt))}}function zi(et){var _=et.alternate;return et===M$1||_!==null&&_===M$1}function Ai(et,_){Jh=Ih=!0;var _e=et.pending;_e===null?_.next=_:(_.next=_e.next,_e.next=_),et.pending=_}function Bi(et,_,_e){if(_e&4194240){var tt=_.lanes;tt&=et.pendingLanes,_e|=tt,_.lanes=_e,Cc(et,_e)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(et,_){return Th().memoizedState=[et,_===void 0?null:_],et},useContext:eh,useEffect:mi,useImperativeHandle:function(et,_,_e){return _e=_e!=null?_e.concat([et]):null,ki(4194308,4,pi.bind(null,_,et),_e)},useLayoutEffect:function(et,_){return ki(4194308,4,et,_)},useInsertionEffect:function(et,_){return ki(4,2,et,_)},useMemo:function(et,_){var _e=Th();return _=_===void 0?null:_,et=et(),_e.memoizedState=[et,_],et},useReducer:function(et,_,_e){var tt=Th();return _=_e!==void 0?_e(_):_,tt.memoizedState=tt.baseState=_,et={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:et,lastRenderedState:_},tt.queue=et,et=et.dispatch=xi.bind(null,M$1,et),[tt.memoizedState,et]},useRef:function(et){var _=Th();return et={current:et},_.memoizedState=et},useState:hi,useDebugValue:ri,useDeferredValue:function(et){return Th().memoizedState=et},useTransition:function(){var et=hi(!1),_=et[0];return et=vi.bind(null,et[1]),Th().memoizedState=et,[_,et]},useMutableSource:function(){},useSyncExternalStore:function(et,_,_e){var tt=M$1,nt=Th();if(I){if(_e===void 0)throw Error(p$1(407));_e=_e()}else{if(_e=_(),Q===null)throw Error(p$1(349));Hh&30||di(tt,_,_e)}nt.memoizedState=_e;var rt={value:_e,getSnapshot:_};return nt.queue=rt,mi(ai.bind(null,tt,rt,et),[et]),tt.flags|=2048,bi(9,ci.bind(null,tt,rt,_e,_),void 0,null),_e},useId:function(){var et=Th(),_=Q.identifierPrefix;if(I){var _e=sg,tt=rg;_e=(tt&~(1<<32-oc(tt)-1)).toString(32)+_e,_=":"+_+"R"+_e,_e=Kh++,0<_e&&(_+="H"+_e.toString(32)),_+=":"}else _e=Lh++,_=":"+_+"r"+_e.toString(32)+":";return et.memoizedState=_},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(et){var _=Uh();return ui(_,N$1.memoizedState,et)},useTransition:function(){var et=Wh(Vh)[0],_=Uh().memoizedState;return[et,_]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(et){var _=Uh();return N$1===null?_.memoizedState=et:ui(_,N$1.memoizedState,et)},useTransition:function(){var et=Xh(Vh)[0],_=Uh().memoizedState;return[et,_]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(et,_){if(et&&et.defaultProps){_=A({},_),et=et.defaultProps;for(var _e in et)_[_e]===void 0&&(_[_e]=et[_e]);return _}return _}function Di(et,_,_e,tt){_=et.memoizedState,_e=_e(tt,_),_e=_e==null?_:A({},_,_e),et.memoizedState=_e,et.lanes===0&&(et.updateQueue.baseState=_e)}var Ei={isMounted:function(et){return(et=et._reactInternals)?Vb(et)===et:!1},enqueueSetState:function(et,_,_e){et=et._reactInternals;var tt=R(),nt=yi(et),rt=mh(tt,nt);rt.payload=_,_e!=null&&(rt.callback=_e),_=nh(et,rt,nt),_!==null&&(gi(_,et,nt,tt),oh(_,et,nt))},enqueueReplaceState:function(et,_,_e){et=et._reactInternals;var tt=R(),nt=yi(et),rt=mh(tt,nt);rt.tag=1,rt.payload=_,_e!=null&&(rt.callback=_e),_=nh(et,rt,nt),_!==null&&(gi(_,et,nt,tt),oh(_,et,nt))},enqueueForceUpdate:function(et,_){et=et._reactInternals;var _e=R(),tt=yi(et),nt=mh(_e,tt);nt.tag=2,_!=null&&(nt.callback=_),_=nh(et,nt,tt),_!==null&&(gi(_,et,tt,_e),oh(_,et,tt))}};function Fi(et,_,_e,tt,nt,rt,it){return et=et.stateNode,typeof et.shouldComponentUpdate=="function"?et.shouldComponentUpdate(tt,rt,it):_.prototype&&_.prototype.isPureReactComponent?!Ie(_e,tt)||!Ie(nt,rt):!0}function Gi(et,_,_e){var tt=!1,nt=Vf,rt=_.contextType;return typeof rt=="object"&&rt!==null?rt=eh(rt):(nt=Zf(_)?Xf:H$1.current,tt=_.contextTypes,rt=(tt=tt!=null)?Yf(et,nt):Vf),_=new _(_e,rt),et.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ei,et.stateNode=_,_._reactInternals=et,tt&&(et=et.stateNode,et.__reactInternalMemoizedUnmaskedChildContext=nt,et.__reactInternalMemoizedMaskedChildContext=rt),_}function Hi(et,_,_e,tt){et=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(_e,tt),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(_e,tt),_.state!==et&&Ei.enqueueReplaceState(_,_.state,null)}function Ii(et,_,_e,tt){var nt=et.stateNode;nt.props=_e,nt.state=et.memoizedState,nt.refs={},kh(et);var rt=_.contextType;typeof rt=="object"&&rt!==null?nt.context=eh(rt):(rt=Zf(_)?Xf:H$1.current,nt.context=Yf(et,rt)),nt.state=et.memoizedState,rt=_.getDerivedStateFromProps,typeof rt=="function"&&(Di(et,_,rt,_e),nt.state=et.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof nt.getSnapshotBeforeUpdate=="function"||typeof nt.UNSAFE_componentWillMount!="function"&&typeof nt.componentWillMount!="function"||(_=nt.state,typeof nt.componentWillMount=="function"&&nt.componentWillMount(),typeof nt.UNSAFE_componentWillMount=="function"&&nt.UNSAFE_componentWillMount(),_!==nt.state&&Ei.enqueueReplaceState(nt,nt.state,null),qh(et,_e,nt,tt),nt.state=et.memoizedState),typeof nt.componentDidMount=="function"&&(et.flags|=4194308)}function Ji(et,_){try{var _e="",tt=_;do _e+=Pa(tt),tt=tt.return;while(tt);var nt=_e}catch(rt){nt=`
Error generating stack: `+rt.message+`
`+rt.stack}return{value:et,source:_,stack:nt,digest:null}}function Ki(et,_,_e){return{value:et,source:null,stack:_e??null,digest:_??null}}function Li(et,_){try{console.error(_.value)}catch(_e){setTimeout(function(){throw _e})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(et,_,_e){_e=mh(-1,_e),_e.tag=3,_e.payload={element:null};var tt=_.value;return _e.callback=function(){Oi||(Oi=!0,Pi=tt),Li(et,_)},_e}function Qi(et,_,_e){_e=mh(-1,_e),_e.tag=3;var tt=et.type.getDerivedStateFromError;if(typeof tt=="function"){var nt=_.value;_e.payload=function(){return tt(nt)},_e.callback=function(){Li(et,_)}}var rt=et.stateNode;return rt!==null&&typeof rt.componentDidCatch=="function"&&(_e.callback=function(){Li(et,_),typeof tt!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var it=_.stack;this.componentDidCatch(_.value,{componentStack:it!==null?it:""})}),_e}function Si(et,_,_e){var tt=et.pingCache;if(tt===null){tt=et.pingCache=new Mi;var nt=new Set;tt.set(_,nt)}else nt=tt.get(_),nt===void 0&&(nt=new Set,tt.set(_,nt));nt.has(_e)||(nt.add(_e),et=Ti.bind(null,et,_,_e),_.then(et,et))}function Ui(et){do{var _;if((_=et.tag===13)&&(_=et.memoizedState,_=_!==null?_.dehydrated!==null:!0),_)return et;et=et.return}while(et!==null);return null}function Vi(et,_,_e,tt,nt){return et.mode&1?(et.flags|=65536,et.lanes=nt,et):(et===_?et.flags|=65536:(et.flags|=128,_e.flags|=131072,_e.flags&=-52805,_e.tag===1&&(_e.alternate===null?_e.tag=17:(_=mh(-1,1),_.tag=2,nh(_e,_,1))),_e.lanes|=1),et)}var Wi=ua$1.ReactCurrentOwner,dh=!1;function Xi(et,_,_e,tt){_.child=et===null?Vg(_,null,_e,tt):Ug(_,et.child,_e,tt)}function Yi(et,_,_e,tt,nt){_e=_e.render;var rt=_.ref;return ch(_,nt),tt=Nh(et,_,_e,tt,rt,nt),_e=Sh(),et!==null&&!dh?(_.updateQueue=et.updateQueue,_.flags&=-2053,et.lanes&=~nt,Zi(et,_,nt)):(I&&_e&&vg(_),_.flags|=1,Xi(et,_,tt,nt),_.child)}function $i(et,_,_e,tt,nt){if(et===null){var rt=_e.type;return typeof rt=="function"&&!aj(rt)&&rt.defaultProps===void 0&&_e.compare===null&&_e.defaultProps===void 0?(_.tag=15,_.type=rt,bj(et,_,rt,tt,nt)):(et=Rg(_e.type,null,tt,_,_.mode,nt),et.ref=_.ref,et.return=_,_.child=et)}if(rt=et.child,!(et.lanes&nt)){var it=rt.memoizedProps;if(_e=_e.compare,_e=_e!==null?_e:Ie,_e(it,tt)&&et.ref===_.ref)return Zi(et,_,nt)}return _.flags|=1,et=Pg(rt,tt),et.ref=_.ref,et.return=_,_.child=et}function bj(et,_,_e,tt,nt){if(et!==null){var rt=et.memoizedProps;if(Ie(rt,tt)&&et.ref===_.ref)if(dh=!1,_.pendingProps=tt=rt,(et.lanes&nt)!==0)et.flags&131072&&(dh=!0);else return _.lanes=et.lanes,Zi(et,_,nt)}return cj(et,_,_e,tt,nt)}function dj(et,_,_e){var tt=_.pendingProps,nt=tt.children,rt=et!==null?et.memoizedState:null;if(tt.mode==="hidden")if(!(_.mode&1))_.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=_e;else{if(!(_e&1073741824))return et=rt!==null?rt.baseLanes|_e:_e,_.lanes=_.childLanes=1073741824,_.memoizedState={baseLanes:et,cachePool:null,transitions:null},_.updateQueue=null,G(ej,fj),fj|=et,null;_.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt=rt!==null?rt.baseLanes:_e,G(ej,fj),fj|=tt}else rt!==null?(tt=rt.baseLanes|_e,_.memoizedState=null):tt=_e,G(ej,fj),fj|=tt;return Xi(et,_,nt,_e),_.child}function gj(et,_){var _e=_.ref;(et===null&&_e!==null||et!==null&&et.ref!==_e)&&(_.flags|=512,_.flags|=2097152)}function cj(et,_,_e,tt,nt){var rt=Zf(_e)?Xf:H$1.current;return rt=Yf(_,rt),ch(_,nt),_e=Nh(et,_,_e,tt,rt,nt),tt=Sh(),et!==null&&!dh?(_.updateQueue=et.updateQueue,_.flags&=-2053,et.lanes&=~nt,Zi(et,_,nt)):(I&&tt&&vg(_),_.flags|=1,Xi(et,_,_e,nt),_.child)}function hj(et,_,_e,tt,nt){if(Zf(_e)){var rt=!0;cg(_)}else rt=!1;if(ch(_,nt),_.stateNode===null)ij(et,_),Gi(_,_e,tt),Ii(_,_e,tt,nt),tt=!0;else if(et===null){var it=_.stateNode,st=_.memoizedProps;it.props=st;var ot=it.context,at=_e.contextType;typeof at=="object"&&at!==null?at=eh(at):(at=Zf(_e)?Xf:H$1.current,at=Yf(_,at));var lt=_e.getDerivedStateFromProps,ct=typeof lt=="function"||typeof it.getSnapshotBeforeUpdate=="function";ct||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(st!==tt||ot!==at)&&Hi(_,it,tt,at),jh=!1;var ht=_.memoizedState;it.state=ht,qh(_,tt,it,nt),ot=_.memoizedState,st!==tt||ht!==ot||Wf.current||jh?(typeof lt=="function"&&(Di(_,_e,lt,tt),ot=_.memoizedState),(st=jh||Fi(_,_e,st,tt,ht,ot,at))?(ct||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount()),typeof it.componentDidMount=="function"&&(_.flags|=4194308)):(typeof it.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=tt,_.memoizedState=ot),it.props=tt,it.state=ot,it.context=at,tt=st):(typeof it.componentDidMount=="function"&&(_.flags|=4194308),tt=!1)}else{it=_.stateNode,lh(et,_),st=_.memoizedProps,at=_.type===_.elementType?st:Ci(_.type,st),it.props=at,ct=_.pendingProps,ht=it.context,ot=_e.contextType,typeof ot=="object"&&ot!==null?ot=eh(ot):(ot=Zf(_e)?Xf:H$1.current,ot=Yf(_,ot));var ut=_e.getDerivedStateFromProps;(lt=typeof ut=="function"||typeof it.getSnapshotBeforeUpdate=="function")||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(st!==ct||ht!==ot)&&Hi(_,it,tt,ot),jh=!1,ht=_.memoizedState,it.state=ht,qh(_,tt,it,nt);var ft=_.memoizedState;st!==ct||ht!==ft||Wf.current||jh?(typeof ut=="function"&&(Di(_,_e,ut,tt),ft=_.memoizedState),(at=jh||Fi(_,_e,at,tt,ht,ft,ot)||!1)?(lt||typeof it.UNSAFE_componentWillUpdate!="function"&&typeof it.componentWillUpdate!="function"||(typeof it.componentWillUpdate=="function"&&it.componentWillUpdate(tt,ft,ot),typeof it.UNSAFE_componentWillUpdate=="function"&&it.UNSAFE_componentWillUpdate(tt,ft,ot)),typeof it.componentDidUpdate=="function"&&(_.flags|=4),typeof it.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof it.componentDidUpdate!="function"||st===et.memoizedProps&&ht===et.memoizedState||(_.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||st===et.memoizedProps&&ht===et.memoizedState||(_.flags|=1024),_.memoizedProps=tt,_.memoizedState=ft),it.props=tt,it.state=ft,it.context=ot,tt=at):(typeof it.componentDidUpdate!="function"||st===et.memoizedProps&&ht===et.memoizedState||(_.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||st===et.memoizedProps&&ht===et.memoizedState||(_.flags|=1024),tt=!1)}return jj(et,_,_e,tt,rt,nt)}function jj(et,_,_e,tt,nt,rt){gj(et,_);var it=(_.flags&128)!==0;if(!tt&&!it)return nt&&dg(_,_e,!1),Zi(et,_,rt);tt=_.stateNode,Wi.current=_;var st=it&&typeof _e.getDerivedStateFromError!="function"?null:tt.render();return _.flags|=1,et!==null&&it?(_.child=Ug(_,et.child,null,rt),_.child=Ug(_,null,st,rt)):Xi(et,_,st,rt),_.memoizedState=tt.state,nt&&dg(_,_e,!0),_.child}function kj(et){var _=et.stateNode;_.pendingContext?ag(et,_.pendingContext,_.pendingContext!==_.context):_.context&&ag(et,_.context,!1),yh(et,_.containerInfo)}function lj(et,_,_e,tt,nt){return Ig(),Jg(nt),_.flags|=256,Xi(et,_,_e,tt),_.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(et){return{baseLanes:et,cachePool:null,transitions:null}}function oj(et,_,_e){var tt=_.pendingProps,nt=L.current,rt=!1,it=(_.flags&128)!==0,st;if((st=it)||(st=et!==null&&et.memoizedState===null?!1:(nt&2)!==0),st?(rt=!0,_.flags&=-129):(et===null||et.memoizedState!==null)&&(nt|=1),G(L,nt&1),et===null)return Eg(_),et=_.memoizedState,et!==null&&(et=et.dehydrated,et!==null)?(_.mode&1?et.data==="$!"?_.lanes=8:_.lanes=1073741824:_.lanes=1,null):(it=tt.children,et=tt.fallback,rt?(tt=_.mode,rt=_.child,it={mode:"hidden",children:it},!(tt&1)&&rt!==null?(rt.childLanes=0,rt.pendingProps=it):rt=pj(it,tt,0,null),et=Tg(et,tt,_e,null),rt.return=_,et.return=_,rt.sibling=et,_.child=rt,_.child.memoizedState=nj(_e),_.memoizedState=mj,et):qj(_,it));if(nt=et.memoizedState,nt!==null&&(st=nt.dehydrated,st!==null))return rj(et,_,it,tt,st,nt,_e);if(rt){rt=tt.fallback,it=_.mode,nt=et.child,st=nt.sibling;var ot={mode:"hidden",children:tt.children};return!(it&1)&&_.child!==nt?(tt=_.child,tt.childLanes=0,tt.pendingProps=ot,_.deletions=null):(tt=Pg(nt,ot),tt.subtreeFlags=nt.subtreeFlags&14680064),st!==null?rt=Pg(st,rt):(rt=Tg(rt,it,_e,null),rt.flags|=2),rt.return=_,tt.return=_,tt.sibling=rt,_.child=tt,tt=rt,rt=_.child,it=et.child.memoizedState,it=it===null?nj(_e):{baseLanes:it.baseLanes|_e,cachePool:null,transitions:it.transitions},rt.memoizedState=it,rt.childLanes=et.childLanes&~_e,_.memoizedState=mj,tt}return rt=et.child,et=rt.sibling,tt=Pg(rt,{mode:"visible",children:tt.children}),!(_.mode&1)&&(tt.lanes=_e),tt.return=_,tt.sibling=null,et!==null&&(_e=_.deletions,_e===null?(_.deletions=[et],_.flags|=16):_e.push(et)),_.child=tt,_.memoizedState=null,tt}function qj(et,_){return _=pj({mode:"visible",children:_},et.mode,0,null),_.return=et,et.child=_}function sj(et,_,_e,tt){return tt!==null&&Jg(tt),Ug(_,et.child,null,_e),et=qj(_,_.pendingProps.children),et.flags|=2,_.memoizedState=null,et}function rj(et,_,_e,tt,nt,rt,it){if(_e)return _.flags&256?(_.flags&=-257,tt=Ki(Error(p$1(422))),sj(et,_,it,tt)):_.memoizedState!==null?(_.child=et.child,_.flags|=128,null):(rt=tt.fallback,nt=_.mode,tt=pj({mode:"visible",children:tt.children},nt,0,null),rt=Tg(rt,nt,it,null),rt.flags|=2,tt.return=_,rt.return=_,tt.sibling=rt,_.child=tt,_.mode&1&&Ug(_,et.child,null,it),_.child.memoizedState=nj(it),_.memoizedState=mj,rt);if(!(_.mode&1))return sj(et,_,it,null);if(nt.data==="$!"){if(tt=nt.nextSibling&&nt.nextSibling.dataset,tt)var st=tt.dgst;return tt=st,rt=Error(p$1(419)),tt=Ki(rt,tt,void 0),sj(et,_,it,tt)}if(st=(it&et.childLanes)!==0,dh||st){if(tt=Q,tt!==null){switch(it&-it){case 4:nt=2;break;case 16:nt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:nt=32;break;case 536870912:nt=268435456;break;default:nt=0}nt=nt&(tt.suspendedLanes|it)?0:nt,nt!==0&&nt!==rt.retryLane&&(rt.retryLane=nt,ih(et,nt),gi(tt,et,nt,-1))}return tj(),tt=Ki(Error(p$1(421))),sj(et,_,it,tt)}return nt.data==="$?"?(_.flags|=128,_.child=et.child,_=uj.bind(null,et),nt._reactRetry=_,null):(et=rt.treeContext,yg=Lf(nt.nextSibling),xg=_,I=!0,zg=null,et!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=et.id,sg=et.overflow,qg=_),_=qj(_,tt.children),_.flags|=4096,_)}function vj(et,_,_e){et.lanes|=_;var tt=et.alternate;tt!==null&&(tt.lanes|=_),bh(et.return,_,_e)}function wj(et,_,_e,tt,nt){var rt=et.memoizedState;rt===null?et.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:tt,tail:_e,tailMode:nt}:(rt.isBackwards=_,rt.rendering=null,rt.renderingStartTime=0,rt.last=tt,rt.tail=_e,rt.tailMode=nt)}function xj(et,_,_e){var tt=_.pendingProps,nt=tt.revealOrder,rt=tt.tail;if(Xi(et,_,tt.children,_e),tt=L.current,tt&2)tt=tt&1|2,_.flags|=128;else{if(et!==null&&et.flags&128)e:for(et=_.child;et!==null;){if(et.tag===13)et.memoizedState!==null&&vj(et,_e,_);else if(et.tag===19)vj(et,_e,_);else if(et.child!==null){et.child.return=et,et=et.child;continue}if(et===_)break e;for(;et.sibling===null;){if(et.return===null||et.return===_)break e;et=et.return}et.sibling.return=et.return,et=et.sibling}tt&=1}if(G(L,tt),!(_.mode&1))_.memoizedState=null;else switch(nt){case"forwards":for(_e=_.child,nt=null;_e!==null;)et=_e.alternate,et!==null&&Ch(et)===null&&(nt=_e),_e=_e.sibling;_e=nt,_e===null?(nt=_.child,_.child=null):(nt=_e.sibling,_e.sibling=null),wj(_,!1,nt,_e,rt);break;case"backwards":for(_e=null,nt=_.child,_.child=null;nt!==null;){if(et=nt.alternate,et!==null&&Ch(et)===null){_.child=nt;break}et=nt.sibling,nt.sibling=_e,_e=nt,nt=et}wj(_,!0,_e,null,rt);break;case"together":wj(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function ij(et,_){!(_.mode&1)&&et!==null&&(et.alternate=null,_.alternate=null,_.flags|=2)}function Zi(et,_,_e){if(et!==null&&(_.dependencies=et.dependencies),rh|=_.lanes,!(_e&_.childLanes))return null;if(et!==null&&_.child!==et.child)throw Error(p$1(153));if(_.child!==null){for(et=_.child,_e=Pg(et,et.pendingProps),_.child=_e,_e.return=_;et.sibling!==null;)et=et.sibling,_e=_e.sibling=Pg(et,et.pendingProps),_e.return=_;_e.sibling=null}return _.child}function yj(et,_,_e){switch(_.tag){case 3:kj(_),Ig();break;case 5:Ah(_);break;case 1:Zf(_.type)&&cg(_);break;case 4:yh(_,_.stateNode.containerInfo);break;case 10:var tt=_.type._context,nt=_.memoizedProps.value;G(Wg,tt._currentValue),tt._currentValue=nt;break;case 13:if(tt=_.memoizedState,tt!==null)return tt.dehydrated!==null?(G(L,L.current&1),_.flags|=128,null):_e&_.child.childLanes?oj(et,_,_e):(G(L,L.current&1),et=Zi(et,_,_e),et!==null?et.sibling:null);G(L,L.current&1);break;case 19:if(tt=(_e&_.childLanes)!==0,et.flags&128){if(tt)return xj(et,_,_e);_.flags|=128}if(nt=_.memoizedState,nt!==null&&(nt.rendering=null,nt.tail=null,nt.lastEffect=null),G(L,L.current),tt)break;return null;case 22:case 23:return _.lanes=0,dj(et,_,_e)}return Zi(et,_,_e)}var zj,Aj,Bj,Cj;zj=function(et,_){for(var _e=_.child;_e!==null;){if(_e.tag===5||_e.tag===6)et.appendChild(_e.stateNode);else if(_e.tag!==4&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===_)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===_)return;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}};Aj=function(){};Bj=function(et,_,_e,tt){var nt=et.memoizedProps;if(nt!==tt){et=_.stateNode,xh(uh.current);var rt=null;switch(_e){case"input":nt=Ya(et,nt),tt=Ya(et,tt),rt=[];break;case"select":nt=A({},nt,{value:void 0}),tt=A({},tt,{value:void 0}),rt=[];break;case"textarea":nt=gb(et,nt),tt=gb(et,tt),rt=[];break;default:typeof nt.onClick!="function"&&typeof tt.onClick=="function"&&(et.onclick=Bf)}ub(_e,tt);var it;_e=null;for(at in nt)if(!tt.hasOwnProperty(at)&&nt.hasOwnProperty(at)&&nt[at]!=null)if(at==="style"){var st=nt[at];for(it in st)st.hasOwnProperty(it)&&(_e||(_e={}),_e[it]="")}else at!=="dangerouslySetInnerHTML"&&at!=="children"&&at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&at!=="autoFocus"&&(ea.hasOwnProperty(at)?rt||(rt=[]):(rt=rt||[]).push(at,null));for(at in tt){var ot=tt[at];if(st=nt!=null?nt[at]:void 0,tt.hasOwnProperty(at)&&ot!==st&&(ot!=null||st!=null))if(at==="style")if(st){for(it in st)!st.hasOwnProperty(it)||ot&&ot.hasOwnProperty(it)||(_e||(_e={}),_e[it]="");for(it in ot)ot.hasOwnProperty(it)&&st[it]!==ot[it]&&(_e||(_e={}),_e[it]=ot[it])}else _e||(rt||(rt=[]),rt.push(at,_e)),_e=ot;else at==="dangerouslySetInnerHTML"?(ot=ot?ot.__html:void 0,st=st?st.__html:void 0,ot!=null&&st!==ot&&(rt=rt||[]).push(at,ot)):at==="children"?typeof ot!="string"&&typeof ot!="number"||(rt=rt||[]).push(at,""+ot):at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&(ea.hasOwnProperty(at)?(ot!=null&&at==="onScroll"&&D("scroll",et),rt||st===ot||(rt=[])):(rt=rt||[]).push(at,ot))}_e&&(rt=rt||[]).push("style",_e);var at=rt;(_.updateQueue=at)&&(_.flags|=4)}};Cj=function(et,_,_e,tt){_e!==tt&&(_.flags|=4)};function Dj(et,_){if(!I)switch(et.tailMode){case"hidden":_=et.tail;for(var _e=null;_!==null;)_.alternate!==null&&(_e=_),_=_.sibling;_e===null?et.tail=null:_e.sibling=null;break;case"collapsed":_e=et.tail;for(var tt=null;_e!==null;)_e.alternate!==null&&(tt=_e),_e=_e.sibling;tt===null?_||et.tail===null?et.tail=null:et.tail.sibling=null:tt.sibling=null}}function S$1(et){var _=et.alternate!==null&&et.alternate.child===et.child,_e=0,tt=0;if(_)for(var nt=et.child;nt!==null;)_e|=nt.lanes|nt.childLanes,tt|=nt.subtreeFlags&14680064,tt|=nt.flags&14680064,nt.return=et,nt=nt.sibling;else for(nt=et.child;nt!==null;)_e|=nt.lanes|nt.childLanes,tt|=nt.subtreeFlags,tt|=nt.flags,nt.return=et,nt=nt.sibling;return et.subtreeFlags|=tt,et.childLanes=_e,_}function Ej(et,_,_e){var tt=_.pendingProps;switch(wg(_),_.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(_),null;case 1:return Zf(_.type)&&$f(),S$1(_),null;case 3:return tt=_.stateNode,zh(),E(Wf),E(H$1),Eh(),tt.pendingContext&&(tt.context=tt.pendingContext,tt.pendingContext=null),(et===null||et.child===null)&&(Gg(_)?_.flags|=4:et===null||et.memoizedState.isDehydrated&&!(_.flags&256)||(_.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(et,_),S$1(_),null;case 5:Bh(_);var nt=xh(wh.current);if(_e=_.type,et!==null&&_.stateNode!=null)Bj(et,_,_e,tt,nt),et.ref!==_.ref&&(_.flags|=512,_.flags|=2097152);else{if(!tt){if(_.stateNode===null)throw Error(p$1(166));return S$1(_),null}if(et=xh(uh.current),Gg(_)){tt=_.stateNode,_e=_.type;var rt=_.memoizedProps;switch(tt[Of]=_,tt[Pf]=rt,et=(_.mode&1)!==0,_e){case"dialog":D("cancel",tt),D("close",tt);break;case"iframe":case"object":case"embed":D("load",tt);break;case"video":case"audio":for(nt=0;nt<lf.length;nt++)D(lf[nt],tt);break;case"source":D("error",tt);break;case"img":case"image":case"link":D("error",tt),D("load",tt);break;case"details":D("toggle",tt);break;case"input":Za(tt,rt),D("invalid",tt);break;case"select":tt._wrapperState={wasMultiple:!!rt.multiple},D("invalid",tt);break;case"textarea":hb(tt,rt),D("invalid",tt)}ub(_e,rt),nt=null;for(var it in rt)if(rt.hasOwnProperty(it)){var st=rt[it];it==="children"?typeof st=="string"?tt.textContent!==st&&(rt.suppressHydrationWarning!==!0&&Af(tt.textContent,st,et),nt=["children",st]):typeof st=="number"&&tt.textContent!==""+st&&(rt.suppressHydrationWarning!==!0&&Af(tt.textContent,st,et),nt=["children",""+st]):ea.hasOwnProperty(it)&&st!=null&&it==="onScroll"&&D("scroll",tt)}switch(_e){case"input":Va(tt),db(tt,rt,!0);break;case"textarea":Va(tt),jb(tt);break;case"select":case"option":break;default:typeof rt.onClick=="function"&&(tt.onclick=Bf)}tt=nt,_.updateQueue=tt,tt!==null&&(_.flags|=4)}else{it=nt.nodeType===9?nt:nt.ownerDocument,et==="http://www.w3.org/1999/xhtml"&&(et=kb(_e)),et==="http://www.w3.org/1999/xhtml"?_e==="script"?(et=it.createElement("div"),et.innerHTML="<script><\/script>",et=et.removeChild(et.firstChild)):typeof tt.is=="string"?et=it.createElement(_e,{is:tt.is}):(et=it.createElement(_e),_e==="select"&&(it=et,tt.multiple?it.multiple=!0:tt.size&&(it.size=tt.size))):et=it.createElementNS(et,_e),et[Of]=_,et[Pf]=tt,zj(et,_,!1,!1),_.stateNode=et;e:{switch(it=vb(_e,tt),_e){case"dialog":D("cancel",et),D("close",et),nt=tt;break;case"iframe":case"object":case"embed":D("load",et),nt=tt;break;case"video":case"audio":for(nt=0;nt<lf.length;nt++)D(lf[nt],et);nt=tt;break;case"source":D("error",et),nt=tt;break;case"img":case"image":case"link":D("error",et),D("load",et),nt=tt;break;case"details":D("toggle",et),nt=tt;break;case"input":Za(et,tt),nt=Ya(et,tt),D("invalid",et);break;case"option":nt=tt;break;case"select":et._wrapperState={wasMultiple:!!tt.multiple},nt=A({},tt,{value:void 0}),D("invalid",et);break;case"textarea":hb(et,tt),nt=gb(et,tt),D("invalid",et);break;default:nt=tt}ub(_e,nt),st=nt;for(rt in st)if(st.hasOwnProperty(rt)){var ot=st[rt];rt==="style"?sb(et,ot):rt==="dangerouslySetInnerHTML"?(ot=ot?ot.__html:void 0,ot!=null&&nb(et,ot)):rt==="children"?typeof ot=="string"?(_e!=="textarea"||ot!=="")&&ob(et,ot):typeof ot=="number"&&ob(et,""+ot):rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&rt!=="autoFocus"&&(ea.hasOwnProperty(rt)?ot!=null&&rt==="onScroll"&&D("scroll",et):ot!=null&&ta(et,rt,ot,it))}switch(_e){case"input":Va(et),db(et,tt,!1);break;case"textarea":Va(et),jb(et);break;case"option":tt.value!=null&&et.setAttribute("value",""+Sa(tt.value));break;case"select":et.multiple=!!tt.multiple,rt=tt.value,rt!=null?fb(et,!!tt.multiple,rt,!1):tt.defaultValue!=null&&fb(et,!!tt.multiple,tt.defaultValue,!0);break;default:typeof nt.onClick=="function"&&(et.onclick=Bf)}switch(_e){case"button":case"input":case"select":case"textarea":tt=!!tt.autoFocus;break e;case"img":tt=!0;break e;default:tt=!1}}tt&&(_.flags|=4)}_.ref!==null&&(_.flags|=512,_.flags|=2097152)}return S$1(_),null;case 6:if(et&&_.stateNode!=null)Cj(et,_,et.memoizedProps,tt);else{if(typeof tt!="string"&&_.stateNode===null)throw Error(p$1(166));if(_e=xh(wh.current),xh(uh.current),Gg(_)){if(tt=_.stateNode,_e=_.memoizedProps,tt[Of]=_,(rt=tt.nodeValue!==_e)&&(et=xg,et!==null))switch(et.tag){case 3:Af(tt.nodeValue,_e,(et.mode&1)!==0);break;case 5:et.memoizedProps.suppressHydrationWarning!==!0&&Af(tt.nodeValue,_e,(et.mode&1)!==0)}rt&&(_.flags|=4)}else tt=(_e.nodeType===9?_e:_e.ownerDocument).createTextNode(tt),tt[Of]=_,_.stateNode=tt}return S$1(_),null;case 13:if(E(L),tt=_.memoizedState,et===null||et.memoizedState!==null&&et.memoizedState.dehydrated!==null){if(I&&yg!==null&&_.mode&1&&!(_.flags&128))Hg(),Ig(),_.flags|=98560,rt=!1;else if(rt=Gg(_),tt!==null&&tt.dehydrated!==null){if(et===null){if(!rt)throw Error(p$1(318));if(rt=_.memoizedState,rt=rt!==null?rt.dehydrated:null,!rt)throw Error(p$1(317));rt[Of]=_}else Ig(),!(_.flags&128)&&(_.memoizedState=null),_.flags|=4;S$1(_),rt=!1}else zg!==null&&(Fj(zg),zg=null),rt=!0;if(!rt)return _.flags&65536?_:null}return _.flags&128?(_.lanes=_e,_):(tt=tt!==null,tt!==(et!==null&&et.memoizedState!==null)&&tt&&(_.child.flags|=8192,_.mode&1&&(et===null||L.current&1?T===0&&(T=3):tj())),_.updateQueue!==null&&(_.flags|=4),S$1(_),null);case 4:return zh(),Aj(et,_),et===null&&sf(_.stateNode.containerInfo),S$1(_),null;case 10:return ah(_.type._context),S$1(_),null;case 17:return Zf(_.type)&&$f(),S$1(_),null;case 19:if(E(L),rt=_.memoizedState,rt===null)return S$1(_),null;if(tt=(_.flags&128)!==0,it=rt.rendering,it===null)if(tt)Dj(rt,!1);else{if(T!==0||et!==null&&et.flags&128)for(et=_.child;et!==null;){if(it=Ch(et),it!==null){for(_.flags|=128,Dj(rt,!1),tt=it.updateQueue,tt!==null&&(_.updateQueue=tt,_.flags|=4),_.subtreeFlags=0,tt=_e,_e=_.child;_e!==null;)rt=_e,et=tt,rt.flags&=14680066,it=rt.alternate,it===null?(rt.childLanes=0,rt.lanes=et,rt.child=null,rt.subtreeFlags=0,rt.memoizedProps=null,rt.memoizedState=null,rt.updateQueue=null,rt.dependencies=null,rt.stateNode=null):(rt.childLanes=it.childLanes,rt.lanes=it.lanes,rt.child=it.child,rt.subtreeFlags=0,rt.deletions=null,rt.memoizedProps=it.memoizedProps,rt.memoizedState=it.memoizedState,rt.updateQueue=it.updateQueue,rt.type=it.type,et=it.dependencies,rt.dependencies=et===null?null:{lanes:et.lanes,firstContext:et.firstContext}),_e=_e.sibling;return G(L,L.current&1|2),_.child}et=et.sibling}rt.tail!==null&&B()>Gj&&(_.flags|=128,tt=!0,Dj(rt,!1),_.lanes=4194304)}else{if(!tt)if(et=Ch(it),et!==null){if(_.flags|=128,tt=!0,_e=et.updateQueue,_e!==null&&(_.updateQueue=_e,_.flags|=4),Dj(rt,!0),rt.tail===null&&rt.tailMode==="hidden"&&!it.alternate&&!I)return S$1(_),null}else 2*B()-rt.renderingStartTime>Gj&&_e!==1073741824&&(_.flags|=128,tt=!0,Dj(rt,!1),_.lanes=4194304);rt.isBackwards?(it.sibling=_.child,_.child=it):(_e=rt.last,_e!==null?_e.sibling=it:_.child=it,rt.last=it)}return rt.tail!==null?(_=rt.tail,rt.rendering=_,rt.tail=_.sibling,rt.renderingStartTime=B(),_.sibling=null,_e=L.current,G(L,tt?_e&1|2:_e&1),_):(S$1(_),null);case 22:case 23:return Hj(),tt=_.memoizedState!==null,et!==null&&et.memoizedState!==null!==tt&&(_.flags|=8192),tt&&_.mode&1?fj&1073741824&&(S$1(_),_.subtreeFlags&6&&(_.flags|=8192)):S$1(_),null;case 24:return null;case 25:return null}throw Error(p$1(156,_.tag))}function Ij(et,_){switch(wg(_),_.tag){case 1:return Zf(_.type)&&$f(),et=_.flags,et&65536?(_.flags=et&-65537|128,_):null;case 3:return zh(),E(Wf),E(H$1),Eh(),et=_.flags,et&65536&&!(et&128)?(_.flags=et&-65537|128,_):null;case 5:return Bh(_),null;case 13:if(E(L),et=_.memoizedState,et!==null&&et.dehydrated!==null){if(_.alternate===null)throw Error(p$1(340));Ig()}return et=_.flags,et&65536?(_.flags=et&-65537|128,_):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(_.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(et,_){var _e=et.ref;if(_e!==null)if(typeof _e=="function")try{_e(null)}catch(tt){W(et,_,tt)}else _e.current=null}function Mj(et,_,_e){try{_e()}catch(tt){W(et,_,tt)}}var Nj=!1;function Oj(et,_){if(Cf=dd,et=Me(),Ne(et)){if("selectionStart"in et)var _e={start:et.selectionStart,end:et.selectionEnd};else e:{_e=(_e=et.ownerDocument)&&_e.defaultView||window;var tt=_e.getSelection&&_e.getSelection();if(tt&&tt.rangeCount!==0){_e=tt.anchorNode;var nt=tt.anchorOffset,rt=tt.focusNode;tt=tt.focusOffset;try{_e.nodeType,rt.nodeType}catch{_e=null;break e}var it=0,st=-1,ot=-1,at=0,lt=0,ct=et,ht=null;t:for(;;){for(var ut;ct!==_e||nt!==0&&ct.nodeType!==3||(st=it+nt),ct!==rt||tt!==0&&ct.nodeType!==3||(ot=it+tt),ct.nodeType===3&&(it+=ct.nodeValue.length),(ut=ct.firstChild)!==null;)ht=ct,ct=ut;for(;;){if(ct===et)break t;if(ht===_e&&++at===nt&&(st=it),ht===rt&&++lt===tt&&(ot=it),(ut=ct.nextSibling)!==null)break;ct=ht,ht=ct.parentNode}ct=ut}_e=st===-1||ot===-1?null:{start:st,end:ot}}else _e=null}_e=_e||{start:0,end:0}}else _e=null;for(Df={focusedElem:et,selectionRange:_e},dd=!1,V=_;V!==null;)if(_=V,et=_.child,(_.subtreeFlags&1028)!==0&&et!==null)et.return=_,V=et;else for(;V!==null;){_=V;try{var ft=_.alternate;if(_.flags&1024)switch(_.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var dt=ft.memoizedProps,pt=ft.memoizedState,mt=_.stateNode,vt=mt.getSnapshotBeforeUpdate(_.elementType===_.type?dt:Ci(_.type,dt),pt);mt.__reactInternalSnapshotBeforeUpdate=vt}break;case 3:var yt=_.stateNode.containerInfo;yt.nodeType===1?yt.textContent="":yt.nodeType===9&&yt.documentElement&&yt.removeChild(yt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(_t){W(_,_.return,_t)}if(et=_.sibling,et!==null){et.return=_.return,V=et;break}V=_.return}return ft=Nj,Nj=!1,ft}function Pj(et,_,_e){var tt=_.updateQueue;if(tt=tt!==null?tt.lastEffect:null,tt!==null){var nt=tt=tt.next;do{if((nt.tag&et)===et){var rt=nt.destroy;nt.destroy=void 0,rt!==void 0&&Mj(_,_e,rt)}nt=nt.next}while(nt!==tt)}}function Qj(et,_){if(_=_.updateQueue,_=_!==null?_.lastEffect:null,_!==null){var _e=_=_.next;do{if((_e.tag&et)===et){var tt=_e.create;_e.destroy=tt()}_e=_e.next}while(_e!==_)}}function Rj(et){var _=et.ref;if(_!==null){var _e=et.stateNode;switch(et.tag){case 5:et=_e;break;default:et=_e}typeof _=="function"?_(et):_.current=et}}function Sj(et){var _=et.alternate;_!==null&&(et.alternate=null,Sj(_)),et.child=null,et.deletions=null,et.sibling=null,et.tag===5&&(_=et.stateNode,_!==null&&(delete _[Of],delete _[Pf],delete _[of],delete _[Qf],delete _[Rf])),et.stateNode=null,et.return=null,et.dependencies=null,et.memoizedProps=null,et.memoizedState=null,et.pendingProps=null,et.stateNode=null,et.updateQueue=null}function Tj(et){return et.tag===5||et.tag===3||et.tag===4}function Uj(et){e:for(;;){for(;et.sibling===null;){if(et.return===null||Tj(et.return))return null;et=et.return}for(et.sibling.return=et.return,et=et.sibling;et.tag!==5&&et.tag!==6&&et.tag!==18;){if(et.flags&2||et.child===null||et.tag===4)continue e;et.child.return=et,et=et.child}if(!(et.flags&2))return et.stateNode}}function Vj(et,_,_e){var tt=et.tag;if(tt===5||tt===6)et=et.stateNode,_?_e.nodeType===8?_e.parentNode.insertBefore(et,_):_e.insertBefore(et,_):(_e.nodeType===8?(_=_e.parentNode,_.insertBefore(et,_e)):(_=_e,_.appendChild(et)),_e=_e._reactRootContainer,_e!=null||_.onclick!==null||(_.onclick=Bf));else if(tt!==4&&(et=et.child,et!==null))for(Vj(et,_,_e),et=et.sibling;et!==null;)Vj(et,_,_e),et=et.sibling}function Wj(et,_,_e){var tt=et.tag;if(tt===5||tt===6)et=et.stateNode,_?_e.insertBefore(et,_):_e.appendChild(et);else if(tt!==4&&(et=et.child,et!==null))for(Wj(et,_,_e),et=et.sibling;et!==null;)Wj(et,_,_e),et=et.sibling}var X=null,Xj=!1;function Yj(et,_,_e){for(_e=_e.child;_e!==null;)Zj(et,_,_e),_e=_e.sibling}function Zj(et,_,_e){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,_e)}catch{}switch(_e.tag){case 5:U||Lj(_e,_);case 6:var tt=X,nt=Xj;X=null,Yj(et,_,_e),X=tt,Xj=nt,X!==null&&(Xj?(et=X,_e=_e.stateNode,et.nodeType===8?et.parentNode.removeChild(_e):et.removeChild(_e)):X.removeChild(_e.stateNode));break;case 18:X!==null&&(Xj?(et=X,_e=_e.stateNode,et.nodeType===8?Kf(et.parentNode,_e):et.nodeType===1&&Kf(et,_e),bd(et)):Kf(X,_e.stateNode));break;case 4:tt=X,nt=Xj,X=_e.stateNode.containerInfo,Xj=!0,Yj(et,_,_e),X=tt,Xj=nt;break;case 0:case 11:case 14:case 15:if(!U&&(tt=_e.updateQueue,tt!==null&&(tt=tt.lastEffect,tt!==null))){nt=tt=tt.next;do{var rt=nt,it=rt.destroy;rt=rt.tag,it!==void 0&&(rt&2||rt&4)&&Mj(_e,_,it),nt=nt.next}while(nt!==tt)}Yj(et,_,_e);break;case 1:if(!U&&(Lj(_e,_),tt=_e.stateNode,typeof tt.componentWillUnmount=="function"))try{tt.props=_e.memoizedProps,tt.state=_e.memoizedState,tt.componentWillUnmount()}catch(st){W(_e,_,st)}Yj(et,_,_e);break;case 21:Yj(et,_,_e);break;case 22:_e.mode&1?(U=(tt=U)||_e.memoizedState!==null,Yj(et,_,_e),U=tt):Yj(et,_,_e);break;default:Yj(et,_,_e)}}function ak(et){var _=et.updateQueue;if(_!==null){et.updateQueue=null;var _e=et.stateNode;_e===null&&(_e=et.stateNode=new Kj),_.forEach(function(tt){var nt=bk.bind(null,et,tt);_e.has(tt)||(_e.add(tt),tt.then(nt,nt))})}}function ck(et,_){var _e=_.deletions;if(_e!==null)for(var tt=0;tt<_e.length;tt++){var nt=_e[tt];try{var rt=et,it=_,st=it;e:for(;st!==null;){switch(st.tag){case 5:X=st.stateNode,Xj=!1;break e;case 3:X=st.stateNode.containerInfo,Xj=!0;break e;case 4:X=st.stateNode.containerInfo,Xj=!0;break e}st=st.return}if(X===null)throw Error(p$1(160));Zj(rt,it,nt),X=null,Xj=!1;var ot=nt.alternate;ot!==null&&(ot.return=null),nt.return=null}catch(at){W(nt,_,at)}}if(_.subtreeFlags&12854)for(_=_.child;_!==null;)dk(_,et),_=_.sibling}function dk(et,_){var _e=et.alternate,tt=et.flags;switch(et.tag){case 0:case 11:case 14:case 15:if(ck(_,et),ek(et),tt&4){try{Pj(3,et,et.return),Qj(3,et)}catch(dt){W(et,et.return,dt)}try{Pj(5,et,et.return)}catch(dt){W(et,et.return,dt)}}break;case 1:ck(_,et),ek(et),tt&512&&_e!==null&&Lj(_e,_e.return);break;case 5:if(ck(_,et),ek(et),tt&512&&_e!==null&&Lj(_e,_e.return),et.flags&32){var nt=et.stateNode;try{ob(nt,"")}catch(dt){W(et,et.return,dt)}}if(tt&4&&(nt=et.stateNode,nt!=null)){var rt=et.memoizedProps,it=_e!==null?_e.memoizedProps:rt,st=et.type,ot=et.updateQueue;if(et.updateQueue=null,ot!==null)try{st==="input"&&rt.type==="radio"&&rt.name!=null&&ab(nt,rt),vb(st,it);var at=vb(st,rt);for(it=0;it<ot.length;it+=2){var lt=ot[it],ct=ot[it+1];lt==="style"?sb(nt,ct):lt==="dangerouslySetInnerHTML"?nb(nt,ct):lt==="children"?ob(nt,ct):ta(nt,lt,ct,at)}switch(st){case"input":bb(nt,rt);break;case"textarea":ib(nt,rt);break;case"select":var ht=nt._wrapperState.wasMultiple;nt._wrapperState.wasMultiple=!!rt.multiple;var ut=rt.value;ut!=null?fb(nt,!!rt.multiple,ut,!1):ht!==!!rt.multiple&&(rt.defaultValue!=null?fb(nt,!!rt.multiple,rt.defaultValue,!0):fb(nt,!!rt.multiple,rt.multiple?[]:"",!1))}nt[Pf]=rt}catch(dt){W(et,et.return,dt)}}break;case 6:if(ck(_,et),ek(et),tt&4){if(et.stateNode===null)throw Error(p$1(162));nt=et.stateNode,rt=et.memoizedProps;try{nt.nodeValue=rt}catch(dt){W(et,et.return,dt)}}break;case 3:if(ck(_,et),ek(et),tt&4&&_e!==null&&_e.memoizedState.isDehydrated)try{bd(_.containerInfo)}catch(dt){W(et,et.return,dt)}break;case 4:ck(_,et),ek(et);break;case 13:ck(_,et),ek(et),nt=et.child,nt.flags&8192&&(rt=nt.memoizedState!==null,nt.stateNode.isHidden=rt,!rt||nt.alternate!==null&&nt.alternate.memoizedState!==null||(fk=B())),tt&4&&ak(et);break;case 22:if(lt=_e!==null&&_e.memoizedState!==null,et.mode&1?(U=(at=U)||lt,ck(_,et),U=at):ck(_,et),ek(et),tt&8192){if(at=et.memoizedState!==null,(et.stateNode.isHidden=at)&&!lt&&et.mode&1)for(V=et,lt=et.child;lt!==null;){for(ct=V=lt;V!==null;){switch(ht=V,ut=ht.child,ht.tag){case 0:case 11:case 14:case 15:Pj(4,ht,ht.return);break;case 1:Lj(ht,ht.return);var ft=ht.stateNode;if(typeof ft.componentWillUnmount=="function"){tt=ht,_e=ht.return;try{_=tt,ft.props=_.memoizedProps,ft.state=_.memoizedState,ft.componentWillUnmount()}catch(dt){W(tt,_e,dt)}}break;case 5:Lj(ht,ht.return);break;case 22:if(ht.memoizedState!==null){gk(ct);continue}}ut!==null?(ut.return=ht,V=ut):gk(ct)}lt=lt.sibling}e:for(lt=null,ct=et;;){if(ct.tag===5){if(lt===null){lt=ct;try{nt=ct.stateNode,at?(rt=nt.style,typeof rt.setProperty=="function"?rt.setProperty("display","none","important"):rt.display="none"):(st=ct.stateNode,ot=ct.memoizedProps.style,it=ot!=null&&ot.hasOwnProperty("display")?ot.display:null,st.style.display=rb("display",it))}catch(dt){W(et,et.return,dt)}}}else if(ct.tag===6){if(lt===null)try{ct.stateNode.nodeValue=at?"":ct.memoizedProps}catch(dt){W(et,et.return,dt)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===et)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===et)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===et)break e;lt===ct&&(lt=null),ct=ct.return}lt===ct&&(lt=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:ck(_,et),ek(et),tt&4&&ak(et);break;case 21:break;default:ck(_,et),ek(et)}}function ek(et){var _=et.flags;if(_&2){try{e:{for(var _e=et.return;_e!==null;){if(Tj(_e)){var tt=_e;break e}_e=_e.return}throw Error(p$1(160))}switch(tt.tag){case 5:var nt=tt.stateNode;tt.flags&32&&(ob(nt,""),tt.flags&=-33);var rt=Uj(et);Wj(et,rt,nt);break;case 3:case 4:var it=tt.stateNode.containerInfo,st=Uj(et);Vj(et,st,it);break;default:throw Error(p$1(161))}}catch(ot){W(et,et.return,ot)}et.flags&=-3}_&4096&&(et.flags&=-4097)}function hk(et,_,_e){V=et,ik(et)}function ik(et,_,_e){for(var tt=(et.mode&1)!==0;V!==null;){var nt=V,rt=nt.child;if(nt.tag===22&&tt){var it=nt.memoizedState!==null||Jj;if(!it){var st=nt.alternate,ot=st!==null&&st.memoizedState!==null||U;st=Jj;var at=U;if(Jj=it,(U=ot)&&!at)for(V=nt;V!==null;)it=V,ot=it.child,it.tag===22&&it.memoizedState!==null?jk(nt):ot!==null?(ot.return=it,V=ot):jk(nt);for(;rt!==null;)V=rt,ik(rt),rt=rt.sibling;V=nt,Jj=st,U=at}kk(et)}else nt.subtreeFlags&8772&&rt!==null?(rt.return=nt,V=rt):kk(et)}}function kk(et){for(;V!==null;){var _=V;if(_.flags&8772){var _e=_.alternate;try{if(_.flags&8772)switch(_.tag){case 0:case 11:case 15:U||Qj(5,_);break;case 1:var tt=_.stateNode;if(_.flags&4&&!U)if(_e===null)tt.componentDidMount();else{var nt=_.elementType===_.type?_e.memoizedProps:Ci(_.type,_e.memoizedProps);tt.componentDidUpdate(nt,_e.memoizedState,tt.__reactInternalSnapshotBeforeUpdate)}var rt=_.updateQueue;rt!==null&&sh(_,rt,tt);break;case 3:var it=_.updateQueue;if(it!==null){if(_e=null,_.child!==null)switch(_.child.tag){case 5:_e=_.child.stateNode;break;case 1:_e=_.child.stateNode}sh(_,it,_e)}break;case 5:var st=_.stateNode;if(_e===null&&_.flags&4){_e=st;var ot=_.memoizedProps;switch(_.type){case"button":case"input":case"select":case"textarea":ot.autoFocus&&_e.focus();break;case"img":ot.src&&(_e.src=ot.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_.memoizedState===null){var at=_.alternate;if(at!==null){var lt=at.memoizedState;if(lt!==null){var ct=lt.dehydrated;ct!==null&&bd(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||_.flags&512&&Rj(_)}catch(ht){W(_,_.return,ht)}}if(_===et){V=null;break}if(_e=_.sibling,_e!==null){_e.return=_.return,V=_e;break}V=_.return}}function gk(et){for(;V!==null;){var _=V;if(_===et){V=null;break}var _e=_.sibling;if(_e!==null){_e.return=_.return,V=_e;break}V=_.return}}function jk(et){for(;V!==null;){var _=V;try{switch(_.tag){case 0:case 11:case 15:var _e=_.return;try{Qj(4,_)}catch(ot){W(_,_e,ot)}break;case 1:var tt=_.stateNode;if(typeof tt.componentDidMount=="function"){var nt=_.return;try{tt.componentDidMount()}catch(ot){W(_,nt,ot)}}var rt=_.return;try{Rj(_)}catch(ot){W(_,rt,ot)}break;case 5:var it=_.return;try{Rj(_)}catch(ot){W(_,it,ot)}}}catch(ot){W(_,_.return,ot)}if(_===et){V=null;break}var st=_.sibling;if(st!==null){st.return=_.return,V=st;break}V=_.return}}var lk=Math.ceil,mk=ua$1.ReactCurrentDispatcher,nk=ua$1.ReactCurrentOwner,ok=ua$1.ReactCurrentBatchConfig,K$1=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K$1&6?B():Ak!==-1?Ak:Ak=B()}function yi(et){return et.mode&1?K$1&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(et=C,et!==0||(et=window.event,et=et===void 0?16:jd(et.type)),et):1}function gi(et,_,_e,tt){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(et,_e,tt),(!(K$1&2)||et!==Q)&&(et===Q&&(!(K$1&2)&&(qk|=_e),T===4&&Ck(et,Z)),Dk(et,tt),_e===1&&K$1===0&&!(_.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(et,_){var _e=et.callbackNode;wc(et,_);var tt=uc(et,et===Q?Z:0);if(tt===0)_e!==null&&bc(_e),et.callbackNode=null,et.callbackPriority=0;else if(_=tt&-tt,et.callbackPriority!==_){if(_e!=null&&bc(_e),_===1)et.tag===0?ig(Ek.bind(null,et)):hg(Ek.bind(null,et)),Jf(function(){!(K$1&6)&&jg()}),_e=null;else{switch(Dc(tt)){case 1:_e=fc;break;case 4:_e=gc;break;case 16:_e=hc;break;case 536870912:_e=jc;break;default:_e=hc}_e=Fk(_e,Gk.bind(null,et))}et.callbackPriority=_,et.callbackNode=_e}}function Gk(et,_){if(Ak=-1,Bk=0,K$1&6)throw Error(p$1(327));var _e=et.callbackNode;if(Hk()&&et.callbackNode!==_e)return null;var tt=uc(et,et===Q?Z:0);if(tt===0)return null;if(tt&30||tt&et.expiredLanes||_)_=Ik(et,tt);else{_=tt;var nt=K$1;K$1|=2;var rt=Jk();(Q!==et||Z!==_)&&(uk=null,Gj=B()+500,Kk(et,_));do try{Lk();break}catch(st){Mk(et,st)}while(!0);$g(),mk.current=rt,K$1=nt,Y!==null?_=0:(Q=null,Z=0,_=T)}if(_!==0){if(_===2&&(nt=xc(et),nt!==0&&(tt=nt,_=Nk(et,nt))),_===1)throw _e=pk,Kk(et,0),Ck(et,tt),Dk(et,B()),_e;if(_===6)Ck(et,tt);else{if(nt=et.current.alternate,!(tt&30)&&!Ok(nt)&&(_=Ik(et,tt),_===2&&(rt=xc(et),rt!==0&&(tt=rt,_=Nk(et,rt))),_===1))throw _e=pk,Kk(et,0),Ck(et,tt),Dk(et,B()),_e;switch(et.finishedWork=nt,et.finishedLanes=tt,_){case 0:case 1:throw Error(p$1(345));case 2:Pk(et,tk,uk);break;case 3:if(Ck(et,tt),(tt&130023424)===tt&&(_=fk+500-B(),10<_)){if(uc(et,0)!==0)break;if(nt=et.suspendedLanes,(nt&tt)!==tt){R(),et.pingedLanes|=et.suspendedLanes&nt;break}et.timeoutHandle=Ff(Pk.bind(null,et,tk,uk),_);break}Pk(et,tk,uk);break;case 4:if(Ck(et,tt),(tt&4194240)===tt)break;for(_=et.eventTimes,nt=-1;0<tt;){var it=31-oc(tt);rt=1<<it,it=_[it],it>nt&&(nt=it),tt&=~rt}if(tt=nt,tt=B()-tt,tt=(120>tt?120:480>tt?480:1080>tt?1080:1920>tt?1920:3e3>tt?3e3:4320>tt?4320:1960*lk(tt/1960))-tt,10<tt){et.timeoutHandle=Ff(Pk.bind(null,et,tk,uk),tt);break}Pk(et,tk,uk);break;case 5:Pk(et,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(et,B()),et.callbackNode===_e?Gk.bind(null,et):null}function Nk(et,_){var _e=sk;return et.current.memoizedState.isDehydrated&&(Kk(et,_).flags|=256),et=Ik(et,_),et!==2&&(_=tk,tk=_e,_!==null&&Fj(_)),et}function Fj(et){tk===null?tk=et:tk.push.apply(tk,et)}function Ok(et){for(var _=et;;){if(_.flags&16384){var _e=_.updateQueue;if(_e!==null&&(_e=_e.stores,_e!==null))for(var tt=0;tt<_e.length;tt++){var nt=_e[tt],rt=nt.getSnapshot;nt=nt.value;try{if(!He(rt(),nt))return!1}catch{return!1}}}if(_e=_.child,_.subtreeFlags&16384&&_e!==null)_e.return=_,_=_e;else{if(_===et)break;for(;_.sibling===null;){if(_.return===null||_.return===et)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Ck(et,_){for(_&=~rk,_&=~qk,et.suspendedLanes|=_,et.pingedLanes&=~_,et=et.expirationTimes;0<_;){var _e=31-oc(_),tt=1<<_e;et[_e]=-1,_&=~tt}}function Ek(et){if(K$1&6)throw Error(p$1(327));Hk();var _=uc(et,0);if(!(_&1))return Dk(et,B()),null;var _e=Ik(et,_);if(et.tag!==0&&_e===2){var tt=xc(et);tt!==0&&(_=tt,_e=Nk(et,tt))}if(_e===1)throw _e=pk,Kk(et,0),Ck(et,_),Dk(et,B()),_e;if(_e===6)throw Error(p$1(345));return et.finishedWork=et.current.alternate,et.finishedLanes=_,Pk(et,tk,uk),Dk(et,B()),null}function Qk(et,_){var _e=K$1;K$1|=1;try{return et(_)}finally{K$1=_e,K$1===0&&(Gj=B()+500,fg&&jg())}}function Rk(et){wk!==null&&wk.tag===0&&!(K$1&6)&&Hk();var _=K$1;K$1|=1;var _e=ok.transition,tt=C;try{if(ok.transition=null,C=1,et)return et()}finally{C=tt,ok.transition=_e,K$1=_,!(K$1&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(et,_){et.finishedWork=null,et.finishedLanes=0;var _e=et.timeoutHandle;if(_e!==-1&&(et.timeoutHandle=-1,Gf(_e)),Y!==null)for(_e=Y.return;_e!==null;){var tt=_e;switch(wg(tt),tt.tag){case 1:tt=tt.type.childContextTypes,tt!=null&&$f();break;case 3:zh(),E(Wf),E(H$1),Eh();break;case 5:Bh(tt);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(tt.type._context);break;case 22:case 23:Hj()}_e=_e.return}if(Q=et,Y=et=Pg(et.current,null),Z=fj=_,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(_=0;_<fh.length;_++)if(_e=fh[_],tt=_e.interleaved,tt!==null){_e.interleaved=null;var nt=tt.next,rt=_e.pending;if(rt!==null){var it=rt.next;rt.next=nt,tt.next=it}_e.pending=tt}fh=null}return et}function Mk(et,_){do{var _e=Y;try{if($g(),Fh.current=Rh,Ih){for(var tt=M$1.memoizedState;tt!==null;){var nt=tt.queue;nt!==null&&(nt.pending=null),tt=tt.next}Ih=!1}if(Hh=0,O=N$1=M$1=null,Jh=!1,Kh=0,nk.current=null,_e===null||_e.return===null){T=1,pk=_,Y=null;break}e:{var rt=et,it=_e.return,st=_e,ot=_;if(_=Z,st.flags|=32768,ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var at=ot,lt=st,ct=lt.tag;if(!(lt.mode&1)&&(ct===0||ct===11||ct===15)){var ht=lt.alternate;ht?(lt.updateQueue=ht.updateQueue,lt.memoizedState=ht.memoizedState,lt.lanes=ht.lanes):(lt.updateQueue=null,lt.memoizedState=null)}var ut=Ui(it);if(ut!==null){ut.flags&=-257,Vi(ut,it,st,rt,_),ut.mode&1&&Si(rt,at,_),_=ut,ot=at;var ft=_.updateQueue;if(ft===null){var dt=new Set;dt.add(ot),_.updateQueue=dt}else ft.add(ot);break e}else{if(!(_&1)){Si(rt,at,_),tj();break e}ot=Error(p$1(426))}}else if(I&&st.mode&1){var pt=Ui(it);if(pt!==null){!(pt.flags&65536)&&(pt.flags|=256),Vi(pt,it,st,rt,_),Jg(Ji(ot,st));break e}}rt=ot=Ji(ot,st),T!==4&&(T=2),sk===null?sk=[rt]:sk.push(rt),rt=it;do{switch(rt.tag){case 3:rt.flags|=65536,_&=-_,rt.lanes|=_;var mt=Ni(rt,ot,_);ph(rt,mt);break e;case 1:st=ot;var vt=rt.type,yt=rt.stateNode;if(!(rt.flags&128)&&(typeof vt.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Ri===null||!Ri.has(yt)))){rt.flags|=65536,_&=-_,rt.lanes|=_;var _t=Qi(rt,st,_);ph(rt,_t);break e}}rt=rt.return}while(rt!==null)}Sk(_e)}catch(St){_=St,Y===_e&&_e!==null&&(Y=_e=_e.return);continue}break}while(!0)}function Jk(){var et=mk.current;return mk.current=Rh,et===null?Rh:et}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(et,_){var _e=K$1;K$1|=2;var tt=Jk();(Q!==et||Z!==_)&&(uk=null,Kk(et,_));do try{Tk();break}catch(nt){Mk(et,nt)}while(!0);if($g(),K$1=_e,mk.current=tt,Y!==null)throw Error(p$1(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(et){var _=Vk(et.alternate,et,fj);et.memoizedProps=et.pendingProps,_===null?Sk(et):Y=_,nk.current=null}function Sk(et){var _=et;do{var _e=_.alternate;if(et=_.return,_.flags&32768){if(_e=Ij(_e,_),_e!==null){_e.flags&=32767,Y=_e;return}if(et!==null)et.flags|=32768,et.subtreeFlags=0,et.deletions=null;else{T=6,Y=null;return}}else if(_e=Ej(_e,_,fj),_e!==null){Y=_e;return}if(_=_.sibling,_!==null){Y=_;return}Y=_=et}while(_!==null);T===0&&(T=5)}function Pk(et,_,_e){var tt=C,nt=ok.transition;try{ok.transition=null,C=1,Wk(et,_,_e,tt)}finally{ok.transition=nt,C=tt}return null}function Wk(et,_,_e,tt){do Hk();while(wk!==null);if(K$1&6)throw Error(p$1(327));_e=et.finishedWork;var nt=et.finishedLanes;if(_e===null)return null;if(et.finishedWork=null,et.finishedLanes=0,_e===et.current)throw Error(p$1(177));et.callbackNode=null,et.callbackPriority=0;var rt=_e.lanes|_e.childLanes;if(Bc(et,rt),et===Q&&(Y=Q=null,Z=0),!(_e.subtreeFlags&2064)&&!(_e.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),rt=(_e.flags&15990)!==0,_e.subtreeFlags&15990||rt){rt=ok.transition,ok.transition=null;var it=C;C=1;var st=K$1;K$1|=4,nk.current=null,Oj(et,_e),dk(_e,et),Oe(Df),dd=!!Cf,Df=Cf=null,et.current=_e,hk(_e),dc(),K$1=st,C=it,ok.transition=rt}else et.current=_e;if(vk&&(vk=!1,wk=et,xk=nt),rt=et.pendingLanes,rt===0&&(Ri=null),mc(_e.stateNode),Dk(et,B()),_!==null)for(tt=et.onRecoverableError,_e=0;_e<_.length;_e++)nt=_[_e],tt(nt.value,{componentStack:nt.stack,digest:nt.digest});if(Oi)throw Oi=!1,et=Pi,Pi=null,et;return xk&1&&et.tag!==0&&Hk(),rt=et.pendingLanes,rt&1?et===zk?yk++:(yk=0,zk=et):yk=0,jg(),null}function Hk(){if(wk!==null){var et=Dc(xk),_=ok.transition,_e=C;try{if(ok.transition=null,C=16>et?16:et,wk===null)var tt=!1;else{if(et=wk,wk=null,xk=0,K$1&6)throw Error(p$1(331));var nt=K$1;for(K$1|=4,V=et.current;V!==null;){var rt=V,it=rt.child;if(V.flags&16){var st=rt.deletions;if(st!==null){for(var ot=0;ot<st.length;ot++){var at=st[ot];for(V=at;V!==null;){var lt=V;switch(lt.tag){case 0:case 11:case 15:Pj(8,lt,rt)}var ct=lt.child;if(ct!==null)ct.return=lt,V=ct;else for(;V!==null;){lt=V;var ht=lt.sibling,ut=lt.return;if(Sj(lt),lt===at){V=null;break}if(ht!==null){ht.return=ut,V=ht;break}V=ut}}}var ft=rt.alternate;if(ft!==null){var dt=ft.child;if(dt!==null){ft.child=null;do{var pt=dt.sibling;dt.sibling=null,dt=pt}while(dt!==null)}}V=rt}}if(rt.subtreeFlags&2064&&it!==null)it.return=rt,V=it;else e:for(;V!==null;){if(rt=V,rt.flags&2048)switch(rt.tag){case 0:case 11:case 15:Pj(9,rt,rt.return)}var mt=rt.sibling;if(mt!==null){mt.return=rt.return,V=mt;break e}V=rt.return}}var vt=et.current;for(V=vt;V!==null;){it=V;var yt=it.child;if(it.subtreeFlags&2064&&yt!==null)yt.return=it,V=yt;else e:for(it=vt;V!==null;){if(st=V,st.flags&2048)try{switch(st.tag){case 0:case 11:case 15:Qj(9,st)}}catch(St){W(st,st.return,St)}if(st===it){V=null;break e}var _t=st.sibling;if(_t!==null){_t.return=st.return,V=_t;break e}V=st.return}}if(K$1=nt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,et)}catch{}tt=!0}return tt}finally{C=_e,ok.transition=_}}return!1}function Xk(et,_,_e){_=Ji(_e,_),_=Ni(et,_,1),et=nh(et,_,1),_=R(),et!==null&&(Ac(et,1,_),Dk(et,_))}function W(et,_,_e){if(et.tag===3)Xk(et,et,_e);else for(;_!==null;){if(_.tag===3){Xk(_,et,_e);break}else if(_.tag===1){var tt=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof tt.componentDidCatch=="function"&&(Ri===null||!Ri.has(tt))){et=Ji(_e,et),et=Qi(_,et,1),_=nh(_,et,1),et=R(),_!==null&&(Ac(_,1,et),Dk(_,et));break}}_=_.return}}function Ti(et,_,_e){var tt=et.pingCache;tt!==null&&tt.delete(_),_=R(),et.pingedLanes|=et.suspendedLanes&_e,Q===et&&(Z&_e)===_e&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(et,0):rk|=_e),Dk(et,_)}function Yk(et,_){_===0&&(et.mode&1?(_=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):_=1);var _e=R();et=ih(et,_),et!==null&&(Ac(et,_,_e),Dk(et,_e))}function uj(et){var _=et.memoizedState,_e=0;_!==null&&(_e=_.retryLane),Yk(et,_e)}function bk(et,_){var _e=0;switch(et.tag){case 13:var tt=et.stateNode,nt=et.memoizedState;nt!==null&&(_e=nt.retryLane);break;case 19:tt=et.stateNode;break;default:throw Error(p$1(314))}tt!==null&&tt.delete(_),Yk(et,_e)}var Vk;Vk=function(et,_,_e){if(et!==null)if(et.memoizedProps!==_.pendingProps||Wf.current)dh=!0;else{if(!(et.lanes&_e)&&!(_.flags&128))return dh=!1,yj(et,_,_e);dh=!!(et.flags&131072)}else dh=!1,I&&_.flags&1048576&&ug(_,ng,_.index);switch(_.lanes=0,_.tag){case 2:var tt=_.type;ij(et,_),et=_.pendingProps;var nt=Yf(_,H$1.current);ch(_,_e),nt=Nh(null,_,tt,et,nt,_e);var rt=Sh();return _.flags|=1,typeof nt=="object"&&nt!==null&&typeof nt.render=="function"&&nt.$$typeof===void 0?(_.tag=1,_.memoizedState=null,_.updateQueue=null,Zf(tt)?(rt=!0,cg(_)):rt=!1,_.memoizedState=nt.state!==null&&nt.state!==void 0?nt.state:null,kh(_),nt.updater=Ei,_.stateNode=nt,nt._reactInternals=_,Ii(_,tt,et,_e),_=jj(null,_,tt,!0,rt,_e)):(_.tag=0,I&&rt&&vg(_),Xi(null,_,nt,_e),_=_.child),_;case 16:tt=_.elementType;e:{switch(ij(et,_),et=_.pendingProps,nt=tt._init,tt=nt(tt._payload),_.type=tt,nt=_.tag=Zk(tt),et=Ci(tt,et),nt){case 0:_=cj(null,_,tt,et,_e);break e;case 1:_=hj(null,_,tt,et,_e);break e;case 11:_=Yi(null,_,tt,et,_e);break e;case 14:_=$i(null,_,tt,Ci(tt.type,et),_e);break e}throw Error(p$1(306,tt,""))}return _;case 0:return tt=_.type,nt=_.pendingProps,nt=_.elementType===tt?nt:Ci(tt,nt),cj(et,_,tt,nt,_e);case 1:return tt=_.type,nt=_.pendingProps,nt=_.elementType===tt?nt:Ci(tt,nt),hj(et,_,tt,nt,_e);case 3:e:{if(kj(_),et===null)throw Error(p$1(387));tt=_.pendingProps,rt=_.memoizedState,nt=rt.element,lh(et,_),qh(_,tt,null,_e);var it=_.memoizedState;if(tt=it.element,rt.isDehydrated)if(rt={element:tt,isDehydrated:!1,cache:it.cache,pendingSuspenseBoundaries:it.pendingSuspenseBoundaries,transitions:it.transitions},_.updateQueue.baseState=rt,_.memoizedState=rt,_.flags&256){nt=Ji(Error(p$1(423)),_),_=lj(et,_,tt,_e,nt);break e}else if(tt!==nt){nt=Ji(Error(p$1(424)),_),_=lj(et,_,tt,_e,nt);break e}else for(yg=Lf(_.stateNode.containerInfo.firstChild),xg=_,I=!0,zg=null,_e=Vg(_,null,tt,_e),_.child=_e;_e;)_e.flags=_e.flags&-3|4096,_e=_e.sibling;else{if(Ig(),tt===nt){_=Zi(et,_,_e);break e}Xi(et,_,tt,_e)}_=_.child}return _;case 5:return Ah(_),et===null&&Eg(_),tt=_.type,nt=_.pendingProps,rt=et!==null?et.memoizedProps:null,it=nt.children,Ef(tt,nt)?it=null:rt!==null&&Ef(tt,rt)&&(_.flags|=32),gj(et,_),Xi(et,_,it,_e),_.child;case 6:return et===null&&Eg(_),null;case 13:return oj(et,_,_e);case 4:return yh(_,_.stateNode.containerInfo),tt=_.pendingProps,et===null?_.child=Ug(_,null,tt,_e):Xi(et,_,tt,_e),_.child;case 11:return tt=_.type,nt=_.pendingProps,nt=_.elementType===tt?nt:Ci(tt,nt),Yi(et,_,tt,nt,_e);case 7:return Xi(et,_,_.pendingProps,_e),_.child;case 8:return Xi(et,_,_.pendingProps.children,_e),_.child;case 12:return Xi(et,_,_.pendingProps.children,_e),_.child;case 10:e:{if(tt=_.type._context,nt=_.pendingProps,rt=_.memoizedProps,it=nt.value,G(Wg,tt._currentValue),tt._currentValue=it,rt!==null)if(He(rt.value,it)){if(rt.children===nt.children&&!Wf.current){_=Zi(et,_,_e);break e}}else for(rt=_.child,rt!==null&&(rt.return=_);rt!==null;){var st=rt.dependencies;if(st!==null){it=rt.child;for(var ot=st.firstContext;ot!==null;){if(ot.context===tt){if(rt.tag===1){ot=mh(-1,_e&-_e),ot.tag=2;var at=rt.updateQueue;if(at!==null){at=at.shared;var lt=at.pending;lt===null?ot.next=ot:(ot.next=lt.next,lt.next=ot),at.pending=ot}}rt.lanes|=_e,ot=rt.alternate,ot!==null&&(ot.lanes|=_e),bh(rt.return,_e,_),st.lanes|=_e;break}ot=ot.next}}else if(rt.tag===10)it=rt.type===_.type?null:rt.child;else if(rt.tag===18){if(it=rt.return,it===null)throw Error(p$1(341));it.lanes|=_e,st=it.alternate,st!==null&&(st.lanes|=_e),bh(it,_e,_),it=rt.sibling}else it=rt.child;if(it!==null)it.return=rt;else for(it=rt;it!==null;){if(it===_){it=null;break}if(rt=it.sibling,rt!==null){rt.return=it.return,it=rt;break}it=it.return}rt=it}Xi(et,_,nt.children,_e),_=_.child}return _;case 9:return nt=_.type,tt=_.pendingProps.children,ch(_,_e),nt=eh(nt),tt=tt(nt),_.flags|=1,Xi(et,_,tt,_e),_.child;case 14:return tt=_.type,nt=Ci(tt,_.pendingProps),nt=Ci(tt.type,nt),$i(et,_,tt,nt,_e);case 15:return bj(et,_,_.type,_.pendingProps,_e);case 17:return tt=_.type,nt=_.pendingProps,nt=_.elementType===tt?nt:Ci(tt,nt),ij(et,_),_.tag=1,Zf(tt)?(et=!0,cg(_)):et=!1,ch(_,_e),Gi(_,tt,nt),Ii(_,tt,nt,_e),jj(null,_,tt,!0,et,_e);case 19:return xj(et,_,_e);case 22:return dj(et,_,_e)}throw Error(p$1(156,_.tag))};function Fk(et,_){return ac(et,_)}function $k(et,_,_e,tt){this.tag=et,this.key=_e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=tt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(et,_,_e,tt){return new $k(et,_,_e,tt)}function aj(et){return et=et.prototype,!(!et||!et.isReactComponent)}function Zk(et){if(typeof et=="function")return aj(et)?1:0;if(et!=null){if(et=et.$$typeof,et===Da)return 11;if(et===Ga)return 14}return 2}function Pg(et,_){var _e=et.alternate;return _e===null?(_e=Bg(et.tag,_,et.key,et.mode),_e.elementType=et.elementType,_e.type=et.type,_e.stateNode=et.stateNode,_e.alternate=et,et.alternate=_e):(_e.pendingProps=_,_e.type=et.type,_e.flags=0,_e.subtreeFlags=0,_e.deletions=null),_e.flags=et.flags&14680064,_e.childLanes=et.childLanes,_e.lanes=et.lanes,_e.child=et.child,_e.memoizedProps=et.memoizedProps,_e.memoizedState=et.memoizedState,_e.updateQueue=et.updateQueue,_=et.dependencies,_e.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},_e.sibling=et.sibling,_e.index=et.index,_e.ref=et.ref,_e}function Rg(et,_,_e,tt,nt,rt){var it=2;if(tt=et,typeof et=="function")aj(et)&&(it=1);else if(typeof et=="string")it=5;else e:switch(et){case ya:return Tg(_e.children,nt,rt,_);case za:it=8,nt|=8;break;case Aa:return et=Bg(12,_e,_,nt|2),et.elementType=Aa,et.lanes=rt,et;case Ea:return et=Bg(13,_e,_,nt),et.elementType=Ea,et.lanes=rt,et;case Fa:return et=Bg(19,_e,_,nt),et.elementType=Fa,et.lanes=rt,et;case Ia:return pj(_e,nt,rt,_);default:if(typeof et=="object"&&et!==null)switch(et.$$typeof){case Ba:it=10;break e;case Ca:it=9;break e;case Da:it=11;break e;case Ga:it=14;break e;case Ha:it=16,tt=null;break e}throw Error(p$1(130,et==null?et:typeof et,""))}return _=Bg(it,_e,_,nt),_.elementType=et,_.type=tt,_.lanes=rt,_}function Tg(et,_,_e,tt){return et=Bg(7,et,tt,_),et.lanes=_e,et}function pj(et,_,_e,tt){return et=Bg(22,et,tt,_),et.elementType=Ia,et.lanes=_e,et.stateNode={isHidden:!1},et}function Qg(et,_,_e){return et=Bg(6,et,null,_),et.lanes=_e,et}function Sg(et,_,_e){return _=Bg(4,et.children!==null?et.children:[],et.key,_),_.lanes=_e,_.stateNode={containerInfo:et.containerInfo,pendingChildren:null,implementation:et.implementation},_}function al(et,_,_e,tt,nt){this.tag=_,this.containerInfo=et,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=tt,this.onRecoverableError=nt,this.mutableSourceEagerHydrationData=null}function bl(et,_,_e,tt,nt,rt,it,st,ot){return et=new al(et,_,_e,st,ot),_===1?(_=1,rt===!0&&(_|=8)):_=0,rt=Bg(3,null,null,_),et.current=rt,rt.stateNode=et,rt.memoizedState={element:tt,isDehydrated:_e,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(rt),et}function cl(et,_,_e){var tt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:tt==null?null:""+tt,children:et,containerInfo:_,implementation:_e}}function dl(et){if(!et)return Vf;et=et._reactInternals;e:{if(Vb(et)!==et||et.tag!==1)throw Error(p$1(170));var _=et;do{switch(_.tag){case 3:_=_.stateNode.context;break e;case 1:if(Zf(_.type)){_=_.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_=_.return}while(_!==null);throw Error(p$1(171))}if(et.tag===1){var _e=et.type;if(Zf(_e))return bg(et,_e,_)}return _}function el(et,_,_e,tt,nt,rt,it,st,ot){return et=bl(_e,tt,!0,et,nt,rt,it,st,ot),et.context=dl(null),_e=et.current,tt=R(),nt=yi(_e),rt=mh(tt,nt),rt.callback=_??null,nh(_e,rt,nt),et.current.lanes=nt,Ac(et,nt,tt),Dk(et,tt),et}function fl(et,_,_e,tt){var nt=_.current,rt=R(),it=yi(nt);return _e=dl(_e),_.context===null?_.context=_e:_.pendingContext=_e,_=mh(rt,it),_.payload={element:et},tt=tt===void 0?null:tt,tt!==null&&(_.callback=tt),et=nh(nt,_,it),et!==null&&(gi(et,nt,it,rt),oh(et,nt,it)),it}function gl(et){if(et=et.current,!et.child)return null;switch(et.child.tag){case 5:return et.child.stateNode;default:return et.child.stateNode}}function hl(et,_){if(et=et.memoizedState,et!==null&&et.dehydrated!==null){var _e=et.retryLane;et.retryLane=_e!==0&&_e<_?_e:_}}function il(et,_){hl(et,_),(et=et.alternate)&&hl(et,_)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(et){console.error(et)};function ll(et){this._internalRoot=et}ml.prototype.render=ll.prototype.render=function(et){var _=this._internalRoot;if(_===null)throw Error(p$1(409));fl(et,_,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var et=this._internalRoot;if(et!==null){this._internalRoot=null;var _=et.containerInfo;Rk(function(){fl(null,et,null,null)}),_[uf]=null}};function ml(et){this._internalRoot=et}ml.prototype.unstable_scheduleHydration=function(et){if(et){var _=Hc();et={blockedOn:null,target:et,priority:_};for(var _e=0;_e<Qc.length&&_!==0&&_<Qc[_e].priority;_e++);Qc.splice(_e,0,et),_e===0&&Vc(et)}};function nl(et){return!(!et||et.nodeType!==1&&et.nodeType!==9&&et.nodeType!==11)}function ol(et){return!(!et||et.nodeType!==1&&et.nodeType!==9&&et.nodeType!==11&&(et.nodeType!==8||et.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(et,_,_e,tt,nt){if(nt){if(typeof tt=="function"){var rt=tt;tt=function(){var at=gl(it);rt.call(at)}}var it=el(_,tt,et,0,null,!1,!1,"",pl);return et._reactRootContainer=it,et[uf]=it.current,sf(et.nodeType===8?et.parentNode:et),Rk(),it}for(;nt=et.lastChild;)et.removeChild(nt);if(typeof tt=="function"){var st=tt;tt=function(){var at=gl(ot);st.call(at)}}var ot=bl(et,0,!1,null,null,!1,!1,"",pl);return et._reactRootContainer=ot,et[uf]=ot.current,sf(et.nodeType===8?et.parentNode:et),Rk(function(){fl(_,ot,_e,tt)}),ot}function rl(et,_,_e,tt,nt){var rt=_e._reactRootContainer;if(rt){var it=rt;if(typeof nt=="function"){var st=nt;nt=function(){var ot=gl(it);st.call(ot)}}fl(_,it,et,nt)}else it=ql(_e,_,et,nt,tt);return gl(it)}Ec=function(et){switch(et.tag){case 3:var _=et.stateNode;if(_.current.memoizedState.isDehydrated){var _e=tc(_.pendingLanes);_e!==0&&(Cc(_,_e|1),Dk(_,B()),!(K$1&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var tt=ih(et,1);if(tt!==null){var nt=R();gi(tt,et,1,nt)}}),il(et,1)}};Fc=function(et){if(et.tag===13){var _=ih(et,134217728);if(_!==null){var _e=R();gi(_,et,134217728,_e)}il(et,134217728)}};Gc=function(et){if(et.tag===13){var _=yi(et),_e=ih(et,_);if(_e!==null){var tt=R();gi(_e,et,_,tt)}il(et,_)}};Hc=function(){return C};Ic=function(et,_){var _e=C;try{return C=et,_()}finally{C=_e}};yb=function(et,_,_e){switch(_){case"input":if(bb(et,_e),_=_e.name,_e.type==="radio"&&_!=null){for(_e=et;_e.parentNode;)_e=_e.parentNode;for(_e=_e.querySelectorAll("input[name="+JSON.stringify(""+_)+'][type="radio"]'),_=0;_<_e.length;_++){var tt=_e[_];if(tt!==et&&tt.form===et.form){var nt=Db(tt);if(!nt)throw Error(p$1(90));Wa(tt),bb(tt,nt)}}}break;case"textarea":ib(et,_e);break;case"select":_=_e.value,_!=null&&fb(et,!!_e.multiple,_,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(et){return et=Zb(et),et===null?null:et.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(et,_){var _e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(_))throw Error(p$1(200));return cl(et,_,null,_e)};reactDom_production_min.createRoot=function(et,_){if(!nl(et))throw Error(p$1(299));var _e=!1,tt="",nt=kl;return _!=null&&(_.unstable_strictMode===!0&&(_e=!0),_.identifierPrefix!==void 0&&(tt=_.identifierPrefix),_.onRecoverableError!==void 0&&(nt=_.onRecoverableError)),_=bl(et,1,!1,null,null,_e,!1,tt,nt),et[uf]=_.current,sf(et.nodeType===8?et.parentNode:et),new ll(_)};reactDom_production_min.findDOMNode=function(et){if(et==null)return null;if(et.nodeType===1)return et;var _=et._reactInternals;if(_===void 0)throw typeof et.render=="function"?Error(p$1(188)):(et=Object.keys(et).join(","),Error(p$1(268,et)));return et=Zb(_),et=et===null?null:et.stateNode,et};reactDom_production_min.flushSync=function(et){return Rk(et)};reactDom_production_min.hydrate=function(et,_,_e){if(!ol(_))throw Error(p$1(200));return rl(null,et,_,!0,_e)};reactDom_production_min.hydrateRoot=function(et,_,_e){if(!nl(et))throw Error(p$1(405));var tt=_e!=null&&_e.hydratedSources||null,nt=!1,rt="",it=kl;if(_e!=null&&(_e.unstable_strictMode===!0&&(nt=!0),_e.identifierPrefix!==void 0&&(rt=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(it=_e.onRecoverableError)),_=el(_,null,et,1,_e??null,nt,!1,rt,it),et[uf]=_.current,sf(et),tt)for(et=0;et<tt.length;et++)_e=tt[et],nt=_e._getVersion,nt=nt(_e._source),_.mutableSourceEagerHydrationData==null?_.mutableSourceEagerHydrationData=[_e,nt]:_.mutableSourceEagerHydrationData.push(_e,nt);return new ml(_)};reactDom_production_min.render=function(et,_,_e){if(!ol(_))throw Error(p$1(200));return rl(null,et,_,!1,_e)};reactDom_production_min.unmountComponentAtNode=function(et){if(!ol(et))throw Error(p$1(40));return et._reactRootContainer?(Rk(function(){rl(null,null,et,!1,function(){et._reactRootContainer=null,et[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(et,_,_e,tt){if(!ol(_e))throw Error(p$1(200));if(et==null||et._reactInternals===void 0)throw Error(p$1(38));return rl(et,_,_e,!1,tt)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(et){console.error(et)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;/**
 * anime.js - ESM
 * @version v4.0.0-beta.100.alpha-4
 * @author Julian Garnier
 * @license MIT
 * @copyright (c) 2024 Julian Garnier
 * @see animejs.com
 */const isBrowser$1=typeof window<"u",win=isBrowser$1?window:null,doc=isBrowser$1?document:null,tweenTypes={INVALID:0,OBJECT:1,ATTRIBUTE:2,CSS:3,TRANSFORM:4,CSS_VAR:5},valueTypes={NUMBER:0,UNIT:1,COLOR:2,COMPLEX:3},tickModes={NONE:0,AUTO:1,FORCE:2},compositionTypes={replace:0,none:1,blend:2},isRegisteredTargetSymbol=Symbol(),isDomSymbol=Symbol(),isSvgSymbol=Symbol(),transformsSymbol=Symbol(),proxyTargetSymbol=Symbol(),minValue=1e-11,maxValue=1e12,K=1e3,maxFps=120,emptyString="",shortTransforms=new Map;shortTransforms.set("x","translateX");shortTransforms.set("y","translateY");shortTransforms.set("z","translateZ");const validTransforms=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],transformsFragmentStrings=validTransforms.reduce((et,_)=>({...et,[_]:_+"("}),{}),noop=()=>{},hexTestRgx=/(^#([\da-f]{3}){1,2}$)|(^#([\da-f]{4}){1,2}$)/i,rgbExecRgx=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,rgbaExecRgx=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,hslExecRgx=/hsl\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*\)/i,hslaExecRgx=/hsla\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,digitWithExponentRgx=/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g,unitsExecRgx=/^([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?)+([a-z]+|%)$/i,lowerCaseRgx=/([a-z])([A-Z])/g,transformsExecRgx=/(\w+)(\([^)]+\)+)/g,relativeValuesExecRgx=/(\*=|\+=|-=)/,defaults={id:null,keyframes:null,playbackEase:null,playbackRate:1,frameRate:maxFps,loop:0,reversed:!1,alternate:!1,autoplay:!0,duration:K,delay:0,loopDelay:0,ease:"outQuad",composition:compositionTypes.replace,modifier:et=>et,onBegin:noop,onUpdate:noop,onRender:noop,onLoop:noop,onComplete:noop},globals={defaults,root:doc,scope:null},selectString=et=>{try{return globals.root.querySelectorAll(et)}catch{return}},toLowerCase=et=>et.replace(lowerCaseRgx,"$1-$2").toLowerCase(),stringStartsWith=(et,_)=>et.indexOf(_)===0,now$3=Date.now,isArr=et=>Array.isArray(et),isObj=et=>et&&et.constructor===Object,isNum=et=>typeof et=="number"&&!isNaN(et),isStr=et=>typeof et=="string",isFnc=et=>typeof et=="function",isUnd=et=>typeof et>"u",isNil=et=>isUnd(et)||et===null,isSvg=et=>isBrowser$1&&et instanceof SVGElement,isHex=et=>hexTestRgx.test(et),isRgb=et=>stringStartsWith(et,"rgb"),isHsl=et=>stringStartsWith(et,"hsl"),isCol=et=>isHex(et)||isRgb(et)||isHsl(et),isKey=et=>!globals.defaults.hasOwnProperty(et),parseNumber=et=>isStr(et)?parseFloat(et):et,pow=Math.pow,sqrt=Math.sqrt,sin=Math.sin,cos=Math.cos,abs$1=Math.abs,exp=Math.exp,ceil=Math.ceil,floor=Math.floor,asin=Math.asin,max$3=Math.max,PI=Math.PI,clamp$2=(et,_,_e)=>et<_?_:et>_e?_e:et,round$2=(et,_)=>{const _e=10**(_||0);return Math.round(et*_e)/_e},snap=(et,_)=>_?Math.round(et/_)*_:et,interpolate=(et,_,_e)=>et+(_-et)*_e,clampInfinity=et=>et===1/0?maxValue:et===-1/0?-maxValue:et,clampZero=et=>et<minValue?minValue:et,toArray=et=>isBrowser$1?(isStr(et)&&(et=selectString(et)||et),et instanceof NodeList||et instanceof HTMLCollection?[].slice.call(et):[et]):[et],cloneArray=et=>isArr(et)?[...et]:et,mergeObjects=(et,_)=>{const _e={...et};for(let tt in _)_e[tt]=isUnd(et[tt])?_[tt]:et[tt];return _e},forEachChildren=(et,_,_e,tt="_prev",nt="_next")=>{let rt=et._head,it=nt;for(_e&&(rt=et._tail,it=tt);rt;){const st=rt[it];_(rt),rt=st}},removeChild=(et,_,_e="_prev",tt="_next")=>{const nt=_[_e],rt=_[tt];nt?nt[tt]=rt:et._head=rt,rt?rt[_e]=nt:et._tail=nt,_[_e]=null,_[tt]=null},addChild=(et,_,_e,tt="_prev",nt="_next")=>{let rt=et._tail;for(;rt&&_e&&_e(rt,_);)rt=rt[tt];const it=rt?rt[nt]:et._head;rt?rt[nt]=_:et._head=_,it?it[tt]=_:et._tail=_,_[tt]=rt,_[nt]=it};let Clock$1=class{constructor(){this.currentTime=0,this.deltaTime=0,this._elapsedTime=0,this._startTime=0,this._lastTime=0,this._scheduledTime=0,this._frameDuration=K/maxFps,this._fps=maxFps,this._speed=1,this._hasChildren=!1}get frameRate(){return this._fps}set frameRate(_){const _e=this._frameDuration,tt=+_,nt=tt<minValue?minValue:tt,rt=K/nt;this._fps=nt,this._frameDuration=rt,this._scheduledTime+=rt-_e}get playbackRate(){return this._speed}set playbackRate(_){const _e=+_;this._speed=_e<minValue?minValue:_e}requestTick(_){const _e=this._scheduledTime,tt=this._elapsedTime;if(this._elapsedTime+=_-tt,tt<_e)return tickModes.NONE;const nt=this._frameDuration,rt=tt-_e;return this._scheduledTime+=rt<nt?nt:rt,tickModes.AUTO}computeDeltaTime(_){const _e=_-this._lastTime;return this.deltaTime=_e,this._lastTime=_,_e}};const render=(et,_,_e,tt,nt)=>{const rt=et.duration,it=et.currentTime,st=et._currentIteration,ot=et._iterationDuration,at=et._iterationCount,lt=et._loopDelay,ct=et.reversed,ht=et._alternate,ut=et._hasChildren,ft=et._delay,dt=ft+ot,pt=clamp$2(_-ft,-ft,rt),mt=pt-it,vt=pt>=rt,yt=nt===tickModes.FORCE,_t=nt===tickModes.AUTO,St=yt||(mt<0?mt*-1:mt)>=200;let bt=et.began,Et=0,Mt=pt;if(at>1){const Ft=~~(pt/(ot+(vt?0:lt)));et._currentIteration=clamp$2(Ft,0,at),vt&&et._currentIteration--,Et=et._currentIteration%2,Mt=pt%(ot+lt)}const Tt=ct^(ht&&Et),wt=et._ease;let Ct=vt?Tt?0:rt:Tt?ot-Mt:Mt;wt&&(Ct=ot*wt(Ct/ot)||0);const Rt=Ct<et._iterationTime,It=St?Rt?2:1:0;et._iterationTime=Ct,et._backwards=Rt&&!Tt,!_e&&!bt&&pt>0&&(bt=et.began=!0,et.onBegin(et)),et.currentTime=pt;let Dt=0;if(bt&&et._currentIteration!==st&&(_e||et.onLoop(et),ut&&forEachChildren(et,Ft=>Ft.reset(),!0)),(yt||_t&&(_>=ft&&_<=dt||_<=ft&&it>0||_>=dt&&it!==rt)||Ct>=dt&&it!==rt||Ct<=ft&&it>0||_<=it&&it===rt&&et.completed)&&(bt&&(et.computeDeltaTime(it),_e||et.onUpdate(et)),!ut)){let Ft=et._head,$t,Yt,Lt,Ot,Nt=0;const zt=et._offset+ft+Ct;for(;Ft;){const Ht=Ft._composition,qt=Ft._currentTime,Gt=Ft._changeDuration,Xt=Ft._absoluteStartTime+Ft._changeDuration,Zt=Ft._nextRep,Qt=Ft._prevRep,un=Ht!==compositionTypes.none;if((It||(qt!==Gt||zt<=Xt+(Zt?Zt._delay:0))&&(qt!==0||zt>=Ft._absoluteStartTime))&&(!un||!Ft._isOverridden&&(!Ft._isOverlapped||zt<=Xt)&&(!Zt||Zt._isOverridden||zt<=Zt._absoluteStartTime)&&(!Qt||Qt._isOverridden||zt>=Qt._absoluteStartTime+Qt._changeDuration+Ft._delay))){const wn=Ft._currentTime=clamp$2(Ct-Ft._startTime,0,Gt),Tn=Ft._ease(wn/Ft._updateDuration),yn=Ft._modifier,Vt=Ft._valueType;let fn,ln;if(Vt===valueTypes.NUMBER)fn=ln=yn(interpolate(Ft._fromNumber,Ft._toNumber,Tn));else if(Vt===valueTypes.UNIT)ln=yn(round$2(interpolate(Ft._fromNumber,Ft._toNumber,Tn),3)),fn=`${ln}${Ft._unit}`;else if(Vt===valueTypes.COLOR){const Jt=Ft._fromNumbers,on=Ft._toNumbers,_n=round$2(clamp$2(yn(interpolate(Jt[0],on[0],Tn)),0,255),0),cn=round$2(clamp$2(yn(interpolate(Jt[1],on[1],Tn)),0,255),0),tn=round$2(clamp$2(yn(interpolate(Jt[2],on[2],Tn)),0,255),0),Wt=clamp$2(yn(interpolate(Jt[3],on[3],Tn)),0,1);if(fn=`rgba(${_n},${cn},${tn},${Wt})`,un){const Bt=Ft._numbers;Bt[0]=_n,Bt[1]=cn,Bt[2]=tn,Bt[3]=Wt}}else if(Vt===valueTypes.COMPLEX){fn=Ft._strings[0];for(let Jt=0,on=Ft._toNumbers.length;Jt<on;Jt++){const _n=yn(round$2(interpolate(Ft._fromNumbers[Jt],Ft._toNumbers[Jt],Tn),5)),cn=Ft._strings[Jt+1];fn+=`${cn?_n+cn:_n}`,un&&(Ft._numbers[Jt]=_n)}}if(un&&(Ft._number=ln),!tt&&Ht!==compositionTypes.blend){const Jt=Ft.property,on=Ft._tweenType;$t=Ft.target,on===tweenTypes.OBJECT?$t[Jt]=fn:on===tweenTypes.ATTRIBUTE?$t.setAttribute(Jt,fn):(Yt=$t.style,on===tweenTypes.TRANSFORM?($t!==Lt&&(Lt=$t,Ot=$t[transformsSymbol]),Ot[Jt]=fn,Nt=1):on===tweenTypes.CSS?Yt[Jt]=fn:on===tweenTypes.CSS_VAR&&Yt.setProperty(Jt,fn)),bt&&(Dt=1)}else Ft._value=fn}if(Nt&&Ft._renderTransforms){let wn=emptyString;for(let Tn in Ot)wn+=`${transformsFragmentStrings[Tn]}${Ot[Tn]}) `;Yt.transform=wn,Nt=0}Ft=Ft._next}Dt&&!_e&&et.onRender(et)}return bt&&vt&&(at===1/0?et._startTime+=et.duration:et._currentIteration>=at-1&&(et.paused=!0,et.completed||(et.completed=!0,_e||(et.onComplete(et),et._resolve(et))))),Dt},tick=(et,_,_e,tt,nt)=>{if(render(et,_,_e,tt,nt),et._hasChildren){let rt=0;const it=tt?_:et._iterationTime,st=now$3();forEachChildren(et,ot=>{rt+=render(ot,(it-ot._offset)*ot._speed,_e,tt,ot._fps<et._fps?ot.requestTick(st):nt)},et._backwards),et.began&&rt&&et.onRender(et)}},additive={animation:null,update:noop},addAdditiveAnimation=et=>{let _=additive.animation;return _||(_={duration:minValue,_offset:0,_delay:0,_head:null,_tail:null},additive.animation=_,additive.update=()=>{et.forEach(_e=>{for(let tt in _e){const nt=_e[tt],rt=nt._head,it=rt._valueType===valueTypes.COMPLEX?cloneArray(rt._fromNumbers):null;let st=rt._fromNumber,ot=nt._tail;for(;ot&&ot!==rt;)it?ot._numbers.forEach((at,lt)=>it[lt]+=at):st+=ot._number,ot=ot._prevAdd;rt._toNumber=st,rt._toNumbers=it}}),tick(_,1,1,0,tickModes.FORCE)}),_},engineTickMethod=isBrowser$1?requestAnimationFrame:setImmediate,engineCancelMethod=isBrowser$1?cancelAnimationFrame:clearImmediate;class Engine extends Clock$1{constructor(){super();const _=now$3();this.currentTime=_,this._elapsedTime=_,this._startTime=_,this._lastTime=_,this.useDefaultMainLoop=!0,this.suspendWhenHidden=!0,this._reqId=0,this._head=null,this._tail=null}update(){const _=this.currentTime=now$3();if(this.requestTick(_)){this.computeDeltaTime(_);const _e=this._speed,tt=this._fps;let nt=this._head;for(;nt;){const rt=nt._next;nt.paused?(removeChild(engine$1,nt),this._hasChildren=!!this._tail,nt._running=!1,nt.completed&&!nt._cancelled&&nt.cancel()):tick(nt,(_-nt._startTime)*nt._speed*_e,0,0,nt._fps<tt?nt.requestTick(_):tickModes.AUTO),nt=rt}additive.update()}}start(){return this.useDefaultMainLoop&&!this._reqId?this._reqId=engineTickMethod(mainLoop):0}resume(){return forEachChildren(this,_=>_.resetTime()),this.start()}suspend(){return this._reqId=engineCancelMethod(this._reqId),this}get playbackRate(){return super.playbackRate}set playbackRate(_){super.playbackRate=_,forEachChildren(this,_e=>_e.playbackRate=_e._speed)}}const engine$1=new Engine,mainLoop=()=>{engine$1._head?(engine$1._reqId=engineTickMethod(mainLoop),engine$1.update()):engine$1._reqId=0},parseTargets=et=>{if(!isNil(et))if(isArr(et)){const _=et,_e=[].concat(..._.map(toArray));return _e.filter((tt,nt)=>_e.indexOf(tt)===nt)}else return toArray(et)},registerTargets=et=>{if(isNil(et))return;const _=parseTargets(et);for(let _e=0,tt=_.length;_e<tt;_e++){const nt=_[_e];if(!nt[isRegisteredTargetSymbol]){nt[isRegisteredTargetSymbol]=!0;const rt=isSvg(nt);(nt.nodeType||rt)&&(nt[isDomSymbol]=!0,nt[isSvgSymbol]=rt,nt[transformsSymbol]={})}}return _},none=et=>et,calcBezier=(et,_,_e)=>(((1-3*_e+3*_)*et+(3*_e-6*_))*et+3*_)*et,binarySubdivide=(et,_,_e)=>{let tt=0,nt=1,rt,it,st=0;do it=tt+(nt-tt)/2,rt=calcBezier(it,_,_e)-et,rt>0?nt=it:tt=it;while(abs$1(rt)>1e-7&&++st<100);return it},cubicBezier=(et,_,_e,tt)=>et===_&&_e===tt?none:nt=>nt===0||nt===1?nt:calcBezier(binarySubdivide(nt,et,_e),_,tt),steps=(et=10,_)=>{const _e=_?ceil:floor;return tt=>_e(clamp$2(tt,0,1)*et)*(1/et)},halfPI=PI/2,doublePI=PI*2,easeInPower=(et=1.64)=>_=>pow(_,+et),easeInFunctions={[emptyString]:easeInPower,Quad:easeInPower(2),Cubic:easeInPower(3),Quart:easeInPower(4),Quint:easeInPower(5),Sine:et=>1-cos(et*halfPI),Circ:et=>1-sqrt(1-et*et),Expo:et=>et?pow(2,10*et-10):0,Bounce:et=>{let _,_e=4;for(;et<((_=pow(2,--_e))-1)/11;);return 1/pow(4,3-_e)-7.5625*pow((_*3-2)/22-et,2)},Back:(et=1.70158)=>_=>(+et+1)*_*_*_-+et*_*_,Elastic:(et=1,_=.3)=>{const _e=clamp$2(+et,1,10),tt=clamp$2(+_,minValue,2),nt=tt/doublePI*asin(1/_e),rt=doublePI/tt;return it=>it===0||it===1?it:-_e*pow(2,-10*(1-it))*sin((1-it-nt)*rt)}},easeTypes={in:et=>_=>et(_),out:et=>_=>1-et(1-_),inOut:et=>_=>_<.5?et(_*2)/2:1-et(_*-2+2)/2,outIn:et=>_=>_<.5?(1-et(1-_*2))/2:(et(_*2-1)+1)/2},linear=(...et)=>{const _=et.length;if(!_)return none;const _e=_-1,tt=et[0],nt=et[_e],rt=[0],it=[parseNumber(tt)];for(let st=1;st<_e;st++){const ot=et[st],at=isStr(ot)?ot.trim().split(" "):[ot],lt=at[0],ct=at[1];rt.push(isUnd(ct)?st/_e:parseNumber(ct)/100),it.push(parseNumber(lt))}return it.push(parseNumber(nt)),rt.push(1),function(ot){for(let at=1,lt=rt.length;at<lt;at++){const ct=rt[at];if(ot<=ct){const ht=rt[at-1],ut=it[at-1];return ut+(it[at]-ut)*(ot-ht)/(ct-ht)}}return it[it.length-1]}},irregular=(et=10,_=1)=>{const _e=[0],tt=et-1;for(let nt=1;nt<tt;nt++){const rt=_e[nt-1],it=nt/tt,st=(nt+1)/tt,ot=it+(st-it)*Math.random(),at=it*(1-_)+ot*_;_e.push(clamp$2(at,rt,1))}return _e.push(1),linear(..._e)},eases={linear,irregular,steps,cubicBezier},easesLookups={linear:none};for(let et in easeTypes)for(let _ in easeInFunctions){const _e=easeInFunctions[_],tt=easeTypes[et],nt=_===emptyString||_==="Back"||_==="Elastic",rt=nt?(st,ot)=>tt(_e(st,ot)):tt(_e),it=et+_;eases[it]=rt,easesLookups[it]=nt?rt():rt}const parseEaseString=et=>{if(et.indexOf("(")<=-1)return none;const _=et.slice(0,-1).split("("),_e=eases[_[0]];return _e?easesLookups[et]=_e(..._[1].split(",")):none},parseEasings=et=>isFnc(et)?et:isStr(et)?easesLookups[et]?easesLookups[et]:parseEaseString(et):none,parseInlineTransforms=(et,_,_e)=>{const tt=et.style.transform;let nt;if(tt){const rt=et[transformsSymbol];let it;for(;it=transformsExecRgx.exec(tt);){const st=it[1],ot=it[2].slice(1,-1);rt[st]=ot,st===_&&(nt=ot,_e&&(_e[_]=ot))}}return tt&&!isUnd(nt)?nt:stringStartsWith(_,"scale")?"1":stringStartsWith(_,"rotate")||stringStartsWith(_,"skew")?"0deg":"0px"},cssReservedProperties=["opacity","rotate","overflow","color"],isValidSVGAttribute=(et,_)=>{if(cssReservedProperties.includes(_))return!1;if(_ in et.style||_ in et){if(_==="scale"){const _e=et.parentNode;return _e&&_e.tagName==="filter"}return!0}},rgbToRgba=et=>{const _=rgbExecRgx.exec(et)||rgbaExecRgx.exec(et),_e=isUnd(_[4])?1:+_[4];return[+_[1],+_[2],+_[3],_e]},hexToRgba=et=>{const _=et.length,_e=_===4||_===5;return[+("0x"+et[1]+et[_e?1:2]),+("0x"+et[_e?2:3]+et[_e?2:4]),+("0x"+et[_e?3:5]+et[_e?3:6]),_===5||_===9?+(+("0x"+et[_e?4:7]+et[_e?4:8])/255).toFixed(3):1]},hue2rgb$2=(et,_,_e)=>(_e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?et+(_-et)*6*_e:_e<1/2?_:_e<2/3?et+(_-et)*(2/3-_e)*6:et),hslToRgba=et=>{const _=hslExecRgx.exec(et)||hslaExecRgx.exec(et),_e=+_[1]/360,tt=+_[2]/100,nt=+_[3]/100,rt=isUnd(_[4])?1:+_[4];let it,st,ot;if(tt===0)it=st=ot=nt;else{const at=nt<.5?nt*(1+tt):nt+tt-nt*tt,lt=2*nt-at;it=round$2(hue2rgb$2(lt,at,_e+1/3)*255,0),st=round$2(hue2rgb$2(lt,at,_e)*255,0),ot=round$2(hue2rgb$2(lt,at,_e-1/3)*255,0)}return[it,st,ot,rt]},convertColorStringValuesToRgbaArray=et=>isRgb(et)?rgbToRgba(et):isHex(et)?hexToRgba(et):isHsl(et)?hslToRgba(et):[0,0,0,1],setValue=(et,_)=>isUnd(et)?_:et,getFunctionValue=(et,_,_e,tt,nt)=>{if(isFnc(et)){const rt=()=>{const it=et(_,_e,tt);return isNaN(+it)?it||0:+it};return nt&&(nt.func=rt),rt()}else return et},getTweenType=(et,_)=>{const _e=et[isDomSymbol]?et[isSvgSymbol]&&isValidSVGAttribute(et,_)?tweenTypes.ATTRIBUTE:validTransforms.includes(_)||shortTransforms.get(_)?tweenTypes.TRANSFORM:stringStartsWith(_,"--")?tweenTypes.CSS_VAR:_ in et.style?tweenTypes.CSS:isNil(et.getAttribute(_))?isUnd(et[_])?tweenTypes.INVALID:tweenTypes.OBJECT:tweenTypes.ATTRIBUTE:tweenTypes.OBJECT;return _e===tweenTypes.INVALID&&console.warn(`Can't find property '${_}' on target '${et}'.`),_e},getCSSValue=(et,_,_e)=>{const tt=et.style[_];tt&&_e&&(_e[_]=tt);const nt=tt||getComputedStyle(et[proxyTargetSymbol]||et).getPropertyValue(_);return nt==="auto"?"0":nt},getOriginalAnimatableValue=(et,_,_e,tt)=>{const nt=isUnd(_e)?getTweenType(et,_):_e;return nt===tweenTypes.OBJECT?et[_]||0:nt===tweenTypes.ATTRIBUTE?et.getAttribute(_):nt===tweenTypes.TRANSFORM?parseInlineTransforms(et,_,tt):nt===tweenTypes.CSS_VAR?getCSSValue(et,_,tt).trimStart():getCSSValue(et,_,tt)},getRelativeValue=(et,_,_e)=>_e==="-"?et-_:_e==="+"?et+_:et*_,createDecomposedValueTargetObject=()=>({t:valueTypes.NUMBER,n:0,u:null,o:null,d:null,s:null}),decomposeRawValue=(et,_)=>{if(_.t=valueTypes.NUMBER,_.n=0,_.u=null,_.o=null,_.d=null,_.s=null,!et)return _;let _e=et;const tt=+_e;if(isNaN(tt)){const nt=relativeValuesExecRgx.exec(_e);nt&&(_e=_e.slice(2),_.o=nt[0][0]);const rt=_e.includes(" ")?!1:unitsExecRgx.exec(_e);if(rt)return _.t=valueTypes.UNIT,_.n=+rt[1],_.u=rt[2],_;if(_.o)return _.n=+_e,_;if(isCol(_e))return _.t=valueTypes.COLOR,_.d=convertColorStringValuesToRgbaArray(_e),_;{const it=_e+emptyString,st=it.match(digitWithExponentRgx);return _.t=valueTypes.COMPLEX,_.d=st?st.map(Number):[],_.s=it.split(digitWithExponentRgx)||[],_}}else return _.n=tt,_},decomposeTweenValue=(et,_)=>(_.t=et._valueType,_.n=et._toNumber,_.u=et._unit,_.o=null,_.d=cloneArray(et._toNumbers),_.s=cloneArray(et._strings),_),decomposedOriginalValue=createDecomposedValueTargetObject(),propertyNamesCache={},sanitizePropertyName=(et,_,_e)=>{if(_e===tweenTypes.TRANSFORM){const tt=shortTransforms.get(et);return tt||et}else if(_e===tweenTypes.CSS||_e===tweenTypes.ATTRIBUTE&&isSvg(_)&&et in _.style){const tt=propertyNamesCache[et];if(tt)return tt;{const nt=toLowerCase(et);return propertyNamesCache[et]=nt,nt}}else return et},angleUnitsMap={deg:1,rad:180/PI,turn:360},convertedValuesCache={},convertValueUnit=(et,_,_e,tt=!1)=>{const nt=_.u,rt=_.n;if(_.t===valueTypes.UNIT&&nt===_e)return _;const it=rt+nt+_e,st=convertedValuesCache[it];if(!isUnd(st)&&!tt)_.n=st;else{let ot;if(nt in angleUnitsMap)ot=rt*angleUnitsMap[nt]/angleUnitsMap[_e];else{const lt=et.cloneNode(),ct=et.parentNode,ht=ct&&ct!==doc?ct:doc.body;ht.appendChild(lt);const ut=lt.style;ut.width=100+nt;const ft=lt.offsetWidth||100;ut.width=100+_e;const dt=lt.offsetWidth||100,pt=ft/dt;ht.removeChild(lt),ot=pt*rt}_.n=ot,convertedValuesCache[it]=ot}return _.t,valueTypes.UNIT,_.u=_e,_},lookups={_rep:new WeakMap,_add:new Map},getTweenSiblings=(et,_,_e="_rep")=>{const tt=lookups[_e];let nt=tt.get(et);return nt||(nt={},tt.set(et,nt)),nt[_]?nt[_]:nt[_]={_head:null,_tail:null}},addTweenSortMethod=(et,_)=>et._isOverridden||et._absoluteStartTime>_._absoluteStartTime,overrideTween=et=>{et._isOverlapped=1,et._isOverridden=1,et._changeDuration=minValue,et._currentTime=minValue},composeTween=(et,_)=>{const _e=et._composition;if(_e===compositionTypes.replace){const tt=et._absoluteStartTime;addChild(_,et,addTweenSortMethod,"_prevRep","_nextRep");const nt=et._prevRep;if(nt){const rt=nt.parent,it=nt._absoluteStartTime+nt._changeDuration;if(et.parent.id!==rt.id&&rt._iterationCount>1&&it+(rt.duration-rt._iterationDuration)>tt){overrideTween(nt);let at=nt._prevRep;for(;at&&at.parent.id===rt.id;)overrideTween(at),at=at._prevRep}const st=tt-et._delay;if(it>st){const at=nt._startTime,lt=it-(at+nt._updateDuration);nt._changeDuration=st-lt-at,nt._currentTime=nt._changeDuration,nt._isOverlapped=1,nt._changeDuration<minValue&&overrideTween(nt)}let ot=0;forEachChildren(rt,at=>{ot-=at._isOverridden-1}),ot===0&&(rt.completed=!0,rt.pause())}}else if(_e===compositionTypes.blend){const tt=getTweenSiblings(et.target,et.property,"_add"),nt=addAdditiveAnimation(lookups._add);let rt=tt._head;rt||(rt={...et},rt._composition=compositionTypes.replace,rt._updateDuration=minValue,rt._startTime=0,rt._numbers=cloneArray(et._fromNumbers),rt._number=0,rt._next=null,rt._prev=null,addChild(tt,rt),addChild(nt,rt));const it=et._toNumber;if(et._fromNumber=rt._fromNumber-it,et._toNumber=0,et._numbers=cloneArray(et._fromNumbers),et._number=0,rt._fromNumber=it,et._toNumbers){const st=cloneArray(et._toNumbers);st&&st.forEach((ot,at)=>{et._fromNumbers[at]=rt._fromNumbers[at]-ot,et._toNumbers[at]=0}),rt._fromNumbers=st}addChild(tt,et,null,"_prevAdd","_nextAdd")}return et},removeTweenSliblings=et=>{const _=et._composition;if(_!==compositionTypes.none){const _e=et.target,tt=et.property,nt=getTweenSiblings(_e,tt);if(removeChild(nt,et,"_prevRep","_nextRep"),_===compositionTypes.blend){const rt=getTweenSiblings(_e,tt,"_add");removeChild(rt,et,"_prevAdd","_nextAdd")}}return et},resetTimerProperties=et=>(et.paused=!0,et.began=!1,et.completed=!1,et),reviveTimer=et=>(et._cancelled&&(et._hasChildren?forEachChildren(et,reviveTimer):forEachChildren(et,_=>{_._composition!==compositionTypes.none&&composeTween(_,getTweenSiblings(_.target,_.property))}),et._cancelled=0),et);let timerId=0;class Timer extends Clock$1{constructor(_={},_e=null,tt=0){super();const{id:nt,delay:rt,duration:it,reversed:st,alternate:ot,loop:at,loopDelay:lt,autoplay:ct,frameRate:ht,playbackRate:ut,onComplete:ft,onLoop:dt,onBegin:pt,onUpdate:mt}=_,vt=_e?0:engine$1._elapsedTime,yt=_e?_e.defaults:globals.defaults,_t=isFnc(rt)||isUnd(rt)?yt.delay:+rt,St=isFnc(it)||isUnd(it)?1/0:+it,bt=setValue(at,yt.loop),Et=setValue(lt,yt.loopDelay),Mt=bt===!0||bt===1/0||bt<0?1/0:bt+1;this.id=isUnd(nt)?it===minValue?0:++timerId:nt,this.parent=_e,this.duration=clampInfinity((St+Et)*Mt-Et),this.paused=!0,this.began=!1,this.completed=!1,this.reversed=+setValue(st,yt.reversed),this.onBegin=pt||yt.onBegin,this.onUpdate=mt||yt.onUpdate,this.onLoop=dt||yt.onLoop,this.onComplete=ft||yt.onComplete,this._autoplay=_e?!1:setValue(ct,yt.autoplay),this._offset=_e?tt:engine$1._elapsedTime-engine$1._startTime,this._delay=_t,this._loopDelay=Et,this._iterationTime=0,this._iterationDuration=St,this._iterationCount=Mt,this._currentIteration=0,this._resolve=noop,this._hasChildren=!1,this._running=!1,this._cancelled=0,this._reversed=this.reversed,this._alternate=setValue(ot,yt.alternate),this._backwards=!1,this._prev=null,this._next=null,this._elapsedTime=vt,this._startTime=vt,this._lastTime=vt,this._fps=setValue(ht,yt.frameRate),this._speed=setValue(ut,yt.playbackRate)}get progress(){return round$2(this.currentTime/this.duration,6)}set progress(_){const _e=this.paused;this.pause().seek(this.duration*+_),_e||this.play()}get playbackRate(){return super.playbackRate}set playbackRate(_){super.playbackRate=_,this.resetTime()}reset(_=0){return reviveTimer(this),!this._reversed!=!this.reversed&&this.reverse(),this._iterationTime=this._iterationDuration,tick(this,0,1,_,tickModes.FORCE),resetTimerProperties(this),this._hasChildren&&forEachChildren(this,resetTimerProperties),this}init(_=0){this.frameRate=this._fps,this.playbackRate=this._speed,!_&&this._hasChildren&&tick(this,this.duration,1,_,tickModes.FORCE),this.reset(_);const _e=this._autoplay;return _e===!0?this.play():!_&&_e&&!isUnd(_e.linked)&&_e.link(this),this}resetTime(){const _=1/(this._speed*engine$1._speed);return this._startTime=now$3()-(this.currentTime+this._delay)*_-12,this}pause(){return this.paused?this:(this.paused=!0,this)}play(){return this.paused?(this.paused=!1,this.duration<=minValue?tick(this,1,0,0,tickModes.FORCE):(this._running||(addChild(engine$1,this),engine$1._hasChildren=!0,this._running=!0),this.resetTime(),engine$1.start()),this):this}restart(){return this.reset(0).play()}seek(_,_e){reviveTimer(this),this.completed=!1;const tt=this.paused;return this.paused=!0,tick(this,_+this._delay,~~_e,0,tickModes.AUTO),tt?this:this.play()}reverse(){const _=this.reversed;return this.reversed=+(this._alternate&&!(this._iterationCount%2)?_:!_),this.seek(this.duration-this.currentTime),this.resetTime(),this}playForward(){return this.reversed?this.reverse().play():this.play()}playBackward(){return this.reversed?this.play():this.reverse().play()}cancel(){return this._hasChildren?forEachChildren(this,_=>_.cancel(),!0):forEachChildren(this,removeTweenSliblings),this._cancelled=1,this.pause()}stretch(_){const _e=this.duration;if(_e===_)return this;const tt=_/_e;return this.duration=clampZero(clampInfinity(_e*tt)),this._iterationDuration=clampZero(clampInfinity(this._iterationDuration*tt)),this._offset*=tt,this._delay*=tt,this._loopDelay*=tt,this}revert(){tick(this,0,1,0,tickModes.FORCE);const _=this._autoplay;return _.linked&&_.revert(),this.cancel()}then(_=noop){const _e=this.then,tt=()=>{this.then=null,_(this),this.then=_e,this._resolve=noop};return new Promise(nt=>(this._resolve=()=>nt(tt()),this.completed&&this._resolve(),this))}}const cleanInlineStyles=et=>{if(et._hasChildren)forEachChildren(et,cleanInlineStyles,!0);else{const _=et;_.pause(),forEachChildren(_,_e=>{const tt=_e.property,nt=_e.target;if(nt[isDomSymbol]){const rt=nt.style,it=_._inlineStyles[tt];if(_e._tweenType===tweenTypes.TRANSFORM){const st=nt[transformsSymbol];if(isUnd(it)||it===emptyString?delete st[tt]:st[tt]=it,_e._renderTransforms)if(!Object.keys(st).length)rt.removeProperty("transform");else{let ot=emptyString;for(let at in st)ot+=transformsFragmentStrings[at]+st[at]+") ";rt.transform=ot}}else isUnd(it)||it===emptyString?rt.removeProperty(tt):rt[tt]=it;_._tail===_e&&_.targets.forEach(st=>{st.getAttribute&&st.getAttribute("style")===emptyString&&st.removeAttribute("style")})}})}return et},fromTargetObject=createDecomposedValueTargetObject(),toTargetObject=createDecomposedValueTargetObject(),toFunctionStore={func:null},keyframesTargetArray=[null],fastSetValuesArray=[null,null],keyObjectTarget={to:null};let tweenId=0,keyframes,key;const generateKeyframes=(et,_)=>{const _e={};if(isArr(et)){const tt=[].concat(...et.map(nt=>Object.keys(nt))).filter(isKey);for(let nt=0,rt=tt.length;nt<rt;nt++){const it=tt[nt],st=et.map(ot=>{const at={};for(let lt in ot){const ct=ot[lt];isKey(lt)?lt===it&&(at.to=ct):at[lt]=ct}return at});_e[it]=st}}else{const tt=setValue(_.duration,globals.defaults.duration);Object.keys(et).map(rt=>({o:parseFloat(rt)/100,p:et[rt]})).sort((rt,it)=>rt.o-it.o).forEach(rt=>{const it=rt.o,st=rt.p;for(let ot in st)if(isKey(ot)){let at=_e[ot];at||(at=_e[ot]=[]);const lt=it*tt;let ct=at.length,ht=at[ct-1];const ut={to:st[ot]};let ft=0;for(let dt=0;dt<ct;dt++)ft+=at[dt].duration;ct===1&&(ut.from=ht.to),st.ease&&(ut.ease=st.ease),ut.duration=lt-(ct?ft:0),at.push(ut)}return rt});for(let rt in _e){const it=_e[rt];let st;for(let ot=0,at=it.length;ot<at;ot++){const lt=it[ot],ct=lt.ease;st&&(lt.ease=st),st=ct}it[0].duration||it.shift()}}return _e};class Animation extends Timer{constructor(_,_e,tt,nt,rt=!1,it=0,st=0){super(_e,tt,nt),this._head=null,this._tail=null;const ot=registerTargets(_),at=ot.length,lt=_e.keyframes,ct=lt?mergeObjects(generateKeyframes(lt,_e),_e):_e,{delay:ht,duration:ut,ease:ft,playbackEase:dt,modifier:pt,composition:mt,onRender:vt}=ct,yt=tt?tt.defaults:globals.defaults,_t=setValue(dt,yt.playbackEase),St=_t?parseEasings(_t):null,bt=!isUnd(ft)&&isObj(ft),Et=bt?ft.solver:setValue(ft,St?"linear":yt.ease),Mt=bt?ft.duration:setValue(ut,yt.duration),Tt=setValue(ht,yt.delay),wt=pt||yt.modifier,Ct=isUnd(mt)&&at>=K?compositionTypes.none:isUnd(mt)?yt.composition:mt,Rt={},It=this._offset;let Dt=NaN,Ft=NaN,$t=0;for(let Yt=0;Yt<at;Yt++){const Lt=ot[Yt],Ot=it||Yt,Nt=st||at;let zt=NaN,Ht=NaN;for(let qt in ct)if(isKey(qt)){const Gt=getTweenType(Lt,qt);if(Gt!==tweenTypes.INVALID){const Xt=sanitizePropertyName(qt,Lt,Gt);let Zt=ct[qt];if(rt&&(fastSetValuesArray[0]=Zt,fastSetValuesArray[1]=Zt,Zt=fastSetValuesArray),isArr(Zt)){const Vt=Zt.length,fn=!isObj(Zt[0]);Vt===2&&fn?(keyObjectTarget.to=Zt,keyframesTargetArray[0]=keyObjectTarget,keyframes=keyframesTargetArray):Vt>2&&fn?(keyframes=[],Zt.forEach((ln,Jt)=>{Jt?Jt===1?(fastSetValuesArray[1]=ln,keyframes.push(fastSetValuesArray)):keyframes.push(ln):fastSetValuesArray[0]=ln})):keyframes=Zt}else keyframesTargetArray[0]=Zt,keyframes=keyframesTargetArray;let Qt=null,un=null,wn=NaN,Tn=0,yn=0;for(let Vt=keyframes.length;yn<Vt;yn++){const fn=keyframes[yn];isObj(fn)?key=fn:(keyObjectTarget.to=fn,key=keyObjectTarget),toFunctionStore.func=null;const ln=getFunctionValue(key.to,Lt,Ot,Nt,toFunctionStore);let Jt;isObj(ln)&&!isUnd(ln.to)?(key=ln,Jt=ln.to):Jt=ln;const on=getFunctionValue(key.from,Lt,Ot,Nt),_n=key.ease,cn=!isUnd(_n)&&isObj(_n),tn=cn?_n.solver:_n||Et,Wt=cn?_n.duration:getFunctionValue(setValue(key.duration,Vt>1?getFunctionValue(Mt,Lt,Ot,Nt)/Vt:Mt),Lt,Ot,Nt),Bt=getFunctionValue(setValue(key.delay,yn?0:Tt),Lt,Ot,Nt),nn=getFunctionValue(setValue(key.composition,Ct),Lt,Ot,Nt),en=isNum(nn)?nn:compositionTypes[nn],mn=key.modifier||wt,sn=isArr(Jt),xn=sn||!isUnd(on)&&!isUnd(Jt),an=un?Tn+Bt:Bt,pn=It+an;let Sn=un;if(en!==compositionTypes.none){Qt||(Qt=getTweenSiblings(Lt,Xt));let Mn=Qt._head;for(;Mn&&!Mn._isOverridden&&Mn._absoluteStartTime<=pn;)if(Sn=Mn,Mn=Mn._nextRep,Mn&&Mn._absoluteStartTime>=pn)for(;Mn;)overrideTween(Mn),Mn=Mn._nextRep}if(xn?(decomposeRawValue(sn?getFunctionValue(Jt[0],Lt,Ot,Nt):on,fromTargetObject),decomposeRawValue(sn?getFunctionValue(Jt[1],Lt,Ot,Nt,toFunctionStore):Jt,toTargetObject),fromTargetObject.t===valueTypes.NUMBER&&(Sn?Sn._valueType===valueTypes.UNIT&&(fromTargetObject.t=valueTypes.UNIT,fromTargetObject.u=Sn._unit):(decomposeRawValue(getOriginalAnimatableValue(Lt,Xt,Gt,Rt),decomposedOriginalValue),decomposedOriginalValue.t===valueTypes.UNIT&&(fromTargetObject.t=valueTypes.UNIT,fromTargetObject.u=decomposedOriginalValue.u)))):(isUnd(Jt)?un?decomposeTweenValue(un,toTargetObject):decomposeRawValue(tt&&Sn&&Sn.parent.parent===tt?Sn._value:getOriginalAnimatableValue(Lt,Xt,Gt,Rt),toTargetObject):decomposeRawValue(Jt,toTargetObject),isUnd(on)?un?decomposeTweenValue(un,fromTargetObject):decomposeRawValue(tt&&Sn&&Sn.parent.parent===tt?Sn._value:getOriginalAnimatableValue(Lt,Xt,Gt,Rt),fromTargetObject):decomposeRawValue(on,fromTargetObject)),fromTargetObject.o&&(fromTargetObject.n=getRelativeValue(Sn?Sn._toNumber:decomposeRawValue(getOriginalAnimatableValue(Lt,Xt,Gt,Rt),decomposedOriginalValue).n,fromTargetObject.n,fromTargetObject.o)),toTargetObject.o&&(toTargetObject.n=getRelativeValue(fromTargetObject.n,toTargetObject.n,toTargetObject.o)),fromTargetObject.t!==toTargetObject.t){if(fromTargetObject.t===valueTypes.COMPLEX||toTargetObject.t===valueTypes.COMPLEX){const Mn=fromTargetObject.t===valueTypes.COMPLEX?fromTargetObject:toTargetObject,kn=fromTargetObject.t===valueTypes.COMPLEX?toTargetObject:fromTargetObject;kn.t=valueTypes.COMPLEX,kn.s=cloneArray(Mn.s),kn.d=Mn.d.map(()=>kn.n)}else if(fromTargetObject.t===valueTypes.UNIT||toTargetObject.t===valueTypes.UNIT){const Mn=fromTargetObject.t===valueTypes.UNIT?fromTargetObject:toTargetObject,kn=fromTargetObject.t===valueTypes.UNIT?toTargetObject:fromTargetObject;kn.t=valueTypes.UNIT,kn.u=Mn.u}else if(fromTargetObject.t===valueTypes.COLOR||toTargetObject.t===valueTypes.COLOR){const Mn=fromTargetObject.t===valueTypes.COLOR?fromTargetObject:toTargetObject,kn=fromTargetObject.t===valueTypes.COLOR?toTargetObject:fromTargetObject;kn.t=valueTypes.COLOR,kn.s=Mn.s,kn.d=[0,0,0,1]}}if(fromTargetObject.u!==toTargetObject.u){let Mn=toTargetObject.u?fromTargetObject:toTargetObject;Mn=convertValueUnit(Lt,Mn,toTargetObject.u?toTargetObject.u:fromTargetObject.u,!1)}if(toTargetObject.d&&fromTargetObject.d&&toTargetObject.d.length!==fromTargetObject.d.length){const Mn=fromTargetObject.d.length>toTargetObject.d.length?fromTargetObject:toTargetObject,kn=Mn===fromTargetObject?toTargetObject:fromTargetObject;kn.d=Mn.d.map((Fn,Nn)=>isUnd(kn.d[Nn])?0:kn.d[Nn]),kn.s=cloneArray(Mn.s)}const gn=+Wt||minValue,Rn={parent:this,id:tweenId++,property:Xt,target:Lt,_value:null,_func:toFunctionStore.func,_ease:parseEasings(tn),_fromNumbers:cloneArray(fromTargetObject.d),_toNumbers:cloneArray(toTargetObject.d),_strings:cloneArray(toTargetObject.s),_fromNumber:fromTargetObject.n,_toNumber:toTargetObject.n,_numbers:cloneArray(fromTargetObject.d),_number:fromTargetObject.n,_unit:toTargetObject.u,_modifier:mn,_currentTime:0,_startTime:an,_delay:+Bt,_updateDuration:gn,_changeDuration:gn,_absoluteStartTime:pn,_tweenType:Gt,_valueType:toTargetObject.t,_composition:en,_isOverlapped:0,_isOverridden:0,_renderTransforms:0,_prevRep:null,_nextRep:null,_prevAdd:null,_nextAdd:null,_prev:null,_next:null};en!==compositionTypes.none&&composeTween(Rn,Qt),isNaN(wn)&&(wn=Rn._startTime),Tn=an+gn,un=Rn,$t++,addChild(this,Rn)}(isNaN(Ft)||wn<Ft)&&(Ft=wn),(isNaN(Dt)||Tn>Dt)&&(Dt=Tn),Gt===tweenTypes.TRANSFORM&&(zt=$t-yn,Ht=$t)}}if(!isNaN(zt)){let qt=0;forEachChildren(this,Gt=>{qt>=zt&&qt<Ht&&(Gt._renderTransforms=1,Gt._composition===compositionTypes.blend&&forEachChildren(additive.animation,Xt=>{Xt.id===Gt.id&&(Xt._renderTransforms=1)})),qt++})}}at||console.warn("No target found. Make sure the element you're trying to animate is accessible before creating your animation."),Ft?(forEachChildren(this,Yt=>{Yt._startTime-Yt._delay||(Yt._delay-=Ft),Yt._startTime-=Ft}),Dt-=Ft):Ft=0,Dt||(Dt=minValue,this._iterationCount=0),this.targets=ot,this.duration=clampInfinity((Dt+this._loopDelay)*this._iterationCount-this._loopDelay)||minValue,this.onRender=vt||yt.onRender,this._ease=St,this._delay=Ft,this._iterationDuration=Dt,this._inlineStyles=Rt}stretch(_){const _e=this.duration;if(_e===_)return this;const tt=_/_e;return forEachChildren(this,nt=>{nt._updateDuration=clampZero(nt._updateDuration*tt),nt._changeDuration=clampZero(nt._changeDuration*tt),nt._currentTime*=tt,nt._startTime*=tt,nt._absoluteStartTime*=tt}),super.stretch(_)}refresh(){return forEachChildren(this,_=>{const _e=getOriginalAnimatableValue(_.target,_.property,_._tweenType);decomposeRawValue(_e,decomposedOriginalValue),_._fromNumbers=cloneArray(decomposedOriginalValue.d),_._fromNumber=decomposedOriginalValue.n,_._func&&(decomposeRawValue(_._func(),toTargetObject),_._toNumbers=cloneArray(toTargetObject.d),_._strings=cloneArray(toTargetObject.s),_._toNumber=toTargetObject.n)}),this}revert(){return super.revert(),cleanInlineStyles(this)}then(_){return super.then(_)}}function getTargetValue(et,_,_e){const tt=registerTargets(et);if(!(isNil(tt)||isArr(tt)&&!tt.length)&&tt&&tt.length){const[nt]=tt,rt=getTweenType(nt,_),it=sanitizePropertyName(_,nt,rt);let st=getOriginalAnimatableValue(nt,it);if(isUnd(_e))return st;if(decomposeRawValue(st,decomposedOriginalValue),decomposedOriginalValue.t===valueTypes.NUMBER||decomposedOriginalValue.t===valueTypes.UNIT){if(_e===!1)return decomposedOriginalValue.n;{const ot=convertValueUnit(nt,decomposedOriginalValue,_e,!1);return`${round$2(ot.n,3)}${ot.u}`}}}}const setTargetValues=(et,_)=>{if(!isUnd(_))return _.duration=minValue,_.composition=setValue(_.composition,compositionTypes.none),new Animation(et,_,null,0,!0).play()},removeTargetsFromAnimation=(et,_)=>{let _e=!1;return forEachChildren(_,tt=>{et.includes(tt.target)&&(removeChild(_,tt),_e=!0)},!0),_e},remove=(et,_)=>{const _e=parseTargets(et),tt=_||engine$1;let nt;if(tt._hasChildren?forEachChildren(tt,rt=>{rt._hasChildren||(nt=removeTargetsFromAnimation(_e,rt),nt&&!rt._head&&removeChild(tt,rt)),rt._head?remove(et,rt):rt._hasChildren=!1},!0):nt=removeTargetsFromAnimation(_e,tt),nt&&!tt._head){tt._hasChildren=!1;const rt=tt;rt.pause&&rt.pause()}return _e},random=(et,_,_e)=>{const tt=10**(_e||0);return floor((Math.random()*(_-et+1/tt)+et)*tt)/tt},randomPick=et=>et[random(0,et.length-1)],shuffle$1=et=>{let _=et.length-1,_e,tt;for(;_;)tt=random(0,_--),_e=et[_],et[_]=et[tt],et[tt]=_e;return et},roundPad=(et,_)=>(+et).toFixed(_),padStart=(et,_,_e)=>`${et}`.padStart(_,_e),padEnd=(et,_,_e)=>`${et}`.padEnd(_,_e),wrap$2=(et,_,_e)=>((et-_)%(_e-_)+(_e-_))%(_e-_)+_,mapRange=(et,_,_e,tt,nt)=>tt+(et-_)/(_e-_)*(nt-tt),degToRad$1=et=>et*PI/180,radToDeg$1=et=>et*180/PI,lerp$1=(et,_,_e,tt)=>{let nt=K/globals.defaults.frameRate;if(tt!==!1){const it=tt||engine$1._hasChildren&&engine$1;it&&it.deltaTime&&(nt=it.deltaTime)}const rt=1-Math.exp(-_e*nt*.1);return _e?_e===1?_:(1-rt)*et+rt*_:et},curry=(et,_=0)=>(..._e)=>_?tt=>et(..._e,tt):tt=>et(tt,..._e),chain=et=>(..._)=>{const _e=et(..._);return new Proxy(noop,{apply:(tt,nt,[rt])=>_e(rt),get:(tt,nt)=>chain((...rt)=>{const it=utils[nt](...rt);return st=>it(_e(st))})})},makeChainable=(et,_=0)=>(..._e)=>(_e.length<et.length?chain(curry(et,_)):et)(..._e),utils={$:registerTargets,get:getTargetValue,set:setTargetValues,remove,cleanInlineStyles,random,randomPick,shuffle:shuffle$1,lerp:lerp$1,clamp:makeChainable(clamp$2),round:makeChainable(round$2),snap:makeChainable(snap),wrap:makeChainable(wrap$2),interpolate:makeChainable(interpolate,1),mapRange:makeChainable(mapRange),roundPad:makeChainable(roundPad),padStart:makeChainable(padStart),padEnd:makeChainable(padEnd),degToRad:makeChainable(degToRad$1),radToDeg:makeChainable(radToDeg$1)},springsCache=new Map,spring=(et=1,_=100,_e=10,tt=0)=>{const nt=[et,_,_e,tt];let rt=springsCache.get(nt);if(!rt){const it=clamp$2(et,0,K),st=clamp$2(_,1,K),ot=clamp$2(_e,.1,K),at=clamp$2(sqrt(st/it),minValue,K),lt=ot/(2*sqrt(st*it)),ct=lt<1?at*sqrt(1-lt*lt):0,ht=lt<1?(lt*at+-tt)/ct:-tt+at,ut=K/60/100,ft=1e-4,dt=mt=>(lt<1?mt=exp(-mt*lt*at)*(1*cos(ct*mt)+ht*sin(ct*mt)):mt=(1+ht*mt)*exp(-mt*at),1-mt),pt=(()=>{let mt=0;for(;;){if(abs$1(1-dt(mt))<ft){const vt=mt;let yt=1;for(;mt+=ut,!(abs$1(1-dt(mt))>=ft);)if(yt++,yt===16)return vt}mt+=ut}})();rt={duration:round$2(pt*K,0),solver:mt=>round$2(dt(pt*mt),5)},springsCache.set(nt,rt)}return rt},getPrevChildOffset=(et,_)=>{if(stringStartsWith(_,"<")){const _e=_[1]==="<",tt=et._tail,nt=tt?tt._offset+tt._delay:0;return _e?nt:nt+tt.duration}},parseTimelinePosition=(et,_)=>{let _e=et._iterationDuration;if(_e===minValue&&(_e=0),isUnd(_))return _e;if(isNum(+_))return+_;const tt=_,nt=et?et.labels:null,rt=!isNil(nt),it=getPrevChildOffset(et,tt),st=!isUnd(it),ot=relativeValuesExecRgx.exec(tt);if(ot){const at=ot[0],lt=tt.split(at),ct=rt&&lt[0]?nt[lt[0]]:_e,ht=st?it:rt?ct:_e,ut=+lt[1];return getRelativeValue(ht,ut,at[0])}else return st?it:rt?isUnd(nt[tt])?_e:nt[tt]:_e};function addTlChild(et,_,_e,tt,nt,rt){const it=isNum(et.duration)&&et.duration<=minValue?_e-minValue:_e;tick(_,it,1,1,tickModes.AUTO);const st=tt?new Animation(tt,et,_,it,!1,nt,rt):new Timer(et,_,it);return st.init(1),addChild(_,st),forEachChildren(_,ot=>{const lt=ot._offset+ot._delay+ot.duration;lt>_._iterationDuration&&(_._iterationDuration=lt)}),_.duration=clampInfinity((_._iterationDuration+_._loopDelay)*_._iterationCount-_._loopDelay),_}class Timeline extends Timer{constructor(_={}){super(_,null,0),this.duration=0,this.labels={};const _e=_.defaults,tt=globals.defaults;this.defaults=_e?mergeObjects(_e,tt):tt,this.onRender=_.onRender||tt.onRender;const nt=setValue(_.playbackEase,tt.playbackEase);this._ease=nt?parseEasings(nt):null,this._iterationDuration=0,this._head=null,this._tail=null}add(_,_e,tt){const nt=isObj(_e),rt=isObj(_),it=isFnc(_);if(nt||rt||it){if(this._hasChildren=!0,nt){const st=_e;if(isFnc(tt)){const ot=tt,at=parseTargets(_),lt=this.duration,ct=this._iterationDuration,ht=st.id;let ut=0;const ft=at.length;at.forEach(dt=>{const pt={...st};this.duration=lt,this._iterationDuration=ct,isUnd(ht)||(pt.id=ht+"-"+ut),addTlChild(pt,this,ot(dt,ut,ft,this),dt,ut,ft),ut++})}else addTlChild(st,this,parseTimelinePosition(this,tt),_)}else addTlChild(rt?_:{onComplete:_,duration:minValue},this,parseTimelinePosition(this,_e));return this.init(1),this._autoplay?this.play():this}else if(isStr(_))return this.labels[_]=parseTimelinePosition(this,_e),this}set(_,_e,tt){return isUnd(_e)?this:(_e.duration=minValue,_e.composition=compositionTypes.replace,this.add(_,_e,tt))}stretch(_){const _e=this.duration;if(_e===_)return this;const tt=_/_e,nt=this.labels;forEachChildren(this,rt=>{rt.stretch(rt.duration*tt)});for(let rt in nt)nt[rt]*=tt;return super.stretch(_)}refresh(){return forEachChildren(this,_=>{_.refresh()}),this}revert(){return super.revert(),forEachChildren(this,_=>_.revert,!0),cleanInlineStyles(this)}then(_){return super.then(_)}}const stagger=(et,_={})=>{let _e=[],tt=0;const nt=_.from,rt=_.reversed,it=_.ease,st=!isUnd(it),at=(st?isObj(it):!1)?it.solver:st?parseEasings(it):null,lt=_.grid,ct=_.axis,ht=isUnd(nt)||nt===0||nt==="first",ut=nt==="center",ft=nt==="last",dt=isArr(et),pt=parseNumber(dt?et[0]:et),mt=dt?parseNumber(et[1]):0,vt=unitsExecRgx.exec(dt?et[1]:et),yt=_.start||0+(dt?pt:0);let _t=ht?0:isNum(nt)?nt:0;return(St,bt,Et,Mt)=>{if(ut&&(_t=(Et-1)/2),ft&&(_t=Et-1),!_e.length){for(let Rt=0;Rt<Et;Rt++){if(!lt)_e.push(abs$1(_t-Rt));else{const It=ut?(lt[0]-1)/2:_t%lt[0],Dt=ut?(lt[1]-1)/2:floor(_t/lt[0]),Ft=Rt%lt[0],$t=floor(Rt/lt[0]),Yt=It-Ft,Lt=Dt-$t;let Ot=sqrt(Yt*Yt+Lt*Lt);ct==="x"&&(Ot=-Yt),ct==="y"&&(Ot=-Lt),_e.push(Ot)}tt=max$3(..._e)}at&&(_e=_e.map(Rt=>at(Rt/tt)*tt)),rt&&(_e=_e.map(Rt=>ct?Rt<0?Rt*-1:-Rt:abs$1(tt-Rt)))}const Tt=dt?(mt-pt)/tt:pt;let Ct=(Mt?parseTimelinePosition(Mt,isUnd(_.start)?Mt._iterationDuration:yt):yt)+(Tt*round$2(_e[bt],2)||0);return _.modifier&&(Ct=_.modifier(Ct)),vt&&(Ct=`${Ct}${vt[2]}`),Ct}},createTimer=et=>new Timer(et,null,0).init(),animate=(et,_)=>new Animation(et,_,null,0,!1).init(),createTimeline=et=>new Timeline(et).init();isBrowser$1&&(win.AnimeJS||(win.AnimeJS=[]),win.AnimeJS.push({version:"4.0.0-beta.100.alpha-4",engine:engine$1}),doc.addEventListener("visibilitychange",()=>engine$1.suspendWhenHidden?doc.hidden?engine$1.suspend():engine$1.resume():0));var react_1=reactExports,isFunction=function(et){return typeof et=="function"},useStateRef=function(et){var _=react_1.useState(et),_e=_[0],tt=_[1],nt=react_1.useRef(_e),rt=react_1.useCallback(function(it){nt.current=isFunction(it)?it(nt.current):it,tt(nt.current)},[]);return[_e,rt,nt]},dist=useStateRef;const useState=getDefaultExportFromCjs(dist),hasMouse=function(){return matchMedia("(hover: hover)").matches}(),randomFloat=(et,_)=>Math.random()*(_-et)+et,shuffle=et=>{for(var _=et.length-1;_>0;_--){var _e=Math.floor(Math.random()*(_+1)),tt=et[_];et[_]=et[_e],et[_e]=tt}},randomInt=(et,_)=>Math.floor(randomFloat(et,_)),umod=(et,_)=>{const _e=et%_;return Math.floor(_e>=0?_e:_e+_)},isDigit=et=>/^\d$/.test(et),isUpper=et=>/^[A-Z]$/.test(et),isLower=et=>/^[a-z]$/.test(et),allowedGlyph=et=>/^[a-zA-Z0-9\/+\-]+$/.test(et),randomElement=et=>et[Math.floor(Math.random()*et.length)],textWidth=(et,_)=>{const _e=document.createElement("canvas").getContext("2d");return _e?(_e.font=_,_e.measureText(et).width):0},chunk=(et,_)=>et.reduce((_e,tt,nt)=>nt%_?_e:[..._e,et.slice(nt,nt+_)],[]),oneRandomArray=et=>{let _=[1];for(var _e=0;_e<et-1;_e++)_.push(Math.random());return _.sort((tt,nt)=>tt-nt),_},distribute=(et,_)=>{const _e=_.map(rt=>Math.floor(et*rt/100)),tt=_e.reduce((rt,it)=>rt+it,0),nt=et-tt;for(let rt=0;rt<nt;rt++)_e[rt]++;return _e};function hexToRgb(et){var _=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(et);return _?{r:parseInt(_[1],16)/255,g:parseInt(_[2],16)/255,b:parseInt(_[3],16)/255}:null}function componentToHex(et){var _=et.toString(16);return _.length==1?"0"+_:_}function rgbToHex(et,_,_e){return"#"+componentToHex(et)+componentToHex(_)+componentToHex(_e)}function interpolateColor(et,_,_e){return _e<=0?et:_e>=1?_:{r:et.r+(_.r-et.r)*_e,g:et.g+(_.g-et.g)*_e,b:et.b+(_.b-et.b)*_e}}function lzw_decode(et){for(var _={},_e=(et+"").split(""),tt=_e[0],nt=tt,rt=[tt],it=256,st,ot=1;ot<_e.length;ot++){var at=_e[ot].charCodeAt(0);at<256?st=_e[ot]:st=_[at]?_[at]:nt+tt,rt.push(st),tt=st.charAt(0),_[it]=nt+tt,it++,nt=st}return rt.join("")}function nthSubstring(et,_,_e){for(var tt=et.length,nt=-1;_e--&&nt++<tt&&(nt=et.indexOf(_,nt),!(nt<0)););return nt}function furthestCorner(et,_,_e,tt){return[{x:0,y:0},{x:_e,y:0},{x:0,y:tt},{x:_e,y:tt}].reduce((rt,it)=>{const st=Math.sqrt((et-it.x)**2+(_-it.y)**2);return Math.max(rt,st)},0)}const squareCount=16,maxSquareIndex=squareCount*squareCount,squareLength={current:1e4},setLength=et=>{squareLength.current=et},indexOf=(et,_)=>Math.floor(_/squareLength.current)*squareCount+Math.floor(et/squareLength.current),getVisible=(et,_,_e)=>{const tt=Math.min(Math.ceil(window.innerHeight/squareLength.current),squareCount),nt=Math.min(Math.ceil(window.innerWidth/squareLength.current),squareCount),rt=et.filter((it,st)=>{const ot=rowOf(st)<tt&&colOf(st)<nt;return!ot&&_e&&_e(et[st],st),ot});for(let it=0;it<rt.length;it++)if(rt[it].id===et[_].id)return{visible:rt,visibleIndex:it,visibleRows:tt,visibleCols:nt};return{visible:[],visibleIndex:-1,visibleRows:tt,visibleCols:nt}},rowOf=(et,_)=>Math.floor(et/(_||squareCount)),colOf=(et,_)=>et%(_||squareCount),ringOf=(et,_,_e)=>Math.max(Math.abs(rowOf(et,_e)-rowOf(_,_e)),Math.abs(colOf(et,_e)-colOf(_,_e))),ring1=et=>{const _=[],_e=rowOf(et);return et-squareCount-1>=0&&rowOf(et-squareCount-1)===_e-1&&_.push(et-squareCount-1),et-squareCount>=0&&_.push(et-squareCount),et-squareCount+1>=0&&rowOf(et-squareCount+1)===_e-1&&_.push(et-squareCount+1),et+1<maxSquareIndex&&rowOf(et+1)===_e&&_.push(et+1),et+squareCount+1<maxSquareIndex&&rowOf(et+squareCount+1)===_e+1&&_.push(et+squareCount+1),et+squareCount<maxSquareIndex&&_.push(et+squareCount),et+squareCount-1<maxSquareIndex&&rowOf(et+squareCount-1)===_e+1&&_.push(et+squareCount-1),et-1>=0&&rowOf(et-1)===_e&&_.push(et-1),_},ring2=et=>{const _=[],_e=rowOf(et);return et-squareCount*2-2>=0&&rowOf(et-squareCount*2-2)===_e-2&&_.push(et-squareCount*2-2),et-squareCount*2-1>=0&&rowOf(et-squareCount*2-1)===_e-2&&_.push(et-squareCount*2-1),et-squareCount*2>=0&&_.push(et-squareCount*2),et-squareCount*2+1>=0&&rowOf(et-squareCount*2+1)===_e-2&&_.push(et-squareCount*2+1),et-squareCount*2+2>=0&&rowOf(et-squareCount*2+2)===_e-2&&_.push(et-squareCount*2+2),et-squareCount+2>=0&&rowOf(et-squareCount+2)===_e-1&&_.push(et-squareCount+2),et+2<maxSquareIndex&&rowOf(et+2)===_e&&_.push(et+2),et+squareCount+2<maxSquareIndex&&rowOf(et+squareCount+2)===_e+1&&_.push(et+squareCount+2),et+squareCount*2+2<maxSquareIndex&&rowOf(et+squareCount*2+2)===_e+2&&_.push(et+squareCount*2+2),et+squareCount*2+1<maxSquareIndex&&rowOf(et+squareCount*2+1)===_e+2&&_.push(et+squareCount*2+1),et+squareCount*2<maxSquareIndex&&_.push(et+squareCount*2),et+squareCount*2-1<maxSquareIndex&&rowOf(et+squareCount*2-1)===_e+2&&_.push(et+squareCount*2-1),et+squareCount*2-2<maxSquareIndex&&rowOf(et+squareCount*2-2)===_e+2&&_.push(et+squareCount*2-2),et+squareCount-2<maxSquareIndex&&rowOf(et+squareCount-2)===_e+1&&_.push(et+squareCount-2),et-2>=0&&rowOf(et-2)===_e&&_.push(et-2),et-squareCount-2>=0&&rowOf(et-squareCount-2)===_e-1&&_.push(et-squareCount-2),_},pick2=(et,_)=>{const _e=[],tt=ring2(et);shuffle(tt);for(let nt=0;nt<_;nt++)_e.push(tt[nt]);return _e},block2=et=>{const _=[et];return _.push(...ring1(et)),_.push(...ring2(et)),_},topdown=(et,_,_e)=>{const tt=[];_e=_e||squareCount;for(var nt=colOf(et,_e);nt<et;)tt.push(nt),nt+=_e;return tt},leftright=(et,_,_e)=>{const tt=[];_e=_e||squareCount;for(var nt=rowOf(et,_e)*_e;nt<et;)tt.push(nt),nt++;return tt},rightleft=(et,_,_e)=>{const tt=[];_e=_e||squareCount;for(var nt=rowOf(et,_e)*_e+_e-1;nt>et;)tt.push(nt),nt--;return tt},bottomup=(et,_,_e)=>{const tt=[];_=_||squareCount,_e=_e||squareCount;for(var nt=colOf(et,_e)+_e*(_-1);nt>et;)tt.push(nt),nt-=_e;return tt},MatterColor={Red:"#fe6d73",Yellow:"#ffcb77",Green:"#17c3b2",Blue:"#227c9d",RedRGB:hexToRgb("#fe6d73"),YellowRGB:hexToRgb("#ffcb77"),GreenRGB:hexToRgb("#17c3b2"),BlueRGB:hexToRgb("#227c9d"),Random:()=>"#ffffff",RandomRGB:()=>({r:255,g:255,b:255}),Array:()=>[""],RandomArray:et=>[""]},colors$1=[MatterColor.Red,MatterColor.Yellow,MatterColor.Green,MatterColor.Blue];MatterColor.Random=()=>colors$1[Math.floor(Math.random()*colors$1.length)];MatterColor.RandomRGB=()=>{const et=hexToRgb(MatterColor.Random());return et===null?{r:255,g:255,b:255}:et};MatterColor.RandomArray=et=>Array.from({length:et},()=>MatterColor.Random());MatterColor.Array=()=>colors$1;const MatterTone={White:"#FAF9F6",Black:"#181717",WhiteRGB:hexToRgb("#FAF9F6"),BlackRGB:hexToRgb("#181717")},squareDuration=300,squareSpeed=squareDuration/4;let animating=!1,animatingFalse=()=>animating=!1;const rippleEffect=(et,_,_e,tt,nt,rt)=>{if(animating)return null;animating=!0;const{visible:it,visibleCols:st,visibleIndex:ot}=getVisible(et,_,lt=>{utils.set(lt,{scale:1,background:_e,rotate:0,translateX:0,translateY:0})});return animate(it,{scale:[{to:0},{to:1}],background:_e,rotate:0,translateX:0,translateY:0,duration:squareDuration,delay:stagger(squareSpeed,{grid:[st,st],from:ot,ease:"linear"}),onBegin:tt,onUpdate:nt,onComplete:()=>{rt(),animatingFalse()}})};let jumpScale=.8;const waterEffect=(et,_,_e)=>{if(animating)return null;animating=!0;const{visible:tt,visibleCols:nt,visibleIndex:rt}=getVisible(et,indexOf(_,_e)),it=animate(tt,{scale:jumpScale,ease:"outElastic(3, 0.45)",delay:stagger(30,{grid:[nt,nt],from:rt}),onComplete:animatingFalse});return jumpScale=jumpScale===.8?1:.8,it},sunflowerEffect=(et,_,_e)=>{if(animating)return null;animating=!0;const tt=MatterColor.RandomRGB(),nt=indexOf(_,_e),{visible:rt,visibleCols:it,visibleIndex:st}=getVisible(et,nt,ct=>{utils.set(ct,{translateX:0,translateY:0,background:rgbToHex(tt.r,tt.g,tt.b)})}),ot=rowOf(st,it),at=colOf(st,it);return animate(rt,{translateX:(ct,ht)=>{if(ht===void 0)return 0;const ut=colOf(ht,it);return ut===at?0:(ut>at?1:-1)*Math.log1p(ringOf(st,ht,it)-1)*75+"%"},translateY:(ct,ht)=>{if(ht===void 0)return 0;const ut=rowOf(ht,it);return ut===ot?0:(ut>ot?1:-1)*Math.log1p(ringOf(st,ht,it)-1)*75+"%"},background:(ct,ht)=>{if(ht===void 0)return MatterTone.White;const ut=interpolateColor(MatterTone.WhiteRGB,tt,1-ringOf(st,ht,it)/squareCount);return`rgb(${Math.round(ut.r*255)}, ${Math.round(ut.g*255)}, ${Math.round(ut.b*255)})`},duration:750,delay:stagger(40,{grid:[it,it],from:st}),onComplete:animatingFalse})},shootDelay=50,shootDuration=200,shootTranslation=40,shootWaveDuration1=600,shootWaveDuration2=400,shootWaveDelay=30,shootBaseColor=MatterColor.Red,shootColor=[MatterTone.White,MatterColor.Yellow,MatterColor.Green,MatterColor.Blue],rotateShootColor=()=>{shootColor.push(shootColor.shift())},shootEffect=(et,_,_e)=>{if(animating)return null;animating=!0;const tt=indexOf(_,_e),{visible:nt,visibleCols:rt,visibleRows:it,visibleIndex:st}=getVisible(et,tt),ot=rowOf(st,rt),at=colOf(st,rt),lt=topdown(st,it,rt),ct=leftright(st,it,rt),ht=rightleft(st,it,rt),ut=bottomup(st,it,rt),ft=Math.max(lt.length,ct.length,ht.length,ut.length),dt=createTimeline(),pt=Math.floor(Math.random()*MatterColor.Array().length);return dt.add(lt.map(mt=>et[mt]),{background:[{to:shootColor[0]},{to:shootBaseColor}],duration:shootDuration,delay:stagger(shootDelay,{start:shootDelay*(ft-lt.length),from:0,ease:"linear"})},0).add(ct.map(mt=>et[mt]),{background:[{to:shootColor[1]},{to:shootBaseColor}],duration:shootDuration,delay:stagger(shootDelay,{start:shootDelay*(ft-ct.length),from:0,ease:"linear"})},0).add(ht.map(mt=>et[mt]),{background:[{to:shootColor[1]},{to:shootBaseColor}],duration:shootDuration,delay:stagger(shootDelay,{start:shootDelay*(ft-ht.length),from:0,ease:"linear"})},0).add(ut.map(mt=>et[mt]),{background:[{to:shootColor[3]},{to:shootBaseColor}],duration:shootDuration,delay:stagger(shootDelay,{start:shootDelay*(ft-ut.length),from:0,ease:"linear"})},0).add(nt,{background:[{to:(mt,vt)=>vt===void 0?shootBaseColor:MatterColor.Array()[(ringOf(st,vt,rt)+pt)%4],duration:shootWaveDuration1},{to:shootBaseColor,duration:shootWaveDuration2}],translateX:[{to:(mt,vt)=>vt===void 0?0:(colOf(vt,rt)-at)*shootTranslation+"%",duration:shootWaveDuration1},{to:0,duration:shootWaveDuration2}],translateY:[{to:(mt,vt)=>vt===void 0?0:(rowOf(vt,rt)-ot)*shootTranslation+"%",duration:shootWaveDuration1},{to:0,duration:shootWaveDuration2}],ease:"outQuad",delay:stagger(shootWaveDelay,{grid:[rt,rt],from:st})},`-=${shootDelay}`).add({duration:1,onComplete:animatingFalse},"+=0"),rotateShootColor(),dt},crossColor=MatterColor.Blue,crossEffect=(et,_,_e)=>{if(animating)return null;animating=!0;const tt=indexOf(_,_e),{visible:nt,visibleCols:rt,visibleIndex:it}=getVisible(et,tt,lt=>{utils.set(lt,{rotate:0,background:crossColor})}),st=rowOf(it,rt),ot=colOf(it,rt);return animate(nt,{rotate:(lt,ct)=>ct===void 0?0:Math.atan2(rowOf(ct,rt)-st,colOf(ct,rt)-ot)+"rad",background:(lt,ct)=>ct===void 0?crossColor:rowOf(ct,rt)===st||colOf(ct,rt)===ot?MatterTone.Black:crossColor,duration:800,ease:"outExpo",delay:stagger(50,{grid:[rt,rt],from:it}),onComplete:animatingFalse})},paintColors=[MatterColor.Red,MatterColor.Green,MatterColor.Blue,MatterTone.White,MatterTone.Black],randomPaint=()=>paintColors[Math.floor(Math.random()*paintColors.length)],paintEffect=(et,_,_e)=>animating?null:(animating=!0,animate(et[indexOf(_,_e)],{background:randomPaint(),ease:"inOutQuad",duration:200,onComplete:animatingFalse})),punchDuration=150,holeEffect=(et,_,_e)=>{if(animating)return null;animating=!0,JSON.parse(JSON.stringify(_)).forEach((it,st)=>{pick2(it,_e[st]).forEach(ot=>{_.push(ot)})}),shuffle(_);var nt=0;const rt=createTimer({duration:punchDuration+10,loop:!0,onLoop:()=>{if(nt>=_.length){rt.pause(),animatingFalse();return}punchEffectWrapper(et,_[nt++],!0)}})},punchEffectWrapper=(et,_,_e=!1)=>{if(!_e&&animating)return null;_e||(animating=!0);const tt=block2(_);return animate(tt.map(rt=>et[rt]),{scale:(rt,it)=>it===void 0||rt===void 0?0:Math.max(utils.get(rt,"scale")-(1-Math.sqrt((rowOf(tt[it])-rowOf(_))**2+(colOf(tt[it])-colOf(_))**2)/3),0),duration:punchDuration,onComplete:()=>{_e||animatingFalse()}})},punchEffect=(et,_,_e)=>punchEffectWrapper(et,indexOf(_,_e)),timerEffect=(et,_,_e,tt)=>animating?null:(animating=!0,createTimer({duration:et,frameRate:60,onBegin:_,onUpdate:_e,onComplete:()=>{tt(),animatingFalse()}})),slideOptions=[{hiding:{translateY:{from:"0%",to:"100%"}},showing:{translateX:0,translateY:{from:"-100%",to:"0%"}}},{hiding:{translateX:{from:"0%",to:"-100%"}},showing:{translateX:{from:"100%",to:"0%"},translateY:0}},{hiding:{translateY:{from:"0%",to:"-100%"}},showing:{translateX:0,translateY:{from:"100%",to:"0%"}}},{hiding:{translateX:{from:"0%",to:"100%"}},showing:{translateX:{from:"-100%",to:"0%"},translateY:0}}],strToSlideOption=et=>{switch(et){case"top":return slideOptions[0];case"right":return slideOptions[1];case"bottom":return slideOptions[2];case"left":return slideOptions[3]}},randomSlide=(et,_,_e,tt,nt,rt)=>{const it=_e==="random"?randomElement(slideOptions):strToSlideOption(_e);return animating?null:(animating=!0,et&&animate(et,{...it.hiding,duration:tt,ease:"inOutQuad",onBegin:nt,onComplete:rt}),animate(_,{...it.showing,duration:tt,ease:"inOutQuad",onBegin:nt,onComplete:()=>{rt(),animatingFalse()}}))},PageContext=reactExports.createContext({active:-1,ready:-1}),usePage=()=>({active:reactExports.useContext(PageContext).active+1,ready:reactExports.useContext(PageContext).ready+1});function SlatePage({text:et,inner:_,tutorial:_e,empty:tt,squareEffect:nt,containerRef:rt,pageNumber:it}){const{active:st,ready:ot}=usePage(),at=reactExports.useRef(null),lt=reactExports.useRef(!1),ct=reactExports.useRef(null),[ht,ut]=useState(_e),ft=mt=>{nt(mt.clientX,mt.clientY),ct.current&&(ct.current.style.display="none")},dt=mt=>{mt.stopPropagation(),lt.current?(at.current.classList.remove("fold-expanded"),at.current.classList.add("fold-contracted")):(at.current.classList.remove("fold-contracted"),at.current.classList.add("fold-expanded")),lt.current=!lt.current,ht&&ut(!1)};return reactExports.useEffect(()=>{st===it||rt.current.classList.remove("show")},[st]),reactExports.useEffect(()=>{ot===it&&rt.current.classList.add("show")},[ot]),reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{className:"w-svw h-svh flex justify-center items-center pointer-events-auto text-slate",onClick:ft,children:!tt&&jsxRuntimeExports.jsxs("div",{className:"party-brick no-select",children:[jsxRuntimeExports.jsx("div",{className:"h-max w-max relative",children:et}),jsxRuntimeExports.jsx("div",{ref:at,className:"h-full w-full absolute top-0 fold-contracted",onClick:dt,children:_}),ht&&jsxRuntimeExports.jsxs("div",{className:"w-full h-max absolute text-headingHalf flex items-end top-0 left-0 -translate-y-[110%] translate-x-[5%]",children:[jsxRuntimeExports.jsx("svg",{className:"inline-svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:jsxRuntimeExports.jsx("path",{d:"M31.71 1.71 30.29.29 2 28.59V16H0v15a1 1 0 0 0 1 1h16v-2H3.41z","data-name":"6-Arrow Down"})}),"press to reveal"]})]})}),[ht])}var matter={exports:{}};/*!
 * matter-js 0.19.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(et,_){(function(tt,nt){et.exports=nt()})(commonjsGlobal,function(){return function(_e){var tt={};function nt(rt){if(tt[rt])return tt[rt].exports;var it=tt[rt]={i:rt,l:!1,exports:{}};return _e[rt].call(it.exports,it,it.exports,nt),it.l=!0,it.exports}return nt.m=_e,nt.c=tt,nt.d=function(rt,it,st){nt.o(rt,it)||Object.defineProperty(rt,it,{enumerable:!0,get:st})},nt.r=function(rt){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(rt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(rt,"__esModule",{value:!0})},nt.t=function(rt,it){if(it&1&&(rt=nt(rt)),it&8||it&4&&typeof rt=="object"&&rt&&rt.__esModule)return rt;var st=Object.create(null);if(nt.r(st),Object.defineProperty(st,"default",{enumerable:!0,value:rt}),it&2&&typeof rt!="string")for(var ot in rt)nt.d(st,ot,(function(at){return rt[at]}).bind(null,ot));return st},nt.n=function(rt){var it=rt&&rt.__esModule?function(){return rt.default}:function(){return rt};return nt.d(it,"a",it),it},nt.o=function(rt,it){return Object.prototype.hasOwnProperty.call(rt,it)},nt.p="",nt(nt.s=20)}([function(_e,tt){var nt={};_e.exports=nt,function(){nt._baseDelta=1e3/60,nt._nextId=0,nt._seed=0,nt._nowStartTime=+new Date,nt._warnedOnce={},nt._decomp=null,nt.extend=function(it,st){var ot,at;typeof st=="boolean"?(ot=2,at=st):(ot=1,at=!0);for(var lt=ot;lt<arguments.length;lt++){var ct=arguments[lt];if(ct)for(var ht in ct)at&&ct[ht]&&ct[ht].constructor===Object&&(!it[ht]||it[ht].constructor===Object)?(it[ht]=it[ht]||{},nt.extend(it[ht],at,ct[ht])):it[ht]=ct[ht]}return it},nt.clone=function(it,st){return nt.extend({},st,it)},nt.keys=function(it){if(Object.keys)return Object.keys(it);var st=[];for(var ot in it)st.push(ot);return st},nt.values=function(it){var st=[];if(Object.keys){for(var ot=Object.keys(it),at=0;at<ot.length;at++)st.push(it[ot[at]]);return st}for(var lt in it)st.push(it[lt]);return st},nt.get=function(it,st,ot,at){st=st.split(".").slice(ot,at);for(var lt=0;lt<st.length;lt+=1)it=it[st[lt]];return it},nt.set=function(it,st,ot,at,lt){var ct=st.split(".").slice(at,lt);return nt.get(it,st,0,-1)[ct[ct.length-1]]=ot,ot},nt.shuffle=function(it){for(var st=it.length-1;st>0;st--){var ot=Math.floor(nt.random()*(st+1)),at=it[st];it[st]=it[ot],it[ot]=at}return it},nt.choose=function(it){return it[Math.floor(nt.random()*it.length)]},nt.isElement=function(it){return typeof HTMLElement<"u"?it instanceof HTMLElement:!!(it&&it.nodeType&&it.nodeName)},nt.isArray=function(it){return Object.prototype.toString.call(it)==="[object Array]"},nt.isFunction=function(it){return typeof it=="function"},nt.isPlainObject=function(it){return typeof it=="object"&&it.constructor===Object},nt.isString=function(it){return toString.call(it)==="[object String]"},nt.clamp=function(it,st,ot){return it<st?st:it>ot?ot:it},nt.sign=function(it){return it<0?-1:1},nt.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-nt._nowStartTime},nt.random=function(it,st){return it=typeof it<"u"?it:0,st=typeof st<"u"?st:1,it+rt()*(st-it)};var rt=function(){return nt._seed=(nt._seed*9301+49297)%233280,nt._seed/233280};nt.colorToNumber=function(it){return it=it.replace("#",""),it.length==3&&(it=it.charAt(0)+it.charAt(0)+it.charAt(1)+it.charAt(1)+it.charAt(2)+it.charAt(2)),parseInt(it,16)},nt.logLevel=1,nt.log=function(){console&&nt.logLevel>0&&nt.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},nt.info=function(){console&&nt.logLevel>0&&nt.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},nt.warn=function(){console&&nt.logLevel>0&&nt.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},nt.warnOnce=function(){var it=Array.prototype.slice.call(arguments).join(" ");nt._warnedOnce[it]||(nt.warn(it),nt._warnedOnce[it]=!0)},nt.deprecated=function(it,st,ot){it[st]=nt.chain(function(){nt.warnOnce(" deprecated ",ot)},it[st])},nt.nextId=function(){return nt._nextId++},nt.indexOf=function(it,st){if(it.indexOf)return it.indexOf(st);for(var ot=0;ot<it.length;ot++)if(it[ot]===st)return ot;return-1},nt.map=function(it,st){if(it.map)return it.map(st);for(var ot=[],at=0;at<it.length;at+=1)ot.push(st(it[at]));return ot},nt.topologicalSort=function(it){var st=[],ot=[],at=[];for(var lt in it)!ot[lt]&&!at[lt]&&nt._topologicalSort(lt,ot,at,it,st);return st},nt._topologicalSort=function(it,st,ot,at,lt){var ct=at[it]||[];ot[it]=!0;for(var ht=0;ht<ct.length;ht+=1){var ut=ct[ht];ot[ut]||st[ut]||nt._topologicalSort(ut,st,ot,at,lt)}ot[it]=!1,st[it]=!0,lt.push(it)},nt.chain=function(){for(var it=[],st=0;st<arguments.length;st+=1){var ot=arguments[st];ot._chained?it.push.apply(it,ot._chained):it.push(ot)}var at=function(){for(var lt,ct=new Array(arguments.length),ht=0,ut=arguments.length;ht<ut;ht++)ct[ht]=arguments[ht];for(ht=0;ht<it.length;ht+=1){var ft=it[ht].apply(lt,ct);typeof ft<"u"&&(lt=ft)}return lt};return at._chained=it,at},nt.chainPathBefore=function(it,st,ot){return nt.set(it,st,nt.chain(ot,nt.get(it,st)))},nt.chainPathAfter=function(it,st,ot){return nt.set(it,st,nt.chain(nt.get(it,st),ot))},nt.setDecomp=function(it){nt._decomp=it},nt.getDecomp=function(){var it=nt._decomp;try{!it&&typeof window<"u"&&(it=window.decomp),!it&&typeof commonjsGlobal<"u"&&(it=commonjsGlobal.decomp)}catch{it=null}return it}}()},function(_e,tt){var nt={};_e.exports=nt,function(){nt.create=function(rt){var it={min:{x:0,y:0},max:{x:0,y:0}};return rt&&nt.update(it,rt),it},nt.update=function(rt,it,st){rt.min.x=1/0,rt.max.x=-1/0,rt.min.y=1/0,rt.max.y=-1/0;for(var ot=0;ot<it.length;ot++){var at=it[ot];at.x>rt.max.x&&(rt.max.x=at.x),at.x<rt.min.x&&(rt.min.x=at.x),at.y>rt.max.y&&(rt.max.y=at.y),at.y<rt.min.y&&(rt.min.y=at.y)}st&&(st.x>0?rt.max.x+=st.x:rt.min.x+=st.x,st.y>0?rt.max.y+=st.y:rt.min.y+=st.y)},nt.contains=function(rt,it){return it.x>=rt.min.x&&it.x<=rt.max.x&&it.y>=rt.min.y&&it.y<=rt.max.y},nt.overlaps=function(rt,it){return rt.min.x<=it.max.x&&rt.max.x>=it.min.x&&rt.max.y>=it.min.y&&rt.min.y<=it.max.y},nt.translate=function(rt,it){rt.min.x+=it.x,rt.max.x+=it.x,rt.min.y+=it.y,rt.max.y+=it.y},nt.shift=function(rt,it){var st=rt.max.x-rt.min.x,ot=rt.max.y-rt.min.y;rt.min.x=it.x,rt.max.x=it.x+st,rt.min.y=it.y,rt.max.y=it.y+ot}}()},function(_e,tt){var nt={};_e.exports=nt,function(){nt.create=function(rt,it){return{x:rt||0,y:it||0}},nt.clone=function(rt){return{x:rt.x,y:rt.y}},nt.magnitude=function(rt){return Math.sqrt(rt.x*rt.x+rt.y*rt.y)},nt.magnitudeSquared=function(rt){return rt.x*rt.x+rt.y*rt.y},nt.rotate=function(rt,it,st){var ot=Math.cos(it),at=Math.sin(it);st||(st={});var lt=rt.x*ot-rt.y*at;return st.y=rt.x*at+rt.y*ot,st.x=lt,st},nt.rotateAbout=function(rt,it,st,ot){var at=Math.cos(it),lt=Math.sin(it);ot||(ot={});var ct=st.x+((rt.x-st.x)*at-(rt.y-st.y)*lt);return ot.y=st.y+((rt.x-st.x)*lt+(rt.y-st.y)*at),ot.x=ct,ot},nt.normalise=function(rt){var it=nt.magnitude(rt);return it===0?{x:0,y:0}:{x:rt.x/it,y:rt.y/it}},nt.dot=function(rt,it){return rt.x*it.x+rt.y*it.y},nt.cross=function(rt,it){return rt.x*it.y-rt.y*it.x},nt.cross3=function(rt,it,st){return(it.x-rt.x)*(st.y-rt.y)-(it.y-rt.y)*(st.x-rt.x)},nt.add=function(rt,it,st){return st||(st={}),st.x=rt.x+it.x,st.y=rt.y+it.y,st},nt.sub=function(rt,it,st){return st||(st={}),st.x=rt.x-it.x,st.y=rt.y-it.y,st},nt.mult=function(rt,it){return{x:rt.x*it,y:rt.y*it}},nt.div=function(rt,it){return{x:rt.x/it,y:rt.y/it}},nt.perp=function(rt,it){return it=it===!0?-1:1,{x:it*-rt.y,y:it*rt.x}},nt.neg=function(rt){return{x:-rt.x,y:-rt.y}},nt.angle=function(rt,it){return Math.atan2(it.y-rt.y,it.x-rt.x)},nt._temp=[nt.create(),nt.create(),nt.create(),nt.create(),nt.create(),nt.create()]}()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(2),st=nt(0);(function(){rt.create=function(ot,at){for(var lt=[],ct=0;ct<ot.length;ct++){var ht=ot[ct],ut={x:ht.x,y:ht.y,index:ct,body:at,isInternal:!1};lt.push(ut)}return lt},rt.fromPath=function(ot,at){var lt=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,ct=[];return ot.replace(lt,function(ht,ut,ft){ct.push({x:parseFloat(ut),y:parseFloat(ft)})}),rt.create(ct,at)},rt.centre=function(ot){for(var at=rt.area(ot,!0),lt={x:0,y:0},ct,ht,ut,ft=0;ft<ot.length;ft++)ut=(ft+1)%ot.length,ct=it.cross(ot[ft],ot[ut]),ht=it.mult(it.add(ot[ft],ot[ut]),ct),lt=it.add(lt,ht);return it.div(lt,6*at)},rt.mean=function(ot){for(var at={x:0,y:0},lt=0;lt<ot.length;lt++)at.x+=ot[lt].x,at.y+=ot[lt].y;return it.div(at,ot.length)},rt.area=function(ot,at){for(var lt=0,ct=ot.length-1,ht=0;ht<ot.length;ht++)lt+=(ot[ct].x-ot[ht].x)*(ot[ct].y+ot[ht].y),ct=ht;return at?lt/2:Math.abs(lt)/2},rt.inertia=function(ot,at){for(var lt=0,ct=0,ht=ot,ut,ft,dt=0;dt<ht.length;dt++)ft=(dt+1)%ht.length,ut=Math.abs(it.cross(ht[ft],ht[dt])),lt+=ut*(it.dot(ht[ft],ht[ft])+it.dot(ht[ft],ht[dt])+it.dot(ht[dt],ht[dt])),ct+=ut;return at/6*(lt/ct)},rt.translate=function(ot,at,lt){lt=typeof lt<"u"?lt:1;var ct=ot.length,ht=at.x*lt,ut=at.y*lt,ft;for(ft=0;ft<ct;ft++)ot[ft].x+=ht,ot[ft].y+=ut;return ot},rt.rotate=function(ot,at,lt){if(at!==0){var ct=Math.cos(at),ht=Math.sin(at),ut=lt.x,ft=lt.y,dt=ot.length,pt,mt,vt,yt;for(yt=0;yt<dt;yt++)pt=ot[yt],mt=pt.x-ut,vt=pt.y-ft,pt.x=ut+(mt*ct-vt*ht),pt.y=ft+(mt*ht+vt*ct);return ot}},rt.contains=function(ot,at){for(var lt=at.x,ct=at.y,ht=ot.length,ut=ot[ht-1],ft,dt=0;dt<ht;dt++){if(ft=ot[dt],(lt-ut.x)*(ft.y-ut.y)+(ct-ut.y)*(ut.x-ft.x)>0)return!1;ut=ft}return!0},rt.scale=function(ot,at,lt,ct){if(at===1&&lt===1)return ot;ct=ct||rt.centre(ot);for(var ht,ut,ft=0;ft<ot.length;ft++)ht=ot[ft],ut=it.sub(ht,ct),ot[ft].x=ct.x+ut.x*at,ot[ft].y=ct.y+ut.y*lt;return ot},rt.chamfer=function(ot,at,lt,ct,ht){typeof at=="number"?at=[at]:at=at||[8],lt=typeof lt<"u"?lt:-1,ct=ct||2,ht=ht||14;for(var ut=[],ft=0;ft<ot.length;ft++){var dt=ot[ft-1>=0?ft-1:ot.length-1],pt=ot[ft],mt=ot[(ft+1)%ot.length],vt=at[ft<at.length?ft:at.length-1];if(vt===0){ut.push(pt);continue}var yt=it.normalise({x:pt.y-dt.y,y:dt.x-pt.x}),_t=it.normalise({x:mt.y-pt.y,y:pt.x-mt.x}),St=Math.sqrt(2*Math.pow(vt,2)),bt=it.mult(st.clone(yt),vt),Et=it.normalise(it.mult(it.add(yt,_t),.5)),Mt=it.sub(pt,it.mult(Et,St)),Tt=lt;lt===-1&&(Tt=Math.pow(vt,.32)*1.75),Tt=st.clamp(Tt,ct,ht),Tt%2===1&&(Tt+=1);for(var wt=Math.acos(it.dot(yt,_t)),Ct=wt/Tt,Rt=0;Rt<Tt;Rt++)ut.push(it.add(it.rotate(bt,Ct*Rt),Mt))}return ut},rt.clockwiseSort=function(ot){var at=rt.mean(ot);return ot.sort(function(lt,ct){return it.angle(at,lt)-it.angle(at,ct)}),ot},rt.isConvex=function(ot){var at=0,lt=ot.length,ct,ht,ut,ft;if(lt<3)return null;for(ct=0;ct<lt;ct++)if(ht=(ct+1)%lt,ut=(ct+2)%lt,ft=(ot[ht].x-ot[ct].x)*(ot[ut].y-ot[ht].y),ft-=(ot[ht].y-ot[ct].y)*(ot[ut].x-ot[ht].x),ft<0?at|=1:ft>0&&(at|=2),at===3)return!1;return at!==0?!0:null},rt.hull=function(ot){var at=[],lt=[],ct,ht;for(ot=ot.slice(0),ot.sort(function(ut,ft){var dt=ut.x-ft.x;return dt!==0?dt:ut.y-ft.y}),ht=0;ht<ot.length;ht+=1){for(ct=ot[ht];lt.length>=2&&it.cross3(lt[lt.length-2],lt[lt.length-1],ct)<=0;)lt.pop();lt.push(ct)}for(ht=ot.length-1;ht>=0;ht-=1){for(ct=ot[ht];at.length>=2&&it.cross3(at[at.length-2],at[at.length-1],ct)<=0;)at.pop();at.push(ct)}return at.pop(),lt.pop(),at.concat(lt)}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(3),st=nt(2),ot=nt(7),at=nt(0),lt=nt(1),ct=nt(11);(function(){rt._timeCorrection=!0,rt._inertiaScale=4,rt._nextCollidingGroupId=1,rt._nextNonCollidingGroupId=-1,rt._nextCategory=1,rt._baseDelta=1e3/60,rt.create=function(ut){var ft={id:at.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:it.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},dt=at.extend(ft,ut);return ht(dt,ut),dt},rt.nextGroup=function(ut){return ut?rt._nextNonCollidingGroupId--:rt._nextCollidingGroupId++},rt.nextCategory=function(){return rt._nextCategory=rt._nextCategory<<1,rt._nextCategory};var ht=function(ut,ft){ft=ft||{},rt.set(ut,{bounds:ut.bounds||lt.create(ut.vertices),positionPrev:ut.positionPrev||st.clone(ut.position),anglePrev:ut.anglePrev||ut.angle,vertices:ut.vertices,parts:ut.parts||[ut],isStatic:ut.isStatic,isSleeping:ut.isSleeping,parent:ut.parent||ut}),it.rotate(ut.vertices,ut.angle,ut.position),ct.rotate(ut.axes,ut.angle),lt.update(ut.bounds,ut.vertices,ut.velocity),rt.set(ut,{axes:ft.axes||ut.axes,area:ft.area||ut.area,mass:ft.mass||ut.mass,inertia:ft.inertia||ut.inertia});var dt=ut.isStatic?"#14151f":at.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),pt=ut.isStatic?"#555":"#ccc",mt=ut.isStatic&&ut.render.fillStyle===null?1:0;ut.render.fillStyle=ut.render.fillStyle||dt,ut.render.strokeStyle=ut.render.strokeStyle||pt,ut.render.lineWidth=ut.render.lineWidth||mt,ut.render.sprite.xOffset+=-(ut.bounds.min.x-ut.position.x)/(ut.bounds.max.x-ut.bounds.min.x),ut.render.sprite.yOffset+=-(ut.bounds.min.y-ut.position.y)/(ut.bounds.max.y-ut.bounds.min.y)};rt.set=function(ut,ft,dt){var pt;typeof ft=="string"&&(pt=ft,ft={},ft[pt]=dt);for(pt in ft)if(Object.prototype.hasOwnProperty.call(ft,pt))switch(dt=ft[pt],pt){case"isStatic":rt.setStatic(ut,dt);break;case"isSleeping":ot.set(ut,dt);break;case"mass":rt.setMass(ut,dt);break;case"density":rt.setDensity(ut,dt);break;case"inertia":rt.setInertia(ut,dt);break;case"vertices":rt.setVertices(ut,dt);break;case"position":rt.setPosition(ut,dt);break;case"angle":rt.setAngle(ut,dt);break;case"velocity":rt.setVelocity(ut,dt);break;case"angularVelocity":rt.setAngularVelocity(ut,dt);break;case"speed":rt.setSpeed(ut,dt);break;case"angularSpeed":rt.setAngularSpeed(ut,dt);break;case"parts":rt.setParts(ut,dt);break;case"centre":rt.setCentre(ut,dt);break;default:ut[pt]=dt}},rt.setStatic=function(ut,ft){for(var dt=0;dt<ut.parts.length;dt++){var pt=ut.parts[dt];pt.isStatic=ft,ft?(pt._original={restitution:pt.restitution,friction:pt.friction,mass:pt.mass,inertia:pt.inertia,density:pt.density,inverseMass:pt.inverseMass,inverseInertia:pt.inverseInertia},pt.restitution=0,pt.friction=1,pt.mass=pt.inertia=pt.density=1/0,pt.inverseMass=pt.inverseInertia=0,pt.positionPrev.x=pt.position.x,pt.positionPrev.y=pt.position.y,pt.anglePrev=pt.angle,pt.angularVelocity=0,pt.speed=0,pt.angularSpeed=0,pt.motion=0):pt._original&&(pt.restitution=pt._original.restitution,pt.friction=pt._original.friction,pt.mass=pt._original.mass,pt.inertia=pt._original.inertia,pt.density=pt._original.density,pt.inverseMass=pt._original.inverseMass,pt.inverseInertia=pt._original.inverseInertia,pt._original=null)}},rt.setMass=function(ut,ft){var dt=ut.inertia/(ut.mass/6);ut.inertia=dt*(ft/6),ut.inverseInertia=1/ut.inertia,ut.mass=ft,ut.inverseMass=1/ut.mass,ut.density=ut.mass/ut.area},rt.setDensity=function(ut,ft){rt.setMass(ut,ft*ut.area),ut.density=ft},rt.setInertia=function(ut,ft){ut.inertia=ft,ut.inverseInertia=1/ut.inertia},rt.setVertices=function(ut,ft){ft[0].body===ut?ut.vertices=ft:ut.vertices=it.create(ft,ut),ut.axes=ct.fromVertices(ut.vertices),ut.area=it.area(ut.vertices),rt.setMass(ut,ut.density*ut.area);var dt=it.centre(ut.vertices);it.translate(ut.vertices,dt,-1),rt.setInertia(ut,rt._inertiaScale*it.inertia(ut.vertices,ut.mass)),it.translate(ut.vertices,ut.position),lt.update(ut.bounds,ut.vertices,ut.velocity)},rt.setParts=function(ut,ft,dt){var pt;for(ft=ft.slice(0),ut.parts.length=0,ut.parts.push(ut),ut.parent=ut,pt=0;pt<ft.length;pt++){var mt=ft[pt];mt!==ut&&(mt.parent=ut,ut.parts.push(mt))}if(ut.parts.length!==1){if(dt=typeof dt<"u"?dt:!0,dt){var vt=[];for(pt=0;pt<ft.length;pt++)vt=vt.concat(ft[pt].vertices);it.clockwiseSort(vt);var yt=it.hull(vt),_t=it.centre(yt);rt.setVertices(ut,yt),it.translate(ut.vertices,_t)}var St=rt._totalProperties(ut);ut.area=St.area,ut.parent=ut,ut.position.x=St.centre.x,ut.position.y=St.centre.y,ut.positionPrev.x=St.centre.x,ut.positionPrev.y=St.centre.y,rt.setMass(ut,St.mass),rt.setInertia(ut,St.inertia),rt.setPosition(ut,St.centre)}},rt.setCentre=function(ut,ft,dt){dt?(ut.positionPrev.x+=ft.x,ut.positionPrev.y+=ft.y,ut.position.x+=ft.x,ut.position.y+=ft.y):(ut.positionPrev.x=ft.x-(ut.position.x-ut.positionPrev.x),ut.positionPrev.y=ft.y-(ut.position.y-ut.positionPrev.y),ut.position.x=ft.x,ut.position.y=ft.y)},rt.setPosition=function(ut,ft,dt){var pt=st.sub(ft,ut.position);dt?(ut.positionPrev.x=ut.position.x,ut.positionPrev.y=ut.position.y,ut.velocity.x=pt.x,ut.velocity.y=pt.y,ut.speed=st.magnitude(pt)):(ut.positionPrev.x+=pt.x,ut.positionPrev.y+=pt.y);for(var mt=0;mt<ut.parts.length;mt++){var vt=ut.parts[mt];vt.position.x+=pt.x,vt.position.y+=pt.y,it.translate(vt.vertices,pt),lt.update(vt.bounds,vt.vertices,ut.velocity)}},rt.setAngle=function(ut,ft,dt){var pt=ft-ut.angle;dt?(ut.anglePrev=ut.angle,ut.angularVelocity=pt,ut.angularSpeed=Math.abs(pt)):ut.anglePrev+=pt;for(var mt=0;mt<ut.parts.length;mt++){var vt=ut.parts[mt];vt.angle+=pt,it.rotate(vt.vertices,pt,ut.position),ct.rotate(vt.axes,pt),lt.update(vt.bounds,vt.vertices,ut.velocity),mt>0&&st.rotateAbout(vt.position,pt,ut.position,vt.position)}},rt.setVelocity=function(ut,ft){var dt=ut.deltaTime/rt._baseDelta;ut.positionPrev.x=ut.position.x-ft.x*dt,ut.positionPrev.y=ut.position.y-ft.y*dt,ut.velocity.x=(ut.position.x-ut.positionPrev.x)/dt,ut.velocity.y=(ut.position.y-ut.positionPrev.y)/dt,ut.speed=st.magnitude(ut.velocity)},rt.getVelocity=function(ut){var ft=rt._baseDelta/ut.deltaTime;return{x:(ut.position.x-ut.positionPrev.x)*ft,y:(ut.position.y-ut.positionPrev.y)*ft}},rt.getSpeed=function(ut){return st.magnitude(rt.getVelocity(ut))},rt.setSpeed=function(ut,ft){rt.setVelocity(ut,st.mult(st.normalise(rt.getVelocity(ut)),ft))},rt.setAngularVelocity=function(ut,ft){var dt=ut.deltaTime/rt._baseDelta;ut.anglePrev=ut.angle-ft*dt,ut.angularVelocity=(ut.angle-ut.anglePrev)/dt,ut.angularSpeed=Math.abs(ut.angularVelocity)},rt.getAngularVelocity=function(ut){return(ut.angle-ut.anglePrev)*rt._baseDelta/ut.deltaTime},rt.getAngularSpeed=function(ut){return Math.abs(rt.getAngularVelocity(ut))},rt.setAngularSpeed=function(ut,ft){rt.setAngularVelocity(ut,at.sign(rt.getAngularVelocity(ut))*ft)},rt.translate=function(ut,ft,dt){rt.setPosition(ut,st.add(ut.position,ft),dt)},rt.rotate=function(ut,ft,dt,pt){if(!dt)rt.setAngle(ut,ut.angle+ft,pt);else{var mt=Math.cos(ft),vt=Math.sin(ft),yt=ut.position.x-dt.x,_t=ut.position.y-dt.y;rt.setPosition(ut,{x:dt.x+(yt*mt-_t*vt),y:dt.y+(yt*vt+_t*mt)},pt),rt.setAngle(ut,ut.angle+ft,pt)}},rt.scale=function(ut,ft,dt,pt){var mt=0,vt=0;pt=pt||ut.position;for(var yt=0;yt<ut.parts.length;yt++){var _t=ut.parts[yt];it.scale(_t.vertices,ft,dt,pt),_t.axes=ct.fromVertices(_t.vertices),_t.area=it.area(_t.vertices),rt.setMass(_t,ut.density*_t.area),it.translate(_t.vertices,{x:-_t.position.x,y:-_t.position.y}),rt.setInertia(_t,rt._inertiaScale*it.inertia(_t.vertices,_t.mass)),it.translate(_t.vertices,{x:_t.position.x,y:_t.position.y}),yt>0&&(mt+=_t.area,vt+=_t.inertia),_t.position.x=pt.x+(_t.position.x-pt.x)*ft,_t.position.y=pt.y+(_t.position.y-pt.y)*dt,lt.update(_t.bounds,_t.vertices,ut.velocity)}ut.parts.length>1&&(ut.area=mt,ut.isStatic||(rt.setMass(ut,ut.density*mt),rt.setInertia(ut,vt))),ut.circleRadius&&(ft===dt?ut.circleRadius*=ft:ut.circleRadius=null)},rt.update=function(ut,ft){ft=(typeof ft<"u"?ft:1e3/60)*ut.timeScale;var dt=ft*ft,pt=rt._timeCorrection?ft/(ut.deltaTime||ft):1,mt=1-ut.frictionAir*(ft/at._baseDelta),vt=(ut.position.x-ut.positionPrev.x)*pt,yt=(ut.position.y-ut.positionPrev.y)*pt;ut.velocity.x=vt*mt+ut.force.x/ut.mass*dt,ut.velocity.y=yt*mt+ut.force.y/ut.mass*dt,ut.positionPrev.x=ut.position.x,ut.positionPrev.y=ut.position.y,ut.position.x+=ut.velocity.x,ut.position.y+=ut.velocity.y,ut.deltaTime=ft,ut.angularVelocity=(ut.angle-ut.anglePrev)*mt*pt+ut.torque/ut.inertia*dt,ut.anglePrev=ut.angle,ut.angle+=ut.angularVelocity;for(var _t=0;_t<ut.parts.length;_t++){var St=ut.parts[_t];it.translate(St.vertices,ut.velocity),_t>0&&(St.position.x+=ut.velocity.x,St.position.y+=ut.velocity.y),ut.angularVelocity!==0&&(it.rotate(St.vertices,ut.angularVelocity,ut.position),ct.rotate(St.axes,ut.angularVelocity),_t>0&&st.rotateAbout(St.position,ut.angularVelocity,ut.position,St.position)),lt.update(St.bounds,St.vertices,ut.velocity)}},rt.updateVelocities=function(ut){var ft=rt._baseDelta/ut.deltaTime,dt=ut.velocity;dt.x=(ut.position.x-ut.positionPrev.x)*ft,dt.y=(ut.position.y-ut.positionPrev.y)*ft,ut.speed=Math.sqrt(dt.x*dt.x+dt.y*dt.y),ut.angularVelocity=(ut.angle-ut.anglePrev)*ft,ut.angularSpeed=Math.abs(ut.angularVelocity)},rt.applyForce=function(ut,ft,dt){var pt={x:ft.x-ut.position.x,y:ft.y-ut.position.y};ut.force.x+=dt.x,ut.force.y+=dt.y,ut.torque+=pt.x*dt.y-pt.y*dt.x},rt._totalProperties=function(ut){for(var ft={mass:0,area:0,inertia:0,centre:{x:0,y:0}},dt=ut.parts.length===1?0:1;dt<ut.parts.length;dt++){var pt=ut.parts[dt],mt=pt.mass!==1/0?pt.mass:1;ft.mass+=mt,ft.area+=pt.area,ft.inertia+=pt.inertia,ft.centre=st.add(ft.centre,st.mult(pt.position,mt))}return ft.centre=st.div(ft.centre,ft.mass),ft}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(0);(function(){rt.on=function(st,ot,at){for(var lt=ot.split(" "),ct,ht=0;ht<lt.length;ht++)ct=lt[ht],st.events=st.events||{},st.events[ct]=st.events[ct]||[],st.events[ct].push(at);return at},rt.off=function(st,ot,at){if(!ot){st.events={};return}typeof ot=="function"&&(at=ot,ot=it.keys(st.events).join(" "));for(var lt=ot.split(" "),ct=0;ct<lt.length;ct++){var ht=st.events[lt[ct]],ut=[];if(at&&ht)for(var ft=0;ft<ht.length;ft++)ht[ft]!==at&&ut.push(ht[ft]);st.events[lt[ct]]=ut}},rt.trigger=function(st,ot,at){var lt,ct,ht,ut,ft=st.events;if(ft&&it.keys(ft).length>0){at||(at={}),lt=ot.split(" ");for(var dt=0;dt<lt.length;dt++)if(ct=lt[dt],ht=ft[ct],ht){ut=it.clone(at,!1),ut.name=ct,ut.source=st;for(var pt=0;pt<ht.length;pt++)ht[pt].apply(st,[ut])}}}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(5),st=nt(0),ot=nt(1),at=nt(4);(function(){rt.create=function(lt){return st.extend({id:st.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},lt)},rt.setModified=function(lt,ct,ht,ut){if(lt.isModified=ct,ct&&lt.cache&&(lt.cache.allBodies=null,lt.cache.allConstraints=null,lt.cache.allComposites=null),ht&&lt.parent&&rt.setModified(lt.parent,ct,ht,ut),ut)for(var ft=0;ft<lt.composites.length;ft++){var dt=lt.composites[ft];rt.setModified(dt,ct,ht,ut)}},rt.add=function(lt,ct){var ht=[].concat(ct);it.trigger(lt,"beforeAdd",{object:ct});for(var ut=0;ut<ht.length;ut++){var ft=ht[ut];switch(ft.type){case"body":if(ft.parent!==ft){st.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}rt.addBody(lt,ft);break;case"constraint":rt.addConstraint(lt,ft);break;case"composite":rt.addComposite(lt,ft);break;case"mouseConstraint":rt.addConstraint(lt,ft.constraint);break}}return it.trigger(lt,"afterAdd",{object:ct}),lt},rt.remove=function(lt,ct,ht){var ut=[].concat(ct);it.trigger(lt,"beforeRemove",{object:ct});for(var ft=0;ft<ut.length;ft++){var dt=ut[ft];switch(dt.type){case"body":rt.removeBody(lt,dt,ht);break;case"constraint":rt.removeConstraint(lt,dt,ht);break;case"composite":rt.removeComposite(lt,dt,ht);break;case"mouseConstraint":rt.removeConstraint(lt,dt.constraint);break}}return it.trigger(lt,"afterRemove",{object:ct}),lt},rt.addComposite=function(lt,ct){return lt.composites.push(ct),ct.parent=lt,rt.setModified(lt,!0,!0,!1),lt},rt.removeComposite=function(lt,ct,ht){var ut=st.indexOf(lt.composites,ct);if(ut!==-1&&rt.removeCompositeAt(lt,ut),ht)for(var ft=0;ft<lt.composites.length;ft++)rt.removeComposite(lt.composites[ft],ct,!0);return lt},rt.removeCompositeAt=function(lt,ct){return lt.composites.splice(ct,1),rt.setModified(lt,!0,!0,!1),lt},rt.addBody=function(lt,ct){return lt.bodies.push(ct),rt.setModified(lt,!0,!0,!1),lt},rt.removeBody=function(lt,ct,ht){var ut=st.indexOf(lt.bodies,ct);if(ut!==-1&&rt.removeBodyAt(lt,ut),ht)for(var ft=0;ft<lt.composites.length;ft++)rt.removeBody(lt.composites[ft],ct,!0);return lt},rt.removeBodyAt=function(lt,ct){return lt.bodies.splice(ct,1),rt.setModified(lt,!0,!0,!1),lt},rt.addConstraint=function(lt,ct){return lt.constraints.push(ct),rt.setModified(lt,!0,!0,!1),lt},rt.removeConstraint=function(lt,ct,ht){var ut=st.indexOf(lt.constraints,ct);if(ut!==-1&&rt.removeConstraintAt(lt,ut),ht)for(var ft=0;ft<lt.composites.length;ft++)rt.removeConstraint(lt.composites[ft],ct,!0);return lt},rt.removeConstraintAt=function(lt,ct){return lt.constraints.splice(ct,1),rt.setModified(lt,!0,!0,!1),lt},rt.clear=function(lt,ct,ht){if(ht)for(var ut=0;ut<lt.composites.length;ut++)rt.clear(lt.composites[ut],ct,!0);return ct?lt.bodies=lt.bodies.filter(function(ft){return ft.isStatic}):lt.bodies.length=0,lt.constraints.length=0,lt.composites.length=0,rt.setModified(lt,!0,!0,!1),lt},rt.allBodies=function(lt){if(lt.cache&&lt.cache.allBodies)return lt.cache.allBodies;for(var ct=[].concat(lt.bodies),ht=0;ht<lt.composites.length;ht++)ct=ct.concat(rt.allBodies(lt.composites[ht]));return lt.cache&&(lt.cache.allBodies=ct),ct},rt.allConstraints=function(lt){if(lt.cache&&lt.cache.allConstraints)return lt.cache.allConstraints;for(var ct=[].concat(lt.constraints),ht=0;ht<lt.composites.length;ht++)ct=ct.concat(rt.allConstraints(lt.composites[ht]));return lt.cache&&(lt.cache.allConstraints=ct),ct},rt.allComposites=function(lt){if(lt.cache&&lt.cache.allComposites)return lt.cache.allComposites;for(var ct=[].concat(lt.composites),ht=0;ht<lt.composites.length;ht++)ct=ct.concat(rt.allComposites(lt.composites[ht]));return lt.cache&&(lt.cache.allComposites=ct),ct},rt.get=function(lt,ct,ht){var ut,ft;switch(ht){case"body":ut=rt.allBodies(lt);break;case"constraint":ut=rt.allConstraints(lt);break;case"composite":ut=rt.allComposites(lt).concat(lt);break}return ut?(ft=ut.filter(function(dt){return dt.id.toString()===ct.toString()}),ft.length===0?null:ft[0]):null},rt.move=function(lt,ct,ht){return rt.remove(lt,ct),rt.add(ht,ct),lt},rt.rebase=function(lt){for(var ct=rt.allBodies(lt).concat(rt.allConstraints(lt)).concat(rt.allComposites(lt)),ht=0;ht<ct.length;ht++)ct[ht].id=st.nextId();return lt},rt.translate=function(lt,ct,ht){for(var ut=ht?rt.allBodies(lt):lt.bodies,ft=0;ft<ut.length;ft++)at.translate(ut[ft],ct);return lt},rt.rotate=function(lt,ct,ht,ut){for(var ft=Math.cos(ct),dt=Math.sin(ct),pt=ut?rt.allBodies(lt):lt.bodies,mt=0;mt<pt.length;mt++){var vt=pt[mt],yt=vt.position.x-ht.x,_t=vt.position.y-ht.y;at.setPosition(vt,{x:ht.x+(yt*ft-_t*dt),y:ht.y+(yt*dt+_t*ft)}),at.rotate(vt,ct)}return lt},rt.scale=function(lt,ct,ht,ut,ft){for(var dt=ft?rt.allBodies(lt):lt.bodies,pt=0;pt<dt.length;pt++){var mt=dt[pt],vt=mt.position.x-ut.x,yt=mt.position.y-ut.y;at.setPosition(mt,{x:ut.x+vt*ct,y:ut.y+yt*ht}),at.scale(mt,ct,ht)}return lt},rt.bounds=function(lt){for(var ct=rt.allBodies(lt),ht=[],ut=0;ut<ct.length;ut+=1){var ft=ct[ut];ht.push(ft.bounds.min,ft.bounds.max)}return ot.create(ht)}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(4),st=nt(5),ot=nt(0);(function(){rt._motionWakeThreshold=.18,rt._motionSleepThreshold=.08,rt._minBias=.9,rt.update=function(at,lt){for(var ct=lt/ot._baseDelta,ht=rt._motionSleepThreshold,ut=0;ut<at.length;ut++){var ft=at[ut],dt=it.getSpeed(ft),pt=it.getAngularSpeed(ft),mt=dt*dt+pt*pt;if(ft.force.x!==0||ft.force.y!==0){rt.set(ft,!1);continue}var vt=Math.min(ft.motion,mt),yt=Math.max(ft.motion,mt);ft.motion=rt._minBias*vt+(1-rt._minBias)*yt,ft.sleepThreshold>0&&ft.motion<ht?(ft.sleepCounter+=1,ft.sleepCounter>=ft.sleepThreshold/ct&&rt.set(ft,!0)):ft.sleepCounter>0&&(ft.sleepCounter-=1)}},rt.afterCollisions=function(at){for(var lt=rt._motionSleepThreshold,ct=0;ct<at.length;ct++){var ht=at[ct];if(ht.isActive){var ut=ht.collision,ft=ut.bodyA.parent,dt=ut.bodyB.parent;if(!(ft.isSleeping&&dt.isSleeping||ft.isStatic||dt.isStatic)&&(ft.isSleeping||dt.isSleeping)){var pt=ft.isSleeping&&!ft.isStatic?ft:dt,mt=pt===ft?dt:ft;!pt.isStatic&&mt.motion>lt&&rt.set(pt,!1)}}}},rt.set=function(at,lt){var ct=at.isSleeping;lt?(at.isSleeping=!0,at.sleepCounter=at.sleepThreshold,at.positionImpulse.x=0,at.positionImpulse.y=0,at.positionPrev.x=at.position.x,at.positionPrev.y=at.position.y,at.anglePrev=at.angle,at.speed=0,at.angularSpeed=0,at.motion=0,ct||st.trigger(at,"sleepStart")):(at.isSleeping=!1,at.sleepCounter=0,ct&&st.trigger(at,"sleepEnd"))}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(3),st=nt(9);(function(){var ot=[],at={overlap:0,axis:null},lt={overlap:0,axis:null};rt.create=function(ct,ht){return{pair:null,collided:!1,bodyA:ct,bodyB:ht,parentA:ct.parent,parentB:ht.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},rt.collides=function(ct,ht,ut){if(rt._overlapAxes(at,ct.vertices,ht.vertices,ct.axes),at.overlap<=0||(rt._overlapAxes(lt,ht.vertices,ct.vertices,ht.axes),lt.overlap<=0))return null;var ft=ut&&ut.table[st.id(ct,ht)],dt;ft?dt=ft.collision:(dt=rt.create(ct,ht),dt.collided=!0,dt.bodyA=ct.id<ht.id?ct:ht,dt.bodyB=ct.id<ht.id?ht:ct,dt.parentA=dt.bodyA.parent,dt.parentB=dt.bodyB.parent),ct=dt.bodyA,ht=dt.bodyB;var pt;at.overlap<lt.overlap?pt=at:pt=lt;var mt=dt.normal,vt=dt.supports,yt=pt.axis,_t=yt.x,St=yt.y;_t*(ht.position.x-ct.position.x)+St*(ht.position.y-ct.position.y)<0?(mt.x=_t,mt.y=St):(mt.x=-_t,mt.y=-St),dt.tangent.x=-mt.y,dt.tangent.y=mt.x,dt.depth=pt.overlap,dt.penetration.x=mt.x*dt.depth,dt.penetration.y=mt.y*dt.depth;var bt=rt._findSupports(ct,ht,mt,1),Et=0;if(it.contains(ct.vertices,bt[0])&&(vt[Et++]=bt[0]),it.contains(ct.vertices,bt[1])&&(vt[Et++]=bt[1]),Et<2){var Mt=rt._findSupports(ht,ct,mt,-1);it.contains(ht.vertices,Mt[0])&&(vt[Et++]=Mt[0]),Et<2&&it.contains(ht.vertices,Mt[1])&&(vt[Et++]=Mt[1])}return Et===0&&(vt[Et++]=bt[0]),vt.length=Et,dt},rt._overlapAxes=function(ct,ht,ut,ft){var dt=ht.length,pt=ut.length,mt=ht[0].x,vt=ht[0].y,yt=ut[0].x,_t=ut[0].y,St=ft.length,bt=Number.MAX_VALUE,Et=0,Mt,Tt,wt,Ct,Rt,It;for(Rt=0;Rt<St;Rt++){var Dt=ft[Rt],Ft=Dt.x,$t=Dt.y,Yt=mt*Ft+vt*$t,Lt=yt*Ft+_t*$t,Ot=Yt,Nt=Lt;for(It=1;It<dt;It+=1)Ct=ht[It].x*Ft+ht[It].y*$t,Ct>Ot?Ot=Ct:Ct<Yt&&(Yt=Ct);for(It=1;It<pt;It+=1)Ct=ut[It].x*Ft+ut[It].y*$t,Ct>Nt?Nt=Ct:Ct<Lt&&(Lt=Ct);if(Tt=Ot-Lt,wt=Nt-Yt,Mt=Tt<wt?Tt:wt,Mt<bt&&(bt=Mt,Et=Rt,Mt<=0))break}ct.axis=ft[Et],ct.overlap=bt},rt._projectToAxis=function(ct,ht,ut){for(var ft=ht[0].x*ut.x+ht[0].y*ut.y,dt=ft,pt=1;pt<ht.length;pt+=1){var mt=ht[pt].x*ut.x+ht[pt].y*ut.y;mt>dt?dt=mt:mt<ft&&(ft=mt)}ct.min=ft,ct.max=dt},rt._findSupports=function(ct,ht,ut,ft){var dt=ht.vertices,pt=dt.length,mt=ct.position.x,vt=ct.position.y,yt=ut.x*ft,_t=ut.y*ft,St=Number.MAX_VALUE,bt,Et,Mt,Tt,wt;for(wt=0;wt<pt;wt+=1)Et=dt[wt],Tt=yt*(mt-Et.x)+_t*(vt-Et.y),Tt<St&&(St=Tt,bt=Et);return Mt=dt[(pt+bt.index-1)%pt],St=yt*(mt-Mt.x)+_t*(vt-Mt.y),Et=dt[(bt.index+1)%pt],yt*(mt-Et.x)+_t*(vt-Et.y)<St?(ot[0]=bt,ot[1]=Et,ot):(ot[0]=bt,ot[1]=Mt,ot)}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(16);(function(){rt.create=function(st,ot){var at=st.bodyA,lt=st.bodyB,ct={id:rt.id(at,lt),bodyA:at,bodyB:lt,collision:st,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:at.isSensor||lt.isSensor,timeCreated:ot,timeUpdated:ot,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return rt.update(ct,st,ot),ct},rt.update=function(st,ot,at){var lt=st.contacts,ct=ot.supports,ht=st.activeContacts,ut=ot.parentA,ft=ot.parentB,dt=ut.vertices.length;st.isActive=!0,st.timeUpdated=at,st.collision=ot,st.separation=ot.depth,st.inverseMass=ut.inverseMass+ft.inverseMass,st.friction=ut.friction<ft.friction?ut.friction:ft.friction,st.frictionStatic=ut.frictionStatic>ft.frictionStatic?ut.frictionStatic:ft.frictionStatic,st.restitution=ut.restitution>ft.restitution?ut.restitution:ft.restitution,st.slop=ut.slop>ft.slop?ut.slop:ft.slop,ot.pair=st,ht.length=0;for(var pt=0;pt<ct.length;pt++){var mt=ct[pt],vt=mt.body===ut?mt.index:dt+mt.index,yt=lt[vt];yt?ht.push(yt):ht.push(lt[vt]=it.create(mt))}},rt.setActive=function(st,ot,at){ot?(st.isActive=!0,st.timeUpdated=at):(st.isActive=!1,st.activeContacts.length=0)},rt.id=function(st,ot){return st.id<ot.id?"A"+st.id+"B"+ot.id:"A"+ot.id+"B"+st.id}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(3),st=nt(2),ot=nt(7),at=nt(1),lt=nt(11),ct=nt(0);(function(){rt._warming=.4,rt._torqueDampen=1,rt._minLength=1e-6,rt.create=function(ht){var ut=ht;ut.bodyA&&!ut.pointA&&(ut.pointA={x:0,y:0}),ut.bodyB&&!ut.pointB&&(ut.pointB={x:0,y:0});var ft=ut.bodyA?st.add(ut.bodyA.position,ut.pointA):ut.pointA,dt=ut.bodyB?st.add(ut.bodyB.position,ut.pointB):ut.pointB,pt=st.magnitude(st.sub(ft,dt));ut.length=typeof ut.length<"u"?ut.length:pt,ut.id=ut.id||ct.nextId(),ut.label=ut.label||"Constraint",ut.type="constraint",ut.stiffness=ut.stiffness||(ut.length>0?1:.7),ut.damping=ut.damping||0,ut.angularStiffness=ut.angularStiffness||0,ut.angleA=ut.bodyA?ut.bodyA.angle:ut.angleA,ut.angleB=ut.bodyB?ut.bodyB.angle:ut.angleB,ut.plugin={};var mt={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return ut.length===0&&ut.stiffness>.1?(mt.type="pin",mt.anchors=!1):ut.stiffness<.9&&(mt.type="spring"),ut.render=ct.extend(mt,ut.render),ut},rt.preSolveAll=function(ht){for(var ut=0;ut<ht.length;ut+=1){var ft=ht[ut],dt=ft.constraintImpulse;ft.isStatic||dt.x===0&&dt.y===0&&dt.angle===0||(ft.position.x+=dt.x,ft.position.y+=dt.y,ft.angle+=dt.angle)}},rt.solveAll=function(ht,ut){for(var ft=ct.clamp(ut/ct._baseDelta,0,1),dt=0;dt<ht.length;dt+=1){var pt=ht[dt],mt=!pt.bodyA||pt.bodyA&&pt.bodyA.isStatic,vt=!pt.bodyB||pt.bodyB&&pt.bodyB.isStatic;(mt||vt)&&rt.solve(ht[dt],ft)}for(dt=0;dt<ht.length;dt+=1)pt=ht[dt],mt=!pt.bodyA||pt.bodyA&&pt.bodyA.isStatic,vt=!pt.bodyB||pt.bodyB&&pt.bodyB.isStatic,!mt&&!vt&&rt.solve(ht[dt],ft)},rt.solve=function(ht,ut){var ft=ht.bodyA,dt=ht.bodyB,pt=ht.pointA,mt=ht.pointB;if(!(!ft&&!dt)){ft&&!ft.isStatic&&(st.rotate(pt,ft.angle-ht.angleA,pt),ht.angleA=ft.angle),dt&&!dt.isStatic&&(st.rotate(mt,dt.angle-ht.angleB,mt),ht.angleB=dt.angle);var vt=pt,yt=mt;if(ft&&(vt=st.add(ft.position,pt)),dt&&(yt=st.add(dt.position,mt)),!(!vt||!yt)){var _t=st.sub(vt,yt),St=st.magnitude(_t);St<rt._minLength&&(St=rt._minLength);var bt=(St-ht.length)/St,Et=ht.stiffness>=1||ht.length===0,Mt=Et?ht.stiffness*ut:ht.stiffness*ut*ut,Tt=ht.damping*ut,wt=st.mult(_t,bt*Mt),Ct=(ft?ft.inverseMass:0)+(dt?dt.inverseMass:0),Rt=(ft?ft.inverseInertia:0)+(dt?dt.inverseInertia:0),It=Ct+Rt,Dt,Ft,$t,Yt,Lt;if(Tt>0){var Ot=st.create();$t=st.div(_t,St),Lt=st.sub(dt&&st.sub(dt.position,dt.positionPrev)||Ot,ft&&st.sub(ft.position,ft.positionPrev)||Ot),Yt=st.dot($t,Lt)}ft&&!ft.isStatic&&(Ft=ft.inverseMass/Ct,ft.constraintImpulse.x-=wt.x*Ft,ft.constraintImpulse.y-=wt.y*Ft,ft.position.x-=wt.x*Ft,ft.position.y-=wt.y*Ft,Tt>0&&(ft.positionPrev.x-=Tt*$t.x*Yt*Ft,ft.positionPrev.y-=Tt*$t.y*Yt*Ft),Dt=st.cross(pt,wt)/It*rt._torqueDampen*ft.inverseInertia*(1-ht.angularStiffness),ft.constraintImpulse.angle-=Dt,ft.angle-=Dt),dt&&!dt.isStatic&&(Ft=dt.inverseMass/Ct,dt.constraintImpulse.x+=wt.x*Ft,dt.constraintImpulse.y+=wt.y*Ft,dt.position.x+=wt.x*Ft,dt.position.y+=wt.y*Ft,Tt>0&&(dt.positionPrev.x+=Tt*$t.x*Yt*Ft,dt.positionPrev.y+=Tt*$t.y*Yt*Ft),Dt=st.cross(mt,wt)/It*rt._torqueDampen*dt.inverseInertia*(1-ht.angularStiffness),dt.constraintImpulse.angle+=Dt,dt.angle+=Dt)}}},rt.postSolveAll=function(ht){for(var ut=0;ut<ht.length;ut++){var ft=ht[ut],dt=ft.constraintImpulse;if(!(ft.isStatic||dt.x===0&&dt.y===0&&dt.angle===0)){ot.set(ft,!1);for(var pt=0;pt<ft.parts.length;pt++){var mt=ft.parts[pt];it.translate(mt.vertices,dt),pt>0&&(mt.position.x+=dt.x,mt.position.y+=dt.y),dt.angle!==0&&(it.rotate(mt.vertices,dt.angle,ft.position),lt.rotate(mt.axes,dt.angle),pt>0&&st.rotateAbout(mt.position,dt.angle,ft.position,mt.position)),at.update(mt.bounds,mt.vertices,ft.velocity)}dt.angle*=rt._warming,dt.x*=rt._warming,dt.y*=rt._warming}}},rt.pointAWorld=function(ht){return{x:(ht.bodyA?ht.bodyA.position.x:0)+(ht.pointA?ht.pointA.x:0),y:(ht.bodyA?ht.bodyA.position.y:0)+(ht.pointA?ht.pointA.y:0)}},rt.pointBWorld=function(ht){return{x:(ht.bodyB?ht.bodyB.position.x:0)+(ht.pointB?ht.pointB.x:0),y:(ht.bodyB?ht.bodyB.position.y:0)+(ht.pointB?ht.pointB.y:0)}}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(2),st=nt(0);(function(){rt.fromVertices=function(ot){for(var at={},lt=0;lt<ot.length;lt++){var ct=(lt+1)%ot.length,ht=it.normalise({x:ot[ct].y-ot[lt].y,y:ot[lt].x-ot[ct].x}),ut=ht.y===0?1/0:ht.x/ht.y;ut=ut.toFixed(3).toString(),at[ut]=ht}return st.values(at)},rt.rotate=function(ot,at){if(at!==0)for(var lt=Math.cos(at),ct=Math.sin(at),ht=0;ht<ot.length;ht++){var ut=ot[ht],ft;ft=ut.x*lt-ut.y*ct,ut.y=ut.x*ct+ut.y*lt,ut.x=ft}}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(3),st=nt(0),ot=nt(4),at=nt(1),lt=nt(2);(function(){rt.rectangle=function(ct,ht,ut,ft,dt){dt=dt||{};var pt={label:"Rectangle Body",position:{x:ct,y:ht},vertices:it.fromPath("L 0 0 L "+ut+" 0 L "+ut+" "+ft+" L 0 "+ft)};if(dt.chamfer){var mt=dt.chamfer;pt.vertices=it.chamfer(pt.vertices,mt.radius,mt.quality,mt.qualityMin,mt.qualityMax),delete dt.chamfer}return ot.create(st.extend({},pt,dt))},rt.trapezoid=function(ct,ht,ut,ft,dt,pt){pt=pt||{},dt*=.5;var mt=(1-dt*2)*ut,vt=ut*dt,yt=vt+mt,_t=yt+vt,St;dt<.5?St="L 0 0 L "+vt+" "+-ft+" L "+yt+" "+-ft+" L "+_t+" 0":St="L 0 0 L "+yt+" "+-ft+" L "+_t+" 0";var bt={label:"Trapezoid Body",position:{x:ct,y:ht},vertices:it.fromPath(St)};if(pt.chamfer){var Et=pt.chamfer;bt.vertices=it.chamfer(bt.vertices,Et.radius,Et.quality,Et.qualityMin,Et.qualityMax),delete pt.chamfer}return ot.create(st.extend({},bt,pt))},rt.circle=function(ct,ht,ut,ft,dt){ft=ft||{};var pt={label:"Circle Body",circleRadius:ut};dt=dt||25;var mt=Math.ceil(Math.max(10,Math.min(dt,ut)));return mt%2===1&&(mt+=1),rt.polygon(ct,ht,mt,ut,st.extend({},pt,ft))},rt.polygon=function(ct,ht,ut,ft,dt){if(dt=dt||{},ut<3)return rt.circle(ct,ht,ft,dt);for(var pt=2*Math.PI/ut,mt="",vt=pt*.5,yt=0;yt<ut;yt+=1){var _t=vt+yt*pt,St=Math.cos(_t)*ft,bt=Math.sin(_t)*ft;mt+="L "+St.toFixed(3)+" "+bt.toFixed(3)+" "}var Et={label:"Polygon Body",position:{x:ct,y:ht},vertices:it.fromPath(mt)};if(dt.chamfer){var Mt=dt.chamfer;Et.vertices=it.chamfer(Et.vertices,Mt.radius,Mt.quality,Mt.qualityMin,Mt.qualityMax),delete dt.chamfer}return ot.create(st.extend({},Et,dt))},rt.fromVertices=function(ct,ht,ut,ft,dt,pt,mt,vt){var yt=st.getDecomp(),_t,St,bt,Et,Mt,Tt,wt,Ct,Rt,It,Dt;for(_t=!!(yt&&yt.quickDecomp),ft=ft||{},bt=[],dt=typeof dt<"u"?dt:!1,pt=typeof pt<"u"?pt:.01,mt=typeof mt<"u"?mt:10,vt=typeof vt<"u"?vt:.01,st.isArray(ut[0])||(ut=[ut]),It=0;It<ut.length;It+=1)if(Tt=ut[It],Et=it.isConvex(Tt),Mt=!Et,Mt&&!_t&&st.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),Et||!_t)Et?Tt=it.clockwiseSort(Tt):Tt=it.hull(Tt),bt.push({position:{x:ct,y:ht},vertices:Tt});else{var Ft=Tt.map(function(Zt){return[Zt.x,Zt.y]});yt.makeCCW(Ft),pt!==!1&&yt.removeCollinearPoints(Ft,pt),vt!==!1&&yt.removeDuplicatePoints&&yt.removeDuplicatePoints(Ft,vt);var $t=yt.quickDecomp(Ft);for(wt=0;wt<$t.length;wt++){var Yt=$t[wt],Lt=Yt.map(function(Zt){return{x:Zt[0],y:Zt[1]}});mt>0&&it.area(Lt)<mt||bt.push({position:it.centre(Lt),vertices:Lt})}}for(wt=0;wt<bt.length;wt++)bt[wt]=ot.create(st.extend(bt[wt],ft));if(dt){var Ot=5;for(wt=0;wt<bt.length;wt++){var Nt=bt[wt];for(Ct=wt+1;Ct<bt.length;Ct++){var zt=bt[Ct];if(at.overlaps(Nt.bounds,zt.bounds)){var Ht=Nt.vertices,qt=zt.vertices;for(Rt=0;Rt<Nt.vertices.length;Rt++)for(Dt=0;Dt<zt.vertices.length;Dt++){var Gt=lt.magnitudeSquared(lt.sub(Ht[(Rt+1)%Ht.length],qt[Dt])),Xt=lt.magnitudeSquared(lt.sub(Ht[Rt],qt[(Dt+1)%qt.length]));Gt<Ot&&Xt<Ot&&(Ht[Rt].isInternal=!0,qt[Dt].isInternal=!0)}}}}}return bt.length>1?(St=ot.create(st.extend({parts:bt.slice(0)},ft)),ot.setPosition(St,{x:ct,y:ht}),St):bt[0]}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(0),st=nt(8);(function(){rt.create=function(ot){var at={bodies:[],pairs:null};return it.extend(at,ot)},rt.setBodies=function(ot,at){ot.bodies=at.slice(0)},rt.clear=function(ot){ot.bodies=[]},rt.collisions=function(ot){var at=[],lt=ot.pairs,ct=ot.bodies,ht=ct.length,ut=rt.canCollide,ft=st.collides,dt,pt;for(ct.sort(rt._compareBoundsX),dt=0;dt<ht;dt++){var mt=ct[dt],vt=mt.bounds,yt=mt.bounds.max.x,_t=mt.bounds.max.y,St=mt.bounds.min.y,bt=mt.isStatic||mt.isSleeping,Et=mt.parts.length,Mt=Et===1;for(pt=dt+1;pt<ht;pt++){var Tt=ct[pt],wt=Tt.bounds;if(wt.min.x>yt)break;if(!(_t<wt.min.y||St>wt.max.y)&&!(bt&&(Tt.isStatic||Tt.isSleeping))&&ut(mt.collisionFilter,Tt.collisionFilter)){var Ct=Tt.parts.length;if(Mt&&Ct===1){var Rt=ft(mt,Tt,lt);Rt&&at.push(Rt)}else for(var It=Et>1?1:0,Dt=Ct>1?1:0,Ft=It;Ft<Et;Ft++)for(var $t=mt.parts[Ft],vt=$t.bounds,Yt=Dt;Yt<Ct;Yt++){var Lt=Tt.parts[Yt],wt=Lt.bounds;if(!(vt.min.x>wt.max.x||vt.max.x<wt.min.x||vt.max.y<wt.min.y||vt.min.y>wt.max.y)){var Rt=ft($t,Lt,lt);Rt&&at.push(Rt)}}}}}return at},rt.canCollide=function(ot,at){return ot.group===at.group&&ot.group!==0?ot.group>0:(ot.mask&at.category)!==0&&(at.mask&ot.category)!==0},rt._compareBoundsX=function(ot,at){return ot.bounds.min.x-at.bounds.min.x}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(0);(function(){rt.create=function(st){var ot={};return st||it.log("Mouse.create: element was undefined, defaulting to document.body","warn"),ot.element=st||document.body,ot.absolute={x:0,y:0},ot.position={x:0,y:0},ot.mousedownPosition={x:0,y:0},ot.mouseupPosition={x:0,y:0},ot.offset={x:0,y:0},ot.scale={x:1,y:1},ot.wheelDelta=0,ot.button=-1,ot.pixelRatio=parseInt(ot.element.getAttribute("data-pixel-ratio"),10)||1,ot.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},ot.mousemove=function(at){var lt=rt._getRelativeMousePosition(at,ot.element,ot.pixelRatio),ct=at.changedTouches;ct&&(ot.button=0,at.preventDefault()),ot.absolute.x=lt.x,ot.absolute.y=lt.y,ot.position.x=ot.absolute.x*ot.scale.x+ot.offset.x,ot.position.y=ot.absolute.y*ot.scale.y+ot.offset.y,ot.sourceEvents.mousemove=at},ot.mousedown=function(at){var lt=rt._getRelativeMousePosition(at,ot.element,ot.pixelRatio),ct=at.changedTouches;ct?(ot.button=0,at.preventDefault()):ot.button=at.button,ot.absolute.x=lt.x,ot.absolute.y=lt.y,ot.position.x=ot.absolute.x*ot.scale.x+ot.offset.x,ot.position.y=ot.absolute.y*ot.scale.y+ot.offset.y,ot.mousedownPosition.x=ot.position.x,ot.mousedownPosition.y=ot.position.y,ot.sourceEvents.mousedown=at},ot.mouseup=function(at){var lt=rt._getRelativeMousePosition(at,ot.element,ot.pixelRatio),ct=at.changedTouches;ct&&at.preventDefault(),ot.button=-1,ot.absolute.x=lt.x,ot.absolute.y=lt.y,ot.position.x=ot.absolute.x*ot.scale.x+ot.offset.x,ot.position.y=ot.absolute.y*ot.scale.y+ot.offset.y,ot.mouseupPosition.x=ot.position.x,ot.mouseupPosition.y=ot.position.y,ot.sourceEvents.mouseup=at},ot.mousewheel=function(at){ot.wheelDelta=Math.max(-1,Math.min(1,at.wheelDelta||-at.detail)),at.preventDefault()},rt.setElement(ot,ot.element),ot},rt.setElement=function(st,ot){st.element=ot,ot.addEventListener("mousemove",st.mousemove),ot.addEventListener("mousedown",st.mousedown),ot.addEventListener("mouseup",st.mouseup),ot.addEventListener("mousewheel",st.mousewheel),ot.addEventListener("DOMMouseScroll",st.mousewheel),ot.addEventListener("touchmove",st.mousemove),ot.addEventListener("touchstart",st.mousedown),ot.addEventListener("touchend",st.mouseup)},rt.clearSourceEvents=function(st){st.sourceEvents.mousemove=null,st.sourceEvents.mousedown=null,st.sourceEvents.mouseup=null,st.sourceEvents.mousewheel=null,st.wheelDelta=0},rt.setOffset=function(st,ot){st.offset.x=ot.x,st.offset.y=ot.y,st.position.x=st.absolute.x*st.scale.x+st.offset.x,st.position.y=st.absolute.y*st.scale.y+st.offset.y},rt.setScale=function(st,ot){st.scale.x=ot.x,st.scale.y=ot.y,st.position.x=st.absolute.x*st.scale.x+st.offset.x,st.position.y=st.absolute.y*st.scale.y+st.offset.y},rt._getRelativeMousePosition=function(st,ot,at){var lt=ot.getBoundingClientRect(),ct=document.documentElement||document.body.parentNode||document.body,ht=window.pageXOffset!==void 0?window.pageXOffset:ct.scrollLeft,ut=window.pageYOffset!==void 0?window.pageYOffset:ct.scrollTop,ft=st.changedTouches,dt,pt;return ft?(dt=ft[0].pageX-lt.left-ht,pt=ft[0].pageY-lt.top-ut):(dt=st.pageX-lt.left-ht,pt=st.pageY-lt.top-ut),{x:dt/(ot.clientWidth/(ot.width||ot.clientWidth)*at),y:pt/(ot.clientHeight/(ot.height||ot.clientHeight)*at)}}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(0);(function(){rt._registry={},rt.register=function(st){if(rt.isPlugin(st)||it.warn("Plugin.register:",rt.toString(st),"does not implement all required fields."),st.name in rt._registry){var ot=rt._registry[st.name],at=rt.versionParse(st.version).number,lt=rt.versionParse(ot.version).number;at>lt?(it.warn("Plugin.register:",rt.toString(ot),"was upgraded to",rt.toString(st)),rt._registry[st.name]=st):at<lt?it.warn("Plugin.register:",rt.toString(ot),"can not be downgraded to",rt.toString(st)):st!==ot&&it.warn("Plugin.register:",rt.toString(st),"is already registered to different plugin object")}else rt._registry[st.name]=st;return st},rt.resolve=function(st){return rt._registry[rt.dependencyParse(st).name]},rt.toString=function(st){return typeof st=="string"?st:(st.name||"anonymous")+"@"+(st.version||st.range||"0.0.0")},rt.isPlugin=function(st){return st&&st.name&&st.version&&st.install},rt.isUsed=function(st,ot){return st.used.indexOf(ot)>-1},rt.isFor=function(st,ot){var at=st.for&&rt.dependencyParse(st.for);return!st.for||ot.name===at.name&&rt.versionSatisfies(ot.version,at.range)},rt.use=function(st,ot){if(st.uses=(st.uses||[]).concat(ot||[]),st.uses.length===0){it.warn("Plugin.use:",rt.toString(st),"does not specify any dependencies to install.");return}for(var at=rt.dependencies(st),lt=it.topologicalSort(at),ct=[],ht=0;ht<lt.length;ht+=1)if(lt[ht]!==st.name){var ut=rt.resolve(lt[ht]);if(!ut){ct.push(" "+lt[ht]);continue}rt.isUsed(st,ut.name)||(rt.isFor(ut,st)||(it.warn("Plugin.use:",rt.toString(ut),"is for",ut.for,"but installed on",rt.toString(st)+"."),ut._warned=!0),ut.install?ut.install(st):(it.warn("Plugin.use:",rt.toString(ut),"does not specify an install function."),ut._warned=!0),ut._warned?(ct.push(" "+rt.toString(ut)),delete ut._warned):ct.push(" "+rt.toString(ut)),st.used.push(ut.name))}ct.length>0&&it.info(ct.join("  "))},rt.dependencies=function(st,ot){var at=rt.dependencyParse(st),lt=at.name;if(ot=ot||{},!(lt in ot)){st=rt.resolve(st)||st,ot[lt]=it.map(st.uses||[],function(ht){rt.isPlugin(ht)&&rt.register(ht);var ut=rt.dependencyParse(ht),ft=rt.resolve(ht);return ft&&!rt.versionSatisfies(ft.version,ut.range)?(it.warn("Plugin.dependencies:",rt.toString(ft),"does not satisfy",rt.toString(ut),"used by",rt.toString(at)+"."),ft._warned=!0,st._warned=!0):ft||(it.warn("Plugin.dependencies:",rt.toString(ht),"used by",rt.toString(at),"could not be resolved."),st._warned=!0),ut.name});for(var ct=0;ct<ot[lt].length;ct+=1)rt.dependencies(ot[lt][ct],ot);return ot}},rt.dependencyParse=function(st){if(it.isString(st)){var ot=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return ot.test(st)||it.warn("Plugin.dependencyParse:",st,"is not a valid dependency string."),{name:st.split("@")[0],range:st.split("@")[1]||"*"}}return{name:st.name,range:st.range||st.version}},rt.versionParse=function(st){var ot=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;ot.test(st)||it.warn("Plugin.versionParse:",st,"is not a valid version or range.");var at=ot.exec(st),lt=Number(at[4]),ct=Number(at[5]),ht=Number(at[6]);return{isRange:!!(at[1]||at[2]),version:at[3],range:st,operator:at[1]||at[2]||"",major:lt,minor:ct,patch:ht,parts:[lt,ct,ht],prerelease:at[7],number:lt*1e8+ct*1e4+ht}},rt.versionSatisfies=function(st,ot){ot=ot||"*";var at=rt.versionParse(ot),lt=rt.versionParse(st);if(at.isRange){if(at.operator==="*"||st==="*")return!0;if(at.operator===">")return lt.number>at.number;if(at.operator===">=")return lt.number>=at.number;if(at.operator==="~")return lt.major===at.major&&lt.minor===at.minor&&lt.patch>=at.patch;if(at.operator==="^")return at.major>0?lt.major===at.major&&lt.number>=at.number:at.minor>0?lt.minor===at.minor&&lt.patch>=at.patch:lt.patch===at.patch}return st===ot||st==="*"}})()},function(_e,tt){var nt={};_e.exports=nt,function(){nt.create=function(rt){return{vertex:rt,normalImpulse:0,tangentImpulse:0}}}()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(7),st=nt(18),ot=nt(13),at=nt(19),lt=nt(5),ct=nt(6),ht=nt(10),ut=nt(0),ft=nt(4);(function(){rt.create=function(dt){dt=dt||{};var pt={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},mt=ut.extend(pt,dt);return mt.world=dt.world||ct.create({label:"World"}),mt.pairs=dt.pairs||at.create(),mt.detector=dt.detector||ot.create(),mt.grid={buckets:[]},mt.world.gravity=mt.gravity,mt.broadphase=mt.grid,mt.metrics={},mt},rt.update=function(dt,pt){var mt=ut.now(),vt=dt.world,yt=dt.detector,_t=dt.pairs,St=dt.timing,bt=St.timestamp,Et;pt=typeof pt<"u"?pt:ut._baseDelta,pt*=St.timeScale,St.timestamp+=pt,St.lastDelta=pt;var Mt={timestamp:St.timestamp,delta:pt};lt.trigger(dt,"beforeUpdate",Mt);var Tt=ct.allBodies(vt),wt=ct.allConstraints(vt);for(vt.isModified&&(ot.setBodies(yt,Tt),ct.setModified(vt,!1,!1,!0)),dt.enableSleeping&&it.update(Tt,pt),rt._bodiesApplyGravity(Tt,dt.gravity),pt>0&&rt._bodiesUpdate(Tt,pt),ht.preSolveAll(Tt),Et=0;Et<dt.constraintIterations;Et++)ht.solveAll(wt,pt);ht.postSolveAll(Tt),yt.pairs=dt.pairs;var Ct=ot.collisions(yt);at.update(_t,Ct,bt),dt.enableSleeping&&it.afterCollisions(_t.list),_t.collisionStart.length>0&&lt.trigger(dt,"collisionStart",{pairs:_t.collisionStart});var Rt=ut.clamp(20/dt.positionIterations,0,1);for(st.preSolvePosition(_t.list),Et=0;Et<dt.positionIterations;Et++)st.solvePosition(_t.list,pt,Rt);for(st.postSolvePosition(Tt),ht.preSolveAll(Tt),Et=0;Et<dt.constraintIterations;Et++)ht.solveAll(wt,pt);for(ht.postSolveAll(Tt),st.preSolveVelocity(_t.list),Et=0;Et<dt.velocityIterations;Et++)st.solveVelocity(_t.list,pt);return rt._bodiesUpdateVelocities(Tt),_t.collisionActive.length>0&&lt.trigger(dt,"collisionActive",{pairs:_t.collisionActive}),_t.collisionEnd.length>0&&lt.trigger(dt,"collisionEnd",{pairs:_t.collisionEnd}),rt._bodiesClearForces(Tt),lt.trigger(dt,"afterUpdate",Mt),dt.timing.lastElapsed=ut.now()-mt,dt},rt.merge=function(dt,pt){if(ut.extend(dt,pt),pt.world){dt.world=pt.world,rt.clear(dt);for(var mt=ct.allBodies(dt.world),vt=0;vt<mt.length;vt++){var yt=mt[vt];it.set(yt,!1),yt.id=ut.nextId()}}},rt.clear=function(dt){at.clear(dt.pairs),ot.clear(dt.detector)},rt._bodiesClearForces=function(dt){for(var pt=dt.length,mt=0;mt<pt;mt++){var vt=dt[mt];vt.force.x=0,vt.force.y=0,vt.torque=0}},rt._bodiesApplyGravity=function(dt,pt){var mt=typeof pt.scale<"u"?pt.scale:.001,vt=dt.length;if(!(pt.x===0&&pt.y===0||mt===0))for(var yt=0;yt<vt;yt++){var _t=dt[yt];_t.isStatic||_t.isSleeping||(_t.force.y+=_t.mass*pt.y*mt,_t.force.x+=_t.mass*pt.x*mt)}},rt._bodiesUpdate=function(dt,pt){for(var mt=dt.length,vt=0;vt<mt;vt++){var yt=dt[vt];yt.isStatic||yt.isSleeping||ft.update(yt,pt)}},rt._bodiesUpdateVelocities=function(dt){for(var pt=dt.length,mt=0;mt<pt;mt++)ft.updateVelocities(dt[mt])}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(3),st=nt(0),ot=nt(1);(function(){rt._restingThresh=2,rt._restingThreshTangent=Math.sqrt(6),rt._positionDampen=.9,rt._positionWarming=.8,rt._frictionNormalMultiplier=5,rt._frictionMaxStatic=Number.MAX_VALUE,rt.preSolvePosition=function(at){var lt,ct,ht,ut=at.length;for(lt=0;lt<ut;lt++)ct=at[lt],ct.isActive&&(ht=ct.activeContacts.length,ct.collision.parentA.totalContacts+=ht,ct.collision.parentB.totalContacts+=ht)},rt.solvePosition=function(at,lt,ct){var ht,ut,ft,dt,pt,mt,vt,yt,_t=rt._positionDampen*(ct||1),St=st.clamp(lt/st._baseDelta,0,1),bt=at.length;for(ht=0;ht<bt;ht++)ut=at[ht],!(!ut.isActive||ut.isSensor)&&(ft=ut.collision,dt=ft.parentA,pt=ft.parentB,mt=ft.normal,ut.separation=mt.x*(pt.positionImpulse.x+ft.penetration.x-dt.positionImpulse.x)+mt.y*(pt.positionImpulse.y+ft.penetration.y-dt.positionImpulse.y));for(ht=0;ht<bt;ht++)ut=at[ht],!(!ut.isActive||ut.isSensor)&&(ft=ut.collision,dt=ft.parentA,pt=ft.parentB,mt=ft.normal,yt=ut.separation-ut.slop*St,(dt.isStatic||pt.isStatic)&&(yt*=2),dt.isStatic||dt.isSleeping||(vt=_t/dt.totalContacts,dt.positionImpulse.x+=mt.x*yt*vt,dt.positionImpulse.y+=mt.y*yt*vt),pt.isStatic||pt.isSleeping||(vt=_t/pt.totalContacts,pt.positionImpulse.x-=mt.x*yt*vt,pt.positionImpulse.y-=mt.y*yt*vt))},rt.postSolvePosition=function(at){for(var lt=rt._positionWarming,ct=at.length,ht=it.translate,ut=ot.update,ft=0;ft<ct;ft++){var dt=at[ft],pt=dt.positionImpulse,mt=pt.x,vt=pt.y,yt=dt.velocity;if(dt.totalContacts=0,mt!==0||vt!==0){for(var _t=0;_t<dt.parts.length;_t++){var St=dt.parts[_t];ht(St.vertices,pt),ut(St.bounds,St.vertices,yt),St.position.x+=mt,St.position.y+=vt}dt.positionPrev.x+=mt,dt.positionPrev.y+=vt,mt*yt.x+vt*yt.y<0?(pt.x=0,pt.y=0):(pt.x*=lt,pt.y*=lt)}}},rt.preSolveVelocity=function(at){var lt=at.length,ct,ht;for(ct=0;ct<lt;ct++){var ut=at[ct];if(!(!ut.isActive||ut.isSensor)){var ft=ut.activeContacts,dt=ft.length,pt=ut.collision,mt=pt.parentA,vt=pt.parentB,yt=pt.normal,_t=pt.tangent;for(ht=0;ht<dt;ht++){var St=ft[ht],bt=St.vertex,Et=St.normalImpulse,Mt=St.tangentImpulse;if(Et!==0||Mt!==0){var Tt=yt.x*Et+_t.x*Mt,wt=yt.y*Et+_t.y*Mt;mt.isStatic||mt.isSleeping||(mt.positionPrev.x+=Tt*mt.inverseMass,mt.positionPrev.y+=wt*mt.inverseMass,mt.anglePrev+=mt.inverseInertia*((bt.x-mt.position.x)*wt-(bt.y-mt.position.y)*Tt)),vt.isStatic||vt.isSleeping||(vt.positionPrev.x-=Tt*vt.inverseMass,vt.positionPrev.y-=wt*vt.inverseMass,vt.anglePrev-=vt.inverseInertia*((bt.x-vt.position.x)*wt-(bt.y-vt.position.y)*Tt))}}}}},rt.solveVelocity=function(at,lt){var ct=lt/st._baseDelta,ht=ct*ct,ut=ht*ct,ft=-rt._restingThresh*ct,dt=rt._restingThreshTangent,pt=rt._frictionNormalMultiplier*ct,mt=rt._frictionMaxStatic,vt=at.length,yt,_t,St,bt;for(St=0;St<vt;St++){var Et=at[St];if(!(!Et.isActive||Et.isSensor)){var Mt=Et.collision,Tt=Mt.parentA,wt=Mt.parentB,Ct=Tt.velocity,Rt=wt.velocity,It=Mt.normal.x,Dt=Mt.normal.y,Ft=Mt.tangent.x,$t=Mt.tangent.y,Yt=Et.activeContacts,Lt=Yt.length,Ot=1/Lt,Nt=Tt.inverseMass+wt.inverseMass,zt=Et.friction*Et.frictionStatic*pt;for(Ct.x=Tt.position.x-Tt.positionPrev.x,Ct.y=Tt.position.y-Tt.positionPrev.y,Rt.x=wt.position.x-wt.positionPrev.x,Rt.y=wt.position.y-wt.positionPrev.y,Tt.angularVelocity=Tt.angle-Tt.anglePrev,wt.angularVelocity=wt.angle-wt.anglePrev,bt=0;bt<Lt;bt++){var Ht=Yt[bt],qt=Ht.vertex,Gt=qt.x-Tt.position.x,Xt=qt.y-Tt.position.y,Zt=qt.x-wt.position.x,Qt=qt.y-wt.position.y,un=Ct.x-Xt*Tt.angularVelocity,wn=Ct.y+Gt*Tt.angularVelocity,Tn=Rt.x-Qt*wt.angularVelocity,yn=Rt.y+Zt*wt.angularVelocity,Vt=un-Tn,fn=wn-yn,ln=It*Vt+Dt*fn,Jt=Ft*Vt+$t*fn,on=Et.separation+ln,_n=Math.min(on,1);_n=on<0?0:_n;var cn=_n*zt;Jt<-cn||Jt>cn?(_t=Jt>0?Jt:-Jt,yt=Et.friction*(Jt>0?1:-1)*ut,yt<-_t?yt=-_t:yt>_t&&(yt=_t)):(yt=Jt,_t=mt);var tn=Gt*Dt-Xt*It,Wt=Zt*Dt-Qt*It,Bt=Ot/(Nt+Tt.inverseInertia*tn*tn+wt.inverseInertia*Wt*Wt),nn=(1+Et.restitution)*ln*Bt;if(yt*=Bt,ln<ft)Ht.normalImpulse=0;else{var en=Ht.normalImpulse;Ht.normalImpulse+=nn,Ht.normalImpulse>0&&(Ht.normalImpulse=0),nn=Ht.normalImpulse-en}if(Jt<-dt||Jt>dt)Ht.tangentImpulse=0;else{var mn=Ht.tangentImpulse;Ht.tangentImpulse+=yt,Ht.tangentImpulse<-_t&&(Ht.tangentImpulse=-_t),Ht.tangentImpulse>_t&&(Ht.tangentImpulse=_t),yt=Ht.tangentImpulse-mn}var sn=It*nn+Ft*yt,xn=Dt*nn+$t*yt;Tt.isStatic||Tt.isSleeping||(Tt.positionPrev.x+=sn*Tt.inverseMass,Tt.positionPrev.y+=xn*Tt.inverseMass,Tt.anglePrev+=(Gt*xn-Xt*sn)*Tt.inverseInertia),wt.isStatic||wt.isSleeping||(wt.positionPrev.x-=sn*wt.inverseMass,wt.positionPrev.y-=xn*wt.inverseMass,wt.anglePrev-=(Zt*xn-Qt*sn)*wt.inverseInertia)}}}}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(9),st=nt(0);(function(){rt.create=function(ot){return st.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},ot)},rt.update=function(ot,at,lt){var ct=ot.list,ht=ct.length,ut=ot.table,ft=at.length,dt=ot.collisionStart,pt=ot.collisionEnd,mt=ot.collisionActive,vt,yt,_t,St;for(dt.length=0,pt.length=0,mt.length=0,St=0;St<ht;St++)ct[St].confirmedActive=!1;for(St=0;St<ft;St++)vt=at[St],_t=vt.pair,_t?(_t.isActive?mt.push(_t):dt.push(_t),it.update(_t,vt,lt),_t.confirmedActive=!0):(_t=it.create(vt,lt),ut[_t.id]=_t,dt.push(_t),ct.push(_t));var bt=[];for(ht=ct.length,St=0;St<ht;St++)_t=ct[St],_t.confirmedActive||(it.setActive(_t,!1,lt),pt.push(_t),!_t.collision.bodyA.isSleeping&&!_t.collision.bodyB.isSleeping&&bt.push(St));for(St=0;St<bt.length;St++)yt=bt[St]-St,_t=ct[yt],ct.splice(yt,1),delete ut[_t.id]},rt.clear=function(ot){return ot.table={},ot.list.length=0,ot.collisionStart.length=0,ot.collisionActive.length=0,ot.collisionEnd.length=0,ot}})()},function(_e,tt,nt){var rt=_e.exports=nt(21);rt.Axes=nt(11),rt.Bodies=nt(12),rt.Body=nt(4),rt.Bounds=nt(1),rt.Collision=nt(8),rt.Common=nt(0),rt.Composite=nt(6),rt.Composites=nt(22),rt.Constraint=nt(10),rt.Contact=nt(16),rt.Detector=nt(13),rt.Engine=nt(17),rt.Events=nt(5),rt.Grid=nt(23),rt.Mouse=nt(14),rt.MouseConstraint=nt(24),rt.Pair=nt(9),rt.Pairs=nt(19),rt.Plugin=nt(15),rt.Query=nt(25),rt.Render=nt(26),rt.Resolver=nt(18),rt.Runner=nt(27),rt.SAT=nt(28),rt.Sleeping=nt(7),rt.Svg=nt(29),rt.Vector=nt(2),rt.Vertices=nt(3),rt.World=nt(30),rt.Engine.run=rt.Runner.run,rt.Common.deprecated(rt.Engine,"run","Engine.run  use Matter.Runner.run(engine) instead")},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(15),st=nt(0);(function(){rt.name="matter-js",rt.version="0.19.0",rt.uses=[],rt.used=[],rt.use=function(){it.use(rt,Array.prototype.slice.call(arguments))},rt.before=function(ot,at){return ot=ot.replace(/^Matter./,""),st.chainPathBefore(rt,ot,at)},rt.after=function(ot,at){return ot=ot.replace(/^Matter./,""),st.chainPathAfter(rt,ot,at)}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(6),st=nt(10),ot=nt(0),at=nt(4),lt=nt(12),ct=ot.deprecated;(function(){rt.stack=function(ht,ut,ft,dt,pt,mt,vt){for(var yt=it.create({label:"Stack"}),_t=ht,St=ut,bt,Et=0,Mt=0;Mt<dt;Mt++){for(var Tt=0,wt=0;wt<ft;wt++){var Ct=vt(_t,St,wt,Mt,bt,Et);if(Ct){var Rt=Ct.bounds.max.y-Ct.bounds.min.y,It=Ct.bounds.max.x-Ct.bounds.min.x;Rt>Tt&&(Tt=Rt),at.translate(Ct,{x:It*.5,y:Rt*.5}),_t=Ct.bounds.max.x+pt,it.addBody(yt,Ct),bt=Ct,Et+=1}else _t+=pt}St+=Tt+mt,_t=ht}return yt},rt.chain=function(ht,ut,ft,dt,pt,mt){for(var vt=ht.bodies,yt=1;yt<vt.length;yt++){var _t=vt[yt-1],St=vt[yt],bt=_t.bounds.max.y-_t.bounds.min.y,Et=_t.bounds.max.x-_t.bounds.min.x,Mt=St.bounds.max.y-St.bounds.min.y,Tt=St.bounds.max.x-St.bounds.min.x,wt={bodyA:_t,pointA:{x:Et*ut,y:bt*ft},bodyB:St,pointB:{x:Tt*dt,y:Mt*pt}},Ct=ot.extend(wt,mt);it.addConstraint(ht,st.create(Ct))}return ht.label+=" Chain",ht},rt.mesh=function(ht,ut,ft,dt,pt){var mt=ht.bodies,vt,yt,_t,St,bt;for(vt=0;vt<ft;vt++){for(yt=1;yt<ut;yt++)_t=mt[yt-1+vt*ut],St=mt[yt+vt*ut],it.addConstraint(ht,st.create(ot.extend({bodyA:_t,bodyB:St},pt)));if(vt>0)for(yt=0;yt<ut;yt++)_t=mt[yt+(vt-1)*ut],St=mt[yt+vt*ut],it.addConstraint(ht,st.create(ot.extend({bodyA:_t,bodyB:St},pt))),dt&&yt>0&&(bt=mt[yt-1+(vt-1)*ut],it.addConstraint(ht,st.create(ot.extend({bodyA:bt,bodyB:St},pt)))),dt&&yt<ut-1&&(bt=mt[yt+1+(vt-1)*ut],it.addConstraint(ht,st.create(ot.extend({bodyA:bt,bodyB:St},pt))))}return ht.label+=" Mesh",ht},rt.pyramid=function(ht,ut,ft,dt,pt,mt,vt){return rt.stack(ht,ut,ft,dt,pt,mt,function(yt,_t,St,bt,Et,Mt){var Tt=Math.min(dt,Math.ceil(ft/2)),wt=Et?Et.bounds.max.x-Et.bounds.min.x:0;if(!(bt>Tt)){bt=Tt-bt;var Ct=bt,Rt=ft-1-bt;if(!(St<Ct||St>Rt)){Mt===1&&at.translate(Et,{x:(St+(ft%2===1?1:-1))*wt,y:0});var It=Et?St*wt:0;return vt(ht+It+St*pt,_t,St,bt,Et,Mt)}}})},rt.newtonsCradle=function(ht,ut,ft,dt,pt){for(var mt=it.create({label:"Newtons Cradle"}),vt=0;vt<ft;vt++){var yt=1.9,_t=lt.circle(ht+vt*(dt*yt),ut+pt,dt,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),St=st.create({pointA:{x:ht+vt*(dt*yt),y:ut},bodyB:_t});it.addBody(mt,_t),it.addConstraint(mt,St)}return mt},ct(rt,"newtonsCradle","Composites.newtonsCradle  moved to newtonsCradle example"),rt.car=function(ht,ut,ft,dt,pt){var mt=at.nextGroup(!0),vt=20,yt=-ft*.5+vt,_t=ft*.5-vt,St=0,bt=it.create({label:"Car"}),Et=lt.rectangle(ht,ut,ft,dt,{collisionFilter:{group:mt},chamfer:{radius:dt*.5},density:2e-4}),Mt=lt.circle(ht+yt,ut+St,pt,{collisionFilter:{group:mt},friction:.8}),Tt=lt.circle(ht+_t,ut+St,pt,{collisionFilter:{group:mt},friction:.8}),wt=st.create({bodyB:Et,pointB:{x:yt,y:St},bodyA:Mt,stiffness:1,length:0}),Ct=st.create({bodyB:Et,pointB:{x:_t,y:St},bodyA:Tt,stiffness:1,length:0});return it.addBody(bt,Et),it.addBody(bt,Mt),it.addBody(bt,Tt),it.addConstraint(bt,wt),it.addConstraint(bt,Ct),bt},ct(rt,"car","Composites.car  moved to car example"),rt.softBody=function(ht,ut,ft,dt,pt,mt,vt,yt,_t,St){_t=ot.extend({inertia:1/0},_t),St=ot.extend({stiffness:.2,render:{type:"line",anchors:!1}},St);var bt=rt.stack(ht,ut,ft,dt,pt,mt,function(Et,Mt){return lt.circle(Et,Mt,yt,_t)});return rt.mesh(bt,ft,dt,vt,St),bt.label="Soft Body",bt},ct(rt,"softBody","Composites.softBody  moved to softBody and cloth examples")})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(9),st=nt(0),ot=st.deprecated;(function(){rt.create=function(at){var lt={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return st.extend(lt,at)},rt.update=function(at,lt,ct,ht){var ut,ft,dt,pt=ct.world,mt=at.buckets,vt,yt,_t=!1;for(ut=0;ut<lt.length;ut++){var St=lt[ut];if(!(St.isSleeping&&!ht)&&!(pt.bounds&&(St.bounds.max.x<pt.bounds.min.x||St.bounds.min.x>pt.bounds.max.x||St.bounds.max.y<pt.bounds.min.y||St.bounds.min.y>pt.bounds.max.y))){var bt=rt._getRegion(at,St);if(!St.region||bt.id!==St.region.id||ht){(!St.region||ht)&&(St.region=bt);var Et=rt._regionUnion(bt,St.region);for(ft=Et.startCol;ft<=Et.endCol;ft++)for(dt=Et.startRow;dt<=Et.endRow;dt++){yt=rt._getBucketId(ft,dt),vt=mt[yt];var Mt=ft>=bt.startCol&&ft<=bt.endCol&&dt>=bt.startRow&&dt<=bt.endRow,Tt=ft>=St.region.startCol&&ft<=St.region.endCol&&dt>=St.region.startRow&&dt<=St.region.endRow;!Mt&&Tt&&Tt&&vt&&rt._bucketRemoveBody(at,vt,St),(St.region===bt||Mt&&!Tt||ht)&&(vt||(vt=rt._createBucket(mt,yt)),rt._bucketAddBody(at,vt,St))}St.region=bt,_t=!0}}}_t&&(at.pairsList=rt._createActivePairsList(at))},ot(rt,"update","Grid.update  replaced by Matter.Detector"),rt.clear=function(at){at.buckets={},at.pairs={},at.pairsList=[]},ot(rt,"clear","Grid.clear  replaced by Matter.Detector"),rt._regionUnion=function(at,lt){var ct=Math.min(at.startCol,lt.startCol),ht=Math.max(at.endCol,lt.endCol),ut=Math.min(at.startRow,lt.startRow),ft=Math.max(at.endRow,lt.endRow);return rt._createRegion(ct,ht,ut,ft)},rt._getRegion=function(at,lt){var ct=lt.bounds,ht=Math.floor(ct.min.x/at.bucketWidth),ut=Math.floor(ct.max.x/at.bucketWidth),ft=Math.floor(ct.min.y/at.bucketHeight),dt=Math.floor(ct.max.y/at.bucketHeight);return rt._createRegion(ht,ut,ft,dt)},rt._createRegion=function(at,lt,ct,ht){return{id:at+","+lt+","+ct+","+ht,startCol:at,endCol:lt,startRow:ct,endRow:ht}},rt._getBucketId=function(at,lt){return"C"+at+"R"+lt},rt._createBucket=function(at,lt){var ct=at[lt]=[];return ct},rt._bucketAddBody=function(at,lt,ct){var ht=at.pairs,ut=it.id,ft=lt.length,dt;for(dt=0;dt<ft;dt++){var pt=lt[dt];if(!(ct.id===pt.id||ct.isStatic&&pt.isStatic)){var mt=ut(ct,pt),vt=ht[mt];vt?vt[2]+=1:ht[mt]=[ct,pt,1]}}lt.push(ct)},rt._bucketRemoveBody=function(at,lt,ct){var ht=at.pairs,ut=it.id,ft;lt.splice(st.indexOf(lt,ct),1);var dt=lt.length;for(ft=0;ft<dt;ft++){var pt=ht[ut(ct,lt[ft])];pt&&(pt[2]-=1)}},rt._createActivePairsList=function(at){var lt,ct=at.pairs,ht=st.keys(ct),ut=ht.length,ft=[],dt;for(dt=0;dt<ut;dt++)lt=ct[ht[dt]],lt[2]>0?ft.push(lt):delete ct[ht[dt]];return ft}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(3),st=nt(7),ot=nt(14),at=nt(5),lt=nt(13),ct=nt(10),ht=nt(6),ut=nt(0),ft=nt(1);(function(){rt.create=function(dt,pt){var mt=(dt?dt.mouse:null)||(pt?pt.mouse:null);mt||(dt&&dt.render&&dt.render.canvas?mt=ot.create(dt.render.canvas):pt&&pt.element?mt=ot.create(pt.element):(mt=ot.create(),ut.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var vt=ct.create({label:"Mouse Constraint",pointA:mt.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),yt={type:"mouseConstraint",mouse:mt,element:null,body:null,constraint:vt,collisionFilter:{category:1,mask:4294967295,group:0}},_t=ut.extend(yt,pt);return at.on(dt,"beforeUpdate",function(){var St=ht.allBodies(dt.world);rt.update(_t,St),rt._triggerEvents(_t)}),_t},rt.update=function(dt,pt){var mt=dt.mouse,vt=dt.constraint,yt=dt.body;if(mt.button===0){if(vt.bodyB)st.set(vt.bodyB,!1),vt.pointA=mt.position;else for(var _t=0;_t<pt.length;_t++)if(yt=pt[_t],ft.contains(yt.bounds,mt.position)&&lt.canCollide(yt.collisionFilter,dt.collisionFilter))for(var St=yt.parts.length>1?1:0;St<yt.parts.length;St++){var bt=yt.parts[St];if(it.contains(bt.vertices,mt.position)){vt.pointA=mt.position,vt.bodyB=dt.body=yt,vt.pointB={x:mt.position.x-yt.position.x,y:mt.position.y-yt.position.y},vt.angleB=yt.angle,st.set(yt,!1),at.trigger(dt,"startdrag",{mouse:mt,body:yt});break}}}else vt.bodyB=dt.body=null,vt.pointB=null,yt&&at.trigger(dt,"enddrag",{mouse:mt,body:yt})},rt._triggerEvents=function(dt){var pt=dt.mouse,mt=pt.sourceEvents;mt.mousemove&&at.trigger(dt,"mousemove",{mouse:pt}),mt.mousedown&&at.trigger(dt,"mousedown",{mouse:pt}),mt.mouseup&&at.trigger(dt,"mouseup",{mouse:pt}),ot.clearSourceEvents(pt)}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(2),st=nt(8),ot=nt(1),at=nt(12),lt=nt(3);(function(){rt.collides=function(ct,ht){for(var ut=[],ft=ht.length,dt=ct.bounds,pt=st.collides,mt=ot.overlaps,vt=0;vt<ft;vt++){var yt=ht[vt],_t=yt.parts.length,St=_t===1?0:1;if(mt(yt.bounds,dt))for(var bt=St;bt<_t;bt++){var Et=yt.parts[bt];if(mt(Et.bounds,dt)){var Mt=pt(Et,ct);if(Mt){ut.push(Mt);break}}}}return ut},rt.ray=function(ct,ht,ut,ft){ft=ft||1e-100;for(var dt=it.angle(ht,ut),pt=it.magnitude(it.sub(ht,ut)),mt=(ut.x+ht.x)*.5,vt=(ut.y+ht.y)*.5,yt=at.rectangle(mt,vt,pt,ft,{angle:dt}),_t=rt.collides(yt,ct),St=0;St<_t.length;St+=1){var bt=_t[St];bt.body=bt.bodyB=bt.bodyA}return _t},rt.region=function(ct,ht,ut){for(var ft=[],dt=0;dt<ct.length;dt++){var pt=ct[dt],mt=ot.overlaps(pt.bounds,ht);(mt&&!ut||!mt&&ut)&&ft.push(pt)}return ft},rt.point=function(ct,ht){for(var ut=[],ft=0;ft<ct.length;ft++){var dt=ct[ft];if(ot.contains(dt.bounds,ht))for(var pt=dt.parts.length===1?0:1;pt<dt.parts.length;pt++){var mt=dt.parts[pt];if(ot.contains(mt.bounds,ht)&&lt.contains(mt.vertices,ht)){ut.push(dt);break}}}return ut}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(4),st=nt(0),ot=nt(6),at=nt(1),lt=nt(5),ct=nt(2),ht=nt(14);(function(){var ut,ft;typeof window<"u"&&(ut=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(St){window.setTimeout(function(){St(st.now())},1e3/60)},ft=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),rt._goodFps=30,rt._goodDelta=1e3/60,rt.create=function(St){var bt={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!St.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},Et=st.extend(bt,St);return Et.canvas&&(Et.canvas.width=Et.options.width||Et.canvas.width,Et.canvas.height=Et.options.height||Et.canvas.height),Et.mouse=St.mouse,Et.engine=St.engine,Et.canvas=Et.canvas||mt(Et.options.width,Et.options.height),Et.context=Et.canvas.getContext("2d"),Et.textures={},Et.bounds=Et.bounds||{min:{x:0,y:0},max:{x:Et.canvas.width,y:Et.canvas.height}},Et.controller=rt,Et.options.showBroadphase=!1,Et.options.pixelRatio!==1&&rt.setPixelRatio(Et,Et.options.pixelRatio),st.isElement(Et.element)&&Et.element.appendChild(Et.canvas),Et},rt.run=function(St){(function bt(Et){St.frameRequestId=ut(bt),dt(St,Et),rt.world(St,Et),(St.options.showStats||St.options.showDebug)&&rt.stats(St,St.context,Et),(St.options.showPerformance||St.options.showDebug)&&rt.performance(St,St.context,Et)})()},rt.stop=function(St){ft(St.frameRequestId)},rt.setPixelRatio=function(St,bt){var Et=St.options,Mt=St.canvas;bt==="auto"&&(bt=vt(Mt)),Et.pixelRatio=bt,Mt.setAttribute("data-pixel-ratio",bt),Mt.width=Et.width*bt,Mt.height=Et.height*bt,Mt.style.width=Et.width+"px",Mt.style.height=Et.height+"px"},rt.lookAt=function(St,bt,Et,Mt){Mt=typeof Mt<"u"?Mt:!0,bt=st.isArray(bt)?bt:[bt],Et=Et||{x:0,y:0};for(var Tt={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},wt=0;wt<bt.length;wt+=1){var Ct=bt[wt],Rt=Ct.bounds?Ct.bounds.min:Ct.min||Ct.position||Ct,It=Ct.bounds?Ct.bounds.max:Ct.max||Ct.position||Ct;Rt&&It&&(Rt.x<Tt.min.x&&(Tt.min.x=Rt.x),It.x>Tt.max.x&&(Tt.max.x=It.x),Rt.y<Tt.min.y&&(Tt.min.y=Rt.y),It.y>Tt.max.y&&(Tt.max.y=It.y))}var Dt=Tt.max.x-Tt.min.x+2*Et.x,Ft=Tt.max.y-Tt.min.y+2*Et.y,$t=St.canvas.height,Yt=St.canvas.width,Lt=Yt/$t,Ot=Dt/Ft,Nt=1,zt=1;Ot>Lt?zt=Ot/Lt:Nt=Lt/Ot,St.options.hasBounds=!0,St.bounds.min.x=Tt.min.x,St.bounds.max.x=Tt.min.x+Dt*Nt,St.bounds.min.y=Tt.min.y,St.bounds.max.y=Tt.min.y+Ft*zt,Mt&&(St.bounds.min.x+=Dt*.5-Dt*Nt*.5,St.bounds.max.x+=Dt*.5-Dt*Nt*.5,St.bounds.min.y+=Ft*.5-Ft*zt*.5,St.bounds.max.y+=Ft*.5-Ft*zt*.5),St.bounds.min.x-=Et.x,St.bounds.max.x-=Et.x,St.bounds.min.y-=Et.y,St.bounds.max.y-=Et.y,St.mouse&&(ht.setScale(St.mouse,{x:(St.bounds.max.x-St.bounds.min.x)/St.canvas.width,y:(St.bounds.max.y-St.bounds.min.y)/St.canvas.height}),ht.setOffset(St.mouse,St.bounds.min))},rt.startViewTransform=function(St){var bt=St.bounds.max.x-St.bounds.min.x,Et=St.bounds.max.y-St.bounds.min.y,Mt=bt/St.options.width,Tt=Et/St.options.height;St.context.setTransform(St.options.pixelRatio/Mt,0,0,St.options.pixelRatio/Tt,0,0),St.context.translate(-St.bounds.min.x,-St.bounds.min.y)},rt.endViewTransform=function(St){St.context.setTransform(St.options.pixelRatio,0,0,St.options.pixelRatio,0,0)},rt.world=function(St,bt){var Et=st.now(),Mt=St.engine,Tt=Mt.world,wt=St.canvas,Ct=St.context,Rt=St.options,It=St.timing,Dt=ot.allBodies(Tt),Ft=ot.allConstraints(Tt),$t=Rt.wireframes?Rt.wireframeBackground:Rt.background,Yt=[],Lt=[],Ot,Nt={timestamp:Mt.timing.timestamp};if(lt.trigger(St,"beforeRender",Nt),St.currentBackground!==$t&&_t(St,$t),Ct.globalCompositeOperation="source-in",Ct.fillStyle="transparent",Ct.fillRect(0,0,wt.width,wt.height),Ct.globalCompositeOperation="source-over",Rt.hasBounds){for(Ot=0;Ot<Dt.length;Ot++){var zt=Dt[Ot];at.overlaps(zt.bounds,St.bounds)&&Yt.push(zt)}for(Ot=0;Ot<Ft.length;Ot++){var Ht=Ft[Ot],qt=Ht.bodyA,Gt=Ht.bodyB,Xt=Ht.pointA,Zt=Ht.pointB;qt&&(Xt=ct.add(qt.position,Ht.pointA)),Gt&&(Zt=ct.add(Gt.position,Ht.pointB)),!(!Xt||!Zt)&&(at.contains(St.bounds,Xt)||at.contains(St.bounds,Zt))&&Lt.push(Ht)}rt.startViewTransform(St),St.mouse&&(ht.setScale(St.mouse,{x:(St.bounds.max.x-St.bounds.min.x)/St.options.width,y:(St.bounds.max.y-St.bounds.min.y)/St.options.height}),ht.setOffset(St.mouse,St.bounds.min))}else Lt=Ft,Yt=Dt,St.options.pixelRatio!==1&&St.context.setTransform(St.options.pixelRatio,0,0,St.options.pixelRatio,0,0);!Rt.wireframes||Mt.enableSleeping&&Rt.showSleeping?rt.bodies(St,Yt,Ct):(Rt.showConvexHulls&&rt.bodyConvexHulls(St,Yt,Ct),rt.bodyWireframes(St,Yt,Ct)),Rt.showBounds&&rt.bodyBounds(St,Yt,Ct),(Rt.showAxes||Rt.showAngleIndicator)&&rt.bodyAxes(St,Yt,Ct),Rt.showPositions&&rt.bodyPositions(St,Yt,Ct),Rt.showVelocity&&rt.bodyVelocity(St,Yt,Ct),Rt.showIds&&rt.bodyIds(St,Yt,Ct),Rt.showSeparations&&rt.separations(St,Mt.pairs.list,Ct),Rt.showCollisions&&rt.collisions(St,Mt.pairs.list,Ct),Rt.showVertexNumbers&&rt.vertexNumbers(St,Yt,Ct),Rt.showMousePosition&&rt.mousePosition(St,St.mouse,Ct),rt.constraints(Lt,Ct),Rt.hasBounds&&rt.endViewTransform(St),lt.trigger(St,"afterRender",Nt),It.lastElapsed=st.now()-Et},rt.stats=function(St,bt,Et){for(var Mt=St.engine,Tt=Mt.world,wt=ot.allBodies(Tt),Ct=0,Rt=55,It=44,Dt=0,Ft=0,$t=0;$t<wt.length;$t+=1)Ct+=wt[$t].parts.length;var Yt={Part:Ct,Body:wt.length,Cons:ot.allConstraints(Tt).length,Comp:ot.allComposites(Tt).length,Pair:Mt.pairs.list.length};bt.fillStyle="#0e0f19",bt.fillRect(Dt,Ft,Rt*5.5,It),bt.font="12px Arial",bt.textBaseline="top",bt.textAlign="right";for(var Lt in Yt){var Ot=Yt[Lt];bt.fillStyle="#aaa",bt.fillText(Lt,Dt+Rt,Ft+8),bt.fillStyle="#eee",bt.fillText(Ot,Dt+Rt,Ft+26),Dt+=Rt}},rt.performance=function(St,bt){var Et=St.engine,Mt=St.timing,Tt=Mt.deltaHistory,wt=Mt.elapsedHistory,Ct=Mt.timestampElapsedHistory,Rt=Mt.engineDeltaHistory,It=Mt.engineElapsedHistory,Dt=Et.timing.lastDelta,Ft=pt(Tt),$t=pt(wt),Yt=pt(Rt),Lt=pt(It),Ot=pt(Ct),Nt=Ot/Ft||0,zt=1e3/Ft||0,Ht=4,qt=12,Gt=60,Xt=34,Zt=10,Qt=69;bt.fillStyle="#0e0f19",bt.fillRect(0,50,qt*4+Gt*5+22,Xt),rt.status(bt,Zt,Qt,Gt,Ht,Tt.length,Math.round(zt)+" fps",zt/rt._goodFps,function(un){return Tt[un]/Ft-1}),rt.status(bt,Zt+qt+Gt,Qt,Gt,Ht,Rt.length,Dt.toFixed(2)+" dt",rt._goodDelta/Dt,function(un){return Rt[un]/Yt-1}),rt.status(bt,Zt+(qt+Gt)*2,Qt,Gt,Ht,It.length,Lt.toFixed(2)+" ut",1-Lt/rt._goodFps,function(un){return It[un]/Lt-1}),rt.status(bt,Zt+(qt+Gt)*3,Qt,Gt,Ht,wt.length,$t.toFixed(2)+" rt",1-$t/rt._goodFps,function(un){return wt[un]/$t-1}),rt.status(bt,Zt+(qt+Gt)*4,Qt,Gt,Ht,Ct.length,Nt.toFixed(2)+" x",Nt*Nt*Nt,function(un){return(Ct[un]/Tt[un]/Nt||0)-1})},rt.status=function(St,bt,Et,Mt,Tt,wt,Ct,Rt,It){St.strokeStyle="#888",St.fillStyle="#444",St.lineWidth=1,St.fillRect(bt,Et+7,Mt,1),St.beginPath(),St.moveTo(bt,Et+7-Tt*st.clamp(.4*It(0),-2,2));for(var Dt=0;Dt<Mt;Dt+=1)St.lineTo(bt+Dt,Et+7-(Dt<wt?Tt*st.clamp(.4*It(Dt),-2,2):0));St.stroke(),St.fillStyle="hsl("+st.clamp(25+95*Rt,0,120)+",100%,60%)",St.fillRect(bt,Et-7,4,4),St.font="12px Arial",St.textBaseline="middle",St.textAlign="right",St.fillStyle="#eee",St.fillText(Ct,bt+Mt,Et-5)},rt.constraints=function(St,bt){for(var Et=bt,Mt=0;Mt<St.length;Mt++){var Tt=St[Mt];if(!(!Tt.render.visible||!Tt.pointA||!Tt.pointB)){var wt=Tt.bodyA,Ct=Tt.bodyB,Rt,It;if(wt?Rt=ct.add(wt.position,Tt.pointA):Rt=Tt.pointA,Tt.render.type==="pin")Et.beginPath(),Et.arc(Rt.x,Rt.y,3,0,2*Math.PI),Et.closePath();else{if(Ct?It=ct.add(Ct.position,Tt.pointB):It=Tt.pointB,Et.beginPath(),Et.moveTo(Rt.x,Rt.y),Tt.render.type==="spring")for(var Dt=ct.sub(It,Rt),Ft=ct.perp(ct.normalise(Dt)),$t=Math.ceil(st.clamp(Tt.length/5,12,20)),Yt,Lt=1;Lt<$t;Lt+=1)Yt=Lt%2===0?1:-1,Et.lineTo(Rt.x+Dt.x*(Lt/$t)+Ft.x*Yt*4,Rt.y+Dt.y*(Lt/$t)+Ft.y*Yt*4);Et.lineTo(It.x,It.y)}Tt.render.lineWidth&&(Et.lineWidth=Tt.render.lineWidth,Et.strokeStyle=Tt.render.strokeStyle,Et.stroke()),Tt.render.anchors&&(Et.fillStyle=Tt.render.strokeStyle,Et.beginPath(),Et.arc(Rt.x,Rt.y,3,0,2*Math.PI),Et.arc(It.x,It.y,3,0,2*Math.PI),Et.closePath(),Et.fill())}}},rt.bodies=function(St,bt,Et){var Mt=Et;St.engine;var Tt=St.options,wt=Tt.showInternalEdges||!Tt.wireframes,Ct,Rt,It,Dt;for(It=0;It<bt.length;It++)if(Ct=bt[It],!!Ct.render.visible){for(Dt=Ct.parts.length>1?1:0;Dt<Ct.parts.length;Dt++)if(Rt=Ct.parts[Dt],!!Rt.render.visible){if(Tt.showSleeping&&Ct.isSleeping?Mt.globalAlpha=.5*Rt.render.opacity:Rt.render.opacity!==1&&(Mt.globalAlpha=Rt.render.opacity),Rt.render.sprite&&Rt.render.sprite.texture&&!Tt.wireframes){var Ft=Rt.render.sprite,$t=yt(St,Ft.texture);Mt.translate(Rt.position.x,Rt.position.y),Mt.rotate(Rt.angle),Mt.drawImage($t,$t.width*-Ft.xOffset*Ft.xScale,$t.height*-Ft.yOffset*Ft.yScale,$t.width*Ft.xScale,$t.height*Ft.yScale),Mt.rotate(-Rt.angle),Mt.translate(-Rt.position.x,-Rt.position.y)}else{if(Rt.circleRadius)Mt.beginPath(),Mt.arc(Rt.position.x,Rt.position.y,Rt.circleRadius,0,2*Math.PI);else{Mt.beginPath(),Mt.moveTo(Rt.vertices[0].x,Rt.vertices[0].y);for(var Yt=1;Yt<Rt.vertices.length;Yt++)!Rt.vertices[Yt-1].isInternal||wt?Mt.lineTo(Rt.vertices[Yt].x,Rt.vertices[Yt].y):Mt.moveTo(Rt.vertices[Yt].x,Rt.vertices[Yt].y),Rt.vertices[Yt].isInternal&&!wt&&Mt.moveTo(Rt.vertices[(Yt+1)%Rt.vertices.length].x,Rt.vertices[(Yt+1)%Rt.vertices.length].y);Mt.lineTo(Rt.vertices[0].x,Rt.vertices[0].y),Mt.closePath()}Tt.wireframes?(Mt.lineWidth=1,Mt.strokeStyle="#bbb",Mt.stroke()):(Mt.fillStyle=Rt.render.fillStyle,Rt.render.lineWidth&&(Mt.lineWidth=Rt.render.lineWidth,Mt.strokeStyle=Rt.render.strokeStyle,Mt.stroke()),Mt.fill())}Mt.globalAlpha=1}}},rt.bodyWireframes=function(St,bt,Et){var Mt=Et,Tt=St.options.showInternalEdges,wt,Ct,Rt,It,Dt;for(Mt.beginPath(),Rt=0;Rt<bt.length;Rt++)if(wt=bt[Rt],!!wt.render.visible)for(Dt=wt.parts.length>1?1:0;Dt<wt.parts.length;Dt++){for(Ct=wt.parts[Dt],Mt.moveTo(Ct.vertices[0].x,Ct.vertices[0].y),It=1;It<Ct.vertices.length;It++)!Ct.vertices[It-1].isInternal||Tt?Mt.lineTo(Ct.vertices[It].x,Ct.vertices[It].y):Mt.moveTo(Ct.vertices[It].x,Ct.vertices[It].y),Ct.vertices[It].isInternal&&!Tt&&Mt.moveTo(Ct.vertices[(It+1)%Ct.vertices.length].x,Ct.vertices[(It+1)%Ct.vertices.length].y);Mt.lineTo(Ct.vertices[0].x,Ct.vertices[0].y)}Mt.lineWidth=1,Mt.strokeStyle="#bbb",Mt.stroke()},rt.bodyConvexHulls=function(St,bt,Et){var Mt=Et,Tt,wt,Ct;for(Mt.beginPath(),wt=0;wt<bt.length;wt++)if(Tt=bt[wt],!(!Tt.render.visible||Tt.parts.length===1)){for(Mt.moveTo(Tt.vertices[0].x,Tt.vertices[0].y),Ct=1;Ct<Tt.vertices.length;Ct++)Mt.lineTo(Tt.vertices[Ct].x,Tt.vertices[Ct].y);Mt.lineTo(Tt.vertices[0].x,Tt.vertices[0].y)}Mt.lineWidth=1,Mt.strokeStyle="rgba(255,255,255,0.2)",Mt.stroke()},rt.vertexNumbers=function(St,bt,Et){var Mt=Et,Tt,wt,Ct;for(Tt=0;Tt<bt.length;Tt++){var Rt=bt[Tt].parts;for(Ct=Rt.length>1?1:0;Ct<Rt.length;Ct++){var It=Rt[Ct];for(wt=0;wt<It.vertices.length;wt++)Mt.fillStyle="rgba(255,255,255,0.2)",Mt.fillText(Tt+"_"+wt,It.position.x+(It.vertices[wt].x-It.position.x)*.8,It.position.y+(It.vertices[wt].y-It.position.y)*.8)}}},rt.mousePosition=function(St,bt,Et){var Mt=Et;Mt.fillStyle="rgba(255,255,255,0.8)",Mt.fillText(bt.position.x+"  "+bt.position.y,bt.position.x+5,bt.position.y-5)},rt.bodyBounds=function(St,bt,Et){var Mt=Et;St.engine;var Tt=St.options;Mt.beginPath();for(var wt=0;wt<bt.length;wt++){var Ct=bt[wt];if(Ct.render.visible)for(var Rt=bt[wt].parts,It=Rt.length>1?1:0;It<Rt.length;It++){var Dt=Rt[It];Mt.rect(Dt.bounds.min.x,Dt.bounds.min.y,Dt.bounds.max.x-Dt.bounds.min.x,Dt.bounds.max.y-Dt.bounds.min.y)}}Tt.wireframes?Mt.strokeStyle="rgba(255,255,255,0.08)":Mt.strokeStyle="rgba(0,0,0,0.1)",Mt.lineWidth=1,Mt.stroke()},rt.bodyAxes=function(St,bt,Et){var Mt=Et;St.engine;var Tt=St.options,wt,Ct,Rt,It;for(Mt.beginPath(),Ct=0;Ct<bt.length;Ct++){var Dt=bt[Ct],Ft=Dt.parts;if(Dt.render.visible)if(Tt.showAxes)for(Rt=Ft.length>1?1:0;Rt<Ft.length;Rt++)for(wt=Ft[Rt],It=0;It<wt.axes.length;It++){var $t=wt.axes[It];Mt.moveTo(wt.position.x,wt.position.y),Mt.lineTo(wt.position.x+$t.x*20,wt.position.y+$t.y*20)}else for(Rt=Ft.length>1?1:0;Rt<Ft.length;Rt++)for(wt=Ft[Rt],It=0;It<wt.axes.length;It++)Mt.moveTo(wt.position.x,wt.position.y),Mt.lineTo((wt.vertices[0].x+wt.vertices[wt.vertices.length-1].x)/2,(wt.vertices[0].y+wt.vertices[wt.vertices.length-1].y)/2)}Tt.wireframes?(Mt.strokeStyle="indianred",Mt.lineWidth=1):(Mt.strokeStyle="rgba(255, 255, 255, 0.4)",Mt.globalCompositeOperation="overlay",Mt.lineWidth=2),Mt.stroke(),Mt.globalCompositeOperation="source-over"},rt.bodyPositions=function(St,bt,Et){var Mt=Et;St.engine;var Tt=St.options,wt,Ct,Rt,It;for(Mt.beginPath(),Rt=0;Rt<bt.length;Rt++)if(wt=bt[Rt],!!wt.render.visible)for(It=0;It<wt.parts.length;It++)Ct=wt.parts[It],Mt.arc(Ct.position.x,Ct.position.y,3,0,2*Math.PI,!1),Mt.closePath();for(Tt.wireframes?Mt.fillStyle="indianred":Mt.fillStyle="rgba(0,0,0,0.5)",Mt.fill(),Mt.beginPath(),Rt=0;Rt<bt.length;Rt++)wt=bt[Rt],wt.render.visible&&(Mt.arc(wt.positionPrev.x,wt.positionPrev.y,2,0,2*Math.PI,!1),Mt.closePath());Mt.fillStyle="rgba(255,165,0,0.8)",Mt.fill()},rt.bodyVelocity=function(St,bt,Et){var Mt=Et;Mt.beginPath();for(var Tt=0;Tt<bt.length;Tt++){var wt=bt[Tt];if(wt.render.visible){var Ct=it.getVelocity(wt);Mt.moveTo(wt.position.x,wt.position.y),Mt.lineTo(wt.position.x+Ct.x,wt.position.y+Ct.y)}}Mt.lineWidth=3,Mt.strokeStyle="cornflowerblue",Mt.stroke()},rt.bodyIds=function(St,bt,Et){var Mt=Et,Tt,wt;for(Tt=0;Tt<bt.length;Tt++)if(bt[Tt].render.visible){var Ct=bt[Tt].parts;for(wt=Ct.length>1?1:0;wt<Ct.length;wt++){var Rt=Ct[wt];Mt.font="12px Arial",Mt.fillStyle="rgba(255,255,255,0.5)",Mt.fillText(Rt.id,Rt.position.x+10,Rt.position.y-10)}}},rt.collisions=function(St,bt,Et){var Mt=Et,Tt=St.options,wt,Ct,Rt,It;for(Mt.beginPath(),Rt=0;Rt<bt.length;Rt++)if(wt=bt[Rt],!!wt.isActive)for(Ct=wt.collision,It=0;It<wt.activeContacts.length;It++){var Dt=wt.activeContacts[It],Ft=Dt.vertex;Mt.rect(Ft.x-1.5,Ft.y-1.5,3.5,3.5)}for(Tt.wireframes?Mt.fillStyle="rgba(255,255,255,0.7)":Mt.fillStyle="orange",Mt.fill(),Mt.beginPath(),Rt=0;Rt<bt.length;Rt++)if(wt=bt[Rt],!!wt.isActive&&(Ct=wt.collision,wt.activeContacts.length>0)){var $t=wt.activeContacts[0].vertex.x,Yt=wt.activeContacts[0].vertex.y;wt.activeContacts.length===2&&($t=(wt.activeContacts[0].vertex.x+wt.activeContacts[1].vertex.x)/2,Yt=(wt.activeContacts[0].vertex.y+wt.activeContacts[1].vertex.y)/2),Ct.bodyB===Ct.supports[0].body||Ct.bodyA.isStatic===!0?Mt.moveTo($t-Ct.normal.x*8,Yt-Ct.normal.y*8):Mt.moveTo($t+Ct.normal.x*8,Yt+Ct.normal.y*8),Mt.lineTo($t,Yt)}Tt.wireframes?Mt.strokeStyle="rgba(255,165,0,0.7)":Mt.strokeStyle="orange",Mt.lineWidth=1,Mt.stroke()},rt.separations=function(St,bt,Et){var Mt=Et,Tt=St.options,wt,Ct,Rt,It,Dt;for(Mt.beginPath(),Dt=0;Dt<bt.length;Dt++)if(wt=bt[Dt],!!wt.isActive){Ct=wt.collision,Rt=Ct.bodyA,It=Ct.bodyB;var Ft=1;!It.isStatic&&!Rt.isStatic&&(Ft=.5),It.isStatic&&(Ft=0),Mt.moveTo(It.position.x,It.position.y),Mt.lineTo(It.position.x-Ct.penetration.x*Ft,It.position.y-Ct.penetration.y*Ft),Ft=1,!It.isStatic&&!Rt.isStatic&&(Ft=.5),Rt.isStatic&&(Ft=0),Mt.moveTo(Rt.position.x,Rt.position.y),Mt.lineTo(Rt.position.x+Ct.penetration.x*Ft,Rt.position.y+Ct.penetration.y*Ft)}Tt.wireframes?Mt.strokeStyle="rgba(255,165,0,0.5)":Mt.strokeStyle="orange",Mt.stroke()},rt.inspector=function(St,bt){St.engine;var Et=St.selected,Mt=St.render,Tt=Mt.options,wt;if(Tt.hasBounds){var Ct=Mt.bounds.max.x-Mt.bounds.min.x,Rt=Mt.bounds.max.y-Mt.bounds.min.y,It=Ct/Mt.options.width,Dt=Rt/Mt.options.height;bt.scale(1/It,1/Dt),bt.translate(-Mt.bounds.min.x,-Mt.bounds.min.y)}for(var Ft=0;Ft<Et.length;Ft++){var $t=Et[Ft].data;switch(bt.translate(.5,.5),bt.lineWidth=1,bt.strokeStyle="rgba(255,165,0,0.9)",bt.setLineDash([1,2]),$t.type){case"body":wt=$t.bounds,bt.beginPath(),bt.rect(Math.floor(wt.min.x-3),Math.floor(wt.min.y-3),Math.floor(wt.max.x-wt.min.x+6),Math.floor(wt.max.y-wt.min.y+6)),bt.closePath(),bt.stroke();break;case"constraint":var Yt=$t.pointA;$t.bodyA&&(Yt=$t.pointB),bt.beginPath(),bt.arc(Yt.x,Yt.y,10,0,2*Math.PI),bt.closePath(),bt.stroke();break}bt.setLineDash([]),bt.translate(-.5,-.5)}St.selectStart!==null&&(bt.translate(.5,.5),bt.lineWidth=1,bt.strokeStyle="rgba(255,165,0,0.6)",bt.fillStyle="rgba(255,165,0,0.1)",wt=St.selectBounds,bt.beginPath(),bt.rect(Math.floor(wt.min.x),Math.floor(wt.min.y),Math.floor(wt.max.x-wt.min.x),Math.floor(wt.max.y-wt.min.y)),bt.closePath(),bt.stroke(),bt.fill(),bt.translate(-.5,-.5)),Tt.hasBounds&&bt.setTransform(1,0,0,1,0,0)};var dt=function(St,bt){var Et=St.engine,Mt=St.timing,Tt=Mt.historySize,wt=Et.timing.timestamp;Mt.delta=bt-Mt.lastTime||rt._goodDelta,Mt.lastTime=bt,Mt.timestampElapsed=wt-Mt.lastTimestamp||0,Mt.lastTimestamp=wt,Mt.deltaHistory.unshift(Mt.delta),Mt.deltaHistory.length=Math.min(Mt.deltaHistory.length,Tt),Mt.engineDeltaHistory.unshift(Et.timing.lastDelta),Mt.engineDeltaHistory.length=Math.min(Mt.engineDeltaHistory.length,Tt),Mt.timestampElapsedHistory.unshift(Mt.timestampElapsed),Mt.timestampElapsedHistory.length=Math.min(Mt.timestampElapsedHistory.length,Tt),Mt.engineElapsedHistory.unshift(Et.timing.lastElapsed),Mt.engineElapsedHistory.length=Math.min(Mt.engineElapsedHistory.length,Tt),Mt.elapsedHistory.unshift(Mt.lastElapsed),Mt.elapsedHistory.length=Math.min(Mt.elapsedHistory.length,Tt)},pt=function(St){for(var bt=0,Et=0;Et<St.length;Et+=1)bt+=St[Et];return bt/St.length||0},mt=function(St,bt){var Et=document.createElement("canvas");return Et.width=St,Et.height=bt,Et.oncontextmenu=function(){return!1},Et.onselectstart=function(){return!1},Et},vt=function(St){var bt=St.getContext("2d"),Et=window.devicePixelRatio||1,Mt=bt.webkitBackingStorePixelRatio||bt.mozBackingStorePixelRatio||bt.msBackingStorePixelRatio||bt.oBackingStorePixelRatio||bt.backingStorePixelRatio||1;return Et/Mt},yt=function(St,bt){var Et=St.textures[bt];return Et||(Et=St.textures[bt]=new Image,Et.src=bt,Et)},_t=function(St,bt){var Et=bt;/(jpg|gif|png)$/.test(bt)&&(Et="url("+bt+")"),St.canvas.style.background=Et,St.canvas.style.backgroundSize="contain",St.currentBackground=bt}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(5),st=nt(17),ot=nt(0);(function(){var at,lt;if(typeof window<"u"&&(at=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,lt=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!at){var ct;at=function(ht){ct=setTimeout(function(){ht(ot.now())},1e3/60)},lt=function(){clearTimeout(ct)}}rt.create=function(ht){var ut={fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},ft=ot.extend(ut,ht);return ft.delta=ft.delta||1e3/ft.fps,ft.deltaMin=ft.deltaMin||1e3/ft.fps,ft.deltaMax=ft.deltaMax||1e3/(ft.fps*.5),ft.fps=1e3/ft.delta,ft},rt.run=function(ht,ut){return typeof ht.positionIterations<"u"&&(ut=ht,ht=rt.create()),function ft(dt){ht.frameRequestId=at(ft),dt&&ht.enabled&&rt.tick(ht,ut,dt)}(),ht},rt.tick=function(ht,ut,ft){var dt=ut.timing,pt;ht.isFixed?pt=ht.delta:(pt=ft-ht.timePrev||ht.delta,ht.timePrev=ft,ht.deltaHistory.push(pt),ht.deltaHistory=ht.deltaHistory.slice(-ht.deltaSampleSize),pt=Math.min.apply(null,ht.deltaHistory),pt=pt<ht.deltaMin?ht.deltaMin:pt,pt=pt>ht.deltaMax?ht.deltaMax:pt,ht.delta=pt);var mt={timestamp:dt.timestamp};it.trigger(ht,"beforeTick",mt),ht.frameCounter+=1,ft-ht.counterTimestamp>=1e3&&(ht.fps=ht.frameCounter*((ft-ht.counterTimestamp)/1e3),ht.counterTimestamp=ft,ht.frameCounter=0),it.trigger(ht,"tick",mt),it.trigger(ht,"beforeUpdate",mt),st.update(ut,pt),it.trigger(ht,"afterUpdate",mt),it.trigger(ht,"afterTick",mt)},rt.stop=function(ht){lt(ht.frameRequestId)},rt.start=function(ht,ut){rt.run(ht,ut)}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(8),st=nt(0),ot=st.deprecated;(function(){rt.collides=function(at,lt){return it.collides(at,lt)},ot(rt,"collides","SAT.collides  replaced by Collision.collides")})()},function(_e,tt,nt){var rt={};_e.exports=rt,nt(1);var it=nt(0);(function(){rt.pathToVertices=function(st,ot){typeof window<"u"&&!("SVGPathSeg"in window)&&it.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var at,lt,ct,ht,ut,ft,dt,pt,mt,vt,yt=[],_t,St,bt=0,Et=0,Mt=0;ot=ot||15;var Tt=function(Ct,Rt,It){var Dt=It%2===1&&It>1;if(!mt||Ct!=mt.x||Rt!=mt.y){mt&&Dt?(_t=mt.x,St=mt.y):(_t=0,St=0);var Ft={x:_t+Ct,y:St+Rt};(Dt||!mt)&&(mt=Ft),yt.push(Ft),Et=_t+Ct,Mt=St+Rt}},wt=function(Ct){var Rt=Ct.pathSegTypeAsLetter.toUpperCase();if(Rt!=="Z"){switch(Rt){case"M":case"L":case"T":case"C":case"S":case"Q":Et=Ct.x,Mt=Ct.y;break;case"H":Et=Ct.x;break;case"V":Mt=Ct.y;break}Tt(Et,Mt,Ct.pathSegType)}};for(rt._svgPathToAbsolute(st),ct=st.getTotalLength(),ft=[],at=0;at<st.pathSegList.numberOfItems;at+=1)ft.push(st.pathSegList.getItem(at));for(dt=ft.concat();bt<ct;){if(vt=st.getPathSegAtLength(bt),ut=ft[vt],ut!=pt){for(;dt.length&&dt[0]!=ut;)wt(dt.shift());pt=ut}switch(ut.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":ht=st.getPointAtLength(bt),Tt(ht.x,ht.y,0);break}bt+=ot}for(at=0,lt=dt.length;at<lt;++at)wt(dt[at]);return yt},rt._svgPathToAbsolute=function(st){for(var ot,at,lt,ct,ht,ut,ft=st.pathSegList,dt=0,pt=0,mt=ft.numberOfItems,vt=0;vt<mt;++vt){var yt=ft.getItem(vt),_t=yt.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(_t))"x"in yt&&(dt=yt.x),"y"in yt&&(pt=yt.y);else switch("x1"in yt&&(lt=dt+yt.x1),"x2"in yt&&(ht=dt+yt.x2),"y1"in yt&&(ct=pt+yt.y1),"y2"in yt&&(ut=pt+yt.y2),"x"in yt&&(dt+=yt.x),"y"in yt&&(pt+=yt.y),_t){case"m":ft.replaceItem(st.createSVGPathSegMovetoAbs(dt,pt),vt);break;case"l":ft.replaceItem(st.createSVGPathSegLinetoAbs(dt,pt),vt);break;case"h":ft.replaceItem(st.createSVGPathSegLinetoHorizontalAbs(dt),vt);break;case"v":ft.replaceItem(st.createSVGPathSegLinetoVerticalAbs(pt),vt);break;case"c":ft.replaceItem(st.createSVGPathSegCurvetoCubicAbs(dt,pt,lt,ct,ht,ut),vt);break;case"s":ft.replaceItem(st.createSVGPathSegCurvetoCubicSmoothAbs(dt,pt,ht,ut),vt);break;case"q":ft.replaceItem(st.createSVGPathSegCurvetoQuadraticAbs(dt,pt,lt,ct),vt);break;case"t":ft.replaceItem(st.createSVGPathSegCurvetoQuadraticSmoothAbs(dt,pt),vt);break;case"a":ft.replaceItem(st.createSVGPathSegArcAbs(dt,pt,yt.r1,yt.r2,yt.angle,yt.largeArcFlag,yt.sweepFlag),vt);break;case"z":case"Z":dt=ot,pt=at;break}(_t=="M"||_t=="m")&&(ot=dt,at=pt)}}})()},function(_e,tt,nt){var rt={};_e.exports=rt;var it=nt(6);nt(0),function(){rt.create=it.create,rt.add=it.add,rt.remove=it.remove,rt.clear=it.clear,rt.addComposite=it.addComposite,rt.addBody=it.addBody,rt.addConstraint=it.addConstraint}()}])})})(matter);var matterExports=matter.exports;const Matter=getDefaultExportFromCjs(matterExports),MatterCategory={Invisible:0,Default:1,Character:2,Cloud:4,Particle:8,Balloon:16};class MatterInstance{constructor(_,_e){Jn(this,"container");Jn(this,"engine");Jn(this,"render");Jn(this,"runner");Jn(this,"running",!1);Jn(this,"mouse");Jn(this,"constraint");this.container=_,this.engine=Matter.Engine.create({gravity:{x:0,y:0},timing:{timeScale:_e&&_e.fast?3:1}}),this.render=Matter.Render.create({element:this.container,engine:this.engine,options:{width:this.container.clientWidth,height:this.container.clientHeight,background:"transparent",wireframes:!1,showAngleIndicator:!1,showDebug:!1,pixelRatio:window.devicePixelRatio}}),this.runner=Matter.Runner.create(),this.mouse=Matter.Mouse.create(this.render.canvas),this.mouse.pixelRatio=window.devicePixelRatio,this.constraint=Matter.MouseConstraint.create(this.engine,{mouse:this.mouse,constraint:{stiffness:.1,damping:.1,render:{visible:!1}},collisionFilter:{category:_e?_e.category:MatterCategory.Default,mask:_e?_e.mask:MatterCategory.Default}}),this.constraint.mouse.element.removeEventListener("mousewheel",this.constraint.mouse.mousewheel),this.constraint.mouse.element.removeEventListener("DOMMouseScroll",this.constraint.mouse.mousewheel),this.render.mouse=this.mouse,Matter.Composite.add(this.engine.world,this.constraint),this.container.style.pointerEvents="auto"}run(){this.running||(this.running=!0,Matter.Render.run(this.render),Matter.Runner.run(this.runner,this.engine))}stop(){this.running&&(this.running=!1,Matter.Render.stop(this.render),Matter.Runner.stop(this.runner))}clear(){Matter.World.clear(this.engine.world,!1),Matter.Engine.clear(this.engine),this.render.canvas.remove()}resize(){this.render.bounds.max.x=this.container.clientWidth,this.render.bounds.max.y=this.container.clientHeight,this.render.options.width=this.container.clientWidth,this.render.options.height=this.container.clientHeight,this.render.canvas.width=this.container.clientWidth,this.render.canvas.height=this.container.clientHeight,Matter.Render.setPixelRatio(this.render,window.devicePixelRatio),this.mouse.pixelRatio=window.devicePixelRatio}width(){return parseInt(this.render.canvas.style.width)}height(){return parseInt(this.render.canvas.style.height)}}const wallThickness$1=3e3,wallLength$1=1e4,vary=.1,ballonRadius=.4,balloonUp=.171,brickDown=.515,brickMass=14285,balloonMass=200,stringStiffness=.04,bounceCutOff=4,bounceCount=5,bounceForce=30,stringExtend=et=>Math.floor((-1+Math.sqrt(1+8*et))/2)+Math.random();class Party{constructor(_,_e){Jn(this,"instance");Jn(this,"engine");Jn(this,"container");Jn(this,"bricks",{});Jn(this,"walls",[]);Jn(this,"spikeId",-1);Jn(this,"spikeElement");Jn(this,"balloons",{});Jn(this,"trampolineId",-1);this.instance=_,this.engine=_.engine,this.container=_.container,this.spikeElement=_e}spawnWalls(){var _={isStatic:!0,render:{visible:!1},collisionFilter:{category:MatterCategory.Default,mask:MatterCategory.Default}};this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth/2,-wallThickness$1/2,wallLength$1,wallThickness$1+this.spikeElement.offsetHeight*2,{isStatic:!0,isSensor:!0,render:{visible:!1},collisionFilter:{category:MatterCategory.Balloon,mask:MatterCategory.Balloon}})),this.spikeId=this.walls[0].id,this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth+wallThickness$1/2,this.container.clientHeight/2,wallThickness$1,wallLength$1,_)),this.walls.push(Matter.Bodies.rectangle(-wallThickness$1/2,this.container.clientHeight/2,wallThickness$1,wallLength$1,_)),this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth/2,this.container.clientHeight+wallThickness$1/2,wallLength$1,wallThickness$1,{isStatic:!0,isSensor:!0,render:{visible:!1},collisionFilter:{category:MatterCategory.Default,mask:MatterCategory.Default}})),this.trampolineId=this.walls[3].id,this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth/2,-wallThickness$1/2,wallLength$1,wallThickness$1,_)),Matter.Composite.add(this.engine.world,this.walls)}repositionWalls(){Matter.Body.setPosition(this.walls[0],{x:this.container.clientWidth/2,y:-wallThickness$1/2}),Matter.Body.setPosition(this.walls[1],{x:this.container.clientWidth+wallThickness$1/2,y:this.container.clientHeight/2}),Matter.Body.setPosition(this.walls[2],{x:-wallThickness$1/2,y:this.container.clientHeight/2}),Matter.Body.setPosition(this.walls[3],{x:this.container.clientWidth/2,y:this.container.clientHeight+wallThickness$1/2}),Matter.Body.setPosition(this.walls[4],{x:this.container.clientWidth/2,y:-wallThickness$1/2})}spawnBrick(_){const _e=new Brick(_);return this.bricks[_e.body.id]=_e,Matter.World.add(this.engine.world,_e.body),_e}despawnBrick(_){const _e=this.bricks[_];_e.balloons.forEach(tt=>this.despawnBalloon(tt)),Matter.Composite.remove(this.engine.world,_e.body),delete this.bricks[_]}spawnBalloon(_,_e){const tt=MatterColor.RandomArray(_e);for(let nt=0;nt<_e;nt++){const rt=new Balloon(_,tt[nt],stringExtend(_.balloons.size));_.balloons.add(rt.body.id),Matter.World.add(this.engine.world,rt.constraint),Matter.World.add(this.engine.world,rt.body),this.balloons[rt.body.id]=rt}}despawnBalloon(_){const _e=this.balloons[_];_e.brick.balloons.delete(_e.body.id),Matter.Composite.remove(this.engine.world,_e.constraint),Matter.Composite.remove(this.engine.world,_e.body),delete this.balloons[_]}bounceBrick(_){const _e=this.bricks[_];_e.balloons.size>=bounceCutOff||(Matter.Body.applyForce(_e.body,_e.body.position,{x:0,y:bounceForce}),this.spawnBalloon(_e,bounceCount))}resize(){this.repositionWalls(),Object.entries(this.bricks).forEach(([_,_e])=>_e.resize()),Object.entries(this.balloons).forEach(([_,_e])=>_e.resize())}}class Brick{constructor(_){Jn(this,"body");Jn(this,"box");Jn(this,"width");Jn(this,"height");Jn(this,"balloons",new Set);Jn(this,"charCount",0);this.box=_;const _e=_.getBoundingClientRect();this.width=this.box.offsetWidth,this.height=this.box.offsetHeight,this.charCount=_.innerText.split("").reduce((tt,nt)=>tt+(/\s/.test(nt)?0:1),0),this.body=Matter.Bodies.rectangle(_e.x+this.width/2,_e.y+this.height/2,this.width,this.height,{render:{visible:!1},collisionFilter:{category:MatterCategory.Default,mask:MatterCategory.Default}}),Matter.Body.setMass(this.body,brickMass*Math.log1p(this.charCount))}down(_){Matter.Body.applyForce(this.body,this.body.position,{x:0,y:brickDown*(1+vary*Math.sin(_/4e3))})}resize(){const _=this.box.offsetWidth,_e=this.box.offsetHeight;Matter.Body.scale(this.body,_/this.width,_e/this.height),this.width=_,this.height=_e,Matter.Body.setMass(this.body,brickMass*Math.log1p(this.charCount))}}class Balloon{constructor(_,_e,tt){Jn(this,"body");Jn(this,"constraint");Jn(this,"brick");Jn(this,"radius");Jn(this,"stringExtension");Jn(this,"anchor");this.brick=_,this.radius=_.height*ballonRadius,this.stringExtension=tt,this.body=Matter.Bodies.circle(_.body.position.x+Math.random()*2-1,_.body.position.y-_.height-this.radius*2*this.stringExtension,_.height*ballonRadius,{render:{fillStyle:_e,strokeStyle:_e},collisionFilter:{category:MatterCategory.Balloon,mask:MatterCategory.Balloon}}),Matter.Body.setMass(this.body,balloonMass),this.anchor={x:Math.random()-.5,y:0},this.constraint=Matter.Constraint.create({bodyA:_.body,bodyB:this.body,pointB:{x:0,y:this.radius},stiffness:stringStiffness,damping:1,length:_.height+this.radius*2*this.stringExtension,render:{lineWidth:1,type:"line",strokeStyle:_e}})}up(){Matter.Body.applyForce(this.body,this.body.position,{x:0,y:-balloonUp})}resize(){Matter.Body.scale(this.body,this.brick.height*ballonRadius/this.radius,this.brick.height*ballonRadius/this.radius),this.radius=this.brick.height*ballonRadius,Matter.Body.setMass(this.body,balloonMass),this.constraint.length=this.brick.height+this.radius*2*this.stringExtension,this.constraint.pointB={x:0,y:this.radius}}}const introLines=["im an extrovert but i dont","get invited to parties","so i made my own"],maxCount=8;function BrickField({show:et}){const _=reactExports.useRef(null),_e=reactExports.useRef([]),tt=useSpawn(),nt=rt=>{if(rt.key==="Enter"&&_.current&&_.current.value.trim().length!=0){rt.preventDefault();const it=_.current.value.trim();_.current.value="",tt(st=>(st&&st.length>=maxCount&&st.shift(),[...st,it]))}};return reactExports.useEffect(()=>{et&&animate(_e.current,{opacity:[{to:1,duration:0}],backgroundColor:[{to:"black"},{to:"transparent"}],duration:200,delay:stagger(80)})},[et]),jsxRuntimeExports.jsxs("div",{className:"w-full h-full absolute top-0 text-black pl-[2svw] pt-[8svh] flex flex-col justify-start items-start",children:[jsxRuntimeExports.jsx("div",{className:"text-heading z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-transparent text-transparent pointer-events-none w-fit h-fit relative",children:["1234567890",jsxRuntimeExports.jsx("input",{ref:_,className:`absolute top-0 left-0 border-none outline-none bg-transparent pointer-events-auto select-auto
          text-black w-full h-full text-heading`,placeholder:"type here",maxLength:10,onKeyDown:nt})]})}),introLines.map((rt,it)=>jsxRuntimeExports.jsx("div",{className:"flex text-text",children:rt.split("").map((st,ot)=>jsxRuntimeExports.jsx("span",{ref:at=>_e.current.push(at),style:{opacity:0,backgroundColor:"black"},children:st===" "?"":st},ot))},it))]})}const spikeCount=100;var spawnedBalloonCount=0;const randomBalloonCount=()=>5,randomTop=()=>randomFloat(0,10)+130+"%",randomLeft=()=>randomFloat(0,70)+10+"%";let instance$1,party,clickedId=-1,clickedPosition={x:0,y:0};const SpawnContext=reactExports.createContext(null),useSpawn=()=>reactExports.useContext(SpawnContext);function BalloonPage({containerRef:et,pageNumber:_}){const{active:_e,ready:tt}=usePage(),[nt,rt,it]=useState(!1),[st,ot]=useState(!1),at=reactExports.useRef(null),lt=reactExports.useRef(null),ct=reactExports.useRef(null),[ht,ut,ft]=useState(["pop","and","drag","the","balloons"]),[dt,pt,mt]=useState([]),vt=reactExports.useRef([]),yt=reactExports.useRef([]),[_t,St,bt]=useState(!1),Et=()=>{instance$1&&instance$1.resize(),party&&party.resize()};reactExports.useEffect(()=>{if(lt.current)return instance$1||(instance$1=new MatterInstance(lt.current,{category:MatterCategory.Balloon,mask:MatterCategory.Balloon,fast:!0})),party||(party=new Party(instance$1,ct.current)),party.spawnWalls(),Et(),window.addEventListener("resize",Et),Matter.Events.on(instance$1.engine,"beforeUpdate",wt=>{Object.entries(party.bricks).forEach(([Ct,Rt])=>{Rt.box.style.top=`${Rt.body.position.y-Rt.height/2}px`,Rt.box.style.left=`${Rt.body.position.x-Rt.width/2}px`,Rt.box.style.rotate=`${Rt.body.angle}rad`,Rt.down(wt.timestamp)}),Object.entries(party.balloons).forEach(([Ct,Rt])=>{Rt.up()})}),Matter.Events.on(instance$1.engine,"collisionStart",wt=>{const Ct=wt.pairs;for(let Rt=0;Rt<Ct.length;Rt++)Ct[Rt].bodyA.id===party.spikeId?party.despawnBalloon(Ct[Rt].bodyB.id):Ct[Rt].bodyB.id===party.spikeId&&party.despawnBalloon(Ct[Rt].bodyA.id)}),Matter.Events.on(instance$1.engine,"collisionActive",wt=>{const Ct=wt.pairs;for(let Rt=0;Rt<Ct.length;Rt++)Ct[Rt].bodyA.id===party.trampolineId?party.bounceBrick(Ct[Rt].bodyB.id):Ct[Rt].bodyB.id===party.trampolineId&&party.bounceBrick(Ct[Rt].bodyA.id)}),Matter.Events.on(instance$1.constraint,"mousedown",wt=>{instance$1.constraint.body?(clickedId=instance$1.constraint.body.id,clickedPosition={x:wt.mouse.position.x,y:wt.mouse.position.y}):clickedId=-1}),Matter.Events.on(instance$1.constraint,"mouseup",wt=>{clickedId!=-1&&Math.abs(wt.mouse.position.x-clickedPosition.x)<15&&Math.abs(wt.mouse.position.y-clickedPosition.y)<15&&party.despawnBalloon(clickedId)}),()=>{window.removeEventListener("resize",Et)}},[]),reactExports.useEffect(()=>{if(_e===_){if(!it.current){if(rt(!0),setTimeout(()=>{St(!0)},1e3),!ct.current)return;animate(ct.current.querySelectorAll("div"),{top:0,duration:1e3,delay:stagger(40)}),ot(!0)}}else et.current.classList.remove("show"),instance$1.stop()},[_e]),reactExports.useEffect(()=>{tt===_&&(et.current.classList.add("show"),instance$1.run())},[tt]),reactExports.useEffect(()=>{bt.current&&pt(wt=>{wt.length===ft.current.length&&(wt.shift(),vt.current.shift(),party.despawnBrick(yt.current[0].body.id),yt.current.shift());const Ct=[...wt];return ft.current.forEach((Rt,It)=>{It<Ct.length||Ct.push(jsxRuntimeExports.jsx("div",{className:"party-brick text-brick no-select",ref:Dt=>vt.current.push(Dt),style:{top:randomTop(),left:randomLeft()},children:Rt},spawnedBalloonCount++))}),Ct})},[_t,ht]),reactExports.useEffect(()=>{!party||vt.current.length<=0||(vt.current=vt.current.filter(wt=>wt!==null),mt.current.forEach((wt,Ct)=>{if(!wt||Ct<yt.current.length)return;const Rt=party.spawnBrick(vt.current[Ct]);yt.current.push(Rt),party.spawnBalloon(Rt,randomBalloonCount())}))},[dt]);const Mt=reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{ref:ct,className:"w-full h-fit absolute top-0 flex flex-nowrap overflow-hidden",children:Array.from({length:spikeCount},(wt,Ct)=>jsxRuntimeExports.jsx("div",{className:"triangle-down relative",style:{top:"-2rem"}},Ct))}),[]),Tt=reactExports.useMemo(()=>jsxRuntimeExports.jsx(BrickField,{show:nt}),[nt]);return jsxRuntimeExports.jsxs("div",{className:"w-full h-full",children:[jsxRuntimeExports.jsxs("div",{ref:at,className:"absolute top-0 w-full h-full z-10",children:[Mt,dt]}),jsxRuntimeExports.jsx(SpawnContext.Provider,{value:ut,children:st&&Tt}),jsxRuntimeExports.jsx("div",{ref:lt,className:"absolute top-0 w-full h-full pointer-events-auto"})]})}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="166",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,NeutralToneMapping=7,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBIntegerFormat=1032,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_,_e){this._listeners===void 0&&(this._listeners={});const tt=this._listeners;tt[_]===void 0&&(tt[_]=[]),tt[_].indexOf(_e)===-1&&tt[_].push(_e)}hasEventListener(_,_e){if(this._listeners===void 0)return!1;const tt=this._listeners;return tt[_]!==void 0&&tt[_].indexOf(_e)!==-1}removeEventListener(_,_e){if(this._listeners===void 0)return;const nt=this._listeners[_];if(nt!==void 0){const rt=nt.indexOf(_e);rt!==-1&&nt.splice(rt,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const tt=this._listeners[_.type];if(tt!==void 0){_.target=this;const nt=tt.slice(0);for(let rt=0,it=nt.length;rt<it;rt++)nt[rt].call(this,_);_.target=null}}}const _lut$1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID$1(){const et=Math.random()*4294967295|0,_=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,tt=Math.random()*4294967295|0;return(_lut$1[et&255]+_lut$1[et>>8&255]+_lut$1[et>>16&255]+_lut$1[et>>24&255]+"-"+_lut$1[_&255]+_lut$1[_>>8&255]+"-"+_lut$1[_>>16&15|64]+_lut$1[_>>24&255]+"-"+_lut$1[_e&63|128]+_lut$1[_e>>8&255]+"-"+_lut$1[_e>>16&255]+_lut$1[_e>>24&255]+_lut$1[tt&255]+_lut$1[tt>>8&255]+_lut$1[tt>>16&255]+_lut$1[tt>>24&255]).toLowerCase()}function clamp$1(et,_,_e){return Math.max(_,Math.min(_e,et))}function euclideanModulo(et,_){return(et%_+_)%_}function mapLinear(et,_,_e,tt,nt){return tt+(et-_)*(nt-tt)/(_e-_)}function inverseLerp(et,_,_e){return et!==_?(_e-et)/(_-et):0}function lerp(et,_,_e){return(1-_e)*et+_e*_}function damp(et,_,_e,tt){return lerp(et,_,1-Math.exp(-_e*tt))}function pingpong(et,_=1){return _-Math.abs(euclideanModulo(et,_*2)-_)}function smoothstep(et,_,_e){return et<=_?0:et>=_e?1:(et=(et-_)/(_e-_),et*et*(3-2*et))}function smootherstep(et,_,_e){return et<=_?0:et>=_e?1:(et=(et-_)/(_e-_),et*et*et*(et*(et*6-15)+10))}function randInt(et,_){return et+Math.floor(Math.random()*(_-et+1))}function randFloat(et,_){return et+Math.random()*(_-et)}function randFloatSpread(et){return et*(.5-Math.random())}function seededRandom(et){et!==void 0&&(_seed=et);let _=_seed+=1831565813;return _=Math.imul(_^_>>>15,_|1),_^=_+Math.imul(_^_>>>7,_|61),((_^_>>>14)>>>0)/4294967296}function degToRad(et){return et*DEG2RAD}function radToDeg(et){return et*RAD2DEG}function isPowerOfTwo(et){return(et&et-1)===0&&et!==0}function ceilPowerOfTwo(et){return Math.pow(2,Math.ceil(Math.log(et)/Math.LN2))}function floorPowerOfTwo(et){return Math.pow(2,Math.floor(Math.log(et)/Math.LN2))}function setQuaternionFromProperEuler(et,_,_e,tt,nt){const rt=Math.cos,it=Math.sin,st=rt(_e/2),ot=it(_e/2),at=rt((_+tt)/2),lt=it((_+tt)/2),ct=rt((_-tt)/2),ht=it((_-tt)/2),ut=rt((tt-_)/2),ft=it((tt-_)/2);switch(nt){case"XYX":et.set(st*lt,ot*ct,ot*ht,st*at);break;case"YZY":et.set(ot*ht,st*lt,ot*ct,st*at);break;case"ZXZ":et.set(ot*ct,ot*ht,st*lt,st*at);break;case"XZX":et.set(st*lt,ot*ft,ot*ut,st*at);break;case"YXY":et.set(ot*ut,st*lt,ot*ft,st*at);break;case"ZYZ":et.set(ot*ft,ot*ut,st*lt,st*at);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+nt)}}function denormalize(et,_){switch(_.constructor){case Float32Array:return et;case Uint32Array:return et/4294967295;case Uint16Array:return et/65535;case Uint8Array:return et/255;case Int32Array:return Math.max(et/2147483647,-1);case Int16Array:return Math.max(et/32767,-1);case Int8Array:return Math.max(et/127,-1);default:throw new Error("Invalid component type.")}}function normalize$1(et,_){switch(_.constructor){case Float32Array:return et;case Uint32Array:return Math.round(et*4294967295);case Uint16Array:return Math.round(et*65535);case Uint8Array:return Math.round(et*255);case Int32Array:return Math.round(et*2147483647);case Int16Array:return Math.round(et*32767);case Int8Array:return Math.round(et*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID:generateUUID$1,clamp:clamp$1,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize:normalize$1,denormalize};class Vector2{constructor(_=0,_e=0){Vector2.prototype.isVector2=!0,this.x=_,this.y=_e}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,_e){return this.x=_,this.y=_e,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,_e){switch(_){case 0:this.x=_e;break;case 1:this.y=_e;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,_e){return this.x=_.x+_e.x,this.y=_.y+_e.y,this}addScaledVector(_,_e){return this.x+=_.x*_e,this.y+=_.y*_e,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,_e){return this.x=_.x-_e.x,this.y=_.y-_e.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const _e=this.x,tt=this.y,nt=_.elements;return this.x=nt[0]*_e+nt[3]*tt+nt[6],this.y=nt[1]*_e+nt[4]*tt+nt[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,_e){return this.x=Math.max(_.x,Math.min(_e.x,this.x)),this.y=Math.max(_.y,Math.min(_e.y,this.y)),this}clampScalar(_,_e){return this.x=Math.max(_,Math.min(_e,this.x)),this.y=Math.max(_,Math.min(_e,this.y)),this}clampLength(_,_e){const tt=this.length();return this.divideScalar(tt||1).multiplyScalar(Math.max(_,Math.min(_e,tt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_){const _e=Math.sqrt(this.lengthSq()*_.lengthSq());if(_e===0)return Math.PI/2;const tt=this.dot(_)/_e;return Math.acos(clamp$1(tt,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const _e=this.x-_.x,tt=this.y-_.y;return _e*_e+tt*tt}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,_e){return this.x+=(_.x-this.x)*_e,this.y+=(_.y-this.y)*_e,this}lerpVectors(_,_e,tt){return this.x=_.x+(_e.x-_.x)*tt,this.y=_.y+(_e.y-_.y)*tt,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,_e=0){return this.x=_[_e],this.y=_[_e+1],this}toArray(_=[],_e=0){return _[_e]=this.x,_[_e+1]=this.y,_}fromBufferAttribute(_,_e){return this.x=_.getX(_e),this.y=_.getY(_e),this}rotateAround(_,_e){const tt=Math.cos(_e),nt=Math.sin(_e),rt=this.x-_.x,it=this.y-_.y;return this.x=rt*tt-it*nt+_.x,this.y=rt*nt+it*tt+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_,_e,tt,nt,rt,it,st,ot,at){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_!==void 0&&this.set(_,_e,tt,nt,rt,it,st,ot,at)}set(_,_e,tt,nt,rt,it,st,ot,at){const lt=this.elements;return lt[0]=_,lt[1]=nt,lt[2]=st,lt[3]=_e,lt[4]=rt,lt[5]=ot,lt[6]=tt,lt[7]=it,lt[8]=at,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const _e=this.elements,tt=_.elements;return _e[0]=tt[0],_e[1]=tt[1],_e[2]=tt[2],_e[3]=tt[3],_e[4]=tt[4],_e[5]=tt[5],_e[6]=tt[6],_e[7]=tt[7],_e[8]=tt[8],this}extractBasis(_,_e,tt){return _.setFromMatrix3Column(this,0),_e.setFromMatrix3Column(this,1),tt.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const _e=_.elements;return this.set(_e[0],_e[4],_e[8],_e[1],_e[5],_e[9],_e[2],_e[6],_e[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,_e){const tt=_.elements,nt=_e.elements,rt=this.elements,it=tt[0],st=tt[3],ot=tt[6],at=tt[1],lt=tt[4],ct=tt[7],ht=tt[2],ut=tt[5],ft=tt[8],dt=nt[0],pt=nt[3],mt=nt[6],vt=nt[1],yt=nt[4],_t=nt[7],St=nt[2],bt=nt[5],Et=nt[8];return rt[0]=it*dt+st*vt+ot*St,rt[3]=it*pt+st*yt+ot*bt,rt[6]=it*mt+st*_t+ot*Et,rt[1]=at*dt+lt*vt+ct*St,rt[4]=at*pt+lt*yt+ct*bt,rt[7]=at*mt+lt*_t+ct*Et,rt[2]=ht*dt+ut*vt+ft*St,rt[5]=ht*pt+ut*yt+ft*bt,rt[8]=ht*mt+ut*_t+ft*Et,this}multiplyScalar(_){const _e=this.elements;return _e[0]*=_,_e[3]*=_,_e[6]*=_,_e[1]*=_,_e[4]*=_,_e[7]*=_,_e[2]*=_,_e[5]*=_,_e[8]*=_,this}determinant(){const _=this.elements,_e=_[0],tt=_[1],nt=_[2],rt=_[3],it=_[4],st=_[5],ot=_[6],at=_[7],lt=_[8];return _e*it*lt-_e*st*at-tt*rt*lt+tt*st*ot+nt*rt*at-nt*it*ot}invert(){const _=this.elements,_e=_[0],tt=_[1],nt=_[2],rt=_[3],it=_[4],st=_[5],ot=_[6],at=_[7],lt=_[8],ct=lt*it-st*at,ht=st*ot-lt*rt,ut=at*rt-it*ot,ft=_e*ct+tt*ht+nt*ut;if(ft===0)return this.set(0,0,0,0,0,0,0,0,0);const dt=1/ft;return _[0]=ct*dt,_[1]=(nt*at-lt*tt)*dt,_[2]=(st*tt-nt*it)*dt,_[3]=ht*dt,_[4]=(lt*_e-nt*ot)*dt,_[5]=(nt*rt-st*_e)*dt,_[6]=ut*dt,_[7]=(tt*ot-at*_e)*dt,_[8]=(it*_e-tt*rt)*dt,this}transpose(){let _;const _e=this.elements;return _=_e[1],_e[1]=_e[3],_e[3]=_,_=_e[2],_e[2]=_e[6],_e[6]=_,_=_e[5],_e[5]=_e[7],_e[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const _e=this.elements;return _[0]=_e[0],_[1]=_e[3],_[2]=_e[6],_[3]=_e[1],_[4]=_e[4],_[5]=_e[7],_[6]=_e[2],_[7]=_e[5],_[8]=_e[8],this}setUvTransform(_,_e,tt,nt,rt,it,st){const ot=Math.cos(rt),at=Math.sin(rt);return this.set(tt*ot,tt*at,-tt*(ot*it+at*st)+it+_,-nt*at,nt*ot,-nt*(-at*it+ot*st)+st+_e,0,0,1),this}scale(_,_e){return this.premultiply(_m3.makeScale(_,_e)),this}rotate(_){return this.premultiply(_m3.makeRotation(-_)),this}translate(_,_e){return this.premultiply(_m3.makeTranslation(_,_e)),this}makeTranslation(_,_e){return _.isVector2?this.set(1,0,_.x,0,1,_.y,0,0,1):this.set(1,0,_,0,1,_e,0,0,1),this}makeRotation(_){const _e=Math.cos(_),tt=Math.sin(_);return this.set(_e,-tt,0,tt,_e,0,0,0,1),this}makeScale(_,_e){return this.set(_,0,0,0,_e,0,0,0,1),this}equals(_){const _e=this.elements,tt=_.elements;for(let nt=0;nt<9;nt++)if(_e[nt]!==tt[nt])return!1;return!0}fromArray(_,_e=0){for(let tt=0;tt<9;tt++)this.elements[tt]=_[tt+_e];return this}toArray(_=[],_e=0){const tt=this.elements;return _[_e]=tt[0],_[_e+1]=tt[1],_[_e+2]=tt[2],_[_e+3]=tt[3],_[_e+4]=tt[4],_[_e+5]=tt[5],_[_e+6]=tt[6],_[_e+7]=tt[7],_[_e+8]=tt[8],_}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(et){for(let _=et.length-1;_>=0;--_)if(et[_]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(et,_){return new TYPED_ARRAYS[et](_)}function createElementNS(et){return document.createElementNS("http://www.w3.org/1999/xhtml",et)}function createCanvasElement(){const et=createElementNS("canvas");return et.style.display="block",et}const _cache={};function warnOnce(et){et in _cache||(_cache[et]=!0,console.warn(et))}function probeAsync(et,_,_e){return new Promise(function(tt,nt){function rt(){switch(et.clientWaitSync(_,et.SYNC_FLUSH_COMMANDS_BIT,0)){case et.WAIT_FAILED:nt();break;case et.TIMEOUT_EXPIRED:setTimeout(rt,_e);break;default:tt()}}setTimeout(rt,_e)})}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,toReference:et=>et,fromReference:et=>et},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,toReference:et=>et.convertSRGBToLinear(),fromReference:et=>et.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,toReference:et=>et.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:et=>et.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,toReference:et=>et.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:et=>et.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(et){if(!SUPPORTED_WORKING_COLOR_SPACES.has(et))throw new Error(`Unsupported working color space, "${et}".`);this._workingColorSpace=et},convert:function(et,_,_e){if(this.enabled===!1||_===_e||!_||!_e)return et;const tt=COLOR_SPACES[_].toReference,nt=COLOR_SPACES[_e].fromReference;return nt(tt(et))},fromWorkingColorSpace:function(et,_){return this.convert(et,this._workingColorSpace,_)},toWorkingColorSpace:function(et,_){return this.convert(et,_,this._workingColorSpace)},getPrimaries:function(et){return COLOR_SPACES[et].primaries},getTransfer:function(et){return et===NoColorSpace?LinearTransfer:COLOR_SPACES[et].transfer}};function SRGBToLinear(et){return et<.04045?et*.0773993808:Math.pow(et*.9478672986+.0521327014,2.4)}function LinearToSRGB(et){return et<.0031308?et*12.92:1.055*Math.pow(et,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(_){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let _e;if(_ instanceof HTMLCanvasElement)_e=_;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_.width,_canvas.height=_.height;const tt=_canvas.getContext("2d");_ instanceof ImageData?tt.putImageData(_,0,0):tt.drawImage(_,0,0,_.width,_.height),_e=_canvas}return _e.width>2048||_e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_),_e.toDataURL("image/jpeg",.6)):_e.toDataURL("image/png")}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const _e=createElementNS("canvas");_e.width=_.width,_e.height=_.height;const tt=_e.getContext("2d");tt.drawImage(_,0,0,_.width,_.height);const nt=tt.getImageData(0,0,_.width,_.height),rt=nt.data;for(let it=0;it<rt.length;it++)rt[it]=SRGBToLinear(rt[it]/255)*255;return tt.putImageData(nt,0,0),_e}else if(_.data){const _e=_.data.slice(0);for(let tt=0;tt<_e.length;tt++)_e instanceof Uint8Array||_e instanceof Uint8ClampedArray?_e[tt]=Math.floor(SRGBToLinear(_e[tt]/255)*255):_e[tt]=SRGBToLinear(_e[tt]);return{data:_e,width:_.width,height:_.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}}let _sourceId=0;class Source{constructor(_=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID$1(),this.data=_,this.dataReady=!0,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const _e=_===void 0||typeof _=="string";if(!_e&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const tt={uuid:this.uuid,url:""},nt=this.data;if(nt!==null){let rt;if(Array.isArray(nt)){rt=[];for(let it=0,st=nt.length;it<st;it++)nt[it].isDataTexture?rt.push(serializeImage(nt[it].image)):rt.push(serializeImage(nt[it]))}else rt=serializeImage(nt);tt.url=rt}return _e||(_.images[this.uuid]=tt),tt}}function serializeImage(et){return typeof HTMLImageElement<"u"&&et instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&et instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&et instanceof ImageBitmap?ImageUtils.getDataURL(et):et.data?{data:Array.from(et.data),width:et.width,height:et.height,type:et.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0,Texture$1=class Bu extends EventDispatcher{constructor(_=Bu.DEFAULT_IMAGE,_e=Bu.DEFAULT_MAPPING,tt=ClampToEdgeWrapping,nt=ClampToEdgeWrapping,rt=LinearFilter,it=LinearMipmapLinearFilter,st=RGBAFormat,ot=UnsignedByteType,at=Bu.DEFAULT_ANISOTROPY,lt=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID$1(),this.name="",this.source=new Source(_),this.mipmaps=[],this.mapping=_e,this.channel=0,this.wrapS=tt,this.wrapT=nt,this.magFilter=rt,this.minFilter=it,this.anisotropy=at,this.format=st,this.internalFormat=null,this.type=ot,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=lt,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_=null){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.channel=_.channel,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.colorSpace=_.colorSpace,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const _e=_===void 0||typeof _=="string";if(!_e&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const tt={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(tt.userData=this.userData),_e||(_.textures[this.uuid]=tt),tt}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==UVMapping)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case RepeatWrapping:_.x=_.x-Math.floor(_.x);break;case ClampToEdgeWrapping:_.x=_.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x);break}if(_.y<0||_.y>1)switch(this.wrapT){case RepeatWrapping:_.y=_.y-Math.floor(_.y);break;case ClampToEdgeWrapping:_.y=_.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y);break}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_){_===!0&&this.pmremVersion++}};Texture$1.DEFAULT_IMAGE=null;Texture$1.DEFAULT_MAPPING=UVMapping;Texture$1.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_=0,_e=0,tt=0,nt=1){Vector4.prototype.isVector4=!0,this.x=_,this.y=_e,this.z=tt,this.w=nt}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,_e,tt,nt){return this.x=_,this.y=_e,this.z=tt,this.w=nt,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,_e){switch(_){case 0:this.x=_e;break;case 1:this.y=_e;break;case 2:this.z=_e;break;case 3:this.w=_e;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,_e){return this.x=_.x+_e.x,this.y=_.y+_e.y,this.z=_.z+_e.z,this.w=_.w+_e.w,this}addScaledVector(_,_e){return this.x+=_.x*_e,this.y+=_.y*_e,this.z+=_.z*_e,this.w+=_.w*_e,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,_e){return this.x=_.x-_e.x,this.y=_.y-_e.y,this.z=_.z-_e.z,this.w=_.w-_e.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const _e=this.x,tt=this.y,nt=this.z,rt=this.w,it=_.elements;return this.x=it[0]*_e+it[4]*tt+it[8]*nt+it[12]*rt,this.y=it[1]*_e+it[5]*tt+it[9]*nt+it[13]*rt,this.z=it[2]*_e+it[6]*tt+it[10]*nt+it[14]*rt,this.w=it[3]*_e+it[7]*tt+it[11]*nt+it[15]*rt,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const _e=Math.sqrt(1-_.w*_.w);return _e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/_e,this.y=_.y/_e,this.z=_.z/_e),this}setAxisAngleFromRotationMatrix(_){let _e,tt,nt,rt;const ot=_.elements,at=ot[0],lt=ot[4],ct=ot[8],ht=ot[1],ut=ot[5],ft=ot[9],dt=ot[2],pt=ot[6],mt=ot[10];if(Math.abs(lt-ht)<.01&&Math.abs(ct-dt)<.01&&Math.abs(ft-pt)<.01){if(Math.abs(lt+ht)<.1&&Math.abs(ct+dt)<.1&&Math.abs(ft+pt)<.1&&Math.abs(at+ut+mt-3)<.1)return this.set(1,0,0,0),this;_e=Math.PI;const yt=(at+1)/2,_t=(ut+1)/2,St=(mt+1)/2,bt=(lt+ht)/4,Et=(ct+dt)/4,Mt=(ft+pt)/4;return yt>_t&&yt>St?yt<.01?(tt=0,nt=.707106781,rt=.707106781):(tt=Math.sqrt(yt),nt=bt/tt,rt=Et/tt):_t>St?_t<.01?(tt=.707106781,nt=0,rt=.707106781):(nt=Math.sqrt(_t),tt=bt/nt,rt=Mt/nt):St<.01?(tt=.707106781,nt=.707106781,rt=0):(rt=Math.sqrt(St),tt=Et/rt,nt=Mt/rt),this.set(tt,nt,rt,_e),this}let vt=Math.sqrt((pt-ft)*(pt-ft)+(ct-dt)*(ct-dt)+(ht-lt)*(ht-lt));return Math.abs(vt)<.001&&(vt=1),this.x=(pt-ft)/vt,this.y=(ct-dt)/vt,this.z=(ht-lt)/vt,this.w=Math.acos((at+ut+mt-1)/2),this}setFromMatrixPosition(_){const _e=_.elements;return this.x=_e[12],this.y=_e[13],this.z=_e[14],this.w=_e[15],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,_e){return this.x=Math.max(_.x,Math.min(_e.x,this.x)),this.y=Math.max(_.y,Math.min(_e.y,this.y)),this.z=Math.max(_.z,Math.min(_e.z,this.z)),this.w=Math.max(_.w,Math.min(_e.w,this.w)),this}clampScalar(_,_e){return this.x=Math.max(_,Math.min(_e,this.x)),this.y=Math.max(_,Math.min(_e,this.y)),this.z=Math.max(_,Math.min(_e,this.z)),this.w=Math.max(_,Math.min(_e,this.w)),this}clampLength(_,_e){const tt=this.length();return this.divideScalar(tt||1).multiplyScalar(Math.max(_,Math.min(_e,tt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,_e){return this.x+=(_.x-this.x)*_e,this.y+=(_.y-this.y)*_e,this.z+=(_.z-this.z)*_e,this.w+=(_.w-this.w)*_e,this}lerpVectors(_,_e,tt){return this.x=_.x+(_e.x-_.x)*tt,this.y=_.y+(_e.y-_.y)*tt,this.z=_.z+(_e.z-_.z)*tt,this.w=_.w+(_e.w-_.w)*tt,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,_e=0){return this.x=_[_e],this.y=_[_e+1],this.z=_[_e+2],this.w=_[_e+3],this}toArray(_=[],_e=0){return _[_e]=this.x,_[_e+1]=this.y,_[_e+2]=this.z,_[_e+3]=this.w,_}fromBufferAttribute(_,_e){return this.x=_.getX(_e),this.y=_.getY(_e),this.z=_.getZ(_e),this.w=_.getW(_e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher{constructor(_=1,_e=1,tt={}){super(),this.isRenderTarget=!0,this.width=_,this.height=_e,this.depth=1,this.scissor=new Vector4(0,0,_,_e),this.scissorTest=!1,this.viewport=new Vector4(0,0,_,_e);const nt={width:_,height:_e,depth:1};tt=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},tt);const rt=new Texture$1(nt,tt.mapping,tt.wrapS,tt.wrapT,tt.magFilter,tt.minFilter,tt.format,tt.type,tt.anisotropy,tt.colorSpace);rt.flipY=!1,rt.generateMipmaps=tt.generateMipmaps,rt.internalFormat=tt.internalFormat,this.textures=[];const it=tt.count;for(let st=0;st<it;st++)this.textures[st]=rt.clone(),this.textures[st].isRenderTargetTexture=!0;this.depthBuffer=tt.depthBuffer,this.stencilBuffer=tt.stencilBuffer,this.resolveDepthBuffer=tt.resolveDepthBuffer,this.resolveStencilBuffer=tt.resolveStencilBuffer,this.depthTexture=tt.depthTexture,this.samples=tt.samples}get texture(){return this.textures[0]}set texture(_){this.textures[0]=_}setSize(_,_e,tt=1){if(this.width!==_||this.height!==_e||this.depth!==tt){this.width=_,this.height=_e,this.depth=tt;for(let nt=0,rt=this.textures.length;nt<rt;nt++)this.textures[nt].image.width=_,this.textures[nt].image.height=_e,this.textures[nt].image.depth=tt;this.dispose()}this.viewport.set(0,0,_,_e),this.scissor.set(0,0,_,_e)}clone(){return new this.constructor().copy(this)}copy(_){this.width=_.width,this.height=_.height,this.depth=_.depth,this.scissor.copy(_.scissor),this.scissorTest=_.scissorTest,this.viewport.copy(_.viewport),this.textures.length=0;for(let tt=0,nt=_.textures.length;tt<nt;tt++)this.textures[tt]=_.textures[tt].clone(),this.textures[tt].isRenderTargetTexture=!0;const _e=Object.assign({},_.texture.image);return this.texture.source=new Source(_e),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,this.resolveDepthBuffer=_.resolveDepthBuffer,this.resolveStencilBuffer=_.resolveStencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.samples=_.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(_=1,_e=1,tt={}){super(_,_e,tt),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture$1{constructor(_=null,_e=1,tt=1,nt=1){super(null),this.isDataArrayTexture=!0,this.image={data:_,width:_e,height:tt,depth:nt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(_){this.layerUpdates.add(_)}clearLayerUpdates(){this.layerUpdates.clear()}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_=1,_e=1,tt=1,nt={}){super(_,_e,nt),this.isWebGLArrayRenderTarget=!0,this.depth=tt,this.texture=new DataArrayTexture(null,_,_e,tt),this.texture.isRenderTargetTexture=!0}}class Data3DTexture extends Texture$1{constructor(_=null,_e=1,tt=1,nt=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:_e,height:tt,depth:nt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_=1,_e=1,tt=1,nt={}){super(_,_e,nt),this.isWebGL3DRenderTarget=!0,this.depth=tt,this.texture=new Data3DTexture(null,_,_e,tt),this.texture.isRenderTargetTexture=!0}}class Quaternion{constructor(_=0,_e=0,tt=0,nt=1){this.isQuaternion=!0,this._x=_,this._y=_e,this._z=tt,this._w=nt}static slerpFlat(_,_e,tt,nt,rt,it,st){let ot=tt[nt+0],at=tt[nt+1],lt=tt[nt+2],ct=tt[nt+3];const ht=rt[it+0],ut=rt[it+1],ft=rt[it+2],dt=rt[it+3];if(st===0){_[_e+0]=ot,_[_e+1]=at,_[_e+2]=lt,_[_e+3]=ct;return}if(st===1){_[_e+0]=ht,_[_e+1]=ut,_[_e+2]=ft,_[_e+3]=dt;return}if(ct!==dt||ot!==ht||at!==ut||lt!==ft){let pt=1-st;const mt=ot*ht+at*ut+lt*ft+ct*dt,vt=mt>=0?1:-1,yt=1-mt*mt;if(yt>Number.EPSILON){const St=Math.sqrt(yt),bt=Math.atan2(St,mt*vt);pt=Math.sin(pt*bt)/St,st=Math.sin(st*bt)/St}const _t=st*vt;if(ot=ot*pt+ht*_t,at=at*pt+ut*_t,lt=lt*pt+ft*_t,ct=ct*pt+dt*_t,pt===1-st){const St=1/Math.sqrt(ot*ot+at*at+lt*lt+ct*ct);ot*=St,at*=St,lt*=St,ct*=St}}_[_e]=ot,_[_e+1]=at,_[_e+2]=lt,_[_e+3]=ct}static multiplyQuaternionsFlat(_,_e,tt,nt,rt,it){const st=tt[nt],ot=tt[nt+1],at=tt[nt+2],lt=tt[nt+3],ct=rt[it],ht=rt[it+1],ut=rt[it+2],ft=rt[it+3];return _[_e]=st*ft+lt*ct+ot*ut-at*ht,_[_e+1]=ot*ft+lt*ht+at*ct-st*ut,_[_e+2]=at*ft+lt*ut+st*ht-ot*ct,_[_e+3]=lt*ft-st*ct-ot*ht-at*ut,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,_e,tt,nt){return this._x=_,this._y=_e,this._z=tt,this._w=nt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,_e=!0){const tt=_._x,nt=_._y,rt=_._z,it=_._order,st=Math.cos,ot=Math.sin,at=st(tt/2),lt=st(nt/2),ct=st(rt/2),ht=ot(tt/2),ut=ot(nt/2),ft=ot(rt/2);switch(it){case"XYZ":this._x=ht*lt*ct+at*ut*ft,this._y=at*ut*ct-ht*lt*ft,this._z=at*lt*ft+ht*ut*ct,this._w=at*lt*ct-ht*ut*ft;break;case"YXZ":this._x=ht*lt*ct+at*ut*ft,this._y=at*ut*ct-ht*lt*ft,this._z=at*lt*ft-ht*ut*ct,this._w=at*lt*ct+ht*ut*ft;break;case"ZXY":this._x=ht*lt*ct-at*ut*ft,this._y=at*ut*ct+ht*lt*ft,this._z=at*lt*ft+ht*ut*ct,this._w=at*lt*ct-ht*ut*ft;break;case"ZYX":this._x=ht*lt*ct-at*ut*ft,this._y=at*ut*ct+ht*lt*ft,this._z=at*lt*ft-ht*ut*ct,this._w=at*lt*ct+ht*ut*ft;break;case"YZX":this._x=ht*lt*ct+at*ut*ft,this._y=at*ut*ct+ht*lt*ft,this._z=at*lt*ft-ht*ut*ct,this._w=at*lt*ct-ht*ut*ft;break;case"XZY":this._x=ht*lt*ct-at*ut*ft,this._y=at*ut*ct-ht*lt*ft,this._z=at*lt*ft+ht*ut*ct,this._w=at*lt*ct+ht*ut*ft;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+it)}return _e===!0&&this._onChangeCallback(),this}setFromAxisAngle(_,_e){const tt=_e/2,nt=Math.sin(tt);return this._x=_.x*nt,this._y=_.y*nt,this._z=_.z*nt,this._w=Math.cos(tt),this._onChangeCallback(),this}setFromRotationMatrix(_){const _e=_.elements,tt=_e[0],nt=_e[4],rt=_e[8],it=_e[1],st=_e[5],ot=_e[9],at=_e[2],lt=_e[6],ct=_e[10],ht=tt+st+ct;if(ht>0){const ut=.5/Math.sqrt(ht+1);this._w=.25/ut,this._x=(lt-ot)*ut,this._y=(rt-at)*ut,this._z=(it-nt)*ut}else if(tt>st&&tt>ct){const ut=2*Math.sqrt(1+tt-st-ct);this._w=(lt-ot)/ut,this._x=.25*ut,this._y=(nt+it)/ut,this._z=(rt+at)/ut}else if(st>ct){const ut=2*Math.sqrt(1+st-tt-ct);this._w=(rt-at)/ut,this._x=(nt+it)/ut,this._y=.25*ut,this._z=(ot+lt)/ut}else{const ut=2*Math.sqrt(1+ct-tt-st);this._w=(it-nt)/ut,this._x=(rt+at)/ut,this._y=(ot+lt)/ut,this._z=.25*ut}return this._onChangeCallback(),this}setFromUnitVectors(_,_e){let tt=_.dot(_e)+1;return tt<Number.EPSILON?(tt=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=tt):(this._x=0,this._y=-_.z,this._z=_.y,this._w=tt)):(this._x=_.y*_e.z-_.z*_e.y,this._y=_.z*_e.x-_.x*_e.z,this._z=_.x*_e.y-_.y*_e.x,this._w=tt),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(clamp$1(this.dot(_),-1,1)))}rotateTowards(_,_e){const tt=this.angleTo(_);if(tt===0)return this;const nt=Math.min(1,_e/tt);return this.slerp(_,nt),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,_e){const tt=_._x,nt=_._y,rt=_._z,it=_._w,st=_e._x,ot=_e._y,at=_e._z,lt=_e._w;return this._x=tt*lt+it*st+nt*at-rt*ot,this._y=nt*lt+it*ot+rt*st-tt*at,this._z=rt*lt+it*at+tt*ot-nt*st,this._w=it*lt-tt*st-nt*ot-rt*at,this._onChangeCallback(),this}slerp(_,_e){if(_e===0)return this;if(_e===1)return this.copy(_);const tt=this._x,nt=this._y,rt=this._z,it=this._w;let st=it*_._w+tt*_._x+nt*_._y+rt*_._z;if(st<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,st=-st):this.copy(_),st>=1)return this._w=it,this._x=tt,this._y=nt,this._z=rt,this;const ot=1-st*st;if(ot<=Number.EPSILON){const ut=1-_e;return this._w=ut*it+_e*this._w,this._x=ut*tt+_e*this._x,this._y=ut*nt+_e*this._y,this._z=ut*rt+_e*this._z,this.normalize(),this}const at=Math.sqrt(ot),lt=Math.atan2(at,st),ct=Math.sin((1-_e)*lt)/at,ht=Math.sin(_e*lt)/at;return this._w=it*ct+this._w*ht,this._x=tt*ct+this._x*ht,this._y=nt*ct+this._y*ht,this._z=rt*ct+this._z*ht,this._onChangeCallback(),this}slerpQuaternions(_,_e,tt){return this.copy(_).slerp(_e,tt)}random(){const _=2*Math.PI*Math.random(),_e=2*Math.PI*Math.random(),tt=Math.random(),nt=Math.sqrt(1-tt),rt=Math.sqrt(tt);return this.set(nt*Math.sin(_),nt*Math.cos(_),rt*Math.sin(_e),rt*Math.cos(_e))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,_e=0){return this._x=_[_e],this._y=_[_e+1],this._z=_[_e+2],this._w=_[_e+3],this._onChangeCallback(),this}toArray(_=[],_e=0){return _[_e]=this._x,_[_e+1]=this._y,_[_e+2]=this._z,_[_e+3]=this._w,_}fromBufferAttribute(_,_e){return this._x=_.getX(_e),this._y=_.getY(_e),this._z=_.getZ(_e),this._w=_.getW(_e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_=0,_e=0,tt=0){Vector3.prototype.isVector3=!0,this.x=_,this.y=_e,this.z=tt}set(_,_e,tt){return tt===void 0&&(tt=this.z),this.x=_,this.y=_e,this.z=tt,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,_e){switch(_){case 0:this.x=_e;break;case 1:this.y=_e;break;case 2:this.z=_e;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,_e){return this.x=_.x+_e.x,this.y=_.y+_e.y,this.z=_.z+_e.z,this}addScaledVector(_,_e){return this.x+=_.x*_e,this.y+=_.y*_e,this.z+=_.z*_e,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,_e){return this.x=_.x-_e.x,this.y=_.y-_e.y,this.z=_.z-_e.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,_e){return this.x=_.x*_e.x,this.y=_.y*_e.y,this.z=_.z*_e.z,this}applyEuler(_){return this.applyQuaternion(_quaternion$4.setFromEuler(_))}applyAxisAngle(_,_e){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_,_e))}applyMatrix3(_){const _e=this.x,tt=this.y,nt=this.z,rt=_.elements;return this.x=rt[0]*_e+rt[3]*tt+rt[6]*nt,this.y=rt[1]*_e+rt[4]*tt+rt[7]*nt,this.z=rt[2]*_e+rt[5]*tt+rt[8]*nt,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const _e=this.x,tt=this.y,nt=this.z,rt=_.elements,it=1/(rt[3]*_e+rt[7]*tt+rt[11]*nt+rt[15]);return this.x=(rt[0]*_e+rt[4]*tt+rt[8]*nt+rt[12])*it,this.y=(rt[1]*_e+rt[5]*tt+rt[9]*nt+rt[13])*it,this.z=(rt[2]*_e+rt[6]*tt+rt[10]*nt+rt[14])*it,this}applyQuaternion(_){const _e=this.x,tt=this.y,nt=this.z,rt=_.x,it=_.y,st=_.z,ot=_.w,at=2*(it*nt-st*tt),lt=2*(st*_e-rt*nt),ct=2*(rt*tt-it*_e);return this.x=_e+ot*at+it*ct-st*lt,this.y=tt+ot*lt+st*at-rt*ct,this.z=nt+ot*ct+rt*lt-it*at,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const _e=this.x,tt=this.y,nt=this.z,rt=_.elements;return this.x=rt[0]*_e+rt[4]*tt+rt[8]*nt,this.y=rt[1]*_e+rt[5]*tt+rt[9]*nt,this.z=rt[2]*_e+rt[6]*tt+rt[10]*nt,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,_e){return this.x=Math.max(_.x,Math.min(_e.x,this.x)),this.y=Math.max(_.y,Math.min(_e.y,this.y)),this.z=Math.max(_.z,Math.min(_e.z,this.z)),this}clampScalar(_,_e){return this.x=Math.max(_,Math.min(_e,this.x)),this.y=Math.max(_,Math.min(_e,this.y)),this.z=Math.max(_,Math.min(_e,this.z)),this}clampLength(_,_e){const tt=this.length();return this.divideScalar(tt||1).multiplyScalar(Math.max(_,Math.min(_e,tt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,_e){return this.x+=(_.x-this.x)*_e,this.y+=(_.y-this.y)*_e,this.z+=(_.z-this.z)*_e,this}lerpVectors(_,_e,tt){return this.x=_.x+(_e.x-_.x)*tt,this.y=_.y+(_e.y-_.y)*tt,this.z=_.z+(_e.z-_.z)*tt,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,_e){const tt=_.x,nt=_.y,rt=_.z,it=_e.x,st=_e.y,ot=_e.z;return this.x=nt*ot-rt*st,this.y=rt*it-tt*ot,this.z=tt*st-nt*it,this}projectOnVector(_){const _e=_.lengthSq();if(_e===0)return this.set(0,0,0);const tt=_.dot(this)/_e;return this.copy(_).multiplyScalar(tt)}projectOnPlane(_){return _vector$c.copy(this).projectOnVector(_),this.sub(_vector$c)}reflect(_){return this.sub(_vector$c.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const _e=Math.sqrt(this.lengthSq()*_.lengthSq());if(_e===0)return Math.PI/2;const tt=this.dot(_)/_e;return Math.acos(clamp$1(tt,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const _e=this.x-_.x,tt=this.y-_.y,nt=this.z-_.z;return _e*_e+tt*tt+nt*nt}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,_e,tt){const nt=Math.sin(_e)*_;return this.x=nt*Math.sin(tt),this.y=Math.cos(_e)*_,this.z=nt*Math.cos(tt),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,_e,tt){return this.x=_*Math.sin(_e),this.y=tt,this.z=_*Math.cos(_e),this}setFromMatrixPosition(_){const _e=_.elements;return this.x=_e[12],this.y=_e[13],this.z=_e[14],this}setFromMatrixScale(_){const _e=this.setFromMatrixColumn(_,0).length(),tt=this.setFromMatrixColumn(_,1).length(),nt=this.setFromMatrixColumn(_,2).length();return this.x=_e,this.y=tt,this.z=nt,this}setFromMatrixColumn(_,_e){return this.fromArray(_.elements,_e*4)}setFromMatrix3Column(_,_e){return this.fromArray(_.elements,_e*3)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}setFromColor(_){return this.x=_.r,this.y=_.g,this.z=_.b,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,_e=0){return this.x=_[_e],this.y=_[_e+1],this.z=_[_e+2],this}toArray(_=[],_e=0){return _[_e]=this.x,_[_e+1]=this.y,_[_e+2]=this.z,_}fromBufferAttribute(_,_e){return this.x=_.getX(_e),this.y=_.getY(_e),this.z=_.getZ(_e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=Math.random()*Math.PI*2,_e=Math.random()*2-1,tt=Math.sqrt(1-_e*_e);return this.x=tt*Math.cos(_),this.y=_e,this.z=tt*Math.sin(_),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_=new Vector3(1/0,1/0,1/0),_e=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=_e}set(_,_e){return this.min.copy(_),this.max.copy(_e),this}setFromArray(_){this.makeEmpty();for(let _e=0,tt=_.length;_e<tt;_e+=3)this.expandByPoint(_vector$b.fromArray(_,_e));return this}setFromBufferAttribute(_){this.makeEmpty();for(let _e=0,tt=_.count;_e<tt;_e++)this.expandByPoint(_vector$b.fromBufferAttribute(_,_e));return this}setFromPoints(_){this.makeEmpty();for(let _e=0,tt=_.length;_e<tt;_e++)this.expandByPoint(_[_e]);return this}setFromCenterAndSize(_,_e){const tt=_vector$b.copy(_e).multiplyScalar(.5);return this.min.copy(_).sub(tt),this.max.copy(_).add(tt),this}setFromObject(_,_e=!1){return this.makeEmpty(),this.expandByObject(_,_e)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,_e=!1){_.updateWorldMatrix(!1,!1);const tt=_.geometry;if(tt!==void 0){const rt=tt.getAttribute("position");if(_e===!0&&rt!==void 0&&_.isInstancedMesh!==!0)for(let it=0,st=rt.count;it<st;it++)_.isMesh===!0?_.getVertexPosition(it,_vector$b):_vector$b.fromBufferAttribute(rt,it),_vector$b.applyMatrix4(_.matrixWorld),this.expandByPoint(_vector$b);else _.boundingBox!==void 0?(_.boundingBox===null&&_.computeBoundingBox(),_box$4.copy(_.boundingBox)):(tt.boundingBox===null&&tt.computeBoundingBox(),_box$4.copy(tt.boundingBox)),_box$4.applyMatrix4(_.matrixWorld),this.union(_box$4)}const nt=_.children;for(let rt=0,it=nt.length;rt<it;rt++)this.expandByObject(nt[rt],_e);return this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y||_.z<this.min.z||_.z>this.max.z)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,_e){return _e.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y||_.max.z<this.min.z||_.min.z>this.max.z)}intersectsSphere(_){return this.clampPoint(_.center,_vector$b),_vector$b.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let _e,tt;return _.normal.x>0?(_e=_.normal.x*this.min.x,tt=_.normal.x*this.max.x):(_e=_.normal.x*this.max.x,tt=_.normal.x*this.min.x),_.normal.y>0?(_e+=_.normal.y*this.min.y,tt+=_.normal.y*this.max.y):(_e+=_.normal.y*this.max.y,tt+=_.normal.y*this.min.y),_.normal.z>0?(_e+=_.normal.z*this.min.z,tt+=_.normal.z*this.max.z):(_e+=_.normal.z*this.max.z,tt+=_.normal.z*this.min.z),_e<=-_.constant&&tt>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_.a,_center),_v1$7.subVectors(_.b,_center),_v2$4.subVectors(_.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let _e=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(_e,_v0$2,_v1$7,_v2$4,_extents)||(_e=[1,0,0,0,1,0,0,0,1],!satForAxes(_e,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),_e=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(_e,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_,_e){return _e.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$b).distanceTo(_)}getBoundingSphere(_){return this.isEmpty()?_.makeEmpty():(this.getCenter(_.center),_.radius=this.getSize(_vector$b).length()*.5),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(_points),this)}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(et,_,_e,tt,nt){for(let rt=0,it=et.length-3;rt<=it;rt+=3){_testAxis.fromArray(et,rt);const st=nt.x*Math.abs(_testAxis.x)+nt.y*Math.abs(_testAxis.y)+nt.z*Math.abs(_testAxis.z),ot=_.dot(_testAxis),at=_e.dot(_testAxis),lt=tt.dot(_testAxis);if(Math.max(-Math.max(ot,at,lt),Math.min(ot,at,lt))>st)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_=new Vector3,_e=-1){this.isSphere=!0,this.center=_,this.radius=_e}set(_,_e){return this.center.copy(_),this.radius=_e,this}setFromPoints(_,_e){const tt=this.center;_e!==void 0?tt.copy(_e):_box$3.setFromPoints(_).getCenter(tt);let nt=0;for(let rt=0,it=_.length;rt<it;rt++)nt=Math.max(nt,tt.distanceToSquared(_[rt]));return this.radius=Math.sqrt(nt),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const _e=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=_e*_e}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,_e){const tt=this.center.distanceToSquared(_);return _e.copy(_),tt>this.radius*this.radius&&(_e.sub(this.center).normalize(),_e.multiplyScalar(this.radius).add(this.center)),_e}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){if(this.isEmpty())return this.center.copy(_),this.radius=0,this;_v1$6.subVectors(_,this.center);const _e=_v1$6.lengthSq();if(_e>this.radius*this.radius){const tt=Math.sqrt(_e),nt=(tt-this.radius)*.5;this.center.addScaledVector(_v1$6,nt/tt),this.radius+=nt}return this}union(_){return _.isEmpty()?this:this.isEmpty()?(this.copy(_),this):(this.center.equals(_.center)===!0?this.radius=Math.max(this.radius,_.radius):(_v2$3.subVectors(_.center,this.center).setLength(_.radius),this.expandByPoint(_v1$6.copy(_.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_.center).sub(_v2$3))),this)}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(_=new Vector3,_e=new Vector3(0,0,-1)){this.origin=_,this.direction=_e}set(_,_e){return this.origin.copy(_),this.direction.copy(_e),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,_e){return _e.copy(this.origin).addScaledVector(this.direction,_)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,_vector$a)),this}closestPointToPoint(_,_e){_e.subVectors(_,this.origin);const tt=_e.dot(this.direction);return tt<0?_e.copy(this.origin):_e.copy(this.origin).addScaledVector(this.direction,tt)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const _e=_vector$a.subVectors(_,this.origin).dot(this.direction);return _e<0?this.origin.distanceToSquared(_):(_vector$a.copy(this.origin).addScaledVector(this.direction,_e),_vector$a.distanceToSquared(_))}distanceSqToSegment(_,_e,tt,nt){_segCenter.copy(_).add(_e).multiplyScalar(.5),_segDir.copy(_e).sub(_).normalize(),_diff.copy(this.origin).sub(_segCenter);const rt=_.distanceTo(_e)*.5,it=-this.direction.dot(_segDir),st=_diff.dot(this.direction),ot=-_diff.dot(_segDir),at=_diff.lengthSq(),lt=Math.abs(1-it*it);let ct,ht,ut,ft;if(lt>0)if(ct=it*ot-st,ht=it*st-ot,ft=rt*lt,ct>=0)if(ht>=-ft)if(ht<=ft){const dt=1/lt;ct*=dt,ht*=dt,ut=ct*(ct+it*ht+2*st)+ht*(it*ct+ht+2*ot)+at}else ht=rt,ct=Math.max(0,-(it*ht+st)),ut=-ct*ct+ht*(ht+2*ot)+at;else ht=-rt,ct=Math.max(0,-(it*ht+st)),ut=-ct*ct+ht*(ht+2*ot)+at;else ht<=-ft?(ct=Math.max(0,-(-it*rt+st)),ht=ct>0?-rt:Math.min(Math.max(-rt,-ot),rt),ut=-ct*ct+ht*(ht+2*ot)+at):ht<=ft?(ct=0,ht=Math.min(Math.max(-rt,-ot),rt),ut=ht*(ht+2*ot)+at):(ct=Math.max(0,-(it*rt+st)),ht=ct>0?rt:Math.min(Math.max(-rt,-ot),rt),ut=-ct*ct+ht*(ht+2*ot)+at);else ht=it>0?-rt:rt,ct=Math.max(0,-(it*ht+st)),ut=-ct*ct+ht*(ht+2*ot)+at;return tt&&tt.copy(this.origin).addScaledVector(this.direction,ct),nt&&nt.copy(_segCenter).addScaledVector(_segDir,ht),ut}intersectSphere(_,_e){_vector$a.subVectors(_.center,this.origin);const tt=_vector$a.dot(this.direction),nt=_vector$a.dot(_vector$a)-tt*tt,rt=_.radius*_.radius;if(nt>rt)return null;const it=Math.sqrt(rt-nt),st=tt-it,ot=tt+it;return ot<0?null:st<0?this.at(ot,_e):this.at(st,_e)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const _e=_.normal.dot(this.direction);if(_e===0)return _.distanceToPoint(this.origin)===0?0:null;const tt=-(this.origin.dot(_.normal)+_.constant)/_e;return tt>=0?tt:null}intersectPlane(_,_e){const tt=this.distanceToPlane(_);return tt===null?null:this.at(tt,_e)}intersectsPlane(_){const _e=_.distanceToPoint(this.origin);return _e===0||_.normal.dot(this.direction)*_e<0}intersectBox(_,_e){let tt,nt,rt,it,st,ot;const at=1/this.direction.x,lt=1/this.direction.y,ct=1/this.direction.z,ht=this.origin;return at>=0?(tt=(_.min.x-ht.x)*at,nt=(_.max.x-ht.x)*at):(tt=(_.max.x-ht.x)*at,nt=(_.min.x-ht.x)*at),lt>=0?(rt=(_.min.y-ht.y)*lt,it=(_.max.y-ht.y)*lt):(rt=(_.max.y-ht.y)*lt,it=(_.min.y-ht.y)*lt),tt>it||rt>nt||((rt>tt||isNaN(tt))&&(tt=rt),(it<nt||isNaN(nt))&&(nt=it),ct>=0?(st=(_.min.z-ht.z)*ct,ot=(_.max.z-ht.z)*ct):(st=(_.max.z-ht.z)*ct,ot=(_.min.z-ht.z)*ct),tt>ot||st>nt)||((st>tt||tt!==tt)&&(tt=st),(ot<nt||nt!==nt)&&(nt=ot),nt<0)?null:this.at(tt>=0?tt:nt,_e)}intersectsBox(_){return this.intersectBox(_,_vector$a)!==null}intersectTriangle(_,_e,tt,nt,rt){_edge1.subVectors(_e,_),_edge2.subVectors(tt,_),_normal$1.crossVectors(_edge1,_edge2);let it=this.direction.dot(_normal$1),st;if(it>0){if(nt)return null;st=1}else if(it<0)st=-1,it=-it;else return null;_diff.subVectors(this.origin,_);const ot=st*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(ot<0)return null;const at=st*this.direction.dot(_edge1.cross(_diff));if(at<0||ot+at>it)return null;const lt=-st*_diff.dot(_normal$1);return lt<0?null:this.at(lt/it,rt)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(_,_e,tt,nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt,pt){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_!==void 0&&this.set(_,_e,tt,nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt,pt)}set(_,_e,tt,nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt,pt){const mt=this.elements;return mt[0]=_,mt[4]=_e,mt[8]=tt,mt[12]=nt,mt[1]=rt,mt[5]=it,mt[9]=st,mt[13]=ot,mt[2]=at,mt[6]=lt,mt[10]=ct,mt[14]=ht,mt[3]=ut,mt[7]=ft,mt[11]=dt,mt[15]=pt,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_){const _e=this.elements,tt=_.elements;return _e[0]=tt[0],_e[1]=tt[1],_e[2]=tt[2],_e[3]=tt[3],_e[4]=tt[4],_e[5]=tt[5],_e[6]=tt[6],_e[7]=tt[7],_e[8]=tt[8],_e[9]=tt[9],_e[10]=tt[10],_e[11]=tt[11],_e[12]=tt[12],_e[13]=tt[13],_e[14]=tt[14],_e[15]=tt[15],this}copyPosition(_){const _e=this.elements,tt=_.elements;return _e[12]=tt[12],_e[13]=tt[13],_e[14]=tt[14],this}setFromMatrix3(_){const _e=_.elements;return this.set(_e[0],_e[3],_e[6],0,_e[1],_e[4],_e[7],0,_e[2],_e[5],_e[8],0,0,0,0,1),this}extractBasis(_,_e,tt){return _.setFromMatrixColumn(this,0),_e.setFromMatrixColumn(this,1),tt.setFromMatrixColumn(this,2),this}makeBasis(_,_e,tt){return this.set(_.x,_e.x,tt.x,0,_.y,_e.y,tt.y,0,_.z,_e.z,tt.z,0,0,0,0,1),this}extractRotation(_){const _e=this.elements,tt=_.elements,nt=1/_v1$5.setFromMatrixColumn(_,0).length(),rt=1/_v1$5.setFromMatrixColumn(_,1).length(),it=1/_v1$5.setFromMatrixColumn(_,2).length();return _e[0]=tt[0]*nt,_e[1]=tt[1]*nt,_e[2]=tt[2]*nt,_e[3]=0,_e[4]=tt[4]*rt,_e[5]=tt[5]*rt,_e[6]=tt[6]*rt,_e[7]=0,_e[8]=tt[8]*it,_e[9]=tt[9]*it,_e[10]=tt[10]*it,_e[11]=0,_e[12]=0,_e[13]=0,_e[14]=0,_e[15]=1,this}makeRotationFromEuler(_){const _e=this.elements,tt=_.x,nt=_.y,rt=_.z,it=Math.cos(tt),st=Math.sin(tt),ot=Math.cos(nt),at=Math.sin(nt),lt=Math.cos(rt),ct=Math.sin(rt);if(_.order==="XYZ"){const ht=it*lt,ut=it*ct,ft=st*lt,dt=st*ct;_e[0]=ot*lt,_e[4]=-ot*ct,_e[8]=at,_e[1]=ut+ft*at,_e[5]=ht-dt*at,_e[9]=-st*ot,_e[2]=dt-ht*at,_e[6]=ft+ut*at,_e[10]=it*ot}else if(_.order==="YXZ"){const ht=ot*lt,ut=ot*ct,ft=at*lt,dt=at*ct;_e[0]=ht+dt*st,_e[4]=ft*st-ut,_e[8]=it*at,_e[1]=it*ct,_e[5]=it*lt,_e[9]=-st,_e[2]=ut*st-ft,_e[6]=dt+ht*st,_e[10]=it*ot}else if(_.order==="ZXY"){const ht=ot*lt,ut=ot*ct,ft=at*lt,dt=at*ct;_e[0]=ht-dt*st,_e[4]=-it*ct,_e[8]=ft+ut*st,_e[1]=ut+ft*st,_e[5]=it*lt,_e[9]=dt-ht*st,_e[2]=-it*at,_e[6]=st,_e[10]=it*ot}else if(_.order==="ZYX"){const ht=it*lt,ut=it*ct,ft=st*lt,dt=st*ct;_e[0]=ot*lt,_e[4]=ft*at-ut,_e[8]=ht*at+dt,_e[1]=ot*ct,_e[5]=dt*at+ht,_e[9]=ut*at-ft,_e[2]=-at,_e[6]=st*ot,_e[10]=it*ot}else if(_.order==="YZX"){const ht=it*ot,ut=it*at,ft=st*ot,dt=st*at;_e[0]=ot*lt,_e[4]=dt-ht*ct,_e[8]=ft*ct+ut,_e[1]=ct,_e[5]=it*lt,_e[9]=-st*lt,_e[2]=-at*lt,_e[6]=ut*ct+ft,_e[10]=ht-dt*ct}else if(_.order==="XZY"){const ht=it*ot,ut=it*at,ft=st*ot,dt=st*at;_e[0]=ot*lt,_e[4]=-ct,_e[8]=at*lt,_e[1]=ht*ct+dt,_e[5]=it*lt,_e[9]=ut*ct-ft,_e[2]=ft*ct-ut,_e[6]=st*lt,_e[10]=dt*ct+ht}return _e[3]=0,_e[7]=0,_e[11]=0,_e[12]=0,_e[13]=0,_e[14]=0,_e[15]=1,this}makeRotationFromQuaternion(_){return this.compose(_zero,_,_one)}lookAt(_,_e,tt){const nt=this.elements;return _z.subVectors(_,_e),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(tt,_z),_x.lengthSq()===0&&(Math.abs(tt.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(tt,_z)),_x.normalize(),_y.crossVectors(_z,_x),nt[0]=_x.x,nt[4]=_y.x,nt[8]=_z.x,nt[1]=_x.y,nt[5]=_y.y,nt[9]=_z.y,nt[2]=_x.z,nt[6]=_y.z,nt[10]=_z.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,_e){const tt=_.elements,nt=_e.elements,rt=this.elements,it=tt[0],st=tt[4],ot=tt[8],at=tt[12],lt=tt[1],ct=tt[5],ht=tt[9],ut=tt[13],ft=tt[2],dt=tt[6],pt=tt[10],mt=tt[14],vt=tt[3],yt=tt[7],_t=tt[11],St=tt[15],bt=nt[0],Et=nt[4],Mt=nt[8],Tt=nt[12],wt=nt[1],Ct=nt[5],Rt=nt[9],It=nt[13],Dt=nt[2],Ft=nt[6],$t=nt[10],Yt=nt[14],Lt=nt[3],Ot=nt[7],Nt=nt[11],zt=nt[15];return rt[0]=it*bt+st*wt+ot*Dt+at*Lt,rt[4]=it*Et+st*Ct+ot*Ft+at*Ot,rt[8]=it*Mt+st*Rt+ot*$t+at*Nt,rt[12]=it*Tt+st*It+ot*Yt+at*zt,rt[1]=lt*bt+ct*wt+ht*Dt+ut*Lt,rt[5]=lt*Et+ct*Ct+ht*Ft+ut*Ot,rt[9]=lt*Mt+ct*Rt+ht*$t+ut*Nt,rt[13]=lt*Tt+ct*It+ht*Yt+ut*zt,rt[2]=ft*bt+dt*wt+pt*Dt+mt*Lt,rt[6]=ft*Et+dt*Ct+pt*Ft+mt*Ot,rt[10]=ft*Mt+dt*Rt+pt*$t+mt*Nt,rt[14]=ft*Tt+dt*It+pt*Yt+mt*zt,rt[3]=vt*bt+yt*wt+_t*Dt+St*Lt,rt[7]=vt*Et+yt*Ct+_t*Ft+St*Ot,rt[11]=vt*Mt+yt*Rt+_t*$t+St*Nt,rt[15]=vt*Tt+yt*It+_t*Yt+St*zt,this}multiplyScalar(_){const _e=this.elements;return _e[0]*=_,_e[4]*=_,_e[8]*=_,_e[12]*=_,_e[1]*=_,_e[5]*=_,_e[9]*=_,_e[13]*=_,_e[2]*=_,_e[6]*=_,_e[10]*=_,_e[14]*=_,_e[3]*=_,_e[7]*=_,_e[11]*=_,_e[15]*=_,this}determinant(){const _=this.elements,_e=_[0],tt=_[4],nt=_[8],rt=_[12],it=_[1],st=_[5],ot=_[9],at=_[13],lt=_[2],ct=_[6],ht=_[10],ut=_[14],ft=_[3],dt=_[7],pt=_[11],mt=_[15];return ft*(+rt*ot*ct-nt*at*ct-rt*st*ht+tt*at*ht+nt*st*ut-tt*ot*ut)+dt*(+_e*ot*ut-_e*at*ht+rt*it*ht-nt*it*ut+nt*at*lt-rt*ot*lt)+pt*(+_e*at*ct-_e*st*ut-rt*it*ct+tt*it*ut+rt*st*lt-tt*at*lt)+mt*(-nt*st*lt-_e*ot*ct+_e*st*ht+nt*it*ct-tt*it*ht+tt*ot*lt)}transpose(){const _=this.elements;let _e;return _e=_[1],_[1]=_[4],_[4]=_e,_e=_[2],_[2]=_[8],_[8]=_e,_e=_[6],_[6]=_[9],_[9]=_e,_e=_[3],_[3]=_[12],_[12]=_e,_e=_[7],_[7]=_[13],_[13]=_e,_e=_[11],_[11]=_[14],_[14]=_e,this}setPosition(_,_e,tt){const nt=this.elements;return _.isVector3?(nt[12]=_.x,nt[13]=_.y,nt[14]=_.z):(nt[12]=_,nt[13]=_e,nt[14]=tt),this}invert(){const _=this.elements,_e=_[0],tt=_[1],nt=_[2],rt=_[3],it=_[4],st=_[5],ot=_[6],at=_[7],lt=_[8],ct=_[9],ht=_[10],ut=_[11],ft=_[12],dt=_[13],pt=_[14],mt=_[15],vt=ct*pt*at-dt*ht*at+dt*ot*ut-st*pt*ut-ct*ot*mt+st*ht*mt,yt=ft*ht*at-lt*pt*at-ft*ot*ut+it*pt*ut+lt*ot*mt-it*ht*mt,_t=lt*dt*at-ft*ct*at+ft*st*ut-it*dt*ut-lt*st*mt+it*ct*mt,St=ft*ct*ot-lt*dt*ot-ft*st*ht+it*dt*ht+lt*st*pt-it*ct*pt,bt=_e*vt+tt*yt+nt*_t+rt*St;if(bt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Et=1/bt;return _[0]=vt*Et,_[1]=(dt*ht*rt-ct*pt*rt-dt*nt*ut+tt*pt*ut+ct*nt*mt-tt*ht*mt)*Et,_[2]=(st*pt*rt-dt*ot*rt+dt*nt*at-tt*pt*at-st*nt*mt+tt*ot*mt)*Et,_[3]=(ct*ot*rt-st*ht*rt-ct*nt*at+tt*ht*at+st*nt*ut-tt*ot*ut)*Et,_[4]=yt*Et,_[5]=(lt*pt*rt-ft*ht*rt+ft*nt*ut-_e*pt*ut-lt*nt*mt+_e*ht*mt)*Et,_[6]=(ft*ot*rt-it*pt*rt-ft*nt*at+_e*pt*at+it*nt*mt-_e*ot*mt)*Et,_[7]=(it*ht*rt-lt*ot*rt+lt*nt*at-_e*ht*at-it*nt*ut+_e*ot*ut)*Et,_[8]=_t*Et,_[9]=(ft*ct*rt-lt*dt*rt-ft*tt*ut+_e*dt*ut+lt*tt*mt-_e*ct*mt)*Et,_[10]=(it*dt*rt-ft*st*rt+ft*tt*at-_e*dt*at-it*tt*mt+_e*st*mt)*Et,_[11]=(lt*st*rt-it*ct*rt-lt*tt*at+_e*ct*at+it*tt*ut-_e*st*ut)*Et,_[12]=St*Et,_[13]=(lt*dt*nt-ft*ct*nt+ft*tt*ht-_e*dt*ht-lt*tt*pt+_e*ct*pt)*Et,_[14]=(ft*st*nt-it*dt*nt-ft*tt*ot+_e*dt*ot+it*tt*pt-_e*st*pt)*Et,_[15]=(it*ct*nt-lt*st*nt+lt*tt*ot-_e*ct*ot-it*tt*ht+_e*st*ht)*Et,this}scale(_){const _e=this.elements,tt=_.x,nt=_.y,rt=_.z;return _e[0]*=tt,_e[4]*=nt,_e[8]*=rt,_e[1]*=tt,_e[5]*=nt,_e[9]*=rt,_e[2]*=tt,_e[6]*=nt,_e[10]*=rt,_e[3]*=tt,_e[7]*=nt,_e[11]*=rt,this}getMaxScaleOnAxis(){const _=this.elements,_e=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],tt=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],nt=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(_e,tt,nt))}makeTranslation(_,_e,tt){return _.isVector3?this.set(1,0,0,_.x,0,1,0,_.y,0,0,1,_.z,0,0,0,1):this.set(1,0,0,_,0,1,0,_e,0,0,1,tt,0,0,0,1),this}makeRotationX(_){const _e=Math.cos(_),tt=Math.sin(_);return this.set(1,0,0,0,0,_e,-tt,0,0,tt,_e,0,0,0,0,1),this}makeRotationY(_){const _e=Math.cos(_),tt=Math.sin(_);return this.set(_e,0,tt,0,0,1,0,0,-tt,0,_e,0,0,0,0,1),this}makeRotationZ(_){const _e=Math.cos(_),tt=Math.sin(_);return this.set(_e,-tt,0,0,tt,_e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,_e){const tt=Math.cos(_e),nt=Math.sin(_e),rt=1-tt,it=_.x,st=_.y,ot=_.z,at=rt*it,lt=rt*st;return this.set(at*it+tt,at*st-nt*ot,at*ot+nt*st,0,at*st+nt*ot,lt*st+tt,lt*ot-nt*it,0,at*ot-nt*st,lt*ot+nt*it,rt*ot*ot+tt,0,0,0,0,1),this}makeScale(_,_e,tt){return this.set(_,0,0,0,0,_e,0,0,0,0,tt,0,0,0,0,1),this}makeShear(_,_e,tt,nt,rt,it){return this.set(1,tt,rt,0,_,1,it,0,_e,nt,1,0,0,0,0,1),this}compose(_,_e,tt){const nt=this.elements,rt=_e._x,it=_e._y,st=_e._z,ot=_e._w,at=rt+rt,lt=it+it,ct=st+st,ht=rt*at,ut=rt*lt,ft=rt*ct,dt=it*lt,pt=it*ct,mt=st*ct,vt=ot*at,yt=ot*lt,_t=ot*ct,St=tt.x,bt=tt.y,Et=tt.z;return nt[0]=(1-(dt+mt))*St,nt[1]=(ut+_t)*St,nt[2]=(ft-yt)*St,nt[3]=0,nt[4]=(ut-_t)*bt,nt[5]=(1-(ht+mt))*bt,nt[6]=(pt+vt)*bt,nt[7]=0,nt[8]=(ft+yt)*Et,nt[9]=(pt-vt)*Et,nt[10]=(1-(ht+dt))*Et,nt[11]=0,nt[12]=_.x,nt[13]=_.y,nt[14]=_.z,nt[15]=1,this}decompose(_,_e,tt){const nt=this.elements;let rt=_v1$5.set(nt[0],nt[1],nt[2]).length();const it=_v1$5.set(nt[4],nt[5],nt[6]).length(),st=_v1$5.set(nt[8],nt[9],nt[10]).length();this.determinant()<0&&(rt=-rt),_.x=nt[12],_.y=nt[13],_.z=nt[14],_m1$4.copy(this);const at=1/rt,lt=1/it,ct=1/st;return _m1$4.elements[0]*=at,_m1$4.elements[1]*=at,_m1$4.elements[2]*=at,_m1$4.elements[4]*=lt,_m1$4.elements[5]*=lt,_m1$4.elements[6]*=lt,_m1$4.elements[8]*=ct,_m1$4.elements[9]*=ct,_m1$4.elements[10]*=ct,_e.setFromRotationMatrix(_m1$4),tt.x=rt,tt.y=it,tt.z=st,this}makePerspective(_,_e,tt,nt,rt,it,st=WebGLCoordinateSystem){const ot=this.elements,at=2*rt/(_e-_),lt=2*rt/(tt-nt),ct=(_e+_)/(_e-_),ht=(tt+nt)/(tt-nt);let ut,ft;if(st===WebGLCoordinateSystem)ut=-(it+rt)/(it-rt),ft=-2*it*rt/(it-rt);else if(st===WebGPUCoordinateSystem)ut=-it/(it-rt),ft=-it*rt/(it-rt);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+st);return ot[0]=at,ot[4]=0,ot[8]=ct,ot[12]=0,ot[1]=0,ot[5]=lt,ot[9]=ht,ot[13]=0,ot[2]=0,ot[6]=0,ot[10]=ut,ot[14]=ft,ot[3]=0,ot[7]=0,ot[11]=-1,ot[15]=0,this}makeOrthographic(_,_e,tt,nt,rt,it,st=WebGLCoordinateSystem){const ot=this.elements,at=1/(_e-_),lt=1/(tt-nt),ct=1/(it-rt),ht=(_e+_)*at,ut=(tt+nt)*lt;let ft,dt;if(st===WebGLCoordinateSystem)ft=(it+rt)*ct,dt=-2*ct;else if(st===WebGPUCoordinateSystem)ft=rt*ct,dt=-1*ct;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+st);return ot[0]=2*at,ot[4]=0,ot[8]=0,ot[12]=-ht,ot[1]=0,ot[5]=2*lt,ot[9]=0,ot[13]=-ut,ot[2]=0,ot[6]=0,ot[10]=dt,ot[14]=-ft,ot[3]=0,ot[7]=0,ot[11]=0,ot[15]=1,this}equals(_){const _e=this.elements,tt=_.elements;for(let nt=0;nt<16;nt++)if(_e[nt]!==tt[nt])return!1;return!0}fromArray(_,_e=0){for(let tt=0;tt<16;tt++)this.elements[tt]=_[tt+_e];return this}toArray(_=[],_e=0){const tt=this.elements;return _[_e]=tt[0],_[_e+1]=tt[1],_[_e+2]=tt[2],_[_e+3]=tt[3],_[_e+4]=tt[4],_[_e+5]=tt[5],_[_e+6]=tt[6],_[_e+7]=tt[7],_[_e+8]=tt[8],_[_e+9]=tt[9],_[_e+10]=tt[10],_[_e+11]=tt[11],_[_e+12]=tt[12],_[_e+13]=tt[13],_[_e+14]=tt[14],_[_e+15]=tt[15],_}}const _v1$5=new Vector3,_m1$4=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_=0,_e=0,tt=0,nt=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_,this._y=_e,this._z=tt,this._order=nt}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,_e,tt,nt=this._order){return this._x=_,this._y=_e,this._z=tt,this._order=nt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,_e=this._order,tt=!0){const nt=_.elements,rt=nt[0],it=nt[4],st=nt[8],ot=nt[1],at=nt[5],lt=nt[9],ct=nt[2],ht=nt[6],ut=nt[10];switch(_e){case"XYZ":this._y=Math.asin(clamp$1(st,-1,1)),Math.abs(st)<.9999999?(this._x=Math.atan2(-lt,ut),this._z=Math.atan2(-it,rt)):(this._x=Math.atan2(ht,at),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$1(lt,-1,1)),Math.abs(lt)<.9999999?(this._y=Math.atan2(st,ut),this._z=Math.atan2(ot,at)):(this._y=Math.atan2(-ct,rt),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$1(ht,-1,1)),Math.abs(ht)<.9999999?(this._y=Math.atan2(-ct,ut),this._z=Math.atan2(-it,at)):(this._y=0,this._z=Math.atan2(ot,rt));break;case"ZYX":this._y=Math.asin(-clamp$1(ct,-1,1)),Math.abs(ct)<.9999999?(this._x=Math.atan2(ht,ut),this._z=Math.atan2(ot,rt)):(this._x=0,this._z=Math.atan2(-it,at));break;case"YZX":this._z=Math.asin(clamp$1(ot,-1,1)),Math.abs(ot)<.9999999?(this._x=Math.atan2(-lt,at),this._y=Math.atan2(-ct,rt)):(this._x=0,this._y=Math.atan2(st,ut));break;case"XZY":this._z=Math.asin(-clamp$1(it,-1,1)),Math.abs(it)<.9999999?(this._x=Math.atan2(ht,at),this._y=Math.atan2(st,rt)):(this._x=Math.atan2(-lt,ut),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+_e)}return this._order=_e,tt===!0&&this._onChangeCallback(),this}setFromQuaternion(_,_e,tt){return _matrix$2.makeRotationFromQuaternion(_),this.setFromRotationMatrix(_matrix$2,_e,tt)}setFromVector3(_,_e=this._order){return this.set(_.x,_.y,_.z,_e)}reorder(_){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],_e=0){return _[_e]=this._x,_[_e+1]=this._y,_[_e+2]=this._z,_[_e+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!==0}isEnabled(_){return(this.mask&(1<<_|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$3=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID$1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _=new Vector3,_e=new Euler,tt=new Quaternion,nt=new Vector3(1,1,1);function rt(){tt.setFromEuler(_e,!1)}function it(){_e.setFromQuaternion(tt,void 0,!1)}_e._onChange(rt),tt._onChange(it),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:_e},quaternion:{configurable:!0,enumerable:!0,value:tt},scale:{configurable:!0,enumerable:!0,value:nt},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,_e){this.quaternion.setFromAxisAngle(_,_e)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,_e){return _q1.setFromAxisAngle(_,_e),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_,_e){return _q1.setFromAxisAngle(_,_e),this.quaternion.premultiply(_q1),this}rotateX(_){return this.rotateOnAxis(_xAxis,_)}rotateY(_){return this.rotateOnAxis(_yAxis,_)}rotateZ(_){return this.rotateOnAxis(_zAxis,_)}translateOnAxis(_,_e){return _v1$4.copy(_).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(_e)),this}translateX(_){return this.translateOnAxis(_xAxis,_)}translateY(_){return this.translateOnAxis(_yAxis,_)}translateZ(_){return this.translateOnAxis(_zAxis,_)}localToWorld(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(this.matrixWorld)}worldToLocal(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(_m1$3.copy(this.matrixWorld).invert())}lookAt(_,_e,tt){_.isVector3?_target.copy(_):_target.set(_,_e,tt);const nt=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$3.lookAt(_position$3,_target,this.up):_m1$3.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$3),nt&&(_m1$3.extractRotation(nt.matrixWorld),_q1.setFromRotationMatrix(_m1$3),this.quaternion.premultiply(_q1.invert()))}add(_){if(arguments.length>1){for(let _e=0;_e<arguments.length;_e++)this.add(arguments[_e]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.removeFromParent(),_.parent=this,this.children.push(_),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let tt=0;tt<arguments.length;tt++)this.remove(arguments[tt]);return this}const _e=this.children.indexOf(_);return _e!==-1&&(_.parent=null,this.children.splice(_e,1),_.dispatchEvent(_removedEvent),_childremovedEvent.child=_,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){return this.remove(...this.children)}attach(_){return this.updateWorldMatrix(!0,!1),_m1$3.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),_m1$3.multiply(_.parent.matrixWorld)),_.applyMatrix4(_m1$3),_.removeFromParent(),_.parent=this,this.children.push(_),_.updateWorldMatrix(!1,!0),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,_e){if(this[_]===_e)return this;for(let tt=0,nt=this.children.length;tt<nt;tt++){const it=this.children[tt].getObjectByProperty(_,_e);if(it!==void 0)return it}}getObjectsByProperty(_,_e,tt=[]){this[_]===_e&&tt.push(this);const nt=this.children;for(let rt=0,it=nt.length;rt<it;rt++)nt[rt].getObjectsByProperty(_,_e,tt);return tt}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_,_scale$2),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const _e=this.matrixWorld.elements;return _.set(_e[8],_e[9],_e[10]).normalize()}raycast(){}traverse(_){_(this);const _e=this.children;for(let tt=0,nt=_e.length;tt<nt;tt++)_e[tt].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const _e=this.children;for(let tt=0,nt=_e.length;tt<nt;tt++)_e[tt].traverseVisible(_)}traverseAncestors(_){const _e=this.parent;_e!==null&&(_(_e),_e.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_=!0);const _e=this.children;for(let tt=0,nt=_e.length;tt<nt;tt++)_e[tt].updateMatrixWorld(_)}updateWorldMatrix(_,_e){const tt=this.parent;if(_===!0&&tt!==null&&tt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),_e===!0){const nt=this.children;for(let rt=0,it=nt.length;rt<it;rt++)nt[rt].updateWorldMatrix(!1,!0)}}toJSON(_){const _e=_===void 0||typeof _=="string",tt={};_e&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},tt.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const nt={};nt.uuid=this.uuid,nt.type=this.type,this.name!==""&&(nt.name=this.name),this.castShadow===!0&&(nt.castShadow=!0),this.receiveShadow===!0&&(nt.receiveShadow=!0),this.visible===!1&&(nt.visible=!1),this.frustumCulled===!1&&(nt.frustumCulled=!1),this.renderOrder!==0&&(nt.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(nt.userData=this.userData),nt.layers=this.layers.mask,nt.matrix=this.matrix.toArray(),nt.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(nt.matrixAutoUpdate=!1),this.isInstancedMesh&&(nt.type="InstancedMesh",nt.count=this.count,nt.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(nt.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(nt.type="BatchedMesh",nt.perObjectFrustumCulled=this.perObjectFrustumCulled,nt.sortObjects=this.sortObjects,nt.drawRanges=this._drawRanges,nt.reservedRanges=this._reservedRanges,nt.visibility=this._visibility,nt.active=this._active,nt.bounds=this._bounds.map(st=>({boxInitialized:st.boxInitialized,boxMin:st.box.min.toArray(),boxMax:st.box.max.toArray(),sphereInitialized:st.sphereInitialized,sphereRadius:st.sphere.radius,sphereCenter:st.sphere.center.toArray()})),nt.maxInstanceCount=this._maxInstanceCount,nt.maxVertexCount=this._maxVertexCount,nt.maxIndexCount=this._maxIndexCount,nt.geometryInitialized=this._geometryInitialized,nt.geometryCount=this._geometryCount,nt.matricesTexture=this._matricesTexture.toJSON(_),this._colorsTexture!==null&&(nt.colorsTexture=this._colorsTexture.toJSON(_)),this.boundingSphere!==null&&(nt.boundingSphere={center:nt.boundingSphere.center.toArray(),radius:nt.boundingSphere.radius}),this.boundingBox!==null&&(nt.boundingBox={min:nt.boundingBox.min.toArray(),max:nt.boundingBox.max.toArray()}));function rt(st,ot){return st[ot.uuid]===void 0&&(st[ot.uuid]=ot.toJSON(_)),ot.uuid}if(this.isScene)this.background&&(this.background.isColor?nt.background=this.background.toJSON():this.background.isTexture&&(nt.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(nt.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){nt.geometry=rt(_.geometries,this.geometry);const st=this.geometry.parameters;if(st!==void 0&&st.shapes!==void 0){const ot=st.shapes;if(Array.isArray(ot))for(let at=0,lt=ot.length;at<lt;at++){const ct=ot[at];rt(_.shapes,ct)}else rt(_.shapes,ot)}}if(this.isSkinnedMesh&&(nt.bindMode=this.bindMode,nt.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(rt(_.skeletons,this.skeleton),nt.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const st=[];for(let ot=0,at=this.material.length;ot<at;ot++)st.push(rt(_.materials,this.material[ot]));nt.material=st}else nt.material=rt(_.materials,this.material);if(this.children.length>0){nt.children=[];for(let st=0;st<this.children.length;st++)nt.children.push(this.children[st].toJSON(_).object)}if(this.animations.length>0){nt.animations=[];for(let st=0;st<this.animations.length;st++){const ot=this.animations[st];nt.animations.push(rt(_.animations,ot))}}if(_e){const st=it(_.geometries),ot=it(_.materials),at=it(_.textures),lt=it(_.images),ct=it(_.shapes),ht=it(_.skeletons),ut=it(_.animations),ft=it(_.nodes);st.length>0&&(tt.geometries=st),ot.length>0&&(tt.materials=ot),at.length>0&&(tt.textures=at),lt.length>0&&(tt.images=lt),ct.length>0&&(tt.shapes=ct),ht.length>0&&(tt.skeletons=ht),ut.length>0&&(tt.animations=ut),ft.length>0&&(tt.nodes=ft)}return tt.object=nt,tt;function it(st){const ot=[];for(const at in st){const lt=st[at];delete lt.metadata,ot.push(lt)}return ot}}clone(_){return new this.constructor().copy(this,_)}copy(_,_e=!0){if(this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.animations=_.animations.slice(),this.userData=JSON.parse(JSON.stringify(_.userData)),_e===!0)for(let tt=0;tt<_.children.length;tt++){const nt=_.children[tt];this.add(nt.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;class Triangle{constructor(_=new Vector3,_e=new Vector3,tt=new Vector3){this.a=_,this.b=_e,this.c=tt}static getNormal(_,_e,tt,nt){nt.subVectors(tt,_e),_v0$1.subVectors(_,_e),nt.cross(_v0$1);const rt=nt.lengthSq();return rt>0?nt.multiplyScalar(1/Math.sqrt(rt)):nt.set(0,0,0)}static getBarycoord(_,_e,tt,nt,rt){_v0$1.subVectors(nt,_e),_v1$3.subVectors(tt,_e),_v2$2.subVectors(_,_e);const it=_v0$1.dot(_v0$1),st=_v0$1.dot(_v1$3),ot=_v0$1.dot(_v2$2),at=_v1$3.dot(_v1$3),lt=_v1$3.dot(_v2$2),ct=it*at-st*st;if(ct===0)return rt.set(0,0,0),null;const ht=1/ct,ut=(at*ot-st*lt)*ht,ft=(it*lt-st*ot)*ht;return rt.set(1-ut-ft,ft,ut)}static containsPoint(_,_e,tt,nt){return this.getBarycoord(_,_e,tt,nt,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(_,_e,tt,nt,rt,it,st,ot){return this.getBarycoord(_,_e,tt,nt,_v3$2)===null?(ot.x=0,ot.y=0,"z"in ot&&(ot.z=0),"w"in ot&&(ot.w=0),null):(ot.setScalar(0),ot.addScaledVector(rt,_v3$2.x),ot.addScaledVector(it,_v3$2.y),ot.addScaledVector(st,_v3$2.z),ot)}static isFrontFacing(_,_e,tt,nt){return _v0$1.subVectors(tt,_e),_v1$3.subVectors(_,_e),_v0$1.cross(_v1$3).dot(nt)<0}set(_,_e,tt){return this.a.copy(_),this.b.copy(_e),this.c.copy(tt),this}setFromPointsAndIndices(_,_e,tt,nt){return this.a.copy(_[_e]),this.b.copy(_[tt]),this.c.copy(_[nt]),this}setFromAttributeAndIndices(_,_e,tt,nt){return this.a.fromBufferAttribute(_,_e),this.b.fromBufferAttribute(_,tt),this.c.fromBufferAttribute(_,nt),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return Triangle.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,_e){return Triangle.getBarycoord(_,this.a,this.b,this.c,_e)}getInterpolation(_,_e,tt,nt,rt){return Triangle.getInterpolation(_,this.a,this.b,this.c,_e,tt,nt,rt)}containsPoint(_){return Triangle.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return Triangle.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,_e){const tt=this.a,nt=this.b,rt=this.c;let it,st;_vab.subVectors(nt,tt),_vac.subVectors(rt,tt),_vap.subVectors(_,tt);const ot=_vab.dot(_vap),at=_vac.dot(_vap);if(ot<=0&&at<=0)return _e.copy(tt);_vbp.subVectors(_,nt);const lt=_vab.dot(_vbp),ct=_vac.dot(_vbp);if(lt>=0&&ct<=lt)return _e.copy(nt);const ht=ot*ct-lt*at;if(ht<=0&&ot>=0&&lt<=0)return it=ot/(ot-lt),_e.copy(tt).addScaledVector(_vab,it);_vcp.subVectors(_,rt);const ut=_vab.dot(_vcp),ft=_vac.dot(_vcp);if(ft>=0&&ut<=ft)return _e.copy(rt);const dt=ut*at-ot*ft;if(dt<=0&&at>=0&&ft<=0)return st=at/(at-ft),_e.copy(tt).addScaledVector(_vac,st);const pt=lt*ft-ut*ct;if(pt<=0&&ct-lt>=0&&ut-ft>=0)return _vbc.subVectors(rt,nt),st=(ct-lt)/(ct-lt+(ut-ft)),_e.copy(nt).addScaledVector(_vbc,st);const mt=1/(pt+dt+ht);return it=dt*mt,st=ht*mt,_e.copy(tt).addScaledVector(_vab,it).addScaledVector(_vac,st)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb$1(et,_,_e){return _e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?et+(_-et)*6*_e:_e<1/2?_:_e<2/3?et+(_-et)*6*(2/3-_e):et}let Color$1=class{constructor(_,_e,tt){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_,_e,tt)}set(_,_e,tt){if(_e===void 0&&tt===void 0){const nt=_;nt&&nt.isColor?this.copy(nt):typeof nt=="number"?this.setHex(nt):typeof nt=="string"&&this.setStyle(nt)}else this.setRGB(_,_e,tt);return this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,_e=SRGBColorSpace){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,ColorManagement.toWorkingColorSpace(this,_e),this}setRGB(_,_e,tt,nt=ColorManagement.workingColorSpace){return this.r=_,this.g=_e,this.b=tt,ColorManagement.toWorkingColorSpace(this,nt),this}setHSL(_,_e,tt,nt=ColorManagement.workingColorSpace){if(_=euclideanModulo(_,1),_e=clamp$1(_e,0,1),tt=clamp$1(tt,0,1),_e===0)this.r=this.g=this.b=tt;else{const rt=tt<=.5?tt*(1+_e):tt+_e-tt*_e,it=2*tt-rt;this.r=hue2rgb$1(it,rt,_+1/3),this.g=hue2rgb$1(it,rt,_),this.b=hue2rgb$1(it,rt,_-1/3)}return ColorManagement.toWorkingColorSpace(this,nt),this}setStyle(_,_e=SRGBColorSpace){function tt(rt){rt!==void 0&&parseFloat(rt)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let nt;if(nt=/^(\w+)\(([^\)]*)\)/.exec(_)){let rt;const it=nt[1],st=nt[2];switch(it){case"rgb":case"rgba":if(rt=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(st))return tt(rt[4]),this.setRGB(Math.min(255,parseInt(rt[1],10))/255,Math.min(255,parseInt(rt[2],10))/255,Math.min(255,parseInt(rt[3],10))/255,_e);if(rt=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(st))return tt(rt[4]),this.setRGB(Math.min(100,parseInt(rt[1],10))/100,Math.min(100,parseInt(rt[2],10))/100,Math.min(100,parseInt(rt[3],10))/100,_e);break;case"hsl":case"hsla":if(rt=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(st))return tt(rt[4]),this.setHSL(parseFloat(rt[1])/360,parseFloat(rt[2])/100,parseFloat(rt[3])/100,_e);break;default:console.warn("THREE.Color: Unknown color model "+_)}}else if(nt=/^\#([A-Fa-f\d]+)$/.exec(_)){const rt=nt[1],it=rt.length;if(it===3)return this.setRGB(parseInt(rt.charAt(0),16)/15,parseInt(rt.charAt(1),16)/15,parseInt(rt.charAt(2),16)/15,_e);if(it===6)return this.setHex(parseInt(rt,16),_e);console.warn("THREE.Color: Invalid hex color "+_)}else if(_&&_.length>0)return this.setColorName(_,_e);return this}setColorName(_,_e=SRGBColorSpace){const tt=_colorKeywords[_.toLowerCase()];return tt!==void 0?this.setHex(tt,_e):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=SRGBToLinear(_.r),this.g=SRGBToLinear(_.g),this.b=SRGBToLinear(_.b),this}copyLinearToSRGB(_){return this.r=LinearToSRGB(_.r),this.g=LinearToSRGB(_.g),this.b=LinearToSRGB(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color$2.copy(this),_),Math.round(clamp$1(_color$2.r*255,0,255))*65536+Math.round(clamp$1(_color$2.g*255,0,255))*256+Math.round(clamp$1(_color$2.b*255,0,255))}getHexString(_=SRGBColorSpace){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,_e=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color$2.copy(this),_e);const tt=_color$2.r,nt=_color$2.g,rt=_color$2.b,it=Math.max(tt,nt,rt),st=Math.min(tt,nt,rt);let ot,at;const lt=(st+it)/2;if(st===it)ot=0,at=0;else{const ct=it-st;switch(at=lt<=.5?ct/(it+st):ct/(2-it-st),it){case tt:ot=(nt-rt)/ct+(nt<rt?6:0);break;case nt:ot=(rt-tt)/ct+2;break;case rt:ot=(tt-nt)/ct+4;break}ot/=6}return _.h=ot,_.s=at,_.l=lt,_}getRGB(_,_e=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color$2.copy(this),_e),_.r=_color$2.r,_.g=_color$2.g,_.b=_color$2.b,_}getStyle(_=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color$2.copy(this),_);const _e=_color$2.r,tt=_color$2.g,nt=_color$2.b;return _!==SRGBColorSpace?`color(${_} ${_e.toFixed(3)} ${tt.toFixed(3)} ${nt.toFixed(3)})`:`rgb(${Math.round(_e*255)},${Math.round(tt*255)},${Math.round(nt*255)})`}offsetHSL(_,_e,tt){return this.getHSL(_hslA),this.setHSL(_hslA.h+_,_hslA.s+_e,_hslA.l+tt)}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,_e){return this.r=_.r+_e.r,this.g=_.g+_e.g,this.b=_.b+_e.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,_e){return this.r+=(_.r-this.r)*_e,this.g+=(_.g-this.g)*_e,this.b+=(_.b-this.b)*_e,this}lerpColors(_,_e,tt){return this.r=_.r+(_e.r-_.r)*tt,this.g=_.g+(_e.g-_.g)*tt,this.b=_.b+(_e.b-_.b)*tt,this}lerpHSL(_,_e){this.getHSL(_hslA),_.getHSL(_hslB);const tt=lerp(_hslA.h,_hslB.h,_e),nt=lerp(_hslA.s,_hslB.s,_e),rt=lerp(_hslA.l,_hslB.l,_e);return this.setHSL(tt,nt,rt),this}setFromVector3(_){return this.r=_.x,this.g=_.y,this.b=_.z,this}applyMatrix3(_){const _e=this.r,tt=this.g,nt=this.b,rt=_.elements;return this.r=rt[0]*_e+rt[3]*tt+rt[6]*nt,this.g=rt[1]*_e+rt[4]*tt+rt[7]*nt,this.b=rt[2]*_e+rt[5]*tt+rt[8]*nt,this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,_e=0){return this.r=_[_e],this.g=_[_e+1],this.b=_[_e+2],this}toArray(_=[],_e=0){return _[_e]=this.r,_[_e+1]=this.g,_[_e+2]=this.b,_}fromBufferAttribute(_,_e){return this.r=_.getX(_e),this.g=_.getY(_e),this.b=_.getZ(_e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color$2=new Color$1;Color$1.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID$1(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color$1(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const _e in _){const tt=_[_e];if(tt===void 0){console.warn(`THREE.Material: parameter '${_e}' has value of undefined.`);continue}const nt=this[_e];if(nt===void 0){console.warn(`THREE.Material: '${_e}' is not a property of THREE.${this.type}.`);continue}nt&&nt.isColor?nt.set(tt):nt&&nt.isVector3&&tt&&tt.isVector3?nt.copy(tt):this[_e]=tt}}toJSON(_){const _e=_===void 0||typeof _=="string";_e&&(_={textures:{},images:{}});const tt={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};tt.uuid=this.uuid,tt.type=this.type,this.name!==""&&(tt.name=this.name),this.color&&this.color.isColor&&(tt.color=this.color.getHex()),this.roughness!==void 0&&(tt.roughness=this.roughness),this.metalness!==void 0&&(tt.metalness=this.metalness),this.sheen!==void 0&&(tt.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(tt.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(tt.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(tt.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(tt.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(tt.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(tt.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(tt.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(tt.shininess=this.shininess),this.clearcoat!==void 0&&(tt.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(tt.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(tt.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(tt.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(tt.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,tt.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(tt.dispersion=this.dispersion),this.iridescence!==void 0&&(tt.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(tt.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(tt.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(tt.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(tt.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.anisotropy!==void 0&&(tt.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(tt.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(tt.anisotropyMap=this.anisotropyMap.toJSON(_).uuid),this.map&&this.map.isTexture&&(tt.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&(tt.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&(tt.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&(tt.lightMap=this.lightMap.toJSON(_).uuid,tt.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(tt.aoMap=this.aoMap.toJSON(_).uuid,tt.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(tt.bumpMap=this.bumpMap.toJSON(_).uuid,tt.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(tt.normalMap=this.normalMap.toJSON(_).uuid,tt.normalMapType=this.normalMapType,tt.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(tt.displacementMap=this.displacementMap.toJSON(_).uuid,tt.displacementScale=this.displacementScale,tt.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(tt.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(tt.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(tt.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&(tt.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(tt.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(tt.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&(tt.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&(tt.combine=this.combine)),this.envMapRotation!==void 0&&(tt.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(tt.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(tt.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(tt.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(tt.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&(tt.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(tt.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&(tt.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(tt.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(tt.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(tt.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(tt.size=this.size),this.shadowSide!==null&&(tt.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(tt.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(tt.blending=this.blending),this.side!==FrontSide&&(tt.side=this.side),this.vertexColors===!0&&(tt.vertexColors=!0),this.opacity<1&&(tt.opacity=this.opacity),this.transparent===!0&&(tt.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(tt.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(tt.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(tt.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(tt.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(tt.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(tt.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(tt.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(tt.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(tt.depthFunc=this.depthFunc),this.depthTest===!1&&(tt.depthTest=this.depthTest),this.depthWrite===!1&&(tt.depthWrite=this.depthWrite),this.colorWrite===!1&&(tt.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(tt.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(tt.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(tt.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(tt.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(tt.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(tt.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(tt.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(tt.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(tt.rotation=this.rotation),this.polygonOffset===!0&&(tt.polygonOffset=!0),this.polygonOffsetFactor!==0&&(tt.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(tt.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(tt.linewidth=this.linewidth),this.dashSize!==void 0&&(tt.dashSize=this.dashSize),this.gapSize!==void 0&&(tt.gapSize=this.gapSize),this.scale!==void 0&&(tt.scale=this.scale),this.dithering===!0&&(tt.dithering=!0),this.alphaTest>0&&(tt.alphaTest=this.alphaTest),this.alphaHash===!0&&(tt.alphaHash=!0),this.alphaToCoverage===!0&&(tt.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(tt.premultipliedAlpha=!0),this.forceSinglePass===!0&&(tt.forceSinglePass=!0),this.wireframe===!0&&(tt.wireframe=!0),this.wireframeLinewidth>1&&(tt.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(tt.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(tt.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(tt.flatShading=!0),this.visible===!1&&(tt.visible=!1),this.toneMapped===!1&&(tt.toneMapped=!1),this.fog===!1&&(tt.fog=!1),Object.keys(this.userData).length>0&&(tt.userData=this.userData);function nt(rt){const it=[];for(const st in rt){const ot=rt[st];delete ot.metadata,it.push(ot)}return it}if(_e){const rt=nt(_.textures),it=nt(_.images);rt.length>0&&(tt.textures=rt),it.length>0&&(tt.images=it)}return tt}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.blendColor.copy(_.blendColor),this.blendAlpha=_.blendAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const _e=_.clippingPlanes;let tt=null;if(_e!==null){const nt=_e.length;tt=new Array(nt);for(let rt=0;rt!==nt;++rt)tt[rt]=_e[rt].clone()}return this.clippingPlanes=tt,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaHash=_.alphaHash,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.forceSinglePass=_.forceSinglePass,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData=JSON.parse(JSON.stringify(_.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}}class MeshBasicMaterial extends Material{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}const _tables=_generateTables();function _generateTables(){const et=new ArrayBuffer(4),_=new Float32Array(et),_e=new Uint32Array(et),tt=new Uint32Array(512),nt=new Uint32Array(512);for(let ot=0;ot<256;++ot){const at=ot-127;at<-27?(tt[ot]=0,tt[ot|256]=32768,nt[ot]=24,nt[ot|256]=24):at<-14?(tt[ot]=1024>>-at-14,tt[ot|256]=1024>>-at-14|32768,nt[ot]=-at-1,nt[ot|256]=-at-1):at<=15?(tt[ot]=at+15<<10,tt[ot|256]=at+15<<10|32768,nt[ot]=13,nt[ot|256]=13):at<128?(tt[ot]=31744,tt[ot|256]=64512,nt[ot]=24,nt[ot|256]=24):(tt[ot]=31744,tt[ot|256]=64512,nt[ot]=13,nt[ot|256]=13)}const rt=new Uint32Array(2048),it=new Uint32Array(64),st=new Uint32Array(64);for(let ot=1;ot<1024;++ot){let at=ot<<13,lt=0;for(;!(at&8388608);)at<<=1,lt-=8388608;at&=-8388609,lt+=947912704,rt[ot]=at|lt}for(let ot=1024;ot<2048;++ot)rt[ot]=939524096+(ot-1024<<13);for(let ot=1;ot<31;++ot)it[ot]=ot<<23;it[31]=1199570944,it[32]=2147483648;for(let ot=33;ot<63;++ot)it[ot]=2147483648+(ot-32<<23);it[63]=3347054592;for(let ot=1;ot<64;++ot)ot!==32&&(st[ot]=1024);return{floatView:_,uint32View:_e,baseTable:tt,shiftTable:nt,mantissaTable:rt,exponentTable:it,offsetTable:st}}function toHalfFloat(et){Math.abs(et)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),et=clamp$1(et,-65504,65504),_tables.floatView[0]=et;const _=_tables.uint32View[0],_e=_>>23&511;return _tables.baseTable[_e]+((_&8388607)>>_tables.shiftTable[_e])}function fromHalfFloat(et){const _=et>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_]+(et&1023)]+_tables.exponentTable[_],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_,_e,tt=!1){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_,this.itemSize=_e,this.count=_!==void 0?_.length/_e:0,this.normalized=tt,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,_e){this.updateRanges.push({start:_,count:_e})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this.gpuType=_.gpuType,this}copyAt(_,_e,tt){_*=this.itemSize,tt*=_e.itemSize;for(let nt=0,rt=this.itemSize;nt<rt;nt++)this.array[_+nt]=_e.array[tt+nt];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let _e=0,tt=this.count;_e<tt;_e++)_vector2$1.fromBufferAttribute(this,_e),_vector2$1.applyMatrix3(_),this.setXY(_e,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let _e=0,tt=this.count;_e<tt;_e++)_vector$9.fromBufferAttribute(this,_e),_vector$9.applyMatrix3(_),this.setXYZ(_e,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_){for(let _e=0,tt=this.count;_e<tt;_e++)_vector$9.fromBufferAttribute(this,_e),_vector$9.applyMatrix4(_),this.setXYZ(_e,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_){for(let _e=0,tt=this.count;_e<tt;_e++)_vector$9.fromBufferAttribute(this,_e),_vector$9.applyNormalMatrix(_),this.setXYZ(_e,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_){for(let _e=0,tt=this.count;_e<tt;_e++)_vector$9.fromBufferAttribute(this,_e),_vector$9.transformDirection(_),this.setXYZ(_e,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_,_e=0){return this.array.set(_,_e),this}getComponent(_,_e){let tt=this.array[_*this.itemSize+_e];return this.normalized&&(tt=denormalize(tt,this.array)),tt}setComponent(_,_e,tt){return this.normalized&&(tt=normalize$1(tt,this.array)),this.array[_*this.itemSize+_e]=tt,this}getX(_){let _e=this.array[_*this.itemSize];return this.normalized&&(_e=denormalize(_e,this.array)),_e}setX(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize]=_e,this}getY(_){let _e=this.array[_*this.itemSize+1];return this.normalized&&(_e=denormalize(_e,this.array)),_e}setY(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize+1]=_e,this}getZ(_){let _e=this.array[_*this.itemSize+2];return this.normalized&&(_e=denormalize(_e,this.array)),_e}setZ(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize+2]=_e,this}getW(_){let _e=this.array[_*this.itemSize+3];return this.normalized&&(_e=denormalize(_e,this.array)),_e}setW(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize+3]=_e,this}setXY(_,_e,tt){return _*=this.itemSize,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array)),this.array[_+0]=_e,this.array[_+1]=tt,this}setXYZ(_,_e,tt,nt){return _*=this.itemSize,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array),nt=normalize$1(nt,this.array)),this.array[_+0]=_e,this.array[_+1]=tt,this.array[_+2]=nt,this}setXYZW(_,_e,tt,nt,rt){return _*=this.itemSize,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array),nt=normalize$1(nt,this.array),rt=normalize$1(rt,this.array)),this.array[_+0]=_e,this.array[_+1]=tt,this.array[_+2]=nt,this.array[_+3]=rt,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==StaticDrawUsage&&(_.usage=this.usage),_}}class Int8BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Int8Array(_),_e,tt)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Uint8Array(_),_e,tt)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Uint8ClampedArray(_),_e,tt)}}class Int16BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Int16Array(_),_e,tt)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Uint16Array(_),_e,tt)}}class Int32BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Int32Array(_),_e,tt)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Uint32Array(_),_e,tt)}}class Float16BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Uint16Array(_),_e,tt),this.isFloat16BufferAttribute=!0}getX(_){let _e=fromHalfFloat(this.array[_*this.itemSize]);return this.normalized&&(_e=denormalize(_e,this.array)),_e}setX(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize]=toHalfFloat(_e),this}getY(_){let _e=fromHalfFloat(this.array[_*this.itemSize+1]);return this.normalized&&(_e=denormalize(_e,this.array)),_e}setY(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize+1]=toHalfFloat(_e),this}getZ(_){let _e=fromHalfFloat(this.array[_*this.itemSize+2]);return this.normalized&&(_e=denormalize(_e,this.array)),_e}setZ(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize+2]=toHalfFloat(_e),this}getW(_){let _e=fromHalfFloat(this.array[_*this.itemSize+3]);return this.normalized&&(_e=denormalize(_e,this.array)),_e}setW(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.array[_*this.itemSize+3]=toHalfFloat(_e),this}setXY(_,_e,tt){return _*=this.itemSize,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array)),this.array[_+0]=toHalfFloat(_e),this.array[_+1]=toHalfFloat(tt),this}setXYZ(_,_e,tt,nt){return _*=this.itemSize,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array),nt=normalize$1(nt,this.array)),this.array[_+0]=toHalfFloat(_e),this.array[_+1]=toHalfFloat(tt),this.array[_+2]=toHalfFloat(nt),this}setXYZW(_,_e,tt,nt,rt){return _*=this.itemSize,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array),nt=normalize$1(nt,this.array),rt=normalize$1(rt,this.array)),this.array[_+0]=toHalfFloat(_e),this.array[_+1]=toHalfFloat(tt),this.array[_+2]=toHalfFloat(nt),this.array[_+3]=toHalfFloat(rt),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_,_e,tt){super(new Float32Array(_),_e,tt)}}let _id$2=0;const _m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID$1(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(arrayNeedsUint32(_)?Uint32BufferAttribute:Uint16BufferAttribute)(_,1):this.index=_,this}getAttribute(_){return this.attributes[_]}setAttribute(_,_e){return this.attributes[_]=_e,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,_e,tt=0){this.groups.push({start:_,count:_e,materialIndex:tt})}clearGroups(){this.groups=[]}setDrawRange(_,_e){this.drawRange.start=_,this.drawRange.count=_e}applyMatrix4(_){const _e=this.attributes.position;_e!==void 0&&(_e.applyMatrix4(_),_e.needsUpdate=!0);const tt=this.attributes.normal;if(tt!==void 0){const rt=new Matrix3().getNormalMatrix(_);tt.applyNormalMatrix(rt),tt.needsUpdate=!0}const nt=this.attributes.tangent;return nt!==void 0&&(nt.transformDirection(_),nt.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return _m1$2.makeRotationFromQuaternion(_),this.applyMatrix4(_m1$2),this}rotateX(_){return _m1$2.makeRotationX(_),this.applyMatrix4(_m1$2),this}rotateY(_){return _m1$2.makeRotationY(_),this.applyMatrix4(_m1$2),this}rotateZ(_){return _m1$2.makeRotationZ(_),this.applyMatrix4(_m1$2),this}translate(_,_e,tt){return _m1$2.makeTranslation(_,_e,tt),this.applyMatrix4(_m1$2),this}scale(_,_e,tt){return _m1$2.makeScale(_,_e,tt),this.applyMatrix4(_m1$2),this}lookAt(_){return _obj.lookAt(_),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_){const _e=[];for(let tt=0,nt=_.length;tt<nt;tt++){const rt=_[tt];_e.push(rt.x,rt.y,rt.z||0)}return this.setAttribute("position",new Float32BufferAttribute(_e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.attributes.position,_e=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),_e)for(let tt=0,nt=_e.length;tt<nt;tt++){const rt=_e[tt];_box$2.setFromBufferAttribute(rt),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _=this.attributes.position,_e=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(_){const tt=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(_),_e)for(let rt=0,it=_e.length;rt<it;rt++){const st=_e[rt];_boxMorphTargets.setFromBufferAttribute(st),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(tt);let nt=0;for(let rt=0,it=_.count;rt<it;rt++)_vector$8.fromBufferAttribute(_,rt),nt=Math.max(nt,tt.distanceToSquared(_vector$8));if(_e)for(let rt=0,it=_e.length;rt<it;rt++){const st=_e[rt],ot=this.morphTargetsRelative;for(let at=0,lt=st.count;at<lt;at++)_vector$8.fromBufferAttribute(st,at),ot&&(_offset.fromBufferAttribute(_,at),_vector$8.add(_offset)),nt=Math.max(nt,tt.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(nt),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,_e=this.attributes;if(_===null||_e.position===void 0||_e.normal===void 0||_e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const tt=_e.position,nt=_e.normal,rt=_e.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*tt.count),4));const it=this.getAttribute("tangent"),st=[],ot=[];for(let Mt=0;Mt<tt.count;Mt++)st[Mt]=new Vector3,ot[Mt]=new Vector3;const at=new Vector3,lt=new Vector3,ct=new Vector3,ht=new Vector2,ut=new Vector2,ft=new Vector2,dt=new Vector3,pt=new Vector3;function mt(Mt,Tt,wt){at.fromBufferAttribute(tt,Mt),lt.fromBufferAttribute(tt,Tt),ct.fromBufferAttribute(tt,wt),ht.fromBufferAttribute(rt,Mt),ut.fromBufferAttribute(rt,Tt),ft.fromBufferAttribute(rt,wt),lt.sub(at),ct.sub(at),ut.sub(ht),ft.sub(ht);const Ct=1/(ut.x*ft.y-ft.x*ut.y);isFinite(Ct)&&(dt.copy(lt).multiplyScalar(ft.y).addScaledVector(ct,-ut.y).multiplyScalar(Ct),pt.copy(ct).multiplyScalar(ut.x).addScaledVector(lt,-ft.x).multiplyScalar(Ct),st[Mt].add(dt),st[Tt].add(dt),st[wt].add(dt),ot[Mt].add(pt),ot[Tt].add(pt),ot[wt].add(pt))}let vt=this.groups;vt.length===0&&(vt=[{start:0,count:_.count}]);for(let Mt=0,Tt=vt.length;Mt<Tt;++Mt){const wt=vt[Mt],Ct=wt.start,Rt=wt.count;for(let It=Ct,Dt=Ct+Rt;It<Dt;It+=3)mt(_.getX(It+0),_.getX(It+1),_.getX(It+2))}const yt=new Vector3,_t=new Vector3,St=new Vector3,bt=new Vector3;function Et(Mt){St.fromBufferAttribute(nt,Mt),bt.copy(St);const Tt=st[Mt];yt.copy(Tt),yt.sub(St.multiplyScalar(St.dot(Tt))).normalize(),_t.crossVectors(bt,Tt);const Ct=_t.dot(ot[Mt])<0?-1:1;it.setXYZW(Mt,yt.x,yt.y,yt.z,Ct)}for(let Mt=0,Tt=vt.length;Mt<Tt;++Mt){const wt=vt[Mt],Ct=wt.start,Rt=wt.count;for(let It=Ct,Dt=Ct+Rt;It<Dt;It+=3)Et(_.getX(It+0)),Et(_.getX(It+1)),Et(_.getX(It+2))}}computeVertexNormals(){const _=this.index,_e=this.getAttribute("position");if(_e!==void 0){let tt=this.getAttribute("normal");if(tt===void 0)tt=new BufferAttribute(new Float32Array(_e.count*3),3),this.setAttribute("normal",tt);else for(let ht=0,ut=tt.count;ht<ut;ht++)tt.setXYZ(ht,0,0,0);const nt=new Vector3,rt=new Vector3,it=new Vector3,st=new Vector3,ot=new Vector3,at=new Vector3,lt=new Vector3,ct=new Vector3;if(_)for(let ht=0,ut=_.count;ht<ut;ht+=3){const ft=_.getX(ht+0),dt=_.getX(ht+1),pt=_.getX(ht+2);nt.fromBufferAttribute(_e,ft),rt.fromBufferAttribute(_e,dt),it.fromBufferAttribute(_e,pt),lt.subVectors(it,rt),ct.subVectors(nt,rt),lt.cross(ct),st.fromBufferAttribute(tt,ft),ot.fromBufferAttribute(tt,dt),at.fromBufferAttribute(tt,pt),st.add(lt),ot.add(lt),at.add(lt),tt.setXYZ(ft,st.x,st.y,st.z),tt.setXYZ(dt,ot.x,ot.y,ot.z),tt.setXYZ(pt,at.x,at.y,at.z)}else for(let ht=0,ut=_e.count;ht<ut;ht+=3)nt.fromBufferAttribute(_e,ht+0),rt.fromBufferAttribute(_e,ht+1),it.fromBufferAttribute(_e,ht+2),lt.subVectors(it,rt),ct.subVectors(nt,rt),lt.cross(ct),tt.setXYZ(ht+0,lt.x,lt.y,lt.z),tt.setXYZ(ht+1,lt.x,lt.y,lt.z),tt.setXYZ(ht+2,lt.x,lt.y,lt.z);this.normalizeNormals(),tt.needsUpdate=!0}}normalizeNormals(){const _=this.attributes.normal;for(let _e=0,tt=_.count;_e<tt;_e++)_vector$8.fromBufferAttribute(_,_e),_vector$8.normalize(),_.setXYZ(_e,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _(st,ot){const at=st.array,lt=st.itemSize,ct=st.normalized,ht=new at.constructor(ot.length*lt);let ut=0,ft=0;for(let dt=0,pt=ot.length;dt<pt;dt++){st.isInterleavedBufferAttribute?ut=ot[dt]*st.data.stride+st.offset:ut=ot[dt]*lt;for(let mt=0;mt<lt;mt++)ht[ft++]=at[ut++]}return new BufferAttribute(ht,lt,ct)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const _e=new BufferGeometry,tt=this.index.array,nt=this.attributes;for(const st in nt){const ot=nt[st],at=_(ot,tt);_e.setAttribute(st,at)}const rt=this.morphAttributes;for(const st in rt){const ot=[],at=rt[st];for(let lt=0,ct=at.length;lt<ct;lt++){const ht=at[lt],ut=_(ht,tt);ot.push(ut)}_e.morphAttributes[st]=ot}_e.morphTargetsRelative=this.morphTargetsRelative;const it=this.groups;for(let st=0,ot=it.length;st<ot;st++){const at=it[st];_e.addGroup(at.start,at.count,at.materialIndex)}return _e}toJSON(){const _={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const ot=this.parameters;for(const at in ot)ot[at]!==void 0&&(_[at]=ot[at]);return _}_.data={attributes:{}};const _e=this.index;_e!==null&&(_.data.index={type:_e.array.constructor.name,array:Array.prototype.slice.call(_e.array)});const tt=this.attributes;for(const ot in tt){const at=tt[ot];_.data.attributes[ot]=at.toJSON(_.data)}const nt={};let rt=!1;for(const ot in this.morphAttributes){const at=this.morphAttributes[ot],lt=[];for(let ct=0,ht=at.length;ct<ht;ct++){const ut=at[ct];lt.push(ut.toJSON(_.data))}lt.length>0&&(nt[ot]=lt,rt=!0)}rt&&(_.data.morphAttributes=nt,_.data.morphTargetsRelative=this.morphTargetsRelative);const it=this.groups;it.length>0&&(_.data.groups=JSON.parse(JSON.stringify(it)));const st=this.boundingSphere;return st!==null&&(_.data.boundingSphere={center:st.center.toArray(),radius:st.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const _e={};this.name=_.name;const tt=_.index;tt!==null&&this.setIndex(tt.clone(_e));const nt=_.attributes;for(const at in nt){const lt=nt[at];this.setAttribute(at,lt.clone(_e))}const rt=_.morphAttributes;for(const at in rt){const lt=[],ct=rt[at];for(let ht=0,ut=ct.length;ht<ut;ht++)lt.push(ct[ht].clone(_e));this.morphAttributes[at]=lt}this.morphTargetsRelative=_.morphTargetsRelative;const it=_.groups;for(let at=0,lt=it.length;at<lt;at++){const ct=it[at];this.addGroup(ct.start,ct.count,ct.materialIndex)}const st=_.boundingBox;st!==null&&(this.boundingBox=st.clone());const ot=_.boundingSphere;return ot!==null&&(this.boundingSphere=ot.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_=new BufferGeometry,_e=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=_e,this.updateMorphTargets()}copy(_,_e){return super.copy(_,_e),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}updateMorphTargets(){const _e=this.geometry.morphAttributes,tt=Object.keys(_e);if(tt.length>0){const nt=_e[tt[0]];if(nt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let rt=0,it=nt.length;rt<it;rt++){const st=nt[rt].name||String(rt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[st]=rt}}}}getVertexPosition(_,_e){const tt=this.geometry,nt=tt.attributes.position,rt=tt.morphAttributes.position,it=tt.morphTargetsRelative;_e.fromBufferAttribute(nt,_);const st=this.morphTargetInfluences;if(rt&&st){_morphA.set(0,0,0);for(let ot=0,at=rt.length;ot<at;ot++){const lt=st[ot],ct=rt[ot];lt!==0&&(_tempA.fromBufferAttribute(ct,_),it?_morphA.addScaledVector(_tempA,lt):_morphA.addScaledVector(_tempA.sub(_e),lt))}_e.add(_morphA)}return _e}raycast(_,_e){const tt=this.geometry,nt=this.material,rt=this.matrixWorld;nt!==void 0&&(tt.boundingSphere===null&&tt.computeBoundingSphere(),_sphere$6.copy(tt.boundingSphere),_sphere$6.applyMatrix4(rt),_ray$3.copy(_.ray).recast(_.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_.far-_.near)**2))&&(_inverseMatrix$3.copy(rt).invert(),_ray$3.copy(_.ray).applyMatrix4(_inverseMatrix$3),!(tt.boundingBox!==null&&_ray$3.intersectsBox(tt.boundingBox)===!1)&&this._computeIntersections(_,_e,_ray$3)))}_computeIntersections(_,_e,tt){let nt;const rt=this.geometry,it=this.material,st=rt.index,ot=rt.attributes.position,at=rt.attributes.uv,lt=rt.attributes.uv1,ct=rt.attributes.normal,ht=rt.groups,ut=rt.drawRange;if(st!==null)if(Array.isArray(it))for(let ft=0,dt=ht.length;ft<dt;ft++){const pt=ht[ft],mt=it[pt.materialIndex],vt=Math.max(pt.start,ut.start),yt=Math.min(st.count,Math.min(pt.start+pt.count,ut.start+ut.count));for(let _t=vt,St=yt;_t<St;_t+=3){const bt=st.getX(_t),Et=st.getX(_t+1),Mt=st.getX(_t+2);nt=checkGeometryIntersection(this,mt,_,tt,at,lt,ct,bt,Et,Mt),nt&&(nt.faceIndex=Math.floor(_t/3),nt.face.materialIndex=pt.materialIndex,_e.push(nt))}}else{const ft=Math.max(0,ut.start),dt=Math.min(st.count,ut.start+ut.count);for(let pt=ft,mt=dt;pt<mt;pt+=3){const vt=st.getX(pt),yt=st.getX(pt+1),_t=st.getX(pt+2);nt=checkGeometryIntersection(this,it,_,tt,at,lt,ct,vt,yt,_t),nt&&(nt.faceIndex=Math.floor(pt/3),_e.push(nt))}}else if(ot!==void 0)if(Array.isArray(it))for(let ft=0,dt=ht.length;ft<dt;ft++){const pt=ht[ft],mt=it[pt.materialIndex],vt=Math.max(pt.start,ut.start),yt=Math.min(ot.count,Math.min(pt.start+pt.count,ut.start+ut.count));for(let _t=vt,St=yt;_t<St;_t+=3){const bt=_t,Et=_t+1,Mt=_t+2;nt=checkGeometryIntersection(this,mt,_,tt,at,lt,ct,bt,Et,Mt),nt&&(nt.faceIndex=Math.floor(_t/3),nt.face.materialIndex=pt.materialIndex,_e.push(nt))}}else{const ft=Math.max(0,ut.start),dt=Math.min(ot.count,ut.start+ut.count);for(let pt=ft,mt=dt;pt<mt;pt+=3){const vt=pt,yt=pt+1,_t=pt+2;nt=checkGeometryIntersection(this,it,_,tt,at,lt,ct,vt,yt,_t),nt&&(nt.faceIndex=Math.floor(pt/3),_e.push(nt))}}}}function checkIntersection$1(et,_,_e,tt,nt,rt,it,st){let ot;if(_.side===BackSide?ot=tt.intersectTriangle(it,rt,nt,!0,st):ot=tt.intersectTriangle(nt,rt,it,_.side===FrontSide,st),ot===null)return null;_intersectionPointWorld.copy(st),_intersectionPointWorld.applyMatrix4(et.matrixWorld);const at=_e.ray.origin.distanceTo(_intersectionPointWorld);return at<_e.near||at>_e.far?null:{distance:at,point:_intersectionPointWorld.clone(),object:et}}function checkGeometryIntersection(et,_,_e,tt,nt,rt,it,st,ot,at){et.getVertexPosition(st,_vA$1),et.getVertexPosition(ot,_vB$1),et.getVertexPosition(at,_vC$1);const lt=checkIntersection$1(et,_,_e,tt,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(lt){nt&&(_uvA$1.fromBufferAttribute(nt,st),_uvB$1.fromBufferAttribute(nt,ot),_uvC$1.fromBufferAttribute(nt,at),lt.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),rt&&(_uvA$1.fromBufferAttribute(rt,st),_uvB$1.fromBufferAttribute(rt,ot),_uvC$1.fromBufferAttribute(rt,at),lt.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),it&&(_normalA.fromBufferAttribute(it,st),_normalB.fromBufferAttribute(it,ot),_normalC.fromBufferAttribute(it,at),lt.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),lt.normal.dot(tt.direction)>0&&lt.normal.multiplyScalar(-1));const ct={a:st,b:ot,c:at,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,ct.normal),lt.face=ct}return lt}class BoxGeometry extends BufferGeometry{constructor(_=1,_e=1,tt=1,nt=1,rt=1,it=1){super(),this.type="BoxGeometry",this.parameters={width:_,height:_e,depth:tt,widthSegments:nt,heightSegments:rt,depthSegments:it};const st=this;nt=Math.floor(nt),rt=Math.floor(rt),it=Math.floor(it);const ot=[],at=[],lt=[],ct=[];let ht=0,ut=0;ft("z","y","x",-1,-1,tt,_e,_,it,rt,0),ft("z","y","x",1,-1,tt,_e,-_,it,rt,1),ft("x","z","y",1,1,_,tt,_e,nt,it,2),ft("x","z","y",1,-1,_,tt,-_e,nt,it,3),ft("x","y","z",1,-1,_,_e,tt,nt,rt,4),ft("x","y","z",-1,-1,_,_e,-tt,nt,rt,5),this.setIndex(ot),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("normal",new Float32BufferAttribute(lt,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2));function ft(dt,pt,mt,vt,yt,_t,St,bt,Et,Mt,Tt){const wt=_t/Et,Ct=St/Mt,Rt=_t/2,It=St/2,Dt=bt/2,Ft=Et+1,$t=Mt+1;let Yt=0,Lt=0;const Ot=new Vector3;for(let Nt=0;Nt<$t;Nt++){const zt=Nt*Ct-It;for(let Ht=0;Ht<Ft;Ht++){const qt=Ht*wt-Rt;Ot[dt]=qt*vt,Ot[pt]=zt*yt,Ot[mt]=Dt,at.push(Ot.x,Ot.y,Ot.z),Ot[dt]=0,Ot[pt]=0,Ot[mt]=bt>0?1:-1,lt.push(Ot.x,Ot.y,Ot.z),ct.push(Ht/Et),ct.push(1-Nt/Mt),Yt+=1}}for(let Nt=0;Nt<Mt;Nt++)for(let zt=0;zt<Et;zt++){const Ht=ht+zt+Ft*Nt,qt=ht+zt+Ft*(Nt+1),Gt=ht+(zt+1)+Ft*(Nt+1),Xt=ht+(zt+1)+Ft*Nt;ot.push(Ht,qt,Xt),ot.push(qt,Gt,Xt),Lt+=6}st.addGroup(ut,Lt,Tt),ut+=Lt,ht+=Yt}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new BoxGeometry(_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments)}}function cloneUniforms(et){const _={};for(const _e in et){_[_e]={};for(const tt in et[_e]){const nt=et[_e][tt];nt&&(nt.isColor||nt.isMatrix3||nt.isMatrix4||nt.isVector2||nt.isVector3||nt.isVector4||nt.isTexture||nt.isQuaternion)?nt.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_[_e][tt]=null):_[_e][tt]=nt.clone():Array.isArray(nt)?_[_e][tt]=nt.slice():_[_e][tt]=nt}}return _}function mergeUniforms(et){const _={};for(let _e=0;_e<et.length;_e++){const tt=cloneUniforms(et[_e]);for(const nt in tt)_[nt]=tt[nt]}return _}function cloneUniformsGroups(et){const _=[];for(let _e=0;_e<et.length;_e++)_.push(et[_e].clone());return _}function getUnlitUniformColorSpace(et){const _=et.getRenderTarget();return _===null?et.outputColorSpace:_.isXRRenderTarget===!0?_.texture.colorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_!==void 0&&this.setValues(_)}copy(_){return super.copy(_),this.fragmentShader=_.fragmentShader,this.vertexShader=_.vertexShader,this.uniforms=cloneUniforms(_.uniforms),this.uniformsGroups=cloneUniformsGroups(_.uniformsGroups),this.defines=Object.assign({},_.defines),this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.fog=_.fog,this.lights=_.lights,this.clipping=_.clipping,this.extensions=Object.assign({},_.extensions),this.glslVersion=_.glslVersion,this}toJSON(_){const _e=super.toJSON(_);_e.glslVersion=this.glslVersion,_e.uniforms={};for(const nt in this.uniforms){const it=this.uniforms[nt].value;it&&it.isTexture?_e.uniforms[nt]={type:"t",value:it.toJSON(_).uuid}:it&&it.isColor?_e.uniforms[nt]={type:"c",value:it.getHex()}:it&&it.isVector2?_e.uniforms[nt]={type:"v2",value:it.toArray()}:it&&it.isVector3?_e.uniforms[nt]={type:"v3",value:it.toArray()}:it&&it.isVector4?_e.uniforms[nt]={type:"v4",value:it.toArray()}:it&&it.isMatrix3?_e.uniforms[nt]={type:"m3",value:it.toArray()}:it&&it.isMatrix4?_e.uniforms[nt]={type:"m4",value:it.toArray()}:_e.uniforms[nt]={value:it}}Object.keys(this.defines).length>0&&(_e.defines=this.defines),_e.vertexShader=this.vertexShader,_e.fragmentShader=this.fragmentShader,_e.lights=this.lights,_e.clipping=this.clipping;const tt={};for(const nt in this.extensions)this.extensions[nt]===!0&&(tt[nt]=!0);return Object.keys(tt).length>0&&(_e.extensions=tt),_e}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_,_e){return super.copy(_,_e),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this.coordinateSystem=_.coordinateSystem,this}getWorldDirection(_){return super.getWorldDirection(_).negate()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,_e){super.updateWorldMatrix(_,_e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;class PerspectiveCamera extends Camera{constructor(_=50,_e=1,tt=.1,nt=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=tt,this.far=nt,this.focus=10,this.aspect=_e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,_e){return super.copy(_,_e),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const _e=.5*this.getFilmHeight()/_;this.fov=RAD2DEG*2*Math.atan(_e),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_,_e,tt){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),_e.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),tt.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z)}getViewSize(_,_e){return this.getViewBounds(_,_minTarget,_maxTarget),_e.subVectors(_maxTarget,_minTarget)}setViewOffset(_,_e,tt,nt,rt,it){this.aspect=_/_e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=_e,this.view.offsetX=tt,this.view.offsetY=nt,this.view.width=rt,this.view.height=it,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let _e=_*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,tt=2*_e,nt=this.aspect*tt,rt=-.5*nt;const it=this.view;if(this.view!==null&&this.view.enabled){const ot=it.fullWidth,at=it.fullHeight;rt+=it.offsetX*nt/ot,_e-=it.offsetY*tt/at,nt*=it.width/ot,tt*=it.height/at}const st=this.filmOffset;st!==0&&(rt+=_*st/this.getFilmWidth()),this.projectionMatrix.makePerspective(rt,rt+nt,_e,_e-tt,_,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const _e=super.toJSON(_);return _e.object.fov=this.fov,_e.object.zoom=this.zoom,_e.object.near=this.near,_e.object.far=this.far,_e.object.focus=this.focus,_e.object.aspect=this.aspect,this.view!==null&&(_e.object.view=Object.assign({},this.view)),_e.object.filmGauge=this.filmGauge,_e.object.filmOffset=this.filmOffset,_e}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_,_e,tt){super(),this.type="CubeCamera",this.renderTarget=tt,this.coordinateSystem=null,this.activeMipmapLevel=0;const nt=new PerspectiveCamera(fov,aspect,_,_e);nt.layers=this.layers,this.add(nt);const rt=new PerspectiveCamera(fov,aspect,_,_e);rt.layers=this.layers,this.add(rt);const it=new PerspectiveCamera(fov,aspect,_,_e);it.layers=this.layers,this.add(it);const st=new PerspectiveCamera(fov,aspect,_,_e);st.layers=this.layers,this.add(st);const ot=new PerspectiveCamera(fov,aspect,_,_e);ot.layers=this.layers,this.add(ot);const at=new PerspectiveCamera(fov,aspect,_,_e);at.layers=this.layers,this.add(at)}updateCoordinateSystem(){const _=this.coordinateSystem,_e=this.children.concat(),[tt,nt,rt,it,st,ot]=_e;for(const at of _e)this.remove(at);if(_===WebGLCoordinateSystem)tt.up.set(0,1,0),tt.lookAt(1,0,0),nt.up.set(0,1,0),nt.lookAt(-1,0,0),rt.up.set(0,0,-1),rt.lookAt(0,1,0),it.up.set(0,0,1),it.lookAt(0,-1,0),st.up.set(0,1,0),st.lookAt(0,0,1),ot.up.set(0,1,0),ot.lookAt(0,0,-1);else if(_===WebGPUCoordinateSystem)tt.up.set(0,-1,0),tt.lookAt(-1,0,0),nt.up.set(0,-1,0),nt.lookAt(1,0,0),rt.up.set(0,0,1),rt.lookAt(0,1,0),it.up.set(0,0,-1),it.lookAt(0,-1,0),st.up.set(0,-1,0),st.lookAt(0,0,1),ot.up.set(0,-1,0),ot.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_);for(const at of _e)this.add(at),at.updateMatrixWorld()}update(_,_e){this.parent===null&&this.updateMatrixWorld();const{renderTarget:tt,activeMipmapLevel:nt}=this;this.coordinateSystem!==_.coordinateSystem&&(this.coordinateSystem=_.coordinateSystem,this.updateCoordinateSystem());const[rt,it,st,ot,at,lt]=this.children,ct=_.getRenderTarget(),ht=_.getActiveCubeFace(),ut=_.getActiveMipmapLevel(),ft=_.xr.enabled;_.xr.enabled=!1;const dt=tt.texture.generateMipmaps;tt.texture.generateMipmaps=!1,_.setRenderTarget(tt,0,nt),_.render(_e,rt),_.setRenderTarget(tt,1,nt),_.render(_e,it),_.setRenderTarget(tt,2,nt),_.render(_e,st),_.setRenderTarget(tt,3,nt),_.render(_e,ot),_.setRenderTarget(tt,4,nt),_.render(_e,at),tt.texture.generateMipmaps=dt,_.setRenderTarget(tt,5,nt),_.render(_e,lt),_.setRenderTarget(ct,ht,ut),_.xr.enabled=ft,tt.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture$1{constructor(_,_e,tt,nt,rt,it,st,ot,at,lt){_=_!==void 0?_:[],_e=_e!==void 0?_e:CubeReflectionMapping,super(_,_e,tt,nt,rt,it,st,ot,at,lt),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_){this.image=_}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_=1,_e={}){super(_,_,_e),this.isWebGLCubeRenderTarget=!0;const tt={width:_,height:_,depth:1},nt=[tt,tt,tt,tt,tt,tt];this.texture=new CubeTexture(nt,_e.mapping,_e.wrapS,_e.wrapT,_e.magFilter,_e.minFilter,_e.format,_e.type,_e.anisotropy,_e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=_e.generateMipmaps!==void 0?_e.generateMipmaps:!1,this.texture.minFilter=_e.minFilter!==void 0?_e.minFilter:LinearFilter}fromEquirectangularTexture(_,_e){this.texture.type=_e.type,this.texture.colorSpace=_e.colorSpace,this.texture.generateMipmaps=_e.generateMipmaps,this.texture.minFilter=_e.minFilter,this.texture.magFilter=_e.magFilter;const tt={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},nt=new BoxGeometry(5,5,5),rt=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(tt.uniforms),vertexShader:tt.vertexShader,fragmentShader:tt.fragmentShader,side:BackSide,blending:NoBlending});rt.uniforms.tEquirect.value=_e;const it=new Mesh(nt,rt),st=_e.minFilter;return _e.minFilter===LinearMipmapLinearFilter&&(_e.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_,it),_e.minFilter=st,it.geometry.dispose(),it.material.dispose(),this}clear(_,_e,tt,nt){const rt=_.getRenderTarget();for(let it=0;it<6;it++)_.setRenderTarget(this,it),_.clear(_e,tt,nt);_.setRenderTarget(rt)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_=new Vector3(1,0,0),_e=0){this.isPlane=!0,this.normal=_,this.constant=_e}set(_,_e){return this.normal.copy(_),this.constant=_e,this}setComponents(_,_e,tt,nt){return this.normal.set(_,_e,tt),this.constant=nt,this}setFromNormalAndCoplanarPoint(_,_e){return this.normal.copy(_),this.constant=-_e.dot(this.normal),this}setFromCoplanarPoints(_,_e,tt){const nt=_vector1.subVectors(tt,_e).cross(_vector2.subVectors(_,_e)).normalize();return this.setFromNormalAndCoplanarPoint(nt,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,_e){return _e.copy(_).addScaledVector(this.normal,-this.distanceToPoint(_))}intersectLine(_,_e){const tt=_.delta(_vector1),nt=this.normal.dot(tt);if(nt===0)return this.distanceToPoint(_.start)===0?_e.copy(_.start):null;const rt=-(_.start.dot(this.normal)+this.constant)/nt;return rt<0||rt>1?null:_e.copy(_.start).addScaledVector(tt,rt)}intersectsLine(_){const _e=this.distanceToPoint(_.start),tt=this.distanceToPoint(_.end);return _e<0&&tt>0||tt<0&&_e>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,_e){const tt=_e||_normalMatrix.getNormalMatrix(_),nt=this.coplanarPoint(_vector1).applyMatrix4(_),rt=this.normal.applyMatrix3(tt).normalize();return this.constant=-nt.dot(rt),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(_=new Plane,_e=new Plane,tt=new Plane,nt=new Plane,rt=new Plane,it=new Plane){this.planes=[_,_e,tt,nt,rt,it]}set(_,_e,tt,nt,rt,it){const st=this.planes;return st[0].copy(_),st[1].copy(_e),st[2].copy(tt),st[3].copy(nt),st[4].copy(rt),st[5].copy(it),this}copy(_){const _e=this.planes;for(let tt=0;tt<6;tt++)_e[tt].copy(_.planes[tt]);return this}setFromProjectionMatrix(_,_e=WebGLCoordinateSystem){const tt=this.planes,nt=_.elements,rt=nt[0],it=nt[1],st=nt[2],ot=nt[3],at=nt[4],lt=nt[5],ct=nt[6],ht=nt[7],ut=nt[8],ft=nt[9],dt=nt[10],pt=nt[11],mt=nt[12],vt=nt[13],yt=nt[14],_t=nt[15];if(tt[0].setComponents(ot-rt,ht-at,pt-ut,_t-mt).normalize(),tt[1].setComponents(ot+rt,ht+at,pt+ut,_t+mt).normalize(),tt[2].setComponents(ot+it,ht+lt,pt+ft,_t+vt).normalize(),tt[3].setComponents(ot-it,ht-lt,pt-ft,_t-vt).normalize(),tt[4].setComponents(ot-st,ht-ct,pt-dt,_t-yt).normalize(),_e===WebGLCoordinateSystem)tt[5].setComponents(ot+st,ht+ct,pt+dt,_t+yt).normalize();else if(_e===WebGPUCoordinateSystem)tt[5].setComponents(st,ct,dt,yt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+_e);return this}intersectsObject(_){if(_.boundingSphere!==void 0)_.boundingSphere===null&&_.computeBoundingSphere(),_sphere$5.copy(_.boundingSphere).applyMatrix4(_.matrixWorld);else{const _e=_.geometry;_e.boundingSphere===null&&_e.computeBoundingSphere(),_sphere$5.copy(_e.boundingSphere).applyMatrix4(_.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(_){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(_){const _e=this.planes,tt=_.center,nt=-_.radius;for(let rt=0;rt<6;rt++)if(_e[rt].distanceToPoint(tt)<nt)return!1;return!0}intersectsBox(_){const _e=this.planes;for(let tt=0;tt<6;tt++){const nt=_e[tt];if(_vector$7.x=nt.normal.x>0?_.max.x:_.min.x,_vector$7.y=nt.normal.y>0?_.max.y:_.min.y,_vector$7.z=nt.normal.z>0?_.max.z:_.min.z,nt.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(_){const _e=this.planes;for(let tt=0;tt<6;tt++)if(_e[tt].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let et=null,_=!1,_e=null,tt=null;function nt(rt,it){_e(rt,it),tt=et.requestAnimationFrame(nt)}return{start:function(){_!==!0&&_e!==null&&(tt=et.requestAnimationFrame(nt),_=!0)},stop:function(){et.cancelAnimationFrame(tt),_=!1},setAnimationLoop:function(rt){_e=rt},setContext:function(rt){et=rt}}}function WebGLAttributes(et){const _=new WeakMap;function _e(st,ot){const at=st.array,lt=st.usage,ct=at.byteLength,ht=et.createBuffer();et.bindBuffer(ot,ht),et.bufferData(ot,at,lt),st.onUploadCallback();let ut;if(at instanceof Float32Array)ut=et.FLOAT;else if(at instanceof Uint16Array)st.isFloat16BufferAttribute?ut=et.HALF_FLOAT:ut=et.UNSIGNED_SHORT;else if(at instanceof Int16Array)ut=et.SHORT;else if(at instanceof Uint32Array)ut=et.UNSIGNED_INT;else if(at instanceof Int32Array)ut=et.INT;else if(at instanceof Int8Array)ut=et.BYTE;else if(at instanceof Uint8Array)ut=et.UNSIGNED_BYTE;else if(at instanceof Uint8ClampedArray)ut=et.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+at);return{buffer:ht,type:ut,bytesPerElement:at.BYTES_PER_ELEMENT,version:st.version,size:ct}}function tt(st,ot,at){const lt=ot.array,ct=ot._updateRange,ht=ot.updateRanges;if(et.bindBuffer(at,st),ct.count===-1&&ht.length===0&&et.bufferSubData(at,0,lt),ht.length!==0){for(let ut=0,ft=ht.length;ut<ft;ut++){const dt=ht[ut];et.bufferSubData(at,dt.start*lt.BYTES_PER_ELEMENT,lt,dt.start,dt.count)}ot.clearUpdateRanges()}ct.count!==-1&&(et.bufferSubData(at,ct.offset*lt.BYTES_PER_ELEMENT,lt,ct.offset,ct.count),ct.count=-1),ot.onUploadCallback()}function nt(st){return st.isInterleavedBufferAttribute&&(st=st.data),_.get(st)}function rt(st){st.isInterleavedBufferAttribute&&(st=st.data);const ot=_.get(st);ot&&(et.deleteBuffer(ot.buffer),_.delete(st))}function it(st,ot){if(st.isGLBufferAttribute){const lt=_.get(st);(!lt||lt.version<st.version)&&_.set(st,{buffer:st.buffer,type:st.type,bytesPerElement:st.elementSize,version:st.version});return}st.isInterleavedBufferAttribute&&(st=st.data);const at=_.get(st);if(at===void 0)_.set(st,_e(st,ot));else if(at.version<st.version){if(at.size!==st.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");tt(at.buffer,st,ot),at.version=st.version}}return{get:nt,remove:rt,update:it}}class PlaneGeometry extends BufferGeometry{constructor(_=1,_e=1,tt=1,nt=1){super(),this.type="PlaneGeometry",this.parameters={width:_,height:_e,widthSegments:tt,heightSegments:nt};const rt=_/2,it=_e/2,st=Math.floor(tt),ot=Math.floor(nt),at=st+1,lt=ot+1,ct=_/st,ht=_e/ot,ut=[],ft=[],dt=[],pt=[];for(let mt=0;mt<lt;mt++){const vt=mt*ht-it;for(let yt=0;yt<at;yt++){const _t=yt*ct-rt;ft.push(_t,-vt,0),dt.push(0,0,1),pt.push(yt/st),pt.push(1-mt/ot)}}for(let mt=0;mt<ot;mt++)for(let vt=0;vt<st;vt++){const yt=vt+at*mt,_t=vt+at*(mt+1),St=vt+1+at*(mt+1),bt=vt+1+at*mt;ut.push(yt,_t,bt),ut.push(_t,St,bt)}this.setIndex(ut),this.setAttribute("position",new Float32BufferAttribute(ft,3)),this.setAttribute("normal",new Float32BufferAttribute(dt,3)),this.setAttribute("uv",new Float32BufferAttribute(pt,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PlaneGeometry(_.width,_.height,_.widthSegments,_.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,common$1=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphinstance_vertex=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common:common$1,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},specular:{value:new Color$1(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$1(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color$1(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color$1(0)},specularColor:{value:new Color$1(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler,_m1$1=new Matrix4;function WebGLBackground(et,_,_e,tt,nt,rt,it){const st=new Color$1(0);let ot=rt===!0?0:1,at,lt,ct=null,ht=0,ut=null;function ft(vt){let yt=vt.isScene===!0?vt.background:null;return yt&&yt.isTexture&&(yt=(vt.backgroundBlurriness>0?_e:_).get(yt)),yt}function dt(vt){let yt=!1;const _t=ft(vt);_t===null?mt(st,ot):_t&&_t.isColor&&(mt(_t,1),yt=!0);const St=et.xr.getEnvironmentBlendMode();St==="additive"?tt.buffers.color.setClear(0,0,0,1,it):St==="alpha-blend"&&tt.buffers.color.setClear(0,0,0,0,it),(et.autoClear||yt)&&(tt.buffers.depth.setTest(!0),tt.buffers.depth.setMask(!0),tt.buffers.color.setMask(!0),et.clear(et.autoClearColor,et.autoClearDepth,et.autoClearStencil))}function pt(vt,yt){const _t=ft(yt);_t&&(_t.isCubeTexture||_t.mapping===CubeUVReflectionMapping)?(lt===void 0&&(lt=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),lt.geometry.deleteAttribute("normal"),lt.geometry.deleteAttribute("uv"),lt.onBeforeRender=function(St,bt,Et){this.matrixWorld.copyPosition(Et.matrixWorld)},Object.defineProperty(lt.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),nt.update(lt)),_e1$1.copy(yt.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,_t.isCubeTexture&&_t.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),lt.material.uniforms.envMap.value=_t,lt.material.uniforms.flipEnvMap.value=_t.isCubeTexture&&_t.isRenderTargetTexture===!1?-1:1,lt.material.uniforms.backgroundBlurriness.value=yt.backgroundBlurriness,lt.material.uniforms.backgroundIntensity.value=yt.backgroundIntensity,lt.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1.makeRotationFromEuler(_e1$1)),lt.material.toneMapped=ColorManagement.getTransfer(_t.colorSpace)!==SRGBTransfer,(ct!==_t||ht!==_t.version||ut!==et.toneMapping)&&(lt.material.needsUpdate=!0,ct=_t,ht=_t.version,ut=et.toneMapping),lt.layers.enableAll(),vt.unshift(lt,lt.geometry,lt.material,0,0,null)):_t&&_t.isTexture&&(at===void 0&&(at=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),at.geometry.deleteAttribute("normal"),Object.defineProperty(at.material,"map",{get:function(){return this.uniforms.t2D.value}}),nt.update(at)),at.material.uniforms.t2D.value=_t,at.material.uniforms.backgroundIntensity.value=yt.backgroundIntensity,at.material.toneMapped=ColorManagement.getTransfer(_t.colorSpace)!==SRGBTransfer,_t.matrixAutoUpdate===!0&&_t.updateMatrix(),at.material.uniforms.uvTransform.value.copy(_t.matrix),(ct!==_t||ht!==_t.version||ut!==et.toneMapping)&&(at.material.needsUpdate=!0,ct=_t,ht=_t.version,ut=et.toneMapping),at.layers.enableAll(),vt.unshift(at,at.geometry,at.material,0,0,null))}function mt(vt,yt){vt.getRGB(_rgb,getUnlitUniformColorSpace(et)),tt.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,yt,it)}return{getClearColor:function(){return st},setClearColor:function(vt,yt=1){st.set(vt),ot=yt,mt(st,ot)},getClearAlpha:function(){return ot},setClearAlpha:function(vt){ot=vt,mt(st,ot)},render:dt,addToRenderList:pt}}function WebGLBindingStates(et,_){const _e=et.getParameter(et.MAX_VERTEX_ATTRIBS),tt={},nt=ht(null);let rt=nt,it=!1;function st(wt,Ct,Rt,It,Dt){let Ft=!1;const $t=ct(It,Rt,Ct);rt!==$t&&(rt=$t,at(rt.object)),Ft=ut(wt,It,Rt,Dt),Ft&&ft(wt,It,Rt,Dt),Dt!==null&&_.update(Dt,et.ELEMENT_ARRAY_BUFFER),(Ft||it)&&(it=!1,_t(wt,Ct,Rt,It),Dt!==null&&et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,_.get(Dt).buffer))}function ot(){return et.createVertexArray()}function at(wt){return et.bindVertexArray(wt)}function lt(wt){return et.deleteVertexArray(wt)}function ct(wt,Ct,Rt){const It=Rt.wireframe===!0;let Dt=tt[wt.id];Dt===void 0&&(Dt={},tt[wt.id]=Dt);let Ft=Dt[Ct.id];Ft===void 0&&(Ft={},Dt[Ct.id]=Ft);let $t=Ft[It];return $t===void 0&&($t=ht(ot()),Ft[It]=$t),$t}function ht(wt){const Ct=[],Rt=[],It=[];for(let Dt=0;Dt<_e;Dt++)Ct[Dt]=0,Rt[Dt]=0,It[Dt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ct,enabledAttributes:Rt,attributeDivisors:It,object:wt,attributes:{},index:null}}function ut(wt,Ct,Rt,It){const Dt=rt.attributes,Ft=Ct.attributes;let $t=0;const Yt=Rt.getAttributes();for(const Lt in Yt)if(Yt[Lt].location>=0){const Nt=Dt[Lt];let zt=Ft[Lt];if(zt===void 0&&(Lt==="instanceMatrix"&&wt.instanceMatrix&&(zt=wt.instanceMatrix),Lt==="instanceColor"&&wt.instanceColor&&(zt=wt.instanceColor)),Nt===void 0||Nt.attribute!==zt||zt&&Nt.data!==zt.data)return!0;$t++}return rt.attributesNum!==$t||rt.index!==It}function ft(wt,Ct,Rt,It){const Dt={},Ft=Ct.attributes;let $t=0;const Yt=Rt.getAttributes();for(const Lt in Yt)if(Yt[Lt].location>=0){let Nt=Ft[Lt];Nt===void 0&&(Lt==="instanceMatrix"&&wt.instanceMatrix&&(Nt=wt.instanceMatrix),Lt==="instanceColor"&&wt.instanceColor&&(Nt=wt.instanceColor));const zt={};zt.attribute=Nt,Nt&&Nt.data&&(zt.data=Nt.data),Dt[Lt]=zt,$t++}rt.attributes=Dt,rt.attributesNum=$t,rt.index=It}function dt(){const wt=rt.newAttributes;for(let Ct=0,Rt=wt.length;Ct<Rt;Ct++)wt[Ct]=0}function pt(wt){mt(wt,0)}function mt(wt,Ct){const Rt=rt.newAttributes,It=rt.enabledAttributes,Dt=rt.attributeDivisors;Rt[wt]=1,It[wt]===0&&(et.enableVertexAttribArray(wt),It[wt]=1),Dt[wt]!==Ct&&(et.vertexAttribDivisor(wt,Ct),Dt[wt]=Ct)}function vt(){const wt=rt.newAttributes,Ct=rt.enabledAttributes;for(let Rt=0,It=Ct.length;Rt<It;Rt++)Ct[Rt]!==wt[Rt]&&(et.disableVertexAttribArray(Rt),Ct[Rt]=0)}function yt(wt,Ct,Rt,It,Dt,Ft,$t){$t===!0?et.vertexAttribIPointer(wt,Ct,Rt,Dt,Ft):et.vertexAttribPointer(wt,Ct,Rt,It,Dt,Ft)}function _t(wt,Ct,Rt,It){dt();const Dt=It.attributes,Ft=Rt.getAttributes(),$t=Ct.defaultAttributeValues;for(const Yt in Ft){const Lt=Ft[Yt];if(Lt.location>=0){let Ot=Dt[Yt];if(Ot===void 0&&(Yt==="instanceMatrix"&&wt.instanceMatrix&&(Ot=wt.instanceMatrix),Yt==="instanceColor"&&wt.instanceColor&&(Ot=wt.instanceColor)),Ot!==void 0){const Nt=Ot.normalized,zt=Ot.itemSize,Ht=_.get(Ot);if(Ht===void 0)continue;const qt=Ht.buffer,Gt=Ht.type,Xt=Ht.bytesPerElement,Zt=Gt===et.INT||Gt===et.UNSIGNED_INT||Ot.gpuType===IntType;if(Ot.isInterleavedBufferAttribute){const Qt=Ot.data,un=Qt.stride,wn=Ot.offset;if(Qt.isInstancedInterleavedBuffer){for(let Tn=0;Tn<Lt.locationSize;Tn++)mt(Lt.location+Tn,Qt.meshPerAttribute);wt.isInstancedMesh!==!0&&It._maxInstanceCount===void 0&&(It._maxInstanceCount=Qt.meshPerAttribute*Qt.count)}else for(let Tn=0;Tn<Lt.locationSize;Tn++)pt(Lt.location+Tn);et.bindBuffer(et.ARRAY_BUFFER,qt);for(let Tn=0;Tn<Lt.locationSize;Tn++)yt(Lt.location+Tn,zt/Lt.locationSize,Gt,Nt,un*Xt,(wn+zt/Lt.locationSize*Tn)*Xt,Zt)}else{if(Ot.isInstancedBufferAttribute){for(let Qt=0;Qt<Lt.locationSize;Qt++)mt(Lt.location+Qt,Ot.meshPerAttribute);wt.isInstancedMesh!==!0&&It._maxInstanceCount===void 0&&(It._maxInstanceCount=Ot.meshPerAttribute*Ot.count)}else for(let Qt=0;Qt<Lt.locationSize;Qt++)pt(Lt.location+Qt);et.bindBuffer(et.ARRAY_BUFFER,qt);for(let Qt=0;Qt<Lt.locationSize;Qt++)yt(Lt.location+Qt,zt/Lt.locationSize,Gt,Nt,zt*Xt,zt/Lt.locationSize*Qt*Xt,Zt)}}else if($t!==void 0){const Nt=$t[Yt];if(Nt!==void 0)switch(Nt.length){case 2:et.vertexAttrib2fv(Lt.location,Nt);break;case 3:et.vertexAttrib3fv(Lt.location,Nt);break;case 4:et.vertexAttrib4fv(Lt.location,Nt);break;default:et.vertexAttrib1fv(Lt.location,Nt)}}}}vt()}function St(){Mt();for(const wt in tt){const Ct=tt[wt];for(const Rt in Ct){const It=Ct[Rt];for(const Dt in It)lt(It[Dt].object),delete It[Dt];delete Ct[Rt]}delete tt[wt]}}function bt(wt){if(tt[wt.id]===void 0)return;const Ct=tt[wt.id];for(const Rt in Ct){const It=Ct[Rt];for(const Dt in It)lt(It[Dt].object),delete It[Dt];delete Ct[Rt]}delete tt[wt.id]}function Et(wt){for(const Ct in tt){const Rt=tt[Ct];if(Rt[wt.id]===void 0)continue;const It=Rt[wt.id];for(const Dt in It)lt(It[Dt].object),delete It[Dt];delete Rt[wt.id]}}function Mt(){Tt(),it=!0,rt!==nt&&(rt=nt,at(rt.object))}function Tt(){nt.geometry=null,nt.program=null,nt.wireframe=!1}return{setup:st,reset:Mt,resetDefaultState:Tt,dispose:St,releaseStatesOfGeometry:bt,releaseStatesOfProgram:Et,initAttributes:dt,enableAttribute:pt,disableUnusedAttributes:vt}}function WebGLBufferRenderer(et,_,_e){let tt;function nt(at){tt=at}function rt(at,lt){et.drawArrays(tt,at,lt),_e.update(lt,tt,1)}function it(at,lt,ct){ct!==0&&(et.drawArraysInstanced(tt,at,lt,ct),_e.update(lt,tt,ct))}function st(at,lt,ct){if(ct===0)return;_.get("WEBGL_multi_draw").multiDrawArraysWEBGL(tt,at,0,lt,0,ct);let ut=0;for(let ft=0;ft<ct;ft++)ut+=lt[ft];_e.update(ut,tt,1)}function ot(at,lt,ct,ht){if(ct===0)return;const ut=_.get("WEBGL_multi_draw");if(ut===null)for(let ft=0;ft<at.length;ft++)it(at[ft],lt[ft],ht[ft]);else{ut.multiDrawArraysInstancedWEBGL(tt,at,0,lt,0,ht,0,ct);let ft=0;for(let dt=0;dt<ct;dt++)ft+=lt[dt];for(let dt=0;dt<ht.length;dt++)_e.update(ft,tt,ht[dt])}}this.setMode=nt,this.render=rt,this.renderInstances=it,this.renderMultiDraw=st,this.renderMultiDrawInstances=ot}function WebGLCapabilities(et,_,_e,tt){let nt;function rt(){if(nt!==void 0)return nt;if(_.has("EXT_texture_filter_anisotropic")===!0){const bt=_.get("EXT_texture_filter_anisotropic");nt=et.getParameter(bt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else nt=0;return nt}function it(bt){return!(bt!==RGBAFormat&&tt.convert(bt)!==et.getParameter(et.IMPLEMENTATION_COLOR_READ_FORMAT))}function st(bt){const Et=bt===HalfFloatType&&(_.has("EXT_color_buffer_half_float")||_.has("EXT_color_buffer_float"));return!(bt!==UnsignedByteType&&tt.convert(bt)!==et.getParameter(et.IMPLEMENTATION_COLOR_READ_TYPE)&&bt!==FloatType&&!Et)}function ot(bt){if(bt==="highp"){if(et.getShaderPrecisionFormat(et.VERTEX_SHADER,et.HIGH_FLOAT).precision>0&&et.getShaderPrecisionFormat(et.FRAGMENT_SHADER,et.HIGH_FLOAT).precision>0)return"highp";bt="mediump"}return bt==="mediump"&&et.getShaderPrecisionFormat(et.VERTEX_SHADER,et.MEDIUM_FLOAT).precision>0&&et.getShaderPrecisionFormat(et.FRAGMENT_SHADER,et.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let at=_e.precision!==void 0?_e.precision:"highp";const lt=ot(at);lt!==at&&(console.warn("THREE.WebGLRenderer:",at,"not supported, using",lt,"instead."),at=lt);const ct=_e.logarithmicDepthBuffer===!0,ht=et.getParameter(et.MAX_TEXTURE_IMAGE_UNITS),ut=et.getParameter(et.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ft=et.getParameter(et.MAX_TEXTURE_SIZE),dt=et.getParameter(et.MAX_CUBE_MAP_TEXTURE_SIZE),pt=et.getParameter(et.MAX_VERTEX_ATTRIBS),mt=et.getParameter(et.MAX_VERTEX_UNIFORM_VECTORS),vt=et.getParameter(et.MAX_VARYING_VECTORS),yt=et.getParameter(et.MAX_FRAGMENT_UNIFORM_VECTORS),_t=ut>0,St=et.getParameter(et.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:rt,getMaxPrecision:ot,textureFormatReadable:it,textureTypeReadable:st,precision:at,logarithmicDepthBuffer:ct,maxTextures:ht,maxVertexTextures:ut,maxTextureSize:ft,maxCubemapSize:dt,maxAttributes:pt,maxVertexUniforms:mt,maxVaryings:vt,maxFragmentUniforms:yt,vertexTextures:_t,maxSamples:St}}function WebGLClipping(et){const _=this;let _e=null,tt=0,nt=!1,rt=!1;const it=new Plane,st=new Matrix3,ot={value:null,needsUpdate:!1};this.uniform=ot,this.numPlanes=0,this.numIntersection=0,this.init=function(ct,ht){const ut=ct.length!==0||ht||tt!==0||nt;return nt=ht,tt=ct.length,ut},this.beginShadows=function(){rt=!0,lt(null)},this.endShadows=function(){rt=!1},this.setGlobalState=function(ct,ht){_e=lt(ct,ht,0)},this.setState=function(ct,ht,ut){const ft=ct.clippingPlanes,dt=ct.clipIntersection,pt=ct.clipShadows,mt=et.get(ct);if(!nt||ft===null||ft.length===0||rt&&!pt)rt?lt(null):at();else{const vt=rt?0:tt,yt=vt*4;let _t=mt.clippingState||null;ot.value=_t,_t=lt(ft,ht,yt,ut);for(let St=0;St!==yt;++St)_t[St]=_e[St];mt.clippingState=_t,this.numIntersection=dt?this.numPlanes:0,this.numPlanes+=vt}};function at(){ot.value!==_e&&(ot.value=_e,ot.needsUpdate=tt>0),_.numPlanes=tt,_.numIntersection=0}function lt(ct,ht,ut,ft){const dt=ct!==null?ct.length:0;let pt=null;if(dt!==0){if(pt=ot.value,ft!==!0||pt===null){const mt=ut+dt*4,vt=ht.matrixWorldInverse;st.getNormalMatrix(vt),(pt===null||pt.length<mt)&&(pt=new Float32Array(mt));for(let yt=0,_t=ut;yt!==dt;++yt,_t+=4)it.copy(ct[yt]).applyMatrix4(vt,st),it.normal.toArray(pt,_t),pt[_t+3]=it.constant}ot.value=pt,ot.needsUpdate=!0}return _.numPlanes=dt,_.numIntersection=0,pt}}function WebGLCubeMaps(et){let _=new WeakMap;function _e(it,st){return st===EquirectangularReflectionMapping?it.mapping=CubeReflectionMapping:st===EquirectangularRefractionMapping&&(it.mapping=CubeRefractionMapping),it}function tt(it){if(it&&it.isTexture){const st=it.mapping;if(st===EquirectangularReflectionMapping||st===EquirectangularRefractionMapping)if(_.has(it)){const ot=_.get(it).texture;return _e(ot,it.mapping)}else{const ot=it.image;if(ot&&ot.height>0){const at=new WebGLCubeRenderTarget(ot.height);return at.fromEquirectangularTexture(et,it),_.set(it,at),it.addEventListener("dispose",nt),_e(at.texture,it.mapping)}else return null}}return it}function nt(it){const st=it.target;st.removeEventListener("dispose",nt);const ot=_.get(st);ot!==void 0&&(_.delete(st),ot.dispose())}function rt(){_=new WeakMap}return{get:tt,dispose:rt}}class OrthographicCamera extends Camera{constructor(_=-1,_e=1,tt=1,nt=-1,rt=.1,it=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=_e,this.top=tt,this.bottom=nt,this.near=rt,this.far=it,this.updateProjectionMatrix()}copy(_,_e){return super.copy(_,_e),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,_e,tt,nt,rt,it){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=_e,this.view.offsetX=tt,this.view.offsetY=nt,this.view.width=rt,this.view.height=it,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),_e=(this.top-this.bottom)/(2*this.zoom),tt=(this.right+this.left)/2,nt=(this.top+this.bottom)/2;let rt=tt-_,it=tt+_,st=nt+_e,ot=nt-_e;if(this.view!==null&&this.view.enabled){const at=(this.right-this.left)/this.view.fullWidth/this.zoom,lt=(this.top-this.bottom)/this.view.fullHeight/this.zoom;rt+=at*this.view.offsetX,it=rt+at*this.view.width,st-=lt*this.view.offsetY,ot=st-lt*this.view.height}this.projectionMatrix.makeOrthographic(rt,it,st,ot,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const _e=super.toJSON(_);return _e.object.zoom=this.zoom,_e.object.left=this.left,_e.object.right=this.right,_e.object.top=this.top,_e.object.bottom=this.bottom,_e.object.near=this.near,_e.object.far=this.far,this.view!==null&&(_e.object.view=Object.assign({},this.view)),_e}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color$1;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0,_oldXrEnabled=!1;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(-PHI,INV_PHI,0),new Vector3(PHI,INV_PHI,0),new Vector3(-INV_PHI,0,PHI),new Vector3(INV_PHI,0,PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(0,PHI,INV_PHI),new Vector3(-1,1,-1),new Vector3(1,1,-1),new Vector3(-1,1,1),new Vector3(1,1,1)];class PMREMGenerator{constructor(_){this._renderer=_,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_,_e=0,tt=.1,nt=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const rt=this._allocateTargets();return rt.depthBuffer=!0,this._sceneToCubeUV(_,tt,nt,rt),_e>0&&this._blur(rt,0,0,_e),this._applyPMREM(rt),this._cleanup(rt),rt}fromEquirectangular(_,_e=null){return this._fromTexture(_,_e)}fromCubemap(_,_e=null){return this._fromTexture(_,_e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_){this._lodMax=Math.floor(Math.log2(_)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _=0;_<this._lodPlanes.length;_++)this._lodPlanes[_].dispose()}_cleanup(_){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),this._renderer.xr.enabled=_oldXrEnabled,_.scissorTest=!1,_setViewport(_,0,0,_.width,_.height)}_fromTexture(_,_e){_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping?this._setSize(_.image.length===0?16:_.image[0].width||_.image[0].image.width):this._setSize(_.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const tt=_e||this._allocateTargets();return this._textureToCubeUV(_,tt),this._applyPMREM(tt),this._cleanup(tt),tt}_allocateTargets(){const _=3*Math.max(this._cubeSize,112),_e=4*this._cubeSize,tt={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},nt=_createRenderTarget(_,_e,tt);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_||this._pingPongRenderTarget.height!==_e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_,_e,tt);const{_lodMax:rt}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(rt)),this._blurMaterial=_getBlurShader(rt,_,_e)}return nt}_compileMaterial(_){const _e=new Mesh(this._lodPlanes[0],_);this._renderer.compile(_e,_flatCamera)}_sceneToCubeUV(_,_e,tt,nt){const st=new PerspectiveCamera(90,1,_e,tt),ot=[1,-1,1,1,1,1],at=[1,1,1,-1,-1,-1],lt=this._renderer,ct=lt.autoClear,ht=lt.toneMapping;lt.getClearColor(_clearColor),lt.toneMapping=NoToneMapping,lt.autoClear=!1;const ut=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ft=new Mesh(new BoxGeometry,ut);let dt=!1;const pt=_.background;pt?pt.isColor&&(ut.color.copy(pt),_.background=null,dt=!0):(ut.color.copy(_clearColor),dt=!0);for(let mt=0;mt<6;mt++){const vt=mt%3;vt===0?(st.up.set(0,ot[mt],0),st.lookAt(at[mt],0,0)):vt===1?(st.up.set(0,0,ot[mt]),st.lookAt(0,at[mt],0)):(st.up.set(0,ot[mt],0),st.lookAt(0,0,at[mt]));const yt=this._cubeSize;_setViewport(nt,vt*yt,mt>2?yt:0,yt,yt),lt.setRenderTarget(nt),dt&&lt.render(ft,st),lt.render(_,st)}ft.geometry.dispose(),ft.material.dispose(),lt.toneMapping=ht,lt.autoClear=ct,_.background=pt}_textureToCubeUV(_,_e){const tt=this._renderer,nt=_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping;nt?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const rt=nt?this._cubemapMaterial:this._equirectMaterial,it=new Mesh(this._lodPlanes[0],rt),st=rt.uniforms;st.envMap.value=_;const ot=this._cubeSize;_setViewport(_e,0,0,3*ot,2*ot),tt.setRenderTarget(_e),tt.render(it,_flatCamera)}_applyPMREM(_){const _e=this._renderer,tt=_e.autoClear;_e.autoClear=!1;const nt=this._lodPlanes.length;for(let rt=1;rt<nt;rt++){const it=Math.sqrt(this._sigmas[rt]*this._sigmas[rt]-this._sigmas[rt-1]*this._sigmas[rt-1]),st=_axisDirections[(nt-rt-1)%_axisDirections.length];this._blur(_,rt-1,rt,it,st)}_e.autoClear=tt}_blur(_,_e,tt,nt,rt){const it=this._pingPongRenderTarget;this._halfBlur(_,it,_e,tt,nt,"latitudinal",rt),this._halfBlur(it,_,tt,tt,nt,"longitudinal",rt)}_halfBlur(_,_e,tt,nt,rt,it,st){const ot=this._renderer,at=this._blurMaterial;it!=="latitudinal"&&it!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const lt=3,ct=new Mesh(this._lodPlanes[nt],at),ht=at.uniforms,ut=this._sizeLods[tt]-1,ft=isFinite(rt)?Math.PI/(2*ut):2*Math.PI/(2*MAX_SAMPLES-1),dt=rt/ft,pt=isFinite(rt)?1+Math.floor(lt*dt):MAX_SAMPLES;pt>MAX_SAMPLES&&console.warn(`sigmaRadians, ${rt}, is too large and will clip, as it requested ${pt} samples when the maximum is set to ${MAX_SAMPLES}`);const mt=[];let vt=0;for(let Et=0;Et<MAX_SAMPLES;++Et){const Mt=Et/dt,Tt=Math.exp(-Mt*Mt/2);mt.push(Tt),Et===0?vt+=Tt:Et<pt&&(vt+=2*Tt)}for(let Et=0;Et<mt.length;Et++)mt[Et]=mt[Et]/vt;ht.envMap.value=_.texture,ht.samples.value=pt,ht.weights.value=mt,ht.latitudinal.value=it==="latitudinal",st&&(ht.poleAxis.value=st);const{_lodMax:yt}=this;ht.dTheta.value=ft,ht.mipInt.value=yt-tt;const _t=this._sizeLods[nt],St=3*_t*(nt>yt-LOD_MIN?nt-yt+LOD_MIN:0),bt=4*(this._cubeSize-_t);_setViewport(_e,St,bt,3*_t,2*_t),ot.setRenderTarget(_e),ot.render(ct,_flatCamera)}}function _createPlanes(et){const _=[],_e=[],tt=[];let nt=et;const rt=et-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let it=0;it<rt;it++){const st=Math.pow(2,nt);_e.push(st);let ot=1/st;it>et-LOD_MIN?ot=EXTRA_LOD_SIGMA[it-et+LOD_MIN-1]:it===0&&(ot=0),tt.push(ot);const at=1/(st-2),lt=-at,ct=1+at,ht=[lt,lt,ct,lt,ct,ct,lt,lt,ct,ct,lt,ct],ut=6,ft=6,dt=3,pt=2,mt=1,vt=new Float32Array(dt*ft*ut),yt=new Float32Array(pt*ft*ut),_t=new Float32Array(mt*ft*ut);for(let bt=0;bt<ut;bt++){const Et=bt%3*2/3-1,Mt=bt>2?0:-1,Tt=[Et,Mt,0,Et+2/3,Mt,0,Et+2/3,Mt+1,0,Et,Mt,0,Et+2/3,Mt+1,0,Et,Mt+1,0];vt.set(Tt,dt*ft*bt),yt.set(ht,pt*ft*bt);const wt=[bt,bt,bt,bt,bt,bt];_t.set(wt,mt*ft*bt)}const St=new BufferGeometry;St.setAttribute("position",new BufferAttribute(vt,dt)),St.setAttribute("uv",new BufferAttribute(yt,pt)),St.setAttribute("faceIndex",new BufferAttribute(_t,mt)),_.push(St),nt>LOD_MIN&&nt--}return{lodPlanes:_,sizeLods:_e,sigmas:tt}}function _createRenderTarget(et,_,_e){const tt=new WebGLRenderTarget(et,_,_e);return tt.texture.mapping=CubeUVReflectionMapping,tt.texture.name="PMREM.cubeUv",tt.scissorTest=!0,tt}function _setViewport(et,_,_e,tt,nt){et.viewport.set(_,_e,tt,nt),et.scissor.set(_,_e,tt,nt)}function _getBlurShader(et,_,_e){const tt=new Float32Array(MAX_SAMPLES),nt=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_,CUBEUV_TEXEL_HEIGHT:1/_e,CUBEUV_MAX_MIP:`${et}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:tt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:nt}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(et){let _=new WeakMap,_e=null;function tt(st){if(st&&st.isTexture){const ot=st.mapping,at=ot===EquirectangularReflectionMapping||ot===EquirectangularRefractionMapping,lt=ot===CubeReflectionMapping||ot===CubeRefractionMapping;if(at||lt){let ct=_.get(st);const ht=ct!==void 0?ct.texture.pmremVersion:0;if(st.isRenderTargetTexture&&st.pmremVersion!==ht)return _e===null&&(_e=new PMREMGenerator(et)),ct=at?_e.fromEquirectangular(st,ct):_e.fromCubemap(st,ct),ct.texture.pmremVersion=st.pmremVersion,_.set(st,ct),ct.texture;if(ct!==void 0)return ct.texture;{const ut=st.image;return at&&ut&&ut.height>0||lt&&ut&&nt(ut)?(_e===null&&(_e=new PMREMGenerator(et)),ct=at?_e.fromEquirectangular(st):_e.fromCubemap(st),ct.texture.pmremVersion=st.pmremVersion,_.set(st,ct),st.addEventListener("dispose",rt),ct.texture):null}}}return st}function nt(st){let ot=0;const at=6;for(let lt=0;lt<at;lt++)st[lt]!==void 0&&ot++;return ot===at}function rt(st){const ot=st.target;ot.removeEventListener("dispose",rt);const at=_.get(ot);at!==void 0&&(_.delete(ot),at.dispose())}function it(){_=new WeakMap,_e!==null&&(_e.dispose(),_e=null)}return{get:tt,dispose:it}}function WebGLExtensions(et){const _={};function _e(tt){if(_[tt]!==void 0)return _[tt];let nt;switch(tt){case"WEBGL_depth_texture":nt=et.getExtension("WEBGL_depth_texture")||et.getExtension("MOZ_WEBGL_depth_texture")||et.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":nt=et.getExtension("EXT_texture_filter_anisotropic")||et.getExtension("MOZ_EXT_texture_filter_anisotropic")||et.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":nt=et.getExtension("WEBGL_compressed_texture_s3tc")||et.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||et.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":nt=et.getExtension("WEBGL_compressed_texture_pvrtc")||et.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:nt=et.getExtension(tt)}return _[tt]=nt,nt}return{has:function(tt){return _e(tt)!==null},init:function(){_e("EXT_color_buffer_float"),_e("WEBGL_clip_cull_distance"),_e("OES_texture_float_linear"),_e("EXT_color_buffer_half_float"),_e("WEBGL_multisampled_render_to_texture"),_e("WEBGL_render_shared_exponent")},get:function(tt){const nt=_e(tt);return nt===null&&warnOnce("THREE.WebGLRenderer: "+tt+" extension not supported."),nt}}}function WebGLGeometries(et,_,_e,tt){const nt={},rt=new WeakMap;function it(ct){const ht=ct.target;ht.index!==null&&_.remove(ht.index);for(const ft in ht.attributes)_.remove(ht.attributes[ft]);for(const ft in ht.morphAttributes){const dt=ht.morphAttributes[ft];for(let pt=0,mt=dt.length;pt<mt;pt++)_.remove(dt[pt])}ht.removeEventListener("dispose",it),delete nt[ht.id];const ut=rt.get(ht);ut&&(_.remove(ut),rt.delete(ht)),tt.releaseStatesOfGeometry(ht),ht.isInstancedBufferGeometry===!0&&delete ht._maxInstanceCount,_e.memory.geometries--}function st(ct,ht){return nt[ht.id]===!0||(ht.addEventListener("dispose",it),nt[ht.id]=!0,_e.memory.geometries++),ht}function ot(ct){const ht=ct.attributes;for(const ft in ht)_.update(ht[ft],et.ARRAY_BUFFER);const ut=ct.morphAttributes;for(const ft in ut){const dt=ut[ft];for(let pt=0,mt=dt.length;pt<mt;pt++)_.update(dt[pt],et.ARRAY_BUFFER)}}function at(ct){const ht=[],ut=ct.index,ft=ct.attributes.position;let dt=0;if(ut!==null){const vt=ut.array;dt=ut.version;for(let yt=0,_t=vt.length;yt<_t;yt+=3){const St=vt[yt+0],bt=vt[yt+1],Et=vt[yt+2];ht.push(St,bt,bt,Et,Et,St)}}else if(ft!==void 0){const vt=ft.array;dt=ft.version;for(let yt=0,_t=vt.length/3-1;yt<_t;yt+=3){const St=yt+0,bt=yt+1,Et=yt+2;ht.push(St,bt,bt,Et,Et,St)}}else return;const pt=new(arrayNeedsUint32(ht)?Uint32BufferAttribute:Uint16BufferAttribute)(ht,1);pt.version=dt;const mt=rt.get(ct);mt&&_.remove(mt),rt.set(ct,pt)}function lt(ct){const ht=rt.get(ct);if(ht){const ut=ct.index;ut!==null&&ht.version<ut.version&&at(ct)}else at(ct);return rt.get(ct)}return{get:st,update:ot,getWireframeAttribute:lt}}function WebGLIndexedBufferRenderer(et,_,_e){let tt;function nt(ht){tt=ht}let rt,it;function st(ht){rt=ht.type,it=ht.bytesPerElement}function ot(ht,ut){et.drawElements(tt,ut,rt,ht*it),_e.update(ut,tt,1)}function at(ht,ut,ft){ft!==0&&(et.drawElementsInstanced(tt,ut,rt,ht*it,ft),_e.update(ut,tt,ft))}function lt(ht,ut,ft){if(ft===0)return;_.get("WEBGL_multi_draw").multiDrawElementsWEBGL(tt,ut,0,rt,ht,0,ft);let pt=0;for(let mt=0;mt<ft;mt++)pt+=ut[mt];_e.update(pt,tt,1)}function ct(ht,ut,ft,dt){if(ft===0)return;const pt=_.get("WEBGL_multi_draw");if(pt===null)for(let mt=0;mt<ht.length;mt++)at(ht[mt]/it,ut[mt],dt[mt]);else{pt.multiDrawElementsInstancedWEBGL(tt,ut,0,rt,ht,0,dt,0,ft);let mt=0;for(let vt=0;vt<ft;vt++)mt+=ut[vt];for(let vt=0;vt<dt.length;vt++)_e.update(mt,tt,dt[vt])}}this.setMode=nt,this.setIndex=st,this.render=ot,this.renderInstances=at,this.renderMultiDraw=lt,this.renderMultiDrawInstances=ct}function WebGLInfo(et){const _={geometries:0,textures:0},_e={frame:0,calls:0,triangles:0,points:0,lines:0};function tt(rt,it,st){switch(_e.calls++,it){case et.TRIANGLES:_e.triangles+=st*(rt/3);break;case et.LINES:_e.lines+=st*(rt/2);break;case et.LINE_STRIP:_e.lines+=st*(rt-1);break;case et.LINE_LOOP:_e.lines+=st*rt;break;case et.POINTS:_e.points+=st*rt;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",it);break}}function nt(){_e.calls=0,_e.triangles=0,_e.points=0,_e.lines=0}return{memory:_,render:_e,programs:null,autoReset:!0,reset:nt,update:tt}}function WebGLMorphtargets(et,_,_e){const tt=new WeakMap,nt=new Vector4;function rt(it,st,ot){const at=it.morphTargetInfluences,lt=st.morphAttributes.position||st.morphAttributes.normal||st.morphAttributes.color,ct=lt!==void 0?lt.length:0;let ht=tt.get(st);if(ht===void 0||ht.count!==ct){let Tt=function(){Et.dispose(),tt.delete(st),st.removeEventListener("dispose",Tt)};ht!==void 0&&ht.texture.dispose();const ut=st.morphAttributes.position!==void 0,ft=st.morphAttributes.normal!==void 0,dt=st.morphAttributes.color!==void 0,pt=st.morphAttributes.position||[],mt=st.morphAttributes.normal||[],vt=st.morphAttributes.color||[];let yt=0;ut===!0&&(yt=1),ft===!0&&(yt=2),dt===!0&&(yt=3);let _t=st.attributes.position.count*yt,St=1;_t>_.maxTextureSize&&(St=Math.ceil(_t/_.maxTextureSize),_t=_.maxTextureSize);const bt=new Float32Array(_t*St*4*ct),Et=new DataArrayTexture(bt,_t,St,ct);Et.type=FloatType,Et.needsUpdate=!0;const Mt=yt*4;for(let wt=0;wt<ct;wt++){const Ct=pt[wt],Rt=mt[wt],It=vt[wt],Dt=_t*St*4*wt;for(let Ft=0;Ft<Ct.count;Ft++){const $t=Ft*Mt;ut===!0&&(nt.fromBufferAttribute(Ct,Ft),bt[Dt+$t+0]=nt.x,bt[Dt+$t+1]=nt.y,bt[Dt+$t+2]=nt.z,bt[Dt+$t+3]=0),ft===!0&&(nt.fromBufferAttribute(Rt,Ft),bt[Dt+$t+4]=nt.x,bt[Dt+$t+5]=nt.y,bt[Dt+$t+6]=nt.z,bt[Dt+$t+7]=0),dt===!0&&(nt.fromBufferAttribute(It,Ft),bt[Dt+$t+8]=nt.x,bt[Dt+$t+9]=nt.y,bt[Dt+$t+10]=nt.z,bt[Dt+$t+11]=It.itemSize===4?nt.w:1)}}ht={count:ct,texture:Et,size:new Vector2(_t,St)},tt.set(st,ht),st.addEventListener("dispose",Tt)}if(it.isInstancedMesh===!0&&it.morphTexture!==null)ot.getUniforms().setValue(et,"morphTexture",it.morphTexture,_e);else{let ut=0;for(let dt=0;dt<at.length;dt++)ut+=at[dt];const ft=st.morphTargetsRelative?1:1-ut;ot.getUniforms().setValue(et,"morphTargetBaseInfluence",ft),ot.getUniforms().setValue(et,"morphTargetInfluences",at)}ot.getUniforms().setValue(et,"morphTargetsTexture",ht.texture,_e),ot.getUniforms().setValue(et,"morphTargetsTextureSize",ht.size)}return{update:rt}}function WebGLObjects(et,_,_e,tt){let nt=new WeakMap;function rt(ot){const at=tt.render.frame,lt=ot.geometry,ct=_.get(ot,lt);if(nt.get(ct)!==at&&(_.update(ct),nt.set(ct,at)),ot.isInstancedMesh&&(ot.hasEventListener("dispose",st)===!1&&ot.addEventListener("dispose",st),nt.get(ot)!==at&&(_e.update(ot.instanceMatrix,et.ARRAY_BUFFER),ot.instanceColor!==null&&_e.update(ot.instanceColor,et.ARRAY_BUFFER),nt.set(ot,at))),ot.isSkinnedMesh){const ht=ot.skeleton;nt.get(ht)!==at&&(ht.update(),nt.set(ht,at))}return ct}function it(){nt=new WeakMap}function st(ot){const at=ot.target;at.removeEventListener("dispose",st),_e.remove(at.instanceMatrix),at.instanceColor!==null&&_e.remove(at.instanceColor)}return{update:rt,dispose:it}}class DepthTexture extends Texture$1{constructor(_,_e,tt,nt,rt,it,st,ot,at,lt=DepthFormat){if(lt!==DepthFormat&&lt!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");tt===void 0&&lt===DepthFormat&&(tt=UnsignedIntType),tt===void 0&&lt===DepthStencilFormat&&(tt=UnsignedInt248Type),super(null,nt,rt,it,st,ot,lt,tt,at),this.isDepthTexture=!0,this.image={width:_,height:_e},this.magFilter=st!==void 0?st:NearestFilter,this.minFilter=ot!==void 0?ot:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_){return super.copy(_),this.compareFunction=_.compareFunction,this}toJSON(_){const _e=super.toJSON(_);return this.compareFunction!==null&&(_e.compareFunction=this.compareFunction),_e}}const emptyTexture=new Texture$1,emptyShadowTexture=new DepthTexture(1,1),emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(et,_,_e){const tt=et[0];if(tt<=0||tt>0)return et;const nt=_*_e;let rt=arrayCacheF32[nt];if(rt===void 0&&(rt=new Float32Array(nt),arrayCacheF32[nt]=rt),_!==0){tt.toArray(rt,0);for(let it=1,st=0;it!==_;++it)st+=_e,et[it].toArray(rt,st)}return rt}function arraysEqual(et,_){if(et.length!==_.length)return!1;for(let _e=0,tt=et.length;_e<tt;_e++)if(et[_e]!==_[_e])return!1;return!0}function copyArray(et,_){for(let _e=0,tt=_.length;_e<tt;_e++)et[_e]=_[_e]}function allocTexUnits(et,_){let _e=arrayCacheI32[_];_e===void 0&&(_e=new Int32Array(_),arrayCacheI32[_]=_e);for(let tt=0;tt!==_;++tt)_e[tt]=et.allocateTextureUnit();return _e}function setValueV1f(et,_){const _e=this.cache;_e[0]!==_&&(et.uniform1f(this.addr,_),_e[0]=_)}function setValueV2f(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y)&&(et.uniform2f(this.addr,_.x,_.y),_e[0]=_.x,_e[1]=_.y);else{if(arraysEqual(_e,_))return;et.uniform2fv(this.addr,_),copyArray(_e,_)}}function setValueV3f(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y||_e[2]!==_.z)&&(et.uniform3f(this.addr,_.x,_.y,_.z),_e[0]=_.x,_e[1]=_.y,_e[2]=_.z);else if(_.r!==void 0)(_e[0]!==_.r||_e[1]!==_.g||_e[2]!==_.b)&&(et.uniform3f(this.addr,_.r,_.g,_.b),_e[0]=_.r,_e[1]=_.g,_e[2]=_.b);else{if(arraysEqual(_e,_))return;et.uniform3fv(this.addr,_),copyArray(_e,_)}}function setValueV4f(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y||_e[2]!==_.z||_e[3]!==_.w)&&(et.uniform4f(this.addr,_.x,_.y,_.z,_.w),_e[0]=_.x,_e[1]=_.y,_e[2]=_.z,_e[3]=_.w);else{if(arraysEqual(_e,_))return;et.uniform4fv(this.addr,_),copyArray(_e,_)}}function setValueM2(et,_){const _e=this.cache,tt=_.elements;if(tt===void 0){if(arraysEqual(_e,_))return;et.uniformMatrix2fv(this.addr,!1,_),copyArray(_e,_)}else{if(arraysEqual(_e,tt))return;mat2array.set(tt),et.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(_e,tt)}}function setValueM3(et,_){const _e=this.cache,tt=_.elements;if(tt===void 0){if(arraysEqual(_e,_))return;et.uniformMatrix3fv(this.addr,!1,_),copyArray(_e,_)}else{if(arraysEqual(_e,tt))return;mat3array.set(tt),et.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(_e,tt)}}function setValueM4(et,_){const _e=this.cache,tt=_.elements;if(tt===void 0){if(arraysEqual(_e,_))return;et.uniformMatrix4fv(this.addr,!1,_),copyArray(_e,_)}else{if(arraysEqual(_e,tt))return;mat4array.set(tt),et.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(_e,tt)}}function setValueV1i(et,_){const _e=this.cache;_e[0]!==_&&(et.uniform1i(this.addr,_),_e[0]=_)}function setValueV2i(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y)&&(et.uniform2i(this.addr,_.x,_.y),_e[0]=_.x,_e[1]=_.y);else{if(arraysEqual(_e,_))return;et.uniform2iv(this.addr,_),copyArray(_e,_)}}function setValueV3i(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y||_e[2]!==_.z)&&(et.uniform3i(this.addr,_.x,_.y,_.z),_e[0]=_.x,_e[1]=_.y,_e[2]=_.z);else{if(arraysEqual(_e,_))return;et.uniform3iv(this.addr,_),copyArray(_e,_)}}function setValueV4i(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y||_e[2]!==_.z||_e[3]!==_.w)&&(et.uniform4i(this.addr,_.x,_.y,_.z,_.w),_e[0]=_.x,_e[1]=_.y,_e[2]=_.z,_e[3]=_.w);else{if(arraysEqual(_e,_))return;et.uniform4iv(this.addr,_),copyArray(_e,_)}}function setValueV1ui(et,_){const _e=this.cache;_e[0]!==_&&(et.uniform1ui(this.addr,_),_e[0]=_)}function setValueV2ui(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y)&&(et.uniform2ui(this.addr,_.x,_.y),_e[0]=_.x,_e[1]=_.y);else{if(arraysEqual(_e,_))return;et.uniform2uiv(this.addr,_),copyArray(_e,_)}}function setValueV3ui(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y||_e[2]!==_.z)&&(et.uniform3ui(this.addr,_.x,_.y,_.z),_e[0]=_.x,_e[1]=_.y,_e[2]=_.z);else{if(arraysEqual(_e,_))return;et.uniform3uiv(this.addr,_),copyArray(_e,_)}}function setValueV4ui(et,_){const _e=this.cache;if(_.x!==void 0)(_e[0]!==_.x||_e[1]!==_.y||_e[2]!==_.z||_e[3]!==_.w)&&(et.uniform4ui(this.addr,_.x,_.y,_.z,_.w),_e[0]=_.x,_e[1]=_.y,_e[2]=_.z,_e[3]=_.w);else{if(arraysEqual(_e,_))return;et.uniform4uiv(this.addr,_),copyArray(_e,_)}}function setValueT1(et,_,_e){const tt=this.cache,nt=_e.allocateTextureUnit();tt[0]!==nt&&(et.uniform1i(this.addr,nt),tt[0]=nt);let rt;this.type===et.SAMPLER_2D_SHADOW?(emptyShadowTexture.compareFunction=LessEqualCompare,rt=emptyShadowTexture):rt=emptyTexture,_e.setTexture2D(_||rt,nt)}function setValueT3D1(et,_,_e){const tt=this.cache,nt=_e.allocateTextureUnit();tt[0]!==nt&&(et.uniform1i(this.addr,nt),tt[0]=nt),_e.setTexture3D(_||empty3dTexture,nt)}function setValueT6(et,_,_e){const tt=this.cache,nt=_e.allocateTextureUnit();tt[0]!==nt&&(et.uniform1i(this.addr,nt),tt[0]=nt),_e.setTextureCube(_||emptyCubeTexture,nt)}function setValueT2DArray1(et,_,_e){const tt=this.cache,nt=_e.allocateTextureUnit();tt[0]!==nt&&(et.uniform1i(this.addr,nt),tt[0]=nt),_e.setTexture2DArray(_||emptyArrayTexture,nt)}function getSingularSetter(et){switch(et){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(et,_){et.uniform1fv(this.addr,_)}function setValueV2fArray(et,_){const _e=flatten(_,this.size,2);et.uniform2fv(this.addr,_e)}function setValueV3fArray(et,_){const _e=flatten(_,this.size,3);et.uniform3fv(this.addr,_e)}function setValueV4fArray(et,_){const _e=flatten(_,this.size,4);et.uniform4fv(this.addr,_e)}function setValueM2Array(et,_){const _e=flatten(_,this.size,4);et.uniformMatrix2fv(this.addr,!1,_e)}function setValueM3Array(et,_){const _e=flatten(_,this.size,9);et.uniformMatrix3fv(this.addr,!1,_e)}function setValueM4Array(et,_){const _e=flatten(_,this.size,16);et.uniformMatrix4fv(this.addr,!1,_e)}function setValueV1iArray(et,_){et.uniform1iv(this.addr,_)}function setValueV2iArray(et,_){et.uniform2iv(this.addr,_)}function setValueV3iArray(et,_){et.uniform3iv(this.addr,_)}function setValueV4iArray(et,_){et.uniform4iv(this.addr,_)}function setValueV1uiArray(et,_){et.uniform1uiv(this.addr,_)}function setValueV2uiArray(et,_){et.uniform2uiv(this.addr,_)}function setValueV3uiArray(et,_){et.uniform3uiv(this.addr,_)}function setValueV4uiArray(et,_){et.uniform4uiv(this.addr,_)}function setValueT1Array(et,_,_e){const tt=this.cache,nt=_.length,rt=allocTexUnits(_e,nt);arraysEqual(tt,rt)||(et.uniform1iv(this.addr,rt),copyArray(tt,rt));for(let it=0;it!==nt;++it)_e.setTexture2D(_[it]||emptyTexture,rt[it])}function setValueT3DArray(et,_,_e){const tt=this.cache,nt=_.length,rt=allocTexUnits(_e,nt);arraysEqual(tt,rt)||(et.uniform1iv(this.addr,rt),copyArray(tt,rt));for(let it=0;it!==nt;++it)_e.setTexture3D(_[it]||empty3dTexture,rt[it])}function setValueT6Array(et,_,_e){const tt=this.cache,nt=_.length,rt=allocTexUnits(_e,nt);arraysEqual(tt,rt)||(et.uniform1iv(this.addr,rt),copyArray(tt,rt));for(let it=0;it!==nt;++it)_e.setTextureCube(_[it]||emptyCubeTexture,rt[it])}function setValueT2DArrayArray(et,_,_e){const tt=this.cache,nt=_.length,rt=allocTexUnits(_e,nt);arraysEqual(tt,rt)||(et.uniform1iv(this.addr,rt),copyArray(tt,rt));for(let it=0;it!==nt;++it)_e.setTexture2DArray(_[it]||emptyArrayTexture,rt[it])}function getPureArraySetter(et){switch(et){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_,_e,tt){this.id=_,this.addr=tt,this.cache=[],this.type=_e.type,this.setValue=getSingularSetter(_e.type)}}class PureArrayUniform{constructor(_,_e,tt){this.id=_,this.addr=tt,this.cache=[],this.type=_e.type,this.size=_e.size,this.setValue=getPureArraySetter(_e.type)}}class StructuredUniform{constructor(_){this.id=_,this.seq=[],this.map={}}setValue(_,_e,tt){const nt=this.seq;for(let rt=0,it=nt.length;rt!==it;++rt){const st=nt[rt];st.setValue(_,_e[st.id],tt)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(et,_){et.seq.push(_),et.map[_.id]=_}function parseUniform(et,_,_e){const tt=et.name,nt=tt.length;for(RePathPart.lastIndex=0;;){const rt=RePathPart.exec(tt),it=RePathPart.lastIndex;let st=rt[1];const ot=rt[2]==="]",at=rt[3];if(ot&&(st=st|0),at===void 0||at==="["&&it+2===nt){addUniform(_e,at===void 0?new SingleUniform(st,et,_):new PureArrayUniform(st,et,_));break}else{let ct=_e.map[st];ct===void 0&&(ct=new StructuredUniform(st),addUniform(_e,ct)),_e=ct}}}class WebGLUniforms{constructor(_,_e){this.seq=[],this.map={};const tt=_.getProgramParameter(_e,_.ACTIVE_UNIFORMS);for(let nt=0;nt<tt;++nt){const rt=_.getActiveUniform(_e,nt),it=_.getUniformLocation(_e,rt.name);parseUniform(rt,it,this)}}setValue(_,_e,tt,nt){const rt=this.map[_e];rt!==void 0&&rt.setValue(_,tt,nt)}setOptional(_,_e,tt){const nt=_e[tt];nt!==void 0&&this.setValue(_,tt,nt)}static upload(_,_e,tt,nt){for(let rt=0,it=_e.length;rt!==it;++rt){const st=_e[rt],ot=tt[st.id];ot.needsUpdate!==!1&&st.setValue(_,ot.value,nt)}}static seqWithValue(_,_e){const tt=[];for(let nt=0,rt=_.length;nt!==rt;++nt){const it=_[nt];it.id in _e&&tt.push(it)}return tt}}function WebGLShader(et,_,_e){const tt=et.createShader(_);return et.shaderSource(tt,_e),et.compileShader(tt),tt}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(et,_){const _e=et.split(`
`),tt=[],nt=Math.max(_-6,0),rt=Math.min(_+6,_e.length);for(let it=nt;it<rt;it++){const st=it+1;tt.push(`${st===_?">":" "} ${st}: ${_e[it]}`)}return tt.join(`
`)}function getEncodingComponents(et){const _=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),_e=ColorManagement.getPrimaries(et);let tt;switch(_===_e?tt="":_===P3Primaries&&_e===Rec709Primaries?tt="LinearDisplayP3ToLinearSRGB":_===Rec709Primaries&&_e===P3Primaries&&(tt="LinearSRGBToLinearDisplayP3"),et){case LinearSRGBColorSpace:case LinearDisplayP3ColorSpace:return[tt,"LinearTransferOETF"];case SRGBColorSpace:case DisplayP3ColorSpace:return[tt,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",et),[tt,"LinearTransferOETF"]}}function getShaderErrors(et,_,_e){const tt=et.getShaderParameter(_,et.COMPILE_STATUS),nt=et.getShaderInfoLog(_).trim();if(tt&&nt==="")return"";const rt=/ERROR: 0:(\d+)/.exec(nt);if(rt){const it=parseInt(rt[1]);return _e.toUpperCase()+`

`+nt+`

`+handleSource(et.getShaderSource(_),it)}else return nt}function getTexelEncodingFunction(et,_){const _e=getEncodingComponents(_);return`vec4 ${et}( vec4 value ) { return ${_e[0]}( ${_e[1]}( value ) ); }`}function getToneMappingFunction(et,_){let _e;switch(_){case LinearToneMapping:_e="Linear";break;case ReinhardToneMapping:_e="Reinhard";break;case CineonToneMapping:_e="OptimizedCineon";break;case ACESFilmicToneMapping:_e="ACESFilmic";break;case AgXToneMapping:_e="AgX";break;case NeutralToneMapping:_e="Neutral";break;case CustomToneMapping:_e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_),_e="Linear"}return"vec3 "+et+"( vec3 color ) { return "+_e+"ToneMapping( color ); }"}function generateVertexExtensions(et){return[et.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",et.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(et){const _=[];for(const _e in et){const tt=et[_e];tt!==!1&&_.push("#define "+_e+" "+tt)}return _.join(`
`)}function fetchAttributeLocations(et,_){const _e={},tt=et.getProgramParameter(_,et.ACTIVE_ATTRIBUTES);for(let nt=0;nt<tt;nt++){const rt=et.getActiveAttrib(_,nt),it=rt.name;let st=1;rt.type===et.FLOAT_MAT2&&(st=2),rt.type===et.FLOAT_MAT3&&(st=3),rt.type===et.FLOAT_MAT4&&(st=4),_e[it]={type:rt.type,location:et.getAttribLocation(_,it),locationSize:st}}return _e}function filterEmptyLine(et){return et!==""}function replaceLightNums(et,_){const _e=_.numSpotLightShadows+_.numSpotLightMaps-_.numSpotLightShadowsWithMaps;return et.replace(/NUM_DIR_LIGHTS/g,_.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,_e).replace(/NUM_RECT_AREA_LIGHTS/g,_.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_.numPointLightShadows)}function replaceClippingPlaneNums(et,_){return et.replace(/NUM_CLIPPING_PLANES/g,_.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_.numClippingPlanes-_.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(et){return et.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(et,_){let _e=ShaderChunk[_];if(_e===void 0){const tt=shaderChunkMap.get(_);if(tt!==void 0)_e=ShaderChunk[tt],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_,tt);else throw new Error("Can not resolve #include <"+_+">")}return resolveIncludes(_e)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(et){return et.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(et,_,_e,tt){let nt="";for(let rt=parseInt(_);rt<parseInt(_e);rt++)nt+=tt.replace(/\[\s*i\s*\]/g,"[ "+rt+" ]").replace(/UNROLLED_LOOP_INDEX/g,rt);return nt}function generatePrecision(et){let _=`precision ${et.precision} float;
	precision ${et.precision} int;
	precision ${et.precision} sampler2D;
	precision ${et.precision} samplerCube;
	precision ${et.precision} sampler3D;
	precision ${et.precision} sampler2DArray;
	precision ${et.precision} sampler2DShadow;
	precision ${et.precision} samplerCubeShadow;
	precision ${et.precision} sampler2DArrayShadow;
	precision ${et.precision} isampler2D;
	precision ${et.precision} isampler3D;
	precision ${et.precision} isamplerCube;
	precision ${et.precision} isampler2DArray;
	precision ${et.precision} usampler2D;
	precision ${et.precision} usampler3D;
	precision ${et.precision} usamplerCube;
	precision ${et.precision} usampler2DArray;
	`;return et.precision==="highp"?_+=`
#define HIGH_PRECISION`:et.precision==="mediump"?_+=`
#define MEDIUM_PRECISION`:et.precision==="lowp"&&(_+=`
#define LOW_PRECISION`),_}function generateShadowMapTypeDefine(et){let _="SHADOWMAP_TYPE_BASIC";return et.shadowMapType===PCFShadowMap?_="SHADOWMAP_TYPE_PCF":et.shadowMapType===PCFSoftShadowMap?_="SHADOWMAP_TYPE_PCF_SOFT":et.shadowMapType===VSMShadowMap&&(_="SHADOWMAP_TYPE_VSM"),_}function generateEnvMapTypeDefine(et){let _="ENVMAP_TYPE_CUBE";if(et.envMap)switch(et.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_="ENVMAP_TYPE_CUBE_UV";break}return _}function generateEnvMapModeDefine(et){let _="ENVMAP_MODE_REFLECTION";if(et.envMap)switch(et.envMapMode){case CubeRefractionMapping:_="ENVMAP_MODE_REFRACTION";break}return _}function generateEnvMapBlendingDefine(et){let _="ENVMAP_BLENDING_NONE";if(et.envMap)switch(et.combine){case MultiplyOperation:_="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_="ENVMAP_BLENDING_MIX";break;case AddOperation:_="ENVMAP_BLENDING_ADD";break}return _}function generateCubeUVSize(et){const _=et.envMapCubeUVHeight;if(_===null)return null;const _e=Math.log2(_)-2,tt=1/_;return{texelWidth:1/(3*Math.max(Math.pow(2,_e),7*16)),texelHeight:tt,maxMip:_e}}function WebGLProgram(et,_,_e,tt){const nt=et.getContext(),rt=_e.defines;let it=_e.vertexShader,st=_e.fragmentShader;const ot=generateShadowMapTypeDefine(_e),at=generateEnvMapTypeDefine(_e),lt=generateEnvMapModeDefine(_e),ct=generateEnvMapBlendingDefine(_e),ht=generateCubeUVSize(_e),ut=generateVertexExtensions(_e),ft=generateDefines(rt),dt=nt.createProgram();let pt,mt,vt=_e.glslVersion?"#version "+_e.glslVersion+`
`:"";_e.isRawShaderMaterial?(pt=["#define SHADER_TYPE "+_e.shaderType,"#define SHADER_NAME "+_e.shaderName,ft].filter(filterEmptyLine).join(`
`),pt.length>0&&(pt+=`
`),mt=["#define SHADER_TYPE "+_e.shaderType,"#define SHADER_NAME "+_e.shaderName,ft].filter(filterEmptyLine).join(`
`),mt.length>0&&(mt+=`
`)):(pt=[generatePrecision(_e),"#define SHADER_TYPE "+_e.shaderType,"#define SHADER_NAME "+_e.shaderName,ft,_e.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",_e.batching?"#define USE_BATCHING":"",_e.batchingColor?"#define USE_BATCHING_COLOR":"",_e.instancing?"#define USE_INSTANCING":"",_e.instancingColor?"#define USE_INSTANCING_COLOR":"",_e.instancingMorph?"#define USE_INSTANCING_MORPH":"",_e.useFog&&_e.fog?"#define USE_FOG":"",_e.useFog&&_e.fogExp2?"#define FOG_EXP2":"",_e.map?"#define USE_MAP":"",_e.envMap?"#define USE_ENVMAP":"",_e.envMap?"#define "+lt:"",_e.lightMap?"#define USE_LIGHTMAP":"",_e.aoMap?"#define USE_AOMAP":"",_e.bumpMap?"#define USE_BUMPMAP":"",_e.normalMap?"#define USE_NORMALMAP":"",_e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",_e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",_e.displacementMap?"#define USE_DISPLACEMENTMAP":"",_e.emissiveMap?"#define USE_EMISSIVEMAP":"",_e.anisotropy?"#define USE_ANISOTROPY":"",_e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",_e.clearcoatMap?"#define USE_CLEARCOATMAP":"",_e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",_e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",_e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",_e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",_e.specularMap?"#define USE_SPECULARMAP":"",_e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",_e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",_e.roughnessMap?"#define USE_ROUGHNESSMAP":"",_e.metalnessMap?"#define USE_METALNESSMAP":"",_e.alphaMap?"#define USE_ALPHAMAP":"",_e.alphaHash?"#define USE_ALPHAHASH":"",_e.transmission?"#define USE_TRANSMISSION":"",_e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",_e.thicknessMap?"#define USE_THICKNESSMAP":"",_e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",_e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",_e.mapUv?"#define MAP_UV "+_e.mapUv:"",_e.alphaMapUv?"#define ALPHAMAP_UV "+_e.alphaMapUv:"",_e.lightMapUv?"#define LIGHTMAP_UV "+_e.lightMapUv:"",_e.aoMapUv?"#define AOMAP_UV "+_e.aoMapUv:"",_e.emissiveMapUv?"#define EMISSIVEMAP_UV "+_e.emissiveMapUv:"",_e.bumpMapUv?"#define BUMPMAP_UV "+_e.bumpMapUv:"",_e.normalMapUv?"#define NORMALMAP_UV "+_e.normalMapUv:"",_e.displacementMapUv?"#define DISPLACEMENTMAP_UV "+_e.displacementMapUv:"",_e.metalnessMapUv?"#define METALNESSMAP_UV "+_e.metalnessMapUv:"",_e.roughnessMapUv?"#define ROUGHNESSMAP_UV "+_e.roughnessMapUv:"",_e.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+_e.anisotropyMapUv:"",_e.clearcoatMapUv?"#define CLEARCOATMAP_UV "+_e.clearcoatMapUv:"",_e.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+_e.clearcoatNormalMapUv:"",_e.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+_e.clearcoatRoughnessMapUv:"",_e.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+_e.iridescenceMapUv:"",_e.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+_e.iridescenceThicknessMapUv:"",_e.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+_e.sheenColorMapUv:"",_e.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+_e.sheenRoughnessMapUv:"",_e.specularMapUv?"#define SPECULARMAP_UV "+_e.specularMapUv:"",_e.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+_e.specularColorMapUv:"",_e.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+_e.specularIntensityMapUv:"",_e.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+_e.transmissionMapUv:"",_e.thicknessMapUv?"#define THICKNESSMAP_UV "+_e.thicknessMapUv:"",_e.vertexTangents&&_e.flatShading===!1?"#define USE_TANGENT":"",_e.vertexColors?"#define USE_COLOR":"",_e.vertexAlphas?"#define USE_COLOR_ALPHA":"",_e.vertexUv1s?"#define USE_UV1":"",_e.vertexUv2s?"#define USE_UV2":"",_e.vertexUv3s?"#define USE_UV3":"",_e.pointsUvs?"#define USE_POINTS_UV":"",_e.flatShading?"#define FLAT_SHADED":"",_e.skinning?"#define USE_SKINNING":"",_e.morphTargets?"#define USE_MORPHTARGETS":"",_e.morphNormals&&_e.flatShading===!1?"#define USE_MORPHNORMALS":"",_e.morphColors?"#define USE_MORPHCOLORS":"",_e.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+_e.morphTextureStride:"",_e.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+_e.morphTargetsCount:"",_e.doubleSided?"#define DOUBLE_SIDED":"",_e.flipSided?"#define FLIP_SIDED":"",_e.shadowMapEnabled?"#define USE_SHADOWMAP":"",_e.shadowMapEnabled?"#define "+ot:"",_e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",_e.numLightProbes>0?"#define USE_LIGHT_PROBES":"",_e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),mt=[generatePrecision(_e),"#define SHADER_TYPE "+_e.shaderType,"#define SHADER_NAME "+_e.shaderName,ft,_e.useFog&&_e.fog?"#define USE_FOG":"",_e.useFog&&_e.fogExp2?"#define FOG_EXP2":"",_e.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",_e.map?"#define USE_MAP":"",_e.matcap?"#define USE_MATCAP":"",_e.envMap?"#define USE_ENVMAP":"",_e.envMap?"#define "+at:"",_e.envMap?"#define "+lt:"",_e.envMap?"#define "+ct:"",ht?"#define CUBEUV_TEXEL_WIDTH "+ht.texelWidth:"",ht?"#define CUBEUV_TEXEL_HEIGHT "+ht.texelHeight:"",ht?"#define CUBEUV_MAX_MIP "+ht.maxMip+".0":"",_e.lightMap?"#define USE_LIGHTMAP":"",_e.aoMap?"#define USE_AOMAP":"",_e.bumpMap?"#define USE_BUMPMAP":"",_e.normalMap?"#define USE_NORMALMAP":"",_e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",_e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",_e.emissiveMap?"#define USE_EMISSIVEMAP":"",_e.anisotropy?"#define USE_ANISOTROPY":"",_e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",_e.clearcoat?"#define USE_CLEARCOAT":"",_e.clearcoatMap?"#define USE_CLEARCOATMAP":"",_e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",_e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",_e.dispersion?"#define USE_DISPERSION":"",_e.iridescence?"#define USE_IRIDESCENCE":"",_e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",_e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",_e.specularMap?"#define USE_SPECULARMAP":"",_e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",_e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",_e.roughnessMap?"#define USE_ROUGHNESSMAP":"",_e.metalnessMap?"#define USE_METALNESSMAP":"",_e.alphaMap?"#define USE_ALPHAMAP":"",_e.alphaTest?"#define USE_ALPHATEST":"",_e.alphaHash?"#define USE_ALPHAHASH":"",_e.sheen?"#define USE_SHEEN":"",_e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",_e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",_e.transmission?"#define USE_TRANSMISSION":"",_e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",_e.thicknessMap?"#define USE_THICKNESSMAP":"",_e.vertexTangents&&_e.flatShading===!1?"#define USE_TANGENT":"",_e.vertexColors||_e.instancingColor||_e.batchingColor?"#define USE_COLOR":"",_e.vertexAlphas?"#define USE_COLOR_ALPHA":"",_e.vertexUv1s?"#define USE_UV1":"",_e.vertexUv2s?"#define USE_UV2":"",_e.vertexUv3s?"#define USE_UV3":"",_e.pointsUvs?"#define USE_POINTS_UV":"",_e.gradientMap?"#define USE_GRADIENTMAP":"",_e.flatShading?"#define FLAT_SHADED":"",_e.doubleSided?"#define DOUBLE_SIDED":"",_e.flipSided?"#define FLIP_SIDED":"",_e.shadowMapEnabled?"#define USE_SHADOWMAP":"",_e.shadowMapEnabled?"#define "+ot:"",_e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",_e.numLightProbes>0?"#define USE_LIGHT_PROBES":"",_e.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",_e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",_e.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",_e.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",_e.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",_e.toneMapping):"",_e.dithering?"#define DITHERING":"",_e.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",_e.outputColorSpace),_e.useDepthPacking?"#define DEPTH_PACKING "+_e.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),it=resolveIncludes(it),it=replaceLightNums(it,_e),it=replaceClippingPlaneNums(it,_e),st=resolveIncludes(st),st=replaceLightNums(st,_e),st=replaceClippingPlaneNums(st,_e),it=unrollLoops(it),st=unrollLoops(st),_e.isRawShaderMaterial!==!0&&(vt=`#version 300 es
`,pt=[ut,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+pt,mt=["#define varying in",_e.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",_e.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+mt);const yt=vt+pt+it,_t=vt+mt+st,St=WebGLShader(nt,nt.VERTEX_SHADER,yt),bt=WebGLShader(nt,nt.FRAGMENT_SHADER,_t);nt.attachShader(dt,St),nt.attachShader(dt,bt),_e.index0AttributeName!==void 0?nt.bindAttribLocation(dt,0,_e.index0AttributeName):_e.morphTargets===!0&&nt.bindAttribLocation(dt,0,"position"),nt.linkProgram(dt);function Et(Ct){if(et.debug.checkShaderErrors){const Rt=nt.getProgramInfoLog(dt).trim(),It=nt.getShaderInfoLog(St).trim(),Dt=nt.getShaderInfoLog(bt).trim();let Ft=!0,$t=!0;if(nt.getProgramParameter(dt,nt.LINK_STATUS)===!1)if(Ft=!1,typeof et.debug.onShaderError=="function")et.debug.onShaderError(nt,dt,St,bt);else{const Yt=getShaderErrors(nt,St,"vertex"),Lt=getShaderErrors(nt,bt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+nt.getError()+" - VALIDATE_STATUS "+nt.getProgramParameter(dt,nt.VALIDATE_STATUS)+`

Material Name: `+Ct.name+`
Material Type: `+Ct.type+`

Program Info Log: `+Rt+`
`+Yt+`
`+Lt)}else Rt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Rt):(It===""||Dt==="")&&($t=!1);$t&&(Ct.diagnostics={runnable:Ft,programLog:Rt,vertexShader:{log:It,prefix:pt},fragmentShader:{log:Dt,prefix:mt}})}nt.deleteShader(St),nt.deleteShader(bt),Mt=new WebGLUniforms(nt,dt),Tt=fetchAttributeLocations(nt,dt)}let Mt;this.getUniforms=function(){return Mt===void 0&&Et(this),Mt};let Tt;this.getAttributes=function(){return Tt===void 0&&Et(this),Tt};let wt=_e.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return wt===!1&&(wt=nt.getProgramParameter(dt,COMPLETION_STATUS_KHR)),wt},this.destroy=function(){tt.releaseStatesOfProgram(this),nt.deleteProgram(dt),this.program=void 0},this.type=_e.shaderType,this.name=_e.shaderName,this.id=programIdCount++,this.cacheKey=_,this.usedTimes=1,this.program=dt,this.vertexShader=St,this.fragmentShader=bt,this}let _id$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_){const _e=_.vertexShader,tt=_.fragmentShader,nt=this._getShaderStage(_e),rt=this._getShaderStage(tt),it=this._getShaderCacheForMaterial(_);return it.has(nt)===!1&&(it.add(nt),nt.usedTimes++),it.has(rt)===!1&&(it.add(rt),rt.usedTimes++),this}remove(_){const _e=this.materialCache.get(_);for(const tt of _e)tt.usedTimes--,tt.usedTimes===0&&this.shaderCache.delete(tt.code);return this.materialCache.delete(_),this}getVertexShaderID(_){return this._getShaderStage(_.vertexShader).id}getFragmentShaderID(_){return this._getShaderStage(_.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_){const _e=this.materialCache;let tt=_e.get(_);return tt===void 0&&(tt=new Set,_e.set(_,tt)),tt}_getShaderStage(_){const _e=this.shaderCache;let tt=_e.get(_);return tt===void 0&&(tt=new WebGLShaderStage(_),_e.set(_,tt)),tt}}class WebGLShaderStage{constructor(_){this.id=_id$1++,this.code=_,this.usedTimes=0}}function WebGLPrograms(et,_,_e,tt,nt,rt,it){const st=new Layers,ot=new WebGLShaderCache,at=new Set,lt=[],ct=nt.logarithmicDepthBuffer,ht=nt.vertexTextures;let ut=nt.precision;const ft={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function dt(Tt){return at.add(Tt),Tt===0?"uv":`uv${Tt}`}function pt(Tt,wt,Ct,Rt,It){const Dt=Rt.fog,Ft=It.geometry,$t=Tt.isMeshStandardMaterial?Rt.environment:null,Yt=(Tt.isMeshStandardMaterial?_e:_).get(Tt.envMap||$t),Lt=Yt&&Yt.mapping===CubeUVReflectionMapping?Yt.image.height:null,Ot=ft[Tt.type];Tt.precision!==null&&(ut=nt.getMaxPrecision(Tt.precision),ut!==Tt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Tt.precision,"not supported, using",ut,"instead."));const Nt=Ft.morphAttributes.position||Ft.morphAttributes.normal||Ft.morphAttributes.color,zt=Nt!==void 0?Nt.length:0;let Ht=0;Ft.morphAttributes.position!==void 0&&(Ht=1),Ft.morphAttributes.normal!==void 0&&(Ht=2),Ft.morphAttributes.color!==void 0&&(Ht=3);let qt,Gt,Xt,Zt;if(Ot){const jt=ShaderLib[Ot];qt=jt.vertexShader,Gt=jt.fragmentShader}else qt=Tt.vertexShader,Gt=Tt.fragmentShader,ot.update(Tt),Xt=ot.getVertexShaderID(Tt),Zt=ot.getFragmentShaderID(Tt);const Qt=et.getRenderTarget(),un=It.isInstancedMesh===!0,wn=It.isBatchedMesh===!0,Tn=!!Tt.map,yn=!!Tt.matcap,Vt=!!Yt,fn=!!Tt.aoMap,ln=!!Tt.lightMap,Jt=!!Tt.bumpMap,on=!!Tt.normalMap,_n=!!Tt.displacementMap,cn=!!Tt.emissiveMap,tn=!!Tt.metalnessMap,Wt=!!Tt.roughnessMap,Bt=Tt.anisotropy>0,nn=Tt.clearcoat>0,en=Tt.dispersion>0,mn=Tt.iridescence>0,sn=Tt.sheen>0,xn=Tt.transmission>0,an=Bt&&!!Tt.anisotropyMap,pn=nn&&!!Tt.clearcoatMap,Sn=nn&&!!Tt.clearcoatNormalMap,gn=nn&&!!Tt.clearcoatRoughnessMap,Rn=mn&&!!Tt.iridescenceMap,Mn=mn&&!!Tt.iridescenceThicknessMap,kn=sn&&!!Tt.sheenColorMap,Fn=sn&&!!Tt.sheenRoughnessMap,Nn=!!Tt.specularMap,Zn=!!Tt.specularColorMap,er=!!Tt.specularIntensityMap,dn=xn&&!!Tt.transmissionMap,$n=xn&&!!Tt.thicknessMap,Pn=!!Tt.gradientMap,Dn=!!Tt.alphaMap,Hn=Tt.alphaTest>0,jn=!!Tt.alphaHash,qn=!!Tt.extensions;let hr=NoToneMapping;Tt.toneMapped&&(Qt===null||Qt.isXRRenderTarget===!0)&&(hr=et.toneMapping);const fr={shaderID:Ot,shaderType:Tt.type,shaderName:Tt.name,vertexShader:qt,fragmentShader:Gt,defines:Tt.defines,customVertexShaderID:Xt,customFragmentShaderID:Zt,isRawShaderMaterial:Tt.isRawShaderMaterial===!0,glslVersion:Tt.glslVersion,precision:ut,batching:wn,batchingColor:wn&&It._colorsTexture!==null,instancing:un,instancingColor:un&&It.instanceColor!==null,instancingMorph:un&&It.morphTexture!==null,supportsVertexTextures:ht,outputColorSpace:Qt===null?et.outputColorSpace:Qt.isXRRenderTarget===!0?Qt.texture.colorSpace:LinearSRGBColorSpace,alphaToCoverage:!!Tt.alphaToCoverage,map:Tn,matcap:yn,envMap:Vt,envMapMode:Vt&&Yt.mapping,envMapCubeUVHeight:Lt,aoMap:fn,lightMap:ln,bumpMap:Jt,normalMap:on,displacementMap:ht&&_n,emissiveMap:cn,normalMapObjectSpace:on&&Tt.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:on&&Tt.normalMapType===TangentSpaceNormalMap,metalnessMap:tn,roughnessMap:Wt,anisotropy:Bt,anisotropyMap:an,clearcoat:nn,clearcoatMap:pn,clearcoatNormalMap:Sn,clearcoatRoughnessMap:gn,dispersion:en,iridescence:mn,iridescenceMap:Rn,iridescenceThicknessMap:Mn,sheen:sn,sheenColorMap:kn,sheenRoughnessMap:Fn,specularMap:Nn,specularColorMap:Zn,specularIntensityMap:er,transmission:xn,transmissionMap:dn,thicknessMap:$n,gradientMap:Pn,opaque:Tt.transparent===!1&&Tt.blending===NormalBlending&&Tt.alphaToCoverage===!1,alphaMap:Dn,alphaTest:Hn,alphaHash:jn,combine:Tt.combine,mapUv:Tn&&dt(Tt.map.channel),aoMapUv:fn&&dt(Tt.aoMap.channel),lightMapUv:ln&&dt(Tt.lightMap.channel),bumpMapUv:Jt&&dt(Tt.bumpMap.channel),normalMapUv:on&&dt(Tt.normalMap.channel),displacementMapUv:_n&&dt(Tt.displacementMap.channel),emissiveMapUv:cn&&dt(Tt.emissiveMap.channel),metalnessMapUv:tn&&dt(Tt.metalnessMap.channel),roughnessMapUv:Wt&&dt(Tt.roughnessMap.channel),anisotropyMapUv:an&&dt(Tt.anisotropyMap.channel),clearcoatMapUv:pn&&dt(Tt.clearcoatMap.channel),clearcoatNormalMapUv:Sn&&dt(Tt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:gn&&dt(Tt.clearcoatRoughnessMap.channel),iridescenceMapUv:Rn&&dt(Tt.iridescenceMap.channel),iridescenceThicknessMapUv:Mn&&dt(Tt.iridescenceThicknessMap.channel),sheenColorMapUv:kn&&dt(Tt.sheenColorMap.channel),sheenRoughnessMapUv:Fn&&dt(Tt.sheenRoughnessMap.channel),specularMapUv:Nn&&dt(Tt.specularMap.channel),specularColorMapUv:Zn&&dt(Tt.specularColorMap.channel),specularIntensityMapUv:er&&dt(Tt.specularIntensityMap.channel),transmissionMapUv:dn&&dt(Tt.transmissionMap.channel),thicknessMapUv:$n&&dt(Tt.thicknessMap.channel),alphaMapUv:Dn&&dt(Tt.alphaMap.channel),vertexTangents:!!Ft.attributes.tangent&&(on||Bt),vertexColors:Tt.vertexColors,vertexAlphas:Tt.vertexColors===!0&&!!Ft.attributes.color&&Ft.attributes.color.itemSize===4,pointsUvs:It.isPoints===!0&&!!Ft.attributes.uv&&(Tn||Dn),fog:!!Dt,useFog:Tt.fog===!0,fogExp2:!!Dt&&Dt.isFogExp2,flatShading:Tt.flatShading===!0,sizeAttenuation:Tt.sizeAttenuation===!0,logarithmicDepthBuffer:ct,skinning:It.isSkinnedMesh===!0,morphTargets:Ft.morphAttributes.position!==void 0,morphNormals:Ft.morphAttributes.normal!==void 0,morphColors:Ft.morphAttributes.color!==void 0,morphTargetsCount:zt,morphTextureStride:Ht,numDirLights:wt.directional.length,numPointLights:wt.point.length,numSpotLights:wt.spot.length,numSpotLightMaps:wt.spotLightMap.length,numRectAreaLights:wt.rectArea.length,numHemiLights:wt.hemi.length,numDirLightShadows:wt.directionalShadowMap.length,numPointLightShadows:wt.pointShadowMap.length,numSpotLightShadows:wt.spotShadowMap.length,numSpotLightShadowsWithMaps:wt.numSpotLightShadowsWithMaps,numLightProbes:wt.numLightProbes,numClippingPlanes:it.numPlanes,numClipIntersection:it.numIntersection,dithering:Tt.dithering,shadowMapEnabled:et.shadowMap.enabled&&Ct.length>0,shadowMapType:et.shadowMap.type,toneMapping:hr,decodeVideoTexture:Tn&&Tt.map.isVideoTexture===!0&&ColorManagement.getTransfer(Tt.map.colorSpace)===SRGBTransfer,premultipliedAlpha:Tt.premultipliedAlpha,doubleSided:Tt.side===DoubleSide,flipSided:Tt.side===BackSide,useDepthPacking:Tt.depthPacking>=0,depthPacking:Tt.depthPacking||0,index0AttributeName:Tt.index0AttributeName,extensionClipCullDistance:qn&&Tt.extensions.clipCullDistance===!0&&tt.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(qn&&Tt.extensions.multiDraw===!0||wn)&&tt.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:tt.has("KHR_parallel_shader_compile"),customProgramCacheKey:Tt.customProgramCacheKey()};return fr.vertexUv1s=at.has(1),fr.vertexUv2s=at.has(2),fr.vertexUv3s=at.has(3),at.clear(),fr}function mt(Tt){const wt=[];if(Tt.shaderID?wt.push(Tt.shaderID):(wt.push(Tt.customVertexShaderID),wt.push(Tt.customFragmentShaderID)),Tt.defines!==void 0)for(const Ct in Tt.defines)wt.push(Ct),wt.push(Tt.defines[Ct]);return Tt.isRawShaderMaterial===!1&&(vt(wt,Tt),yt(wt,Tt),wt.push(et.outputColorSpace)),wt.push(Tt.customProgramCacheKey),wt.join()}function vt(Tt,wt){Tt.push(wt.precision),Tt.push(wt.outputColorSpace),Tt.push(wt.envMapMode),Tt.push(wt.envMapCubeUVHeight),Tt.push(wt.mapUv),Tt.push(wt.alphaMapUv),Tt.push(wt.lightMapUv),Tt.push(wt.aoMapUv),Tt.push(wt.bumpMapUv),Tt.push(wt.normalMapUv),Tt.push(wt.displacementMapUv),Tt.push(wt.emissiveMapUv),Tt.push(wt.metalnessMapUv),Tt.push(wt.roughnessMapUv),Tt.push(wt.anisotropyMapUv),Tt.push(wt.clearcoatMapUv),Tt.push(wt.clearcoatNormalMapUv),Tt.push(wt.clearcoatRoughnessMapUv),Tt.push(wt.iridescenceMapUv),Tt.push(wt.iridescenceThicknessMapUv),Tt.push(wt.sheenColorMapUv),Tt.push(wt.sheenRoughnessMapUv),Tt.push(wt.specularMapUv),Tt.push(wt.specularColorMapUv),Tt.push(wt.specularIntensityMapUv),Tt.push(wt.transmissionMapUv),Tt.push(wt.thicknessMapUv),Tt.push(wt.combine),Tt.push(wt.fogExp2),Tt.push(wt.sizeAttenuation),Tt.push(wt.morphTargetsCount),Tt.push(wt.morphAttributeCount),Tt.push(wt.numDirLights),Tt.push(wt.numPointLights),Tt.push(wt.numSpotLights),Tt.push(wt.numSpotLightMaps),Tt.push(wt.numHemiLights),Tt.push(wt.numRectAreaLights),Tt.push(wt.numDirLightShadows),Tt.push(wt.numPointLightShadows),Tt.push(wt.numSpotLightShadows),Tt.push(wt.numSpotLightShadowsWithMaps),Tt.push(wt.numLightProbes),Tt.push(wt.shadowMapType),Tt.push(wt.toneMapping),Tt.push(wt.numClippingPlanes),Tt.push(wt.numClipIntersection),Tt.push(wt.depthPacking)}function yt(Tt,wt){st.disableAll(),wt.supportsVertexTextures&&st.enable(0),wt.instancing&&st.enable(1),wt.instancingColor&&st.enable(2),wt.instancingMorph&&st.enable(3),wt.matcap&&st.enable(4),wt.envMap&&st.enable(5),wt.normalMapObjectSpace&&st.enable(6),wt.normalMapTangentSpace&&st.enable(7),wt.clearcoat&&st.enable(8),wt.iridescence&&st.enable(9),wt.alphaTest&&st.enable(10),wt.vertexColors&&st.enable(11),wt.vertexAlphas&&st.enable(12),wt.vertexUv1s&&st.enable(13),wt.vertexUv2s&&st.enable(14),wt.vertexUv3s&&st.enable(15),wt.vertexTangents&&st.enable(16),wt.anisotropy&&st.enable(17),wt.alphaHash&&st.enable(18),wt.batching&&st.enable(19),wt.dispersion&&st.enable(20),wt.batchingColor&&st.enable(21),Tt.push(st.mask),st.disableAll(),wt.fog&&st.enable(0),wt.useFog&&st.enable(1),wt.flatShading&&st.enable(2),wt.logarithmicDepthBuffer&&st.enable(3),wt.skinning&&st.enable(4),wt.morphTargets&&st.enable(5),wt.morphNormals&&st.enable(6),wt.morphColors&&st.enable(7),wt.premultipliedAlpha&&st.enable(8),wt.shadowMapEnabled&&st.enable(9),wt.doubleSided&&st.enable(10),wt.flipSided&&st.enable(11),wt.useDepthPacking&&st.enable(12),wt.dithering&&st.enable(13),wt.transmission&&st.enable(14),wt.sheen&&st.enable(15),wt.opaque&&st.enable(16),wt.pointsUvs&&st.enable(17),wt.decodeVideoTexture&&st.enable(18),wt.alphaToCoverage&&st.enable(19),Tt.push(st.mask)}function _t(Tt){const wt=ft[Tt.type];let Ct;if(wt){const Rt=ShaderLib[wt];Ct=UniformsUtils.clone(Rt.uniforms)}else Ct=Tt.uniforms;return Ct}function St(Tt,wt){let Ct;for(let Rt=0,It=lt.length;Rt<It;Rt++){const Dt=lt[Rt];if(Dt.cacheKey===wt){Ct=Dt,++Ct.usedTimes;break}}return Ct===void 0&&(Ct=new WebGLProgram(et,wt,Tt,rt),lt.push(Ct)),Ct}function bt(Tt){if(--Tt.usedTimes===0){const wt=lt.indexOf(Tt);lt[wt]=lt[lt.length-1],lt.pop(),Tt.destroy()}}function Et(Tt){ot.remove(Tt)}function Mt(){ot.dispose()}return{getParameters:pt,getProgramCacheKey:mt,getUniforms:_t,acquireProgram:St,releaseProgram:bt,releaseShaderCache:Et,programs:lt,dispose:Mt}}function WebGLProperties(){let et=new WeakMap;function _(rt){let it=et.get(rt);return it===void 0&&(it={},et.set(rt,it)),it}function _e(rt){et.delete(rt)}function tt(rt,it,st){et.get(rt)[it]=st}function nt(){et=new WeakMap}return{get:_,remove:_e,update:tt,dispose:nt}}function painterSortStable(et,_){return et.groupOrder!==_.groupOrder?et.groupOrder-_.groupOrder:et.renderOrder!==_.renderOrder?et.renderOrder-_.renderOrder:et.material.id!==_.material.id?et.material.id-_.material.id:et.z!==_.z?et.z-_.z:et.id-_.id}function reversePainterSortStable(et,_){return et.groupOrder!==_.groupOrder?et.groupOrder-_.groupOrder:et.renderOrder!==_.renderOrder?et.renderOrder-_.renderOrder:et.z!==_.z?_.z-et.z:et.id-_.id}function WebGLRenderList(){const et=[];let _=0;const _e=[],tt=[],nt=[];function rt(){_=0,_e.length=0,tt.length=0,nt.length=0}function it(ct,ht,ut,ft,dt,pt){let mt=et[_];return mt===void 0?(mt={id:ct.id,object:ct,geometry:ht,material:ut,groupOrder:ft,renderOrder:ct.renderOrder,z:dt,group:pt},et[_]=mt):(mt.id=ct.id,mt.object=ct,mt.geometry=ht,mt.material=ut,mt.groupOrder=ft,mt.renderOrder=ct.renderOrder,mt.z=dt,mt.group=pt),_++,mt}function st(ct,ht,ut,ft,dt,pt){const mt=it(ct,ht,ut,ft,dt,pt);ut.transmission>0?tt.push(mt):ut.transparent===!0?nt.push(mt):_e.push(mt)}function ot(ct,ht,ut,ft,dt,pt){const mt=it(ct,ht,ut,ft,dt,pt);ut.transmission>0?tt.unshift(mt):ut.transparent===!0?nt.unshift(mt):_e.unshift(mt)}function at(ct,ht){_e.length>1&&_e.sort(ct||painterSortStable),tt.length>1&&tt.sort(ht||reversePainterSortStable),nt.length>1&&nt.sort(ht||reversePainterSortStable)}function lt(){for(let ct=_,ht=et.length;ct<ht;ct++){const ut=et[ct];if(ut.id===null)break;ut.id=null,ut.object=null,ut.geometry=null,ut.material=null,ut.group=null}}return{opaque:_e,transmissive:tt,transparent:nt,init:rt,push:st,unshift:ot,finish:lt,sort:at}}function WebGLRenderLists(){let et=new WeakMap;function _(tt,nt){const rt=et.get(tt);let it;return rt===void 0?(it=new WebGLRenderList,et.set(tt,[it])):nt>=rt.length?(it=new WebGLRenderList,rt.push(it)):it=rt[nt],it}function _e(){et=new WeakMap}return{get:_,dispose:_e}}function UniformsCache(){const et={};return{get:function(_){if(et[_.id]!==void 0)return et[_.id];let _e;switch(_.type){case"DirectionalLight":_e={direction:new Vector3,color:new Color$1};break;case"SpotLight":_e={position:new Vector3,direction:new Vector3,color:new Color$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":_e={position:new Vector3,color:new Color$1,distance:0,decay:0};break;case"HemisphereLight":_e={direction:new Vector3,skyColor:new Color$1,groundColor:new Color$1};break;case"RectAreaLight":_e={color:new Color$1,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return et[_.id]=_e,_e}}}function ShadowUniformsCache(){const et={};return{get:function(_){if(et[_.id]!==void 0)return et[_.id];let _e;switch(_.type){case"DirectionalLight":_e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":_e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":_e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return et[_.id]=_e,_e}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(et,_){return(_.castShadow?2:0)-(et.castShadow?2:0)+(_.map?1:0)-(et.map?1:0)}function WebGLLights(et){const _=new UniformsCache,_e=ShadowUniformsCache(),tt={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let at=0;at<9;at++)tt.probe.push(new Vector3);const nt=new Vector3,rt=new Matrix4,it=new Matrix4;function st(at){let lt=0,ct=0,ht=0;for(let Tt=0;Tt<9;Tt++)tt.probe[Tt].set(0,0,0);let ut=0,ft=0,dt=0,pt=0,mt=0,vt=0,yt=0,_t=0,St=0,bt=0,Et=0;at.sort(shadowCastingAndTexturingLightsFirst);for(let Tt=0,wt=at.length;Tt<wt;Tt++){const Ct=at[Tt],Rt=Ct.color,It=Ct.intensity,Dt=Ct.distance,Ft=Ct.shadow&&Ct.shadow.map?Ct.shadow.map.texture:null;if(Ct.isAmbientLight)lt+=Rt.r*It,ct+=Rt.g*It,ht+=Rt.b*It;else if(Ct.isLightProbe){for(let $t=0;$t<9;$t++)tt.probe[$t].addScaledVector(Ct.sh.coefficients[$t],It);Et++}else if(Ct.isDirectionalLight){const $t=_.get(Ct);if($t.color.copy(Ct.color).multiplyScalar(Ct.intensity),Ct.castShadow){const Yt=Ct.shadow,Lt=_e.get(Ct);Lt.shadowIntensity=Yt.intensity,Lt.shadowBias=Yt.bias,Lt.shadowNormalBias=Yt.normalBias,Lt.shadowRadius=Yt.radius,Lt.shadowMapSize=Yt.mapSize,tt.directionalShadow[ut]=Lt,tt.directionalShadowMap[ut]=Ft,tt.directionalShadowMatrix[ut]=Ct.shadow.matrix,vt++}tt.directional[ut]=$t,ut++}else if(Ct.isSpotLight){const $t=_.get(Ct);$t.position.setFromMatrixPosition(Ct.matrixWorld),$t.color.copy(Rt).multiplyScalar(It),$t.distance=Dt,$t.coneCos=Math.cos(Ct.angle),$t.penumbraCos=Math.cos(Ct.angle*(1-Ct.penumbra)),$t.decay=Ct.decay,tt.spot[dt]=$t;const Yt=Ct.shadow;if(Ct.map&&(tt.spotLightMap[St]=Ct.map,St++,Yt.updateMatrices(Ct),Ct.castShadow&&bt++),tt.spotLightMatrix[dt]=Yt.matrix,Ct.castShadow){const Lt=_e.get(Ct);Lt.shadowIntensity=Yt.intensity,Lt.shadowBias=Yt.bias,Lt.shadowNormalBias=Yt.normalBias,Lt.shadowRadius=Yt.radius,Lt.shadowMapSize=Yt.mapSize,tt.spotShadow[dt]=Lt,tt.spotShadowMap[dt]=Ft,_t++}dt++}else if(Ct.isRectAreaLight){const $t=_.get(Ct);$t.color.copy(Rt).multiplyScalar(It),$t.halfWidth.set(Ct.width*.5,0,0),$t.halfHeight.set(0,Ct.height*.5,0),tt.rectArea[pt]=$t,pt++}else if(Ct.isPointLight){const $t=_.get(Ct);if($t.color.copy(Ct.color).multiplyScalar(Ct.intensity),$t.distance=Ct.distance,$t.decay=Ct.decay,Ct.castShadow){const Yt=Ct.shadow,Lt=_e.get(Ct);Lt.shadowIntensity=Yt.intensity,Lt.shadowBias=Yt.bias,Lt.shadowNormalBias=Yt.normalBias,Lt.shadowRadius=Yt.radius,Lt.shadowMapSize=Yt.mapSize,Lt.shadowCameraNear=Yt.camera.near,Lt.shadowCameraFar=Yt.camera.far,tt.pointShadow[ft]=Lt,tt.pointShadowMap[ft]=Ft,tt.pointShadowMatrix[ft]=Ct.shadow.matrix,yt++}tt.point[ft]=$t,ft++}else if(Ct.isHemisphereLight){const $t=_.get(Ct);$t.skyColor.copy(Ct.color).multiplyScalar(It),$t.groundColor.copy(Ct.groundColor).multiplyScalar(It),tt.hemi[mt]=$t,mt++}}pt>0&&(et.has("OES_texture_float_linear")===!0?(tt.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,tt.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(tt.rectAreaLTC1=UniformsLib.LTC_HALF_1,tt.rectAreaLTC2=UniformsLib.LTC_HALF_2)),tt.ambient[0]=lt,tt.ambient[1]=ct,tt.ambient[2]=ht;const Mt=tt.hash;(Mt.directionalLength!==ut||Mt.pointLength!==ft||Mt.spotLength!==dt||Mt.rectAreaLength!==pt||Mt.hemiLength!==mt||Mt.numDirectionalShadows!==vt||Mt.numPointShadows!==yt||Mt.numSpotShadows!==_t||Mt.numSpotMaps!==St||Mt.numLightProbes!==Et)&&(tt.directional.length=ut,tt.spot.length=dt,tt.rectArea.length=pt,tt.point.length=ft,tt.hemi.length=mt,tt.directionalShadow.length=vt,tt.directionalShadowMap.length=vt,tt.pointShadow.length=yt,tt.pointShadowMap.length=yt,tt.spotShadow.length=_t,tt.spotShadowMap.length=_t,tt.directionalShadowMatrix.length=vt,tt.pointShadowMatrix.length=yt,tt.spotLightMatrix.length=_t+St-bt,tt.spotLightMap.length=St,tt.numSpotLightShadowsWithMaps=bt,tt.numLightProbes=Et,Mt.directionalLength=ut,Mt.pointLength=ft,Mt.spotLength=dt,Mt.rectAreaLength=pt,Mt.hemiLength=mt,Mt.numDirectionalShadows=vt,Mt.numPointShadows=yt,Mt.numSpotShadows=_t,Mt.numSpotMaps=St,Mt.numLightProbes=Et,tt.version=nextVersion++)}function ot(at,lt){let ct=0,ht=0,ut=0,ft=0,dt=0;const pt=lt.matrixWorldInverse;for(let mt=0,vt=at.length;mt<vt;mt++){const yt=at[mt];if(yt.isDirectionalLight){const _t=tt.directional[ct];_t.direction.setFromMatrixPosition(yt.matrixWorld),nt.setFromMatrixPosition(yt.target.matrixWorld),_t.direction.sub(nt),_t.direction.transformDirection(pt),ct++}else if(yt.isSpotLight){const _t=tt.spot[ut];_t.position.setFromMatrixPosition(yt.matrixWorld),_t.position.applyMatrix4(pt),_t.direction.setFromMatrixPosition(yt.matrixWorld),nt.setFromMatrixPosition(yt.target.matrixWorld),_t.direction.sub(nt),_t.direction.transformDirection(pt),ut++}else if(yt.isRectAreaLight){const _t=tt.rectArea[ft];_t.position.setFromMatrixPosition(yt.matrixWorld),_t.position.applyMatrix4(pt),it.identity(),rt.copy(yt.matrixWorld),rt.premultiply(pt),it.extractRotation(rt),_t.halfWidth.set(yt.width*.5,0,0),_t.halfHeight.set(0,yt.height*.5,0),_t.halfWidth.applyMatrix4(it),_t.halfHeight.applyMatrix4(it),ft++}else if(yt.isPointLight){const _t=tt.point[ht];_t.position.setFromMatrixPosition(yt.matrixWorld),_t.position.applyMatrix4(pt),ht++}else if(yt.isHemisphereLight){const _t=tt.hemi[dt];_t.direction.setFromMatrixPosition(yt.matrixWorld),_t.direction.transformDirection(pt),dt++}}}return{setup:st,setupView:ot,state:tt}}function WebGLRenderState(et){const _=new WebGLLights(et),_e=[],tt=[];function nt(lt){at.camera=lt,_e.length=0,tt.length=0}function rt(lt){_e.push(lt)}function it(lt){tt.push(lt)}function st(){_.setup(_e)}function ot(lt){_.setupView(_e,lt)}const at={lightsArray:_e,shadowsArray:tt,camera:null,lights:_,transmissionRenderTarget:{}};return{init:nt,state:at,setupLights:st,setupLightsView:ot,pushLight:rt,pushShadow:it}}function WebGLRenderStates(et){let _=new WeakMap;function _e(nt,rt=0){const it=_.get(nt);let st;return it===void 0?(st=new WebGLRenderState(et),_.set(nt,[st])):rt>=it.length?(st=new WebGLRenderState(et),it.push(st)):st=it[rt],st}function tt(){_=new WeakMap}return{get:_e,dispose:tt}}class MeshDepthMaterial extends Material{constructor(_){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)}copy(_){return super.copy(_),this.depthPacking=_.depthPacking,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_)}copy(_){return super.copy(_),this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(et,_,_e){let tt=new Frustum;const nt=new Vector2,rt=new Vector2,it=new Vector4,st=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),ot=new MeshDistanceMaterial,at={},lt=_e.maxTextureSize,ct={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},ht=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),ut=ht.clone();ut.defines.HORIZONTAL_PASS=1;const ft=new BufferGeometry;ft.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const dt=new Mesh(ft,ht),pt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let mt=this.type;this.render=function(bt,Et,Mt){if(pt.enabled===!1||pt.autoUpdate===!1&&pt.needsUpdate===!1||bt.length===0)return;const Tt=et.getRenderTarget(),wt=et.getActiveCubeFace(),Ct=et.getActiveMipmapLevel(),Rt=et.state;Rt.setBlending(NoBlending),Rt.buffers.color.setClear(1,1,1,1),Rt.buffers.depth.setTest(!0),Rt.setScissorTest(!1);const It=mt!==VSMShadowMap&&this.type===VSMShadowMap,Dt=mt===VSMShadowMap&&this.type!==VSMShadowMap;for(let Ft=0,$t=bt.length;Ft<$t;Ft++){const Yt=bt[Ft],Lt=Yt.shadow;if(Lt===void 0){console.warn("THREE.WebGLShadowMap:",Yt,"has no shadow.");continue}if(Lt.autoUpdate===!1&&Lt.needsUpdate===!1)continue;nt.copy(Lt.mapSize);const Ot=Lt.getFrameExtents();if(nt.multiply(Ot),rt.copy(Lt.mapSize),(nt.x>lt||nt.y>lt)&&(nt.x>lt&&(rt.x=Math.floor(lt/Ot.x),nt.x=rt.x*Ot.x,Lt.mapSize.x=rt.x),nt.y>lt&&(rt.y=Math.floor(lt/Ot.y),nt.y=rt.y*Ot.y,Lt.mapSize.y=rt.y)),Lt.map===null||It===!0||Dt===!0){const zt=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};Lt.map!==null&&Lt.map.dispose(),Lt.map=new WebGLRenderTarget(nt.x,nt.y,zt),Lt.map.texture.name=Yt.name+".shadowMap",Lt.camera.updateProjectionMatrix()}et.setRenderTarget(Lt.map),et.clear();const Nt=Lt.getViewportCount();for(let zt=0;zt<Nt;zt++){const Ht=Lt.getViewport(zt);it.set(rt.x*Ht.x,rt.y*Ht.y,rt.x*Ht.z,rt.y*Ht.w),Rt.viewport(it),Lt.updateMatrices(Yt,zt),tt=Lt.getFrustum(),_t(Et,Mt,Lt.camera,Yt,this.type)}Lt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&vt(Lt,Mt),Lt.needsUpdate=!1}mt=this.type,pt.needsUpdate=!1,et.setRenderTarget(Tt,wt,Ct)};function vt(bt,Et){const Mt=_.update(dt);ht.defines.VSM_SAMPLES!==bt.blurSamples&&(ht.defines.VSM_SAMPLES=bt.blurSamples,ut.defines.VSM_SAMPLES=bt.blurSamples,ht.needsUpdate=!0,ut.needsUpdate=!0),bt.mapPass===null&&(bt.mapPass=new WebGLRenderTarget(nt.x,nt.y)),ht.uniforms.shadow_pass.value=bt.map.texture,ht.uniforms.resolution.value=bt.mapSize,ht.uniforms.radius.value=bt.radius,et.setRenderTarget(bt.mapPass),et.clear(),et.renderBufferDirect(Et,null,Mt,ht,dt,null),ut.uniforms.shadow_pass.value=bt.mapPass.texture,ut.uniforms.resolution.value=bt.mapSize,ut.uniforms.radius.value=bt.radius,et.setRenderTarget(bt.map),et.clear(),et.renderBufferDirect(Et,null,Mt,ut,dt,null)}function yt(bt,Et,Mt,Tt){let wt=null;const Ct=Mt.isPointLight===!0?bt.customDistanceMaterial:bt.customDepthMaterial;if(Ct!==void 0)wt=Ct;else if(wt=Mt.isPointLight===!0?ot:st,et.localClippingEnabled&&Et.clipShadows===!0&&Array.isArray(Et.clippingPlanes)&&Et.clippingPlanes.length!==0||Et.displacementMap&&Et.displacementScale!==0||Et.alphaMap&&Et.alphaTest>0||Et.map&&Et.alphaTest>0){const Rt=wt.uuid,It=Et.uuid;let Dt=at[Rt];Dt===void 0&&(Dt={},at[Rt]=Dt);let Ft=Dt[It];Ft===void 0&&(Ft=wt.clone(),Dt[It]=Ft,Et.addEventListener("dispose",St)),wt=Ft}if(wt.visible=Et.visible,wt.wireframe=Et.wireframe,Tt===VSMShadowMap?wt.side=Et.shadowSide!==null?Et.shadowSide:Et.side:wt.side=Et.shadowSide!==null?Et.shadowSide:ct[Et.side],wt.alphaMap=Et.alphaMap,wt.alphaTest=Et.alphaTest,wt.map=Et.map,wt.clipShadows=Et.clipShadows,wt.clippingPlanes=Et.clippingPlanes,wt.clipIntersection=Et.clipIntersection,wt.displacementMap=Et.displacementMap,wt.displacementScale=Et.displacementScale,wt.displacementBias=Et.displacementBias,wt.wireframeLinewidth=Et.wireframeLinewidth,wt.linewidth=Et.linewidth,Mt.isPointLight===!0&&wt.isMeshDistanceMaterial===!0){const Rt=et.properties.get(wt);Rt.light=Mt}return wt}function _t(bt,Et,Mt,Tt,wt){if(bt.visible===!1)return;if(bt.layers.test(Et.layers)&&(bt.isMesh||bt.isLine||bt.isPoints)&&(bt.castShadow||bt.receiveShadow&&wt===VSMShadowMap)&&(!bt.frustumCulled||tt.intersectsObject(bt))){bt.modelViewMatrix.multiplyMatrices(Mt.matrixWorldInverse,bt.matrixWorld);const It=_.update(bt),Dt=bt.material;if(Array.isArray(Dt)){const Ft=It.groups;for(let $t=0,Yt=Ft.length;$t<Yt;$t++){const Lt=Ft[$t],Ot=Dt[Lt.materialIndex];if(Ot&&Ot.visible){const Nt=yt(bt,Ot,Tt,wt);bt.onBeforeShadow(et,bt,Et,Mt,It,Nt,Lt),et.renderBufferDirect(Mt,null,It,Nt,bt,Lt),bt.onAfterShadow(et,bt,Et,Mt,It,Nt,Lt)}}}else if(Dt.visible){const Ft=yt(bt,Dt,Tt,wt);bt.onBeforeShadow(et,bt,Et,Mt,It,Ft,null),et.renderBufferDirect(Mt,null,It,Ft,bt,null),bt.onAfterShadow(et,bt,Et,Mt,It,Ft,null)}}const Rt=bt.children;for(let It=0,Dt=Rt.length;It<Dt;It++)_t(Rt[It],Et,Mt,Tt,wt)}function St(bt){bt.target.removeEventListener("dispose",St);for(const Mt in at){const Tt=at[Mt],wt=bt.target.uuid;wt in Tt&&(Tt[wt].dispose(),delete Tt[wt])}}}function WebGLState(et){function _(){let dn=!1;const $n=new Vector4;let Pn=null;const Dn=new Vector4(0,0,0,0);return{setMask:function(Hn){Pn!==Hn&&!dn&&(et.colorMask(Hn,Hn,Hn,Hn),Pn=Hn)},setLocked:function(Hn){dn=Hn},setClear:function(Hn,jn,qn,hr,fr){fr===!0&&(Hn*=hr,jn*=hr,qn*=hr),$n.set(Hn,jn,qn,hr),Dn.equals($n)===!1&&(et.clearColor(Hn,jn,qn,hr),Dn.copy($n))},reset:function(){dn=!1,Pn=null,Dn.set(-1,0,0,0)}}}function _e(){let dn=!1,$n=null,Pn=null,Dn=null;return{setTest:function(Hn){Hn?Zt(et.DEPTH_TEST):Qt(et.DEPTH_TEST)},setMask:function(Hn){$n!==Hn&&!dn&&(et.depthMask(Hn),$n=Hn)},setFunc:function(Hn){if(Pn!==Hn){switch(Hn){case NeverDepth:et.depthFunc(et.NEVER);break;case AlwaysDepth:et.depthFunc(et.ALWAYS);break;case LessDepth:et.depthFunc(et.LESS);break;case LessEqualDepth:et.depthFunc(et.LEQUAL);break;case EqualDepth:et.depthFunc(et.EQUAL);break;case GreaterEqualDepth:et.depthFunc(et.GEQUAL);break;case GreaterDepth:et.depthFunc(et.GREATER);break;case NotEqualDepth:et.depthFunc(et.NOTEQUAL);break;default:et.depthFunc(et.LEQUAL)}Pn=Hn}},setLocked:function(Hn){dn=Hn},setClear:function(Hn){Dn!==Hn&&(et.clearDepth(Hn),Dn=Hn)},reset:function(){dn=!1,$n=null,Pn=null,Dn=null}}}function tt(){let dn=!1,$n=null,Pn=null,Dn=null,Hn=null,jn=null,qn=null,hr=null,fr=null;return{setTest:function(jt){dn||(jt?Zt(et.STENCIL_TEST):Qt(et.STENCIL_TEST))},setMask:function(jt){$n!==jt&&!dn&&(et.stencilMask(jt),$n=jt)},setFunc:function(jt,hn,En){(Pn!==jt||Dn!==hn||Hn!==En)&&(et.stencilFunc(jt,hn,En),Pn=jt,Dn=hn,Hn=En)},setOp:function(jt,hn,En){(jn!==jt||qn!==hn||hr!==En)&&(et.stencilOp(jt,hn,En),jn=jt,qn=hn,hr=En)},setLocked:function(jt){dn=jt},setClear:function(jt){fr!==jt&&(et.clearStencil(jt),fr=jt)},reset:function(){dn=!1,$n=null,Pn=null,Dn=null,Hn=null,jn=null,qn=null,hr=null,fr=null}}}const nt=new _,rt=new _e,it=new tt,st=new WeakMap,ot=new WeakMap;let at={},lt={},ct=new WeakMap,ht=[],ut=null,ft=!1,dt=null,pt=null,mt=null,vt=null,yt=null,_t=null,St=null,bt=new Color$1(0,0,0),Et=0,Mt=!1,Tt=null,wt=null,Ct=null,Rt=null,It=null;const Dt=et.getParameter(et.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ft=!1,$t=0;const Yt=et.getParameter(et.VERSION);Yt.indexOf("WebGL")!==-1?($t=parseFloat(/^WebGL (\d)/.exec(Yt)[1]),Ft=$t>=1):Yt.indexOf("OpenGL ES")!==-1&&($t=parseFloat(/^OpenGL ES (\d)/.exec(Yt)[1]),Ft=$t>=2);let Lt=null,Ot={};const Nt=et.getParameter(et.SCISSOR_BOX),zt=et.getParameter(et.VIEWPORT),Ht=new Vector4().fromArray(Nt),qt=new Vector4().fromArray(zt);function Gt(dn,$n,Pn,Dn){const Hn=new Uint8Array(4),jn=et.createTexture();et.bindTexture(dn,jn),et.texParameteri(dn,et.TEXTURE_MIN_FILTER,et.NEAREST),et.texParameteri(dn,et.TEXTURE_MAG_FILTER,et.NEAREST);for(let qn=0;qn<Pn;qn++)dn===et.TEXTURE_3D||dn===et.TEXTURE_2D_ARRAY?et.texImage3D($n,0,et.RGBA,1,1,Dn,0,et.RGBA,et.UNSIGNED_BYTE,Hn):et.texImage2D($n+qn,0,et.RGBA,1,1,0,et.RGBA,et.UNSIGNED_BYTE,Hn);return jn}const Xt={};Xt[et.TEXTURE_2D]=Gt(et.TEXTURE_2D,et.TEXTURE_2D,1),Xt[et.TEXTURE_CUBE_MAP]=Gt(et.TEXTURE_CUBE_MAP,et.TEXTURE_CUBE_MAP_POSITIVE_X,6),Xt[et.TEXTURE_2D_ARRAY]=Gt(et.TEXTURE_2D_ARRAY,et.TEXTURE_2D_ARRAY,1,1),Xt[et.TEXTURE_3D]=Gt(et.TEXTURE_3D,et.TEXTURE_3D,1,1),nt.setClear(0,0,0,1),rt.setClear(1),it.setClear(0),Zt(et.DEPTH_TEST),rt.setFunc(LessEqualDepth),Jt(!1),on(CullFaceBack),Zt(et.CULL_FACE),fn(NoBlending);function Zt(dn){at[dn]!==!0&&(et.enable(dn),at[dn]=!0)}function Qt(dn){at[dn]!==!1&&(et.disable(dn),at[dn]=!1)}function un(dn,$n){return lt[dn]!==$n?(et.bindFramebuffer(dn,$n),lt[dn]=$n,dn===et.DRAW_FRAMEBUFFER&&(lt[et.FRAMEBUFFER]=$n),dn===et.FRAMEBUFFER&&(lt[et.DRAW_FRAMEBUFFER]=$n),!0):!1}function wn(dn,$n){let Pn=ht,Dn=!1;if(dn){Pn=ct.get($n),Pn===void 0&&(Pn=[],ct.set($n,Pn));const Hn=dn.textures;if(Pn.length!==Hn.length||Pn[0]!==et.COLOR_ATTACHMENT0){for(let jn=0,qn=Hn.length;jn<qn;jn++)Pn[jn]=et.COLOR_ATTACHMENT0+jn;Pn.length=Hn.length,Dn=!0}}else Pn[0]!==et.BACK&&(Pn[0]=et.BACK,Dn=!0);Dn&&et.drawBuffers(Pn)}function Tn(dn){return ut!==dn?(et.useProgram(dn),ut=dn,!0):!1}const yn={[AddEquation]:et.FUNC_ADD,[SubtractEquation]:et.FUNC_SUBTRACT,[ReverseSubtractEquation]:et.FUNC_REVERSE_SUBTRACT};yn[MinEquation]=et.MIN,yn[MaxEquation]=et.MAX;const Vt={[ZeroFactor]:et.ZERO,[OneFactor]:et.ONE,[SrcColorFactor]:et.SRC_COLOR,[SrcAlphaFactor]:et.SRC_ALPHA,[SrcAlphaSaturateFactor]:et.SRC_ALPHA_SATURATE,[DstColorFactor]:et.DST_COLOR,[DstAlphaFactor]:et.DST_ALPHA,[OneMinusSrcColorFactor]:et.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:et.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:et.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:et.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:et.CONSTANT_COLOR,[OneMinusConstantColorFactor]:et.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:et.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:et.ONE_MINUS_CONSTANT_ALPHA};function fn(dn,$n,Pn,Dn,Hn,jn,qn,hr,fr,jt){if(dn===NoBlending){ft===!0&&(Qt(et.BLEND),ft=!1);return}if(ft===!1&&(Zt(et.BLEND),ft=!0),dn!==CustomBlending){if(dn!==dt||jt!==Mt){if((pt!==AddEquation||yt!==AddEquation)&&(et.blendEquation(et.FUNC_ADD),pt=AddEquation,yt=AddEquation),jt)switch(dn){case NormalBlending:et.blendFuncSeparate(et.ONE,et.ONE_MINUS_SRC_ALPHA,et.ONE,et.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:et.blendFunc(et.ONE,et.ONE);break;case SubtractiveBlending:et.blendFuncSeparate(et.ZERO,et.ONE_MINUS_SRC_COLOR,et.ZERO,et.ONE);break;case MultiplyBlending:et.blendFuncSeparate(et.ZERO,et.SRC_COLOR,et.ZERO,et.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",dn);break}else switch(dn){case NormalBlending:et.blendFuncSeparate(et.SRC_ALPHA,et.ONE_MINUS_SRC_ALPHA,et.ONE,et.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:et.blendFunc(et.SRC_ALPHA,et.ONE);break;case SubtractiveBlending:et.blendFuncSeparate(et.ZERO,et.ONE_MINUS_SRC_COLOR,et.ZERO,et.ONE);break;case MultiplyBlending:et.blendFunc(et.ZERO,et.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",dn);break}mt=null,vt=null,_t=null,St=null,bt.set(0,0,0),Et=0,dt=dn,Mt=jt}return}Hn=Hn||$n,jn=jn||Pn,qn=qn||Dn,($n!==pt||Hn!==yt)&&(et.blendEquationSeparate(yn[$n],yn[Hn]),pt=$n,yt=Hn),(Pn!==mt||Dn!==vt||jn!==_t||qn!==St)&&(et.blendFuncSeparate(Vt[Pn],Vt[Dn],Vt[jn],Vt[qn]),mt=Pn,vt=Dn,_t=jn,St=qn),(hr.equals(bt)===!1||fr!==Et)&&(et.blendColor(hr.r,hr.g,hr.b,fr),bt.copy(hr),Et=fr),dt=dn,Mt=!1}function ln(dn,$n){dn.side===DoubleSide?Qt(et.CULL_FACE):Zt(et.CULL_FACE);let Pn=dn.side===BackSide;$n&&(Pn=!Pn),Jt(Pn),dn.blending===NormalBlending&&dn.transparent===!1?fn(NoBlending):fn(dn.blending,dn.blendEquation,dn.blendSrc,dn.blendDst,dn.blendEquationAlpha,dn.blendSrcAlpha,dn.blendDstAlpha,dn.blendColor,dn.blendAlpha,dn.premultipliedAlpha),rt.setFunc(dn.depthFunc),rt.setTest(dn.depthTest),rt.setMask(dn.depthWrite),nt.setMask(dn.colorWrite);const Dn=dn.stencilWrite;it.setTest(Dn),Dn&&(it.setMask(dn.stencilWriteMask),it.setFunc(dn.stencilFunc,dn.stencilRef,dn.stencilFuncMask),it.setOp(dn.stencilFail,dn.stencilZFail,dn.stencilZPass)),cn(dn.polygonOffset,dn.polygonOffsetFactor,dn.polygonOffsetUnits),dn.alphaToCoverage===!0?Zt(et.SAMPLE_ALPHA_TO_COVERAGE):Qt(et.SAMPLE_ALPHA_TO_COVERAGE)}function Jt(dn){Tt!==dn&&(dn?et.frontFace(et.CW):et.frontFace(et.CCW),Tt=dn)}function on(dn){dn!==CullFaceNone?(Zt(et.CULL_FACE),dn!==wt&&(dn===CullFaceBack?et.cullFace(et.BACK):dn===CullFaceFront?et.cullFace(et.FRONT):et.cullFace(et.FRONT_AND_BACK))):Qt(et.CULL_FACE),wt=dn}function _n(dn){dn!==Ct&&(Ft&&et.lineWidth(dn),Ct=dn)}function cn(dn,$n,Pn){dn?(Zt(et.POLYGON_OFFSET_FILL),(Rt!==$n||It!==Pn)&&(et.polygonOffset($n,Pn),Rt=$n,It=Pn)):Qt(et.POLYGON_OFFSET_FILL)}function tn(dn){dn?Zt(et.SCISSOR_TEST):Qt(et.SCISSOR_TEST)}function Wt(dn){dn===void 0&&(dn=et.TEXTURE0+Dt-1),Lt!==dn&&(et.activeTexture(dn),Lt=dn)}function Bt(dn,$n,Pn){Pn===void 0&&(Lt===null?Pn=et.TEXTURE0+Dt-1:Pn=Lt);let Dn=Ot[Pn];Dn===void 0&&(Dn={type:void 0,texture:void 0},Ot[Pn]=Dn),(Dn.type!==dn||Dn.texture!==$n)&&(Lt!==Pn&&(et.activeTexture(Pn),Lt=Pn),et.bindTexture(dn,$n||Xt[dn]),Dn.type=dn,Dn.texture=$n)}function nn(){const dn=Ot[Lt];dn!==void 0&&dn.type!==void 0&&(et.bindTexture(dn.type,null),dn.type=void 0,dn.texture=void 0)}function en(){try{et.compressedTexImage2D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function mn(){try{et.compressedTexImage3D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function sn(){try{et.texSubImage2D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function xn(){try{et.texSubImage3D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function an(){try{et.compressedTexSubImage2D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function pn(){try{et.compressedTexSubImage3D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function Sn(){try{et.texStorage2D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function gn(){try{et.texStorage3D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function Rn(){try{et.texImage2D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function Mn(){try{et.texImage3D.apply(et,arguments)}catch(dn){console.error("THREE.WebGLState:",dn)}}function kn(dn){Ht.equals(dn)===!1&&(et.scissor(dn.x,dn.y,dn.z,dn.w),Ht.copy(dn))}function Fn(dn){qt.equals(dn)===!1&&(et.viewport(dn.x,dn.y,dn.z,dn.w),qt.copy(dn))}function Nn(dn,$n){let Pn=ot.get($n);Pn===void 0&&(Pn=new WeakMap,ot.set($n,Pn));let Dn=Pn.get(dn);Dn===void 0&&(Dn=et.getUniformBlockIndex($n,dn.name),Pn.set(dn,Dn))}function Zn(dn,$n){const Dn=ot.get($n).get(dn);st.get($n)!==Dn&&(et.uniformBlockBinding($n,Dn,dn.__bindingPointIndex),st.set($n,Dn))}function er(){et.disable(et.BLEND),et.disable(et.CULL_FACE),et.disable(et.DEPTH_TEST),et.disable(et.POLYGON_OFFSET_FILL),et.disable(et.SCISSOR_TEST),et.disable(et.STENCIL_TEST),et.disable(et.SAMPLE_ALPHA_TO_COVERAGE),et.blendEquation(et.FUNC_ADD),et.blendFunc(et.ONE,et.ZERO),et.blendFuncSeparate(et.ONE,et.ZERO,et.ONE,et.ZERO),et.blendColor(0,0,0,0),et.colorMask(!0,!0,!0,!0),et.clearColor(0,0,0,0),et.depthMask(!0),et.depthFunc(et.LESS),et.clearDepth(1),et.stencilMask(4294967295),et.stencilFunc(et.ALWAYS,0,4294967295),et.stencilOp(et.KEEP,et.KEEP,et.KEEP),et.clearStencil(0),et.cullFace(et.BACK),et.frontFace(et.CCW),et.polygonOffset(0,0),et.activeTexture(et.TEXTURE0),et.bindFramebuffer(et.FRAMEBUFFER,null),et.bindFramebuffer(et.DRAW_FRAMEBUFFER,null),et.bindFramebuffer(et.READ_FRAMEBUFFER,null),et.useProgram(null),et.lineWidth(1),et.scissor(0,0,et.canvas.width,et.canvas.height),et.viewport(0,0,et.canvas.width,et.canvas.height),at={},Lt=null,Ot={},lt={},ct=new WeakMap,ht=[],ut=null,ft=!1,dt=null,pt=null,mt=null,vt=null,yt=null,_t=null,St=null,bt=new Color$1(0,0,0),Et=0,Mt=!1,Tt=null,wt=null,Ct=null,Rt=null,It=null,Ht.set(0,0,et.canvas.width,et.canvas.height),qt.set(0,0,et.canvas.width,et.canvas.height),nt.reset(),rt.reset(),it.reset()}return{buffers:{color:nt,depth:rt,stencil:it},enable:Zt,disable:Qt,bindFramebuffer:un,drawBuffers:wn,useProgram:Tn,setBlending:fn,setMaterial:ln,setFlipSided:Jt,setCullFace:on,setLineWidth:_n,setPolygonOffset:cn,setScissorTest:tn,activeTexture:Wt,bindTexture:Bt,unbindTexture:nn,compressedTexImage2D:en,compressedTexImage3D:mn,texImage2D:Rn,texImage3D:Mn,updateUBOMapping:Nn,uniformBlockBinding:Zn,texStorage2D:Sn,texStorage3D:gn,texSubImage2D:sn,texSubImage3D:xn,compressedTexSubImage2D:an,compressedTexSubImage3D:pn,scissor:kn,viewport:Fn,reset:er}}function contain(et,_){const _e=et.image&&et.image.width?et.image.width/et.image.height:1;return _e>_?(et.repeat.x=1,et.repeat.y=_e/_,et.offset.x=0,et.offset.y=(1-et.repeat.y)/2):(et.repeat.x=_/_e,et.repeat.y=1,et.offset.x=(1-et.repeat.x)/2,et.offset.y=0),et}function cover(et,_){const _e=et.image&&et.image.width?et.image.width/et.image.height:1;return _e>_?(et.repeat.x=_/_e,et.repeat.y=1,et.offset.x=(1-et.repeat.x)/2,et.offset.y=0):(et.repeat.x=1,et.repeat.y=_e/_,et.offset.x=0,et.offset.y=(1-et.repeat.y)/2),et}function fill$1(et){return et.repeat.x=1,et.repeat.y=1,et.offset.x=0,et.offset.y=0,et}function getByteLength$1(et,_,_e,tt){const nt=getTextureTypeByteLength(tt);switch(_e){case AlphaFormat:return et*_;case LuminanceFormat:return et*_;case LuminanceAlphaFormat:return et*_*2;case RedFormat:return et*_/nt.components*nt.byteLength;case RedIntegerFormat:return et*_/nt.components*nt.byteLength;case RGFormat:return et*_*2/nt.components*nt.byteLength;case RGIntegerFormat:return et*_*2/nt.components*nt.byteLength;case RGBFormat:return et*_*3/nt.components*nt.byteLength;case RGBAFormat:return et*_*4/nt.components*nt.byteLength;case RGBAIntegerFormat:return et*_*4/nt.components*nt.byteLength;case RGB_S3TC_DXT1_Format:case RGBA_S3TC_DXT1_Format:return Math.floor((et+3)/4)*Math.floor((_+3)/4)*8;case RGBA_S3TC_DXT3_Format:case RGBA_S3TC_DXT5_Format:return Math.floor((et+3)/4)*Math.floor((_+3)/4)*16;case RGB_PVRTC_2BPPV1_Format:case RGBA_PVRTC_2BPPV1_Format:return Math.max(et,16)*Math.max(_,8)/4;case RGB_PVRTC_4BPPV1_Format:case RGBA_PVRTC_4BPPV1_Format:return Math.max(et,8)*Math.max(_,8)/2;case RGB_ETC1_Format:case RGB_ETC2_Format:return Math.floor((et+3)/4)*Math.floor((_+3)/4)*8;case RGBA_ETC2_EAC_Format:return Math.floor((et+3)/4)*Math.floor((_+3)/4)*16;case RGBA_ASTC_4x4_Format:return Math.floor((et+3)/4)*Math.floor((_+3)/4)*16;case RGBA_ASTC_5x4_Format:return Math.floor((et+4)/5)*Math.floor((_+3)/4)*16;case RGBA_ASTC_5x5_Format:return Math.floor((et+4)/5)*Math.floor((_+4)/5)*16;case RGBA_ASTC_6x5_Format:return Math.floor((et+5)/6)*Math.floor((_+4)/5)*16;case RGBA_ASTC_6x6_Format:return Math.floor((et+5)/6)*Math.floor((_+5)/6)*16;case RGBA_ASTC_8x5_Format:return Math.floor((et+7)/8)*Math.floor((_+4)/5)*16;case RGBA_ASTC_8x6_Format:return Math.floor((et+7)/8)*Math.floor((_+5)/6)*16;case RGBA_ASTC_8x8_Format:return Math.floor((et+7)/8)*Math.floor((_+7)/8)*16;case RGBA_ASTC_10x5_Format:return Math.floor((et+9)/10)*Math.floor((_+4)/5)*16;case RGBA_ASTC_10x6_Format:return Math.floor((et+9)/10)*Math.floor((_+5)/6)*16;case RGBA_ASTC_10x8_Format:return Math.floor((et+9)/10)*Math.floor((_+7)/8)*16;case RGBA_ASTC_10x10_Format:return Math.floor((et+9)/10)*Math.floor((_+9)/10)*16;case RGBA_ASTC_12x10_Format:return Math.floor((et+11)/12)*Math.floor((_+9)/10)*16;case RGBA_ASTC_12x12_Format:return Math.floor((et+11)/12)*Math.floor((_+11)/12)*16;case RGBA_BPTC_Format:case RGB_BPTC_SIGNED_Format:case RGB_BPTC_UNSIGNED_Format:return Math.ceil(et/4)*Math.ceil(_/4)*16;case RED_RGTC1_Format:case SIGNED_RED_RGTC1_Format:return Math.ceil(et/4)*Math.ceil(_/4)*8;case RED_GREEN_RGTC2_Format:case SIGNED_RED_GREEN_RGTC2_Format:return Math.ceil(et/4)*Math.ceil(_/4)*16}throw new Error(`Unable to determine texture byte length for ${_e} format.`)}function getTextureTypeByteLength(et){switch(et){case UnsignedByteType:case ByteType:return{byteLength:1,components:1};case UnsignedShortType:case ShortType:case HalfFloatType:return{byteLength:2,components:1};case UnsignedShort4444Type:case UnsignedShort5551Type:return{byteLength:2,components:4};case UnsignedIntType:case IntType:case FloatType:return{byteLength:4,components:1};case UnsignedInt5999Type:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${et}.`)}const TextureUtils={contain,cover,fill:fill$1,getByteLength:getByteLength$1};function WebGLTextures(et,_,_e,tt,nt,rt,it){const st=_.has("WEBGL_multisampled_render_to_texture")?_.get("WEBGL_multisampled_render_to_texture"):null,ot=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),at=new Vector2,lt=new WeakMap;let ct;const ht=new WeakMap;let ut=!1;try{ut=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ft(Wt,Bt){return ut?new OffscreenCanvas(Wt,Bt):createElementNS("canvas")}function dt(Wt,Bt,nn){let en=1;const mn=tn(Wt);if((mn.width>nn||mn.height>nn)&&(en=nn/Math.max(mn.width,mn.height)),en<1)if(typeof HTMLImageElement<"u"&&Wt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Wt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Wt instanceof ImageBitmap||typeof VideoFrame<"u"&&Wt instanceof VideoFrame){const sn=Math.floor(en*mn.width),xn=Math.floor(en*mn.height);ct===void 0&&(ct=ft(sn,xn));const an=Bt?ft(sn,xn):ct;return an.width=sn,an.height=xn,an.getContext("2d").drawImage(Wt,0,0,sn,xn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+mn.width+"x"+mn.height+") to ("+sn+"x"+xn+")."),an}else return"data"in Wt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+mn.width+"x"+mn.height+")."),Wt;return Wt}function pt(Wt){return Wt.generateMipmaps&&Wt.minFilter!==NearestFilter&&Wt.minFilter!==LinearFilter}function mt(Wt){et.generateMipmap(Wt)}function vt(Wt,Bt,nn,en,mn=!1){if(Wt!==null){if(et[Wt]!==void 0)return et[Wt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Wt+"'")}let sn=Bt;if(Bt===et.RED&&(nn===et.FLOAT&&(sn=et.R32F),nn===et.HALF_FLOAT&&(sn=et.R16F),nn===et.UNSIGNED_BYTE&&(sn=et.R8)),Bt===et.RED_INTEGER&&(nn===et.UNSIGNED_BYTE&&(sn=et.R8UI),nn===et.UNSIGNED_SHORT&&(sn=et.R16UI),nn===et.UNSIGNED_INT&&(sn=et.R32UI),nn===et.BYTE&&(sn=et.R8I),nn===et.SHORT&&(sn=et.R16I),nn===et.INT&&(sn=et.R32I)),Bt===et.RG&&(nn===et.FLOAT&&(sn=et.RG32F),nn===et.HALF_FLOAT&&(sn=et.RG16F),nn===et.UNSIGNED_BYTE&&(sn=et.RG8)),Bt===et.RG_INTEGER&&(nn===et.UNSIGNED_BYTE&&(sn=et.RG8UI),nn===et.UNSIGNED_SHORT&&(sn=et.RG16UI),nn===et.UNSIGNED_INT&&(sn=et.RG32UI),nn===et.BYTE&&(sn=et.RG8I),nn===et.SHORT&&(sn=et.RG16I),nn===et.INT&&(sn=et.RG32I)),Bt===et.RGB&&nn===et.UNSIGNED_INT_5_9_9_9_REV&&(sn=et.RGB9_E5),Bt===et.RGBA){const xn=mn?LinearTransfer:ColorManagement.getTransfer(en);nn===et.FLOAT&&(sn=et.RGBA32F),nn===et.HALF_FLOAT&&(sn=et.RGBA16F),nn===et.UNSIGNED_BYTE&&(sn=xn===SRGBTransfer?et.SRGB8_ALPHA8:et.RGBA8),nn===et.UNSIGNED_SHORT_4_4_4_4&&(sn=et.RGBA4),nn===et.UNSIGNED_SHORT_5_5_5_1&&(sn=et.RGB5_A1)}return(sn===et.R16F||sn===et.R32F||sn===et.RG16F||sn===et.RG32F||sn===et.RGBA16F||sn===et.RGBA32F)&&_.get("EXT_color_buffer_float"),sn}function yt(Wt,Bt){let nn;return Wt?Bt===null||Bt===UnsignedIntType||Bt===UnsignedInt248Type?nn=et.DEPTH24_STENCIL8:Bt===FloatType?nn=et.DEPTH32F_STENCIL8:Bt===UnsignedShortType&&(nn=et.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Bt===null||Bt===UnsignedIntType||Bt===UnsignedInt248Type?nn=et.DEPTH_COMPONENT24:Bt===FloatType?nn=et.DEPTH_COMPONENT32F:Bt===UnsignedShortType&&(nn=et.DEPTH_COMPONENT16),nn}function _t(Wt,Bt){return pt(Wt)===!0||Wt.isFramebufferTexture&&Wt.minFilter!==NearestFilter&&Wt.minFilter!==LinearFilter?Math.log2(Math.max(Bt.width,Bt.height))+1:Wt.mipmaps!==void 0&&Wt.mipmaps.length>0?Wt.mipmaps.length:Wt.isCompressedTexture&&Array.isArray(Wt.image)?Bt.mipmaps.length:1}function St(Wt){const Bt=Wt.target;Bt.removeEventListener("dispose",St),Et(Bt),Bt.isVideoTexture&&lt.delete(Bt)}function bt(Wt){const Bt=Wt.target;Bt.removeEventListener("dispose",bt),Tt(Bt)}function Et(Wt){const Bt=tt.get(Wt);if(Bt.__webglInit===void 0)return;const nn=Wt.source,en=ht.get(nn);if(en){const mn=en[Bt.__cacheKey];mn.usedTimes--,mn.usedTimes===0&&Mt(Wt),Object.keys(en).length===0&&ht.delete(nn)}tt.remove(Wt)}function Mt(Wt){const Bt=tt.get(Wt);et.deleteTexture(Bt.__webglTexture);const nn=Wt.source,en=ht.get(nn);delete en[Bt.__cacheKey],it.memory.textures--}function Tt(Wt){const Bt=tt.get(Wt);if(Wt.depthTexture&&Wt.depthTexture.dispose(),Wt.isWebGLCubeRenderTarget)for(let en=0;en<6;en++){if(Array.isArray(Bt.__webglFramebuffer[en]))for(let mn=0;mn<Bt.__webglFramebuffer[en].length;mn++)et.deleteFramebuffer(Bt.__webglFramebuffer[en][mn]);else et.deleteFramebuffer(Bt.__webglFramebuffer[en]);Bt.__webglDepthbuffer&&et.deleteRenderbuffer(Bt.__webglDepthbuffer[en])}else{if(Array.isArray(Bt.__webglFramebuffer))for(let en=0;en<Bt.__webglFramebuffer.length;en++)et.deleteFramebuffer(Bt.__webglFramebuffer[en]);else et.deleteFramebuffer(Bt.__webglFramebuffer);if(Bt.__webglDepthbuffer&&et.deleteRenderbuffer(Bt.__webglDepthbuffer),Bt.__webglMultisampledFramebuffer&&et.deleteFramebuffer(Bt.__webglMultisampledFramebuffer),Bt.__webglColorRenderbuffer)for(let en=0;en<Bt.__webglColorRenderbuffer.length;en++)Bt.__webglColorRenderbuffer[en]&&et.deleteRenderbuffer(Bt.__webglColorRenderbuffer[en]);Bt.__webglDepthRenderbuffer&&et.deleteRenderbuffer(Bt.__webglDepthRenderbuffer)}const nn=Wt.textures;for(let en=0,mn=nn.length;en<mn;en++){const sn=tt.get(nn[en]);sn.__webglTexture&&(et.deleteTexture(sn.__webglTexture),it.memory.textures--),tt.remove(nn[en])}tt.remove(Wt)}let wt=0;function Ct(){wt=0}function Rt(){const Wt=wt;return Wt>=nt.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Wt+" texture units while this GPU supports only "+nt.maxTextures),wt+=1,Wt}function It(Wt){const Bt=[];return Bt.push(Wt.wrapS),Bt.push(Wt.wrapT),Bt.push(Wt.wrapR||0),Bt.push(Wt.magFilter),Bt.push(Wt.minFilter),Bt.push(Wt.anisotropy),Bt.push(Wt.internalFormat),Bt.push(Wt.format),Bt.push(Wt.type),Bt.push(Wt.generateMipmaps),Bt.push(Wt.premultiplyAlpha),Bt.push(Wt.flipY),Bt.push(Wt.unpackAlignment),Bt.push(Wt.colorSpace),Bt.join()}function Dt(Wt,Bt){const nn=tt.get(Wt);if(Wt.isVideoTexture&&_n(Wt),Wt.isRenderTargetTexture===!1&&Wt.version>0&&nn.__version!==Wt.version){const en=Wt.image;if(en===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(en.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{qt(nn,Wt,Bt);return}}_e.bindTexture(et.TEXTURE_2D,nn.__webglTexture,et.TEXTURE0+Bt)}function Ft(Wt,Bt){const nn=tt.get(Wt);if(Wt.version>0&&nn.__version!==Wt.version){qt(nn,Wt,Bt);return}_e.bindTexture(et.TEXTURE_2D_ARRAY,nn.__webglTexture,et.TEXTURE0+Bt)}function $t(Wt,Bt){const nn=tt.get(Wt);if(Wt.version>0&&nn.__version!==Wt.version){qt(nn,Wt,Bt);return}_e.bindTexture(et.TEXTURE_3D,nn.__webglTexture,et.TEXTURE0+Bt)}function Yt(Wt,Bt){const nn=tt.get(Wt);if(Wt.version>0&&nn.__version!==Wt.version){Gt(nn,Wt,Bt);return}_e.bindTexture(et.TEXTURE_CUBE_MAP,nn.__webglTexture,et.TEXTURE0+Bt)}const Lt={[RepeatWrapping]:et.REPEAT,[ClampToEdgeWrapping]:et.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:et.MIRRORED_REPEAT},Ot={[NearestFilter]:et.NEAREST,[NearestMipmapNearestFilter]:et.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:et.NEAREST_MIPMAP_LINEAR,[LinearFilter]:et.LINEAR,[LinearMipmapNearestFilter]:et.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:et.LINEAR_MIPMAP_LINEAR},Nt={[NeverCompare]:et.NEVER,[AlwaysCompare]:et.ALWAYS,[LessCompare]:et.LESS,[LessEqualCompare]:et.LEQUAL,[EqualCompare]:et.EQUAL,[GreaterEqualCompare]:et.GEQUAL,[GreaterCompare]:et.GREATER,[NotEqualCompare]:et.NOTEQUAL};function zt(Wt,Bt){if(Bt.type===FloatType&&_.has("OES_texture_float_linear")===!1&&(Bt.magFilter===LinearFilter||Bt.magFilter===LinearMipmapNearestFilter||Bt.magFilter===NearestMipmapLinearFilter||Bt.magFilter===LinearMipmapLinearFilter||Bt.minFilter===LinearFilter||Bt.minFilter===LinearMipmapNearestFilter||Bt.minFilter===NearestMipmapLinearFilter||Bt.minFilter===LinearMipmapLinearFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),et.texParameteri(Wt,et.TEXTURE_WRAP_S,Lt[Bt.wrapS]),et.texParameteri(Wt,et.TEXTURE_WRAP_T,Lt[Bt.wrapT]),(Wt===et.TEXTURE_3D||Wt===et.TEXTURE_2D_ARRAY)&&et.texParameteri(Wt,et.TEXTURE_WRAP_R,Lt[Bt.wrapR]),et.texParameteri(Wt,et.TEXTURE_MAG_FILTER,Ot[Bt.magFilter]),et.texParameteri(Wt,et.TEXTURE_MIN_FILTER,Ot[Bt.minFilter]),Bt.compareFunction&&(et.texParameteri(Wt,et.TEXTURE_COMPARE_MODE,et.COMPARE_REF_TO_TEXTURE),et.texParameteri(Wt,et.TEXTURE_COMPARE_FUNC,Nt[Bt.compareFunction])),_.has("EXT_texture_filter_anisotropic")===!0){if(Bt.magFilter===NearestFilter||Bt.minFilter!==NearestMipmapLinearFilter&&Bt.minFilter!==LinearMipmapLinearFilter||Bt.type===FloatType&&_.has("OES_texture_float_linear")===!1)return;if(Bt.anisotropy>1||tt.get(Bt).__currentAnisotropy){const nn=_.get("EXT_texture_filter_anisotropic");et.texParameterf(Wt,nn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Bt.anisotropy,nt.getMaxAnisotropy())),tt.get(Bt).__currentAnisotropy=Bt.anisotropy}}}function Ht(Wt,Bt){let nn=!1;Wt.__webglInit===void 0&&(Wt.__webglInit=!0,Bt.addEventListener("dispose",St));const en=Bt.source;let mn=ht.get(en);mn===void 0&&(mn={},ht.set(en,mn));const sn=It(Bt);if(sn!==Wt.__cacheKey){mn[sn]===void 0&&(mn[sn]={texture:et.createTexture(),usedTimes:0},it.memory.textures++,nn=!0),mn[sn].usedTimes++;const xn=mn[Wt.__cacheKey];xn!==void 0&&(mn[Wt.__cacheKey].usedTimes--,xn.usedTimes===0&&Mt(Bt)),Wt.__cacheKey=sn,Wt.__webglTexture=mn[sn].texture}return nn}function qt(Wt,Bt,nn){let en=et.TEXTURE_2D;(Bt.isDataArrayTexture||Bt.isCompressedArrayTexture)&&(en=et.TEXTURE_2D_ARRAY),Bt.isData3DTexture&&(en=et.TEXTURE_3D);const mn=Ht(Wt,Bt),sn=Bt.source;_e.bindTexture(en,Wt.__webglTexture,et.TEXTURE0+nn);const xn=tt.get(sn);if(sn.version!==xn.__version||mn===!0){_e.activeTexture(et.TEXTURE0+nn);const an=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),pn=Bt.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(Bt.colorSpace),Sn=Bt.colorSpace===NoColorSpace||an===pn?et.NONE:et.BROWSER_DEFAULT_WEBGL;et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,Bt.flipY),et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Bt.premultiplyAlpha),et.pixelStorei(et.UNPACK_ALIGNMENT,Bt.unpackAlignment),et.pixelStorei(et.UNPACK_COLORSPACE_CONVERSION_WEBGL,Sn);let gn=dt(Bt.image,!1,nt.maxTextureSize);gn=cn(Bt,gn);const Rn=rt.convert(Bt.format,Bt.colorSpace),Mn=rt.convert(Bt.type);let kn=vt(Bt.internalFormat,Rn,Mn,Bt.colorSpace,Bt.isVideoTexture);zt(en,Bt);let Fn;const Nn=Bt.mipmaps,Zn=Bt.isVideoTexture!==!0,er=xn.__version===void 0||mn===!0,dn=sn.dataReady,$n=_t(Bt,gn);if(Bt.isDepthTexture)kn=yt(Bt.format===DepthStencilFormat,Bt.type),er&&(Zn?_e.texStorage2D(et.TEXTURE_2D,1,kn,gn.width,gn.height):_e.texImage2D(et.TEXTURE_2D,0,kn,gn.width,gn.height,0,Rn,Mn,null));else if(Bt.isDataTexture)if(Nn.length>0){Zn&&er&&_e.texStorage2D(et.TEXTURE_2D,$n,kn,Nn[0].width,Nn[0].height);for(let Pn=0,Dn=Nn.length;Pn<Dn;Pn++)Fn=Nn[Pn],Zn?dn&&_e.texSubImage2D(et.TEXTURE_2D,Pn,0,0,Fn.width,Fn.height,Rn,Mn,Fn.data):_e.texImage2D(et.TEXTURE_2D,Pn,kn,Fn.width,Fn.height,0,Rn,Mn,Fn.data);Bt.generateMipmaps=!1}else Zn?(er&&_e.texStorage2D(et.TEXTURE_2D,$n,kn,gn.width,gn.height),dn&&_e.texSubImage2D(et.TEXTURE_2D,0,0,0,gn.width,gn.height,Rn,Mn,gn.data)):_e.texImage2D(et.TEXTURE_2D,0,kn,gn.width,gn.height,0,Rn,Mn,gn.data);else if(Bt.isCompressedTexture)if(Bt.isCompressedArrayTexture){Zn&&er&&_e.texStorage3D(et.TEXTURE_2D_ARRAY,$n,kn,Nn[0].width,Nn[0].height,gn.depth);for(let Pn=0,Dn=Nn.length;Pn<Dn;Pn++)if(Fn=Nn[Pn],Bt.format!==RGBAFormat)if(Rn!==null)if(Zn){if(dn)if(Bt.layerUpdates.size>0){const Hn=getByteLength$1(Fn.width,Fn.height,Bt.format,Bt.type);for(const jn of Bt.layerUpdates){const qn=Fn.data.subarray(jn*Hn/Fn.data.BYTES_PER_ELEMENT,(jn+1)*Hn/Fn.data.BYTES_PER_ELEMENT);_e.compressedTexSubImage3D(et.TEXTURE_2D_ARRAY,Pn,0,0,jn,Fn.width,Fn.height,1,Rn,qn,0,0)}Bt.clearLayerUpdates()}else _e.compressedTexSubImage3D(et.TEXTURE_2D_ARRAY,Pn,0,0,0,Fn.width,Fn.height,gn.depth,Rn,Fn.data,0,0)}else _e.compressedTexImage3D(et.TEXTURE_2D_ARRAY,Pn,kn,Fn.width,Fn.height,gn.depth,0,Fn.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Zn?dn&&_e.texSubImage3D(et.TEXTURE_2D_ARRAY,Pn,0,0,0,Fn.width,Fn.height,gn.depth,Rn,Mn,Fn.data):_e.texImage3D(et.TEXTURE_2D_ARRAY,Pn,kn,Fn.width,Fn.height,gn.depth,0,Rn,Mn,Fn.data)}else{Zn&&er&&_e.texStorage2D(et.TEXTURE_2D,$n,kn,Nn[0].width,Nn[0].height);for(let Pn=0,Dn=Nn.length;Pn<Dn;Pn++)Fn=Nn[Pn],Bt.format!==RGBAFormat?Rn!==null?Zn?dn&&_e.compressedTexSubImage2D(et.TEXTURE_2D,Pn,0,0,Fn.width,Fn.height,Rn,Fn.data):_e.compressedTexImage2D(et.TEXTURE_2D,Pn,kn,Fn.width,Fn.height,0,Fn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Zn?dn&&_e.texSubImage2D(et.TEXTURE_2D,Pn,0,0,Fn.width,Fn.height,Rn,Mn,Fn.data):_e.texImage2D(et.TEXTURE_2D,Pn,kn,Fn.width,Fn.height,0,Rn,Mn,Fn.data)}else if(Bt.isDataArrayTexture)if(Zn){if(er&&_e.texStorage3D(et.TEXTURE_2D_ARRAY,$n,kn,gn.width,gn.height,gn.depth),dn)if(Bt.layerUpdates.size>0){const Pn=getByteLength$1(gn.width,gn.height,Bt.format,Bt.type);for(const Dn of Bt.layerUpdates){const Hn=gn.data.subarray(Dn*Pn/gn.data.BYTES_PER_ELEMENT,(Dn+1)*Pn/gn.data.BYTES_PER_ELEMENT);_e.texSubImage3D(et.TEXTURE_2D_ARRAY,0,0,0,Dn,gn.width,gn.height,1,Rn,Mn,Hn)}Bt.clearLayerUpdates()}else _e.texSubImage3D(et.TEXTURE_2D_ARRAY,0,0,0,0,gn.width,gn.height,gn.depth,Rn,Mn,gn.data)}else _e.texImage3D(et.TEXTURE_2D_ARRAY,0,kn,gn.width,gn.height,gn.depth,0,Rn,Mn,gn.data);else if(Bt.isData3DTexture)Zn?(er&&_e.texStorage3D(et.TEXTURE_3D,$n,kn,gn.width,gn.height,gn.depth),dn&&_e.texSubImage3D(et.TEXTURE_3D,0,0,0,0,gn.width,gn.height,gn.depth,Rn,Mn,gn.data)):_e.texImage3D(et.TEXTURE_3D,0,kn,gn.width,gn.height,gn.depth,0,Rn,Mn,gn.data);else if(Bt.isFramebufferTexture){if(er)if(Zn)_e.texStorage2D(et.TEXTURE_2D,$n,kn,gn.width,gn.height);else{let Pn=gn.width,Dn=gn.height;for(let Hn=0;Hn<$n;Hn++)_e.texImage2D(et.TEXTURE_2D,Hn,kn,Pn,Dn,0,Rn,Mn,null),Pn>>=1,Dn>>=1}}else if(Nn.length>0){if(Zn&&er){const Pn=tn(Nn[0]);_e.texStorage2D(et.TEXTURE_2D,$n,kn,Pn.width,Pn.height)}for(let Pn=0,Dn=Nn.length;Pn<Dn;Pn++)Fn=Nn[Pn],Zn?dn&&_e.texSubImage2D(et.TEXTURE_2D,Pn,0,0,Rn,Mn,Fn):_e.texImage2D(et.TEXTURE_2D,Pn,kn,Rn,Mn,Fn);Bt.generateMipmaps=!1}else if(Zn){if(er){const Pn=tn(gn);_e.texStorage2D(et.TEXTURE_2D,$n,kn,Pn.width,Pn.height)}dn&&_e.texSubImage2D(et.TEXTURE_2D,0,0,0,Rn,Mn,gn)}else _e.texImage2D(et.TEXTURE_2D,0,kn,Rn,Mn,gn);pt(Bt)&&mt(en),xn.__version=sn.version,Bt.onUpdate&&Bt.onUpdate(Bt)}Wt.__version=Bt.version}function Gt(Wt,Bt,nn){if(Bt.image.length!==6)return;const en=Ht(Wt,Bt),mn=Bt.source;_e.bindTexture(et.TEXTURE_CUBE_MAP,Wt.__webglTexture,et.TEXTURE0+nn);const sn=tt.get(mn);if(mn.version!==sn.__version||en===!0){_e.activeTexture(et.TEXTURE0+nn);const xn=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),an=Bt.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(Bt.colorSpace),pn=Bt.colorSpace===NoColorSpace||xn===an?et.NONE:et.BROWSER_DEFAULT_WEBGL;et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,Bt.flipY),et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Bt.premultiplyAlpha),et.pixelStorei(et.UNPACK_ALIGNMENT,Bt.unpackAlignment),et.pixelStorei(et.UNPACK_COLORSPACE_CONVERSION_WEBGL,pn);const Sn=Bt.isCompressedTexture||Bt.image[0].isCompressedTexture,gn=Bt.image[0]&&Bt.image[0].isDataTexture,Rn=[];for(let Dn=0;Dn<6;Dn++)!Sn&&!gn?Rn[Dn]=dt(Bt.image[Dn],!0,nt.maxCubemapSize):Rn[Dn]=gn?Bt.image[Dn].image:Bt.image[Dn],Rn[Dn]=cn(Bt,Rn[Dn]);const Mn=Rn[0],kn=rt.convert(Bt.format,Bt.colorSpace),Fn=rt.convert(Bt.type),Nn=vt(Bt.internalFormat,kn,Fn,Bt.colorSpace),Zn=Bt.isVideoTexture!==!0,er=sn.__version===void 0||en===!0,dn=mn.dataReady;let $n=_t(Bt,Mn);zt(et.TEXTURE_CUBE_MAP,Bt);let Pn;if(Sn){Zn&&er&&_e.texStorage2D(et.TEXTURE_CUBE_MAP,$n,Nn,Mn.width,Mn.height);for(let Dn=0;Dn<6;Dn++){Pn=Rn[Dn].mipmaps;for(let Hn=0;Hn<Pn.length;Hn++){const jn=Pn[Hn];Bt.format!==RGBAFormat?kn!==null?Zn?dn&&_e.compressedTexSubImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn,0,0,jn.width,jn.height,kn,jn.data):_e.compressedTexImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn,Nn,jn.width,jn.height,0,jn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Zn?dn&&_e.texSubImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn,0,0,jn.width,jn.height,kn,Fn,jn.data):_e.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn,Nn,jn.width,jn.height,0,kn,Fn,jn.data)}}}else{if(Pn=Bt.mipmaps,Zn&&er){Pn.length>0&&$n++;const Dn=tn(Rn[0]);_e.texStorage2D(et.TEXTURE_CUBE_MAP,$n,Nn,Dn.width,Dn.height)}for(let Dn=0;Dn<6;Dn++)if(gn){Zn?dn&&_e.texSubImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,0,0,0,Rn[Dn].width,Rn[Dn].height,kn,Fn,Rn[Dn].data):_e.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,0,Nn,Rn[Dn].width,Rn[Dn].height,0,kn,Fn,Rn[Dn].data);for(let Hn=0;Hn<Pn.length;Hn++){const qn=Pn[Hn].image[Dn].image;Zn?dn&&_e.texSubImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn+1,0,0,qn.width,qn.height,kn,Fn,qn.data):_e.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn+1,Nn,qn.width,qn.height,0,kn,Fn,qn.data)}}else{Zn?dn&&_e.texSubImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,0,0,0,kn,Fn,Rn[Dn]):_e.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,0,Nn,kn,Fn,Rn[Dn]);for(let Hn=0;Hn<Pn.length;Hn++){const jn=Pn[Hn];Zn?dn&&_e.texSubImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn+1,0,0,kn,Fn,jn.image[Dn]):_e.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+Dn,Hn+1,Nn,kn,Fn,jn.image[Dn])}}}pt(Bt)&&mt(et.TEXTURE_CUBE_MAP),sn.__version=mn.version,Bt.onUpdate&&Bt.onUpdate(Bt)}Wt.__version=Bt.version}function Xt(Wt,Bt,nn,en,mn,sn){const xn=rt.convert(nn.format,nn.colorSpace),an=rt.convert(nn.type),pn=vt(nn.internalFormat,xn,an,nn.colorSpace);if(!tt.get(Bt).__hasExternalTextures){const gn=Math.max(1,Bt.width>>sn),Rn=Math.max(1,Bt.height>>sn);mn===et.TEXTURE_3D||mn===et.TEXTURE_2D_ARRAY?_e.texImage3D(mn,sn,pn,gn,Rn,Bt.depth,0,xn,an,null):_e.texImage2D(mn,sn,pn,gn,Rn,0,xn,an,null)}_e.bindFramebuffer(et.FRAMEBUFFER,Wt),on(Bt)?st.framebufferTexture2DMultisampleEXT(et.FRAMEBUFFER,en,mn,tt.get(nn).__webglTexture,0,Jt(Bt)):(mn===et.TEXTURE_2D||mn>=et.TEXTURE_CUBE_MAP_POSITIVE_X&&mn<=et.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&et.framebufferTexture2D(et.FRAMEBUFFER,en,mn,tt.get(nn).__webglTexture,sn),_e.bindFramebuffer(et.FRAMEBUFFER,null)}function Zt(Wt,Bt,nn){if(et.bindRenderbuffer(et.RENDERBUFFER,Wt),Bt.depthBuffer){const en=Bt.depthTexture,mn=en&&en.isDepthTexture?en.type:null,sn=yt(Bt.stencilBuffer,mn),xn=Bt.stencilBuffer?et.DEPTH_STENCIL_ATTACHMENT:et.DEPTH_ATTACHMENT,an=Jt(Bt);on(Bt)?st.renderbufferStorageMultisampleEXT(et.RENDERBUFFER,an,sn,Bt.width,Bt.height):nn?et.renderbufferStorageMultisample(et.RENDERBUFFER,an,sn,Bt.width,Bt.height):et.renderbufferStorage(et.RENDERBUFFER,sn,Bt.width,Bt.height),et.framebufferRenderbuffer(et.FRAMEBUFFER,xn,et.RENDERBUFFER,Wt)}else{const en=Bt.textures;for(let mn=0;mn<en.length;mn++){const sn=en[mn],xn=rt.convert(sn.format,sn.colorSpace),an=rt.convert(sn.type),pn=vt(sn.internalFormat,xn,an,sn.colorSpace),Sn=Jt(Bt);nn&&on(Bt)===!1?et.renderbufferStorageMultisample(et.RENDERBUFFER,Sn,pn,Bt.width,Bt.height):on(Bt)?st.renderbufferStorageMultisampleEXT(et.RENDERBUFFER,Sn,pn,Bt.width,Bt.height):et.renderbufferStorage(et.RENDERBUFFER,pn,Bt.width,Bt.height)}}et.bindRenderbuffer(et.RENDERBUFFER,null)}function Qt(Wt,Bt){if(Bt&&Bt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(_e.bindFramebuffer(et.FRAMEBUFFER,Wt),!(Bt.depthTexture&&Bt.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!tt.get(Bt.depthTexture).__webglTexture||Bt.depthTexture.image.width!==Bt.width||Bt.depthTexture.image.height!==Bt.height)&&(Bt.depthTexture.image.width=Bt.width,Bt.depthTexture.image.height=Bt.height,Bt.depthTexture.needsUpdate=!0),Dt(Bt.depthTexture,0);const en=tt.get(Bt.depthTexture).__webglTexture,mn=Jt(Bt);if(Bt.depthTexture.format===DepthFormat)on(Bt)?st.framebufferTexture2DMultisampleEXT(et.FRAMEBUFFER,et.DEPTH_ATTACHMENT,et.TEXTURE_2D,en,0,mn):et.framebufferTexture2D(et.FRAMEBUFFER,et.DEPTH_ATTACHMENT,et.TEXTURE_2D,en,0);else if(Bt.depthTexture.format===DepthStencilFormat)on(Bt)?st.framebufferTexture2DMultisampleEXT(et.FRAMEBUFFER,et.DEPTH_STENCIL_ATTACHMENT,et.TEXTURE_2D,en,0,mn):et.framebufferTexture2D(et.FRAMEBUFFER,et.DEPTH_STENCIL_ATTACHMENT,et.TEXTURE_2D,en,0);else throw new Error("Unknown depthTexture format")}function un(Wt){const Bt=tt.get(Wt),nn=Wt.isWebGLCubeRenderTarget===!0;if(Wt.depthTexture&&!Bt.__autoAllocateDepthBuffer){if(nn)throw new Error("target.depthTexture not supported in Cube render targets");Qt(Bt.__webglFramebuffer,Wt)}else if(nn){Bt.__webglDepthbuffer=[];for(let en=0;en<6;en++)_e.bindFramebuffer(et.FRAMEBUFFER,Bt.__webglFramebuffer[en]),Bt.__webglDepthbuffer[en]=et.createRenderbuffer(),Zt(Bt.__webglDepthbuffer[en],Wt,!1)}else _e.bindFramebuffer(et.FRAMEBUFFER,Bt.__webglFramebuffer),Bt.__webglDepthbuffer=et.createRenderbuffer(),Zt(Bt.__webglDepthbuffer,Wt,!1);_e.bindFramebuffer(et.FRAMEBUFFER,null)}function wn(Wt,Bt,nn){const en=tt.get(Wt);Bt!==void 0&&Xt(en.__webglFramebuffer,Wt,Wt.texture,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,0),nn!==void 0&&un(Wt)}function Tn(Wt){const Bt=Wt.texture,nn=tt.get(Wt),en=tt.get(Bt);Wt.addEventListener("dispose",bt);const mn=Wt.textures,sn=Wt.isWebGLCubeRenderTarget===!0,xn=mn.length>1;if(xn||(en.__webglTexture===void 0&&(en.__webglTexture=et.createTexture()),en.__version=Bt.version,it.memory.textures++),sn){nn.__webglFramebuffer=[];for(let an=0;an<6;an++)if(Bt.mipmaps&&Bt.mipmaps.length>0){nn.__webglFramebuffer[an]=[];for(let pn=0;pn<Bt.mipmaps.length;pn++)nn.__webglFramebuffer[an][pn]=et.createFramebuffer()}else nn.__webglFramebuffer[an]=et.createFramebuffer()}else{if(Bt.mipmaps&&Bt.mipmaps.length>0){nn.__webglFramebuffer=[];for(let an=0;an<Bt.mipmaps.length;an++)nn.__webglFramebuffer[an]=et.createFramebuffer()}else nn.__webglFramebuffer=et.createFramebuffer();if(xn)for(let an=0,pn=mn.length;an<pn;an++){const Sn=tt.get(mn[an]);Sn.__webglTexture===void 0&&(Sn.__webglTexture=et.createTexture(),it.memory.textures++)}if(Wt.samples>0&&on(Wt)===!1){nn.__webglMultisampledFramebuffer=et.createFramebuffer(),nn.__webglColorRenderbuffer=[],_e.bindFramebuffer(et.FRAMEBUFFER,nn.__webglMultisampledFramebuffer);for(let an=0;an<mn.length;an++){const pn=mn[an];nn.__webglColorRenderbuffer[an]=et.createRenderbuffer(),et.bindRenderbuffer(et.RENDERBUFFER,nn.__webglColorRenderbuffer[an]);const Sn=rt.convert(pn.format,pn.colorSpace),gn=rt.convert(pn.type),Rn=vt(pn.internalFormat,Sn,gn,pn.colorSpace,Wt.isXRRenderTarget===!0),Mn=Jt(Wt);et.renderbufferStorageMultisample(et.RENDERBUFFER,Mn,Rn,Wt.width,Wt.height),et.framebufferRenderbuffer(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0+an,et.RENDERBUFFER,nn.__webglColorRenderbuffer[an])}et.bindRenderbuffer(et.RENDERBUFFER,null),Wt.depthBuffer&&(nn.__webglDepthRenderbuffer=et.createRenderbuffer(),Zt(nn.__webglDepthRenderbuffer,Wt,!0)),_e.bindFramebuffer(et.FRAMEBUFFER,null)}}if(sn){_e.bindTexture(et.TEXTURE_CUBE_MAP,en.__webglTexture),zt(et.TEXTURE_CUBE_MAP,Bt);for(let an=0;an<6;an++)if(Bt.mipmaps&&Bt.mipmaps.length>0)for(let pn=0;pn<Bt.mipmaps.length;pn++)Xt(nn.__webglFramebuffer[an][pn],Wt,Bt,et.COLOR_ATTACHMENT0,et.TEXTURE_CUBE_MAP_POSITIVE_X+an,pn);else Xt(nn.__webglFramebuffer[an],Wt,Bt,et.COLOR_ATTACHMENT0,et.TEXTURE_CUBE_MAP_POSITIVE_X+an,0);pt(Bt)&&mt(et.TEXTURE_CUBE_MAP),_e.unbindTexture()}else if(xn){for(let an=0,pn=mn.length;an<pn;an++){const Sn=mn[an],gn=tt.get(Sn);_e.bindTexture(et.TEXTURE_2D,gn.__webglTexture),zt(et.TEXTURE_2D,Sn),Xt(nn.__webglFramebuffer,Wt,Sn,et.COLOR_ATTACHMENT0+an,et.TEXTURE_2D,0),pt(Sn)&&mt(et.TEXTURE_2D)}_e.unbindTexture()}else{let an=et.TEXTURE_2D;if((Wt.isWebGL3DRenderTarget||Wt.isWebGLArrayRenderTarget)&&(an=Wt.isWebGL3DRenderTarget?et.TEXTURE_3D:et.TEXTURE_2D_ARRAY),_e.bindTexture(an,en.__webglTexture),zt(an,Bt),Bt.mipmaps&&Bt.mipmaps.length>0)for(let pn=0;pn<Bt.mipmaps.length;pn++)Xt(nn.__webglFramebuffer[pn],Wt,Bt,et.COLOR_ATTACHMENT0,an,pn);else Xt(nn.__webglFramebuffer,Wt,Bt,et.COLOR_ATTACHMENT0,an,0);pt(Bt)&&mt(an),_e.unbindTexture()}Wt.depthBuffer&&un(Wt)}function yn(Wt){const Bt=Wt.textures;for(let nn=0,en=Bt.length;nn<en;nn++){const mn=Bt[nn];if(pt(mn)){const sn=Wt.isWebGLCubeRenderTarget?et.TEXTURE_CUBE_MAP:et.TEXTURE_2D,xn=tt.get(mn).__webglTexture;_e.bindTexture(sn,xn),mt(sn),_e.unbindTexture()}}}const Vt=[],fn=[];function ln(Wt){if(Wt.samples>0){if(on(Wt)===!1){const Bt=Wt.textures,nn=Wt.width,en=Wt.height;let mn=et.COLOR_BUFFER_BIT;const sn=Wt.stencilBuffer?et.DEPTH_STENCIL_ATTACHMENT:et.DEPTH_ATTACHMENT,xn=tt.get(Wt),an=Bt.length>1;if(an)for(let pn=0;pn<Bt.length;pn++)_e.bindFramebuffer(et.FRAMEBUFFER,xn.__webglMultisampledFramebuffer),et.framebufferRenderbuffer(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0+pn,et.RENDERBUFFER,null),_e.bindFramebuffer(et.FRAMEBUFFER,xn.__webglFramebuffer),et.framebufferTexture2D(et.DRAW_FRAMEBUFFER,et.COLOR_ATTACHMENT0+pn,et.TEXTURE_2D,null,0);_e.bindFramebuffer(et.READ_FRAMEBUFFER,xn.__webglMultisampledFramebuffer),_e.bindFramebuffer(et.DRAW_FRAMEBUFFER,xn.__webglFramebuffer);for(let pn=0;pn<Bt.length;pn++){if(Wt.resolveDepthBuffer&&(Wt.depthBuffer&&(mn|=et.DEPTH_BUFFER_BIT),Wt.stencilBuffer&&Wt.resolveStencilBuffer&&(mn|=et.STENCIL_BUFFER_BIT)),an){et.framebufferRenderbuffer(et.READ_FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.RENDERBUFFER,xn.__webglColorRenderbuffer[pn]);const Sn=tt.get(Bt[pn]).__webglTexture;et.framebufferTexture2D(et.DRAW_FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,Sn,0)}et.blitFramebuffer(0,0,nn,en,0,0,nn,en,mn,et.NEAREST),ot===!0&&(Vt.length=0,fn.length=0,Vt.push(et.COLOR_ATTACHMENT0+pn),Wt.depthBuffer&&Wt.resolveDepthBuffer===!1&&(Vt.push(sn),fn.push(sn),et.invalidateFramebuffer(et.DRAW_FRAMEBUFFER,fn)),et.invalidateFramebuffer(et.READ_FRAMEBUFFER,Vt))}if(_e.bindFramebuffer(et.READ_FRAMEBUFFER,null),_e.bindFramebuffer(et.DRAW_FRAMEBUFFER,null),an)for(let pn=0;pn<Bt.length;pn++){_e.bindFramebuffer(et.FRAMEBUFFER,xn.__webglMultisampledFramebuffer),et.framebufferRenderbuffer(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0+pn,et.RENDERBUFFER,xn.__webglColorRenderbuffer[pn]);const Sn=tt.get(Bt[pn]).__webglTexture;_e.bindFramebuffer(et.FRAMEBUFFER,xn.__webglFramebuffer),et.framebufferTexture2D(et.DRAW_FRAMEBUFFER,et.COLOR_ATTACHMENT0+pn,et.TEXTURE_2D,Sn,0)}_e.bindFramebuffer(et.DRAW_FRAMEBUFFER,xn.__webglMultisampledFramebuffer)}else if(Wt.depthBuffer&&Wt.resolveDepthBuffer===!1&&ot){const Bt=Wt.stencilBuffer?et.DEPTH_STENCIL_ATTACHMENT:et.DEPTH_ATTACHMENT;et.invalidateFramebuffer(et.DRAW_FRAMEBUFFER,[Bt])}}}function Jt(Wt){return Math.min(nt.maxSamples,Wt.samples)}function on(Wt){const Bt=tt.get(Wt);return Wt.samples>0&&_.has("WEBGL_multisampled_render_to_texture")===!0&&Bt.__useRenderToTexture!==!1}function _n(Wt){const Bt=it.render.frame;lt.get(Wt)!==Bt&&(lt.set(Wt,Bt),Wt.update())}function cn(Wt,Bt){const nn=Wt.colorSpace,en=Wt.format,mn=Wt.type;return Wt.isCompressedTexture===!0||Wt.isVideoTexture===!0||nn!==LinearSRGBColorSpace&&nn!==NoColorSpace&&(ColorManagement.getTransfer(nn)===SRGBTransfer?(en!==RGBAFormat||mn!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",nn)),Bt}function tn(Wt){return typeof HTMLImageElement<"u"&&Wt instanceof HTMLImageElement?(at.width=Wt.naturalWidth||Wt.width,at.height=Wt.naturalHeight||Wt.height):typeof VideoFrame<"u"&&Wt instanceof VideoFrame?(at.width=Wt.displayWidth,at.height=Wt.displayHeight):(at.width=Wt.width,at.height=Wt.height),at}this.allocateTextureUnit=Rt,this.resetTextureUnits=Ct,this.setTexture2D=Dt,this.setTexture2DArray=Ft,this.setTexture3D=$t,this.setTextureCube=Yt,this.rebindTextures=wn,this.setupRenderTarget=Tn,this.updateRenderTargetMipmap=yn,this.updateMultisampleRenderTarget=ln,this.setupDepthRenderbuffer=un,this.setupFrameBufferTexture=Xt,this.useMultisampledRTT=on}function WebGLUtils(et,_){function _e(tt,nt=NoColorSpace){let rt;const it=ColorManagement.getTransfer(nt);if(tt===UnsignedByteType)return et.UNSIGNED_BYTE;if(tt===UnsignedShort4444Type)return et.UNSIGNED_SHORT_4_4_4_4;if(tt===UnsignedShort5551Type)return et.UNSIGNED_SHORT_5_5_5_1;if(tt===UnsignedInt5999Type)return et.UNSIGNED_INT_5_9_9_9_REV;if(tt===ByteType)return et.BYTE;if(tt===ShortType)return et.SHORT;if(tt===UnsignedShortType)return et.UNSIGNED_SHORT;if(tt===IntType)return et.INT;if(tt===UnsignedIntType)return et.UNSIGNED_INT;if(tt===FloatType)return et.FLOAT;if(tt===HalfFloatType)return et.HALF_FLOAT;if(tt===AlphaFormat)return et.ALPHA;if(tt===RGBFormat)return et.RGB;if(tt===RGBAFormat)return et.RGBA;if(tt===LuminanceFormat)return et.LUMINANCE;if(tt===LuminanceAlphaFormat)return et.LUMINANCE_ALPHA;if(tt===DepthFormat)return et.DEPTH_COMPONENT;if(tt===DepthStencilFormat)return et.DEPTH_STENCIL;if(tt===RedFormat)return et.RED;if(tt===RedIntegerFormat)return et.RED_INTEGER;if(tt===RGFormat)return et.RG;if(tt===RGIntegerFormat)return et.RG_INTEGER;if(tt===RGBAIntegerFormat)return et.RGBA_INTEGER;if(tt===RGB_S3TC_DXT1_Format||tt===RGBA_S3TC_DXT1_Format||tt===RGBA_S3TC_DXT3_Format||tt===RGBA_S3TC_DXT5_Format)if(it===SRGBTransfer)if(rt=_.get("WEBGL_compressed_texture_s3tc_srgb"),rt!==null){if(tt===RGB_S3TC_DXT1_Format)return rt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(tt===RGBA_S3TC_DXT1_Format)return rt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(tt===RGBA_S3TC_DXT3_Format)return rt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(tt===RGBA_S3TC_DXT5_Format)return rt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(rt=_.get("WEBGL_compressed_texture_s3tc"),rt!==null){if(tt===RGB_S3TC_DXT1_Format)return rt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(tt===RGBA_S3TC_DXT1_Format)return rt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(tt===RGBA_S3TC_DXT3_Format)return rt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(tt===RGBA_S3TC_DXT5_Format)return rt.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(tt===RGB_PVRTC_4BPPV1_Format||tt===RGB_PVRTC_2BPPV1_Format||tt===RGBA_PVRTC_4BPPV1_Format||tt===RGBA_PVRTC_2BPPV1_Format)if(rt=_.get("WEBGL_compressed_texture_pvrtc"),rt!==null){if(tt===RGB_PVRTC_4BPPV1_Format)return rt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(tt===RGB_PVRTC_2BPPV1_Format)return rt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(tt===RGBA_PVRTC_4BPPV1_Format)return rt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(tt===RGBA_PVRTC_2BPPV1_Format)return rt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(tt===RGB_ETC1_Format||tt===RGB_ETC2_Format||tt===RGBA_ETC2_EAC_Format)if(rt=_.get("WEBGL_compressed_texture_etc"),rt!==null){if(tt===RGB_ETC1_Format||tt===RGB_ETC2_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ETC2:rt.COMPRESSED_RGB8_ETC2;if(tt===RGBA_ETC2_EAC_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:rt.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(tt===RGBA_ASTC_4x4_Format||tt===RGBA_ASTC_5x4_Format||tt===RGBA_ASTC_5x5_Format||tt===RGBA_ASTC_6x5_Format||tt===RGBA_ASTC_6x6_Format||tt===RGBA_ASTC_8x5_Format||tt===RGBA_ASTC_8x6_Format||tt===RGBA_ASTC_8x8_Format||tt===RGBA_ASTC_10x5_Format||tt===RGBA_ASTC_10x6_Format||tt===RGBA_ASTC_10x8_Format||tt===RGBA_ASTC_10x10_Format||tt===RGBA_ASTC_12x10_Format||tt===RGBA_ASTC_12x12_Format)if(rt=_.get("WEBGL_compressed_texture_astc"),rt!==null){if(tt===RGBA_ASTC_4x4_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:rt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(tt===RGBA_ASTC_5x4_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:rt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(tt===RGBA_ASTC_5x5_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:rt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(tt===RGBA_ASTC_6x5_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:rt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(tt===RGBA_ASTC_6x6_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:rt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(tt===RGBA_ASTC_8x5_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:rt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(tt===RGBA_ASTC_8x6_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:rt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(tt===RGBA_ASTC_8x8_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:rt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(tt===RGBA_ASTC_10x5_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:rt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(tt===RGBA_ASTC_10x6_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:rt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(tt===RGBA_ASTC_10x8_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:rt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(tt===RGBA_ASTC_10x10_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:rt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(tt===RGBA_ASTC_12x10_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:rt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(tt===RGBA_ASTC_12x12_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:rt.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(tt===RGBA_BPTC_Format||tt===RGB_BPTC_SIGNED_Format||tt===RGB_BPTC_UNSIGNED_Format)if(rt=_.get("EXT_texture_compression_bptc"),rt!==null){if(tt===RGBA_BPTC_Format)return it===SRGBTransfer?rt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:rt.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(tt===RGB_BPTC_SIGNED_Format)return rt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(tt===RGB_BPTC_UNSIGNED_Format)return rt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(tt===RED_RGTC1_Format||tt===SIGNED_RED_RGTC1_Format||tt===RED_GREEN_RGTC2_Format||tt===SIGNED_RED_GREEN_RGTC2_Format)if(rt=_.get("EXT_texture_compression_rgtc"),rt!==null){if(tt===RGBA_BPTC_Format)return rt.COMPRESSED_RED_RGTC1_EXT;if(tt===SIGNED_RED_RGTC1_Format)return rt.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(tt===RED_GREEN_RGTC2_Format)return rt.COMPRESSED_RED_GREEN_RGTC2_EXT;if(tt===SIGNED_RED_GREEN_RGTC2_Format)return rt.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return tt===UnsignedInt248Type?et.UNSIGNED_INT_24_8:et[tt]!==void 0?et[tt]:null}return{convert:_e}}class ArrayCamera extends PerspectiveCamera{constructor(_=[]){super(),this.isArrayCamera=!0,this.cameras=_}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_){return this._targetRay!==null&&this._targetRay.dispatchEvent(_),this._grip!==null&&this._grip.dispatchEvent(_),this._hand!==null&&this._hand.dispatchEvent(_),this}connect(_){if(_&&_.hand){const _e=this._hand;if(_e)for(const tt of _.hand.values())this._getHandJoint(_e,tt)}return this.dispatchEvent({type:"connected",data:_}),this}disconnect(_){return this.dispatchEvent({type:"disconnected",data:_}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_,_e,tt){let nt=null,rt=null,it=null;const st=this._targetRay,ot=this._grip,at=this._hand;if(_&&_e.session.visibilityState!=="visible-blurred"){if(at&&_.hand){it=!0;for(const dt of _.hand.values()){const pt=_e.getJointPose(dt,tt),mt=this._getHandJoint(at,dt);pt!==null&&(mt.matrix.fromArray(pt.transform.matrix),mt.matrix.decompose(mt.position,mt.rotation,mt.scale),mt.matrixWorldNeedsUpdate=!0,mt.jointRadius=pt.radius),mt.visible=pt!==null}const lt=at.joints["index-finger-tip"],ct=at.joints["thumb-tip"],ht=lt.position.distanceTo(ct.position),ut=.02,ft=.005;at.inputState.pinching&&ht>ut+ft?(at.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_.handedness,target:this})):!at.inputState.pinching&&ht<=ut-ft&&(at.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_.handedness,target:this}))}else ot!==null&&_.gripSpace&&(rt=_e.getPose(_.gripSpace,tt),rt!==null&&(ot.matrix.fromArray(rt.transform.matrix),ot.matrix.decompose(ot.position,ot.rotation,ot.scale),ot.matrixWorldNeedsUpdate=!0,rt.linearVelocity?(ot.hasLinearVelocity=!0,ot.linearVelocity.copy(rt.linearVelocity)):ot.hasLinearVelocity=!1,rt.angularVelocity?(ot.hasAngularVelocity=!0,ot.angularVelocity.copy(rt.angularVelocity)):ot.hasAngularVelocity=!1));st!==null&&(nt=_e.getPose(_.targetRaySpace,tt),nt===null&&rt!==null&&(nt=rt),nt!==null&&(st.matrix.fromArray(nt.transform.matrix),st.matrix.decompose(st.position,st.rotation,st.scale),st.matrixWorldNeedsUpdate=!0,nt.linearVelocity?(st.hasLinearVelocity=!0,st.linearVelocity.copy(nt.linearVelocity)):st.hasLinearVelocity=!1,nt.angularVelocity?(st.hasAngularVelocity=!0,st.angularVelocity.copy(nt.angularVelocity)):st.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return st!==null&&(st.visible=nt!==null),ot!==null&&(ot.visible=rt!==null),at!==null&&(at.visible=it!==null),this}_getHandJoint(_,_e){if(_.joints[_e.jointName]===void 0){const tt=new Group;tt.matrixAutoUpdate=!1,tt.visible=!1,_.joints[_e.jointName]=tt,_.add(tt)}return _.joints[_e.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(_,_e,tt){if(this.texture===null){const nt=new Texture$1,rt=_.properties.get(nt);rt.__webglTexture=_e.texture,(_e.depthNear!=tt.depthNear||_e.depthFar!=tt.depthFar)&&(this.depthNear=_e.depthNear,this.depthFar=_e.depthFar),this.texture=nt}}getMesh(_){if(this.texture!==null&&this.mesh===null){const _e=_.cameras[0].viewport,tt=new ShaderMaterial({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:_e.z},depthHeight:{value:_e.w}}});this.mesh=new Mesh(new PlaneGeometry(20,20),tt)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends EventDispatcher{constructor(_,_e){super();const tt=this;let nt=null,rt=1,it=null,st="local-floor",ot=1,at=null,lt=null,ct=null,ht=null,ut=null,ft=null;const dt=new WebXRDepthSensing,pt=_e.getContextAttributes();let mt=null,vt=null;const yt=[],_t=[],St=new Vector2;let bt=null;const Et=new PerspectiveCamera;Et.layers.enable(1),Et.viewport=new Vector4;const Mt=new PerspectiveCamera;Mt.layers.enable(2),Mt.viewport=new Vector4;const Tt=[Et,Mt],wt=new ArrayCamera;wt.layers.enable(1),wt.layers.enable(2);let Ct=null,Rt=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Gt){let Xt=yt[Gt];return Xt===void 0&&(Xt=new WebXRController,yt[Gt]=Xt),Xt.getTargetRaySpace()},this.getControllerGrip=function(Gt){let Xt=yt[Gt];return Xt===void 0&&(Xt=new WebXRController,yt[Gt]=Xt),Xt.getGripSpace()},this.getHand=function(Gt){let Xt=yt[Gt];return Xt===void 0&&(Xt=new WebXRController,yt[Gt]=Xt),Xt.getHandSpace()};function It(Gt){const Xt=_t.indexOf(Gt.inputSource);if(Xt===-1)return;const Zt=yt[Xt];Zt!==void 0&&(Zt.update(Gt.inputSource,Gt.frame,at||it),Zt.dispatchEvent({type:Gt.type,data:Gt.inputSource}))}function Dt(){nt.removeEventListener("select",It),nt.removeEventListener("selectstart",It),nt.removeEventListener("selectend",It),nt.removeEventListener("squeeze",It),nt.removeEventListener("squeezestart",It),nt.removeEventListener("squeezeend",It),nt.removeEventListener("end",Dt),nt.removeEventListener("inputsourceschange",Ft);for(let Gt=0;Gt<yt.length;Gt++){const Xt=_t[Gt];Xt!==null&&(_t[Gt]=null,yt[Gt].disconnect(Xt))}Ct=null,Rt=null,dt.reset(),_.setRenderTarget(mt),ut=null,ht=null,ct=null,nt=null,vt=null,qt.stop(),tt.isPresenting=!1,_.setPixelRatio(bt),_.setSize(St.width,St.height,!1),tt.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Gt){rt=Gt,tt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Gt){st=Gt,tt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return at||it},this.setReferenceSpace=function(Gt){at=Gt},this.getBaseLayer=function(){return ht!==null?ht:ut},this.getBinding=function(){return ct},this.getFrame=function(){return ft},this.getSession=function(){return nt},this.setSession=async function(Gt){if(nt=Gt,nt!==null){if(mt=_.getRenderTarget(),nt.addEventListener("select",It),nt.addEventListener("selectstart",It),nt.addEventListener("selectend",It),nt.addEventListener("squeeze",It),nt.addEventListener("squeezestart",It),nt.addEventListener("squeezeend",It),nt.addEventListener("end",Dt),nt.addEventListener("inputsourceschange",Ft),pt.xrCompatible!==!0&&await _e.makeXRCompatible(),bt=_.getPixelRatio(),_.getSize(St),nt.renderState.layers===void 0){const Xt={antialias:pt.antialias,alpha:!0,depth:pt.depth,stencil:pt.stencil,framebufferScaleFactor:rt};ut=new XRWebGLLayer(nt,_e,Xt),nt.updateRenderState({baseLayer:ut}),_.setPixelRatio(1),_.setSize(ut.framebufferWidth,ut.framebufferHeight,!1),vt=new WebGLRenderTarget(ut.framebufferWidth,ut.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:_.outputColorSpace,stencilBuffer:pt.stencil})}else{let Xt=null,Zt=null,Qt=null;pt.depth&&(Qt=pt.stencil?_e.DEPTH24_STENCIL8:_e.DEPTH_COMPONENT24,Xt=pt.stencil?DepthStencilFormat:DepthFormat,Zt=pt.stencil?UnsignedInt248Type:UnsignedIntType);const un={colorFormat:_e.RGBA8,depthFormat:Qt,scaleFactor:rt};ct=new XRWebGLBinding(nt,_e),ht=ct.createProjectionLayer(un),nt.updateRenderState({layers:[ht]}),_.setPixelRatio(1),_.setSize(ht.textureWidth,ht.textureHeight,!1),vt=new WebGLRenderTarget(ht.textureWidth,ht.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(ht.textureWidth,ht.textureHeight,Zt,void 0,void 0,void 0,void 0,void 0,void 0,Xt),stencilBuffer:pt.stencil,colorSpace:_.outputColorSpace,samples:pt.antialias?4:0,resolveDepthBuffer:ht.ignoreDepthValues===!1})}vt.isXRRenderTarget=!0,this.setFoveation(ot),at=null,it=await nt.requestReferenceSpace(st),qt.setContext(nt),qt.start(),tt.isPresenting=!0,tt.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(nt!==null)return nt.environmentBlendMode},this.getDepthTexture=function(){return dt.getDepthTexture()};function Ft(Gt){for(let Xt=0;Xt<Gt.removed.length;Xt++){const Zt=Gt.removed[Xt],Qt=_t.indexOf(Zt);Qt>=0&&(_t[Qt]=null,yt[Qt].disconnect(Zt))}for(let Xt=0;Xt<Gt.added.length;Xt++){const Zt=Gt.added[Xt];let Qt=_t.indexOf(Zt);if(Qt===-1){for(let wn=0;wn<yt.length;wn++)if(wn>=_t.length){_t.push(Zt),Qt=wn;break}else if(_t[wn]===null){_t[wn]=Zt,Qt=wn;break}if(Qt===-1)break}const un=yt[Qt];un&&un.connect(Zt)}}const $t=new Vector3,Yt=new Vector3;function Lt(Gt,Xt,Zt){$t.setFromMatrixPosition(Xt.matrixWorld),Yt.setFromMatrixPosition(Zt.matrixWorld);const Qt=$t.distanceTo(Yt),un=Xt.projectionMatrix.elements,wn=Zt.projectionMatrix.elements,Tn=un[14]/(un[10]-1),yn=un[14]/(un[10]+1),Vt=(un[9]+1)/un[5],fn=(un[9]-1)/un[5],ln=(un[8]-1)/un[0],Jt=(wn[8]+1)/wn[0],on=Tn*ln,_n=Tn*Jt,cn=Qt/(-ln+Jt),tn=cn*-ln;Xt.matrixWorld.decompose(Gt.position,Gt.quaternion,Gt.scale),Gt.translateX(tn),Gt.translateZ(cn),Gt.matrixWorld.compose(Gt.position,Gt.quaternion,Gt.scale),Gt.matrixWorldInverse.copy(Gt.matrixWorld).invert();const Wt=Tn+cn,Bt=yn+cn,nn=on-tn,en=_n+(Qt-tn),mn=Vt*yn/Bt*Wt,sn=fn*yn/Bt*Wt;Gt.projectionMatrix.makePerspective(nn,en,mn,sn,Wt,Bt),Gt.projectionMatrixInverse.copy(Gt.projectionMatrix).invert()}function Ot(Gt,Xt){Xt===null?Gt.matrixWorld.copy(Gt.matrix):Gt.matrixWorld.multiplyMatrices(Xt.matrixWorld,Gt.matrix),Gt.matrixWorldInverse.copy(Gt.matrixWorld).invert()}this.updateCamera=function(Gt){if(nt===null)return;dt.texture!==null&&(Gt.near=dt.depthNear,Gt.far=dt.depthFar),wt.near=Mt.near=Et.near=Gt.near,wt.far=Mt.far=Et.far=Gt.far,(Ct!==wt.near||Rt!==wt.far)&&(nt.updateRenderState({depthNear:wt.near,depthFar:wt.far}),Ct=wt.near,Rt=wt.far,Et.near=Ct,Et.far=Rt,Mt.near=Ct,Mt.far=Rt,Et.updateProjectionMatrix(),Mt.updateProjectionMatrix(),Gt.updateProjectionMatrix());const Xt=Gt.parent,Zt=wt.cameras;Ot(wt,Xt);for(let Qt=0;Qt<Zt.length;Qt++)Ot(Zt[Qt],Xt);Zt.length===2?Lt(wt,Et,Mt):wt.projectionMatrix.copy(Et.projectionMatrix),Nt(Gt,wt,Xt)};function Nt(Gt,Xt,Zt){Zt===null?Gt.matrix.copy(Xt.matrixWorld):(Gt.matrix.copy(Zt.matrixWorld),Gt.matrix.invert(),Gt.matrix.multiply(Xt.matrixWorld)),Gt.matrix.decompose(Gt.position,Gt.quaternion,Gt.scale),Gt.updateMatrixWorld(!0),Gt.projectionMatrix.copy(Xt.projectionMatrix),Gt.projectionMatrixInverse.copy(Xt.projectionMatrixInverse),Gt.isPerspectiveCamera&&(Gt.fov=RAD2DEG*2*Math.atan(1/Gt.projectionMatrix.elements[5]),Gt.zoom=1)}this.getCamera=function(){return wt},this.getFoveation=function(){if(!(ht===null&&ut===null))return ot},this.setFoveation=function(Gt){ot=Gt,ht!==null&&(ht.fixedFoveation=Gt),ut!==null&&ut.fixedFoveation!==void 0&&(ut.fixedFoveation=Gt)},this.hasDepthSensing=function(){return dt.texture!==null},this.getDepthSensingMesh=function(){return dt.getMesh(wt)};let zt=null;function Ht(Gt,Xt){if(lt=Xt.getViewerPose(at||it),ft=Xt,lt!==null){const Zt=lt.views;ut!==null&&(_.setRenderTargetFramebuffer(vt,ut.framebuffer),_.setRenderTarget(vt));let Qt=!1;Zt.length!==wt.cameras.length&&(wt.cameras.length=0,Qt=!0);for(let wn=0;wn<Zt.length;wn++){const Tn=Zt[wn];let yn=null;if(ut!==null)yn=ut.getViewport(Tn);else{const fn=ct.getViewSubImage(ht,Tn);yn=fn.viewport,wn===0&&(_.setRenderTargetTextures(vt,fn.colorTexture,ht.ignoreDepthValues?void 0:fn.depthStencilTexture),_.setRenderTarget(vt))}let Vt=Tt[wn];Vt===void 0&&(Vt=new PerspectiveCamera,Vt.layers.enable(wn),Vt.viewport=new Vector4,Tt[wn]=Vt),Vt.matrix.fromArray(Tn.transform.matrix),Vt.matrix.decompose(Vt.position,Vt.quaternion,Vt.scale),Vt.projectionMatrix.fromArray(Tn.projectionMatrix),Vt.projectionMatrixInverse.copy(Vt.projectionMatrix).invert(),Vt.viewport.set(yn.x,yn.y,yn.width,yn.height),wn===0&&(wt.matrix.copy(Vt.matrix),wt.matrix.decompose(wt.position,wt.quaternion,wt.scale)),Qt===!0&&wt.cameras.push(Vt)}const un=nt.enabledFeatures;if(un&&un.includes("depth-sensing")){const wn=ct.getDepthInformation(Zt[0]);wn&&wn.isValid&&wn.texture&&dt.init(_,wn,nt.renderState)}}for(let Zt=0;Zt<yt.length;Zt++){const Qt=_t[Zt],un=yt[Zt];Qt!==null&&un!==void 0&&un.update(Qt,Xt,at||it)}zt&&zt(Gt,Xt),Xt.detectedPlanes&&tt.dispatchEvent({type:"planesdetected",data:Xt}),ft=null}const qt=new WebGLAnimation;qt.setAnimationLoop(Ht),this.setAnimationLoop=function(Gt){zt=Gt},this.dispose=function(){}}}const _e1=new Euler,_m1=new Matrix4;function WebGLMaterials(et,_){function _e(pt,mt){pt.matrixAutoUpdate===!0&&pt.updateMatrix(),mt.value.copy(pt.matrix)}function tt(pt,mt){mt.color.getRGB(pt.fogColor.value,getUnlitUniformColorSpace(et)),mt.isFog?(pt.fogNear.value=mt.near,pt.fogFar.value=mt.far):mt.isFogExp2&&(pt.fogDensity.value=mt.density)}function nt(pt,mt,vt,yt,_t){mt.isMeshBasicMaterial||mt.isMeshLambertMaterial?rt(pt,mt):mt.isMeshToonMaterial?(rt(pt,mt),ct(pt,mt)):mt.isMeshPhongMaterial?(rt(pt,mt),lt(pt,mt)):mt.isMeshStandardMaterial?(rt(pt,mt),ht(pt,mt),mt.isMeshPhysicalMaterial&&ut(pt,mt,_t)):mt.isMeshMatcapMaterial?(rt(pt,mt),ft(pt,mt)):mt.isMeshDepthMaterial?rt(pt,mt):mt.isMeshDistanceMaterial?(rt(pt,mt),dt(pt,mt)):mt.isMeshNormalMaterial?rt(pt,mt):mt.isLineBasicMaterial?(it(pt,mt),mt.isLineDashedMaterial&&st(pt,mt)):mt.isPointsMaterial?ot(pt,mt,vt,yt):mt.isSpriteMaterial?at(pt,mt):mt.isShadowMaterial?(pt.color.value.copy(mt.color),pt.opacity.value=mt.opacity):mt.isShaderMaterial&&(mt.uniformsNeedUpdate=!1)}function rt(pt,mt){pt.opacity.value=mt.opacity,mt.color&&pt.diffuse.value.copy(mt.color),mt.emissive&&pt.emissive.value.copy(mt.emissive).multiplyScalar(mt.emissiveIntensity),mt.map&&(pt.map.value=mt.map,_e(mt.map,pt.mapTransform)),mt.alphaMap&&(pt.alphaMap.value=mt.alphaMap,_e(mt.alphaMap,pt.alphaMapTransform)),mt.bumpMap&&(pt.bumpMap.value=mt.bumpMap,_e(mt.bumpMap,pt.bumpMapTransform),pt.bumpScale.value=mt.bumpScale,mt.side===BackSide&&(pt.bumpScale.value*=-1)),mt.normalMap&&(pt.normalMap.value=mt.normalMap,_e(mt.normalMap,pt.normalMapTransform),pt.normalScale.value.copy(mt.normalScale),mt.side===BackSide&&pt.normalScale.value.negate()),mt.displacementMap&&(pt.displacementMap.value=mt.displacementMap,_e(mt.displacementMap,pt.displacementMapTransform),pt.displacementScale.value=mt.displacementScale,pt.displacementBias.value=mt.displacementBias),mt.emissiveMap&&(pt.emissiveMap.value=mt.emissiveMap,_e(mt.emissiveMap,pt.emissiveMapTransform)),mt.specularMap&&(pt.specularMap.value=mt.specularMap,_e(mt.specularMap,pt.specularMapTransform)),mt.alphaTest>0&&(pt.alphaTest.value=mt.alphaTest);const vt=_.get(mt),yt=vt.envMap,_t=vt.envMapRotation;yt&&(pt.envMap.value=yt,_e1.copy(_t),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,yt.isCubeTexture&&yt.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),pt.envMapRotation.value.setFromMatrix4(_m1.makeRotationFromEuler(_e1)),pt.flipEnvMap.value=yt.isCubeTexture&&yt.isRenderTargetTexture===!1?-1:1,pt.reflectivity.value=mt.reflectivity,pt.ior.value=mt.ior,pt.refractionRatio.value=mt.refractionRatio),mt.lightMap&&(pt.lightMap.value=mt.lightMap,pt.lightMapIntensity.value=mt.lightMapIntensity,_e(mt.lightMap,pt.lightMapTransform)),mt.aoMap&&(pt.aoMap.value=mt.aoMap,pt.aoMapIntensity.value=mt.aoMapIntensity,_e(mt.aoMap,pt.aoMapTransform))}function it(pt,mt){pt.diffuse.value.copy(mt.color),pt.opacity.value=mt.opacity,mt.map&&(pt.map.value=mt.map,_e(mt.map,pt.mapTransform))}function st(pt,mt){pt.dashSize.value=mt.dashSize,pt.totalSize.value=mt.dashSize+mt.gapSize,pt.scale.value=mt.scale}function ot(pt,mt,vt,yt){pt.diffuse.value.copy(mt.color),pt.opacity.value=mt.opacity,pt.size.value=mt.size*vt,pt.scale.value=yt*.5,mt.map&&(pt.map.value=mt.map,_e(mt.map,pt.uvTransform)),mt.alphaMap&&(pt.alphaMap.value=mt.alphaMap,_e(mt.alphaMap,pt.alphaMapTransform)),mt.alphaTest>0&&(pt.alphaTest.value=mt.alphaTest)}function at(pt,mt){pt.diffuse.value.copy(mt.color),pt.opacity.value=mt.opacity,pt.rotation.value=mt.rotation,mt.map&&(pt.map.value=mt.map,_e(mt.map,pt.mapTransform)),mt.alphaMap&&(pt.alphaMap.value=mt.alphaMap,_e(mt.alphaMap,pt.alphaMapTransform)),mt.alphaTest>0&&(pt.alphaTest.value=mt.alphaTest)}function lt(pt,mt){pt.specular.value.copy(mt.specular),pt.shininess.value=Math.max(mt.shininess,1e-4)}function ct(pt,mt){mt.gradientMap&&(pt.gradientMap.value=mt.gradientMap)}function ht(pt,mt){pt.metalness.value=mt.metalness,mt.metalnessMap&&(pt.metalnessMap.value=mt.metalnessMap,_e(mt.metalnessMap,pt.metalnessMapTransform)),pt.roughness.value=mt.roughness,mt.roughnessMap&&(pt.roughnessMap.value=mt.roughnessMap,_e(mt.roughnessMap,pt.roughnessMapTransform)),mt.envMap&&(pt.envMapIntensity.value=mt.envMapIntensity)}function ut(pt,mt,vt){pt.ior.value=mt.ior,mt.sheen>0&&(pt.sheenColor.value.copy(mt.sheenColor).multiplyScalar(mt.sheen),pt.sheenRoughness.value=mt.sheenRoughness,mt.sheenColorMap&&(pt.sheenColorMap.value=mt.sheenColorMap,_e(mt.sheenColorMap,pt.sheenColorMapTransform)),mt.sheenRoughnessMap&&(pt.sheenRoughnessMap.value=mt.sheenRoughnessMap,_e(mt.sheenRoughnessMap,pt.sheenRoughnessMapTransform))),mt.clearcoat>0&&(pt.clearcoat.value=mt.clearcoat,pt.clearcoatRoughness.value=mt.clearcoatRoughness,mt.clearcoatMap&&(pt.clearcoatMap.value=mt.clearcoatMap,_e(mt.clearcoatMap,pt.clearcoatMapTransform)),mt.clearcoatRoughnessMap&&(pt.clearcoatRoughnessMap.value=mt.clearcoatRoughnessMap,_e(mt.clearcoatRoughnessMap,pt.clearcoatRoughnessMapTransform)),mt.clearcoatNormalMap&&(pt.clearcoatNormalMap.value=mt.clearcoatNormalMap,_e(mt.clearcoatNormalMap,pt.clearcoatNormalMapTransform),pt.clearcoatNormalScale.value.copy(mt.clearcoatNormalScale),mt.side===BackSide&&pt.clearcoatNormalScale.value.negate())),mt.dispersion>0&&(pt.dispersion.value=mt.dispersion),mt.iridescence>0&&(pt.iridescence.value=mt.iridescence,pt.iridescenceIOR.value=mt.iridescenceIOR,pt.iridescenceThicknessMinimum.value=mt.iridescenceThicknessRange[0],pt.iridescenceThicknessMaximum.value=mt.iridescenceThicknessRange[1],mt.iridescenceMap&&(pt.iridescenceMap.value=mt.iridescenceMap,_e(mt.iridescenceMap,pt.iridescenceMapTransform)),mt.iridescenceThicknessMap&&(pt.iridescenceThicknessMap.value=mt.iridescenceThicknessMap,_e(mt.iridescenceThicknessMap,pt.iridescenceThicknessMapTransform))),mt.transmission>0&&(pt.transmission.value=mt.transmission,pt.transmissionSamplerMap.value=vt.texture,pt.transmissionSamplerSize.value.set(vt.width,vt.height),mt.transmissionMap&&(pt.transmissionMap.value=mt.transmissionMap,_e(mt.transmissionMap,pt.transmissionMapTransform)),pt.thickness.value=mt.thickness,mt.thicknessMap&&(pt.thicknessMap.value=mt.thicknessMap,_e(mt.thicknessMap,pt.thicknessMapTransform)),pt.attenuationDistance.value=mt.attenuationDistance,pt.attenuationColor.value.copy(mt.attenuationColor)),mt.anisotropy>0&&(pt.anisotropyVector.value.set(mt.anisotropy*Math.cos(mt.anisotropyRotation),mt.anisotropy*Math.sin(mt.anisotropyRotation)),mt.anisotropyMap&&(pt.anisotropyMap.value=mt.anisotropyMap,_e(mt.anisotropyMap,pt.anisotropyMapTransform))),pt.specularIntensity.value=mt.specularIntensity,pt.specularColor.value.copy(mt.specularColor),mt.specularColorMap&&(pt.specularColorMap.value=mt.specularColorMap,_e(mt.specularColorMap,pt.specularColorMapTransform)),mt.specularIntensityMap&&(pt.specularIntensityMap.value=mt.specularIntensityMap,_e(mt.specularIntensityMap,pt.specularIntensityMapTransform))}function ft(pt,mt){mt.matcap&&(pt.matcap.value=mt.matcap)}function dt(pt,mt){const vt=_.get(mt).light;pt.referencePosition.value.setFromMatrixPosition(vt.matrixWorld),pt.nearDistance.value=vt.shadow.camera.near,pt.farDistance.value=vt.shadow.camera.far}return{refreshFogUniforms:tt,refreshMaterialUniforms:nt}}function WebGLUniformsGroups(et,_,_e,tt){let nt={},rt={},it=[];const st=et.getParameter(et.MAX_UNIFORM_BUFFER_BINDINGS);function ot(vt,yt){const _t=yt.program;tt.uniformBlockBinding(vt,_t)}function at(vt,yt){let _t=nt[vt.id];_t===void 0&&(ft(vt),_t=lt(vt),nt[vt.id]=_t,vt.addEventListener("dispose",pt));const St=yt.program;tt.updateUBOMapping(vt,St);const bt=_.render.frame;rt[vt.id]!==bt&&(ht(vt),rt[vt.id]=bt)}function lt(vt){const yt=ct();vt.__bindingPointIndex=yt;const _t=et.createBuffer(),St=vt.__size,bt=vt.usage;return et.bindBuffer(et.UNIFORM_BUFFER,_t),et.bufferData(et.UNIFORM_BUFFER,St,bt),et.bindBuffer(et.UNIFORM_BUFFER,null),et.bindBufferBase(et.UNIFORM_BUFFER,yt,_t),_t}function ct(){for(let vt=0;vt<st;vt++)if(it.indexOf(vt)===-1)return it.push(vt),vt;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function ht(vt){const yt=nt[vt.id],_t=vt.uniforms,St=vt.__cache;et.bindBuffer(et.UNIFORM_BUFFER,yt);for(let bt=0,Et=_t.length;bt<Et;bt++){const Mt=Array.isArray(_t[bt])?_t[bt]:[_t[bt]];for(let Tt=0,wt=Mt.length;Tt<wt;Tt++){const Ct=Mt[Tt];if(ut(Ct,bt,Tt,St)===!0){const Rt=Ct.__offset,It=Array.isArray(Ct.value)?Ct.value:[Ct.value];let Dt=0;for(let Ft=0;Ft<It.length;Ft++){const $t=It[Ft],Yt=dt($t);typeof $t=="number"||typeof $t=="boolean"?(Ct.__data[0]=$t,et.bufferSubData(et.UNIFORM_BUFFER,Rt+Dt,Ct.__data)):$t.isMatrix3?(Ct.__data[0]=$t.elements[0],Ct.__data[1]=$t.elements[1],Ct.__data[2]=$t.elements[2],Ct.__data[3]=0,Ct.__data[4]=$t.elements[3],Ct.__data[5]=$t.elements[4],Ct.__data[6]=$t.elements[5],Ct.__data[7]=0,Ct.__data[8]=$t.elements[6],Ct.__data[9]=$t.elements[7],Ct.__data[10]=$t.elements[8],Ct.__data[11]=0):($t.toArray(Ct.__data,Dt),Dt+=Yt.storage/Float32Array.BYTES_PER_ELEMENT)}et.bufferSubData(et.UNIFORM_BUFFER,Rt,Ct.__data)}}}et.bindBuffer(et.UNIFORM_BUFFER,null)}function ut(vt,yt,_t,St){const bt=vt.value,Et=yt+"_"+_t;if(St[Et]===void 0)return typeof bt=="number"||typeof bt=="boolean"?St[Et]=bt:St[Et]=bt.clone(),!0;{const Mt=St[Et];if(typeof bt=="number"||typeof bt=="boolean"){if(Mt!==bt)return St[Et]=bt,!0}else if(Mt.equals(bt)===!1)return Mt.copy(bt),!0}return!1}function ft(vt){const yt=vt.uniforms;let _t=0;const St=16;for(let Et=0,Mt=yt.length;Et<Mt;Et++){const Tt=Array.isArray(yt[Et])?yt[Et]:[yt[Et]];for(let wt=0,Ct=Tt.length;wt<Ct;wt++){const Rt=Tt[wt],It=Array.isArray(Rt.value)?Rt.value:[Rt.value];for(let Dt=0,Ft=It.length;Dt<Ft;Dt++){const $t=It[Dt],Yt=dt($t),Lt=_t%St;Lt!==0&&St-Lt<Yt.boundary&&(_t+=St-Lt),Rt.__data=new Float32Array(Yt.storage/Float32Array.BYTES_PER_ELEMENT),Rt.__offset=_t,_t+=Yt.storage}}}const bt=_t%St;return bt>0&&(_t+=St-bt),vt.__size=_t,vt.__cache={},this}function dt(vt){const yt={boundary:0,storage:0};return typeof vt=="number"||typeof vt=="boolean"?(yt.boundary=4,yt.storage=4):vt.isVector2?(yt.boundary=8,yt.storage=8):vt.isVector3||vt.isColor?(yt.boundary=16,yt.storage=12):vt.isVector4?(yt.boundary=16,yt.storage=16):vt.isMatrix3?(yt.boundary=48,yt.storage=48):vt.isMatrix4?(yt.boundary=64,yt.storage=64):vt.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",vt),yt}function pt(vt){const yt=vt.target;yt.removeEventListener("dispose",pt);const _t=it.indexOf(yt.__bindingPointIndex);it.splice(_t,1),et.deleteBuffer(nt[yt.id]),delete nt[yt.id],delete rt[yt.id]}function mt(){for(const vt in nt)et.deleteBuffer(nt[vt]);it=[],nt={},rt={}}return{bind:ot,update:at,dispose:mt}}class WebGLRenderer{constructor(_={}){const{canvas:_e=createCanvasElement(),context:tt=null,depth:nt=!0,stencil:rt=!1,alpha:it=!1,antialias:st=!1,premultipliedAlpha:ot=!0,preserveDrawingBuffer:at=!1,powerPreference:lt="default",failIfMajorPerformanceCaveat:ct=!1}=_;this.isWebGLRenderer=!0;let ht;if(tt!==null){if(typeof WebGLRenderingContext<"u"&&tt instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");ht=tt.getContextAttributes().alpha}else ht=it;const ut=new Uint32Array(4),ft=new Int32Array(4);let dt=null,pt=null;const mt=[],vt=[];this.domElement=_e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const yt=this;let _t=!1,St=0,bt=0,Et=null,Mt=-1,Tt=null;const wt=new Vector4,Ct=new Vector4;let Rt=null;const It=new Color$1(0);let Dt=0,Ft=_e.width,$t=_e.height,Yt=1,Lt=null,Ot=null;const Nt=new Vector4(0,0,Ft,$t),zt=new Vector4(0,0,Ft,$t);let Ht=!1;const qt=new Frustum;let Gt=!1,Xt=!1;const Zt=new Matrix4,Qt=new Vector3,un=new Vector4,wn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Tn=!1;function yn(){return Et===null?Yt:1}let Vt=tt;function fn(Kt,vn){return _e.getContext(Kt,vn)}try{const Kt={alpha:!0,depth:nt,stencil:rt,antialias:st,premultipliedAlpha:ot,preserveDrawingBuffer:at,powerPreference:lt,failIfMajorPerformanceCaveat:ct};if("setAttribute"in _e&&_e.setAttribute("data-engine",`three.js r${REVISION}`),_e.addEventListener("webglcontextlost",Pn,!1),_e.addEventListener("webglcontextrestored",Dn,!1),_e.addEventListener("webglcontextcreationerror",Hn,!1),Vt===null){const vn="webgl2";if(Vt=fn(vn,Kt),Vt===null)throw fn(vn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Kt){throw console.error("THREE.WebGLRenderer: "+Kt.message),Kt}let ln,Jt,on,_n,cn,tn,Wt,Bt,nn,en,mn,sn,xn,an,pn,Sn,gn,Rn,Mn,kn,Fn,Nn,Zn,er;function dn(){ln=new WebGLExtensions(Vt),ln.init(),Nn=new WebGLUtils(Vt,ln),Jt=new WebGLCapabilities(Vt,ln,_,Nn),on=new WebGLState(Vt),_n=new WebGLInfo(Vt),cn=new WebGLProperties,tn=new WebGLTextures(Vt,ln,on,cn,Jt,Nn,_n),Wt=new WebGLCubeMaps(yt),Bt=new WebGLCubeUVMaps(yt),nn=new WebGLAttributes(Vt),Zn=new WebGLBindingStates(Vt,nn),en=new WebGLGeometries(Vt,nn,_n,Zn),mn=new WebGLObjects(Vt,en,nn,_n),Mn=new WebGLMorphtargets(Vt,Jt,tn),Sn=new WebGLClipping(cn),sn=new WebGLPrograms(yt,Wt,Bt,ln,Jt,Zn,Sn),xn=new WebGLMaterials(yt,cn),an=new WebGLRenderLists,pn=new WebGLRenderStates(ln),Rn=new WebGLBackground(yt,Wt,Bt,on,mn,ht,ot),gn=new WebGLShadowMap(yt,mn,Jt),er=new WebGLUniformsGroups(Vt,_n,Jt,on),kn=new WebGLBufferRenderer(Vt,ln,_n),Fn=new WebGLIndexedBufferRenderer(Vt,ln,_n),_n.programs=sn.programs,yt.capabilities=Jt,yt.extensions=ln,yt.properties=cn,yt.renderLists=an,yt.shadowMap=gn,yt.state=on,yt.info=_n}dn();const $n=new WebXRManager(yt,Vt);this.xr=$n,this.getContext=function(){return Vt},this.getContextAttributes=function(){return Vt.getContextAttributes()},this.forceContextLoss=function(){const Kt=ln.get("WEBGL_lose_context");Kt&&Kt.loseContext()},this.forceContextRestore=function(){const Kt=ln.get("WEBGL_lose_context");Kt&&Kt.restoreContext()},this.getPixelRatio=function(){return Yt},this.setPixelRatio=function(Kt){Kt!==void 0&&(Yt=Kt,this.setSize(Ft,$t,!1))},this.getSize=function(Kt){return Kt.set(Ft,$t)},this.setSize=function(Kt,vn,In=!0){if($n.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ft=Kt,$t=vn,_e.width=Math.floor(Kt*Yt),_e.height=Math.floor(vn*Yt),In===!0&&(_e.style.width=Kt+"px",_e.style.height=vn+"px"),this.setViewport(0,0,Kt,vn)},this.getDrawingBufferSize=function(Kt){return Kt.set(Ft*Yt,$t*Yt).floor()},this.setDrawingBufferSize=function(Kt,vn,In){Ft=Kt,$t=vn,Yt=In,_e.width=Math.floor(Kt*In),_e.height=Math.floor(vn*In),this.setViewport(0,0,Kt,vn)},this.getCurrentViewport=function(Kt){return Kt.copy(wt)},this.getViewport=function(Kt){return Kt.copy(Nt)},this.setViewport=function(Kt,vn,In,Ln){Kt.isVector4?Nt.set(Kt.x,Kt.y,Kt.z,Kt.w):Nt.set(Kt,vn,In,Ln),on.viewport(wt.copy(Nt).multiplyScalar(Yt).round())},this.getScissor=function(Kt){return Kt.copy(zt)},this.setScissor=function(Kt,vn,In,Ln){Kt.isVector4?zt.set(Kt.x,Kt.y,Kt.z,Kt.w):zt.set(Kt,vn,In,Ln),on.scissor(Ct.copy(zt).multiplyScalar(Yt).round())},this.getScissorTest=function(){return Ht},this.setScissorTest=function(Kt){on.setScissorTest(Ht=Kt)},this.setOpaqueSort=function(Kt){Lt=Kt},this.setTransparentSort=function(Kt){Ot=Kt},this.getClearColor=function(Kt){return Kt.copy(Rn.getClearColor())},this.setClearColor=function(){Rn.setClearColor.apply(Rn,arguments)},this.getClearAlpha=function(){return Rn.getClearAlpha()},this.setClearAlpha=function(){Rn.setClearAlpha.apply(Rn,arguments)},this.clear=function(Kt=!0,vn=!0,In=!0){let Ln=0;if(Kt){let Cn=!1;if(Et!==null){const Wn=Et.texture.format;Cn=Wn===RGBAIntegerFormat||Wn===RGIntegerFormat||Wn===RedIntegerFormat}if(Cn){const Wn=Et.texture.type,Qn=Wn===UnsignedByteType||Wn===UnsignedIntType||Wn===UnsignedShortType||Wn===UnsignedInt248Type||Wn===UnsignedShort4444Type||Wn===UnsignedShort5551Type,rr=Rn.getClearColor(),zn=Rn.getClearAlpha(),ar=rr.r,dr=rr.g,sr=rr.b;Qn?(ut[0]=ar,ut[1]=dr,ut[2]=sr,ut[3]=zn,Vt.clearBufferuiv(Vt.COLOR,0,ut)):(ft[0]=ar,ft[1]=dr,ft[2]=sr,ft[3]=zn,Vt.clearBufferiv(Vt.COLOR,0,ft))}else Ln|=Vt.COLOR_BUFFER_BIT}vn&&(Ln|=Vt.DEPTH_BUFFER_BIT),In&&(Ln|=Vt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Vt.clear(Ln)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){_e.removeEventListener("webglcontextlost",Pn,!1),_e.removeEventListener("webglcontextrestored",Dn,!1),_e.removeEventListener("webglcontextcreationerror",Hn,!1),an.dispose(),pn.dispose(),cn.dispose(),Wt.dispose(),Bt.dispose(),mn.dispose(),Zn.dispose(),er.dispose(),sn.dispose(),$n.dispose(),$n.removeEventListener("sessionstart",En),$n.removeEventListener("sessionend",Vn),Gn.stop()};function Pn(Kt){Kt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_t=!0}function Dn(){console.log("THREE.WebGLRenderer: Context Restored."),_t=!1;const Kt=_n.autoReset,vn=gn.enabled,In=gn.autoUpdate,Ln=gn.needsUpdate,Cn=gn.type;dn(),_n.autoReset=Kt,gn.enabled=vn,gn.autoUpdate=In,gn.needsUpdate=Ln,gn.type=Cn}function Hn(Kt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Kt.statusMessage)}function jn(Kt){const vn=Kt.target;vn.removeEventListener("dispose",jn),qn(vn)}function qn(Kt){hr(Kt),cn.remove(Kt)}function hr(Kt){const vn=cn.get(Kt).programs;vn!==void 0&&(vn.forEach(function(In){sn.releaseProgram(In)}),Kt.isShaderMaterial&&sn.releaseShaderCache(Kt))}this.renderBufferDirect=function(Kt,vn,In,Ln,Cn,Wn){vn===null&&(vn=wn);const Qn=Cn.isMesh&&Cn.matrixWorld.determinant()<0,rr=Ur(Kt,vn,In,Ln,Cn);on.setMaterial(Ln,Qn);let zn=In.index,ar=1;if(Ln.wireframe===!0){if(zn=en.getWireframeAttribute(In),zn===void 0)return;ar=2}const dr=In.drawRange,sr=In.attributes.position;let Mr=dr.start*ar,Dr=(dr.start+dr.count)*ar;Wn!==null&&(Mr=Math.max(Mr,Wn.start*ar),Dr=Math.min(Dr,(Wn.start+Wn.count)*ar)),zn!==null?(Mr=Math.max(Mr,0),Dr=Math.min(Dr,zn.count)):sr!=null&&(Mr=Math.max(Mr,0),Dr=Math.min(Dr,sr.count));const Ar=Dr-Mr;if(Ar<0||Ar===1/0)return;Zn.setup(Cn,Ln,rr,In,zn);let Lr,or=kn;if(zn!==null&&(Lr=nn.get(zn),or=Fn,or.setIndex(Lr)),Cn.isMesh)Ln.wireframe===!0?(on.setLineWidth(Ln.wireframeLinewidth*yn()),or.setMode(Vt.LINES)):or.setMode(Vt.TRIANGLES);else if(Cn.isLine){let Yn=Ln.linewidth;Yn===void 0&&(Yn=1),on.setLineWidth(Yn*yn()),Cn.isLineSegments?or.setMode(Vt.LINES):Cn.isLineLoop?or.setMode(Vt.LINE_LOOP):or.setMode(Vt.LINE_STRIP)}else Cn.isPoints?or.setMode(Vt.POINTS):Cn.isSprite&&or.setMode(Vt.TRIANGLES);if(Cn.isBatchedMesh)if(Cn._multiDrawInstances!==null)or.renderMultiDrawInstances(Cn._multiDrawStarts,Cn._multiDrawCounts,Cn._multiDrawCount,Cn._multiDrawInstances);else if(ln.get("WEBGL_multi_draw"))or.renderMultiDraw(Cn._multiDrawStarts,Cn._multiDrawCounts,Cn._multiDrawCount);else{const Yn=Cn._multiDrawStarts,Ir=Cn._multiDrawCounts,mr=Cn._multiDrawCount,kr=zn?nn.get(zn).bytesPerElement:1,ss=cn.get(Ln).currentProgram.getUniforms();for(let Fr=0;Fr<mr;Fr++)ss.setValue(Vt,"_gl_DrawID",Fr),or.render(Yn[Fr]/kr,Ir[Fr])}else if(Cn.isInstancedMesh)or.renderInstances(Mr,Ar,Cn.count);else if(In.isInstancedBufferGeometry){const Yn=In._maxInstanceCount!==void 0?In._maxInstanceCount:1/0,Ir=Math.min(In.instanceCount,Yn);or.renderInstances(Mr,Ar,Ir)}else or.render(Mr,Ar)};function fr(Kt,vn,In){Kt.transparent===!0&&Kt.side===DoubleSide&&Kt.forceSinglePass===!1?(Kt.side=BackSide,Kt.needsUpdate=!0,zr(Kt,vn,In),Kt.side=FrontSide,Kt.needsUpdate=!0,zr(Kt,vn,In),Kt.side=DoubleSide):zr(Kt,vn,In)}this.compile=function(Kt,vn,In=null){In===null&&(In=Kt),pt=pn.get(In),pt.init(vn),vt.push(pt),In.traverseVisible(function(Cn){Cn.isLight&&Cn.layers.test(vn.layers)&&(pt.pushLight(Cn),Cn.castShadow&&pt.pushShadow(Cn))}),Kt!==In&&Kt.traverseVisible(function(Cn){Cn.isLight&&Cn.layers.test(vn.layers)&&(pt.pushLight(Cn),Cn.castShadow&&pt.pushShadow(Cn))}),pt.setupLights();const Ln=new Set;return Kt.traverse(function(Cn){const Wn=Cn.material;if(Wn)if(Array.isArray(Wn))for(let Qn=0;Qn<Wn.length;Qn++){const rr=Wn[Qn];fr(rr,In,Cn),Ln.add(rr)}else fr(Wn,In,Cn),Ln.add(Wn)}),vt.pop(),pt=null,Ln},this.compileAsync=function(Kt,vn,In=null){const Ln=this.compile(Kt,vn,In);return new Promise(Cn=>{function Wn(){if(Ln.forEach(function(Qn){cn.get(Qn).currentProgram.isReady()&&Ln.delete(Qn)}),Ln.size===0){Cn(Kt);return}setTimeout(Wn,10)}ln.get("KHR_parallel_shader_compile")!==null?Wn():setTimeout(Wn,10)})};let jt=null;function hn(Kt){jt&&jt(Kt)}function En(){Gn.stop()}function Vn(){Gn.start()}const Gn=new WebGLAnimation;Gn.setAnimationLoop(hn),typeof self<"u"&&Gn.setContext(self),this.setAnimationLoop=function(Kt){jt=Kt,$n.setAnimationLoop(Kt),Kt===null?Gn.stop():Gn.start()},$n.addEventListener("sessionstart",En),$n.addEventListener("sessionend",Vn),this.render=function(Kt,vn){if(vn!==void 0&&vn.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_t===!0)return;if(Kt.matrixWorldAutoUpdate===!0&&Kt.updateMatrixWorld(),vn.parent===null&&vn.matrixWorldAutoUpdate===!0&&vn.updateMatrixWorld(),$n.enabled===!0&&$n.isPresenting===!0&&($n.cameraAutoUpdate===!0&&$n.updateCamera(vn),vn=$n.getCamera()),Kt.isScene===!0&&Kt.onBeforeRender(yt,Kt,vn,Et),pt=pn.get(Kt,vt.length),pt.init(vn),vt.push(pt),Zt.multiplyMatrices(vn.projectionMatrix,vn.matrixWorldInverse),qt.setFromProjectionMatrix(Zt),Xt=this.localClippingEnabled,Gt=Sn.init(this.clippingPlanes,Xt),dt=an.get(Kt,mt.length),dt.init(),mt.push(dt),$n.enabled===!0&&$n.isPresenting===!0){const Wn=yt.xr.getDepthSensingMesh();Wn!==null&&Kn(Wn,vn,-1/0,yt.sortObjects)}Kn(Kt,vn,0,yt.sortObjects),dt.finish(),yt.sortObjects===!0&&dt.sort(Lt,Ot),Tn=$n.enabled===!1||$n.isPresenting===!1||$n.hasDepthSensing()===!1,Tn&&Rn.addToRenderList(dt,Kt),this.info.render.frame++,Gt===!0&&Sn.beginShadows();const In=pt.state.shadowsArray;gn.render(In,Kt,vn),Gt===!0&&Sn.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ln=dt.opaque,Cn=dt.transmissive;if(pt.setupLights(),vn.isArrayCamera){const Wn=vn.cameras;if(Cn.length>0)for(let Qn=0,rr=Wn.length;Qn<rr;Qn++){const zn=Wn[Qn];gr(Ln,Cn,Kt,zn)}Tn&&Rn.render(Kt);for(let Qn=0,rr=Wn.length;Qn<rr;Qn++){const zn=Wn[Qn];br(dt,Kt,zn,zn.viewport)}}else Cn.length>0&&gr(Ln,Cn,Kt,vn),Tn&&Rn.render(Kt),br(dt,Kt,vn);Et!==null&&(tn.updateMultisampleRenderTarget(Et),tn.updateRenderTargetMipmap(Et)),Kt.isScene===!0&&Kt.onAfterRender(yt,Kt,vn),Zn.resetDefaultState(),Mt=-1,Tt=null,vt.pop(),vt.length>0?(pt=vt[vt.length-1],Gt===!0&&Sn.setGlobalState(yt.clippingPlanes,pt.state.camera)):pt=null,mt.pop(),mt.length>0?dt=mt[mt.length-1]:dt=null};function Kn(Kt,vn,In,Ln){if(Kt.visible===!1)return;if(Kt.layers.test(vn.layers)){if(Kt.isGroup)In=Kt.renderOrder;else if(Kt.isLOD)Kt.autoUpdate===!0&&Kt.update(vn);else if(Kt.isLight)pt.pushLight(Kt),Kt.castShadow&&pt.pushShadow(Kt);else if(Kt.isSprite){if(!Kt.frustumCulled||qt.intersectsSprite(Kt)){Ln&&un.setFromMatrixPosition(Kt.matrixWorld).applyMatrix4(Zt);const Qn=mn.update(Kt),rr=Kt.material;rr.visible&&dt.push(Kt,Qn,rr,In,un.z,null)}}else if((Kt.isMesh||Kt.isLine||Kt.isPoints)&&(!Kt.frustumCulled||qt.intersectsObject(Kt))){const Qn=mn.update(Kt),rr=Kt.material;if(Ln&&(Kt.boundingSphere!==void 0?(Kt.boundingSphere===null&&Kt.computeBoundingSphere(),un.copy(Kt.boundingSphere.center)):(Qn.boundingSphere===null&&Qn.computeBoundingSphere(),un.copy(Qn.boundingSphere.center)),un.applyMatrix4(Kt.matrixWorld).applyMatrix4(Zt)),Array.isArray(rr)){const zn=Qn.groups;for(let ar=0,dr=zn.length;ar<dr;ar++){const sr=zn[ar],Mr=rr[sr.materialIndex];Mr&&Mr.visible&&dt.push(Kt,Qn,Mr,In,un.z,sr)}}else rr.visible&&dt.push(Kt,Qn,rr,In,un.z,null)}}const Wn=Kt.children;for(let Qn=0,rr=Wn.length;Qn<rr;Qn++)Kn(Wn[Qn],vn,In,Ln)}function br(Kt,vn,In,Ln){const Cn=Kt.opaque,Wn=Kt.transmissive,Qn=Kt.transparent;pt.setupLightsView(In),Gt===!0&&Sn.setGlobalState(yt.clippingPlanes,In),Ln&&on.viewport(wt.copy(Ln)),Cn.length>0&&Er(Cn,vn,In),Wn.length>0&&Er(Wn,vn,In),Qn.length>0&&Er(Qn,vn,In),on.buffers.depth.setTest(!0),on.buffers.depth.setMask(!0),on.buffers.color.setMask(!0),on.setPolygonOffset(!1)}function gr(Kt,vn,In,Ln){if((In.isScene===!0?In.overrideMaterial:null)!==null)return;pt.state.transmissionRenderTarget[Ln.id]===void 0&&(pt.state.transmissionRenderTarget[Ln.id]=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:ln.has("EXT_color_buffer_half_float")||ln.has("EXT_color_buffer_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:4,stencilBuffer:rt,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ColorManagement.workingColorSpace}));const Wn=pt.state.transmissionRenderTarget[Ln.id],Qn=Ln.viewport||wt;Wn.setSize(Qn.z,Qn.w);const rr=yt.getRenderTarget();yt.setRenderTarget(Wn),yt.getClearColor(It),Dt=yt.getClearAlpha(),Dt<1&&yt.setClearColor(16777215,.5),Tn?Rn.render(In):yt.clear();const zn=yt.toneMapping;yt.toneMapping=NoToneMapping;const ar=Ln.viewport;if(Ln.viewport!==void 0&&(Ln.viewport=void 0),pt.setupLightsView(Ln),Gt===!0&&Sn.setGlobalState(yt.clippingPlanes,Ln),Er(Kt,In,Ln),tn.updateMultisampleRenderTarget(Wn),tn.updateRenderTargetMipmap(Wn),ln.has("WEBGL_multisampled_render_to_texture")===!1){let dr=!1;for(let sr=0,Mr=vn.length;sr<Mr;sr++){const Dr=vn[sr],Ar=Dr.object,Lr=Dr.geometry,or=Dr.material,Yn=Dr.group;if(or.side===DoubleSide&&Ar.layers.test(Ln.layers)){const Ir=or.side;or.side=BackSide,or.needsUpdate=!0,Tr(Ar,In,Ln,Lr,or,Yn),or.side=Ir,or.needsUpdate=!0,dr=!0}}dr===!0&&(tn.updateMultisampleRenderTarget(Wn),tn.updateRenderTargetMipmap(Wn))}yt.setRenderTarget(rr),yt.setClearColor(It,Dt),ar!==void 0&&(Ln.viewport=ar),yt.toneMapping=zn}function Er(Kt,vn,In){const Ln=vn.isScene===!0?vn.overrideMaterial:null;for(let Cn=0,Wn=Kt.length;Cn<Wn;Cn++){const Qn=Kt[Cn],rr=Qn.object,zn=Qn.geometry,ar=Ln===null?Qn.material:Ln,dr=Qn.group;rr.layers.test(In.layers)&&Tr(rr,vn,In,zn,ar,dr)}}function Tr(Kt,vn,In,Ln,Cn,Wn){Kt.onBeforeRender(yt,vn,In,Ln,Cn,Wn),Kt.modelViewMatrix.multiplyMatrices(In.matrixWorldInverse,Kt.matrixWorld),Kt.normalMatrix.getNormalMatrix(Kt.modelViewMatrix),Cn.transparent===!0&&Cn.side===DoubleSide&&Cn.forceSinglePass===!1?(Cn.side=BackSide,Cn.needsUpdate=!0,yt.renderBufferDirect(In,vn,Ln,Cn,Kt,Wn),Cn.side=FrontSide,Cn.needsUpdate=!0,yt.renderBufferDirect(In,vn,Ln,Cn,Kt,Wn),Cn.side=DoubleSide):yt.renderBufferDirect(In,vn,Ln,Cn,Kt,Wn),Kt.onAfterRender(yt,vn,In,Ln,Cn,Wn)}function zr(Kt,vn,In){vn.isScene!==!0&&(vn=wn);const Ln=cn.get(Kt),Cn=pt.state.lights,Wn=pt.state.shadowsArray,Qn=Cn.state.version,rr=sn.getParameters(Kt,Cn.state,Wn,vn,In),zn=sn.getProgramCacheKey(rr);let ar=Ln.programs;Ln.environment=Kt.isMeshStandardMaterial?vn.environment:null,Ln.fog=vn.fog,Ln.envMap=(Kt.isMeshStandardMaterial?Bt:Wt).get(Kt.envMap||Ln.environment),Ln.envMapRotation=Ln.environment!==null&&Kt.envMap===null?vn.environmentRotation:Kt.envMapRotation,ar===void 0&&(Kt.addEventListener("dispose",jn),ar=new Map,Ln.programs=ar);let dr=ar.get(zn);if(dr!==void 0){if(Ln.currentProgram===dr&&Ln.lightsStateVersion===Qn)return Wr(Kt,rr),dr}else rr.uniforms=sn.getUniforms(Kt),Kt.onBeforeCompile(rr,yt),dr=sn.acquireProgram(rr,zn),ar.set(zn,dr),Ln.uniforms=rr.uniforms;const sr=Ln.uniforms;return(!Kt.isShaderMaterial&&!Kt.isRawShaderMaterial||Kt.clipping===!0)&&(sr.clippingPlanes=Sn.uniform),Wr(Kt,rr),Ln.needsLights=$r(Kt),Ln.lightsStateVersion=Qn,Ln.needsLights&&(sr.ambientLightColor.value=Cn.state.ambient,sr.lightProbe.value=Cn.state.probe,sr.directionalLights.value=Cn.state.directional,sr.directionalLightShadows.value=Cn.state.directionalShadow,sr.spotLights.value=Cn.state.spot,sr.spotLightShadows.value=Cn.state.spotShadow,sr.rectAreaLights.value=Cn.state.rectArea,sr.ltc_1.value=Cn.state.rectAreaLTC1,sr.ltc_2.value=Cn.state.rectAreaLTC2,sr.pointLights.value=Cn.state.point,sr.pointLightShadows.value=Cn.state.pointShadow,sr.hemisphereLights.value=Cn.state.hemi,sr.directionalShadowMap.value=Cn.state.directionalShadowMap,sr.directionalShadowMatrix.value=Cn.state.directionalShadowMatrix,sr.spotShadowMap.value=Cn.state.spotShadowMap,sr.spotLightMatrix.value=Cn.state.spotLightMatrix,sr.spotLightMap.value=Cn.state.spotLightMap,sr.pointShadowMap.value=Cn.state.pointShadowMap,sr.pointShadowMatrix.value=Cn.state.pointShadowMatrix),Ln.currentProgram=dr,Ln.uniformsList=null,dr}function wr(Kt){if(Kt.uniformsList===null){const vn=Kt.currentProgram.getUniforms();Kt.uniformsList=WebGLUniforms.seqWithValue(vn.seq,Kt.uniforms)}return Kt.uniformsList}function Wr(Kt,vn){const In=cn.get(Kt);In.outputColorSpace=vn.outputColorSpace,In.batching=vn.batching,In.batchingColor=vn.batchingColor,In.instancing=vn.instancing,In.instancingColor=vn.instancingColor,In.instancingMorph=vn.instancingMorph,In.skinning=vn.skinning,In.morphTargets=vn.morphTargets,In.morphNormals=vn.morphNormals,In.morphColors=vn.morphColors,In.morphTargetsCount=vn.morphTargetsCount,In.numClippingPlanes=vn.numClippingPlanes,In.numIntersection=vn.numClipIntersection,In.vertexAlphas=vn.vertexAlphas,In.vertexTangents=vn.vertexTangents,In.toneMapping=vn.toneMapping}function Ur(Kt,vn,In,Ln,Cn){vn.isScene!==!0&&(vn=wn),tn.resetTextureUnits();const Wn=vn.fog,Qn=Ln.isMeshStandardMaterial?vn.environment:null,rr=Et===null?yt.outputColorSpace:Et.isXRRenderTarget===!0?Et.texture.colorSpace:LinearSRGBColorSpace,zn=(Ln.isMeshStandardMaterial?Bt:Wt).get(Ln.envMap||Qn),ar=Ln.vertexColors===!0&&!!In.attributes.color&&In.attributes.color.itemSize===4,dr=!!In.attributes.tangent&&(!!Ln.normalMap||Ln.anisotropy>0),sr=!!In.morphAttributes.position,Mr=!!In.morphAttributes.normal,Dr=!!In.morphAttributes.color;let Ar=NoToneMapping;Ln.toneMapped&&(Et===null||Et.isXRRenderTarget===!0)&&(Ar=yt.toneMapping);const Lr=In.morphAttributes.position||In.morphAttributes.normal||In.morphAttributes.color,or=Lr!==void 0?Lr.length:0,Yn=cn.get(Ln),Ir=pt.state.lights;if(Gt===!0&&(Xt===!0||Kt!==Tt)){const jr=Kt===Tt&&Ln.id===Mt;Sn.setState(Ln,Kt,jr)}let mr=!1;Ln.version===Yn.__version?(Yn.needsLights&&Yn.lightsStateVersion!==Ir.state.version||Yn.outputColorSpace!==rr||Cn.isBatchedMesh&&Yn.batching===!1||!Cn.isBatchedMesh&&Yn.batching===!0||Cn.isBatchedMesh&&Yn.batchingColor===!0&&Cn.colorTexture===null||Cn.isBatchedMesh&&Yn.batchingColor===!1&&Cn.colorTexture!==null||Cn.isInstancedMesh&&Yn.instancing===!1||!Cn.isInstancedMesh&&Yn.instancing===!0||Cn.isSkinnedMesh&&Yn.skinning===!1||!Cn.isSkinnedMesh&&Yn.skinning===!0||Cn.isInstancedMesh&&Yn.instancingColor===!0&&Cn.instanceColor===null||Cn.isInstancedMesh&&Yn.instancingColor===!1&&Cn.instanceColor!==null||Cn.isInstancedMesh&&Yn.instancingMorph===!0&&Cn.morphTexture===null||Cn.isInstancedMesh&&Yn.instancingMorph===!1&&Cn.morphTexture!==null||Yn.envMap!==zn||Ln.fog===!0&&Yn.fog!==Wn||Yn.numClippingPlanes!==void 0&&(Yn.numClippingPlanes!==Sn.numPlanes||Yn.numIntersection!==Sn.numIntersection)||Yn.vertexAlphas!==ar||Yn.vertexTangents!==dr||Yn.morphTargets!==sr||Yn.morphNormals!==Mr||Yn.morphColors!==Dr||Yn.toneMapping!==Ar||Yn.morphTargetsCount!==or)&&(mr=!0):(mr=!0,Yn.__version=Ln.version);let kr=Yn.currentProgram;mr===!0&&(kr=zr(Ln,vn,Cn));let ss=!1,Fr=!1,Gr=!1;const Cr=kr.getUniforms(),ps=Yn.uniforms;if(on.useProgram(kr.program)&&(ss=!0,Fr=!0,Gr=!0),Ln.id!==Mt&&(Mt=Ln.id,Fr=!0),ss||Tt!==Kt){Cr.setValue(Vt,"projectionMatrix",Kt.projectionMatrix),Cr.setValue(Vt,"viewMatrix",Kt.matrixWorldInverse);const jr=Cr.map.cameraPosition;jr!==void 0&&jr.setValue(Vt,Qt.setFromMatrixPosition(Kt.matrixWorld)),Jt.logarithmicDepthBuffer&&Cr.setValue(Vt,"logDepthBufFC",2/(Math.log(Kt.far+1)/Math.LN2)),(Ln.isMeshPhongMaterial||Ln.isMeshToonMaterial||Ln.isMeshLambertMaterial||Ln.isMeshBasicMaterial||Ln.isMeshStandardMaterial||Ln.isShaderMaterial)&&Cr.setValue(Vt,"isOrthographic",Kt.isOrthographicCamera===!0),Tt!==Kt&&(Tt=Kt,Fr=!0,Gr=!0)}if(Cn.isSkinnedMesh){Cr.setOptional(Vt,Cn,"bindMatrix"),Cr.setOptional(Vt,Cn,"bindMatrixInverse");const jr=Cn.skeleton;jr&&(jr.boneTexture===null&&jr.computeBoneTexture(),Cr.setValue(Vt,"boneTexture",jr.boneTexture,tn))}Cn.isBatchedMesh&&(Cr.setOptional(Vt,Cn,"batchingTexture"),Cr.setValue(Vt,"batchingTexture",Cn._matricesTexture,tn),Cr.setOptional(Vt,Cn,"batchingIdTexture"),Cr.setValue(Vt,"batchingIdTexture",Cn._indirectTexture,tn),Cr.setOptional(Vt,Cn,"batchingColorTexture"),Cn._colorsTexture!==null&&Cr.setValue(Vt,"batchingColorTexture",Cn._colorsTexture,tn));const Ws=In.morphAttributes;if((Ws.position!==void 0||Ws.normal!==void 0||Ws.color!==void 0)&&Mn.update(Cn,In,kr),(Fr||Yn.receiveShadow!==Cn.receiveShadow)&&(Yn.receiveShadow=Cn.receiveShadow,Cr.setValue(Vt,"receiveShadow",Cn.receiveShadow)),Ln.isMeshGouraudMaterial&&Ln.envMap!==null&&(ps.envMap.value=zn,ps.flipEnvMap.value=zn.isCubeTexture&&zn.isRenderTargetTexture===!1?-1:1),Ln.isMeshStandardMaterial&&Ln.envMap===null&&vn.environment!==null&&(ps.envMapIntensity.value=vn.environmentIntensity),Fr&&(Cr.setValue(Vt,"toneMappingExposure",yt.toneMappingExposure),Yn.needsLights&&Qr(ps,Gr),Wn&&Ln.fog===!0&&xn.refreshFogUniforms(ps,Wn),xn.refreshMaterialUniforms(ps,Ln,Yt,$t,pt.state.transmissionRenderTarget[Kt.id]),WebGLUniforms.upload(Vt,wr(Yn),ps,tn)),Ln.isShaderMaterial&&Ln.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Vt,wr(Yn),ps,tn),Ln.uniformsNeedUpdate=!1),Ln.isSpriteMaterial&&Cr.setValue(Vt,"center",Cn.center),Cr.setValue(Vt,"modelViewMatrix",Cn.modelViewMatrix),Cr.setValue(Vt,"normalMatrix",Cn.normalMatrix),Cr.setValue(Vt,"modelMatrix",Cn.matrixWorld),Ln.isShaderMaterial||Ln.isRawShaderMaterial){const jr=Ln.uniformsGroups;for(let as=0,ms=jr.length;as<ms;as++){const Js=jr[as];er.update(Js,kr),er.bind(Js,kr)}}return kr}function Qr(Kt,vn){Kt.ambientLightColor.needsUpdate=vn,Kt.lightProbe.needsUpdate=vn,Kt.directionalLights.needsUpdate=vn,Kt.directionalLightShadows.needsUpdate=vn,Kt.pointLights.needsUpdate=vn,Kt.pointLightShadows.needsUpdate=vn,Kt.spotLights.needsUpdate=vn,Kt.spotLightShadows.needsUpdate=vn,Kt.rectAreaLights.needsUpdate=vn,Kt.hemisphereLights.needsUpdate=vn}function $r(Kt){return Kt.isMeshLambertMaterial||Kt.isMeshToonMaterial||Kt.isMeshPhongMaterial||Kt.isMeshStandardMaterial||Kt.isShadowMaterial||Kt.isShaderMaterial&&Kt.lights===!0}this.getActiveCubeFace=function(){return St},this.getActiveMipmapLevel=function(){return bt},this.getRenderTarget=function(){return Et},this.setRenderTargetTextures=function(Kt,vn,In){cn.get(Kt.texture).__webglTexture=vn,cn.get(Kt.depthTexture).__webglTexture=In;const Ln=cn.get(Kt);Ln.__hasExternalTextures=!0,Ln.__autoAllocateDepthBuffer=In===void 0,Ln.__autoAllocateDepthBuffer||ln.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ln.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Kt,vn){const In=cn.get(Kt);In.__webglFramebuffer=vn,In.__useDefaultFramebuffer=vn===void 0},this.setRenderTarget=function(Kt,vn=0,In=0){Et=Kt,St=vn,bt=In;let Ln=!0,Cn=null,Wn=!1,Qn=!1;if(Kt){const zn=cn.get(Kt);zn.__useDefaultFramebuffer!==void 0?(on.bindFramebuffer(Vt.FRAMEBUFFER,null),Ln=!1):zn.__webglFramebuffer===void 0?tn.setupRenderTarget(Kt):zn.__hasExternalTextures&&tn.rebindTextures(Kt,cn.get(Kt.texture).__webglTexture,cn.get(Kt.depthTexture).__webglTexture);const ar=Kt.texture;(ar.isData3DTexture||ar.isDataArrayTexture||ar.isCompressedArrayTexture)&&(Qn=!0);const dr=cn.get(Kt).__webglFramebuffer;Kt.isWebGLCubeRenderTarget?(Array.isArray(dr[vn])?Cn=dr[vn][In]:Cn=dr[vn],Wn=!0):Kt.samples>0&&tn.useMultisampledRTT(Kt)===!1?Cn=cn.get(Kt).__webglMultisampledFramebuffer:Array.isArray(dr)?Cn=dr[In]:Cn=dr,wt.copy(Kt.viewport),Ct.copy(Kt.scissor),Rt=Kt.scissorTest}else wt.copy(Nt).multiplyScalar(Yt).floor(),Ct.copy(zt).multiplyScalar(Yt).floor(),Rt=Ht;if(on.bindFramebuffer(Vt.FRAMEBUFFER,Cn)&&Ln&&on.drawBuffers(Kt,Cn),on.viewport(wt),on.scissor(Ct),on.setScissorTest(Rt),Wn){const zn=cn.get(Kt.texture);Vt.framebufferTexture2D(Vt.FRAMEBUFFER,Vt.COLOR_ATTACHMENT0,Vt.TEXTURE_CUBE_MAP_POSITIVE_X+vn,zn.__webglTexture,In)}else if(Qn){const zn=cn.get(Kt.texture),ar=vn||0;Vt.framebufferTextureLayer(Vt.FRAMEBUFFER,Vt.COLOR_ATTACHMENT0,zn.__webglTexture,In||0,ar)}Mt=-1},this.readRenderTargetPixels=function(Kt,vn,In,Ln,Cn,Wn,Qn){if(!(Kt&&Kt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let rr=cn.get(Kt).__webglFramebuffer;if(Kt.isWebGLCubeRenderTarget&&Qn!==void 0&&(rr=rr[Qn]),rr){on.bindFramebuffer(Vt.FRAMEBUFFER,rr);try{const zn=Kt.texture,ar=zn.format,dr=zn.type;if(!Jt.textureFormatReadable(ar)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Jt.textureTypeReadable(dr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}vn>=0&&vn<=Kt.width-Ln&&In>=0&&In<=Kt.height-Cn&&Vt.readPixels(vn,In,Ln,Cn,Nn.convert(ar),Nn.convert(dr),Wn)}finally{const zn=Et!==null?cn.get(Et).__webglFramebuffer:null;on.bindFramebuffer(Vt.FRAMEBUFFER,zn)}}},this.readRenderTargetPixelsAsync=async function(Kt,vn,In,Ln,Cn,Wn,Qn){if(!(Kt&&Kt.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let rr=cn.get(Kt).__webglFramebuffer;if(Kt.isWebGLCubeRenderTarget&&Qn!==void 0&&(rr=rr[Qn]),rr){on.bindFramebuffer(Vt.FRAMEBUFFER,rr);try{const zn=Kt.texture,ar=zn.format,dr=zn.type;if(!Jt.textureFormatReadable(ar))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Jt.textureTypeReadable(dr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(vn>=0&&vn<=Kt.width-Ln&&In>=0&&In<=Kt.height-Cn){const sr=Vt.createBuffer();Vt.bindBuffer(Vt.PIXEL_PACK_BUFFER,sr),Vt.bufferData(Vt.PIXEL_PACK_BUFFER,Wn.byteLength,Vt.STREAM_READ),Vt.readPixels(vn,In,Ln,Cn,Nn.convert(ar),Nn.convert(dr),0),Vt.flush();const Mr=Vt.fenceSync(Vt.SYNC_GPU_COMMANDS_COMPLETE,0);await probeAsync(Vt,Mr,4);try{Vt.bindBuffer(Vt.PIXEL_PACK_BUFFER,sr),Vt.getBufferSubData(Vt.PIXEL_PACK_BUFFER,0,Wn)}finally{Vt.deleteBuffer(sr),Vt.deleteSync(Mr)}return Wn}}finally{const zn=Et!==null?cn.get(Et).__webglFramebuffer:null;on.bindFramebuffer(Vt.FRAMEBUFFER,zn)}}},this.copyFramebufferToTexture=function(Kt,vn=null,In=0){Kt.isTexture!==!0&&(console.warn("WebGLRenderer: copyFramebufferToTexture function signature has changed."),vn=arguments[0]||null,Kt=arguments[1]);const Ln=Math.pow(2,-In),Cn=Math.floor(Kt.image.width*Ln),Wn=Math.floor(Kt.image.height*Ln),Qn=vn!==null?vn.x:0,rr=vn!==null?vn.y:0;tn.setTexture2D(Kt,0),Vt.copyTexSubImage2D(Vt.TEXTURE_2D,In,0,0,Qn,rr,Cn,Wn),on.unbindTexture()},this.copyTextureToTexture=function(Kt,vn,In=null,Ln=null,Cn=0){Kt.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture function signature has changed."),Ln=arguments[0]||null,Kt=arguments[1],vn=arguments[2],Cn=arguments[3]||0,In=null);let Wn,Qn,rr,zn,ar,dr;In!==null?(Wn=In.max.x-In.min.x,Qn=In.max.y-In.min.y,rr=In.min.x,zn=In.min.y):(Wn=Kt.image.width,Qn=Kt.image.height,rr=0,zn=0),Ln!==null?(ar=Ln.x,dr=Ln.y):(ar=0,dr=0);const sr=Nn.convert(vn.format),Mr=Nn.convert(vn.type);tn.setTexture2D(vn,0),Vt.pixelStorei(Vt.UNPACK_FLIP_Y_WEBGL,vn.flipY),Vt.pixelStorei(Vt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,vn.premultiplyAlpha),Vt.pixelStorei(Vt.UNPACK_ALIGNMENT,vn.unpackAlignment);const Dr=Vt.getParameter(Vt.UNPACK_ROW_LENGTH),Ar=Vt.getParameter(Vt.UNPACK_IMAGE_HEIGHT),Lr=Vt.getParameter(Vt.UNPACK_SKIP_PIXELS),or=Vt.getParameter(Vt.UNPACK_SKIP_ROWS),Yn=Vt.getParameter(Vt.UNPACK_SKIP_IMAGES),Ir=Kt.isCompressedTexture?Kt.mipmaps[Cn]:Kt.image;Vt.pixelStorei(Vt.UNPACK_ROW_LENGTH,Ir.width),Vt.pixelStorei(Vt.UNPACK_IMAGE_HEIGHT,Ir.height),Vt.pixelStorei(Vt.UNPACK_SKIP_PIXELS,rr),Vt.pixelStorei(Vt.UNPACK_SKIP_ROWS,zn),Kt.isDataTexture?Vt.texSubImage2D(Vt.TEXTURE_2D,Cn,ar,dr,Wn,Qn,sr,Mr,Ir.data):Kt.isCompressedTexture?Vt.compressedTexSubImage2D(Vt.TEXTURE_2D,Cn,ar,dr,Ir.width,Ir.height,sr,Ir.data):Vt.texSubImage2D(Vt.TEXTURE_2D,Cn,ar,dr,Wn,Qn,sr,Mr,Ir),Vt.pixelStorei(Vt.UNPACK_ROW_LENGTH,Dr),Vt.pixelStorei(Vt.UNPACK_IMAGE_HEIGHT,Ar),Vt.pixelStorei(Vt.UNPACK_SKIP_PIXELS,Lr),Vt.pixelStorei(Vt.UNPACK_SKIP_ROWS,or),Vt.pixelStorei(Vt.UNPACK_SKIP_IMAGES,Yn),Cn===0&&vn.generateMipmaps&&Vt.generateMipmap(Vt.TEXTURE_2D),on.unbindTexture()},this.copyTextureToTexture3D=function(Kt,vn,In=null,Ln=null,Cn=0){Kt.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture3D function signature has changed."),In=arguments[0]||null,Ln=arguments[1]||null,Kt=arguments[2],vn=arguments[3],Cn=arguments[4]||0);let Wn,Qn,rr,zn,ar,dr,sr,Mr,Dr;const Ar=Kt.isCompressedTexture?Kt.mipmaps[Cn]:Kt.image;In!==null?(Wn=In.max.x-In.min.x,Qn=In.max.y-In.min.y,rr=In.max.z-In.min.z,zn=In.min.x,ar=In.min.y,dr=In.min.z):(Wn=Ar.width,Qn=Ar.height,rr=Ar.depth,zn=0,ar=0,dr=0),Ln!==null?(sr=Ln.x,Mr=Ln.y,Dr=Ln.z):(sr=0,Mr=0,Dr=0);const Lr=Nn.convert(vn.format),or=Nn.convert(vn.type);let Yn;if(vn.isData3DTexture)tn.setTexture3D(vn,0),Yn=Vt.TEXTURE_3D;else if(vn.isDataArrayTexture||vn.isCompressedArrayTexture)tn.setTexture2DArray(vn,0),Yn=Vt.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Vt.pixelStorei(Vt.UNPACK_FLIP_Y_WEBGL,vn.flipY),Vt.pixelStorei(Vt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,vn.premultiplyAlpha),Vt.pixelStorei(Vt.UNPACK_ALIGNMENT,vn.unpackAlignment);const Ir=Vt.getParameter(Vt.UNPACK_ROW_LENGTH),mr=Vt.getParameter(Vt.UNPACK_IMAGE_HEIGHT),kr=Vt.getParameter(Vt.UNPACK_SKIP_PIXELS),ss=Vt.getParameter(Vt.UNPACK_SKIP_ROWS),Fr=Vt.getParameter(Vt.UNPACK_SKIP_IMAGES);Vt.pixelStorei(Vt.UNPACK_ROW_LENGTH,Ar.width),Vt.pixelStorei(Vt.UNPACK_IMAGE_HEIGHT,Ar.height),Vt.pixelStorei(Vt.UNPACK_SKIP_PIXELS,zn),Vt.pixelStorei(Vt.UNPACK_SKIP_ROWS,ar),Vt.pixelStorei(Vt.UNPACK_SKIP_IMAGES,dr),Kt.isDataTexture||Kt.isData3DTexture?Vt.texSubImage3D(Yn,Cn,sr,Mr,Dr,Wn,Qn,rr,Lr,or,Ar.data):vn.isCompressedArrayTexture?Vt.compressedTexSubImage3D(Yn,Cn,sr,Mr,Dr,Wn,Qn,rr,Lr,Ar.data):Vt.texSubImage3D(Yn,Cn,sr,Mr,Dr,Wn,Qn,rr,Lr,or,Ar),Vt.pixelStorei(Vt.UNPACK_ROW_LENGTH,Ir),Vt.pixelStorei(Vt.UNPACK_IMAGE_HEIGHT,mr),Vt.pixelStorei(Vt.UNPACK_SKIP_PIXELS,kr),Vt.pixelStorei(Vt.UNPACK_SKIP_ROWS,ss),Vt.pixelStorei(Vt.UNPACK_SKIP_IMAGES,Fr),Cn===0&&vn.generateMipmaps&&Vt.generateMipmap(Yn),on.unbindTexture()},this.initRenderTarget=function(Kt){cn.get(Kt).__webglFramebuffer===void 0&&tn.setupRenderTarget(Kt)},this.initTexture=function(Kt){Kt.isCubeTexture?tn.setTextureCube(Kt,0):Kt.isData3DTexture?tn.setTexture3D(Kt,0):Kt.isDataArrayTexture||Kt.isCompressedArrayTexture?tn.setTexture2DArray(Kt,0):tn.setTexture2D(Kt,0),on.unbindTexture()},this.resetState=function(){St=0,bt=0,Et=null,on.reset(),Zn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(_){this._outputColorSpace=_;const _e=this.getContext();_e.drawingBufferColorSpace=_===DisplayP3ColorSpace?"display-p3":"srgb",_e.unpackColorSpace=ColorManagement.workingColorSpace===LinearDisplayP3ColorSpace?"display-p3":"srgb"}}class FogExp2{constructor(_,_e=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color$1(_),this.density=_e}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(_,_e=1,tt=1e3){this.isFog=!0,this.name="",this.color=new Color$1(_),this.near=_e,this.far=tt}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler,this.environmentIntensity=1,this.environmentRotation=new Euler,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_,_e){return super.copy(_,_e),_.background!==null&&(this.background=_.background.clone()),_.environment!==null&&(this.environment=_.environment.clone()),_.fog!==null&&(this.fog=_.fog.clone()),this.backgroundBlurriness=_.backgroundBlurriness,this.backgroundIntensity=_.backgroundIntensity,this.backgroundRotation.copy(_.backgroundRotation),this.environmentIntensity=_.environmentIntensity,this.environmentRotation.copy(_.environmentRotation),_.overrideMaterial!==null&&(this.overrideMaterial=_.overrideMaterial.clone()),this.matrixAutoUpdate=_.matrixAutoUpdate,this}toJSON(_){const _e=super.toJSON(_);return this.fog!==null&&(_e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(_e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(_e.object.backgroundIntensity=this.backgroundIntensity),_e.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(_e.object.environmentIntensity=this.environmentIntensity),_e.object.environmentRotation=this.environmentRotation.toArray(),_e}}class InterleavedBuffer{constructor(_,_e){this.isInterleavedBuffer=!0,this.array=_,this.stride=_e,this.count=_!==void 0?_.length/_e:0,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=generateUUID$1()}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,_e){this.updateRanges.push({start:_,count:_e})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.array=new _.array.constructor(_.array),this.count=_.count,this.stride=_.stride,this.usage=_.usage,this}copyAt(_,_e,tt){_*=this.stride,tt*=_e.stride;for(let nt=0,rt=this.stride;nt<rt;nt++)this.array[_+nt]=_e.array[tt+nt];return this}set(_,_e=0){return this.array.set(_,_e),this}clone(_){_.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const _e=new this.array.constructor(_.arrayBuffers[this.array.buffer._uuid]),tt=new this.constructor(_e,this.stride);return tt.setUsage(this.usage),tt}onUpload(_){return this.onUploadCallback=_,this}toJSON(_){return _.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(_,_e,tt,nt=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_,this.itemSize=_e,this.offset=tt,this.normalized=nt}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_){this.data.needsUpdate=_}applyMatrix4(_){for(let _e=0,tt=this.data.count;_e<tt;_e++)_vector$6.fromBufferAttribute(this,_e),_vector$6.applyMatrix4(_),this.setXYZ(_e,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(_){for(let _e=0,tt=this.count;_e<tt;_e++)_vector$6.fromBufferAttribute(this,_e),_vector$6.applyNormalMatrix(_),this.setXYZ(_e,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(_){for(let _e=0,tt=this.count;_e<tt;_e++)_vector$6.fromBufferAttribute(this,_e),_vector$6.transformDirection(_),this.setXYZ(_e,_vector$6.x,_vector$6.y,_vector$6.z);return this}getComponent(_,_e){let tt=this.array[_*this.data.stride+this.offset+_e];return this.normalized&&(tt=denormalize(tt,this.array)),tt}setComponent(_,_e,tt){return this.normalized&&(tt=normalize$1(tt,this.array)),this.data.array[_*this.data.stride+this.offset+_e]=tt,this}setX(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.data.array[_*this.data.stride+this.offset]=_e,this}setY(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.data.array[_*this.data.stride+this.offset+1]=_e,this}setZ(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.data.array[_*this.data.stride+this.offset+2]=_e,this}setW(_,_e){return this.normalized&&(_e=normalize$1(_e,this.array)),this.data.array[_*this.data.stride+this.offset+3]=_e,this}getX(_){let _e=this.data.array[_*this.data.stride+this.offset];return this.normalized&&(_e=denormalize(_e,this.array)),_e}getY(_){let _e=this.data.array[_*this.data.stride+this.offset+1];return this.normalized&&(_e=denormalize(_e,this.array)),_e}getZ(_){let _e=this.data.array[_*this.data.stride+this.offset+2];return this.normalized&&(_e=denormalize(_e,this.array)),_e}getW(_){let _e=this.data.array[_*this.data.stride+this.offset+3];return this.normalized&&(_e=denormalize(_e,this.array)),_e}setXY(_,_e,tt){return _=_*this.data.stride+this.offset,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array)),this.data.array[_+0]=_e,this.data.array[_+1]=tt,this}setXYZ(_,_e,tt,nt){return _=_*this.data.stride+this.offset,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array),nt=normalize$1(nt,this.array)),this.data.array[_+0]=_e,this.data.array[_+1]=tt,this.data.array[_+2]=nt,this}setXYZW(_,_e,tt,nt,rt){return _=_*this.data.stride+this.offset,this.normalized&&(_e=normalize$1(_e,this.array),tt=normalize$1(tt,this.array),nt=normalize$1(nt,this.array),rt=normalize$1(rt,this.array)),this.data.array[_+0]=_e,this.data.array[_+1]=tt,this.data.array[_+2]=nt,this.data.array[_+3]=rt,this}clone(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const _e=[];for(let tt=0;tt<this.count;tt++){const nt=tt*this.data.stride+this.offset;for(let rt=0;rt<this.itemSize;rt++)_e.push(this.data.array[nt+rt])}return new BufferAttribute(new this.array.constructor(_e),this.itemSize,this.normalized)}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.clone(_)),new InterleavedBufferAttribute(_.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const _e=[];for(let tt=0;tt<this.count;tt++){const nt=tt*this.data.stride+this.offset;for(let rt=0;rt<this.itemSize;rt++)_e.push(this.data.array[nt+rt])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:_e,normalized:this.normalized}}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.toJSON(_)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.rotation=_.rotation,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA$2=new Vector3,_vB$2=new Vector3,_vC$2=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;let Sprite$1=class extends Object3D{constructor(_=new SpriteMaterial){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const _e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),tt=new InterleavedBuffer(_e,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(tt,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(tt,2,3,!1))}this.geometry=_geometry,this.material=_,this.center=new Vector2(.5,.5)}raycast(_,_e){_.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const tt=this.material.rotation;let nt,rt;tt!==0&&(rt=Math.cos(tt),nt=Math.sin(tt));const it=this.center;transformVertex(_vA$2.set(-.5,-.5,0),_mvPosition,it,_worldScale,nt,rt),transformVertex(_vB$2.set(.5,-.5,0),_mvPosition,it,_worldScale,nt,rt),transformVertex(_vC$2.set(.5,.5,0),_mvPosition,it,_worldScale,nt,rt),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let st=_.ray.intersectTriangle(_vA$2,_vB$2,_vC$2,!1,_intersectPoint);if(st===null&&(transformVertex(_vB$2.set(-.5,.5,0),_mvPosition,it,_worldScale,nt,rt),_uvB.set(0,1),st=_.ray.intersectTriangle(_vA$2,_vC$2,_vB$2,!1,_intersectPoint),st===null))return;const ot=_.ray.origin.distanceTo(_intersectPoint);ot<_.near||ot>_.far||_e.push({distance:ot,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA$2,_vB$2,_vC$2,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(_,_e){return super.copy(_,_e),_.center!==void 0&&this.center.copy(_.center),this.material=_.material,this}};function transformVertex(et,_,_e,tt,nt,rt){_alignedPosition.subVectors(et,_e).addScalar(.5).multiply(tt),nt!==void 0?(_rotatedPosition.x=rt*_alignedPosition.x-nt*_alignedPosition.y,_rotatedPosition.y=nt*_alignedPosition.x+rt*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),et.copy(_),et.x+=_rotatedPosition.x,et.y+=_rotatedPosition.y,et.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_){super.copy(_,!1);const _e=_.levels;for(let tt=0,nt=_e.length;tt<nt;tt++){const rt=_e[tt];this.addLevel(rt.object.clone(),rt.distance,rt.hysteresis)}return this.autoUpdate=_.autoUpdate,this}addLevel(_,_e=0,tt=0){_e=Math.abs(_e);const nt=this.levels;let rt;for(rt=0;rt<nt.length&&!(_e<nt[rt].distance);rt++);return nt.splice(rt,0,{distance:_e,hysteresis:tt,object:_}),this.add(_),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_){const _e=this.levels;if(_e.length>0){let tt,nt;for(tt=1,nt=_e.length;tt<nt;tt++){let rt=_e[tt].distance;if(_e[tt].object.visible&&(rt-=rt*_e[tt].hysteresis),_<rt)break}return _e[tt-1].object}return null}raycast(_,_e){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const nt=_.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(nt).raycast(_,_e)}}update(_){const _e=this.levels;if(_e.length>1){_v1$2.setFromMatrixPosition(_.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const tt=_v1$2.distanceTo(_v2$1)/_.zoom;_e[0].object.visible=!0;let nt,rt;for(nt=1,rt=_e.length;nt<rt;nt++){let it=_e[nt].distance;if(_e[nt].object.visible&&(it-=it*_e[nt].hysteresis),tt>=it)_e[nt-1].object.visible=!1,_e[nt].object.visible=!0;else break}for(this._currentLevel=nt-1;nt<rt;nt++)_e[nt].object.visible=!1}}toJSON(_){const _e=super.toJSON(_);this.autoUpdate===!1&&(_e.object.autoUpdate=!1),_e.object.levels=[];const tt=this.levels;for(let nt=0,rt=tt.length;nt<rt;nt++){const it=tt[nt];_e.object.levels.push({object:it.object.uuid,distance:it.distance,hysteresis:it.hysteresis})}return _e}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(_,_e){super(_,_e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const _e=_.getAttribute("position");for(let tt=0;tt<_e.count;tt++)this.getVertexPosition(tt,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const _e=_.getAttribute("position");for(let tt=0;tt<_e.count;tt++)this.getVertexPosition(tt,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_,_e){return super.copy(_,_e),this.bindMode=_.bindMode,this.bindMatrix.copy(_.bindMatrix),this.bindMatrixInverse.copy(_.bindMatrixInverse),this.skeleton=_.skeleton,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}raycast(_,_e){const tt=this.material,nt=this.matrixWorld;tt!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(nt),_.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(nt).invert(),_ray$2.copy(_.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_,_e,_ray$2)))}getVertexPosition(_,_e){return super.getVertexPosition(_,_e),this.applyBoneTransform(_,_e),_e}bind(_,_e){this.skeleton=_,_e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),_e=this.matrixWorld),this.bindMatrix.copy(_e),this.bindMatrixInverse.copy(_e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _=new Vector4,_e=this.geometry.attributes.skinWeight;for(let tt=0,nt=_e.count;tt<nt;tt++){_.fromBufferAttribute(_e,tt);const rt=1/_.manhattanLength();rt!==1/0?_.multiplyScalar(rt):_.set(1,0,0,0),_e.setXYZW(tt,_.x,_.y,_.z,_.w)}}updateMatrixWorld(_){super.updateMatrixWorld(_),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_,_e){const tt=this.skeleton,nt=this.geometry;_skinIndex.fromBufferAttribute(nt.attributes.skinIndex,_),_skinWeight.fromBufferAttribute(nt.attributes.skinWeight,_),_basePosition.copy(_e).applyMatrix4(this.bindMatrix),_e.set(0,0,0);for(let rt=0;rt<4;rt++){const it=_skinWeight.getComponent(rt);if(it!==0){const st=_skinIndex.getComponent(rt);_matrix4.multiplyMatrices(tt.bones[st].matrixWorld,tt.boneInverses[st]),_e.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),it)}}return _e.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture$1{constructor(_=null,_e=1,tt=1,nt,rt,it,st,ot,at=NearestFilter,lt=NearestFilter,ct,ht){super(null,it,st,ot,at,lt,nt,rt,ct,ht),this.isDataTexture=!0,this.image={data:_,width:_e,height:tt},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(_=[],_e=[]){this.uuid=generateUUID$1(),this.bones=_.slice(0),this.boneInverses=_e,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const _=this.bones,_e=this.boneInverses;if(this.boneMatrices=new Float32Array(_.length*16),_e.length===0)this.calculateInverses();else if(_.length!==_e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let tt=0,nt=this.bones.length;tt<nt;tt++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _=0,_e=this.bones.length;_<_e;_++){const tt=new Matrix4;this.bones[_]&&tt.copy(this.bones[_].matrixWorld).invert(),this.boneInverses.push(tt)}}pose(){for(let _=0,_e=this.bones.length;_<_e;_++){const tt=this.bones[_];tt&&tt.matrixWorld.copy(this.boneInverses[_]).invert()}for(let _=0,_e=this.bones.length;_<_e;_++){const tt=this.bones[_];tt&&(tt.parent&&tt.parent.isBone?(tt.matrix.copy(tt.parent.matrixWorld).invert(),tt.matrix.multiply(tt.matrixWorld)):tt.matrix.copy(tt.matrixWorld),tt.matrix.decompose(tt.position,tt.quaternion,tt.scale))}}update(){const _=this.bones,_e=this.boneInverses,tt=this.boneMatrices,nt=this.boneTexture;for(let rt=0,it=_.length;rt<it;rt++){const st=_[rt]?_[rt].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(st,_e[rt]),_offsetMatrix.toArray(tt,rt*16)}nt!==null&&(nt.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _=Math.sqrt(this.bones.length*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const _e=new Float32Array(_*_*4);_e.set(this.boneMatrices);const tt=new DataTexture(_e,_,_,RGBAFormat,FloatType);return tt.needsUpdate=!0,this.boneMatrices=_e,this.boneTexture=tt,this}getBoneByName(_){for(let _e=0,tt=this.bones.length;_e<tt;_e++){const nt=this.bones[_e];if(nt.name===_)return nt}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_,_e){this.uuid=_.uuid;for(let tt=0,nt=_.bones.length;tt<nt;tt++){const rt=_.bones[tt];let it=_e[rt];it===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",rt),it=new Bone),this.bones.push(it),this.boneInverses.push(new Matrix4().fromArray(_.boneInverses[tt]))}return this.init(),this}toJSON(){const _={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_.uuid=this.uuid;const _e=this.bones,tt=this.boneInverses;for(let nt=0,rt=_e.length;nt<rt;nt++){const it=_e[nt];_.bones.push(it.uuid);const st=tt[nt];_.boneInverses.push(st.toArray())}return _}}class InstancedBufferAttribute extends BufferAttribute{constructor(_,_e,tt,nt=1){super(_,_e,tt),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=nt}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}toJSON(){const _=super.toJSON();return _.meshPerAttribute=this.meshPerAttribute,_.isInstancedBufferAttribute=!0,_}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh$1=new Mesh,_sphere$3=new Sphere;class InstancedMesh extends Mesh{constructor(_,_e,tt){super(_,_e),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(tt*16),16),this.instanceColor=null,this.morphTexture=null,this.count=tt,this.boundingBox=null,this.boundingSphere=null;for(let nt=0;nt<tt;nt++)this.setMatrixAt(nt,_identity)}computeBoundingBox(){const _=this.geometry,_e=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_.boundingBox===null&&_.computeBoundingBox(),this.boundingBox.makeEmpty();for(let tt=0;tt<_e;tt++)this.getMatrixAt(tt,_instanceLocalMatrix),_box3.copy(_.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const _=this.geometry,_e=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),_.boundingSphere===null&&_.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let tt=0;tt<_e;tt++)this.getMatrixAt(tt,_instanceLocalMatrix),_sphere$3.copy(_.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$3)}copy(_,_e){return super.copy(_,_e),this.instanceMatrix.copy(_.instanceMatrix),_.morphTexture!==null&&(this.morphTexture=_.morphTexture.clone()),_.instanceColor!==null&&(this.instanceColor=_.instanceColor.clone()),this.count=_.count,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}getColorAt(_,_e){_e.fromArray(this.instanceColor.array,_*3)}getMatrixAt(_,_e){_e.fromArray(this.instanceMatrix.array,_*16)}getMorphAt(_,_e){const tt=_e.morphTargetInfluences,nt=this.morphTexture.source.data.data,rt=tt.length+1,it=_*rt+1;for(let st=0;st<tt.length;st++)tt[st]=nt[it+st]}raycast(_,_e){const tt=this.matrixWorld,nt=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(tt),_.ray.intersectsSphere(_sphere$3)!==!1))for(let rt=0;rt<nt;rt++){this.getMatrixAt(rt,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(tt,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,_mesh$1.raycast(_,_instanceIntersects);for(let it=0,st=_instanceIntersects.length;it<st;it++){const ot=_instanceIntersects[it];ot.instanceId=rt,ot.object=this,_e.push(ot)}_instanceIntersects.length=0}}setColorAt(_,_e){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),_e.toArray(this.instanceColor.array,_*3)}setMatrixAt(_,_e){_e.toArray(this.instanceMatrix.array,_*16)}setMorphAt(_,_e){const tt=_e.morphTargetInfluences,nt=tt.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(nt*this.count),nt,this.count,RedFormat,FloatType));const rt=this.morphTexture.source.data.data;let it=0;for(let at=0;at<tt.length;at++)it+=tt[at];const st=this.geometry.morphTargetsRelative?1:1-it,ot=nt*_;rt[ot]=st,rt.set(tt,ot+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function sortOpaque(et,_){return et.z-_.z}function sortTransparent(et,_){return _.z-et.z}class MultiDrawRenderList{constructor(){this.index=0,this.pool=[],this.list=[]}push(_,_e,tt){const nt=this.pool,rt=this.list;this.index>=nt.length&&nt.push({start:-1,count:-1,z:-1,index:-1});const it=nt[this.index];rt.push(it),this.index++,it.start=_.start,it.count=_.count,it.z=_e,it.index=tt}reset(){this.list.length=0,this.index=0}}const _matrix$1=new Matrix4,_invMatrixWorld=new Matrix4,_identityMatrix=new Matrix4,_whiteColor=new Color$1(1,1,1),_projScreenMatrix$2=new Matrix4,_frustum=new Frustum,_box$1=new Box3,_sphere$2=new Sphere,_vector$5=new Vector3,_forward=new Vector3,_temp=new Vector3,_renderList=new MultiDrawRenderList,_mesh=new Mesh,_batchIntersects=[];function copyAttributeData(et,_,_e=0){const tt=_.itemSize;if(et.isInterleavedBufferAttribute||et.array.constructor!==_.array.constructor){const nt=et.count;for(let rt=0;rt<nt;rt++)for(let it=0;it<tt;it++)_.setComponent(rt+_e,it,et.getComponent(rt,it))}else _.array.set(et.array,_e*tt);_.needsUpdate=!0}class BatchedMesh extends Mesh{get maxInstanceCount(){return this._maxInstanceCount}constructor(_,_e,tt=_e*2,nt){super(new BufferGeometry,nt),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=_,this._maxVertexCount=_e,this._maxIndexCount=tt,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(_),this._multiDrawStarts=new Int32Array(_),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let _=Math.sqrt(this._maxInstanceCount*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const _e=new Float32Array(_*_*4),tt=new DataTexture(_e,_,_,RGBAFormat,FloatType);this._matricesTexture=tt}_initIndirectTexture(){let _=Math.sqrt(this._maxInstanceCount);_=Math.ceil(_);const _e=new Uint32Array(_*_),tt=new DataTexture(_e,_,_,RedIntegerFormat,UnsignedIntType);this._indirectTexture=tt}_initColorsTexture(){let _=Math.sqrt(this._maxIndexCount);_=Math.ceil(_);const _e=new Float32Array(_*_*4).fill(1),tt=new DataTexture(_e,_,_,RGBAFormat,FloatType);tt.colorSpace=ColorManagement.workingColorSpace,this._colorsTexture=tt}_initializeGeometry(_){const _e=this.geometry,tt=this._maxVertexCount,nt=this._maxIndexCount;if(this._geometryInitialized===!1){for(const rt in _.attributes){const it=_.getAttribute(rt),{array:st,itemSize:ot,normalized:at}=it,lt=new st.constructor(tt*ot),ct=new BufferAttribute(lt,ot,at);_e.setAttribute(rt,ct)}if(_.getIndex()!==null){const rt=tt>65535?new Uint32Array(nt):new Uint16Array(nt);_e.setIndex(new BufferAttribute(rt,1))}this._geometryInitialized=!0}}_validateGeometry(_){const _e=this.geometry;if(!!_.getIndex()!=!!_e.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const tt in _e.attributes){if(!_.hasAttribute(tt))throw new Error(`BatchedMesh: Added geometry missing "${tt}". All geometries must have consistent attributes.`);const nt=_.getAttribute(tt),rt=_e.getAttribute(tt);if(nt.itemSize!==rt.itemSize||nt.normalized!==rt.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(_){return this.customSort=_,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this._geometryCount,_e=this.boundingBox,tt=this._drawInfo;_e.makeEmpty();for(let nt=0;nt<_;nt++){if(tt[nt].active===!1)continue;const rt=tt[nt].geometryIndex;this.getMatrixAt(nt,_matrix$1),this.getBoundingBoxAt(rt,_box$1).applyMatrix4(_matrix$1),_e.union(_box$1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _=this.boundingSphere,_e=this._drawInfo;_.makeEmpty();for(let tt=0,nt=_e.length;tt<nt;tt++){if(_e[tt].active===!1)continue;const rt=_e[tt].geometryIndex;this.getMatrixAt(tt,_matrix$1),this.getBoundingSphereAt(rt,_sphere$2).applyMatrix4(_matrix$1),_.union(_sphere$2)}}addInstance(_){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:_});const _e=this._drawInfo.length-1,tt=this._matricesTexture,nt=tt.image.data;_identityMatrix.toArray(nt,_e*16),tt.needsUpdate=!0;const rt=this._colorsTexture;return rt&&(_whiteColor.toArray(rt.image.data,_e*4),rt.needsUpdate=!0),_e}addGeometry(_,_e=-1,tt=-1){if(this._initializeGeometry(_),this._validateGeometry(_),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const nt={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let rt=null;const it=this._reservedRanges,st=this._drawRanges,ot=this._bounds;this._geometryCount!==0&&(rt=it[it.length-1]),_e===-1?nt.vertexCount=_.getAttribute("position").count:nt.vertexCount=_e,rt===null?nt.vertexStart=0:nt.vertexStart=rt.vertexStart+rt.vertexCount;const at=_.getIndex(),lt=at!==null;if(lt&&(tt===-1?nt.indexCount=at.count:nt.indexCount=tt,rt===null?nt.indexStart=0:nt.indexStart=rt.indexStart+rt.indexCount),nt.indexStart!==-1&&nt.indexStart+nt.indexCount>this._maxIndexCount||nt.vertexStart+nt.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const ct=this._geometryCount;return this._geometryCount++,it.push(nt),st.push({start:lt?nt.indexStart:nt.vertexStart,count:-1}),ot.push({boxInitialized:!1,box:new Box3,sphereInitialized:!1,sphere:new Sphere}),this.setGeometryAt(ct,_),ct}setGeometryAt(_,_e){if(_>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(_e);const tt=this.geometry,nt=tt.getIndex()!==null,rt=tt.getIndex(),it=_e.getIndex(),st=this._reservedRanges[_];if(nt&&it.count>st.indexCount||_e.attributes.position.count>st.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const ot=st.vertexStart,at=st.vertexCount;for(const ut in tt.attributes){const ft=_e.getAttribute(ut),dt=tt.getAttribute(ut);copyAttributeData(ft,dt,ot);const pt=ft.itemSize;for(let mt=ft.count,vt=at;mt<vt;mt++){const yt=ot+mt;for(let _t=0;_t<pt;_t++)dt.setComponent(yt,_t,0)}dt.needsUpdate=!0,dt.addUpdateRange(ot*pt,at*pt)}if(nt){const ut=st.indexStart;for(let ft=0;ft<it.count;ft++)rt.setX(ut+ft,ot+it.getX(ft));for(let ft=it.count,dt=st.indexCount;ft<dt;ft++)rt.setX(ut+ft,ot);rt.needsUpdate=!0,rt.addUpdateRange(ut,st.indexCount)}const lt=this._bounds[_];_e.boundingBox!==null?(lt.box.copy(_e.boundingBox),lt.boxInitialized=!0):lt.boxInitialized=!1,_e.boundingSphere!==null?(lt.sphere.copy(_e.boundingSphere),lt.sphereInitialized=!0):lt.sphereInitialized=!1;const ct=this._drawRanges[_],ht=_e.getAttribute("position");return ct.count=nt?it.count:ht.count,this._visibilityChanged=!0,_}getBoundingBoxAt(_,_e){if(_>=this._geometryCount)return null;const tt=this._bounds[_],nt=tt.box,rt=this.geometry;if(tt.boxInitialized===!1){nt.makeEmpty();const it=rt.index,st=rt.attributes.position,ot=this._drawRanges[_];for(let at=ot.start,lt=ot.start+ot.count;at<lt;at++){let ct=at;it&&(ct=it.getX(ct)),nt.expandByPoint(_vector$5.fromBufferAttribute(st,ct))}tt.boxInitialized=!0}return _e.copy(nt),_e}getBoundingSphereAt(_,_e){if(_>=this._geometryCount)return null;const tt=this._bounds[_],nt=tt.sphere,rt=this.geometry;if(tt.sphereInitialized===!1){nt.makeEmpty(),this.getBoundingBoxAt(_,_box$1),_box$1.getCenter(nt.center);const it=rt.index,st=rt.attributes.position,ot=this._drawRanges[_];let at=0;for(let lt=ot.start,ct=ot.start+ot.count;lt<ct;lt++){let ht=lt;it&&(ht=it.getX(ht)),_vector$5.fromBufferAttribute(st,ht),at=Math.max(at,nt.center.distanceToSquared(_vector$5))}nt.radius=Math.sqrt(at),tt.sphereInitialized=!0}return _e.copy(nt),_e}setMatrixAt(_,_e){const tt=this._drawInfo,nt=this._matricesTexture,rt=this._matricesTexture.image.data;return _>=tt.length||tt[_].active===!1?this:(_e.toArray(rt,_*16),nt.needsUpdate=!0,this)}getMatrixAt(_,_e){const tt=this._drawInfo,nt=this._matricesTexture.image.data;return _>=tt.length||tt[_].active===!1?null:_e.fromArray(nt,_*16)}setColorAt(_,_e){this._colorsTexture===null&&this._initColorsTexture();const tt=this._colorsTexture,nt=this._colorsTexture.image.data,rt=this._drawInfo;return _>=rt.length||rt[_].active===!1?this:(_e.toArray(nt,_*4),tt.needsUpdate=!0,this)}getColorAt(_,_e){const tt=this._colorsTexture.image.data,nt=this._drawInfo;return _>=nt.length||nt[_].active===!1?null:_e.fromArray(tt,_*4)}setVisibleAt(_,_e){const tt=this._drawInfo;return _>=tt.length||tt[_].active===!1||tt[_].visible===_e?this:(tt[_].visible=_e,this._visibilityChanged=!0,this)}getVisibleAt(_){const _e=this._drawInfo;return _>=_e.length||_e[_].active===!1?!1:_e[_].visible}raycast(_,_e){const tt=this._drawInfo,nt=this._drawRanges,rt=this.matrixWorld,it=this.geometry;_mesh.material=this.material,_mesh.geometry.index=it.index,_mesh.geometry.attributes=it.attributes,_mesh.geometry.boundingBox===null&&(_mesh.geometry.boundingBox=new Box3),_mesh.geometry.boundingSphere===null&&(_mesh.geometry.boundingSphere=new Sphere);for(let st=0,ot=tt.length;st<ot;st++){if(!tt[st].visible||!tt[st].active)continue;const at=tt[st].geometryIndex,lt=nt[at];_mesh.geometry.setDrawRange(lt.start,lt.count),this.getMatrixAt(st,_mesh.matrixWorld).premultiply(rt),this.getBoundingBoxAt(at,_mesh.geometry.boundingBox),this.getBoundingSphereAt(at,_mesh.geometry.boundingSphere),_mesh.raycast(_,_batchIntersects);for(let ct=0,ht=_batchIntersects.length;ct<ht;ct++){const ut=_batchIntersects[ct];ut.object=this,ut.batchId=st,_e.push(ut)}_batchIntersects.length=0}_mesh.material=null,_mesh.geometry.index=null,_mesh.geometry.attributes={},_mesh.geometry.setDrawRange(0,1/0)}copy(_){return super.copy(_),this.geometry=_.geometry.clone(),this.perObjectFrustumCulled=_.perObjectFrustumCulled,this.sortObjects=_.sortObjects,this.boundingBox=_.boundingBox!==null?_.boundingBox.clone():null,this.boundingSphere=_.boundingSphere!==null?_.boundingSphere.clone():null,this._drawRanges=_._drawRanges.map(_e=>({..._e})),this._reservedRanges=_._reservedRanges.map(_e=>({..._e})),this._drawInfo=_._drawInfo.map(_e=>({..._e})),this._bounds=_._bounds.map(_e=>({boxInitialized:_e.boxInitialized,box:_e.box.clone(),sphereInitialized:_e.sphereInitialized,sphere:_e.sphere.clone()})),this._maxInstanceCount=_._maxInstanceCount,this._maxVertexCount=_._maxVertexCount,this._maxIndexCount=_._maxIndexCount,this._geometryInitialized=_._geometryInitialized,this._geometryCount=_._geometryCount,this._multiDrawCounts=_._multiDrawCounts.slice(),this._multiDrawStarts=_._multiDrawStarts.slice(),this._matricesTexture=_._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this._colorsTexture!==null&&(this._colorsTexture=_._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(_,_e,tt,nt,rt){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const it=nt.getIndex(),st=it===null?1:it.array.BYTES_PER_ELEMENT,ot=this._drawInfo,at=this._multiDrawStarts,lt=this._multiDrawCounts,ct=this._drawRanges,ht=this.perObjectFrustumCulled,ut=this._indirectTexture,ft=ut.image.data;ht&&(_projScreenMatrix$2.multiplyMatrices(tt.projectionMatrix,tt.matrixWorldInverse).multiply(this.matrixWorld),_frustum.setFromProjectionMatrix(_projScreenMatrix$2,_.coordinateSystem));let dt=0;if(this.sortObjects){_invMatrixWorld.copy(this.matrixWorld).invert(),_vector$5.setFromMatrixPosition(tt.matrixWorld).applyMatrix4(_invMatrixWorld),_forward.set(0,0,-1).transformDirection(tt.matrixWorld).transformDirection(_invMatrixWorld);for(let vt=0,yt=ot.length;vt<yt;vt++)if(ot[vt].visible&&ot[vt].active){const _t=ot[vt].geometryIndex;this.getMatrixAt(vt,_matrix$1),this.getBoundingSphereAt(_t,_sphere$2).applyMatrix4(_matrix$1);let St=!1;if(ht&&(St=!_frustum.intersectsSphere(_sphere$2)),!St){const bt=_temp.subVectors(_sphere$2.center,_vector$5).dot(_forward);_renderList.push(ct[_t],bt,vt)}}const pt=_renderList.list,mt=this.customSort;mt===null?pt.sort(rt.transparent?sortTransparent:sortOpaque):mt.call(this,pt,tt);for(let vt=0,yt=pt.length;vt<yt;vt++){const _t=pt[vt];at[dt]=_t.start*st,lt[dt]=_t.count,ft[dt]=_t.index,dt++}_renderList.reset()}else for(let pt=0,mt=ot.length;pt<mt;pt++)if(ot[pt].visible&&ot[pt].active){const vt=ot[pt].geometryIndex;let yt=!1;if(ht&&(this.getMatrixAt(pt,_matrix$1),this.getBoundingSphereAt(vt,_sphere$2).applyMatrix4(_matrix$1),yt=!_frustum.intersectsSphere(_sphere$2)),!yt){const _t=ct[vt];at[dt]=_t.start*st,lt[dt]=_t.count,ft[dt]=pt,dt++}}ut.needsUpdate=!0,this._multiDrawCount=dt,this._visibilityChanged=!1}onBeforeShadow(_,_e,tt,nt,rt,it){this.onBeforeRender(_,null,nt,rt,it)}}class LineBasicMaterial extends Material{constructor(_){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.linewidth=_.linewidth,this.linecap=_.linecap,this.linejoin=_.linejoin,this.fog=_.fog,this}}const _vStart=new Vector3,_vEnd=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere,_intersectPointOnRay=new Vector3,_intersectPointOnSegment=new Vector3;class Line extends Object3D{constructor(_=new BufferGeometry,_e=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_,this.material=_e,this.updateMorphTargets()}copy(_,_e){return super.copy(_,_e),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}computeLineDistances(){const _=this.geometry;if(_.index===null){const _e=_.attributes.position,tt=[0];for(let nt=1,rt=_e.count;nt<rt;nt++)_vStart.fromBufferAttribute(_e,nt-1),_vEnd.fromBufferAttribute(_e,nt),tt[nt]=tt[nt-1],tt[nt]+=_vStart.distanceTo(_vEnd);_.setAttribute("lineDistance",new Float32BufferAttribute(tt,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_,_e){const tt=this.geometry,nt=this.matrixWorld,rt=_.params.Line.threshold,it=tt.drawRange;if(tt.boundingSphere===null&&tt.computeBoundingSphere(),_sphere$1.copy(tt.boundingSphere),_sphere$1.applyMatrix4(nt),_sphere$1.radius+=rt,_.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(nt).invert(),_ray$1.copy(_.ray).applyMatrix4(_inverseMatrix$1);const st=rt/((this.scale.x+this.scale.y+this.scale.z)/3),ot=st*st,at=this.isLineSegments?2:1,lt=tt.index,ht=tt.attributes.position;if(lt!==null){const ut=Math.max(0,it.start),ft=Math.min(lt.count,it.start+it.count);for(let dt=ut,pt=ft-1;dt<pt;dt+=at){const mt=lt.getX(dt),vt=lt.getX(dt+1),yt=checkIntersection(this,_,_ray$1,ot,mt,vt);yt&&_e.push(yt)}if(this.isLineLoop){const dt=lt.getX(ft-1),pt=lt.getX(ut),mt=checkIntersection(this,_,_ray$1,ot,dt,pt);mt&&_e.push(mt)}}else{const ut=Math.max(0,it.start),ft=Math.min(ht.count,it.start+it.count);for(let dt=ut,pt=ft-1;dt<pt;dt+=at){const mt=checkIntersection(this,_,_ray$1,ot,dt,dt+1);mt&&_e.push(mt)}if(this.isLineLoop){const dt=checkIntersection(this,_,_ray$1,ot,ft-1,ut);dt&&_e.push(dt)}}}updateMorphTargets(){const _e=this.geometry.morphAttributes,tt=Object.keys(_e);if(tt.length>0){const nt=_e[tt[0]];if(nt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let rt=0,it=nt.length;rt<it;rt++){const st=nt[rt].name||String(rt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[st]=rt}}}}}function checkIntersection(et,_,_e,tt,nt,rt){const it=et.geometry.attributes.position;if(_vStart.fromBufferAttribute(it,nt),_vEnd.fromBufferAttribute(it,rt),_e.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>tt)return;_intersectPointOnRay.applyMatrix4(et.matrixWorld);const ot=_.ray.origin.distanceTo(_intersectPointOnRay);if(!(ot<_.near||ot>_.far))return{distance:ot,point:_intersectPointOnSegment.clone().applyMatrix4(et.matrixWorld),index:nt,face:null,faceIndex:null,object:et}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(_,_e){super(_,_e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _=this.geometry;if(_.index===null){const _e=_.attributes.position,tt=[];for(let nt=0,rt=_e.count;nt<rt;nt+=2)_start.fromBufferAttribute(_e,nt),_end.fromBufferAttribute(_e,nt+1),tt[nt]=nt===0?0:tt[nt-1],tt[nt+1]=tt[nt]+_start.distanceTo(_end);_.setAttribute("lineDistance",new Float32BufferAttribute(tt,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_,_e){super(_,_e),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.size=_.size,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(_=new BufferGeometry,_e=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_,this.material=_e,this.updateMorphTargets()}copy(_,_e){return super.copy(_,_e),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}raycast(_,_e){const tt=this.geometry,nt=this.matrixWorld,rt=_.params.Points.threshold,it=tt.drawRange;if(tt.boundingSphere===null&&tt.computeBoundingSphere(),_sphere.copy(tt.boundingSphere),_sphere.applyMatrix4(nt),_sphere.radius+=rt,_.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(nt).invert(),_ray.copy(_.ray).applyMatrix4(_inverseMatrix);const st=rt/((this.scale.x+this.scale.y+this.scale.z)/3),ot=st*st,at=tt.index,ct=tt.attributes.position;if(at!==null){const ht=Math.max(0,it.start),ut=Math.min(at.count,it.start+it.count);for(let ft=ht,dt=ut;ft<dt;ft++){const pt=at.getX(ft);_position$2.fromBufferAttribute(ct,pt),testPoint(_position$2,pt,ot,nt,_,_e,this)}}else{const ht=Math.max(0,it.start),ut=Math.min(ct.count,it.start+it.count);for(let ft=ht,dt=ut;ft<dt;ft++)_position$2.fromBufferAttribute(ct,ft),testPoint(_position$2,ft,ot,nt,_,_e,this)}}updateMorphTargets(){const _e=this.geometry.morphAttributes,tt=Object.keys(_e);if(tt.length>0){const nt=_e[tt[0]];if(nt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let rt=0,it=nt.length;rt<it;rt++){const st=nt[rt].name||String(rt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[st]=rt}}}}}function testPoint(et,_,_e,tt,nt,rt,it){const st=_ray.distanceSqToPoint(et);if(st<_e){const ot=new Vector3;_ray.closestPointToPoint(et,ot),ot.applyMatrix4(tt);const at=nt.ray.origin.distanceTo(ot);if(at<nt.near||at>nt.far)return;rt.push({distance:at,distanceToRay:Math.sqrt(st),point:ot,index:_,face:null,object:it})}}class VideoTexture extends Texture$1{constructor(_,_e,tt,nt,rt,it,st,ot,at){super(_,_e,tt,nt,rt,it,st,ot,at),this.isVideoTexture=!0,this.minFilter=it!==void 0?it:LinearFilter,this.magFilter=rt!==void 0?rt:LinearFilter,this.generateMipmaps=!1;const lt=this;function ct(){lt.needsUpdate=!0,_.requestVideoFrameCallback(ct)}"requestVideoFrameCallback"in _&&_.requestVideoFrameCallback(ct)}clone(){return new this.constructor(this.image).copy(this)}update(){const _=this.image;"requestVideoFrameCallback"in _===!1&&_.readyState>=_.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture$1{constructor(_,_e){super({width:_,height:_e}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture$1{constructor(_,_e,tt,nt,rt,it,st,ot,at,lt,ct,ht){super(null,it,st,ot,at,lt,nt,rt,ct,ht),this.isCompressedTexture=!0,this.image={width:_e,height:tt},this.mipmaps=_,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(_,_e,tt,nt,rt,it){super(_,_e,tt,rt,it),this.isCompressedArrayTexture=!0,this.image.depth=nt,this.wrapR=ClampToEdgeWrapping,this.layerUpdates=new Set}addLayerUpdate(_){this.layerUpdates.add(_)}clearLayerUpdates(){this.layerUpdates.clear()}}class CompressedCubeTexture extends CompressedTexture{constructor(_,_e,tt){super(void 0,_[0].width,_[0].height,_e,tt,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=_}}class CanvasTexture extends Texture$1{constructor(_,_e,tt,nt,rt,it,st,ot,at){super(_,_e,tt,nt,rt,it,st,ot,at),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_,_e){const tt=this.getUtoTmapping(_);return this.getPoint(tt,_e)}getPoints(_=5){const _e=[];for(let tt=0;tt<=_;tt++)_e.push(this.getPoint(tt/_));return _e}getSpacedPoints(_=5){const _e=[];for(let tt=0;tt<=_;tt++)_e.push(this.getPointAt(tt/_));return _e}getLength(){const _=this.getLengths();return _[_.length-1]}getLengths(_=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const _e=[];let tt,nt=this.getPoint(0),rt=0;_e.push(0);for(let it=1;it<=_;it++)tt=this.getPoint(it/_),rt+=tt.distanceTo(nt),_e.push(rt),nt=tt;return this.cacheArcLengths=_e,_e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_,_e){const tt=this.getLengths();let nt=0;const rt=tt.length;let it;_e?it=_e:it=_*tt[rt-1];let st=0,ot=rt-1,at;for(;st<=ot;)if(nt=Math.floor(st+(ot-st)/2),at=tt[nt]-it,at<0)st=nt+1;else if(at>0)ot=nt-1;else{ot=nt;break}if(nt=ot,tt[nt]===it)return nt/(rt-1);const lt=tt[nt],ht=tt[nt+1]-lt,ut=(it-lt)/ht;return(nt+ut)/(rt-1)}getTangent(_,_e){let nt=_-1e-4,rt=_+1e-4;nt<0&&(nt=0),rt>1&&(rt=1);const it=this.getPoint(nt),st=this.getPoint(rt),ot=_e||(it.isVector2?new Vector2:new Vector3);return ot.copy(st).sub(it).normalize(),ot}getTangentAt(_,_e){const tt=this.getUtoTmapping(_);return this.getTangent(tt,_e)}computeFrenetFrames(_,_e){const tt=new Vector3,nt=[],rt=[],it=[],st=new Vector3,ot=new Matrix4;for(let ut=0;ut<=_;ut++){const ft=ut/_;nt[ut]=this.getTangentAt(ft,new Vector3)}rt[0]=new Vector3,it[0]=new Vector3;let at=Number.MAX_VALUE;const lt=Math.abs(nt[0].x),ct=Math.abs(nt[0].y),ht=Math.abs(nt[0].z);lt<=at&&(at=lt,tt.set(1,0,0)),ct<=at&&(at=ct,tt.set(0,1,0)),ht<=at&&tt.set(0,0,1),st.crossVectors(nt[0],tt).normalize(),rt[0].crossVectors(nt[0],st),it[0].crossVectors(nt[0],rt[0]);for(let ut=1;ut<=_;ut++){if(rt[ut]=rt[ut-1].clone(),it[ut]=it[ut-1].clone(),st.crossVectors(nt[ut-1],nt[ut]),st.length()>Number.EPSILON){st.normalize();const ft=Math.acos(clamp$1(nt[ut-1].dot(nt[ut]),-1,1));rt[ut].applyMatrix4(ot.makeRotationAxis(st,ft))}it[ut].crossVectors(nt[ut],rt[ut])}if(_e===!0){let ut=Math.acos(clamp$1(rt[0].dot(rt[_]),-1,1));ut/=_,nt[0].dot(st.crossVectors(rt[0],rt[_]))>0&&(ut=-ut);for(let ft=1;ft<=_;ft++)rt[ft].applyMatrix4(ot.makeRotationAxis(nt[ft],ut*ft)),it[ft].crossVectors(nt[ft],rt[ft])}return{tangents:nt,normals:rt,binormals:it}}clone(){return new this.constructor().copy(this)}copy(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}toJSON(){const _={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _.arcLengthDivisions=this.arcLengthDivisions,_.type=this.type,_}fromJSON(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_=0,_e=0,tt=1,nt=1,rt=0,it=Math.PI*2,st=!1,ot=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_,this.aY=_e,this.xRadius=tt,this.yRadius=nt,this.aStartAngle=rt,this.aEndAngle=it,this.aClockwise=st,this.aRotation=ot}getPoint(_,_e=new Vector2){const tt=_e,nt=Math.PI*2;let rt=this.aEndAngle-this.aStartAngle;const it=Math.abs(rt)<Number.EPSILON;for(;rt<0;)rt+=nt;for(;rt>nt;)rt-=nt;rt<Number.EPSILON&&(it?rt=0:rt=nt),this.aClockwise===!0&&!it&&(rt===nt?rt=-nt:rt=rt-nt);const st=this.aStartAngle+_*rt;let ot=this.aX+this.xRadius*Math.cos(st),at=this.aY+this.yRadius*Math.sin(st);if(this.aRotation!==0){const lt=Math.cos(this.aRotation),ct=Math.sin(this.aRotation),ht=ot-this.aX,ut=at-this.aY;ot=ht*lt-ut*ct+this.aX,at=ht*ct+ut*lt+this.aY}return tt.set(ot,at)}copy(_){return super.copy(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}toJSON(){const _=super.toJSON();return _.aX=this.aX,_.aY=this.aY,_.xRadius=this.xRadius,_.yRadius=this.yRadius,_.aStartAngle=this.aStartAngle,_.aEndAngle=this.aEndAngle,_.aClockwise=this.aClockwise,_.aRotation=this.aRotation,_}fromJSON(_){return super.fromJSON(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_,_e,tt,nt,rt,it){super(_,_e,tt,tt,nt,rt,it),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let et=0,_=0,_e=0,tt=0;function nt(rt,it,st,ot){et=rt,_=st,_e=-3*rt+3*it-2*st-ot,tt=2*rt-2*it+st+ot}return{initCatmullRom:function(rt,it,st,ot,at){nt(it,st,at*(st-rt),at*(ot-it))},initNonuniformCatmullRom:function(rt,it,st,ot,at,lt,ct){let ht=(it-rt)/at-(st-rt)/(at+lt)+(st-it)/lt,ut=(st-it)/lt-(ot-it)/(lt+ct)+(ot-st)/ct;ht*=lt,ut*=lt,nt(it,st,ht,ut)},calc:function(rt){const it=rt*rt,st=it*rt;return et+_*rt+_e*it+tt*st}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_=[],_e=!1,tt="centripetal",nt=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_,this.closed=_e,this.curveType=tt,this.tension=nt}getPoint(_,_e=new Vector3){const tt=_e,nt=this.points,rt=nt.length,it=(rt-(this.closed?0:1))*_;let st=Math.floor(it),ot=it-st;this.closed?st+=st>0?0:(Math.floor(Math.abs(st)/rt)+1)*rt:ot===0&&st===rt-1&&(st=rt-2,ot=1);let at,lt;this.closed||st>0?at=nt[(st-1)%rt]:(tmp.subVectors(nt[0],nt[1]).add(nt[0]),at=tmp);const ct=nt[st%rt],ht=nt[(st+1)%rt];if(this.closed||st+2<rt?lt=nt[(st+2)%rt]:(tmp.subVectors(nt[rt-1],nt[rt-2]).add(nt[rt-1]),lt=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ut=this.curveType==="chordal"?.5:.25;let ft=Math.pow(at.distanceToSquared(ct),ut),dt=Math.pow(ct.distanceToSquared(ht),ut),pt=Math.pow(ht.distanceToSquared(lt),ut);dt<1e-4&&(dt=1),ft<1e-4&&(ft=dt),pt<1e-4&&(pt=dt),px.initNonuniformCatmullRom(at.x,ct.x,ht.x,lt.x,ft,dt,pt),py.initNonuniformCatmullRom(at.y,ct.y,ht.y,lt.y,ft,dt,pt),pz.initNonuniformCatmullRom(at.z,ct.z,ht.z,lt.z,ft,dt,pt)}else this.curveType==="catmullrom"&&(px.initCatmullRom(at.x,ct.x,ht.x,lt.x,this.tension),py.initCatmullRom(at.y,ct.y,ht.y,lt.y,this.tension),pz.initCatmullRom(at.z,ct.z,ht.z,lt.z,this.tension));return tt.set(px.calc(ot),py.calc(ot),pz.calc(ot)),tt}copy(_){super.copy(_),this.points=[];for(let _e=0,tt=_.points.length;_e<tt;_e++){const nt=_.points[_e];this.points.push(nt.clone())}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}toJSON(){const _=super.toJSON();_.points=[];for(let _e=0,tt=this.points.length;_e<tt;_e++){const nt=this.points[_e];_.points.push(nt.toArray())}return _.closed=this.closed,_.curveType=this.curveType,_.tension=this.tension,_}fromJSON(_){super.fromJSON(_),this.points=[];for(let _e=0,tt=_.points.length;_e<tt;_e++){const nt=_.points[_e];this.points.push(new Vector3().fromArray(nt))}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}}function CatmullRom(et,_,_e,tt,nt){const rt=(tt-_)*.5,it=(nt-_e)*.5,st=et*et,ot=et*st;return(2*_e-2*tt+rt+it)*ot+(-3*_e+3*tt-2*rt-it)*st+rt*et+_e}function QuadraticBezierP0(et,_){const _e=1-et;return _e*_e*_}function QuadraticBezierP1(et,_){return 2*(1-et)*et*_}function QuadraticBezierP2(et,_){return et*et*_}function QuadraticBezier(et,_,_e,tt){return QuadraticBezierP0(et,_)+QuadraticBezierP1(et,_e)+QuadraticBezierP2(et,tt)}function CubicBezierP0(et,_){const _e=1-et;return _e*_e*_e*_}function CubicBezierP1(et,_){const _e=1-et;return 3*_e*_e*et*_}function CubicBezierP2(et,_){return 3*(1-et)*et*et*_}function CubicBezierP3(et,_){return et*et*et*_}function CubicBezier(et,_,_e,tt,nt){return CubicBezierP0(et,_)+CubicBezierP1(et,_e)+CubicBezierP2(et,tt)+CubicBezierP3(et,nt)}class CubicBezierCurve extends Curve{constructor(_=new Vector2,_e=new Vector2,tt=new Vector2,nt=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_,this.v1=_e,this.v2=tt,this.v3=nt}getPoint(_,_e=new Vector2){const tt=_e,nt=this.v0,rt=this.v1,it=this.v2,st=this.v3;return tt.set(CubicBezier(_,nt.x,rt.x,it.x,st.x),CubicBezier(_,nt.y,rt.y,it.y,st.y)),tt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_=new Vector3,_e=new Vector3,tt=new Vector3,nt=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_,this.v1=_e,this.v2=tt,this.v3=nt}getPoint(_,_e=new Vector3){const tt=_e,nt=this.v0,rt=this.v1,it=this.v2,st=this.v3;return tt.set(CubicBezier(_,nt.x,rt.x,it.x,st.x),CubicBezier(_,nt.y,rt.y,it.y,st.y),CubicBezier(_,nt.z,rt.z,it.z,st.z)),tt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class LineCurve extends Curve{constructor(_=new Vector2,_e=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_,this.v2=_e}getPoint(_,_e=new Vector2){const tt=_e;return _===1?tt.copy(this.v2):(tt.copy(this.v2).sub(this.v1),tt.multiplyScalar(_).add(this.v1)),tt}getPointAt(_,_e){return this.getPoint(_,_e)}getTangent(_,_e=new Vector2){return _e.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,_e){return this.getTangent(_,_e)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class LineCurve3 extends Curve{constructor(_=new Vector3,_e=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_,this.v2=_e}getPoint(_,_e=new Vector3){const tt=_e;return _===1?tt.copy(this.v2):(tt.copy(this.v2).sub(this.v1),tt.multiplyScalar(_).add(this.v1)),tt}getPointAt(_,_e){return this.getPoint(_,_e)}getTangent(_,_e=new Vector3){return _e.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,_e){return this.getTangent(_,_e)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_=new Vector2,_e=new Vector2,tt=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_,this.v1=_e,this.v2=tt}getPoint(_,_e=new Vector2){const tt=_e,nt=this.v0,rt=this.v1,it=this.v2;return tt.set(QuadraticBezier(_,nt.x,rt.x,it.x),QuadraticBezier(_,nt.y,rt.y,it.y)),tt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_=new Vector3,_e=new Vector3,tt=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_,this.v1=_e,this.v2=tt}getPoint(_,_e=new Vector3){const tt=_e,nt=this.v0,rt=this.v1,it=this.v2;return tt.set(QuadraticBezier(_,nt.x,rt.x,it.x),QuadraticBezier(_,nt.y,rt.y,it.y),QuadraticBezier(_,nt.z,rt.z,it.z)),tt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class SplineCurve extends Curve{constructor(_=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_}getPoint(_,_e=new Vector2){const tt=_e,nt=this.points,rt=(nt.length-1)*_,it=Math.floor(rt),st=rt-it,ot=nt[it===0?it:it-1],at=nt[it],lt=nt[it>nt.length-2?nt.length-1:it+1],ct=nt[it>nt.length-3?nt.length-1:it+2];return tt.set(CatmullRom(st,ot.x,at.x,lt.x,ct.x),CatmullRom(st,ot.y,at.y,lt.y,ct.y)),tt}copy(_){super.copy(_),this.points=[];for(let _e=0,tt=_.points.length;_e<tt;_e++){const nt=_.points[_e];this.points.push(nt.clone())}return this}toJSON(){const _=super.toJSON();_.points=[];for(let _e=0,tt=this.points.length;_e<tt;_e++){const nt=this.points[_e];_.points.push(nt.toArray())}return _}fromJSON(_){super.fromJSON(_),this.points=[];for(let _e=0,tt=_.points.length;_e<tt;_e++){const nt=_.points[_e];this.points.push(new Vector2().fromArray(nt))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_){this.curves.push(_)}closePath(){const _=this.curves[0].getPoint(0),_e=this.curves[this.curves.length-1].getPoint(1);if(!_.equals(_e)){const tt=_.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Curves[tt](_e,_))}return this}getPoint(_,_e){const tt=_*this.getLength(),nt=this.getCurveLengths();let rt=0;for(;rt<nt.length;){if(nt[rt]>=tt){const it=nt[rt]-tt,st=this.curves[rt],ot=st.getLength(),at=ot===0?0:1-it/ot;return st.getPointAt(at,_e)}rt++}return null}getLength(){const _=this.getCurveLengths();return _[_.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _=[];let _e=0;for(let tt=0,nt=this.curves.length;tt<nt;tt++)_e+=this.curves[tt].getLength(),_.push(_e);return this.cacheLengths=_,_}getSpacedPoints(_=40){const _e=[];for(let tt=0;tt<=_;tt++)_e.push(this.getPoint(tt/_));return this.autoClose&&_e.push(_e[0]),_e}getPoints(_=12){const _e=[];let tt;for(let nt=0,rt=this.curves;nt<rt.length;nt++){const it=rt[nt],st=it.isEllipseCurve?_*2:it.isLineCurve||it.isLineCurve3?1:it.isSplineCurve?_*it.points.length:_,ot=it.getPoints(st);for(let at=0;at<ot.length;at++){const lt=ot[at];tt&&tt.equals(lt)||(_e.push(lt),tt=lt)}}return this.autoClose&&_e.length>1&&!_e[_e.length-1].equals(_e[0])&&_e.push(_e[0]),_e}copy(_){super.copy(_),this.curves=[];for(let _e=0,tt=_.curves.length;_e<tt;_e++){const nt=_.curves[_e];this.curves.push(nt.clone())}return this.autoClose=_.autoClose,this}toJSON(){const _=super.toJSON();_.autoClose=this.autoClose,_.curves=[];for(let _e=0,tt=this.curves.length;_e<tt;_e++){const nt=this.curves[_e];_.curves.push(nt.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.autoClose=_.autoClose,this.curves=[];for(let _e=0,tt=_.curves.length;_e<tt;_e++){const nt=_.curves[_e];this.curves.push(new Curves[nt.type]().fromJSON(nt))}return this}}class Path extends CurvePath{constructor(_){super(),this.type="Path",this.currentPoint=new Vector2,_&&this.setFromPoints(_)}setFromPoints(_){this.moveTo(_[0].x,_[0].y);for(let _e=1,tt=_.length;_e<tt;_e++)this.lineTo(_[_e].x,_[_e].y);return this}moveTo(_,_e){return this.currentPoint.set(_,_e),this}lineTo(_,_e){const tt=new LineCurve(this.currentPoint.clone(),new Vector2(_,_e));return this.curves.push(tt),this.currentPoint.set(_,_e),this}quadraticCurveTo(_,_e,tt,nt){const rt=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_,_e),new Vector2(tt,nt));return this.curves.push(rt),this.currentPoint.set(tt,nt),this}bezierCurveTo(_,_e,tt,nt,rt,it){const st=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_,_e),new Vector2(tt,nt),new Vector2(rt,it));return this.curves.push(st),this.currentPoint.set(rt,it),this}splineThru(_){const _e=[this.currentPoint.clone()].concat(_),tt=new SplineCurve(_e);return this.curves.push(tt),this.currentPoint.copy(_[_.length-1]),this}arc(_,_e,tt,nt,rt,it){const st=this.currentPoint.x,ot=this.currentPoint.y;return this.absarc(_+st,_e+ot,tt,nt,rt,it),this}absarc(_,_e,tt,nt,rt,it){return this.absellipse(_,_e,tt,tt,nt,rt,it),this}ellipse(_,_e,tt,nt,rt,it,st,ot){const at=this.currentPoint.x,lt=this.currentPoint.y;return this.absellipse(_+at,_e+lt,tt,nt,rt,it,st,ot),this}absellipse(_,_e,tt,nt,rt,it,st,ot){const at=new EllipseCurve(_,_e,tt,nt,rt,it,st,ot);if(this.curves.length>0){const ct=at.getPoint(0);ct.equals(this.currentPoint)||this.lineTo(ct.x,ct.y)}this.curves.push(at);const lt=at.getPoint(1);return this.currentPoint.copy(lt),this}copy(_){return super.copy(_),this.currentPoint.copy(_.currentPoint),this}toJSON(){const _=super.toJSON();return _.currentPoint=this.currentPoint.toArray(),_}fromJSON(_){return super.fromJSON(_),this.currentPoint.fromArray(_.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(_=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],_e=12,tt=0,nt=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_,segments:_e,phiStart:tt,phiLength:nt},_e=Math.floor(_e),nt=clamp$1(nt,0,Math.PI*2);const rt=[],it=[],st=[],ot=[],at=[],lt=1/_e,ct=new Vector3,ht=new Vector2,ut=new Vector3,ft=new Vector3,dt=new Vector3;let pt=0,mt=0;for(let vt=0;vt<=_.length-1;vt++)switch(vt){case 0:pt=_[vt+1].x-_[vt].x,mt=_[vt+1].y-_[vt].y,ut.x=mt*1,ut.y=-pt,ut.z=mt*0,dt.copy(ut),ut.normalize(),ot.push(ut.x,ut.y,ut.z);break;case _.length-1:ot.push(dt.x,dt.y,dt.z);break;default:pt=_[vt+1].x-_[vt].x,mt=_[vt+1].y-_[vt].y,ut.x=mt*1,ut.y=-pt,ut.z=mt*0,ft.copy(ut),ut.x+=dt.x,ut.y+=dt.y,ut.z+=dt.z,ut.normalize(),ot.push(ut.x,ut.y,ut.z),dt.copy(ft)}for(let vt=0;vt<=_e;vt++){const yt=tt+vt*lt*nt,_t=Math.sin(yt),St=Math.cos(yt);for(let bt=0;bt<=_.length-1;bt++){ct.x=_[bt].x*_t,ct.y=_[bt].y,ct.z=_[bt].x*St,it.push(ct.x,ct.y,ct.z),ht.x=vt/_e,ht.y=bt/(_.length-1),st.push(ht.x,ht.y);const Et=ot[3*bt+0]*_t,Mt=ot[3*bt+1],Tt=ot[3*bt+0]*St;at.push(Et,Mt,Tt)}}for(let vt=0;vt<_e;vt++)for(let yt=0;yt<_.length-1;yt++){const _t=yt+vt*_.length,St=_t,bt=_t+_.length,Et=_t+_.length+1,Mt=_t+1;rt.push(St,bt,Mt),rt.push(Et,Mt,bt)}this.setIndex(rt),this.setAttribute("position",new Float32BufferAttribute(it,3)),this.setAttribute("uv",new Float32BufferAttribute(st,2)),this.setAttribute("normal",new Float32BufferAttribute(at,3))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new LatheGeometry(_.points,_.segments,_.phiStart,_.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_=1,_e=1,tt=4,nt=8){const rt=new Path;rt.absarc(0,-_e/2,_,Math.PI*1.5,0),rt.absarc(0,_e/2,_,0,Math.PI*.5),super(rt.getPoints(tt),nt),this.type="CapsuleGeometry",this.parameters={radius:_,length:_e,capSegments:tt,radialSegments:nt}}static fromJSON(_){return new CapsuleGeometry(_.radius,_.length,_.capSegments,_.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_=1,_e=32,tt=0,nt=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_,segments:_e,thetaStart:tt,thetaLength:nt},_e=Math.max(3,_e);const rt=[],it=[],st=[],ot=[],at=new Vector3,lt=new Vector2;it.push(0,0,0),st.push(0,0,1),ot.push(.5,.5);for(let ct=0,ht=3;ct<=_e;ct++,ht+=3){const ut=tt+ct/_e*nt;at.x=_*Math.cos(ut),at.y=_*Math.sin(ut),it.push(at.x,at.y,at.z),st.push(0,0,1),lt.x=(it[ht]/_+1)/2,lt.y=(it[ht+1]/_+1)/2,ot.push(lt.x,lt.y)}for(let ct=1;ct<=_e;ct++)rt.push(ct,ct+1,0);this.setIndex(rt),this.setAttribute("position",new Float32BufferAttribute(it,3)),this.setAttribute("normal",new Float32BufferAttribute(st,3)),this.setAttribute("uv",new Float32BufferAttribute(ot,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CircleGeometry(_.radius,_.segments,_.thetaStart,_.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_=1,_e=1,tt=1,nt=32,rt=1,it=!1,st=0,ot=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_,radiusBottom:_e,height:tt,radialSegments:nt,heightSegments:rt,openEnded:it,thetaStart:st,thetaLength:ot};const at=this;nt=Math.floor(nt),rt=Math.floor(rt);const lt=[],ct=[],ht=[],ut=[];let ft=0;const dt=[],pt=tt/2;let mt=0;vt(),it===!1&&(_>0&&yt(!0),_e>0&&yt(!1)),this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute(ct,3)),this.setAttribute("normal",new Float32BufferAttribute(ht,3)),this.setAttribute("uv",new Float32BufferAttribute(ut,2));function vt(){const _t=new Vector3,St=new Vector3;let bt=0;const Et=(_e-_)/tt;for(let Mt=0;Mt<=rt;Mt++){const Tt=[],wt=Mt/rt,Ct=wt*(_e-_)+_;for(let Rt=0;Rt<=nt;Rt++){const It=Rt/nt,Dt=It*ot+st,Ft=Math.sin(Dt),$t=Math.cos(Dt);St.x=Ct*Ft,St.y=-wt*tt+pt,St.z=Ct*$t,ct.push(St.x,St.y,St.z),_t.set(Ft,Et,$t).normalize(),ht.push(_t.x,_t.y,_t.z),ut.push(It,1-wt),Tt.push(ft++)}dt.push(Tt)}for(let Mt=0;Mt<nt;Mt++)for(let Tt=0;Tt<rt;Tt++){const wt=dt[Tt][Mt],Ct=dt[Tt+1][Mt],Rt=dt[Tt+1][Mt+1],It=dt[Tt][Mt+1];lt.push(wt,Ct,It),lt.push(Ct,Rt,It),bt+=6}at.addGroup(mt,bt,0),mt+=bt}function yt(_t){const St=ft,bt=new Vector2,Et=new Vector3;let Mt=0;const Tt=_t===!0?_:_e,wt=_t===!0?1:-1;for(let Rt=1;Rt<=nt;Rt++)ct.push(0,pt*wt,0),ht.push(0,wt,0),ut.push(.5,.5),ft++;const Ct=ft;for(let Rt=0;Rt<=nt;Rt++){const Dt=Rt/nt*ot+st,Ft=Math.cos(Dt),$t=Math.sin(Dt);Et.x=Tt*$t,Et.y=pt*wt,Et.z=Tt*Ft,ct.push(Et.x,Et.y,Et.z),ht.push(0,wt,0),bt.x=Ft*.5+.5,bt.y=$t*.5*wt+.5,ut.push(bt.x,bt.y),ft++}for(let Rt=0;Rt<nt;Rt++){const It=St+Rt,Dt=Ct+Rt;_t===!0?lt.push(Dt,Dt+1,It):lt.push(Dt+1,Dt,It),Mt+=3}at.addGroup(mt,Mt,_t===!0?1:2),mt+=Mt}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CylinderGeometry(_.radiusTop,_.radiusBottom,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_=1,_e=1,tt=32,nt=1,rt=!1,it=0,st=Math.PI*2){super(0,_,_e,tt,nt,rt,it,st),this.type="ConeGeometry",this.parameters={radius:_,height:_e,radialSegments:tt,heightSegments:nt,openEnded:rt,thetaStart:it,thetaLength:st}}static fromJSON(_){return new ConeGeometry(_.radius,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_=[],_e=[],tt=1,nt=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_,indices:_e,radius:tt,detail:nt};const rt=[],it=[];st(nt),at(tt),lt(),this.setAttribute("position",new Float32BufferAttribute(rt,3)),this.setAttribute("normal",new Float32BufferAttribute(rt.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(it,2)),nt===0?this.computeVertexNormals():this.normalizeNormals();function st(vt){const yt=new Vector3,_t=new Vector3,St=new Vector3;for(let bt=0;bt<_e.length;bt+=3)ut(_e[bt+0],yt),ut(_e[bt+1],_t),ut(_e[bt+2],St),ot(yt,_t,St,vt)}function ot(vt,yt,_t,St){const bt=St+1,Et=[];for(let Mt=0;Mt<=bt;Mt++){Et[Mt]=[];const Tt=vt.clone().lerp(_t,Mt/bt),wt=yt.clone().lerp(_t,Mt/bt),Ct=bt-Mt;for(let Rt=0;Rt<=Ct;Rt++)Rt===0&&Mt===bt?Et[Mt][Rt]=Tt:Et[Mt][Rt]=Tt.clone().lerp(wt,Rt/Ct)}for(let Mt=0;Mt<bt;Mt++)for(let Tt=0;Tt<2*(bt-Mt)-1;Tt++){const wt=Math.floor(Tt/2);Tt%2===0?(ht(Et[Mt][wt+1]),ht(Et[Mt+1][wt]),ht(Et[Mt][wt])):(ht(Et[Mt][wt+1]),ht(Et[Mt+1][wt+1]),ht(Et[Mt+1][wt]))}}function at(vt){const yt=new Vector3;for(let _t=0;_t<rt.length;_t+=3)yt.x=rt[_t+0],yt.y=rt[_t+1],yt.z=rt[_t+2],yt.normalize().multiplyScalar(vt),rt[_t+0]=yt.x,rt[_t+1]=yt.y,rt[_t+2]=yt.z}function lt(){const vt=new Vector3;for(let yt=0;yt<rt.length;yt+=3){vt.x=rt[yt+0],vt.y=rt[yt+1],vt.z=rt[yt+2];const _t=pt(vt)/2/Math.PI+.5,St=mt(vt)/Math.PI+.5;it.push(_t,1-St)}ft(),ct()}function ct(){for(let vt=0;vt<it.length;vt+=6){const yt=it[vt+0],_t=it[vt+2],St=it[vt+4],bt=Math.max(yt,_t,St),Et=Math.min(yt,_t,St);bt>.9&&Et<.1&&(yt<.2&&(it[vt+0]+=1),_t<.2&&(it[vt+2]+=1),St<.2&&(it[vt+4]+=1))}}function ht(vt){rt.push(vt.x,vt.y,vt.z)}function ut(vt,yt){const _t=vt*3;yt.x=_[_t+0],yt.y=_[_t+1],yt.z=_[_t+2]}function ft(){const vt=new Vector3,yt=new Vector3,_t=new Vector3,St=new Vector3,bt=new Vector2,Et=new Vector2,Mt=new Vector2;for(let Tt=0,wt=0;Tt<rt.length;Tt+=9,wt+=6){vt.set(rt[Tt+0],rt[Tt+1],rt[Tt+2]),yt.set(rt[Tt+3],rt[Tt+4],rt[Tt+5]),_t.set(rt[Tt+6],rt[Tt+7],rt[Tt+8]),bt.set(it[wt+0],it[wt+1]),Et.set(it[wt+2],it[wt+3]),Mt.set(it[wt+4],it[wt+5]),St.copy(vt).add(yt).add(_t).divideScalar(3);const Ct=pt(St);dt(bt,wt+0,vt,Ct),dt(Et,wt+2,yt,Ct),dt(Mt,wt+4,_t,Ct)}}function dt(vt,yt,_t,St){St<0&&vt.x===1&&(it[yt]=vt.x-1),_t.x===0&&_t.z===0&&(it[yt]=St/2/Math.PI+.5)}function pt(vt){return Math.atan2(vt.z,-vt.x)}function mt(vt){return Math.atan2(-vt.y,Math.sqrt(vt.x*vt.x+vt.z*vt.z))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PolyhedronGeometry(_.vertices,_.indices,_.radius,_.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_=1,_e=0){const tt=(1+Math.sqrt(5))/2,nt=1/tt,rt=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-nt,-tt,0,-nt,tt,0,nt,-tt,0,nt,tt,-nt,-tt,0,-nt,tt,0,nt,-tt,0,nt,tt,0,-tt,0,-nt,tt,0,-nt,-tt,0,nt,tt,0,nt],it=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(rt,it,_,_e),this.type="DodecahedronGeometry",this.parameters={radius:_,detail:_e}}static fromJSON(_){return new DodecahedronGeometry(_.radius,_.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_=null,_e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_,thresholdAngle:_e},_!==null){const nt=Math.pow(10,4),rt=Math.cos(DEG2RAD*_e),it=_.getIndex(),st=_.getAttribute("position"),ot=it?it.count:st.count,at=[0,0,0],lt=["a","b","c"],ct=new Array(3),ht={},ut=[];for(let ft=0;ft<ot;ft+=3){it?(at[0]=it.getX(ft),at[1]=it.getX(ft+1),at[2]=it.getX(ft+2)):(at[0]=ft,at[1]=ft+1,at[2]=ft+2);const{a:dt,b:pt,c:mt}=_triangle;if(dt.fromBufferAttribute(st,at[0]),pt.fromBufferAttribute(st,at[1]),mt.fromBufferAttribute(st,at[2]),_triangle.getNormal(_normal),ct[0]=`${Math.round(dt.x*nt)},${Math.round(dt.y*nt)},${Math.round(dt.z*nt)}`,ct[1]=`${Math.round(pt.x*nt)},${Math.round(pt.y*nt)},${Math.round(pt.z*nt)}`,ct[2]=`${Math.round(mt.x*nt)},${Math.round(mt.y*nt)},${Math.round(mt.z*nt)}`,!(ct[0]===ct[1]||ct[1]===ct[2]||ct[2]===ct[0]))for(let vt=0;vt<3;vt++){const yt=(vt+1)%3,_t=ct[vt],St=ct[yt],bt=_triangle[lt[vt]],Et=_triangle[lt[yt]],Mt=`${_t}_${St}`,Tt=`${St}_${_t}`;Tt in ht&&ht[Tt]?(_normal.dot(ht[Tt].normal)<=rt&&(ut.push(bt.x,bt.y,bt.z),ut.push(Et.x,Et.y,Et.z)),ht[Tt]=null):Mt in ht||(ht[Mt]={index0:at[vt],index1:at[yt],normal:_normal.clone()})}}for(const ft in ht)if(ht[ft]){const{index0:dt,index1:pt}=ht[ft];_v0.fromBufferAttribute(st,dt),_v1$1.fromBufferAttribute(st,pt),ut.push(_v0.x,_v0.y,_v0.z),ut.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(ut,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}let Shape$1=class extends Path{constructor(_){super(_),this.uuid=generateUUID$1(),this.type="Shape",this.holes=[]}getPointsHoles(_){const _e=[];for(let tt=0,nt=this.holes.length;tt<nt;tt++)_e[tt]=this.holes[tt].getPoints(_);return _e}extractPoints(_){return{shape:this.getPoints(_),holes:this.getPointsHoles(_)}}copy(_){super.copy(_),this.holes=[];for(let _e=0,tt=_.holes.length;_e<tt;_e++){const nt=_.holes[_e];this.holes.push(nt.clone())}return this}toJSON(){const _=super.toJSON();_.uuid=this.uuid,_.holes=[];for(let _e=0,tt=this.holes.length;_e<tt;_e++){const nt=this.holes[_e];_.holes.push(nt.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.uuid=_.uuid,this.holes=[];for(let _e=0,tt=_.holes.length;_e<tt;_e++){const nt=_.holes[_e];this.holes.push(new Path().fromJSON(nt))}return this}};const Earcut={triangulate:function(et,_,_e=2){const tt=_&&_.length,nt=tt?_[0]*_e:et.length;let rt=linkedList$1(et,0,nt,_e,!0);const it=[];if(!rt||rt.next===rt.prev)return it;let st,ot,at,lt,ct,ht,ut;if(tt&&(rt=eliminateHoles$1(et,_,rt,_e)),et.length>80*_e){st=at=et[0],ot=lt=et[1];for(let ft=_e;ft<nt;ft+=_e)ct=et[ft],ht=et[ft+1],ct<st&&(st=ct),ht<ot&&(ot=ht),ct>at&&(at=ct),ht>lt&&(lt=ht);ut=Math.max(at-st,lt-ot),ut=ut!==0?32767/ut:0}return earcutLinked$1(rt,it,_e,st,ot,ut,0),it}};function linkedList$1(et,_,_e,tt,nt){let rt,it;if(nt===signedArea$1(et,_,_e,tt)>0)for(rt=_;rt<_e;rt+=tt)it=insertNode$1(rt,et[rt],et[rt+1],it);else for(rt=_e-tt;rt>=_;rt-=tt)it=insertNode$1(rt,et[rt],et[rt+1],it);return it&&equals$1(it,it.next)&&(removeNode$1(it),it=it.next),it}function filterPoints$1(et,_){if(!et)return et;_||(_=et);let _e=et,tt;do if(tt=!1,!_e.steiner&&(equals$1(_e,_e.next)||area$1(_e.prev,_e,_e.next)===0)){if(removeNode$1(_e),_e=_=_e.prev,_e===_e.next)break;tt=!0}else _e=_e.next;while(tt||_e!==_);return _}function earcutLinked$1(et,_,_e,tt,nt,rt,it){if(!et)return;!it&&rt&&indexCurve$1(et,tt,nt,rt);let st=et,ot,at;for(;et.prev!==et.next;){if(ot=et.prev,at=et.next,rt?isEarHashed$1(et,tt,nt,rt):isEar$1(et)){_.push(ot.i/_e|0),_.push(et.i/_e|0),_.push(at.i/_e|0),removeNode$1(et),et=at.next,st=at.next;continue}if(et=at,et===st){it?it===1?(et=cureLocalIntersections$1(filterPoints$1(et),_,_e),earcutLinked$1(et,_,_e,tt,nt,rt,2)):it===2&&splitEarcut$1(et,_,_e,tt,nt,rt):earcutLinked$1(filterPoints$1(et),_,_e,tt,nt,rt,1);break}}}function isEar$1(et){const _=et.prev,_e=et,tt=et.next;if(area$1(_,_e,tt)>=0)return!1;const nt=_.x,rt=_e.x,it=tt.x,st=_.y,ot=_e.y,at=tt.y,lt=nt<rt?nt<it?nt:it:rt<it?rt:it,ct=st<ot?st<at?st:at:ot<at?ot:at,ht=nt>rt?nt>it?nt:it:rt>it?rt:it,ut=st>ot?st>at?st:at:ot>at?ot:at;let ft=tt.next;for(;ft!==_;){if(ft.x>=lt&&ft.x<=ht&&ft.y>=ct&&ft.y<=ut&&pointInTriangle$1(nt,st,rt,ot,it,at,ft.x,ft.y)&&area$1(ft.prev,ft,ft.next)>=0)return!1;ft=ft.next}return!0}function isEarHashed$1(et,_,_e,tt){const nt=et.prev,rt=et,it=et.next;if(area$1(nt,rt,it)>=0)return!1;const st=nt.x,ot=rt.x,at=it.x,lt=nt.y,ct=rt.y,ht=it.y,ut=st<ot?st<at?st:at:ot<at?ot:at,ft=lt<ct?lt<ht?lt:ht:ct<ht?ct:ht,dt=st>ot?st>at?st:at:ot>at?ot:at,pt=lt>ct?lt>ht?lt:ht:ct>ht?ct:ht,mt=zOrder$1(ut,ft,_,_e,tt),vt=zOrder$1(dt,pt,_,_e,tt);let yt=et.prevZ,_t=et.nextZ;for(;yt&&yt.z>=mt&&_t&&_t.z<=vt;){if(yt.x>=ut&&yt.x<=dt&&yt.y>=ft&&yt.y<=pt&&yt!==nt&&yt!==it&&pointInTriangle$1(st,lt,ot,ct,at,ht,yt.x,yt.y)&&area$1(yt.prev,yt,yt.next)>=0||(yt=yt.prevZ,_t.x>=ut&&_t.x<=dt&&_t.y>=ft&&_t.y<=pt&&_t!==nt&&_t!==it&&pointInTriangle$1(st,lt,ot,ct,at,ht,_t.x,_t.y)&&area$1(_t.prev,_t,_t.next)>=0))return!1;_t=_t.nextZ}for(;yt&&yt.z>=mt;){if(yt.x>=ut&&yt.x<=dt&&yt.y>=ft&&yt.y<=pt&&yt!==nt&&yt!==it&&pointInTriangle$1(st,lt,ot,ct,at,ht,yt.x,yt.y)&&area$1(yt.prev,yt,yt.next)>=0)return!1;yt=yt.prevZ}for(;_t&&_t.z<=vt;){if(_t.x>=ut&&_t.x<=dt&&_t.y>=ft&&_t.y<=pt&&_t!==nt&&_t!==it&&pointInTriangle$1(st,lt,ot,ct,at,ht,_t.x,_t.y)&&area$1(_t.prev,_t,_t.next)>=0)return!1;_t=_t.nextZ}return!0}function cureLocalIntersections$1(et,_,_e){let tt=et;do{const nt=tt.prev,rt=tt.next.next;!equals$1(nt,rt)&&intersects$1(nt,tt,tt.next,rt)&&locallyInside$1(nt,rt)&&locallyInside$1(rt,nt)&&(_.push(nt.i/_e|0),_.push(tt.i/_e|0),_.push(rt.i/_e|0),removeNode$1(tt),removeNode$1(tt.next),tt=et=rt),tt=tt.next}while(tt!==et);return filterPoints$1(tt)}function splitEarcut$1(et,_,_e,tt,nt,rt){let it=et;do{let st=it.next.next;for(;st!==it.prev;){if(it.i!==st.i&&isValidDiagonal$1(it,st)){let ot=splitPolygon$1(it,st);it=filterPoints$1(it,it.next),ot=filterPoints$1(ot,ot.next),earcutLinked$1(it,_,_e,tt,nt,rt,0),earcutLinked$1(ot,_,_e,tt,nt,rt,0);return}st=st.next}it=it.next}while(it!==et)}function eliminateHoles$1(et,_,_e,tt){const nt=[];let rt,it,st,ot,at;for(rt=0,it=_.length;rt<it;rt++)st=_[rt]*tt,ot=rt<it-1?_[rt+1]*tt:et.length,at=linkedList$1(et,st,ot,tt,!1),at===at.next&&(at.steiner=!0),nt.push(getLeftmost$1(at));for(nt.sort(compareX$1),rt=0;rt<nt.length;rt++)_e=eliminateHole$1(nt[rt],_e);return _e}function compareX$1(et,_){return et.x-_.x}function eliminateHole$1(et,_){const _e=findHoleBridge$1(et,_);if(!_e)return _;const tt=splitPolygon$1(_e,et);return filterPoints$1(tt,tt.next),filterPoints$1(_e,_e.next)}function findHoleBridge$1(et,_){let _e=_,tt=-1/0,nt;const rt=et.x,it=et.y;do{if(it<=_e.y&&it>=_e.next.y&&_e.next.y!==_e.y){const ht=_e.x+(it-_e.y)*(_e.next.x-_e.x)/(_e.next.y-_e.y);if(ht<=rt&&ht>tt&&(tt=ht,nt=_e.x<_e.next.x?_e:_e.next,ht===rt))return nt}_e=_e.next}while(_e!==_);if(!nt)return null;const st=nt,ot=nt.x,at=nt.y;let lt=1/0,ct;_e=nt;do rt>=_e.x&&_e.x>=ot&&rt!==_e.x&&pointInTriangle$1(it<at?rt:tt,it,ot,at,it<at?tt:rt,it,_e.x,_e.y)&&(ct=Math.abs(it-_e.y)/(rt-_e.x),locallyInside$1(_e,et)&&(ct<lt||ct===lt&&(_e.x>nt.x||_e.x===nt.x&&sectorContainsSector$1(nt,_e)))&&(nt=_e,lt=ct)),_e=_e.next;while(_e!==st);return nt}function sectorContainsSector$1(et,_){return area$1(et.prev,et,_.prev)<0&&area$1(_.next,et,et.next)<0}function indexCurve$1(et,_,_e,tt){let nt=et;do nt.z===0&&(nt.z=zOrder$1(nt.x,nt.y,_,_e,tt)),nt.prevZ=nt.prev,nt.nextZ=nt.next,nt=nt.next;while(nt!==et);nt.prevZ.nextZ=null,nt.prevZ=null,sortLinked$1(nt)}function sortLinked$1(et){let _,_e,tt,nt,rt,it,st,ot,at=1;do{for(_e=et,et=null,rt=null,it=0;_e;){for(it++,tt=_e,st=0,_=0;_<at&&(st++,tt=tt.nextZ,!!tt);_++);for(ot=at;st>0||ot>0&&tt;)st!==0&&(ot===0||!tt||_e.z<=tt.z)?(nt=_e,_e=_e.nextZ,st--):(nt=tt,tt=tt.nextZ,ot--),rt?rt.nextZ=nt:et=nt,nt.prevZ=rt,rt=nt;_e=tt}rt.nextZ=null,at*=2}while(it>1);return et}function zOrder$1(et,_,_e,tt,nt){return et=(et-_e)*nt|0,_=(_-tt)*nt|0,et=(et|et<<8)&16711935,et=(et|et<<4)&252645135,et=(et|et<<2)&858993459,et=(et|et<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,et|_<<1}function getLeftmost$1(et){let _=et,_e=et;do(_.x<_e.x||_.x===_e.x&&_.y<_e.y)&&(_e=_),_=_.next;while(_!==et);return _e}function pointInTriangle$1(et,_,_e,tt,nt,rt,it,st){return(nt-it)*(_-st)>=(et-it)*(rt-st)&&(et-it)*(tt-st)>=(_e-it)*(_-st)&&(_e-it)*(rt-st)>=(nt-it)*(tt-st)}function isValidDiagonal$1(et,_){return et.next.i!==_.i&&et.prev.i!==_.i&&!intersectsPolygon$1(et,_)&&(locallyInside$1(et,_)&&locallyInside$1(_,et)&&middleInside$1(et,_)&&(area$1(et.prev,et,_.prev)||area$1(et,_.prev,_))||equals$1(et,_)&&area$1(et.prev,et,et.next)>0&&area$1(_.prev,_,_.next)>0)}function area$1(et,_,_e){return(_.y-et.y)*(_e.x-_.x)-(_.x-et.x)*(_e.y-_.y)}function equals$1(et,_){return et.x===_.x&&et.y===_.y}function intersects$1(et,_,_e,tt){const nt=sign$1(area$1(et,_,_e)),rt=sign$1(area$1(et,_,tt)),it=sign$1(area$1(_e,tt,et)),st=sign$1(area$1(_e,tt,_));return!!(nt!==rt&&it!==st||nt===0&&onSegment$1(et,_e,_)||rt===0&&onSegment$1(et,tt,_)||it===0&&onSegment$1(_e,et,tt)||st===0&&onSegment$1(_e,_,tt))}function onSegment$1(et,_,_e){return _.x<=Math.max(et.x,_e.x)&&_.x>=Math.min(et.x,_e.x)&&_.y<=Math.max(et.y,_e.y)&&_.y>=Math.min(et.y,_e.y)}function sign$1(et){return et>0?1:et<0?-1:0}function intersectsPolygon$1(et,_){let _e=et;do{if(_e.i!==et.i&&_e.next.i!==et.i&&_e.i!==_.i&&_e.next.i!==_.i&&intersects$1(_e,_e.next,et,_))return!0;_e=_e.next}while(_e!==et);return!1}function locallyInside$1(et,_){return area$1(et.prev,et,et.next)<0?area$1(et,_,et.next)>=0&&area$1(et,et.prev,_)>=0:area$1(et,_,et.prev)<0||area$1(et,et.next,_)<0}function middleInside$1(et,_){let _e=et,tt=!1;const nt=(et.x+_.x)/2,rt=(et.y+_.y)/2;do _e.y>rt!=_e.next.y>rt&&_e.next.y!==_e.y&&nt<(_e.next.x-_e.x)*(rt-_e.y)/(_e.next.y-_e.y)+_e.x&&(tt=!tt),_e=_e.next;while(_e!==et);return tt}function splitPolygon$1(et,_){const _e=new Node$2(et.i,et.x,et.y),tt=new Node$2(_.i,_.x,_.y),nt=et.next,rt=_.prev;return et.next=_,_.prev=et,_e.next=nt,nt.prev=_e,tt.next=_e,_e.prev=tt,rt.next=tt,tt.prev=rt,tt}function insertNode$1(et,_,_e,tt){const nt=new Node$2(et,_,_e);return tt?(nt.next=tt.next,nt.prev=tt,tt.next.prev=nt,tt.next=nt):(nt.prev=nt,nt.next=nt),nt}function removeNode$1(et){et.next.prev=et.prev,et.prev.next=et.next,et.prevZ&&(et.prevZ.nextZ=et.nextZ),et.nextZ&&(et.nextZ.prevZ=et.prevZ)}function Node$2(et,_,_e){this.i=et,this.x=_,this.y=_e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea$1(et,_,_e,tt){let nt=0;for(let rt=_,it=_e-tt;rt<_e;rt+=tt)nt+=(et[it]-et[rt])*(et[rt+1]+et[it+1]),it=rt;return nt}class ShapeUtils{static area(_){const _e=_.length;let tt=0;for(let nt=_e-1,rt=0;rt<_e;nt=rt++)tt+=_[nt].x*_[rt].y-_[rt].x*_[nt].y;return tt*.5}static isClockWise(_){return ShapeUtils.area(_)<0}static triangulateShape(_,_e){const tt=[],nt=[],rt=[];removeDupEndPts(_),addContour(tt,_);let it=_.length;_e.forEach(removeDupEndPts);for(let ot=0;ot<_e.length;ot++)nt.push(it),it+=_e[ot].length,addContour(tt,_e[ot]);const st=Earcut.triangulate(tt,nt);for(let ot=0;ot<st.length;ot+=3)rt.push(st.slice(ot,ot+3));return rt}}function removeDupEndPts(et){const _=et.length;_>2&&et[_-1].equals(et[0])&&et.pop()}function addContour(et,_){for(let _e=0;_e<_.length;_e++)et.push(_[_e].x),et.push(_[_e].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_=new Shape$1([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),_e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_,options:_e},_=Array.isArray(_)?_:[_];const tt=this,nt=[],rt=[];for(let st=0,ot=_.length;st<ot;st++){const at=_[st];it(at)}this.setAttribute("position",new Float32BufferAttribute(nt,3)),this.setAttribute("uv",new Float32BufferAttribute(rt,2)),this.computeVertexNormals();function it(st){const ot=[],at=_e.curveSegments!==void 0?_e.curveSegments:12,lt=_e.steps!==void 0?_e.steps:1,ct=_e.depth!==void 0?_e.depth:1;let ht=_e.bevelEnabled!==void 0?_e.bevelEnabled:!0,ut=_e.bevelThickness!==void 0?_e.bevelThickness:.2,ft=_e.bevelSize!==void 0?_e.bevelSize:ut-.1,dt=_e.bevelOffset!==void 0?_e.bevelOffset:0,pt=_e.bevelSegments!==void 0?_e.bevelSegments:3;const mt=_e.extrudePath,vt=_e.UVGenerator!==void 0?_e.UVGenerator:WorldUVGenerator;let yt,_t=!1,St,bt,Et,Mt;mt&&(yt=mt.getSpacedPoints(lt),_t=!0,ht=!1,St=mt.computeFrenetFrames(lt,!1),bt=new Vector3,Et=new Vector3,Mt=new Vector3),ht||(pt=0,ut=0,ft=0,dt=0);const Tt=st.extractPoints(at);let wt=Tt.shape;const Ct=Tt.holes;if(!ShapeUtils.isClockWise(wt)){wt=wt.reverse();for(let Vt=0,fn=Ct.length;Vt<fn;Vt++){const ln=Ct[Vt];ShapeUtils.isClockWise(ln)&&(Ct[Vt]=ln.reverse())}}const It=ShapeUtils.triangulateShape(wt,Ct),Dt=wt;for(let Vt=0,fn=Ct.length;Vt<fn;Vt++){const ln=Ct[Vt];wt=wt.concat(ln)}function Ft(Vt,fn,ln){return fn||console.error("THREE.ExtrudeGeometry: vec does not exist"),Vt.clone().addScaledVector(fn,ln)}const $t=wt.length,Yt=It.length;function Lt(Vt,fn,ln){let Jt,on,_n;const cn=Vt.x-fn.x,tn=Vt.y-fn.y,Wt=ln.x-Vt.x,Bt=ln.y-Vt.y,nn=cn*cn+tn*tn,en=cn*Bt-tn*Wt;if(Math.abs(en)>Number.EPSILON){const mn=Math.sqrt(nn),sn=Math.sqrt(Wt*Wt+Bt*Bt),xn=fn.x-tn/mn,an=fn.y+cn/mn,pn=ln.x-Bt/sn,Sn=ln.y+Wt/sn,gn=((pn-xn)*Bt-(Sn-an)*Wt)/(cn*Bt-tn*Wt);Jt=xn+cn*gn-Vt.x,on=an+tn*gn-Vt.y;const Rn=Jt*Jt+on*on;if(Rn<=2)return new Vector2(Jt,on);_n=Math.sqrt(Rn/2)}else{let mn=!1;cn>Number.EPSILON?Wt>Number.EPSILON&&(mn=!0):cn<-Number.EPSILON?Wt<-Number.EPSILON&&(mn=!0):Math.sign(tn)===Math.sign(Bt)&&(mn=!0),mn?(Jt=-tn,on=cn,_n=Math.sqrt(nn)):(Jt=cn,on=tn,_n=Math.sqrt(nn/2))}return new Vector2(Jt/_n,on/_n)}const Ot=[];for(let Vt=0,fn=Dt.length,ln=fn-1,Jt=Vt+1;Vt<fn;Vt++,ln++,Jt++)ln===fn&&(ln=0),Jt===fn&&(Jt=0),Ot[Vt]=Lt(Dt[Vt],Dt[ln],Dt[Jt]);const Nt=[];let zt,Ht=Ot.concat();for(let Vt=0,fn=Ct.length;Vt<fn;Vt++){const ln=Ct[Vt];zt=[];for(let Jt=0,on=ln.length,_n=on-1,cn=Jt+1;Jt<on;Jt++,_n++,cn++)_n===on&&(_n=0),cn===on&&(cn=0),zt[Jt]=Lt(ln[Jt],ln[_n],ln[cn]);Nt.push(zt),Ht=Ht.concat(zt)}for(let Vt=0;Vt<pt;Vt++){const fn=Vt/pt,ln=ut*Math.cos(fn*Math.PI/2),Jt=ft*Math.sin(fn*Math.PI/2)+dt;for(let on=0,_n=Dt.length;on<_n;on++){const cn=Ft(Dt[on],Ot[on],Jt);Qt(cn.x,cn.y,-ln)}for(let on=0,_n=Ct.length;on<_n;on++){const cn=Ct[on];zt=Nt[on];for(let tn=0,Wt=cn.length;tn<Wt;tn++){const Bt=Ft(cn[tn],zt[tn],Jt);Qt(Bt.x,Bt.y,-ln)}}}const qt=ft+dt;for(let Vt=0;Vt<$t;Vt++){const fn=ht?Ft(wt[Vt],Ht[Vt],qt):wt[Vt];_t?(Et.copy(St.normals[0]).multiplyScalar(fn.x),bt.copy(St.binormals[0]).multiplyScalar(fn.y),Mt.copy(yt[0]).add(Et).add(bt),Qt(Mt.x,Mt.y,Mt.z)):Qt(fn.x,fn.y,0)}for(let Vt=1;Vt<=lt;Vt++)for(let fn=0;fn<$t;fn++){const ln=ht?Ft(wt[fn],Ht[fn],qt):wt[fn];_t?(Et.copy(St.normals[Vt]).multiplyScalar(ln.x),bt.copy(St.binormals[Vt]).multiplyScalar(ln.y),Mt.copy(yt[Vt]).add(Et).add(bt),Qt(Mt.x,Mt.y,Mt.z)):Qt(ln.x,ln.y,ct/lt*Vt)}for(let Vt=pt-1;Vt>=0;Vt--){const fn=Vt/pt,ln=ut*Math.cos(fn*Math.PI/2),Jt=ft*Math.sin(fn*Math.PI/2)+dt;for(let on=0,_n=Dt.length;on<_n;on++){const cn=Ft(Dt[on],Ot[on],Jt);Qt(cn.x,cn.y,ct+ln)}for(let on=0,_n=Ct.length;on<_n;on++){const cn=Ct[on];zt=Nt[on];for(let tn=0,Wt=cn.length;tn<Wt;tn++){const Bt=Ft(cn[tn],zt[tn],Jt);_t?Qt(Bt.x,Bt.y+yt[lt-1].y,yt[lt-1].x+ln):Qt(Bt.x,Bt.y,ct+ln)}}}Gt(),Xt();function Gt(){const Vt=nt.length/3;if(ht){let fn=0,ln=$t*fn;for(let Jt=0;Jt<Yt;Jt++){const on=It[Jt];un(on[2]+ln,on[1]+ln,on[0]+ln)}fn=lt+pt*2,ln=$t*fn;for(let Jt=0;Jt<Yt;Jt++){const on=It[Jt];un(on[0]+ln,on[1]+ln,on[2]+ln)}}else{for(let fn=0;fn<Yt;fn++){const ln=It[fn];un(ln[2],ln[1],ln[0])}for(let fn=0;fn<Yt;fn++){const ln=It[fn];un(ln[0]+$t*lt,ln[1]+$t*lt,ln[2]+$t*lt)}}tt.addGroup(Vt,nt.length/3-Vt,0)}function Xt(){const Vt=nt.length/3;let fn=0;Zt(Dt,fn),fn+=Dt.length;for(let ln=0,Jt=Ct.length;ln<Jt;ln++){const on=Ct[ln];Zt(on,fn),fn+=on.length}tt.addGroup(Vt,nt.length/3-Vt,1)}function Zt(Vt,fn){let ln=Vt.length;for(;--ln>=0;){const Jt=ln;let on=ln-1;on<0&&(on=Vt.length-1);for(let _n=0,cn=lt+pt*2;_n<cn;_n++){const tn=$t*_n,Wt=$t*(_n+1),Bt=fn+Jt+tn,nn=fn+on+tn,en=fn+on+Wt,mn=fn+Jt+Wt;wn(Bt,nn,en,mn)}}}function Qt(Vt,fn,ln){ot.push(Vt),ot.push(fn),ot.push(ln)}function un(Vt,fn,ln){Tn(Vt),Tn(fn),Tn(ln);const Jt=nt.length/3,on=vt.generateTopUV(tt,nt,Jt-3,Jt-2,Jt-1);yn(on[0]),yn(on[1]),yn(on[2])}function wn(Vt,fn,ln,Jt){Tn(Vt),Tn(fn),Tn(Jt),Tn(fn),Tn(ln),Tn(Jt);const on=nt.length/3,_n=vt.generateSideWallUV(tt,nt,on-6,on-3,on-2,on-1);yn(_n[0]),yn(_n[1]),yn(_n[3]),yn(_n[1]),yn(_n[2]),yn(_n[3])}function Tn(Vt){nt.push(ot[Vt*3+0]),nt.push(ot[Vt*3+1]),nt.push(ot[Vt*3+2])}function yn(Vt){rt.push(Vt.x),rt.push(Vt.y)}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),_e=this.parameters.shapes,tt=this.parameters.options;return toJSON$1(_e,tt,_)}static fromJSON(_,_e){const tt=[];for(let rt=0,it=_.shapes.length;rt<it;rt++){const st=_e[_.shapes[rt]];tt.push(st)}const nt=_.options.extrudePath;return nt!==void 0&&(_.options.extrudePath=new Curves[nt.type]().fromJSON(nt)),new ExtrudeGeometry(tt,_.options)}}const WorldUVGenerator={generateTopUV:function(et,_,_e,tt,nt){const rt=_[_e*3],it=_[_e*3+1],st=_[tt*3],ot=_[tt*3+1],at=_[nt*3],lt=_[nt*3+1];return[new Vector2(rt,it),new Vector2(st,ot),new Vector2(at,lt)]},generateSideWallUV:function(et,_,_e,tt,nt,rt){const it=_[_e*3],st=_[_e*3+1],ot=_[_e*3+2],at=_[tt*3],lt=_[tt*3+1],ct=_[tt*3+2],ht=_[nt*3],ut=_[nt*3+1],ft=_[nt*3+2],dt=_[rt*3],pt=_[rt*3+1],mt=_[rt*3+2];return Math.abs(st-lt)<Math.abs(it-at)?[new Vector2(it,1-ot),new Vector2(at,1-ct),new Vector2(ht,1-ft),new Vector2(dt,1-mt)]:[new Vector2(st,1-ot),new Vector2(lt,1-ct),new Vector2(ut,1-ft),new Vector2(pt,1-mt)]}};function toJSON$1(et,_,_e){if(_e.shapes=[],Array.isArray(et))for(let tt=0,nt=et.length;tt<nt;tt++){const rt=et[tt];_e.shapes.push(rt.uuid)}else _e.shapes.push(et.uuid);return _e.options=Object.assign({},_),_.extrudePath!==void 0&&(_e.options.extrudePath=_.extrudePath.toJSON()),_e}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_=1,_e=0){const tt=(1+Math.sqrt(5))/2,nt=[-1,tt,0,1,tt,0,-1,-tt,0,1,-tt,0,0,-1,tt,0,1,tt,0,-1,-tt,0,1,-tt,tt,0,-1,tt,0,1,-tt,0,-1,-tt,0,1],rt=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(nt,rt,_,_e),this.type="IcosahedronGeometry",this.parameters={radius:_,detail:_e}}static fromJSON(_){return new IcosahedronGeometry(_.radius,_.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_=1,_e=0){const tt=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],nt=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(tt,nt,_,_e),this.type="OctahedronGeometry",this.parameters={radius:_,detail:_e}}static fromJSON(_){return new OctahedronGeometry(_.radius,_.detail)}}class RingGeometry extends BufferGeometry{constructor(_=.5,_e=1,tt=32,nt=1,rt=0,it=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_,outerRadius:_e,thetaSegments:tt,phiSegments:nt,thetaStart:rt,thetaLength:it},tt=Math.max(3,tt),nt=Math.max(1,nt);const st=[],ot=[],at=[],lt=[];let ct=_;const ht=(_e-_)/nt,ut=new Vector3,ft=new Vector2;for(let dt=0;dt<=nt;dt++){for(let pt=0;pt<=tt;pt++){const mt=rt+pt/tt*it;ut.x=ct*Math.cos(mt),ut.y=ct*Math.sin(mt),ot.push(ut.x,ut.y,ut.z),at.push(0,0,1),ft.x=(ut.x/_e+1)/2,ft.y=(ut.y/_e+1)/2,lt.push(ft.x,ft.y)}ct+=ht}for(let dt=0;dt<nt;dt++){const pt=dt*(tt+1);for(let mt=0;mt<tt;mt++){const vt=mt+pt,yt=vt,_t=vt+tt+1,St=vt+tt+2,bt=vt+1;st.push(yt,_t,bt),st.push(_t,St,bt)}}this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(at,3)),this.setAttribute("uv",new Float32BufferAttribute(lt,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new RingGeometry(_.innerRadius,_.outerRadius,_.thetaSegments,_.phiSegments,_.thetaStart,_.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_=new Shape$1([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),_e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_,curveSegments:_e};const tt=[],nt=[],rt=[],it=[];let st=0,ot=0;if(Array.isArray(_)===!1)at(_);else for(let lt=0;lt<_.length;lt++)at(_[lt]),this.addGroup(st,ot,lt),st+=ot,ot=0;this.setIndex(tt),this.setAttribute("position",new Float32BufferAttribute(nt,3)),this.setAttribute("normal",new Float32BufferAttribute(rt,3)),this.setAttribute("uv",new Float32BufferAttribute(it,2));function at(lt){const ct=nt.length/3,ht=lt.extractPoints(_e);let ut=ht.shape;const ft=ht.holes;ShapeUtils.isClockWise(ut)===!1&&(ut=ut.reverse());for(let pt=0,mt=ft.length;pt<mt;pt++){const vt=ft[pt];ShapeUtils.isClockWise(vt)===!0&&(ft[pt]=vt.reverse())}const dt=ShapeUtils.triangulateShape(ut,ft);for(let pt=0,mt=ft.length;pt<mt;pt++){const vt=ft[pt];ut=ut.concat(vt)}for(let pt=0,mt=ut.length;pt<mt;pt++){const vt=ut[pt];nt.push(vt.x,vt.y,0),rt.push(0,0,1),it.push(vt.x,vt.y)}for(let pt=0,mt=dt.length;pt<mt;pt++){const vt=dt[pt],yt=vt[0]+ct,_t=vt[1]+ct,St=vt[2]+ct;tt.push(yt,_t,St),ot+=3}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),_e=this.parameters.shapes;return toJSON(_e,_)}static fromJSON(_,_e){const tt=[];for(let nt=0,rt=_.shapes.length;nt<rt;nt++){const it=_e[_.shapes[nt]];tt.push(it)}return new ShapeGeometry(tt,_.curveSegments)}}function toJSON(et,_){if(_.shapes=[],Array.isArray(et))for(let _e=0,tt=et.length;_e<tt;_e++){const nt=et[_e];_.shapes.push(nt.uuid)}else _.shapes.push(et.uuid);return _}class SphereGeometry extends BufferGeometry{constructor(_=1,_e=32,tt=16,nt=0,rt=Math.PI*2,it=0,st=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_,widthSegments:_e,heightSegments:tt,phiStart:nt,phiLength:rt,thetaStart:it,thetaLength:st},_e=Math.max(3,Math.floor(_e)),tt=Math.max(2,Math.floor(tt));const ot=Math.min(it+st,Math.PI);let at=0;const lt=[],ct=new Vector3,ht=new Vector3,ut=[],ft=[],dt=[],pt=[];for(let mt=0;mt<=tt;mt++){const vt=[],yt=mt/tt;let _t=0;mt===0&&it===0?_t=.5/_e:mt===tt&&ot===Math.PI&&(_t=-.5/_e);for(let St=0;St<=_e;St++){const bt=St/_e;ct.x=-_*Math.cos(nt+bt*rt)*Math.sin(it+yt*st),ct.y=_*Math.cos(it+yt*st),ct.z=_*Math.sin(nt+bt*rt)*Math.sin(it+yt*st),ft.push(ct.x,ct.y,ct.z),ht.copy(ct).normalize(),dt.push(ht.x,ht.y,ht.z),pt.push(bt+_t,1-yt),vt.push(at++)}lt.push(vt)}for(let mt=0;mt<tt;mt++)for(let vt=0;vt<_e;vt++){const yt=lt[mt][vt+1],_t=lt[mt][vt],St=lt[mt+1][vt],bt=lt[mt+1][vt+1];(mt!==0||it>0)&&ut.push(yt,_t,bt),(mt!==tt-1||ot<Math.PI)&&ut.push(_t,St,bt)}this.setIndex(ut),this.setAttribute("position",new Float32BufferAttribute(ft,3)),this.setAttribute("normal",new Float32BufferAttribute(dt,3)),this.setAttribute("uv",new Float32BufferAttribute(pt,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new SphereGeometry(_.radius,_.widthSegments,_.heightSegments,_.phiStart,_.phiLength,_.thetaStart,_.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_=1,_e=0){const tt=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],nt=[2,1,0,0,3,2,1,3,0,2,3,1];super(tt,nt,_,_e),this.type="TetrahedronGeometry",this.parameters={radius:_,detail:_e}}static fromJSON(_){return new TetrahedronGeometry(_.radius,_.detail)}}class TorusGeometry extends BufferGeometry{constructor(_=1,_e=.4,tt=12,nt=48,rt=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_,tube:_e,radialSegments:tt,tubularSegments:nt,arc:rt},tt=Math.floor(tt),nt=Math.floor(nt);const it=[],st=[],ot=[],at=[],lt=new Vector3,ct=new Vector3,ht=new Vector3;for(let ut=0;ut<=tt;ut++)for(let ft=0;ft<=nt;ft++){const dt=ft/nt*rt,pt=ut/tt*Math.PI*2;ct.x=(_+_e*Math.cos(pt))*Math.cos(dt),ct.y=(_+_e*Math.cos(pt))*Math.sin(dt),ct.z=_e*Math.sin(pt),st.push(ct.x,ct.y,ct.z),lt.x=_*Math.cos(dt),lt.y=_*Math.sin(dt),ht.subVectors(ct,lt).normalize(),ot.push(ht.x,ht.y,ht.z),at.push(ft/nt),at.push(ut/tt)}for(let ut=1;ut<=tt;ut++)for(let ft=1;ft<=nt;ft++){const dt=(nt+1)*ut+ft-1,pt=(nt+1)*(ut-1)+ft-1,mt=(nt+1)*(ut-1)+ft,vt=(nt+1)*ut+ft;it.push(dt,pt,vt),it.push(pt,mt,vt)}this.setIndex(it),this.setAttribute("position",new Float32BufferAttribute(st,3)),this.setAttribute("normal",new Float32BufferAttribute(ot,3)),this.setAttribute("uv",new Float32BufferAttribute(at,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusGeometry(_.radius,_.tube,_.radialSegments,_.tubularSegments,_.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_=1,_e=.4,tt=64,nt=8,rt=2,it=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_,tube:_e,tubularSegments:tt,radialSegments:nt,p:rt,q:it},tt=Math.floor(tt),nt=Math.floor(nt);const st=[],ot=[],at=[],lt=[],ct=new Vector3,ht=new Vector3,ut=new Vector3,ft=new Vector3,dt=new Vector3,pt=new Vector3,mt=new Vector3;for(let yt=0;yt<=tt;++yt){const _t=yt/tt*rt*Math.PI*2;vt(_t,rt,it,_,ut),vt(_t+.01,rt,it,_,ft),pt.subVectors(ft,ut),mt.addVectors(ft,ut),dt.crossVectors(pt,mt),mt.crossVectors(dt,pt),dt.normalize(),mt.normalize();for(let St=0;St<=nt;++St){const bt=St/nt*Math.PI*2,Et=-_e*Math.cos(bt),Mt=_e*Math.sin(bt);ct.x=ut.x+(Et*mt.x+Mt*dt.x),ct.y=ut.y+(Et*mt.y+Mt*dt.y),ct.z=ut.z+(Et*mt.z+Mt*dt.z),ot.push(ct.x,ct.y,ct.z),ht.subVectors(ct,ut).normalize(),at.push(ht.x,ht.y,ht.z),lt.push(yt/tt),lt.push(St/nt)}}for(let yt=1;yt<=tt;yt++)for(let _t=1;_t<=nt;_t++){const St=(nt+1)*(yt-1)+(_t-1),bt=(nt+1)*yt+(_t-1),Et=(nt+1)*yt+_t,Mt=(nt+1)*(yt-1)+_t;st.push(St,bt,Mt),st.push(bt,Et,Mt)}this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(at,3)),this.setAttribute("uv",new Float32BufferAttribute(lt,2));function vt(yt,_t,St,bt,Et){const Mt=Math.cos(yt),Tt=Math.sin(yt),wt=St/_t*yt,Ct=Math.cos(wt);Et.x=bt*(2+Ct)*.5*Mt,Et.y=bt*(2+Ct)*Tt*.5,Et.z=bt*Math.sin(wt)*.5}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusKnotGeometry(_.radius,_.tube,_.tubularSegments,_.radialSegments,_.p,_.q)}}class TubeGeometry extends BufferGeometry{constructor(_=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),_e=64,tt=1,nt=8,rt=!1){super(),this.type="TubeGeometry",this.parameters={path:_,tubularSegments:_e,radius:tt,radialSegments:nt,closed:rt};const it=_.computeFrenetFrames(_e,rt);this.tangents=it.tangents,this.normals=it.normals,this.binormals=it.binormals;const st=new Vector3,ot=new Vector3,at=new Vector2;let lt=new Vector3;const ct=[],ht=[],ut=[],ft=[];dt(),this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute(ct,3)),this.setAttribute("normal",new Float32BufferAttribute(ht,3)),this.setAttribute("uv",new Float32BufferAttribute(ut,2));function dt(){for(let yt=0;yt<_e;yt++)pt(yt);pt(rt===!1?_e:0),vt(),mt()}function pt(yt){lt=_.getPointAt(yt/_e,lt);const _t=it.normals[yt],St=it.binormals[yt];for(let bt=0;bt<=nt;bt++){const Et=bt/nt*Math.PI*2,Mt=Math.sin(Et),Tt=-Math.cos(Et);ot.x=Tt*_t.x+Mt*St.x,ot.y=Tt*_t.y+Mt*St.y,ot.z=Tt*_t.z+Mt*St.z,ot.normalize(),ht.push(ot.x,ot.y,ot.z),st.x=lt.x+tt*ot.x,st.y=lt.y+tt*ot.y,st.z=lt.z+tt*ot.z,ct.push(st.x,st.y,st.z)}}function mt(){for(let yt=1;yt<=_e;yt++)for(let _t=1;_t<=nt;_t++){const St=(nt+1)*(yt-1)+(_t-1),bt=(nt+1)*yt+(_t-1),Et=(nt+1)*yt+_t,Mt=(nt+1)*(yt-1)+_t;ft.push(St,bt,Mt),ft.push(bt,Et,Mt)}}function vt(){for(let yt=0;yt<=_e;yt++)for(let _t=0;_t<=nt;_t++)at.x=yt/_e,at.y=_t/nt,ut.push(at.x,at.y)}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON();return _.path=this.parameters.path.toJSON(),_}static fromJSON(_){return new TubeGeometry(new Curves[_.path.type]().fromJSON(_.path),_.tubularSegments,_.radius,_.radialSegments,_.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_},_!==null){const _e=[],tt=new Set,nt=new Vector3,rt=new Vector3;if(_.index!==null){const it=_.attributes.position,st=_.index;let ot=_.groups;ot.length===0&&(ot=[{start:0,count:st.count,materialIndex:0}]);for(let at=0,lt=ot.length;at<lt;++at){const ct=ot[at],ht=ct.start,ut=ct.count;for(let ft=ht,dt=ht+ut;ft<dt;ft+=3)for(let pt=0;pt<3;pt++){const mt=st.getX(ft+pt),vt=st.getX(ft+(pt+1)%3);nt.fromBufferAttribute(it,mt),rt.fromBufferAttribute(it,vt),isUniqueEdge(nt,rt,tt)===!0&&(_e.push(nt.x,nt.y,nt.z),_e.push(rt.x,rt.y,rt.z))}}}else{const it=_.attributes.position;for(let st=0,ot=it.count/3;st<ot;st++)for(let at=0;at<3;at++){const lt=3*st+at,ct=3*st+(at+1)%3;nt.fromBufferAttribute(it,lt),rt.fromBufferAttribute(it,ct),isUniqueEdge(nt,rt,tt)===!0&&(_e.push(nt.x,nt.y,nt.z),_e.push(rt.x,rt.y,rt.z))}}this.setAttribute("position",new Float32BufferAttribute(_e,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}function isUniqueEdge(et,_,_e){const tt=`${et.x},${et.y},${et.z}-${_.x},${_.y},${_.z}`,nt=`${_.x},${_.y},${_.z}-${et.x},${et.y},${et.z}`;return _e.has(tt)===!0||_e.has(nt)===!0?!1:(_e.add(tt),_e.add(nt),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color$1(0),this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.fog=_.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_){super(_),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color$1(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={STANDARD:""},this.color.copy(_.color),this.roughness=_.roughness,this.metalness=_.metalness,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.roughnessMap=_.roughnessMap,this.metalnessMap=_.metalnessMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.envMapIntensity=_.envMapIntensity,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$1(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(_e){this.ior=(1+.4*_e)/(1-.4*_e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color$1(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color$1(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color$1(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_)}get anisotropy(){return this._anisotropy}set anisotropy(_){this._anisotropy>0!=_>0&&this.version++,this._anisotropy=_}get clearcoat(){return this._clearcoat}set clearcoat(_){this._clearcoat>0!=_>0&&this.version++,this._clearcoat=_}get iridescence(){return this._iridescence}set iridescence(_){this._iridescence>0!=_>0&&this.version++,this._iridescence=_}get dispersion(){return this._dispersion}set dispersion(_){this._dispersion>0!=_>0&&this.version++,this._dispersion=_}get sheen(){return this._sheen}set sheen(_){this._sheen>0!=_>0&&this.version++,this._sheen=_}get transmission(){return this._transmission}set transmission(_){this._transmission>0!=_>0&&this.version++,this._transmission=_}copy(_){return super.copy(_),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_.anisotropy,this.anisotropyRotation=_.anisotropyRotation,this.anisotropyMap=_.anisotropyMap,this.clearcoat=_.clearcoat,this.clearcoatMap=_.clearcoatMap,this.clearcoatRoughness=_.clearcoatRoughness,this.clearcoatRoughnessMap=_.clearcoatRoughnessMap,this.clearcoatNormalMap=_.clearcoatNormalMap,this.clearcoatNormalScale.copy(_.clearcoatNormalScale),this.dispersion=_.dispersion,this.ior=_.ior,this.iridescence=_.iridescence,this.iridescenceMap=_.iridescenceMap,this.iridescenceIOR=_.iridescenceIOR,this.iridescenceThicknessRange=[..._.iridescenceThicknessRange],this.iridescenceThicknessMap=_.iridescenceThicknessMap,this.sheen=_.sheen,this.sheenColor.copy(_.sheenColor),this.sheenColorMap=_.sheenColorMap,this.sheenRoughness=_.sheenRoughness,this.sheenRoughnessMap=_.sheenRoughnessMap,this.transmission=_.transmission,this.transmissionMap=_.transmissionMap,this.thickness=_.thickness,this.thicknessMap=_.thicknessMap,this.attenuationDistance=_.attenuationDistance,this.attenuationColor.copy(_.attenuationColor),this.specularIntensity=_.specularIntensity,this.specularIntensityMap=_.specularIntensityMap,this.specularColor.copy(_.specularColor),this.specularColorMap=_.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color$1(16777215),this.specular=new Color$1(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.specular.copy(_.specular),this.shininess=_.shininess,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshToonMaterial extends Material{constructor(_){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color$1(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.gradientMap=_.gradientMap,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}class MeshNormalMaterial extends Material{constructor(_){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_)}copy(_){return super.copy(_),this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.flatShading=_.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshMatcapMaterial extends Material{constructor(_){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color$1(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={MATCAP:""},this.color.copy(_.color),this.matcap=_.matcap,this.map=_.map,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.flatShading=_.flatShading,this.fog=_.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_)}copy(_){return super.copy(_),this.scale=_.scale,this.dashSize=_.dashSize,this.gapSize=_.gapSize,this}}function convertArray(et,_,_e){return!et||!_e&&et.constructor===_?et:typeof _.BYTES_PER_ELEMENT=="number"?new _(et):Array.prototype.slice.call(et)}function isTypedArray(et){return ArrayBuffer.isView(et)&&!(et instanceof DataView)}function getKeyframeOrder(et){function _(nt,rt){return et[nt]-et[rt]}const _e=et.length,tt=new Array(_e);for(let nt=0;nt!==_e;++nt)tt[nt]=nt;return tt.sort(_),tt}function sortedArray(et,_,_e){const tt=et.length,nt=new et.constructor(tt);for(let rt=0,it=0;it!==tt;++rt){const st=_e[rt]*_;for(let ot=0;ot!==_;++ot)nt[it++]=et[st+ot]}return nt}function flattenJSON(et,_,_e,tt){let nt=1,rt=et[0];for(;rt!==void 0&&rt[tt]===void 0;)rt=et[nt++];if(rt===void 0)return;let it=rt[tt];if(it!==void 0)if(Array.isArray(it))do it=rt[tt],it!==void 0&&(_.push(rt.time),_e.push.apply(_e,it)),rt=et[nt++];while(rt!==void 0);else if(it.toArray!==void 0)do it=rt[tt],it!==void 0&&(_.push(rt.time),it.toArray(_e,_e.length)),rt=et[nt++];while(rt!==void 0);else do it=rt[tt],it!==void 0&&(_.push(rt.time),_e.push(it)),rt=et[nt++];while(rt!==void 0)}function subclip(et,_,_e,tt,nt=30){const rt=et.clone();rt.name=_;const it=[];for(let ot=0;ot<rt.tracks.length;++ot){const at=rt.tracks[ot],lt=at.getValueSize(),ct=[],ht=[];for(let ut=0;ut<at.times.length;++ut){const ft=at.times[ut]*nt;if(!(ft<_e||ft>=tt)){ct.push(at.times[ut]);for(let dt=0;dt<lt;++dt)ht.push(at.values[ut*lt+dt])}}ct.length!==0&&(at.times=convertArray(ct,at.times.constructor),at.values=convertArray(ht,at.values.constructor),it.push(at))}rt.tracks=it;let st=1/0;for(let ot=0;ot<rt.tracks.length;++ot)st>rt.tracks[ot].times[0]&&(st=rt.tracks[ot].times[0]);for(let ot=0;ot<rt.tracks.length;++ot)rt.tracks[ot].shift(-1*st);return rt.resetDuration(),rt}function makeClipAdditive(et,_=0,_e=et,tt=30){tt<=0&&(tt=30);const nt=_e.tracks.length,rt=_/tt;for(let it=0;it<nt;++it){const st=_e.tracks[it],ot=st.ValueTypeName;if(ot==="bool"||ot==="string")continue;const at=et.tracks.find(function(mt){return mt.name===st.name&&mt.ValueTypeName===ot});if(at===void 0)continue;let lt=0;const ct=st.getValueSize();st.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(lt=ct/3);let ht=0;const ut=at.getValueSize();at.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ht=ut/3);const ft=st.times.length-1;let dt;if(rt<=st.times[0]){const mt=lt,vt=ct-lt;dt=st.values.slice(mt,vt)}else if(rt>=st.times[ft]){const mt=ft*ct+lt,vt=mt+ct-lt;dt=st.values.slice(mt,vt)}else{const mt=st.createInterpolant(),vt=lt,yt=ct-lt;mt.evaluate(rt),dt=mt.resultBuffer.slice(vt,yt)}ot==="quaternion"&&new Quaternion().fromArray(dt).normalize().conjugate().toArray(dt);const pt=at.times.length;for(let mt=0;mt<pt;++mt){const vt=mt*ut+ht;if(ot==="quaternion")Quaternion.multiplyQuaternionsFlat(at.values,vt,dt,0,at.values,vt);else{const yt=ut-ht*2;for(let _t=0;_t<yt;++_t)at.values[vt+_t]-=dt[_t]}}}return et.blendMode=AdditiveAnimationBlendMode,et}const AnimationUtils={convertArray,isTypedArray,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_,_e,tt,nt){this.parameterPositions=_,this._cachedIndex=0,this.resultBuffer=nt!==void 0?nt:new _e.constructor(tt),this.sampleValues=_e,this.valueSize=tt,this.settings=null,this.DefaultSettings_={}}evaluate(_){const _e=this.parameterPositions;let tt=this._cachedIndex,nt=_e[tt],rt=_e[tt-1];e:{t:{let it;n:{r:if(!(_<nt)){for(let st=tt+2;;){if(nt===void 0){if(_<rt)break r;return tt=_e.length,this._cachedIndex=tt,this.copySampleValue_(tt-1)}if(tt===st)break;if(rt=nt,nt=_e[++tt],_<nt)break t}it=_e.length;break n}if(!(_>=rt)){const st=_e[1];_<st&&(tt=2,rt=st);for(let ot=tt-2;;){if(rt===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(tt===ot)break;if(nt=rt,rt=_e[--tt-1],_>=rt)break t}it=tt,tt=0;break n}break e}for(;tt<it;){const st=tt+it>>>1;_<_e[st]?it=st:tt=st+1}if(nt=_e[tt],rt=_e[tt-1],rt===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(nt===void 0)return tt=_e.length,this._cachedIndex=tt,this.copySampleValue_(tt-1)}this._cachedIndex=tt,this.intervalChanged_(tt,rt,nt)}return this.interpolate_(tt,rt,_,nt)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_){const _e=this.resultBuffer,tt=this.sampleValues,nt=this.valueSize,rt=_*nt;for(let it=0;it!==nt;++it)_e[it]=tt[rt+it];return _e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_,_e,tt,nt){super(_,_e,tt,nt),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_,_e,tt){const nt=this.parameterPositions;let rt=_-2,it=_+1,st=nt[rt],ot=nt[it];if(st===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:rt=_,st=2*_e-tt;break;case WrapAroundEnding:rt=nt.length-2,st=_e+nt[rt]-nt[rt+1];break;default:rt=_,st=tt}if(ot===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:it=_,ot=2*tt-_e;break;case WrapAroundEnding:it=1,ot=tt+nt[1]-nt[0];break;default:it=_-1,ot=_e}const at=(tt-_e)*.5,lt=this.valueSize;this._weightPrev=at/(_e-st),this._weightNext=at/(ot-tt),this._offsetPrev=rt*lt,this._offsetNext=it*lt}interpolate_(_,_e,tt,nt){const rt=this.resultBuffer,it=this.sampleValues,st=this.valueSize,ot=_*st,at=ot-st,lt=this._offsetPrev,ct=this._offsetNext,ht=this._weightPrev,ut=this._weightNext,ft=(tt-_e)/(nt-_e),dt=ft*ft,pt=dt*ft,mt=-ht*pt+2*ht*dt-ht*ft,vt=(1+ht)*pt+(-1.5-2*ht)*dt+(-.5+ht)*ft+1,yt=(-1-ut)*pt+(1.5+ut)*dt+.5*ft,_t=ut*pt-ut*dt;for(let St=0;St!==st;++St)rt[St]=mt*it[lt+St]+vt*it[at+St]+yt*it[ot+St]+_t*it[ct+St];return rt}}class LinearInterpolant extends Interpolant{constructor(_,_e,tt,nt){super(_,_e,tt,nt)}interpolate_(_,_e,tt,nt){const rt=this.resultBuffer,it=this.sampleValues,st=this.valueSize,ot=_*st,at=ot-st,lt=(tt-_e)/(nt-_e),ct=1-lt;for(let ht=0;ht!==st;++ht)rt[ht]=it[at+ht]*ct+it[ot+ht]*lt;return rt}}class DiscreteInterpolant extends Interpolant{constructor(_,_e,tt,nt){super(_,_e,tt,nt)}interpolate_(_){return this.copySampleValue_(_-1)}}class KeyframeTrack{constructor(_,_e,tt,nt){if(_===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(_e===void 0||_e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_);this.name=_,this.times=convertArray(_e,this.TimeBufferType),this.values=convertArray(tt,this.ValueBufferType),this.setInterpolation(nt||this.DefaultInterpolation)}static toJSON(_){const _e=_.constructor;let tt;if(_e.toJSON!==this.toJSON)tt=_e.toJSON(_);else{tt={name:_.name,times:convertArray(_.times,Array),values:convertArray(_.values,Array)};const nt=_.getInterpolation();nt!==_.DefaultInterpolation&&(tt.interpolation=nt)}return tt.type=_.ValueTypeName,tt}InterpolantFactoryMethodDiscrete(_){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodLinear(_){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodSmooth(_){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_)}setInterpolation(_){let _e;switch(_){case InterpolateDiscrete:_e=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:_e=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:_e=this.InterpolantFactoryMethodSmooth;break}if(_e===void 0){const tt="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(tt);return console.warn("THREE.KeyframeTrack:",tt),this}return this.createInterpolant=_e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_){if(_!==0){const _e=this.times;for(let tt=0,nt=_e.length;tt!==nt;++tt)_e[tt]+=_}return this}scale(_){if(_!==1){const _e=this.times;for(let tt=0,nt=_e.length;tt!==nt;++tt)_e[tt]*=_}return this}trim(_,_e){const tt=this.times,nt=tt.length;let rt=0,it=nt-1;for(;rt!==nt&&tt[rt]<_;)++rt;for(;it!==-1&&tt[it]>_e;)--it;if(++it,rt!==0||it!==nt){rt>=it&&(it=Math.max(it,1),rt=it-1);const st=this.getValueSize();this.times=tt.slice(rt,it),this.values=this.values.slice(rt*st,it*st)}return this}validate(){let _=!0;const _e=this.getValueSize();_e-Math.floor(_e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_=!1);const tt=this.times,nt=this.values,rt=tt.length;rt===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_=!1);let it=null;for(let st=0;st!==rt;st++){const ot=tt[st];if(typeof ot=="number"&&isNaN(ot)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,st,ot),_=!1;break}if(it!==null&&it>ot){console.error("THREE.KeyframeTrack: Out of order keys.",this,st,ot,it),_=!1;break}it=ot}if(nt!==void 0&&isTypedArray(nt))for(let st=0,ot=nt.length;st!==ot;++st){const at=nt[st];if(isNaN(at)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,st,at),_=!1;break}}return _}optimize(){const _=this.times.slice(),_e=this.values.slice(),tt=this.getValueSize(),nt=this.getInterpolation()===InterpolateSmooth,rt=_.length-1;let it=1;for(let st=1;st<rt;++st){let ot=!1;const at=_[st],lt=_[st+1];if(at!==lt&&(st!==1||at!==_[0]))if(nt)ot=!0;else{const ct=st*tt,ht=ct-tt,ut=ct+tt;for(let ft=0;ft!==tt;++ft){const dt=_e[ct+ft];if(dt!==_e[ht+ft]||dt!==_e[ut+ft]){ot=!0;break}}}if(ot){if(st!==it){_[it]=_[st];const ct=st*tt,ht=it*tt;for(let ut=0;ut!==tt;++ut)_e[ht+ut]=_e[ct+ut]}++it}}if(rt>0){_[it]=_[rt];for(let st=rt*tt,ot=it*tt,at=0;at!==tt;++at)_e[ot+at]=_e[st+at];++it}return it!==_.length?(this.times=_.slice(0,it),this.values=_e.slice(0,it*tt)):(this.times=_,this.values=_e),this}clone(){const _=this.times.slice(),_e=this.values.slice(),tt=this.constructor,nt=new tt(this.name,_,_e);return nt.createInterpolant=this.createInterpolant,nt}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{constructor(_,_e,tt){super(_,_e,tt)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_,_e,tt,nt){super(_,_e,tt,nt)}interpolate_(_,_e,tt,nt){const rt=this.resultBuffer,it=this.sampleValues,st=this.valueSize,ot=(tt-_e)/(nt-_e);let at=_*st;for(let lt=at+st;at!==lt;at+=4)Quaternion.slerpFlat(rt,0,it,at-st,it,at,ot);return rt}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(_,_e,tt){super(_,_e,tt)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_="",_e=-1,tt=[],nt=NormalAnimationBlendMode){this.name=_,this.tracks=tt,this.duration=_e,this.blendMode=nt,this.uuid=generateUUID$1(),this.duration<0&&this.resetDuration()}static parse(_){const _e=[],tt=_.tracks,nt=1/(_.fps||1);for(let it=0,st=tt.length;it!==st;++it)_e.push(parseKeyframeTrack(tt[it]).scale(nt));const rt=new this(_.name,_.duration,_e,_.blendMode);return rt.uuid=_.uuid,rt}static toJSON(_){const _e=[],tt=_.tracks,nt={name:_.name,duration:_.duration,tracks:_e,uuid:_.uuid,blendMode:_.blendMode};for(let rt=0,it=tt.length;rt!==it;++rt)_e.push(KeyframeTrack.toJSON(tt[rt]));return nt}static CreateFromMorphTargetSequence(_,_e,tt,nt){const rt=_e.length,it=[];for(let st=0;st<rt;st++){let ot=[],at=[];ot.push((st+rt-1)%rt,st,(st+1)%rt),at.push(0,1,0);const lt=getKeyframeOrder(ot);ot=sortedArray(ot,1,lt),at=sortedArray(at,1,lt),!nt&&ot[0]===0&&(ot.push(rt),at.push(at[0])),it.push(new NumberKeyframeTrack(".morphTargetInfluences["+_e[st].name+"]",ot,at).scale(1/tt))}return new this(_,-1,it)}static findByName(_,_e){let tt=_;if(!Array.isArray(_)){const nt=_;tt=nt.geometry&&nt.geometry.animations||nt.animations}for(let nt=0;nt<tt.length;nt++)if(tt[nt].name===_e)return tt[nt];return null}static CreateClipsFromMorphTargetSequences(_,_e,tt){const nt={},rt=/^([\w-]*?)([\d]+)$/;for(let st=0,ot=_.length;st<ot;st++){const at=_[st],lt=at.name.match(rt);if(lt&&lt.length>1){const ct=lt[1];let ht=nt[ct];ht||(nt[ct]=ht=[]),ht.push(at)}}const it=[];for(const st in nt)it.push(this.CreateFromMorphTargetSequence(st,nt[st],_e,tt));return it}static parseAnimation(_,_e){if(!_)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const tt=function(ct,ht,ut,ft,dt){if(ut.length!==0){const pt=[],mt=[];flattenJSON(ut,pt,mt,ft),pt.length!==0&&dt.push(new ct(ht,pt,mt))}},nt=[],rt=_.name||"default",it=_.fps||30,st=_.blendMode;let ot=_.length||-1;const at=_.hierarchy||[];for(let ct=0;ct<at.length;ct++){const ht=at[ct].keys;if(!(!ht||ht.length===0))if(ht[0].morphTargets){const ut={};let ft;for(ft=0;ft<ht.length;ft++)if(ht[ft].morphTargets)for(let dt=0;dt<ht[ft].morphTargets.length;dt++)ut[ht[ft].morphTargets[dt]]=-1;for(const dt in ut){const pt=[],mt=[];for(let vt=0;vt!==ht[ft].morphTargets.length;++vt){const yt=ht[ft];pt.push(yt.time),mt.push(yt.morphTarget===dt?1:0)}nt.push(new NumberKeyframeTrack(".morphTargetInfluence["+dt+"]",pt,mt))}ot=ut.length*it}else{const ut=".bones["+_e[ct].name+"]";tt(VectorKeyframeTrack,ut+".position",ht,"pos",nt),tt(QuaternionKeyframeTrack,ut+".quaternion",ht,"rot",nt),tt(VectorKeyframeTrack,ut+".scale",ht,"scl",nt)}}return nt.length===0?null:new this(rt,ot,nt,st)}resetDuration(){const _=this.tracks;let _e=0;for(let tt=0,nt=_.length;tt!==nt;++tt){const rt=this.tracks[tt];_e=Math.max(_e,rt.times[rt.times.length-1])}return this.duration=_e,this}trim(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].trim(0,this.duration);return this}validate(){let _=!0;for(let _e=0;_e<this.tracks.length;_e++)_=_&&this.tracks[_e].validate();return _}optimize(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].optimize();return this}clone(){const _=[];for(let _e=0;_e<this.tracks.length;_e++)_.push(this.tracks[_e].clone());return new this.constructor(this.name,this.duration,_,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(et){switch(et.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+et)}function parseKeyframeTrack(et){if(et.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _=getTrackTypeForValueTypeName(et.type);if(et.times===void 0){const _e=[],tt=[];flattenJSON(et.keys,_e,tt,"value"),et.times=_e,et.values=tt}return _.parse!==void 0?_.parse(et):new _(et.name,et.times,et.values,et.interpolation)}const Cache$1={enabled:!1,files:{},add:function(et,_){this.enabled!==!1&&(this.files[et]=_)},get:function(et){if(this.enabled!==!1)return this.files[et]},remove:function(et){delete this.files[et]},clear:function(){this.files={}}};class LoadingManager{constructor(_,_e,tt){const nt=this;let rt=!1,it=0,st=0,ot;const at=[];this.onStart=void 0,this.onLoad=_,this.onProgress=_e,this.onError=tt,this.itemStart=function(lt){st++,rt===!1&&nt.onStart!==void 0&&nt.onStart(lt,it,st),rt=!0},this.itemEnd=function(lt){it++,nt.onProgress!==void 0&&nt.onProgress(lt,it,st),it===st&&(rt=!1,nt.onLoad!==void 0&&nt.onLoad())},this.itemError=function(lt){nt.onError!==void 0&&nt.onError(lt)},this.resolveURL=function(lt){return ot?ot(lt):lt},this.setURLModifier=function(lt){return ot=lt,this},this.addHandler=function(lt,ct){return at.push(lt,ct),this},this.removeHandler=function(lt){const ct=at.indexOf(lt);return ct!==-1&&at.splice(ct,2),this},this.getHandler=function(lt){for(let ct=0,ht=at.length;ct<ht;ct+=2){const ut=at[ct],ft=at[ct+1];if(ut.global&&(ut.lastIndex=0),ut.test(lt))return ft}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_){this.manager=_!==void 0?_:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_,_e){const tt=this;return new Promise(function(nt,rt){tt.load(_,nt,_e,rt)})}parse(){}setCrossOrigin(_){return this.crossOrigin=_,this}setWithCredentials(_){return this.withCredentials=_,this}setPath(_){return this.path=_,this}setResourcePath(_){return this.resourcePath=_,this}setRequestHeader(_){return this.requestHeader=_,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_,_e){super(_),this.response=_e}}class FileLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const rt=Cache$1.get(_);if(rt!==void 0)return this.manager.itemStart(_),setTimeout(()=>{_e&&_e(rt),this.manager.itemEnd(_)},0),rt;if(loading[_]!==void 0){loading[_].push({onLoad:_e,onProgress:tt,onError:nt});return}loading[_]=[],loading[_].push({onLoad:_e,onProgress:tt,onError:nt});const it=new Request(_,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),st=this.mimeType,ot=this.responseType;fetch(it).then(at=>{if(at.status===200||at.status===0){if(at.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||at.body===void 0||at.body.getReader===void 0)return at;const lt=loading[_],ct=at.body.getReader(),ht=at.headers.get("X-File-Size")||at.headers.get("Content-Length"),ut=ht?parseInt(ht):0,ft=ut!==0;let dt=0;const pt=new ReadableStream({start(mt){vt();function vt(){ct.read().then(({done:yt,value:_t})=>{if(yt)mt.close();else{dt+=_t.byteLength;const St=new ProgressEvent("progress",{lengthComputable:ft,loaded:dt,total:ut});for(let bt=0,Et=lt.length;bt<Et;bt++){const Mt=lt[bt];Mt.onProgress&&Mt.onProgress(St)}mt.enqueue(_t),vt()}},yt=>{mt.error(yt)})}}});return new Response(pt)}else throw new HttpError(`fetch for "${at.url}" responded with ${at.status}: ${at.statusText}`,at)}).then(at=>{switch(ot){case"arraybuffer":return at.arrayBuffer();case"blob":return at.blob();case"document":return at.text().then(lt=>new DOMParser().parseFromString(lt,st));case"json":return at.json();default:if(st===void 0)return at.text();{const ct=/charset="?([^;"\s]*)"?/i.exec(st),ht=ct&&ct[1]?ct[1].toLowerCase():void 0,ut=new TextDecoder(ht);return at.arrayBuffer().then(ft=>ut.decode(ft))}}}).then(at=>{Cache$1.add(_,at);const lt=loading[_];delete loading[_];for(let ct=0,ht=lt.length;ct<ht;ct++){const ut=lt[ct];ut.onLoad&&ut.onLoad(at)}}).catch(at=>{const lt=loading[_];if(lt===void 0)throw this.manager.itemError(_),at;delete loading[_];for(let ct=0,ht=lt.length;ct<ht;ct++){const ut=lt[ct];ut.onError&&ut.onError(at)}this.manager.itemError(_)}).finally(()=>{this.manager.itemEnd(_)}),this.manager.itemStart(_)}setResponseType(_){return this.responseType=_,this}setMimeType(_){return this.mimeType=_,this}}class AnimationLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=this,it=new FileLoader(this.manager);it.setPath(this.path),it.setRequestHeader(this.requestHeader),it.setWithCredentials(this.withCredentials),it.load(_,function(st){try{_e(rt.parse(JSON.parse(st)))}catch(ot){nt?nt(ot):console.error(ot),rt.manager.itemError(_)}},tt,nt)}parse(_){const _e=[];for(let tt=0;tt<_.length;tt++){const nt=AnimationClip.parse(_[tt]);_e.push(nt)}return _e}}class CompressedTextureLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=this,it=[],st=new CompressedTexture,ot=new FileLoader(this.manager);ot.setPath(this.path),ot.setResponseType("arraybuffer"),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(rt.withCredentials);let at=0;function lt(ct){ot.load(_[ct],function(ht){const ut=rt.parse(ht,!0);it[ct]={width:ut.width,height:ut.height,format:ut.format,mipmaps:ut.mipmaps},at+=1,at===6&&(ut.mipmapCount===1&&(st.minFilter=LinearFilter),st.image=it,st.format=ut.format,st.needsUpdate=!0,_e&&_e(st))},tt,nt)}if(Array.isArray(_))for(let ct=0,ht=_.length;ct<ht;++ct)lt(ct);else ot.load(_,function(ct){const ht=rt.parse(ct,!0);if(ht.isCubemap){const ut=ht.mipmaps.length/ht.mipmapCount;for(let ft=0;ft<ut;ft++){it[ft]={mipmaps:[]};for(let dt=0;dt<ht.mipmapCount;dt++)it[ft].mipmaps.push(ht.mipmaps[ft*ht.mipmapCount+dt]),it[ft].format=ht.format,it[ft].width=ht.width,it[ft].height=ht.height}st.image=it}else st.image.width=ht.width,st.image.height=ht.height,st.mipmaps=ht.mipmaps;ht.mipmapCount===1&&(st.minFilter=LinearFilter),st.format=ht.format,st.needsUpdate=!0,_e&&_e(st)},tt,nt);return st}}class ImageLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const rt=this,it=Cache$1.get(_);if(it!==void 0)return rt.manager.itemStart(_),setTimeout(function(){_e&&_e(it),rt.manager.itemEnd(_)},0),it;const st=createElementNS("img");function ot(){lt(),Cache$1.add(_,this),_e&&_e(this),rt.manager.itemEnd(_)}function at(ct){lt(),nt&&nt(ct),rt.manager.itemError(_),rt.manager.itemEnd(_)}function lt(){st.removeEventListener("load",ot,!1),st.removeEventListener("error",at,!1)}return st.addEventListener("load",ot,!1),st.addEventListener("error",at,!1),_.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(st.crossOrigin=this.crossOrigin),rt.manager.itemStart(_),st.src=_,st}}class CubeTextureLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=new CubeTexture;rt.colorSpace=SRGBColorSpace;const it=new ImageLoader(this.manager);it.setCrossOrigin(this.crossOrigin),it.setPath(this.path);let st=0;function ot(at){it.load(_[at],function(lt){rt.images[at]=lt,st++,st===6&&(rt.needsUpdate=!0,_e&&_e(rt))},void 0,nt)}for(let at=0;at<_.length;++at)ot(at);return rt}}class DataTextureLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=this,it=new DataTexture,st=new FileLoader(this.manager);return st.setResponseType("arraybuffer"),st.setRequestHeader(this.requestHeader),st.setPath(this.path),st.setWithCredentials(rt.withCredentials),st.load(_,function(ot){let at;try{at=rt.parse(ot)}catch(lt){if(nt!==void 0)nt(lt);else{console.error(lt);return}}at.image!==void 0?it.image=at.image:at.data!==void 0&&(it.image.width=at.width,it.image.height=at.height,it.image.data=at.data),it.wrapS=at.wrapS!==void 0?at.wrapS:ClampToEdgeWrapping,it.wrapT=at.wrapT!==void 0?at.wrapT:ClampToEdgeWrapping,it.magFilter=at.magFilter!==void 0?at.magFilter:LinearFilter,it.minFilter=at.minFilter!==void 0?at.minFilter:LinearFilter,it.anisotropy=at.anisotropy!==void 0?at.anisotropy:1,at.colorSpace!==void 0&&(it.colorSpace=at.colorSpace),at.flipY!==void 0&&(it.flipY=at.flipY),at.format!==void 0&&(it.format=at.format),at.type!==void 0&&(it.type=at.type),at.mipmaps!==void 0&&(it.mipmaps=at.mipmaps,it.minFilter=LinearMipmapLinearFilter),at.mipmapCount===1&&(it.minFilter=LinearFilter),at.generateMipmaps!==void 0&&(it.generateMipmaps=at.generateMipmaps),it.needsUpdate=!0,_e&&_e(it,at)},tt,nt),it}}class TextureLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=new Texture$1,it=new ImageLoader(this.manager);return it.setCrossOrigin(this.crossOrigin),it.setPath(this.path),it.load(_,function(st){rt.image=st,rt.needsUpdate=!0,_e!==void 0&&_e(rt)},tt,nt),rt}}class Light extends Object3D{constructor(_,_e=1){super(),this.isLight=!0,this.type="Light",this.color=new Color$1(_),this.intensity=_e}dispose(){}copy(_,_e){return super.copy(_,_e),this.color.copy(_.color),this.intensity=_.intensity,this}toJSON(_){const _e=super.toJSON(_);return _e.object.color=this.color.getHex(),_e.object.intensity=this.intensity,this.groundColor!==void 0&&(_e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(_e.object.distance=this.distance),this.angle!==void 0&&(_e.object.angle=this.angle),this.decay!==void 0&&(_e.object.decay=this.decay),this.penumbra!==void 0&&(_e.object.penumbra=this.penumbra),this.shadow!==void 0&&(_e.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(_e.object.target=this.target.uuid),_e}}class HemisphereLight extends Light{constructor(_,_e,tt){super(_,tt),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color$1(_e)}copy(_,_e){return super.copy(_,_e),this.groundColor.copy(_.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_){this.camera=_,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_){const _e=this.camera,tt=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_.matrixWorld),_e.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_.target.matrixWorld),_e.lookAt(_lookTarget$1),_e.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),tt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),tt.multiply(_projScreenMatrix$1)}getViewport(_){return this._viewports[_]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_){return this.camera=_.camera.clone(),this.intensity=_.intensity,this.bias=_.bias,this.radius=_.radius,this.mapSize.copy(_.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _={};return this.intensity!==1&&(_.intensity=this.intensity),this.bias!==0&&(_.bias=this.bias),this.normalBias!==0&&(_.normalBias=this.normalBias),this.radius!==1&&(_.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_.mapSize=this.mapSize.toArray()),_.camera=this.camera.toJSON(!1).object,delete _.camera.matrix,_}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_){const _e=this.camera,tt=RAD2DEG*2*_.angle*this.focus,nt=this.mapSize.width/this.mapSize.height,rt=_.distance||_e.far;(tt!==_e.fov||nt!==_e.aspect||rt!==_e.far)&&(_e.fov=tt,_e.aspect=nt,_e.far=rt,_e.updateProjectionMatrix()),super.updateMatrices(_)}copy(_){return super.copy(_),this.focus=_.focus,this}}class SpotLight extends Light{constructor(_,_e,tt=0,nt=Math.PI/3,rt=0,it=2){super(_,_e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=tt,this.angle=nt,this.penumbra=rt,this.decay=it,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_){this.intensity=_/Math.PI}dispose(){this.shadow.dispose()}copy(_,_e){return super.copy(_,_e),this.distance=_.distance,this.angle=_.angle,this.penumbra=_.penumbra,this.decay=_.decay,this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_,_e=0){const tt=this.camera,nt=this.matrix,rt=_.distance||tt.far;rt!==tt.far&&(tt.far=rt,tt.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_.matrixWorld),tt.position.copy(_lightPositionWorld),_lookTarget.copy(tt.position),_lookTarget.add(this._cubeDirections[_e]),tt.up.copy(this._cubeUps[_e]),tt.lookAt(_lookTarget),tt.updateMatrixWorld(),nt.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(tt.projectionMatrix,tt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_,_e,tt=0,nt=2){super(_,_e),this.isPointLight=!0,this.type="PointLight",this.distance=tt,this.decay=nt,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_){this.intensity=_/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_,_e){return super.copy(_,_e),this.distance=_.distance,this.decay=_.decay,this.shadow=_.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_,_e){super(_,_e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_){return super.copy(_),this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}class AmbientLight extends Light{constructor(_,_e){super(_,_e),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_,_e,tt=10,nt=10){super(_,_e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=tt,this.height=nt}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_){this.intensity=_/(this.width*this.height*Math.PI)}copy(_){return super.copy(_),this.width=_.width,this.height=_.height,this}toJSON(_){const _e=super.toJSON(_);return _e.object.width=this.width,_e.object.height=this.height,_e}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _=0;_<9;_++)this.coefficients.push(new Vector3)}set(_){for(let _e=0;_e<9;_e++)this.coefficients[_e].copy(_[_e]);return this}zero(){for(let _=0;_<9;_++)this.coefficients[_].set(0,0,0);return this}getAt(_,_e){const tt=_.x,nt=_.y,rt=_.z,it=this.coefficients;return _e.copy(it[0]).multiplyScalar(.282095),_e.addScaledVector(it[1],.488603*nt),_e.addScaledVector(it[2],.488603*rt),_e.addScaledVector(it[3],.488603*tt),_e.addScaledVector(it[4],1.092548*(tt*nt)),_e.addScaledVector(it[5],1.092548*(nt*rt)),_e.addScaledVector(it[6],.315392*(3*rt*rt-1)),_e.addScaledVector(it[7],1.092548*(tt*rt)),_e.addScaledVector(it[8],.546274*(tt*tt-nt*nt)),_e}getIrradianceAt(_,_e){const tt=_.x,nt=_.y,rt=_.z,it=this.coefficients;return _e.copy(it[0]).multiplyScalar(.886227),_e.addScaledVector(it[1],2*.511664*nt),_e.addScaledVector(it[2],2*.511664*rt),_e.addScaledVector(it[3],2*.511664*tt),_e.addScaledVector(it[4],2*.429043*tt*nt),_e.addScaledVector(it[5],2*.429043*nt*rt),_e.addScaledVector(it[6],.743125*rt*rt-.247708),_e.addScaledVector(it[7],2*.429043*tt*rt),_e.addScaledVector(it[8],.429043*(tt*tt-nt*nt)),_e}add(_){for(let _e=0;_e<9;_e++)this.coefficients[_e].add(_.coefficients[_e]);return this}addScaledSH(_,_e){for(let tt=0;tt<9;tt++)this.coefficients[tt].addScaledVector(_.coefficients[tt],_e);return this}scale(_){for(let _e=0;_e<9;_e++)this.coefficients[_e].multiplyScalar(_);return this}lerp(_,_e){for(let tt=0;tt<9;tt++)this.coefficients[tt].lerp(_.coefficients[tt],_e);return this}equals(_){for(let _e=0;_e<9;_e++)if(!this.coefficients[_e].equals(_.coefficients[_e]))return!1;return!0}copy(_){return this.set(_.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_,_e=0){const tt=this.coefficients;for(let nt=0;nt<9;nt++)tt[nt].fromArray(_,_e+nt*3);return this}toArray(_=[],_e=0){const tt=this.coefficients;for(let nt=0;nt<9;nt++)tt[nt].toArray(_,_e+nt*3);return _}static getBasisAt(_,_e){const tt=_.x,nt=_.y,rt=_.z;_e[0]=.282095,_e[1]=.488603*nt,_e[2]=.488603*rt,_e[3]=.488603*tt,_e[4]=1.092548*tt*nt,_e[5]=1.092548*nt*rt,_e[6]=.315392*(3*rt*rt-1),_e[7]=1.092548*tt*rt,_e[8]=.546274*(tt*tt-nt*nt)}}class LightProbe extends Light{constructor(_=new SphericalHarmonics3,_e=1){super(void 0,_e),this.isLightProbe=!0,this.sh=_}copy(_){return super.copy(_),this.sh.copy(_.sh),this}fromJSON(_){return this.intensity=_.intensity,this.sh.fromArray(_.sh),this}toJSON(_){const _e=super.toJSON(_);return _e.object.sh=this.sh.toArray(),_e}}class MaterialLoader extends Loader{constructor(_){super(_),this.textures={}}load(_,_e,tt,nt){const rt=this,it=new FileLoader(rt.manager);it.setPath(rt.path),it.setRequestHeader(rt.requestHeader),it.setWithCredentials(rt.withCredentials),it.load(_,function(st){try{_e(rt.parse(JSON.parse(st)))}catch(ot){nt?nt(ot):console.error(ot),rt.manager.itemError(_)}},tt,nt)}parse(_){const _e=this.textures;function tt(rt){return _e[rt]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",rt),_e[rt]}const nt=MaterialLoader.createMaterialFromType(_.type);if(_.uuid!==void 0&&(nt.uuid=_.uuid),_.name!==void 0&&(nt.name=_.name),_.color!==void 0&&nt.color!==void 0&&nt.color.setHex(_.color),_.roughness!==void 0&&(nt.roughness=_.roughness),_.metalness!==void 0&&(nt.metalness=_.metalness),_.sheen!==void 0&&(nt.sheen=_.sheen),_.sheenColor!==void 0&&(nt.sheenColor=new Color$1().setHex(_.sheenColor)),_.sheenRoughness!==void 0&&(nt.sheenRoughness=_.sheenRoughness),_.emissive!==void 0&&nt.emissive!==void 0&&nt.emissive.setHex(_.emissive),_.specular!==void 0&&nt.specular!==void 0&&nt.specular.setHex(_.specular),_.specularIntensity!==void 0&&(nt.specularIntensity=_.specularIntensity),_.specularColor!==void 0&&nt.specularColor!==void 0&&nt.specularColor.setHex(_.specularColor),_.shininess!==void 0&&(nt.shininess=_.shininess),_.clearcoat!==void 0&&(nt.clearcoat=_.clearcoat),_.clearcoatRoughness!==void 0&&(nt.clearcoatRoughness=_.clearcoatRoughness),_.dispersion!==void 0&&(nt.dispersion=_.dispersion),_.iridescence!==void 0&&(nt.iridescence=_.iridescence),_.iridescenceIOR!==void 0&&(nt.iridescenceIOR=_.iridescenceIOR),_.iridescenceThicknessRange!==void 0&&(nt.iridescenceThicknessRange=_.iridescenceThicknessRange),_.transmission!==void 0&&(nt.transmission=_.transmission),_.thickness!==void 0&&(nt.thickness=_.thickness),_.attenuationDistance!==void 0&&(nt.attenuationDistance=_.attenuationDistance),_.attenuationColor!==void 0&&nt.attenuationColor!==void 0&&nt.attenuationColor.setHex(_.attenuationColor),_.anisotropy!==void 0&&(nt.anisotropy=_.anisotropy),_.anisotropyRotation!==void 0&&(nt.anisotropyRotation=_.anisotropyRotation),_.fog!==void 0&&(nt.fog=_.fog),_.flatShading!==void 0&&(nt.flatShading=_.flatShading),_.blending!==void 0&&(nt.blending=_.blending),_.combine!==void 0&&(nt.combine=_.combine),_.side!==void 0&&(nt.side=_.side),_.shadowSide!==void 0&&(nt.shadowSide=_.shadowSide),_.opacity!==void 0&&(nt.opacity=_.opacity),_.transparent!==void 0&&(nt.transparent=_.transparent),_.alphaTest!==void 0&&(nt.alphaTest=_.alphaTest),_.alphaHash!==void 0&&(nt.alphaHash=_.alphaHash),_.depthFunc!==void 0&&(nt.depthFunc=_.depthFunc),_.depthTest!==void 0&&(nt.depthTest=_.depthTest),_.depthWrite!==void 0&&(nt.depthWrite=_.depthWrite),_.colorWrite!==void 0&&(nt.colorWrite=_.colorWrite),_.blendSrc!==void 0&&(nt.blendSrc=_.blendSrc),_.blendDst!==void 0&&(nt.blendDst=_.blendDst),_.blendEquation!==void 0&&(nt.blendEquation=_.blendEquation),_.blendSrcAlpha!==void 0&&(nt.blendSrcAlpha=_.blendSrcAlpha),_.blendDstAlpha!==void 0&&(nt.blendDstAlpha=_.blendDstAlpha),_.blendEquationAlpha!==void 0&&(nt.blendEquationAlpha=_.blendEquationAlpha),_.blendColor!==void 0&&nt.blendColor!==void 0&&nt.blendColor.setHex(_.blendColor),_.blendAlpha!==void 0&&(nt.blendAlpha=_.blendAlpha),_.stencilWriteMask!==void 0&&(nt.stencilWriteMask=_.stencilWriteMask),_.stencilFunc!==void 0&&(nt.stencilFunc=_.stencilFunc),_.stencilRef!==void 0&&(nt.stencilRef=_.stencilRef),_.stencilFuncMask!==void 0&&(nt.stencilFuncMask=_.stencilFuncMask),_.stencilFail!==void 0&&(nt.stencilFail=_.stencilFail),_.stencilZFail!==void 0&&(nt.stencilZFail=_.stencilZFail),_.stencilZPass!==void 0&&(nt.stencilZPass=_.stencilZPass),_.stencilWrite!==void 0&&(nt.stencilWrite=_.stencilWrite),_.wireframe!==void 0&&(nt.wireframe=_.wireframe),_.wireframeLinewidth!==void 0&&(nt.wireframeLinewidth=_.wireframeLinewidth),_.wireframeLinecap!==void 0&&(nt.wireframeLinecap=_.wireframeLinecap),_.wireframeLinejoin!==void 0&&(nt.wireframeLinejoin=_.wireframeLinejoin),_.rotation!==void 0&&(nt.rotation=_.rotation),_.linewidth!==void 0&&(nt.linewidth=_.linewidth),_.dashSize!==void 0&&(nt.dashSize=_.dashSize),_.gapSize!==void 0&&(nt.gapSize=_.gapSize),_.scale!==void 0&&(nt.scale=_.scale),_.polygonOffset!==void 0&&(nt.polygonOffset=_.polygonOffset),_.polygonOffsetFactor!==void 0&&(nt.polygonOffsetFactor=_.polygonOffsetFactor),_.polygonOffsetUnits!==void 0&&(nt.polygonOffsetUnits=_.polygonOffsetUnits),_.dithering!==void 0&&(nt.dithering=_.dithering),_.alphaToCoverage!==void 0&&(nt.alphaToCoverage=_.alphaToCoverage),_.premultipliedAlpha!==void 0&&(nt.premultipliedAlpha=_.premultipliedAlpha),_.forceSinglePass!==void 0&&(nt.forceSinglePass=_.forceSinglePass),_.visible!==void 0&&(nt.visible=_.visible),_.toneMapped!==void 0&&(nt.toneMapped=_.toneMapped),_.userData!==void 0&&(nt.userData=_.userData),_.vertexColors!==void 0&&(typeof _.vertexColors=="number"?nt.vertexColors=_.vertexColors>0:nt.vertexColors=_.vertexColors),_.uniforms!==void 0)for(const rt in _.uniforms){const it=_.uniforms[rt];switch(nt.uniforms[rt]={},it.type){case"t":nt.uniforms[rt].value=tt(it.value);break;case"c":nt.uniforms[rt].value=new Color$1().setHex(it.value);break;case"v2":nt.uniforms[rt].value=new Vector2().fromArray(it.value);break;case"v3":nt.uniforms[rt].value=new Vector3().fromArray(it.value);break;case"v4":nt.uniforms[rt].value=new Vector4().fromArray(it.value);break;case"m3":nt.uniforms[rt].value=new Matrix3().fromArray(it.value);break;case"m4":nt.uniforms[rt].value=new Matrix4().fromArray(it.value);break;default:nt.uniforms[rt].value=it.value}}if(_.defines!==void 0&&(nt.defines=_.defines),_.vertexShader!==void 0&&(nt.vertexShader=_.vertexShader),_.fragmentShader!==void 0&&(nt.fragmentShader=_.fragmentShader),_.glslVersion!==void 0&&(nt.glslVersion=_.glslVersion),_.extensions!==void 0)for(const rt in _.extensions)nt.extensions[rt]=_.extensions[rt];if(_.lights!==void 0&&(nt.lights=_.lights),_.clipping!==void 0&&(nt.clipping=_.clipping),_.size!==void 0&&(nt.size=_.size),_.sizeAttenuation!==void 0&&(nt.sizeAttenuation=_.sizeAttenuation),_.map!==void 0&&(nt.map=tt(_.map)),_.matcap!==void 0&&(nt.matcap=tt(_.matcap)),_.alphaMap!==void 0&&(nt.alphaMap=tt(_.alphaMap)),_.bumpMap!==void 0&&(nt.bumpMap=tt(_.bumpMap)),_.bumpScale!==void 0&&(nt.bumpScale=_.bumpScale),_.normalMap!==void 0&&(nt.normalMap=tt(_.normalMap)),_.normalMapType!==void 0&&(nt.normalMapType=_.normalMapType),_.normalScale!==void 0){let rt=_.normalScale;Array.isArray(rt)===!1&&(rt=[rt,rt]),nt.normalScale=new Vector2().fromArray(rt)}return _.displacementMap!==void 0&&(nt.displacementMap=tt(_.displacementMap)),_.displacementScale!==void 0&&(nt.displacementScale=_.displacementScale),_.displacementBias!==void 0&&(nt.displacementBias=_.displacementBias),_.roughnessMap!==void 0&&(nt.roughnessMap=tt(_.roughnessMap)),_.metalnessMap!==void 0&&(nt.metalnessMap=tt(_.metalnessMap)),_.emissiveMap!==void 0&&(nt.emissiveMap=tt(_.emissiveMap)),_.emissiveIntensity!==void 0&&(nt.emissiveIntensity=_.emissiveIntensity),_.specularMap!==void 0&&(nt.specularMap=tt(_.specularMap)),_.specularIntensityMap!==void 0&&(nt.specularIntensityMap=tt(_.specularIntensityMap)),_.specularColorMap!==void 0&&(nt.specularColorMap=tt(_.specularColorMap)),_.envMap!==void 0&&(nt.envMap=tt(_.envMap)),_.envMapRotation!==void 0&&nt.envMapRotation.fromArray(_.envMapRotation),_.envMapIntensity!==void 0&&(nt.envMapIntensity=_.envMapIntensity),_.reflectivity!==void 0&&(nt.reflectivity=_.reflectivity),_.refractionRatio!==void 0&&(nt.refractionRatio=_.refractionRatio),_.lightMap!==void 0&&(nt.lightMap=tt(_.lightMap)),_.lightMapIntensity!==void 0&&(nt.lightMapIntensity=_.lightMapIntensity),_.aoMap!==void 0&&(nt.aoMap=tt(_.aoMap)),_.aoMapIntensity!==void 0&&(nt.aoMapIntensity=_.aoMapIntensity),_.gradientMap!==void 0&&(nt.gradientMap=tt(_.gradientMap)),_.clearcoatMap!==void 0&&(nt.clearcoatMap=tt(_.clearcoatMap)),_.clearcoatRoughnessMap!==void 0&&(nt.clearcoatRoughnessMap=tt(_.clearcoatRoughnessMap)),_.clearcoatNormalMap!==void 0&&(nt.clearcoatNormalMap=tt(_.clearcoatNormalMap)),_.clearcoatNormalScale!==void 0&&(nt.clearcoatNormalScale=new Vector2().fromArray(_.clearcoatNormalScale)),_.iridescenceMap!==void 0&&(nt.iridescenceMap=tt(_.iridescenceMap)),_.iridescenceThicknessMap!==void 0&&(nt.iridescenceThicknessMap=tt(_.iridescenceThicknessMap)),_.transmissionMap!==void 0&&(nt.transmissionMap=tt(_.transmissionMap)),_.thicknessMap!==void 0&&(nt.thicknessMap=tt(_.thicknessMap)),_.anisotropyMap!==void 0&&(nt.anisotropyMap=tt(_.anisotropyMap)),_.sheenColorMap!==void 0&&(nt.sheenColorMap=tt(_.sheenColorMap)),_.sheenRoughnessMap!==void 0&&(nt.sheenRoughnessMap=tt(_.sheenRoughnessMap)),nt}setTextures(_){return this.textures=_,this}static createMaterialFromType(_){const _e={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new _e[_]}}class LoaderUtils{static decodeText(_){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(_);let _e="";for(let tt=0,nt=_.length;tt<nt;tt++)_e+=String.fromCharCode(_[tt]);try{return decodeURIComponent(escape(_e))}catch{return _e}}static extractUrlBase(_){const _e=_.lastIndexOf("/");return _e===-1?"./":_.slice(0,_e+1)}static resolveURL(_,_e){return typeof _!="string"||_===""?"":(/^https?:\/\//i.test(_e)&&/^\//.test(_)&&(_e=_e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_)||/^data:.*,.*$/i.test(_)||/^blob:.*$/i.test(_)?_:_e+_)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_){return super.copy(_),this.instanceCount=_.instanceCount,this}toJSON(){const _=super.toJSON();return _.instanceCount=this.instanceCount,_.isInstancedBufferGeometry=!0,_}}class BufferGeometryLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=this,it=new FileLoader(rt.manager);it.setPath(rt.path),it.setRequestHeader(rt.requestHeader),it.setWithCredentials(rt.withCredentials),it.load(_,function(st){try{_e(rt.parse(JSON.parse(st)))}catch(ot){nt?nt(ot):console.error(ot),rt.manager.itemError(_)}},tt,nt)}parse(_){const _e={},tt={};function nt(ut,ft){if(_e[ft]!==void 0)return _e[ft];const pt=ut.interleavedBuffers[ft],mt=rt(ut,pt.buffer),vt=getTypedArray(pt.type,mt),yt=new InterleavedBuffer(vt,pt.stride);return yt.uuid=pt.uuid,_e[ft]=yt,yt}function rt(ut,ft){if(tt[ft]!==void 0)return tt[ft];const pt=ut.arrayBuffers[ft],mt=new Uint32Array(pt).buffer;return tt[ft]=mt,mt}const it=_.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,st=_.data.index;if(st!==void 0){const ut=getTypedArray(st.type,st.array);it.setIndex(new BufferAttribute(ut,1))}const ot=_.data.attributes;for(const ut in ot){const ft=ot[ut];let dt;if(ft.isInterleavedBufferAttribute){const pt=nt(_.data,ft.data);dt=new InterleavedBufferAttribute(pt,ft.itemSize,ft.offset,ft.normalized)}else{const pt=getTypedArray(ft.type,ft.array),mt=ft.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;dt=new mt(pt,ft.itemSize,ft.normalized)}ft.name!==void 0&&(dt.name=ft.name),ft.usage!==void 0&&dt.setUsage(ft.usage),it.setAttribute(ut,dt)}const at=_.data.morphAttributes;if(at)for(const ut in at){const ft=at[ut],dt=[];for(let pt=0,mt=ft.length;pt<mt;pt++){const vt=ft[pt];let yt;if(vt.isInterleavedBufferAttribute){const _t=nt(_.data,vt.data);yt=new InterleavedBufferAttribute(_t,vt.itemSize,vt.offset,vt.normalized)}else{const _t=getTypedArray(vt.type,vt.array);yt=new BufferAttribute(_t,vt.itemSize,vt.normalized)}vt.name!==void 0&&(yt.name=vt.name),dt.push(yt)}it.morphAttributes[ut]=dt}_.data.morphTargetsRelative&&(it.morphTargetsRelative=!0);const ct=_.data.groups||_.data.drawcalls||_.data.offsets;if(ct!==void 0)for(let ut=0,ft=ct.length;ut!==ft;++ut){const dt=ct[ut];it.addGroup(dt.start,dt.count,dt.materialIndex)}const ht=_.data.boundingSphere;if(ht!==void 0){const ut=new Vector3;ht.center!==void 0&&ut.fromArray(ht.center),it.boundingSphere=new Sphere(ut,ht.radius)}return _.name&&(it.name=_.name),_.userData&&(it.userData=_.userData),it}}class ObjectLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=this,it=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||it;const st=new FileLoader(this.manager);st.setPath(this.path),st.setRequestHeader(this.requestHeader),st.setWithCredentials(this.withCredentials),st.load(_,function(ot){let at=null;try{at=JSON.parse(ot)}catch(ct){nt!==void 0&&nt(ct),console.error("THREE:ObjectLoader: Can't parse "+_+".",ct.message);return}const lt=at.metadata;if(lt===void 0||lt.type===void 0||lt.type.toLowerCase()==="geometry"){nt!==void 0&&nt(new Error("THREE.ObjectLoader: Can't load "+_)),console.error("THREE.ObjectLoader: Can't load "+_);return}rt.parse(at,_e)},tt,nt)}async loadAsync(_,_e){const tt=this,nt=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||nt;const rt=new FileLoader(this.manager);rt.setPath(this.path),rt.setRequestHeader(this.requestHeader),rt.setWithCredentials(this.withCredentials);const it=await rt.loadAsync(_,_e),st=JSON.parse(it),ot=st.metadata;if(ot===void 0||ot.type===void 0||ot.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_);return await tt.parseAsync(st)}parse(_,_e){const tt=this.parseAnimations(_.animations),nt=this.parseShapes(_.shapes),rt=this.parseGeometries(_.geometries,nt),it=this.parseImages(_.images,function(){_e!==void 0&&_e(at)}),st=this.parseTextures(_.textures,it),ot=this.parseMaterials(_.materials,st),at=this.parseObject(_.object,rt,ot,st,tt),lt=this.parseSkeletons(_.skeletons,at);if(this.bindSkeletons(at,lt),this.bindLightTargets(at),_e!==void 0){let ct=!1;for(const ht in it)if(it[ht].data instanceof HTMLImageElement){ct=!0;break}ct===!1&&_e(at)}return at}async parseAsync(_){const _e=this.parseAnimations(_.animations),tt=this.parseShapes(_.shapes),nt=this.parseGeometries(_.geometries,tt),rt=await this.parseImagesAsync(_.images),it=this.parseTextures(_.textures,rt),st=this.parseMaterials(_.materials,it),ot=this.parseObject(_.object,nt,st,it,_e),at=this.parseSkeletons(_.skeletons,ot);return this.bindSkeletons(ot,at),this.bindLightTargets(ot),ot}parseShapes(_){const _e={};if(_!==void 0)for(let tt=0,nt=_.length;tt<nt;tt++){const rt=new Shape$1().fromJSON(_[tt]);_e[rt.uuid]=rt}return _e}parseSkeletons(_,_e){const tt={},nt={};if(_e.traverse(function(rt){rt.isBone&&(nt[rt.uuid]=rt)}),_!==void 0)for(let rt=0,it=_.length;rt<it;rt++){const st=new Skeleton().fromJSON(_[rt],nt);tt[st.uuid]=st}return tt}parseGeometries(_,_e){const tt={};if(_!==void 0){const nt=new BufferGeometryLoader;for(let rt=0,it=_.length;rt<it;rt++){let st;const ot=_[rt];switch(ot.type){case"BufferGeometry":case"InstancedBufferGeometry":st=nt.parse(ot);break;default:ot.type in Geometries?st=Geometries[ot.type].fromJSON(ot,_e):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${ot.type}"`)}st.uuid=ot.uuid,ot.name!==void 0&&(st.name=ot.name),ot.userData!==void 0&&(st.userData=ot.userData),tt[ot.uuid]=st}}return tt}parseMaterials(_,_e){const tt={},nt={};if(_!==void 0){const rt=new MaterialLoader;rt.setTextures(_e);for(let it=0,st=_.length;it<st;it++){const ot=_[it];tt[ot.uuid]===void 0&&(tt[ot.uuid]=rt.parse(ot)),nt[ot.uuid]=tt[ot.uuid]}}return nt}parseAnimations(_){const _e={};if(_!==void 0)for(let tt=0;tt<_.length;tt++){const nt=_[tt],rt=AnimationClip.parse(nt);_e[rt.uuid]=rt}return _e}parseImages(_,_e){const tt=this,nt={};let rt;function it(ot){return tt.manager.itemStart(ot),rt.load(ot,function(){tt.manager.itemEnd(ot)},void 0,function(){tt.manager.itemError(ot),tt.manager.itemEnd(ot)})}function st(ot){if(typeof ot=="string"){const at=ot,lt=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(at)?at:tt.resourcePath+at;return it(lt)}else return ot.data?{data:getTypedArray(ot.type,ot.data),width:ot.width,height:ot.height}:null}if(_!==void 0&&_.length>0){const ot=new LoadingManager(_e);rt=new ImageLoader(ot),rt.setCrossOrigin(this.crossOrigin);for(let at=0,lt=_.length;at<lt;at++){const ct=_[at],ht=ct.url;if(Array.isArray(ht)){const ut=[];for(let ft=0,dt=ht.length;ft<dt;ft++){const pt=ht[ft],mt=st(pt);mt!==null&&(mt instanceof HTMLImageElement?ut.push(mt):ut.push(new DataTexture(mt.data,mt.width,mt.height)))}nt[ct.uuid]=new Source(ut)}else{const ut=st(ct.url);nt[ct.uuid]=new Source(ut)}}}return nt}async parseImagesAsync(_){const _e=this,tt={};let nt;async function rt(it){if(typeof it=="string"){const st=it,ot=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(st)?st:_e.resourcePath+st;return await nt.loadAsync(ot)}else return it.data?{data:getTypedArray(it.type,it.data),width:it.width,height:it.height}:null}if(_!==void 0&&_.length>0){nt=new ImageLoader(this.manager),nt.setCrossOrigin(this.crossOrigin);for(let it=0,st=_.length;it<st;it++){const ot=_[it],at=ot.url;if(Array.isArray(at)){const lt=[];for(let ct=0,ht=at.length;ct<ht;ct++){const ut=at[ct],ft=await rt(ut);ft!==null&&(ft instanceof HTMLImageElement?lt.push(ft):lt.push(new DataTexture(ft.data,ft.width,ft.height)))}tt[ot.uuid]=new Source(lt)}else{const lt=await rt(ot.url);tt[ot.uuid]=new Source(lt)}}}return tt}parseTextures(_,_e){function tt(rt,it){return typeof rt=="number"?rt:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",rt),it[rt])}const nt={};if(_!==void 0)for(let rt=0,it=_.length;rt<it;rt++){const st=_[rt];st.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',st.uuid),_e[st.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",st.image);const ot=_e[st.image],at=ot.data;let lt;Array.isArray(at)?(lt=new CubeTexture,at.length===6&&(lt.needsUpdate=!0)):(at&&at.data?lt=new DataTexture:lt=new Texture$1,at&&(lt.needsUpdate=!0)),lt.source=ot,lt.uuid=st.uuid,st.name!==void 0&&(lt.name=st.name),st.mapping!==void 0&&(lt.mapping=tt(st.mapping,TEXTURE_MAPPING)),st.channel!==void 0&&(lt.channel=st.channel),st.offset!==void 0&&lt.offset.fromArray(st.offset),st.repeat!==void 0&&lt.repeat.fromArray(st.repeat),st.center!==void 0&&lt.center.fromArray(st.center),st.rotation!==void 0&&(lt.rotation=st.rotation),st.wrap!==void 0&&(lt.wrapS=tt(st.wrap[0],TEXTURE_WRAPPING),lt.wrapT=tt(st.wrap[1],TEXTURE_WRAPPING)),st.format!==void 0&&(lt.format=st.format),st.internalFormat!==void 0&&(lt.internalFormat=st.internalFormat),st.type!==void 0&&(lt.type=st.type),st.colorSpace!==void 0&&(lt.colorSpace=st.colorSpace),st.minFilter!==void 0&&(lt.minFilter=tt(st.minFilter,TEXTURE_FILTER)),st.magFilter!==void 0&&(lt.magFilter=tt(st.magFilter,TEXTURE_FILTER)),st.anisotropy!==void 0&&(lt.anisotropy=st.anisotropy),st.flipY!==void 0&&(lt.flipY=st.flipY),st.generateMipmaps!==void 0&&(lt.generateMipmaps=st.generateMipmaps),st.premultiplyAlpha!==void 0&&(lt.premultiplyAlpha=st.premultiplyAlpha),st.unpackAlignment!==void 0&&(lt.unpackAlignment=st.unpackAlignment),st.compareFunction!==void 0&&(lt.compareFunction=st.compareFunction),st.userData!==void 0&&(lt.userData=st.userData),nt[st.uuid]=lt}return nt}parseObject(_,_e,tt,nt,rt){let it;function st(ht){return _e[ht]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",ht),_e[ht]}function ot(ht){if(ht!==void 0){if(Array.isArray(ht)){const ut=[];for(let ft=0,dt=ht.length;ft<dt;ft++){const pt=ht[ft];tt[pt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",pt),ut.push(tt[pt])}return ut}return tt[ht]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ht),tt[ht]}}function at(ht){return nt[ht]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",ht),nt[ht]}let lt,ct;switch(_.type){case"Scene":it=new Scene,_.background!==void 0&&(Number.isInteger(_.background)?it.background=new Color$1(_.background):it.background=at(_.background)),_.environment!==void 0&&(it.environment=at(_.environment)),_.fog!==void 0&&(_.fog.type==="Fog"?it.fog=new Fog(_.fog.color,_.fog.near,_.fog.far):_.fog.type==="FogExp2"&&(it.fog=new FogExp2(_.fog.color,_.fog.density)),_.fog.name!==""&&(it.fog.name=_.fog.name)),_.backgroundBlurriness!==void 0&&(it.backgroundBlurriness=_.backgroundBlurriness),_.backgroundIntensity!==void 0&&(it.backgroundIntensity=_.backgroundIntensity),_.backgroundRotation!==void 0&&it.backgroundRotation.fromArray(_.backgroundRotation),_.environmentIntensity!==void 0&&(it.environmentIntensity=_.environmentIntensity),_.environmentRotation!==void 0&&it.environmentRotation.fromArray(_.environmentRotation);break;case"PerspectiveCamera":it=new PerspectiveCamera(_.fov,_.aspect,_.near,_.far),_.focus!==void 0&&(it.focus=_.focus),_.zoom!==void 0&&(it.zoom=_.zoom),_.filmGauge!==void 0&&(it.filmGauge=_.filmGauge),_.filmOffset!==void 0&&(it.filmOffset=_.filmOffset),_.view!==void 0&&(it.view=Object.assign({},_.view));break;case"OrthographicCamera":it=new OrthographicCamera(_.left,_.right,_.top,_.bottom,_.near,_.far),_.zoom!==void 0&&(it.zoom=_.zoom),_.view!==void 0&&(it.view=Object.assign({},_.view));break;case"AmbientLight":it=new AmbientLight(_.color,_.intensity);break;case"DirectionalLight":it=new DirectionalLight(_.color,_.intensity),it.target=_.target||"";break;case"PointLight":it=new PointLight(_.color,_.intensity,_.distance,_.decay);break;case"RectAreaLight":it=new RectAreaLight(_.color,_.intensity,_.width,_.height);break;case"SpotLight":it=new SpotLight(_.color,_.intensity,_.distance,_.angle,_.penumbra,_.decay),it.target=_.target||"";break;case"HemisphereLight":it=new HemisphereLight(_.color,_.groundColor,_.intensity);break;case"LightProbe":it=new LightProbe().fromJSON(_);break;case"SkinnedMesh":lt=st(_.geometry),ct=ot(_.material),it=new SkinnedMesh(lt,ct),_.bindMode!==void 0&&(it.bindMode=_.bindMode),_.bindMatrix!==void 0&&it.bindMatrix.fromArray(_.bindMatrix),_.skeleton!==void 0&&(it.skeleton=_.skeleton);break;case"Mesh":lt=st(_.geometry),ct=ot(_.material),it=new Mesh(lt,ct);break;case"InstancedMesh":lt=st(_.geometry),ct=ot(_.material);const ht=_.count,ut=_.instanceMatrix,ft=_.instanceColor;it=new InstancedMesh(lt,ct,ht),it.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ut.array),16),ft!==void 0&&(it.instanceColor=new InstancedBufferAttribute(new Float32Array(ft.array),ft.itemSize));break;case"BatchedMesh":lt=st(_.geometry),ct=ot(_.material),it=new BatchedMesh(_.maxInstanceCount,_.maxVertexCount,_.maxIndexCount,ct),it.geometry=lt,it.perObjectFrustumCulled=_.perObjectFrustumCulled,it.sortObjects=_.sortObjects,it._drawRanges=_.drawRanges,it._reservedRanges=_.reservedRanges,it._visibility=_.visibility,it._active=_.active,it._bounds=_.bounds.map(dt=>{const pt=new Box3;pt.min.fromArray(dt.boxMin),pt.max.fromArray(dt.boxMax);const mt=new Sphere;return mt.radius=dt.sphereRadius,mt.center.fromArray(dt.sphereCenter),{boxInitialized:dt.boxInitialized,box:pt,sphereInitialized:dt.sphereInitialized,sphere:mt}}),it._maxInstanceCount=_.maxInstanceCount,it._maxVertexCount=_.maxVertexCount,it._maxIndexCount=_.maxIndexCount,it._geometryInitialized=_.geometryInitialized,it._geometryCount=_.geometryCount,it._matricesTexture=at(_.matricesTexture.uuid),_.colorsTexture!==void 0&&(it._colorsTexture=at(_.colorsTexture.uuid));break;case"LOD":it=new LOD;break;case"Line":it=new Line(st(_.geometry),ot(_.material));break;case"LineLoop":it=new LineLoop(st(_.geometry),ot(_.material));break;case"LineSegments":it=new LineSegments(st(_.geometry),ot(_.material));break;case"PointCloud":case"Points":it=new Points(st(_.geometry),ot(_.material));break;case"Sprite":it=new Sprite$1(ot(_.material));break;case"Group":it=new Group;break;case"Bone":it=new Bone;break;default:it=new Object3D}if(it.uuid=_.uuid,_.name!==void 0&&(it.name=_.name),_.matrix!==void 0?(it.matrix.fromArray(_.matrix),_.matrixAutoUpdate!==void 0&&(it.matrixAutoUpdate=_.matrixAutoUpdate),it.matrixAutoUpdate&&it.matrix.decompose(it.position,it.quaternion,it.scale)):(_.position!==void 0&&it.position.fromArray(_.position),_.rotation!==void 0&&it.rotation.fromArray(_.rotation),_.quaternion!==void 0&&it.quaternion.fromArray(_.quaternion),_.scale!==void 0&&it.scale.fromArray(_.scale)),_.up!==void 0&&it.up.fromArray(_.up),_.castShadow!==void 0&&(it.castShadow=_.castShadow),_.receiveShadow!==void 0&&(it.receiveShadow=_.receiveShadow),_.shadow&&(_.shadow.intensity!==void 0&&(it.shadow.intensity=_.shadow.intensity),_.shadow.bias!==void 0&&(it.shadow.bias=_.shadow.bias),_.shadow.normalBias!==void 0&&(it.shadow.normalBias=_.shadow.normalBias),_.shadow.radius!==void 0&&(it.shadow.radius=_.shadow.radius),_.shadow.mapSize!==void 0&&it.shadow.mapSize.fromArray(_.shadow.mapSize),_.shadow.camera!==void 0&&(it.shadow.camera=this.parseObject(_.shadow.camera))),_.visible!==void 0&&(it.visible=_.visible),_.frustumCulled!==void 0&&(it.frustumCulled=_.frustumCulled),_.renderOrder!==void 0&&(it.renderOrder=_.renderOrder),_.userData!==void 0&&(it.userData=_.userData),_.layers!==void 0&&(it.layers.mask=_.layers),_.children!==void 0){const ht=_.children;for(let ut=0;ut<ht.length;ut++)it.add(this.parseObject(ht[ut],_e,tt,nt,rt))}if(_.animations!==void 0){const ht=_.animations;for(let ut=0;ut<ht.length;ut++){const ft=ht[ut];it.animations.push(rt[ft])}}if(_.type==="LOD"){_.autoUpdate!==void 0&&(it.autoUpdate=_.autoUpdate);const ht=_.levels;for(let ut=0;ut<ht.length;ut++){const ft=ht[ut],dt=it.getObjectByProperty("uuid",ft.object);dt!==void 0&&it.addLevel(dt,ft.distance,ft.hysteresis)}}return it}bindSkeletons(_,_e){Object.keys(_e).length!==0&&_.traverse(function(tt){if(tt.isSkinnedMesh===!0&&tt.skeleton!==void 0){const nt=_e[tt.skeleton];nt===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",tt.skeleton):tt.bind(nt,tt.bindMatrix)}})}bindLightTargets(_){_.traverse(function(_e){if(_e.isDirectionalLight||_e.isSpotLight){const tt=_e.target,nt=_.getObjectByProperty("uuid",tt);nt!==void 0?_e.target=nt:_e.target=new Object3D}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_){super(_),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_){return this.options=_,this}load(_,_e,tt,nt){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const rt=this,it=Cache$1.get(_);if(it!==void 0){if(rt.manager.itemStart(_),it.then){it.then(at=>{_e&&_e(at),rt.manager.itemEnd(_)}).catch(at=>{nt&&nt(at)});return}return setTimeout(function(){_e&&_e(it),rt.manager.itemEnd(_)},0),it}const st={};st.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",st.headers=this.requestHeader;const ot=fetch(_,st).then(function(at){return at.blob()}).then(function(at){return createImageBitmap(at,Object.assign(rt.options,{colorSpaceConversion:"none"}))}).then(function(at){return Cache$1.add(_,at),_e&&_e(at),rt.manager.itemEnd(_),at}).catch(function(at){nt&&nt(at),Cache$1.remove(_),rt.manager.itemError(_),rt.manager.itemEnd(_)});Cache$1.add(_,ot),rt.manager.itemStart(_)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(_){_context=_}}class AudioLoader extends Loader{constructor(_){super(_)}load(_,_e,tt,nt){const rt=this,it=new FileLoader(this.manager);it.setResponseType("arraybuffer"),it.setPath(this.path),it.setRequestHeader(this.requestHeader),it.setWithCredentials(this.withCredentials),it.load(_,function(ot){try{const at=ot.slice(0);AudioContext.getContext().decodeAudioData(at,function(ct){_e(ct)}).catch(st)}catch(at){st(at)}},tt,nt);function st(ot){nt?nt(ot):console.error(ot),rt.manager.itemError(_)}}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_){const _e=this._cache;if(_e.focus!==_.focus||_e.fov!==_.fov||_e.aspect!==_.aspect*this.aspect||_e.near!==_.near||_e.far!==_.far||_e.zoom!==_.zoom||_e.eyeSep!==this.eyeSep){_e.focus=_.focus,_e.fov=_.fov,_e.aspect=_.aspect*this.aspect,_e.near=_.near,_e.far=_.far,_e.zoom=_.zoom,_e.eyeSep=this.eyeSep,_projectionMatrix.copy(_.projectionMatrix);const nt=_e.eyeSep/2,rt=nt*_e.near/_e.focus,it=_e.near*Math.tan(DEG2RAD*_e.fov*.5)/_e.zoom;let st,ot;_eyeLeft.elements[12]=-nt,_eyeRight.elements[12]=nt,st=-it*_e.aspect+rt,ot=it*_e.aspect+rt,_projectionMatrix.elements[0]=2*_e.near/(ot-st),_projectionMatrix.elements[8]=(ot+st)/(ot-st),this.cameraL.projectionMatrix.copy(_projectionMatrix),st=-it*_e.aspect-rt,ot=it*_e.aspect-rt,_projectionMatrix.elements[0]=2*_e.near/(ot-st),_projectionMatrix.elements[8]=(ot+st)/(ot-st),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(_=!0){this.autoStart=_,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const _e=now$2();_=(_e-this.oldTime)/1e3,this.oldTime=_e,this.elapsedTime+=_}return _}}function now$2(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}updateMatrixWorld(_){super.updateMatrixWorld(_);const _e=this.context.listener,tt=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),_e.positionX){const nt=this.context.currentTime+this.timeDelta;_e.positionX.linearRampToValueAtTime(_position$1.x,nt),_e.positionY.linearRampToValueAtTime(_position$1.y,nt),_e.positionZ.linearRampToValueAtTime(_position$1.z,nt),_e.forwardX.linearRampToValueAtTime(_orientation$1.x,nt),_e.forwardY.linearRampToValueAtTime(_orientation$1.y,nt),_e.forwardZ.linearRampToValueAtTime(_orientation$1.z,nt),_e.upX.linearRampToValueAtTime(tt.x,nt),_e.upY.linearRampToValueAtTime(tt.y,nt),_e.upZ.linearRampToValueAtTime(tt.z,nt)}else _e.setPosition(_position$1.x,_position$1.y,_position$1.z),_e.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,tt.x,tt.y,tt.z)}}class Audio extends Object3D{constructor(_){super(),this.type="Audio",this.listener=_,this.context=_.context,this.gain=this.context.createGain(),this.gain.connect(_.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_,this.connect(),this}setMediaElementSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_),this.connect(),this}setMediaStreamSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_),this.connect(),this}setBuffer(_){return this.buffer=_,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_;const _e=this.context.createBufferSource();return _e.buffer=this.buffer,_e.loop=this.loop,_e.loopStart=this.loopStart,_e.loopEnd=this.loopEnd,_e.onended=this.onEnded.bind(this),_e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=_e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _=1,_e=this.filters.length;_<_e;_++)this.filters[_-1].connect(this.filters[_]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _=1,_e=this.filters.length;_<_e;_++)this.filters[_-1].disconnect(this.filters[_]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(_){return _||(_=[]),this._connected===!0?(this.disconnect(),this.filters=_.slice(),this.connect()):this.filters=_.slice(),this}setDetune(_){return this.detune=_,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_){return this.setFilters(_?[_]:[])}setPlaybackRate(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_){return this.loopStart=_,this}setLoopEnd(_){return this.loopEnd=_,this}getVolume(){return this.gain.gain.value}setVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(_){super(_),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_){return this.panner.refDistance=_,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_){return this.panner.rolloffFactor=_,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_){return this.panner.distanceModel=_,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_){return this.panner.maxDistance=_,this}setDirectionalCone(_,_e,tt){return this.panner.coneInnerAngle=_,this.panner.coneOuterAngle=_e,this.panner.coneOuterGain=tt,this}updateMatrixWorld(_){if(super.updateMatrixWorld(_),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const _e=this.panner;if(_e.positionX){const tt=this.context.currentTime+this.listener.timeDelta;_e.positionX.linearRampToValueAtTime(_position.x,tt),_e.positionY.linearRampToValueAtTime(_position.y,tt),_e.positionZ.linearRampToValueAtTime(_position.z,tt),_e.orientationX.linearRampToValueAtTime(_orientation.x,tt),_e.orientationY.linearRampToValueAtTime(_orientation.y,tt),_e.orientationZ.linearRampToValueAtTime(_orientation.z,tt)}else _e.setPosition(_position.x,_position.y,_position.z),_e.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_,_e=2048){this.analyser=_.context.createAnalyser(),this.analyser.fftSize=_e,this.data=new Uint8Array(this.analyser.frequencyBinCount),_.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _=0;const _e=this.getFrequencyData();for(let tt=0;tt<_e.length;tt++)_+=_e[tt];return _/_e.length}}class PropertyMixer{constructor(_,_e,tt){this.binding=_,this.valueSize=tt;let nt,rt,it;switch(_e){case"quaternion":nt=this._slerp,rt=this._slerpAdditive,it=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(tt*6),this._workIndex=5;break;case"string":case"bool":nt=this._select,rt=this._select,it=this._setAdditiveIdentityOther,this.buffer=new Array(tt*5);break;default:nt=this._lerp,rt=this._lerpAdditive,it=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(tt*5)}this._mixBufferRegion=nt,this._mixBufferRegionAdditive=rt,this._setIdentity=it,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_,_e){const tt=this.buffer,nt=this.valueSize,rt=_*nt+nt;let it=this.cumulativeWeight;if(it===0){for(let st=0;st!==nt;++st)tt[rt+st]=tt[st];it=_e}else{it+=_e;const st=_e/it;this._mixBufferRegion(tt,rt,0,st,nt)}this.cumulativeWeight=it}accumulateAdditive(_){const _e=this.buffer,tt=this.valueSize,nt=tt*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(_e,nt,0,_,tt),this.cumulativeWeightAdditive+=_}apply(_){const _e=this.valueSize,tt=this.buffer,nt=_*_e+_e,rt=this.cumulativeWeight,it=this.cumulativeWeightAdditive,st=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,rt<1){const ot=_e*this._origIndex;this._mixBufferRegion(tt,nt,ot,1-rt,_e)}it>0&&this._mixBufferRegionAdditive(tt,nt,this._addIndex*_e,1,_e);for(let ot=_e,at=_e+_e;ot!==at;++ot)if(tt[ot]!==tt[ot+_e]){st.setValue(tt,nt);break}}saveOriginalState(){const _=this.binding,_e=this.buffer,tt=this.valueSize,nt=tt*this._origIndex;_.getValue(_e,nt);for(let rt=tt,it=nt;rt!==it;++rt)_e[rt]=_e[nt+rt%tt];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _=this.valueSize*3;this.binding.setValue(this.buffer,_)}_setAdditiveIdentityNumeric(){const _=this._addIndex*this.valueSize,_e=_+this.valueSize;for(let tt=_;tt<_e;tt++)this.buffer[tt]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _=this._origIndex*this.valueSize,_e=this._addIndex*this.valueSize;for(let tt=0;tt<this.valueSize;tt++)this.buffer[_e+tt]=this.buffer[_+tt]}_select(_,_e,tt,nt,rt){if(nt>=.5)for(let it=0;it!==rt;++it)_[_e+it]=_[tt+it]}_slerp(_,_e,tt,nt){Quaternion.slerpFlat(_,_e,_,_e,_,tt,nt)}_slerpAdditive(_,_e,tt,nt,rt){const it=this._workIndex*rt;Quaternion.multiplyQuaternionsFlat(_,it,_,_e,_,tt),Quaternion.slerpFlat(_,_e,_,_e,_,it,nt)}_lerp(_,_e,tt,nt,rt){const it=1-nt;for(let st=0;st!==rt;++st){const ot=_e+st;_[ot]=_[ot]*it+_[tt+st]*nt}}_lerpAdditive(_,_e,tt,nt,rt){for(let it=0;it!==rt;++it){const st=_e+it;_[st]=_[st]+_[tt+it]*nt}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_,_e,tt){const nt=tt||PropertyBinding.parseTrackName(_e);this._targetGroup=_,this._bindings=_.subscribe_(_e,nt)}getValue(_,_e){this.bind();const tt=this._targetGroup.nCachedObjects_,nt=this._bindings[tt];nt!==void 0&&nt.getValue(_,_e)}setValue(_,_e){const tt=this._bindings;for(let nt=this._targetGroup.nCachedObjects_,rt=tt.length;nt!==rt;++nt)tt[nt].setValue(_,_e)}bind(){const _=this._bindings;for(let _e=this._targetGroup.nCachedObjects_,tt=_.length;_e!==tt;++_e)_[_e].bind()}unbind(){const _=this._bindings;for(let _e=this._targetGroup.nCachedObjects_,tt=_.length;_e!==tt;++_e)_[_e].unbind()}}class PropertyBinding{constructor(_,_e,tt){this.path=_e,this.parsedPath=tt||PropertyBinding.parseTrackName(_e),this.node=PropertyBinding.findNode(_,this.parsedPath.nodeName),this.rootNode=_,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_,_e,tt){return _&&_.isAnimationObjectGroup?new PropertyBinding.Composite(_,_e,tt):new PropertyBinding(_,_e,tt)}static sanitizeNodeName(_){return _.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_){const _e=_trackRe.exec(_);if(_e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_);const tt={nodeName:_e[2],objectName:_e[3],objectIndex:_e[4],propertyName:_e[5],propertyIndex:_e[6]},nt=tt.nodeName&&tt.nodeName.lastIndexOf(".");if(nt!==void 0&&nt!==-1){const rt=tt.nodeName.substring(nt+1);_supportedObjectNames.indexOf(rt)!==-1&&(tt.nodeName=tt.nodeName.substring(0,nt),tt.objectName=rt)}if(tt.propertyName===null||tt.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_);return tt}static findNode(_,_e){if(_e===void 0||_e===""||_e==="."||_e===-1||_e===_.name||_e===_.uuid)return _;if(_.skeleton){const tt=_.skeleton.getBoneByName(_e);if(tt!==void 0)return tt}if(_.children){const tt=function(rt){for(let it=0;it<rt.length;it++){const st=rt[it];if(st.name===_e||st.uuid===_e)return st;const ot=tt(st.children);if(ot)return ot}return null},nt=tt(_.children);if(nt)return nt}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_,_e){_[_e]=this.targetObject[this.propertyName]}_getValue_array(_,_e){const tt=this.resolvedProperty;for(let nt=0,rt=tt.length;nt!==rt;++nt)_[_e++]=tt[nt]}_getValue_arrayElement(_,_e){_[_e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_,_e){this.resolvedProperty.toArray(_,_e)}_setValue_direct(_,_e){this.targetObject[this.propertyName]=_[_e]}_setValue_direct_setNeedsUpdate(_,_e){this.targetObject[this.propertyName]=_[_e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_,_e){this.targetObject[this.propertyName]=_[_e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_,_e){const tt=this.resolvedProperty;for(let nt=0,rt=tt.length;nt!==rt;++nt)tt[nt]=_[_e++]}_setValue_array_setNeedsUpdate(_,_e){const tt=this.resolvedProperty;for(let nt=0,rt=tt.length;nt!==rt;++nt)tt[nt]=_[_e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_,_e){const tt=this.resolvedProperty;for(let nt=0,rt=tt.length;nt!==rt;++nt)tt[nt]=_[_e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_,_e){this.resolvedProperty[this.propertyIndex]=_[_e]}_setValue_arrayElement_setNeedsUpdate(_,_e){this.resolvedProperty[this.propertyIndex]=_[_e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_,_e){this.resolvedProperty[this.propertyIndex]=_[_e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_,_e){this.resolvedProperty.fromArray(_,_e)}_setValue_fromArray_setNeedsUpdate(_,_e){this.resolvedProperty.fromArray(_,_e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_,_e){this.resolvedProperty.fromArray(_,_e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_,_e){this.bind(),this.getValue(_,_e)}_setValue_unbound(_,_e){this.bind(),this.setValue(_,_e)}bind(){let _=this.node;const _e=this.parsedPath,tt=_e.objectName,nt=_e.propertyName;let rt=_e.propertyIndex;if(_||(_=PropertyBinding.findNode(this.rootNode,_e.nodeName),this.node=_),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(tt){let at=_e.objectIndex;switch(tt){case"materials":if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_=_.material.materials;break;case"bones":if(!_.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_=_.skeleton.bones;for(let lt=0;lt<_.length;lt++)if(_[lt].name===at){at=lt;break}break;case"map":if("map"in _){_=_.map;break}if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_=_.material.map;break;default:if(_[tt]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_=_[tt]}if(at!==void 0){if(_[at]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_);return}_=_[at]}}const it=_[nt];if(it===void 0){const at=_e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+at+"."+nt+" but it wasn't found.",_);return}let st=this.Versioning.None;this.targetObject=_,_.needsUpdate!==void 0?st=this.Versioning.NeedsUpdate:_.matrixWorldNeedsUpdate!==void 0&&(st=this.Versioning.MatrixWorldNeedsUpdate);let ot=this.BindingType.Direct;if(rt!==void 0){if(nt==="morphTargetInfluences"){if(!_.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_.morphTargetDictionary[rt]!==void 0&&(rt=_.morphTargetDictionary[rt])}ot=this.BindingType.ArrayElement,this.resolvedProperty=it,this.propertyIndex=rt}else it.fromArray!==void 0&&it.toArray!==void 0?(ot=this.BindingType.HasFromToArray,this.resolvedProperty=it):Array.isArray(it)?(ot=this.BindingType.EntireArray,this.resolvedProperty=it):this.propertyName=nt;this.getValue=this.GetterByBindingType[ot],this.setValue=this.SetterByBindingTypeAndVersioning[ot][st]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID$1(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _={};this._indicesByUUID=_;for(let tt=0,nt=arguments.length;tt!==nt;++tt)_[arguments[tt].uuid]=tt;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const _e=this;this.stats={objects:{get total(){return _e._objects.length},get inUse(){return this.total-_e.nCachedObjects_}},get bindingsPerObject(){return _e._bindings.length}}}add(){const _=this._objects,_e=this._indicesByUUID,tt=this._paths,nt=this._parsedPaths,rt=this._bindings,it=rt.length;let st,ot=_.length,at=this.nCachedObjects_;for(let lt=0,ct=arguments.length;lt!==ct;++lt){const ht=arguments[lt],ut=ht.uuid;let ft=_e[ut];if(ft===void 0){ft=ot++,_e[ut]=ft,_.push(ht);for(let dt=0,pt=it;dt!==pt;++dt)rt[dt].push(new PropertyBinding(ht,tt[dt],nt[dt]))}else if(ft<at){st=_[ft];const dt=--at,pt=_[dt];_e[pt.uuid]=ft,_[ft]=pt,_e[ut]=dt,_[dt]=ht;for(let mt=0,vt=it;mt!==vt;++mt){const yt=rt[mt],_t=yt[dt];let St=yt[ft];yt[ft]=_t,St===void 0&&(St=new PropertyBinding(ht,tt[mt],nt[mt])),yt[dt]=St}}else _[ft]!==st&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=at}remove(){const _=this._objects,_e=this._indicesByUUID,tt=this._bindings,nt=tt.length;let rt=this.nCachedObjects_;for(let it=0,st=arguments.length;it!==st;++it){const ot=arguments[it],at=ot.uuid,lt=_e[at];if(lt!==void 0&&lt>=rt){const ct=rt++,ht=_[ct];_e[ht.uuid]=lt,_[lt]=ht,_e[at]=ct,_[ct]=ot;for(let ut=0,ft=nt;ut!==ft;++ut){const dt=tt[ut],pt=dt[ct],mt=dt[lt];dt[lt]=pt,dt[ct]=mt}}}this.nCachedObjects_=rt}uncache(){const _=this._objects,_e=this._indicesByUUID,tt=this._bindings,nt=tt.length;let rt=this.nCachedObjects_,it=_.length;for(let st=0,ot=arguments.length;st!==ot;++st){const at=arguments[st],lt=at.uuid,ct=_e[lt];if(ct!==void 0)if(delete _e[lt],ct<rt){const ht=--rt,ut=_[ht],ft=--it,dt=_[ft];_e[ut.uuid]=ct,_[ct]=ut,_e[dt.uuid]=ht,_[ht]=dt,_.pop();for(let pt=0,mt=nt;pt!==mt;++pt){const vt=tt[pt],yt=vt[ht],_t=vt[ft];vt[ct]=yt,vt[ht]=_t,vt.pop()}}else{const ht=--it,ut=_[ht];ht>0&&(_e[ut.uuid]=ct),_[ct]=ut,_.pop();for(let ft=0,dt=nt;ft!==dt;++ft){const pt=tt[ft];pt[ct]=pt[ht],pt.pop()}}}this.nCachedObjects_=rt}subscribe_(_,_e){const tt=this._bindingsIndicesByPath;let nt=tt[_];const rt=this._bindings;if(nt!==void 0)return rt[nt];const it=this._paths,st=this._parsedPaths,ot=this._objects,at=ot.length,lt=this.nCachedObjects_,ct=new Array(at);nt=rt.length,tt[_]=nt,it.push(_),st.push(_e),rt.push(ct);for(let ht=lt,ut=ot.length;ht!==ut;++ht){const ft=ot[ht];ct[ht]=new PropertyBinding(ft,_,_e)}return ct}unsubscribe_(_){const _e=this._bindingsIndicesByPath,tt=_e[_];if(tt!==void 0){const nt=this._paths,rt=this._parsedPaths,it=this._bindings,st=it.length-1,ot=it[st],at=_[st];_e[at]=tt,it[tt]=ot,it.pop(),rt[tt]=rt[st],rt.pop(),nt[tt]=nt[st],nt.pop()}}}class AnimationAction{constructor(_,_e,tt=null,nt=_e.blendMode){this._mixer=_,this._clip=_e,this._localRoot=tt,this.blendMode=nt;const rt=_e.tracks,it=rt.length,st=new Array(it),ot={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let at=0;at!==it;++at){const lt=rt[at].createInterpolant(null);st[at]=lt,lt.settings=ot}this._interpolantSettings=ot,this._interpolants=st,this._propertyBindings=new Array(it),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_){return this._startTime=_,this}setLoop(_,_e){return this.loop=_,this.repetitions=_e,this}setEffectiveWeight(_){return this.weight=_,this._effectiveWeight=this.enabled?_:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_){return this._scheduleFading(_,0,1)}fadeOut(_){return this._scheduleFading(_,1,0)}crossFadeFrom(_,_e,tt){if(_.fadeOut(_e),this.fadeIn(_e),tt){const nt=this._clip.duration,rt=_._clip.duration,it=rt/nt,st=nt/rt;_.warp(1,it,_e),this.warp(st,1,_e)}return this}crossFadeTo(_,_e,tt){return _.crossFadeFrom(this,_e,tt)}stopFading(){const _=this._weightInterpolant;return _!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}setEffectiveTimeScale(_){return this.timeScale=_,this._effectiveTimeScale=this.paused?0:_,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_){return this.timeScale=this._clip.duration/_,this.stopWarping()}syncWith(_){return this.time=_.time,this.timeScale=_.timeScale,this.stopWarping()}halt(_){return this.warp(this._effectiveTimeScale,0,_)}warp(_,_e,tt){const nt=this._mixer,rt=nt.time,it=this.timeScale;let st=this._timeScaleInterpolant;st===null&&(st=nt._lendControlInterpolant(),this._timeScaleInterpolant=st);const ot=st.parameterPositions,at=st.sampleValues;return ot[0]=rt,ot[1]=rt+tt,at[0]=_/it,at[1]=_e/it,this}stopWarping(){const _=this._timeScaleInterpolant;return _!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_,_e,tt,nt){if(!this.enabled){this._updateWeight(_);return}const rt=this._startTime;if(rt!==null){const ot=(_-rt)*tt;ot<0||tt===0?_e=0:(this._startTime=null,_e=tt*ot)}_e*=this._updateTimeScale(_);const it=this._updateTime(_e),st=this._updateWeight(_);if(st>0){const ot=this._interpolants,at=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let lt=0,ct=ot.length;lt!==ct;++lt)ot[lt].evaluate(it),at[lt].accumulateAdditive(st);break;case NormalAnimationBlendMode:default:for(let lt=0,ct=ot.length;lt!==ct;++lt)ot[lt].evaluate(it),at[lt].accumulate(nt,st)}}}_updateWeight(_){let _e=0;if(this.enabled){_e=this.weight;const tt=this._weightInterpolant;if(tt!==null){const nt=tt.evaluate(_)[0];_e*=nt,_>tt.parameterPositions[1]&&(this.stopFading(),nt===0&&(this.enabled=!1))}}return this._effectiveWeight=_e,_e}_updateTimeScale(_){let _e=0;if(!this.paused){_e=this.timeScale;const tt=this._timeScaleInterpolant;if(tt!==null){const nt=tt.evaluate(_)[0];_e*=nt,_>tt.parameterPositions[1]&&(this.stopWarping(),_e===0?this.paused=!0:this.timeScale=_e)}}return this._effectiveTimeScale=_e,_e}_updateTime(_){const _e=this._clip.duration,tt=this.loop;let nt=this.time+_,rt=this._loopCount;const it=tt===LoopPingPong;if(_===0)return rt===-1?nt:it&&(rt&1)===1?_e-nt:nt;if(tt===LoopOnce){rt===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(nt>=_e)nt=_e;else if(nt<0)nt=0;else{this.time=nt;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=nt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_<0?-1:1})}}else{if(rt===-1&&(_>=0?(rt=0,this._setEndings(!0,this.repetitions===0,it)):this._setEndings(this.repetitions===0,!0,it)),nt>=_e||nt<0){const st=Math.floor(nt/_e);nt-=_e*st,rt+=Math.abs(st);const ot=this.repetitions-rt;if(ot<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,nt=_>0?_e:0,this.time=nt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_>0?1:-1});else{if(ot===1){const at=_<0;this._setEndings(at,!at,it)}else this._setEndings(!1,!1,it);this._loopCount=rt,this.time=nt,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:st})}}else this.time=nt;if(it&&(rt&1)===1)return _e-nt}return nt}_setEndings(_,_e,tt){const nt=this._interpolantSettings;tt?(nt.endingStart=ZeroSlopeEnding,nt.endingEnd=ZeroSlopeEnding):(_?nt.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:nt.endingStart=WrapAroundEnding,_e?nt.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:nt.endingEnd=WrapAroundEnding)}_scheduleFading(_,_e,tt){const nt=this._mixer,rt=nt.time;let it=this._weightInterpolant;it===null&&(it=nt._lendControlInterpolant(),this._weightInterpolant=it);const st=it.parameterPositions,ot=it.sampleValues;return st[0]=rt,ot[0]=_e,st[1]=rt+_,ot[1]=tt,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(_){super(),this._root=_,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_,_e){const tt=_._localRoot||this._root,nt=_._clip.tracks,rt=nt.length,it=_._propertyBindings,st=_._interpolants,ot=tt.uuid,at=this._bindingsByRootAndName;let lt=at[ot];lt===void 0&&(lt={},at[ot]=lt);for(let ct=0;ct!==rt;++ct){const ht=nt[ct],ut=ht.name;let ft=lt[ut];if(ft!==void 0)++ft.referenceCount,it[ct]=ft;else{if(ft=it[ct],ft!==void 0){ft._cacheIndex===null&&(++ft.referenceCount,this._addInactiveBinding(ft,ot,ut));continue}const dt=_e&&_e._propertyBindings[ct].binding.parsedPath;ft=new PropertyMixer(PropertyBinding.create(tt,ut,dt),ht.ValueTypeName,ht.getValueSize()),++ft.referenceCount,this._addInactiveBinding(ft,ot,ut),it[ct]=ft}st[ct].resultBuffer=ft.buffer}}_activateAction(_){if(!this._isActiveAction(_)){if(_._cacheIndex===null){const tt=(_._localRoot||this._root).uuid,nt=_._clip.uuid,rt=this._actionsByClip[nt];this._bindAction(_,rt&&rt.knownActions[0]),this._addInactiveAction(_,nt,tt)}const _e=_._propertyBindings;for(let tt=0,nt=_e.length;tt!==nt;++tt){const rt=_e[tt];rt.useCount++===0&&(this._lendBinding(rt),rt.saveOriginalState())}this._lendAction(_)}}_deactivateAction(_){if(this._isActiveAction(_)){const _e=_._propertyBindings;for(let tt=0,nt=_e.length;tt!==nt;++tt){const rt=_e[tt];--rt.useCount===0&&(rt.restoreOriginalState(),this._takeBackBinding(rt))}this._takeBackAction(_)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _=this;this.stats={actions:{get total(){return _._actions.length},get inUse(){return _._nActiveActions}},bindings:{get total(){return _._bindings.length},get inUse(){return _._nActiveBindings}},controlInterpolants:{get total(){return _._controlInterpolants.length},get inUse(){return _._nActiveControlInterpolants}}}}_isActiveAction(_){const _e=_._cacheIndex;return _e!==null&&_e<this._nActiveActions}_addInactiveAction(_,_e,tt){const nt=this._actions,rt=this._actionsByClip;let it=rt[_e];if(it===void 0)it={knownActions:[_],actionByRoot:{}},_._byClipCacheIndex=0,rt[_e]=it;else{const st=it.knownActions;_._byClipCacheIndex=st.length,st.push(_)}_._cacheIndex=nt.length,nt.push(_),it.actionByRoot[tt]=_}_removeInactiveAction(_){const _e=this._actions,tt=_e[_e.length-1],nt=_._cacheIndex;tt._cacheIndex=nt,_e[nt]=tt,_e.pop(),_._cacheIndex=null;const rt=_._clip.uuid,it=this._actionsByClip,st=it[rt],ot=st.knownActions,at=ot[ot.length-1],lt=_._byClipCacheIndex;at._byClipCacheIndex=lt,ot[lt]=at,ot.pop(),_._byClipCacheIndex=null;const ct=st.actionByRoot,ht=(_._localRoot||this._root).uuid;delete ct[ht],ot.length===0&&delete it[rt],this._removeInactiveBindingsForAction(_)}_removeInactiveBindingsForAction(_){const _e=_._propertyBindings;for(let tt=0,nt=_e.length;tt!==nt;++tt){const rt=_e[tt];--rt.referenceCount===0&&this._removeInactiveBinding(rt)}}_lendAction(_){const _e=this._actions,tt=_._cacheIndex,nt=this._nActiveActions++,rt=_e[nt];_._cacheIndex=nt,_e[nt]=_,rt._cacheIndex=tt,_e[tt]=rt}_takeBackAction(_){const _e=this._actions,tt=_._cacheIndex,nt=--this._nActiveActions,rt=_e[nt];_._cacheIndex=nt,_e[nt]=_,rt._cacheIndex=tt,_e[tt]=rt}_addInactiveBinding(_,_e,tt){const nt=this._bindingsByRootAndName,rt=this._bindings;let it=nt[_e];it===void 0&&(it={},nt[_e]=it),it[tt]=_,_._cacheIndex=rt.length,rt.push(_)}_removeInactiveBinding(_){const _e=this._bindings,tt=_.binding,nt=tt.rootNode.uuid,rt=tt.path,it=this._bindingsByRootAndName,st=it[nt],ot=_e[_e.length-1],at=_._cacheIndex;ot._cacheIndex=at,_e[at]=ot,_e.pop(),delete st[rt],Object.keys(st).length===0&&delete it[nt]}_lendBinding(_){const _e=this._bindings,tt=_._cacheIndex,nt=this._nActiveBindings++,rt=_e[nt];_._cacheIndex=nt,_e[nt]=_,rt._cacheIndex=tt,_e[tt]=rt}_takeBackBinding(_){const _e=this._bindings,tt=_._cacheIndex,nt=--this._nActiveBindings,rt=_e[nt];_._cacheIndex=nt,_e[nt]=_,rt._cacheIndex=tt,_e[tt]=rt}_lendControlInterpolant(){const _=this._controlInterpolants,_e=this._nActiveControlInterpolants++;let tt=_[_e];return tt===void 0&&(tt=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),tt.__cacheIndex=_e,_[_e]=tt),tt}_takeBackControlInterpolant(_){const _e=this._controlInterpolants,tt=_.__cacheIndex,nt=--this._nActiveControlInterpolants,rt=_e[nt];_.__cacheIndex=nt,_e[nt]=_,rt.__cacheIndex=tt,_e[tt]=rt}clipAction(_,_e,tt){const nt=_e||this._root,rt=nt.uuid;let it=typeof _=="string"?AnimationClip.findByName(nt,_):_;const st=it!==null?it.uuid:_,ot=this._actionsByClip[st];let at=null;if(tt===void 0&&(it!==null?tt=it.blendMode:tt=NormalAnimationBlendMode),ot!==void 0){const ct=ot.actionByRoot[rt];if(ct!==void 0&&ct.blendMode===tt)return ct;at=ot.knownActions[0],it===null&&(it=at._clip)}if(it===null)return null;const lt=new AnimationAction(this,it,_e,tt);return this._bindAction(lt,at),this._addInactiveAction(lt,st,rt),lt}existingAction(_,_e){const tt=_e||this._root,nt=tt.uuid,rt=typeof _=="string"?AnimationClip.findByName(tt,_):_,it=rt?rt.uuid:_,st=this._actionsByClip[it];return st!==void 0&&st.actionByRoot[nt]||null}stopAllAction(){const _=this._actions,_e=this._nActiveActions;for(let tt=_e-1;tt>=0;--tt)_[tt].stop();return this}update(_){_*=this.timeScale;const _e=this._actions,tt=this._nActiveActions,nt=this.time+=_,rt=Math.sign(_),it=this._accuIndex^=1;for(let at=0;at!==tt;++at)_e[at]._update(nt,_,rt,it);const st=this._bindings,ot=this._nActiveBindings;for(let at=0;at!==ot;++at)st[at].apply(it);return this}setTime(_){this.time=0;for(let _e=0;_e<this._actions.length;_e++)this._actions[_e].time=0;return this.update(_)}getRoot(){return this._root}uncacheClip(_){const _e=this._actions,tt=_.uuid,nt=this._actionsByClip,rt=nt[tt];if(rt!==void 0){const it=rt.knownActions;for(let st=0,ot=it.length;st!==ot;++st){const at=it[st];this._deactivateAction(at);const lt=at._cacheIndex,ct=_e[_e.length-1];at._cacheIndex=null,at._byClipCacheIndex=null,ct._cacheIndex=lt,_e[lt]=ct,_e.pop(),this._removeInactiveBindingsForAction(at)}delete nt[tt]}}uncacheRoot(_){const _e=_.uuid,tt=this._actionsByClip;for(const it in tt){const st=tt[it].actionByRoot,ot=st[_e];ot!==void 0&&(this._deactivateAction(ot),this._removeInactiveAction(ot))}const nt=this._bindingsByRootAndName,rt=nt[_e];if(rt!==void 0)for(const it in rt){const st=rt[it];st.restoreOriginalState(),this._removeInactiveBinding(st)}}uncacheAction(_,_e){const tt=this.existingAction(_,_e);tt!==null&&(this._deactivateAction(tt),this._removeInactiveAction(tt))}}class Uniform{constructor(_){this.value=_}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let _id=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_){return this.uniforms.push(_),this}remove(_){const _e=this.uniforms.indexOf(_);return _e!==-1&&this.uniforms.splice(_e,1),this}setName(_){return this.name=_,this}setUsage(_){return this.usage=_,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_){this.name=_.name,this.usage=_.usage;const _e=_.uniforms;this.uniforms.length=0;for(let tt=0,nt=_e.length;tt<nt;tt++){const rt=Array.isArray(_e[tt])?_e[tt]:[_e[tt]];for(let it=0;it<rt.length;it++)this.uniforms.push(rt[it].clone())}return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_,_e,tt=1){super(_,_e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=tt}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}clone(_){const _e=super.clone(_);return _e.meshPerAttribute=this.meshPerAttribute,_e}toJSON(_){const _e=super.toJSON(_);return _e.isInstancedInterleavedBuffer=!0,_e.meshPerAttribute=this.meshPerAttribute,_e}}class GLBufferAttribute{constructor(_,_e,tt,nt,rt){this.isGLBufferAttribute=!0,this.name="",this.buffer=_,this.type=_e,this.itemSize=tt,this.elementSize=nt,this.count=rt,this.version=0}set needsUpdate(_){_===!0&&this.version++}setBuffer(_){return this.buffer=_,this}setType(_,_e){return this.type=_,this.elementSize=_e,this}setItemSize(_){return this.itemSize=_,this}setCount(_){return this.count=_,this}}const _matrix=new Matrix4;class Raycaster{constructor(_,_e,tt=0,nt=1/0){this.ray=new Ray(_,_e),this.near=tt,this.far=nt,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_,_e){this.ray.set(_,_e)}setFromCamera(_,_e){_e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(_e.matrixWorld),this.ray.direction.set(_.x,_.y,.5).unproject(_e).sub(this.ray.origin).normalize(),this.camera=_e):_e.isOrthographicCamera?(this.ray.origin.set(_.x,_.y,(_e.near+_e.far)/(_e.near-_e.far)).unproject(_e),this.ray.direction.set(0,0,-1).transformDirection(_e.matrixWorld),this.camera=_e):console.error("THREE.Raycaster: Unsupported camera type: "+_e.type)}setFromXRController(_){return _matrix.identity().extractRotation(_.matrixWorld),this.ray.origin.setFromMatrixPosition(_.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_matrix),this}intersectObject(_,_e=!0,tt=[]){return intersect(_,this,tt,_e),tt.sort(ascSort),tt}intersectObjects(_,_e=!0,tt=[]){for(let nt=0,rt=_.length;nt<rt;nt++)intersect(_[nt],this,tt,_e);return tt.sort(ascSort),tt}}function ascSort(et,_){return et.distance-_.distance}function intersect(et,_,_e,tt){let nt=!0;if(et.layers.test(_.layers)&&et.raycast(_,_e)===!1&&(nt=!1),nt===!0&&tt===!0){const rt=et.children;for(let it=0,st=rt.length;it<st;it++)intersect(rt[it],_,_e,!0)}}class Spherical{constructor(_=1,_e=0,tt=0){return this.radius=_,this.phi=_e,this.theta=tt,this}set(_,_e,tt){return this.radius=_,this.phi=_e,this.theta=tt,this}copy(_){return this.radius=_.radius,this.phi=_.phi,this.theta=_.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,_e,tt){return this.radius=Math.sqrt(_*_+_e*_e+tt*tt),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_,tt),this.phi=Math.acos(clamp$1(_e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_=1,_e=0,tt=0){return this.radius=_,this.theta=_e,this.y=tt,this}set(_,_e,tt){return this.radius=_,this.theta=_e,this.y=tt,this}copy(_){return this.radius=_.radius,this.theta=_.theta,this.y=_.y,this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,_e,tt){return this.radius=Math.sqrt(_*_+tt*tt),this.theta=Math.atan2(_,tt),this.y=_e,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(_=new Vector2(1/0,1/0),_e=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_,this.max=_e}set(_,_e){return this.min.copy(_),this.max.copy(_e),this}setFromPoints(_){this.makeEmpty();for(let _e=0,tt=_.length;_e<tt;_e++)this.expandByPoint(_[_e]);return this}setFromCenterAndSize(_,_e){const tt=_vector$4.copy(_e).multiplyScalar(.5);return this.min.copy(_).sub(tt),this.max.copy(_).add(tt),this}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_){return this.isEmpty()?_.set(0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y}getParameter(_,_e){return _e.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y)}clampPoint(_,_e){return _e.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$4).distanceTo(_)}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_=new Vector3,_e=new Vector3){this.start=_,this.end=_e}set(_,_e){return this.start.copy(_),this.end.copy(_e),this}copy(_){return this.start.copy(_.start),this.end.copy(_.end),this}getCenter(_){return _.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_){return _.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_,_e){return this.delta(_e).multiplyScalar(_).add(this.start)}closestPointToPointParameter(_,_e){_startP.subVectors(_,this.start),_startEnd.subVectors(this.end,this.start);const tt=_startEnd.dot(_startEnd);let rt=_startEnd.dot(_startP)/tt;return _e&&(rt=clamp$1(rt,0,1)),rt}closestPointToPoint(_,_e,tt){const nt=this.closestPointToPointParameter(_,_e);return this.delta(tt).multiplyScalar(nt).add(this.start)}applyMatrix4(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this}equals(_){return _.start.equals(this.start)&&_.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_,_e){super(),this.light=_,this.matrixAutoUpdate=!1,this.color=_e,this.type="SpotLightHelper";const tt=new BufferGeometry,nt=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let it=0,st=1,ot=32;it<ot;it++,st++){const at=it/ot*Math.PI*2,lt=st/ot*Math.PI*2;nt.push(Math.cos(at),Math.sin(at),1,Math.cos(lt),Math.sin(lt),1)}tt.setAttribute("position",new Float32BufferAttribute(nt,3));const rt=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(tt,rt),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const _=this.light.distance?this.light.distance:1e3,_e=_*Math.tan(this.light.angle);this.cone.scale.set(_e,_e,_),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_){const _e=getBoneList(_),tt=new BufferGeometry,nt=[],rt=[],it=new Color$1(0,0,1),st=new Color$1(0,1,0);for(let at=0;at<_e.length;at++){const lt=_e[at];lt.parent&&lt.parent.isBone&&(nt.push(0,0,0),nt.push(0,0,0),rt.push(it.r,it.g,it.b),rt.push(st.r,st.g,st.b))}tt.setAttribute("position",new Float32BufferAttribute(nt,3)),tt.setAttribute("color",new Float32BufferAttribute(rt,3));const ot=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(tt,ot),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_,this.bones=_e,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_){const _e=this.bones,tt=this.geometry,nt=tt.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let rt=0,it=0;rt<_e.length;rt++){const st=_e[rt];st.parent&&st.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,st.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),nt.setXYZ(it,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,st.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),nt.setXYZ(it+1,_vector$2.x,_vector$2.y,_vector$2.z),it+=2)}tt.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(et){const _=[];et.isBone===!0&&_.push(et);for(let _e=0;_e<et.children.length;_e++)_.push.apply(_,getBoneList(et.children[_e]));return _}class PointLightHelper extends Mesh{constructor(_,_e,tt){const nt=new SphereGeometry(_e,4,2),rt=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(nt,rt),this.light=_,this.color=tt,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color$1,_color2=new Color$1;class HemisphereLightHelper extends Object3D{constructor(_,_e,tt){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=tt,this.type="HemisphereLightHelper";const nt=new OctahedronGeometry(_e);nt.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const rt=nt.getAttribute("position"),it=new Float32Array(rt.count*3);nt.setAttribute("color",new BufferAttribute(it,3)),this.add(new Mesh(nt,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const _e=_.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let tt=0,nt=_e.count;tt<nt;tt++){const rt=tt<nt/2?_color1:_color2;_e.setXYZ(tt,rt.r,rt.g,rt.b)}_e.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_=10,_e=10,tt=4473924,nt=8947848){tt=new Color$1(tt),nt=new Color$1(nt);const rt=_e/2,it=_/_e,st=_/2,ot=[],at=[];for(let ht=0,ut=0,ft=-st;ht<=_e;ht++,ft+=it){ot.push(-st,0,ft,st,0,ft),ot.push(ft,0,-st,ft,0,st);const dt=ht===rt?tt:nt;dt.toArray(at,ut),ut+=3,dt.toArray(at,ut),ut+=3,dt.toArray(at,ut),ut+=3,dt.toArray(at,ut),ut+=3}const lt=new BufferGeometry;lt.setAttribute("position",new Float32BufferAttribute(ot,3)),lt.setAttribute("color",new Float32BufferAttribute(at,3));const ct=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(lt,ct),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_=10,_e=16,tt=8,nt=64,rt=4473924,it=8947848){rt=new Color$1(rt),it=new Color$1(it);const st=[],ot=[];if(_e>1)for(let ct=0;ct<_e;ct++){const ht=ct/_e*(Math.PI*2),ut=Math.sin(ht)*_,ft=Math.cos(ht)*_;st.push(0,0,0),st.push(ut,0,ft);const dt=ct&1?rt:it;ot.push(dt.r,dt.g,dt.b),ot.push(dt.r,dt.g,dt.b)}for(let ct=0;ct<tt;ct++){const ht=ct&1?rt:it,ut=_-_/tt*ct;for(let ft=0;ft<nt;ft++){let dt=ft/nt*(Math.PI*2),pt=Math.sin(dt)*ut,mt=Math.cos(dt)*ut;st.push(pt,0,mt),ot.push(ht.r,ht.g,ht.b),dt=(ft+1)/nt*(Math.PI*2),pt=Math.sin(dt)*ut,mt=Math.cos(dt)*ut,st.push(pt,0,mt),ot.push(ht.r,ht.g,ht.b)}}const at=new BufferGeometry;at.setAttribute("position",new Float32BufferAttribute(st,3)),at.setAttribute("color",new Float32BufferAttribute(ot,3));const lt=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(at,lt),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_,_e,tt){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=tt,this.type="DirectionalLightHelper",_e===void 0&&(_e=1);let nt=new BufferGeometry;nt.setAttribute("position",new Float32BufferAttribute([-_e,_e,0,_e,_e,0,_e,-_e,0,-_e,-_e,0,-_e,_e,0],3));const rt=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(nt,rt),this.add(this.lightPlane),nt=new BufferGeometry,nt.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(nt,rt),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(_){const _e=new BufferGeometry,tt=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),nt=[],rt=[],it={};st("n1","n2"),st("n2","n4"),st("n4","n3"),st("n3","n1"),st("f1","f2"),st("f2","f4"),st("f4","f3"),st("f3","f1"),st("n1","f1"),st("n2","f2"),st("n3","f3"),st("n4","f4"),st("p","n1"),st("p","n2"),st("p","n3"),st("p","n4"),st("u1","u2"),st("u2","u3"),st("u3","u1"),st("c","t"),st("p","c"),st("cn1","cn2"),st("cn3","cn4"),st("cf1","cf2"),st("cf3","cf4");function st(ft,dt){ot(ft),ot(dt)}function ot(ft){nt.push(0,0,0),rt.push(0,0,0),it[ft]===void 0&&(it[ft]=[]),it[ft].push(nt.length/3-1)}_e.setAttribute("position",new Float32BufferAttribute(nt,3)),_e.setAttribute("color",new Float32BufferAttribute(rt,3)),super(_e,tt),this.type="CameraHelper",this.camera=_,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=it,this.update();const at=new Color$1(16755200),lt=new Color$1(16711680),ct=new Color$1(43775),ht=new Color$1(16777215),ut=new Color$1(3355443);this.setColors(at,lt,ct,ht,ut)}setColors(_,_e,tt,nt,rt){const st=this.geometry.getAttribute("color");st.setXYZ(0,_.r,_.g,_.b),st.setXYZ(1,_.r,_.g,_.b),st.setXYZ(2,_.r,_.g,_.b),st.setXYZ(3,_.r,_.g,_.b),st.setXYZ(4,_.r,_.g,_.b),st.setXYZ(5,_.r,_.g,_.b),st.setXYZ(6,_.r,_.g,_.b),st.setXYZ(7,_.r,_.g,_.b),st.setXYZ(8,_.r,_.g,_.b),st.setXYZ(9,_.r,_.g,_.b),st.setXYZ(10,_.r,_.g,_.b),st.setXYZ(11,_.r,_.g,_.b),st.setXYZ(12,_.r,_.g,_.b),st.setXYZ(13,_.r,_.g,_.b),st.setXYZ(14,_.r,_.g,_.b),st.setXYZ(15,_.r,_.g,_.b),st.setXYZ(16,_.r,_.g,_.b),st.setXYZ(17,_.r,_.g,_.b),st.setXYZ(18,_.r,_.g,_.b),st.setXYZ(19,_.r,_.g,_.b),st.setXYZ(20,_.r,_.g,_.b),st.setXYZ(21,_.r,_.g,_.b),st.setXYZ(22,_.r,_.g,_.b),st.setXYZ(23,_.r,_.g,_.b),st.setXYZ(24,_e.r,_e.g,_e.b),st.setXYZ(25,_e.r,_e.g,_e.b),st.setXYZ(26,_e.r,_e.g,_e.b),st.setXYZ(27,_e.r,_e.g,_e.b),st.setXYZ(28,_e.r,_e.g,_e.b),st.setXYZ(29,_e.r,_e.g,_e.b),st.setXYZ(30,_e.r,_e.g,_e.b),st.setXYZ(31,_e.r,_e.g,_e.b),st.setXYZ(32,tt.r,tt.g,tt.b),st.setXYZ(33,tt.r,tt.g,tt.b),st.setXYZ(34,tt.r,tt.g,tt.b),st.setXYZ(35,tt.r,tt.g,tt.b),st.setXYZ(36,tt.r,tt.g,tt.b),st.setXYZ(37,tt.r,tt.g,tt.b),st.setXYZ(38,nt.r,nt.g,nt.b),st.setXYZ(39,nt.r,nt.g,nt.b),st.setXYZ(40,rt.r,rt.g,rt.b),st.setXYZ(41,rt.r,rt.g,rt.b),st.setXYZ(42,rt.r,rt.g,rt.b),st.setXYZ(43,rt.r,rt.g,rt.b),st.setXYZ(44,rt.r,rt.g,rt.b),st.setXYZ(45,rt.r,rt.g,rt.b),st.setXYZ(46,rt.r,rt.g,rt.b),st.setXYZ(47,rt.r,rt.g,rt.b),st.setXYZ(48,rt.r,rt.g,rt.b),st.setXYZ(49,rt.r,rt.g,rt.b),st.needsUpdate=!0}update(){const _=this.geometry,_e=this.pointMap,tt=1,nt=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",_e,_,_camera,0,0,-1),setPoint("t",_e,_,_camera,0,0,1),setPoint("n1",_e,_,_camera,-tt,-nt,-1),setPoint("n2",_e,_,_camera,tt,-nt,-1),setPoint("n3",_e,_,_camera,-tt,nt,-1),setPoint("n4",_e,_,_camera,tt,nt,-1),setPoint("f1",_e,_,_camera,-tt,-nt,1),setPoint("f2",_e,_,_camera,tt,-nt,1),setPoint("f3",_e,_,_camera,-tt,nt,1),setPoint("f4",_e,_,_camera,tt,nt,1),setPoint("u1",_e,_,_camera,tt*.7,nt*1.1,-1),setPoint("u2",_e,_,_camera,-tt*.7,nt*1.1,-1),setPoint("u3",_e,_,_camera,0,nt*2,-1),setPoint("cf1",_e,_,_camera,-tt,0,1),setPoint("cf2",_e,_,_camera,tt,0,1),setPoint("cf3",_e,_,_camera,0,-nt,1),setPoint("cf4",_e,_,_camera,0,nt,1),setPoint("cn1",_e,_,_camera,-tt,0,-1),setPoint("cn2",_e,_,_camera,tt,0,-1),setPoint("cn3",_e,_,_camera,0,-nt,-1),setPoint("cn4",_e,_,_camera,0,nt,-1),_.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(et,_,_e,tt,nt,rt,it){_vector.set(nt,rt,it).unproject(tt);const st=_[et];if(st!==void 0){const ot=_e.getAttribute("position");for(let at=0,lt=st.length;at<lt;at++)ot.setXYZ(st[at],_vector.x,_vector.y,_vector.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(_,_e=16776960){const tt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),nt=new Float32Array(8*3),rt=new BufferGeometry;rt.setIndex(new BufferAttribute(tt,1)),rt.setAttribute("position",new BufferAttribute(nt,3)),super(rt,new LineBasicMaterial({color:_e,toneMapped:!1})),this.object=_,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_){if(_!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const _e=_box.min,tt=_box.max,nt=this.geometry.attributes.position,rt=nt.array;rt[0]=tt.x,rt[1]=tt.y,rt[2]=tt.z,rt[3]=_e.x,rt[4]=tt.y,rt[5]=tt.z,rt[6]=_e.x,rt[7]=_e.y,rt[8]=tt.z,rt[9]=tt.x,rt[10]=_e.y,rt[11]=tt.z,rt[12]=tt.x,rt[13]=tt.y,rt[14]=_e.z,rt[15]=_e.x,rt[16]=tt.y,rt[17]=_e.z,rt[18]=_e.x,rt[19]=_e.y,rt[20]=_e.z,rt[21]=tt.x,rt[22]=_e.y,rt[23]=_e.z,nt.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_){return this.object=_,this.update(),this}copy(_,_e){return super.copy(_,_e),this.object=_.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_,_e=16776960){const tt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),nt=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],rt=new BufferGeometry;rt.setIndex(new BufferAttribute(tt,1)),rt.setAttribute("position",new Float32BufferAttribute(nt,3)),super(rt,new LineBasicMaterial({color:_e,toneMapped:!1})),this.box=_,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_){const _e=this.box;_e.isEmpty()||(_e.getCenter(this.position),_e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(_,_e=1,tt=16776960){const nt=tt,rt=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],it=new BufferGeometry;it.setAttribute("position",new Float32BufferAttribute(rt,3)),it.computeBoundingSphere(),super(it,new LineBasicMaterial({color:nt,toneMapped:!1})),this.type="PlaneHelper",this.plane=_,this.size=_e;const st=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],ot=new BufferGeometry;ot.setAttribute("position",new Float32BufferAttribute(st,3)),ot.computeBoundingSphere(),this.add(new Mesh(ot,new MeshBasicMaterial({color:nt,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_=new Vector3(0,0,1),_e=new Vector3(0,0,0),tt=1,nt=16776960,rt=tt*.2,it=rt*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(_e),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:nt,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:nt,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_),this.setLength(tt,rt,it)}setDirection(_){if(_.y>.99999)this.quaternion.set(0,0,0,1);else if(_.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_.z,0,-_.x).normalize();const _e=Math.acos(_.y);this.quaternion.setFromAxisAngle(_axis,_e)}}setLength(_,_e=_*.2,tt=_e*.2){this.line.scale.set(1,Math.max(1e-4,_-_e),1),this.line.updateMatrix(),this.cone.scale.set(tt,_e,tt),this.cone.position.y=_,this.cone.updateMatrix()}setColor(_){this.line.material.color.set(_),this.cone.material.color.set(_)}copy(_){return super.copy(_,!1),this.line.copy(_.line),this.cone.copy(_.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_=1){const _e=[0,0,0,_,0,0,0,0,0,0,_,0,0,0,0,0,0,_],tt=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],nt=new BufferGeometry;nt.setAttribute("position",new Float32BufferAttribute(_e,3)),nt.setAttribute("color",new Float32BufferAttribute(tt,3));const rt=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(nt,rt),this.type="AxesHelper"}setColors(_,_e,tt){const nt=new Color$1,rt=this.geometry.attributes.color.array;return nt.set(_),nt.toArray(rt,0),nt.toArray(rt,3),nt.set(_e),nt.toArray(rt,6),nt.toArray(rt,9),nt.set(tt),nt.toArray(rt,12),nt.toArray(rt,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}let ShapePath$1=class{constructor(){this.type="ShapePath",this.color=new Color$1,this.subPaths=[],this.currentPath=null}moveTo(_,_e){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_,_e),this}lineTo(_,_e){return this.currentPath.lineTo(_,_e),this}quadraticCurveTo(_,_e,tt,nt){return this.currentPath.quadraticCurveTo(_,_e,tt,nt),this}bezierCurveTo(_,_e,tt,nt,rt,it){return this.currentPath.bezierCurveTo(_,_e,tt,nt,rt,it),this}splineThru(_){return this.currentPath.splineThru(_),this}toShapes(_){function _e(mt){const vt=[];for(let yt=0,_t=mt.length;yt<_t;yt++){const St=mt[yt],bt=new Shape$1;bt.curves=St.curves,vt.push(bt)}return vt}function tt(mt,vt){const yt=vt.length;let _t=!1;for(let St=yt-1,bt=0;bt<yt;St=bt++){let Et=vt[St],Mt=vt[bt],Tt=Mt.x-Et.x,wt=Mt.y-Et.y;if(Math.abs(wt)>Number.EPSILON){if(wt<0&&(Et=vt[bt],Tt=-Tt,Mt=vt[St],wt=-wt),mt.y<Et.y||mt.y>Mt.y)continue;if(mt.y===Et.y){if(mt.x===Et.x)return!0}else{const Ct=wt*(mt.x-Et.x)-Tt*(mt.y-Et.y);if(Ct===0)return!0;if(Ct<0)continue;_t=!_t}}else{if(mt.y!==Et.y)continue;if(Mt.x<=mt.x&&mt.x<=Et.x||Et.x<=mt.x&&mt.x<=Mt.x)return!0}}return _t}const nt=ShapeUtils.isClockWise,rt=this.subPaths;if(rt.length===0)return[];let it,st,ot;const at=[];if(rt.length===1)return st=rt[0],ot=new Shape$1,ot.curves=st.curves,at.push(ot),at;let lt=!nt(rt[0].getPoints());lt=_?!lt:lt;const ct=[],ht=[];let ut=[],ft=0,dt;ht[ft]=void 0,ut[ft]=[];for(let mt=0,vt=rt.length;mt<vt;mt++)st=rt[mt],dt=st.getPoints(),it=nt(dt),it=_?!it:it,it?(!lt&&ht[ft]&&ft++,ht[ft]={s:new Shape$1,p:dt},ht[ft].s.curves=st.curves,lt&&ft++,ut[ft]=[]):ut[ft].push({h:st,p:dt[0]});if(!ht[0])return _e(rt);if(ht.length>1){let mt=!1,vt=0;for(let yt=0,_t=ht.length;yt<_t;yt++)ct[yt]=[];for(let yt=0,_t=ht.length;yt<_t;yt++){const St=ut[yt];for(let bt=0;bt<St.length;bt++){const Et=St[bt];let Mt=!0;for(let Tt=0;Tt<ht.length;Tt++)tt(Et.p,ht[Tt].p)&&(yt!==Tt&&vt++,Mt?(Mt=!1,ct[Tt].push(Et)):mt=!0);Mt&&ct[yt].push(Et)}}vt>0&&mt===!1&&(ut=ct)}let pt;for(let mt=0,vt=ht.length;mt<vt;mt++){ot=ht[mt].s,at.push(ot),pt=ut[mt];for(let yt=0,_t=pt.length;yt<_t;yt++)ot.holes.push(pt[yt].h)}return at}};class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(_=1,_e=1,tt=1,nt={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(_,_e,{...nt,count:tt}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AgXToneMapping,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache:Cache$1,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color:Color$1,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DetachedBindMode,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearDisplayP3ColorSpace,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace,LinearToneMapping,LinearTransfer,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeutralToneMapping,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera,P3Primaries,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera,Plane,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGBFormat,RGBIntegerFormat,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,Rec709Primaries,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RenderTarget,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace,SRGBTransfer,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape:Shape$1,ShapeGeometry,ShapePath:ShapePath$1,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite:Sprite$1,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture:Texture$1,TextureLoader,TextureUtils,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedInt5999Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,createCanvasElement},Symbol.toStringTag,{value:"Module"}));var constants$5={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants$5.exports=reactReconcilerConstants_production_min;var constantsExports=constants$5.exports;function createStore$1(et){let _;const _e=new Set,tt=(at,lt)=>{const ct=typeof at=="function"?at(_):at;if(ct!==_){const ht=_;_=lt?ct:Object.assign({},_,ct),_e.forEach(ut=>ut(_,ht))}},nt=()=>_,rt=(at,lt=nt,ct=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let ht=lt(_);function ut(){const ft=lt(_);if(!ct(ht,ft)){const dt=ht;at(ht=ft,dt)}}return _e.add(ut),()=>_e.delete(ut)},ot={setState:tt,getState:nt,subscribe:(at,lt,ct)=>lt||ct?rt(at,lt,ct):(_e.add(at),()=>_e.delete(at)),destroy:()=>_e.clear()};return _=et(tt,nt,ot),ot}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$1=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create(et){const _=typeof et=="function"?createStore$1(et):et,_e=(tt=_.getState,nt=Object.is)=>{const[,rt]=reactExports.useReducer(pt=>pt+1,0),it=_.getState(),st=reactExports.useRef(it),ot=reactExports.useRef(tt),at=reactExports.useRef(nt),lt=reactExports.useRef(!1),ct=reactExports.useRef();ct.current===void 0&&(ct.current=tt(it));let ht,ut=!1;(st.current!==it||ot.current!==tt||at.current!==nt||lt.current)&&(ht=tt(it),ut=!nt(ct.current,ht)),useIsomorphicLayoutEffect$1(()=>{ut&&(ct.current=ht),st.current=it,ot.current=tt,at.current=nt,lt.current=!1});const ft=reactExports.useRef(it);useIsomorphicLayoutEffect$1(()=>{const pt=()=>{try{const vt=_.getState(),yt=ot.current(vt);at.current(ct.current,yt)||(st.current=vt,ct.current=yt,rt())}catch{lt.current=!0,rt()}},mt=_.subscribe(pt);return _.getState()!==ft.current&&pt(),mt},[]);const dt=ut?ht:ct.current;return reactExports.useDebugValue(dt),dt};return Object.assign(_e,_),_e[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const tt=[_e,_];return{next(){const nt=tt.length<=0;return{value:tt.shift(),done:nt}}}},_e}var reactReconciler={exports:{}},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(et){function _(Lt,Ot){var Nt=Lt.length;Lt.push(Ot);e:for(;0<Nt;){var zt=Nt-1>>>1,Ht=Lt[zt];if(0<nt(Ht,Ot))Lt[zt]=Ot,Lt[Nt]=Ht,Nt=zt;else break e}}function _e(Lt){return Lt.length===0?null:Lt[0]}function tt(Lt){if(Lt.length===0)return null;var Ot=Lt[0],Nt=Lt.pop();if(Nt!==Ot){Lt[0]=Nt;e:for(var zt=0,Ht=Lt.length,qt=Ht>>>1;zt<qt;){var Gt=2*(zt+1)-1,Xt=Lt[Gt],Zt=Gt+1,Qt=Lt[Zt];if(0>nt(Xt,Nt))Zt<Ht&&0>nt(Qt,Xt)?(Lt[zt]=Qt,Lt[Zt]=Nt,zt=Zt):(Lt[zt]=Xt,Lt[Gt]=Nt,zt=Gt);else if(Zt<Ht&&0>nt(Qt,Nt))Lt[zt]=Qt,Lt[Zt]=Nt,zt=Zt;else break e}}return Ot}function nt(Lt,Ot){var Nt=Lt.sortIndex-Ot.sortIndex;return Nt!==0?Nt:Lt.id-Ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var rt=performance;et.unstable_now=function(){return rt.now()}}else{var it=Date,st=it.now();et.unstable_now=function(){return it.now()-st}}var ot=[],at=[],lt=1,ct=null,ht=3,ut=!1,ft=!1,dt=!1,pt=typeof setTimeout=="function"?setTimeout:null,mt=typeof clearTimeout=="function"?clearTimeout:null,vt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(Lt){for(var Ot=_e(at);Ot!==null;){if(Ot.callback===null)tt(at);else if(Ot.startTime<=Lt)tt(at),Ot.sortIndex=Ot.expirationTime,_(ot,Ot);else break;Ot=_e(at)}}function _t(Lt){if(dt=!1,yt(Lt),!ft)if(_e(ot)!==null)ft=!0,$t(St);else{var Ot=_e(at);Ot!==null&&Yt(_t,Ot.startTime-Lt)}}function St(Lt,Ot){ft=!1,dt&&(dt=!1,mt(Mt),Mt=-1),ut=!0;var Nt=ht;try{for(yt(Ot),ct=_e(ot);ct!==null&&(!(ct.expirationTime>Ot)||Lt&&!Ct());){var zt=ct.callback;if(typeof zt=="function"){ct.callback=null,ht=ct.priorityLevel;var Ht=zt(ct.expirationTime<=Ot);Ot=et.unstable_now(),typeof Ht=="function"?ct.callback=Ht:ct===_e(ot)&&tt(ot),yt(Ot)}else tt(ot);ct=_e(ot)}if(ct!==null)var qt=!0;else{var Gt=_e(at);Gt!==null&&Yt(_t,Gt.startTime-Ot),qt=!1}return qt}finally{ct=null,ht=Nt,ut=!1}}var bt=!1,Et=null,Mt=-1,Tt=5,wt=-1;function Ct(){return!(et.unstable_now()-wt<Tt)}function Rt(){if(Et!==null){var Lt=et.unstable_now();wt=Lt;var Ot=!0;try{Ot=Et(!0,Lt)}finally{Ot?It():(bt=!1,Et=null)}}else bt=!1}var It;if(typeof vt=="function")It=function(){vt(Rt)};else if(typeof MessageChannel<"u"){var Dt=new MessageChannel,Ft=Dt.port2;Dt.port1.onmessage=Rt,It=function(){Ft.postMessage(null)}}else It=function(){pt(Rt,0)};function $t(Lt){Et=Lt,bt||(bt=!0,It())}function Yt(Lt,Ot){Mt=pt(function(){Lt(et.unstable_now())},Ot)}et.unstable_IdlePriority=5,et.unstable_ImmediatePriority=1,et.unstable_LowPriority=4,et.unstable_NormalPriority=3,et.unstable_Profiling=null,et.unstable_UserBlockingPriority=2,et.unstable_cancelCallback=function(Lt){Lt.callback=null},et.unstable_continueExecution=function(){ft||ut||(ft=!0,$t(St))},et.unstable_forceFrameRate=function(Lt){0>Lt||125<Lt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Tt=0<Lt?Math.floor(1e3/Lt):5},et.unstable_getCurrentPriorityLevel=function(){return ht},et.unstable_getFirstCallbackNode=function(){return _e(ot)},et.unstable_next=function(Lt){switch(ht){case 1:case 2:case 3:var Ot=3;break;default:Ot=ht}var Nt=ht;ht=Ot;try{return Lt()}finally{ht=Nt}},et.unstable_pauseExecution=function(){},et.unstable_requestPaint=function(){},et.unstable_runWithPriority=function(Lt,Ot){switch(Lt){case 1:case 2:case 3:case 4:case 5:break;default:Lt=3}var Nt=ht;ht=Lt;try{return Ot()}finally{ht=Nt}},et.unstable_scheduleCallback=function(Lt,Ot,Nt){var zt=et.unstable_now();switch(typeof Nt=="object"&&Nt!==null?(Nt=Nt.delay,Nt=typeof Nt=="number"&&0<Nt?zt+Nt:zt):Nt=zt,Lt){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=Nt+Ht,Lt={id:lt++,callback:Ot,priorityLevel:Lt,startTime:Nt,expirationTime:Ht,sortIndex:-1},Nt>zt?(Lt.sortIndex=Nt,_(at,Lt),_e(ot)===null&&Lt===_e(at)&&(dt?(mt(Mt),Mt=-1):dt=!0,Yt(_t,Nt-zt))):(Lt.sortIndex=Ht,_(ot,Lt),ft||ut||(ft=!0,$t(St))),Lt},et.unstable_shouldYield=Ct,et.unstable_wrapCallback=function(Lt){var Ot=ht;return function(){var Nt=ht;ht=Ot;try{return Lt.apply(this,arguments)}finally{ht=Nt}}}}(scheduler_production_min$1)),scheduler_production_min$1}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler$1.exports=requireScheduler_production_min()),scheduler$1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function(_){var _e={},tt=reactExports,nt=requireScheduler(),rt=Object.assign;function it(gt){for(var xt="https://reactjs.org/docs/error-decoder.html?invariant="+gt,At=1;At<arguments.length;At++)xt+="&args[]="+encodeURIComponent(arguments[At]);return"Minified React error #"+gt+"; visit "+xt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var st=tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ot=Symbol.for("react.element"),at=Symbol.for("react.portal"),lt=Symbol.for("react.fragment"),ct=Symbol.for("react.strict_mode"),ht=Symbol.for("react.profiler"),ut=Symbol.for("react.provider"),ft=Symbol.for("react.context"),dt=Symbol.for("react.forward_ref"),pt=Symbol.for("react.suspense"),mt=Symbol.for("react.suspense_list"),vt=Symbol.for("react.memo"),yt=Symbol.for("react.lazy"),_t=Symbol.for("react.offscreen"),St=Symbol.iterator;function bt(gt){return gt===null||typeof gt!="object"?null:(gt=St&&gt[St]||gt["@@iterator"],typeof gt=="function"?gt:null)}function Et(gt){if(gt==null)return null;if(typeof gt=="function")return gt.displayName||gt.name||null;if(typeof gt=="string")return gt;switch(gt){case lt:return"Fragment";case at:return"Portal";case ht:return"Profiler";case ct:return"StrictMode";case pt:return"Suspense";case mt:return"SuspenseList"}if(typeof gt=="object")switch(gt.$$typeof){case ft:return(gt.displayName||"Context")+".Consumer";case ut:return(gt._context.displayName||"Context")+".Provider";case dt:var xt=gt.render;return gt=gt.displayName,gt||(gt=xt.displayName||xt.name||"",gt=gt!==""?"ForwardRef("+gt+")":"ForwardRef"),gt;case vt:return xt=gt.displayName||null,xt!==null?xt:Et(gt.type)||"Memo";case yt:xt=gt._payload,gt=gt._init;try{return Et(gt(xt))}catch{}}return null}function Mt(gt){var xt=gt.type;switch(gt.tag){case 24:return"Cache";case 9:return(xt.displayName||"Context")+".Consumer";case 10:return(xt._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return gt=xt.render,gt=gt.displayName||gt.name||"",xt.displayName||(gt!==""?"ForwardRef("+gt+")":"ForwardRef");case 7:return"Fragment";case 5:return xt;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Et(xt);case 8:return xt===ct?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof xt=="function")return xt.displayName||xt.name||null;if(typeof xt=="string")return xt}return null}function Tt(gt){var xt=gt,At=gt;if(gt.alternate)for(;xt.return;)xt=xt.return;else{gt=xt;do xt=gt,xt.flags&4098&&(At=xt.return),gt=xt.return;while(gt)}return xt.tag===3?At:null}function wt(gt){if(Tt(gt)!==gt)throw Error(it(188))}function Ct(gt){var xt=gt.alternate;if(!xt){if(xt=Tt(gt),xt===null)throw Error(it(188));return xt!==gt?null:gt}for(var At=gt,Pt=xt;;){var kt=At.return;if(kt===null)break;var Ut=kt.alternate;if(Ut===null){if(Pt=kt.return,Pt!==null){At=Pt;continue}break}if(kt.child===Ut.child){for(Ut=kt.child;Ut;){if(Ut===At)return wt(kt),gt;if(Ut===Pt)return wt(kt),xt;Ut=Ut.sibling}throw Error(it(188))}if(At.return!==Pt.return)At=kt,Pt=Ut;else{for(var rn=!1,bn=kt.child;bn;){if(bn===At){rn=!0,At=kt,Pt=Ut;break}if(bn===Pt){rn=!0,Pt=kt,At=Ut;break}bn=bn.sibling}if(!rn){for(bn=Ut.child;bn;){if(bn===At){rn=!0,At=Ut,Pt=kt;break}if(bn===Pt){rn=!0,Pt=Ut,At=kt;break}bn=bn.sibling}if(!rn)throw Error(it(189))}}if(At.alternate!==Pt)throw Error(it(190))}if(At.tag!==3)throw Error(it(188));return At.stateNode.current===At?gt:xt}function Rt(gt){return gt=Ct(gt),gt!==null?It(gt):null}function It(gt){if(gt.tag===5||gt.tag===6)return gt;for(gt=gt.child;gt!==null;){var xt=It(gt);if(xt!==null)return xt;gt=gt.sibling}return null}function Dt(gt){if(gt.tag===5||gt.tag===6)return gt;for(gt=gt.child;gt!==null;){if(gt.tag!==4){var xt=Dt(gt);if(xt!==null)return xt}gt=gt.sibling}return null}var Ft=Array.isArray,$t=_.getPublicInstance,Yt=_.getRootHostContext,Lt=_.getChildHostContext,Ot=_.prepareForCommit,Nt=_.resetAfterCommit,zt=_.createInstance,Ht=_.appendInitialChild,qt=_.finalizeInitialChildren,Gt=_.prepareUpdate,Xt=_.shouldSetTextContent,Zt=_.createTextInstance,Qt=_.scheduleTimeout,un=_.cancelTimeout,wn=_.noTimeout,Tn=_.isPrimaryRenderer,yn=_.supportsMutation,Vt=_.supportsPersistence,fn=_.supportsHydration,ln=_.getInstanceFromNode,Jt=_.preparePortalMount,on=_.getCurrentEventPriority,_n=_.detachDeletedInstance,cn=_.supportsMicrotasks,tn=_.scheduleMicrotask,Wt=_.supportsTestSelectors,Bt=_.findFiberRoot,nn=_.getBoundingRect,en=_.getTextContent,mn=_.isHiddenSubtree,sn=_.matchAccessibilityRole,xn=_.setFocusIfFocusable,an=_.setupIntersectionObserver,pn=_.appendChild,Sn=_.appendChildToContainer,gn=_.commitTextUpdate,Rn=_.commitMount,Mn=_.commitUpdate,kn=_.insertBefore,Fn=_.insertInContainerBefore,Nn=_.removeChild,Zn=_.removeChildFromContainer,er=_.resetTextContent,dn=_.hideInstance,$n=_.hideTextInstance,Pn=_.unhideInstance,Dn=_.unhideTextInstance,Hn=_.clearContainer,jn=_.cloneInstance,qn=_.createContainerChildSet,hr=_.appendChildToContainerChildSet,fr=_.finalizeContainerChildren,jt=_.replaceContainerChildren,hn=_.cloneHiddenInstance,En=_.cloneHiddenTextInstance,Vn=_.canHydrateInstance,Gn=_.canHydrateTextInstance,Kn=_.canHydrateSuspenseInstance,br=_.isSuspenseInstancePending,gr=_.isSuspenseInstanceFallback,Er=_.registerSuspenseInstanceRetry,Tr=_.getNextHydratableSibling,zr=_.getFirstHydratableChild,wr=_.getFirstHydratableChildWithinContainer,Wr=_.getFirstHydratableChildWithinSuspenseInstance,Ur=_.hydrateInstance,Qr=_.hydrateTextInstance,$r=_.hydrateSuspenseInstance,Kt=_.getNextHydratableInstanceAfterSuspenseInstance,vn=_.commitHydratedContainer,In=_.commitHydratedSuspenseInstance,Ln=_.clearSuspenseBoundary,Cn=_.clearSuspenseBoundaryFromContainer,Wn=_.shouldDeleteUnhydratedTailInstances,Qn=_.didNotMatchHydratedContainerTextInstance,rr=_.didNotMatchHydratedTextInstance,zn;function ar(gt){if(zn===void 0)try{throw Error()}catch(At){var xt=At.stack.trim().match(/\n( *(at )?)/);zn=xt&&xt[1]||""}return`
`+zn+gt}var dr=!1;function sr(gt,xt){if(!gt||dr)return"";dr=!0;var At=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(xt)if(xt=function(){throw Error()},Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(Xn){var Pt=Xn}Reflect.construct(gt,[],xt)}else{try{xt.call()}catch(Xn){Pt=Xn}gt.call(xt.prototype)}else{try{throw Error()}catch(Xn){Pt=Xn}gt()}}catch(Xn){if(Xn&&Pt&&typeof Xn.stack=="string"){for(var kt=Xn.stack.split(`
`),Ut=Pt.stack.split(`
`),rn=kt.length-1,bn=Ut.length-1;1<=rn&&0<=bn&&kt[rn]!==Ut[bn];)bn--;for(;1<=rn&&0<=bn;rn--,bn--)if(kt[rn]!==Ut[bn]){if(rn!==1||bn!==1)do if(rn--,bn--,0>bn||kt[rn]!==Ut[bn]){var On=`
`+kt[rn].replace(" at new "," at ");return gt.displayName&&On.includes("<anonymous>")&&(On=On.replace("<anonymous>",gt.displayName)),On}while(1<=rn&&0<=bn);break}}}finally{dr=!1,Error.prepareStackTrace=At}return(gt=gt?gt.displayName||gt.name:"")?ar(gt):""}var Mr=Object.prototype.hasOwnProperty,Dr=[],Ar=-1;function Lr(gt){return{current:gt}}function or(gt){0>Ar||(gt.current=Dr[Ar],Dr[Ar]=null,Ar--)}function Yn(gt,xt){Ar++,Dr[Ar]=gt.current,gt.current=xt}var Ir={},mr=Lr(Ir),kr=Lr(!1),ss=Ir;function Fr(gt,xt){var At=gt.type.contextTypes;if(!At)return Ir;var Pt=gt.stateNode;if(Pt&&Pt.__reactInternalMemoizedUnmaskedChildContext===xt)return Pt.__reactInternalMemoizedMaskedChildContext;var kt={},Ut;for(Ut in At)kt[Ut]=xt[Ut];return Pt&&(gt=gt.stateNode,gt.__reactInternalMemoizedUnmaskedChildContext=xt,gt.__reactInternalMemoizedMaskedChildContext=kt),kt}function Gr(gt){return gt=gt.childContextTypes,gt!=null}function Cr(){or(kr),or(mr)}function ps(gt,xt,At){if(mr.current!==Ir)throw Error(it(168));Yn(mr,xt),Yn(kr,At)}function Ws(gt,xt,At){var Pt=gt.stateNode;if(xt=xt.childContextTypes,typeof Pt.getChildContext!="function")return At;Pt=Pt.getChildContext();for(var kt in Pt)if(!(kt in xt))throw Error(it(108,Mt(gt)||"Unknown",kt));return rt({},At,Pt)}function jr(gt){return gt=(gt=gt.stateNode)&&gt.__reactInternalMemoizedMergedChildContext||Ir,ss=mr.current,Yn(mr,gt),Yn(kr,kr.current),!0}function as(gt,xt,At){var Pt=gt.stateNode;if(!Pt)throw Error(it(169));At?(gt=Ws(gt,xt,ss),Pt.__reactInternalMemoizedMergedChildContext=gt,or(kr),or(mr),Yn(mr,gt)):or(kr),Yn(kr,At)}var ms=Math.clz32?Math.clz32:Gl,Js=Math.log,So=Math.LN2;function Gl(gt){return gt>>>=0,gt===0?32:31-(Js(gt)/So|0)|0}var eo=64,to=4194304;function no(gt){switch(gt&-gt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return gt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return gt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return gt}}function bo(gt,xt){var At=gt.pendingLanes;if(At===0)return 0;var Pt=0,kt=gt.suspendedLanes,Ut=gt.pingedLanes,rn=At&268435455;if(rn!==0){var bn=rn&~kt;bn!==0?Pt=no(bn):(Ut&=rn,Ut!==0&&(Pt=no(Ut)))}else rn=At&~kt,rn!==0?Pt=no(rn):Ut!==0&&(Pt=no(Ut));if(Pt===0)return 0;if(xt!==0&&xt!==Pt&&!(xt&kt)&&(kt=Pt&-Pt,Ut=xt&-xt,kt>=Ut||kt===16&&(Ut&4194240)!==0))return xt;if(Pt&4&&(Pt|=At&16),xt=gt.entangledLanes,xt!==0)for(gt=gt.entanglements,xt&=Pt;0<xt;)At=31-ms(xt),kt=1<<At,Pt|=gt[At],xt&=~kt;return Pt}function Hl(gt,xt){switch(gt){case 1:case 2:case 4:return xt+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return xt+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ga(gt,xt){for(var At=gt.suspendedLanes,Pt=gt.pingedLanes,kt=gt.expirationTimes,Ut=gt.pendingLanes;0<Ut;){var rn=31-ms(Ut),bn=1<<rn,On=kt[rn];On===-1?(!(bn&At)||bn&Pt)&&(kt[rn]=Hl(bn,xt)):On<=xt&&(gt.expiredLanes|=bn),Ut&=~bn}}function ro(gt){return gt=gt.pendingLanes&-1073741825,gt!==0?gt:gt&1073741824?1073741824:0}function Vo(gt){for(var xt=[],At=0;31>At;At++)xt.push(gt);return xt}function js(gt,xt,At){gt.pendingLanes|=xt,xt!==536870912&&(gt.suspendedLanes=0,gt.pingedLanes=0),gt=gt.eventTimes,xt=31-ms(xt),gt[xt]=At}function uo(gt,xt){var At=gt.pendingLanes&~xt;gt.pendingLanes=xt,gt.suspendedLanes=0,gt.pingedLanes=0,gt.expiredLanes&=xt,gt.mutableReadLanes&=xt,gt.entangledLanes&=xt,xt=gt.entanglements;var Pt=gt.eventTimes;for(gt=gt.expirationTimes;0<At;){var kt=31-ms(At),Ut=1<<kt;xt[kt]=0,Pt[kt]=-1,gt[kt]=-1,At&=~Ut}}function Xs(gt,xt){var At=gt.entangledLanes|=xt;for(gt=gt.entanglements;At;){var Pt=31-ms(At),kt=1<<Pt;kt&xt|gt[Pt]&xt&&(gt[Pt]|=xt),At&=~kt}}var Sr=0;function xa(gt){return gt&=-gt,1<gt?4<gt?gt&268435455?16:536870912:4:1}var io=nt.unstable_scheduleCallback,zo=nt.unstable_cancelCallback,ba=nt.unstable_shouldYield,Wl=nt.unstable_requestPaint,Or=nt.unstable_now,Mo=nt.unstable_ImmediatePriority,Xl=nt.unstable_UserBlockingPriority,gs=nt.unstable_NormalPriority,$a=nt.unstable_IdlePriority,Eo=null,Ts=null;function xl(gt){if(Ts&&typeof Ts.onCommitFiberRoot=="function")try{Ts.onCommitFiberRoot(Eo,gt,void 0,(gt.current.flags&128)===128)}catch{}}function Yl(gt,xt){return gt===xt&&(gt!==0||1/gt===1/xt)||gt!==gt&&xt!==xt}var As=typeof Object.is=="function"?Object.is:Yl,xs=null,Ys=!1,Ls=!1;function yl(gt){xs===null?xs=[gt]:xs.push(gt)}function _l(gt){Ys=!0,yl(gt)}function Ss(){if(!Ls&&xs!==null){Ls=!0;var gt=0,xt=Sr;try{var At=xs;for(Sr=1;gt<At.length;gt++){var Pt=At[gt];do Pt=Pt(!0);while(Pt!==null)}xs=null,Ys=!1}catch(kt){throw xs!==null&&(xs=xs.slice(gt+1)),io(Mo,Ss),kt}finally{Sr=xt,Ls=!1}}return null}var To=st.ReactCurrentBatchConfig;function Ao(gt,xt){if(As(gt,xt))return!0;if(typeof gt!="object"||gt===null||typeof xt!="object"||xt===null)return!1;var At=Object.keys(gt),Pt=Object.keys(xt);if(At.length!==Pt.length)return!1;for(Pt=0;Pt<At.length;Pt++){var kt=At[Pt];if(!Mr.call(xt,kt)||!As(gt[kt],xt[kt]))return!1}return!0}function Co(gt){switch(gt.tag){case 5:return ar(gt.type);case 16:return ar("Lazy");case 13:return ar("Suspense");case 19:return ar("SuspenseList");case 0:case 2:case 15:return gt=sr(gt.type,!1),gt;case 11:return gt=sr(gt.type.render,!1),gt;case 1:return gt=sr(gt.type,!0),gt;default:return""}}function ys(gt,xt){if(gt&&gt.defaultProps){xt=rt({},xt),gt=gt.defaultProps;for(var At in gt)xt[At]===void 0&&(xt[At]=gt[At]);return xt}return xt}var es=Lr(null),$o=null,$s=null,ho=null;function Go(){ho=$s=$o=null}function Kl(gt,xt,At){Tn?(Yn(es,xt._currentValue),xt._currentValue=At):(Yn(es,xt._currentValue2),xt._currentValue2=At)}function ts(gt){var xt=es.current;or(es),Tn?gt._currentValue=xt:gt._currentValue2=xt}function vs(gt,xt,At){for(;gt!==null;){var Pt=gt.alternate;if((gt.childLanes&xt)!==xt?(gt.childLanes|=xt,Pt!==null&&(Pt.childLanes|=xt)):Pt!==null&&(Pt.childLanes&xt)!==xt&&(Pt.childLanes|=xt),gt===At)break;gt=gt.return}}function Xr(gt,xt){$o=gt,ho=$s=null,gt=gt.dependencies,gt!==null&&gt.firstContext!==null&&(gt.lanes&xt&&(Is=!0),gt.firstContext=null)}function Yr(gt){var xt=Tn?gt._currentValue:gt._currentValue2;if(ho!==gt)if(gt={context:gt,memoizedValue:xt,next:null},$s===null){if($o===null)throw Error(it(308));$s=gt,$o.dependencies={lanes:0,firstContext:gt}}else $s=$s.next=gt;return xt}var Cs=null,fo=!1;function Nu(gt){gt.updateQueue={baseState:gt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fp(gt,xt){gt=gt.updateQueue,xt.updateQueue===gt&&(xt.updateQueue={baseState:gt.baseState,firstBaseUpdate:gt.firstBaseUpdate,lastBaseUpdate:gt.lastBaseUpdate,shared:gt.shared,effects:gt.effects})}function so(gt,xt){return{eventTime:gt,lane:xt,tag:0,payload:null,callback:null,next:null}}function po(gt,xt){var At=gt.updateQueue;At!==null&&(At=At.shared,Kr!==null&&gt.mode&1&&!(_r&2)?(gt=At.interleaved,gt===null?(xt.next=xt,Cs===null?Cs=[At]:Cs.push(At)):(xt.next=gt.next,gt.next=xt),At.interleaved=xt):(gt=At.pending,gt===null?xt.next=xt:(xt.next=gt.next,gt.next=xt),At.pending=xt))}function Zl(gt,xt,At){if(xt=xt.updateQueue,xt!==null&&(xt=xt.shared,(At&4194240)!==0)){var Pt=xt.lanes;Pt&=gt.pendingLanes,At|=Pt,xt.lanes=At,Xs(gt,At)}}function Up(gt,xt){var At=gt.updateQueue,Pt=gt.alternate;if(Pt!==null&&(Pt=Pt.updateQueue,At===Pt)){var kt=null,Ut=null;if(At=At.firstBaseUpdate,At!==null){do{var rn={eventTime:At.eventTime,lane:At.lane,tag:At.tag,payload:At.payload,callback:At.callback,next:null};Ut===null?kt=Ut=rn:Ut=Ut.next=rn,At=At.next}while(At!==null);Ut===null?kt=Ut=xt:Ut=Ut.next=xt}else kt=Ut=xt;At={baseState:Pt.baseState,firstBaseUpdate:kt,lastBaseUpdate:Ut,shared:Pt.shared,effects:Pt.effects},gt.updateQueue=At;return}gt=At.lastBaseUpdate,gt===null?At.firstBaseUpdate=xt:gt.next=xt,At.lastBaseUpdate=xt}function Ql(gt,xt,At,Pt){var kt=gt.updateQueue;fo=!1;var Ut=kt.firstBaseUpdate,rn=kt.lastBaseUpdate,bn=kt.shared.pending;if(bn!==null){kt.shared.pending=null;var On=bn,Xn=On.next;On.next=null,rn===null?Ut=Xn:rn.next=Xn,rn=On;var ir=gt.alternate;ir!==null&&(ir=ir.updateQueue,bn=ir.lastBaseUpdate,bn!==rn&&(bn===null?ir.firstBaseUpdate=Xn:bn.next=Xn,ir.lastBaseUpdate=On))}if(Ut!==null){var xr=kt.baseState;rn=0,ir=Xn=On=null,bn=Ut;do{var pr=bn.lane,Br=bn.eventTime;if((Pt&pr)===pr){ir!==null&&(ir=ir.next={eventTime:Br,lane:0,tag:bn.tag,payload:bn.payload,callback:bn.callback,next:null});e:{var ur=gt,fs=bn;switch(pr=xt,Br=At,fs.tag){case 1:if(ur=fs.payload,typeof ur=="function"){xr=ur.call(Br,xr,pr);break e}xr=ur;break e;case 3:ur.flags=ur.flags&-65537|128;case 0:if(ur=fs.payload,pr=typeof ur=="function"?ur.call(Br,xr,pr):ur,pr==null)break e;xr=rt({},xr,pr);break e;case 2:fo=!0}}bn.callback!==null&&bn.lane!==0&&(gt.flags|=64,pr=kt.effects,pr===null?kt.effects=[bn]:pr.push(bn))}else Br={eventTime:Br,lane:pr,tag:bn.tag,payload:bn.payload,callback:bn.callback,next:null},ir===null?(Xn=ir=Br,On=xr):ir=ir.next=Br,rn|=pr;if(bn=bn.next,bn===null){if(bn=kt.shared.pending,bn===null)break;pr=bn,bn=pr.next,pr.next=null,kt.lastBaseUpdate=pr,kt.shared.pending=null}}while(!0);if(ir===null&&(On=xr),kt.baseState=On,kt.firstBaseUpdate=Xn,kt.lastBaseUpdate=ir,xt=kt.shared.interleaved,xt!==null){kt=xt;do rn|=kt.lane,kt=kt.next;while(kt!==xt)}else Ut===null&&(kt.shared.lanes=0);Qo|=rn,gt.lanes=rn,gt.memoizedState=xr}}function Np(gt,xt,At){if(gt=xt.effects,xt.effects=null,gt!==null)for(xt=0;xt<gt.length;xt++){var Pt=gt[xt],kt=Pt.callback;if(kt!==null){if(Pt.callback=null,Pt=At,typeof kt!="function")throw Error(it(191,kt));kt.call(Pt)}}}var Op=new tt.Component().refs;function Ou(gt,xt,At,Pt){xt=gt.memoizedState,At=At(Pt,xt),At=At==null?xt:rt({},xt,At),gt.memoizedState=At,gt.lanes===0&&(gt.updateQueue.baseState=At)}var Jl={isMounted:function(gt){return(gt=gt._reactInternals)?Tt(gt)===gt:!1},enqueueSetState:function(gt,xt,At){gt=gt._reactInternals;var Pt=ws(),kt=xo(gt),Ut=so(Pt,kt);Ut.payload=xt,At!=null&&(Ut.callback=At),po(gt,Ut),xt=Os(gt,kt,Pt),xt!==null&&Zl(xt,gt,kt)},enqueueReplaceState:function(gt,xt,At){gt=gt._reactInternals;var Pt=ws(),kt=xo(gt),Ut=so(Pt,kt);Ut.tag=1,Ut.payload=xt,At!=null&&(Ut.callback=At),po(gt,Ut),xt=Os(gt,kt,Pt),xt!==null&&Zl(xt,gt,kt)},enqueueForceUpdate:function(gt,xt){gt=gt._reactInternals;var At=ws(),Pt=xo(gt),kt=so(At,Pt);kt.tag=2,xt!=null&&(kt.callback=xt),po(gt,kt),xt=Os(gt,Pt,At),xt!==null&&Zl(xt,gt,Pt)}};function Vp(gt,xt,At,Pt,kt,Ut,rn){return gt=gt.stateNode,typeof gt.shouldComponentUpdate=="function"?gt.shouldComponentUpdate(Pt,Ut,rn):xt.prototype&&xt.prototype.isPureReactComponent?!Ao(At,Pt)||!Ao(kt,Ut):!0}function zp(gt,xt,At){var Pt=!1,kt=Ir,Ut=xt.contextType;return typeof Ut=="object"&&Ut!==null?Ut=Yr(Ut):(kt=Gr(xt)?ss:mr.current,Pt=xt.contextTypes,Ut=(Pt=Pt!=null)?Fr(gt,kt):Ir),xt=new xt(At,Ut),gt.memoizedState=xt.state!==null&&xt.state!==void 0?xt.state:null,xt.updater=Jl,gt.stateNode=xt,xt._reactInternals=gt,Pt&&(gt=gt.stateNode,gt.__reactInternalMemoizedUnmaskedChildContext=kt,gt.__reactInternalMemoizedMaskedChildContext=Ut),xt}function $p(gt,xt,At,Pt){gt=xt.state,typeof xt.componentWillReceiveProps=="function"&&xt.componentWillReceiveProps(At,Pt),typeof xt.UNSAFE_componentWillReceiveProps=="function"&&xt.UNSAFE_componentWillReceiveProps(At,Pt),xt.state!==gt&&Jl.enqueueReplaceState(xt,xt.state,null)}function Vu(gt,xt,At,Pt){var kt=gt.stateNode;kt.props=At,kt.state=gt.memoizedState,kt.refs=Op,Nu(gt);var Ut=xt.contextType;typeof Ut=="object"&&Ut!==null?kt.context=Yr(Ut):(Ut=Gr(xt)?ss:mr.current,kt.context=Fr(gt,Ut)),kt.state=gt.memoizedState,Ut=xt.getDerivedStateFromProps,typeof Ut=="function"&&(Ou(gt,xt,Ut,At),kt.state=gt.memoizedState),typeof xt.getDerivedStateFromProps=="function"||typeof kt.getSnapshotBeforeUpdate=="function"||typeof kt.UNSAFE_componentWillMount!="function"&&typeof kt.componentWillMount!="function"||(xt=kt.state,typeof kt.componentWillMount=="function"&&kt.componentWillMount(),typeof kt.UNSAFE_componentWillMount=="function"&&kt.UNSAFE_componentWillMount(),xt!==kt.state&&Jl.enqueueReplaceState(kt,kt.state,null),Ql(gt,At,kt,Pt),kt.state=gt.memoizedState),typeof kt.componentDidMount=="function"&&(gt.flags|=4194308)}var Ho=[],Wo=0,_c=null,eu=0,Bs=[],Fs=0,Ro=null,oo=1,ao="";function Po(gt,xt){Ho[Wo++]=eu,Ho[Wo++]=_c,_c=gt,eu=xt}function Gp(gt,xt,At){Bs[Fs++]=oo,Bs[Fs++]=ao,Bs[Fs++]=Ro,Ro=gt;var Pt=oo;gt=ao;var kt=32-ms(Pt)-1;Pt&=~(1<<kt),At+=1;var Ut=32-ms(xt)+kt;if(30<Ut){var rn=kt-kt%5;Ut=(Pt&(1<<rn)-1).toString(32),Pt>>=rn,kt-=rn,oo=1<<32-ms(xt)+kt|At<<kt|Pt,ao=Ut+gt}else oo=1<<Ut|At<<kt|Pt,ao=gt}function zu(gt){gt.return!==null&&(Po(gt,1),Gp(gt,1,0))}function $u(gt){for(;gt===_c;)_c=Ho[--Wo],Ho[Wo]=null,eu=Ho[--Wo],Ho[Wo]=null;for(;gt===Ro;)Ro=Bs[--Fs],Bs[Fs]=null,ao=Bs[--Fs],Bs[Fs]=null,oo=Bs[--Fs],Bs[Fs]=null}var Rs=null,Ps=null,Nr=!1,wl=!1,Gs=null;function Hp(gt,xt){var At=Vs(5,null,null,0);At.elementType="DELETED",At.stateNode=xt,At.return=gt,xt=gt.deletions,xt===null?(gt.deletions=[At],gt.flags|=16):xt.push(At)}function Wp(gt,xt){switch(gt.tag){case 5:return xt=Vn(xt,gt.type,gt.pendingProps),xt!==null?(gt.stateNode=xt,Rs=gt,Ps=zr(xt),!0):!1;case 6:return xt=Gn(xt,gt.pendingProps),xt!==null?(gt.stateNode=xt,Rs=gt,Ps=null,!0):!1;case 13:if(xt=Kn(xt),xt!==null){var At=Ro!==null?{id:oo,overflow:ao}:null;return gt.memoizedState={dehydrated:xt,treeContext:At,retryLane:1073741824},At=Vs(18,null,null,0),At.stateNode=xt,At.return=gt,gt.child=At,Rs=gt,Ps=null,!0}return!1;default:return!1}}function Gu(gt){return(gt.mode&1)!==0&&(gt.flags&128)===0}function Hu(gt){if(Nr){var xt=Ps;if(xt){var At=xt;if(!Wp(gt,xt)){if(Gu(gt))throw Error(it(418));xt=Tr(At);var Pt=Rs;xt&&Wp(gt,xt)?Hp(Pt,At):(gt.flags=gt.flags&-4097|2,Nr=!1,Rs=gt)}}else{if(Gu(gt))throw Error(it(418));gt.flags=gt.flags&-4097|2,Nr=!1,Rs=gt}}}function jp(gt){for(gt=gt.return;gt!==null&&gt.tag!==5&&gt.tag!==3&&gt.tag!==13;)gt=gt.return;Rs=gt}function Sl(gt){if(!fn||gt!==Rs)return!1;if(!Nr)return jp(gt),Nr=!0,!1;if(gt.tag!==3&&(gt.tag!==5||Wn(gt.type)&&!Xt(gt.type,gt.memoizedProps))){var xt=Ps;if(xt){if(Gu(gt)){for(gt=Ps;gt;)gt=Tr(gt);throw Error(it(418))}for(;xt;)Hp(gt,xt),xt=Tr(xt)}}if(jp(gt),gt.tag===13){if(!fn)throw Error(it(316));if(gt=gt.memoizedState,gt=gt!==null?gt.dehydrated:null,!gt)throw Error(it(317));Ps=Kt(gt)}else Ps=Rs?Tr(gt.stateNode):null;return!0}function jo(){fn&&(Ps=Rs=null,wl=Nr=!1)}function Wu(gt){Gs===null?Gs=[gt]:Gs.push(gt)}function Ml(gt,xt,At){if(gt=At.ref,gt!==null&&typeof gt!="function"&&typeof gt!="object"){if(At._owner){if(At=At._owner,At){if(At.tag!==1)throw Error(it(309));var Pt=At.stateNode}if(!Pt)throw Error(it(147,gt));var kt=Pt,Ut=""+gt;return xt!==null&&xt.ref!==null&&typeof xt.ref=="function"&&xt.ref._stringRef===Ut?xt.ref:(xt=function(rn){var bn=kt.refs;bn===Op&&(bn=kt.refs={}),rn===null?delete bn[Ut]:bn[Ut]=rn},xt._stringRef=Ut,xt)}if(typeof gt!="string")throw Error(it(284));if(!At._owner)throw Error(it(290,gt))}return gt}function tu(gt,xt){throw gt=Object.prototype.toString.call(xt),Error(it(31,gt==="[object Object]"?"object with keys {"+Object.keys(xt).join(", ")+"}":gt))}function Xp(gt){var xt=gt._init;return xt(gt._payload)}function Yp(gt){function xt(Bn,An){if(gt){var Un=Bn.deletions;Un===null?(Bn.deletions=[An],Bn.flags|=16):Un.push(An)}}function At(Bn,An){if(!gt)return null;for(;An!==null;)xt(Bn,An),An=An.sibling;return null}function Pt(Bn,An){for(Bn=new Map;An!==null;)An.key!==null?Bn.set(An.key,An):Bn.set(An.index,An),An=An.sibling;return Bn}function kt(Bn,An){return Bn=vo(Bn,An),Bn.index=0,Bn.sibling=null,Bn}function Ut(Bn,An,Un){return Bn.index=Un,gt?(Un=Bn.alternate,Un!==null?(Un=Un.index,Un<An?(Bn.flags|=2,An):Un):(Bn.flags|=2,An)):(Bn.flags|=1048576,An)}function rn(Bn){return gt&&Bn.alternate===null&&(Bn.flags|=2),Bn}function bn(Bn,An,Un,nr){return An===null||An.tag!==6?(An=Ep(Un,Bn.mode,nr),An.return=Bn,An):(An=kt(An,Un),An.return=Bn,An)}function On(Bn,An,Un,nr){var lr=Un.type;return lr===lt?ir(Bn,An,Un.props.children,nr,Un.key):An!==null&&(An.elementType===lr||typeof lr=="object"&&lr!==null&&lr.$$typeof===yt&&Xp(lr)===An.type)?(nr=kt(An,Un.props),nr.ref=Ml(Bn,An,Un),nr.return=Bn,nr):(nr=ku(Un.type,Un.key,Un.props,null,Bn.mode,nr),nr.ref=Ml(Bn,An,Un),nr.return=Bn,nr)}function Xn(Bn,An,Un,nr){return An===null||An.tag!==4||An.stateNode.containerInfo!==Un.containerInfo||An.stateNode.implementation!==Un.implementation?(An=Tp(Un,Bn.mode,nr),An.return=Bn,An):(An=kt(An,Un.children||[]),An.return=Bn,An)}function ir(Bn,An,Un,nr,lr){return An===null||An.tag!==7?(An=Uo(Un,Bn.mode,nr,lr),An.return=Bn,An):(An=kt(An,Un),An.return=Bn,An)}function xr(Bn,An,Un){if(typeof An=="string"&&An!==""||typeof An=="number")return An=Ep(""+An,Bn.mode,Un),An.return=Bn,An;if(typeof An=="object"&&An!==null){switch(An.$$typeof){case ot:return Un=ku(An.type,An.key,An.props,null,Bn.mode,Un),Un.ref=Ml(Bn,null,An),Un.return=Bn,Un;case at:return An=Tp(An,Bn.mode,Un),An.return=Bn,An;case yt:var nr=An._init;return xr(Bn,nr(An._payload),Un)}if(Ft(An)||bt(An))return An=Uo(An,Bn.mode,Un,null),An.return=Bn,An;tu(Bn,An)}return null}function pr(Bn,An,Un,nr){var lr=An!==null?An.key:null;if(typeof Un=="string"&&Un!==""||typeof Un=="number")return lr!==null?null:bn(Bn,An,""+Un,nr);if(typeof Un=="object"&&Un!==null){switch(Un.$$typeof){case ot:return Un.key===lr?On(Bn,An,Un,nr):null;case at:return Un.key===lr?Xn(Bn,An,Un,nr):null;case yt:return lr=Un._init,pr(Bn,An,lr(Un._payload),nr)}if(Ft(Un)||bt(Un))return lr!==null?null:ir(Bn,An,Un,nr,null);tu(Bn,Un)}return null}function Br(Bn,An,Un,nr,lr){if(typeof nr=="string"&&nr!==""||typeof nr=="number")return Bn=Bn.get(Un)||null,bn(An,Bn,""+nr,lr);if(typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case ot:return Bn=Bn.get(nr.key===null?Un:nr.key)||null,On(An,Bn,nr,lr);case at:return Bn=Bn.get(nr.key===null?Un:nr.key)||null,Xn(An,Bn,nr,lr);case yt:var vr=nr._init;return Br(Bn,An,Un,vr(nr._payload),lr)}if(Ft(nr)||bt(nr))return Bn=Bn.get(Un)||null,ir(An,Bn,nr,lr,null);tu(An,nr)}return null}function ur(Bn,An,Un,nr){for(var lr=null,vr=null,yr=An,Rr=An=0,rs=null;yr!==null&&Rr<Un.length;Rr++){yr.index>Rr?(rs=yr,yr=null):rs=yr.sibling;var Pr=pr(Bn,yr,Un[Rr],nr);if(Pr===null){yr===null&&(yr=rs);break}gt&&yr&&Pr.alternate===null&&xt(Bn,yr),An=Ut(Pr,An,Rr),vr===null?lr=Pr:vr.sibling=Pr,vr=Pr,yr=rs}if(Rr===Un.length)return At(Bn,yr),Nr&&Po(Bn,Rr),lr;if(yr===null){for(;Rr<Un.length;Rr++)yr=xr(Bn,Un[Rr],nr),yr!==null&&(An=Ut(yr,An,Rr),vr===null?lr=yr:vr.sibling=yr,vr=yr);return Nr&&Po(Bn,Rr),lr}for(yr=Pt(Bn,yr);Rr<Un.length;Rr++)rs=Br(yr,Bn,Rr,Un[Rr],nr),rs!==null&&(gt&&rs.alternate!==null&&yr.delete(rs.key===null?Rr:rs.key),An=Ut(rs,An,Rr),vr===null?lr=rs:vr.sibling=rs,vr=rs);return gt&&yr.forEach(function(_o){return xt(Bn,_o)}),Nr&&Po(Bn,Rr),lr}function fs(Bn,An,Un,nr){var lr=bt(Un);if(typeof lr!="function")throw Error(it(150));if(Un=lr.call(Un),Un==null)throw Error(it(151));for(var vr=lr=null,yr=An,Rr=An=0,rs=null,Pr=Un.next();yr!==null&&!Pr.done;Rr++,Pr=Un.next()){yr.index>Rr?(rs=yr,yr=null):rs=yr.sibling;var _o=pr(Bn,yr,Pr.value,nr);if(_o===null){yr===null&&(yr=rs);break}gt&&yr&&_o.alternate===null&&xt(Bn,yr),An=Ut(_o,An,Rr),vr===null?lr=_o:vr.sibling=_o,vr=_o,yr=rs}if(Pr.done)return At(Bn,yr),Nr&&Po(Bn,Rr),lr;if(yr===null){for(;!Pr.done;Rr++,Pr=Un.next())Pr=xr(Bn,Pr.value,nr),Pr!==null&&(An=Ut(Pr,An,Rr),vr===null?lr=Pr:vr.sibling=Pr,vr=Pr);return Nr&&Po(Bn,Rr),lr}for(yr=Pt(Bn,yr);!Pr.done;Rr++,Pr=Un.next())Pr=Br(yr,Bn,Rr,Pr.value,nr),Pr!==null&&(gt&&Pr.alternate!==null&&yr.delete(Pr.key===null?Rr:Pr.key),An=Ut(Pr,An,Rr),vr===null?lr=Pr:vr.sibling=Pr,vr=Pr);return gt&&yr.forEach(function(X0){return xt(Bn,X0)}),Nr&&Po(Bn,Rr),lr}function zs(Bn,An,Un,nr){if(typeof Un=="object"&&Un!==null&&Un.type===lt&&Un.key===null&&(Un=Un.props.children),typeof Un=="object"&&Un!==null){switch(Un.$$typeof){case ot:e:{for(var lr=Un.key,vr=An;vr!==null;){if(vr.key===lr){if(lr=Un.type,lr===lt){if(vr.tag===7){At(Bn,vr.sibling),An=kt(vr,Un.props.children),An.return=Bn,Bn=An;break e}}else if(vr.elementType===lr||typeof lr=="object"&&lr!==null&&lr.$$typeof===yt&&Xp(lr)===vr.type){At(Bn,vr.sibling),An=kt(vr,Un.props),An.ref=Ml(Bn,vr,Un),An.return=Bn,Bn=An;break e}At(Bn,vr);break}else xt(Bn,vr);vr=vr.sibling}Un.type===lt?(An=Uo(Un.props.children,Bn.mode,nr,Un.key),An.return=Bn,Bn=An):(nr=ku(Un.type,Un.key,Un.props,null,Bn.mode,nr),nr.ref=Ml(Bn,An,Un),nr.return=Bn,Bn=nr)}return rn(Bn);case at:e:{for(vr=Un.key;An!==null;){if(An.key===vr)if(An.tag===4&&An.stateNode.containerInfo===Un.containerInfo&&An.stateNode.implementation===Un.implementation){At(Bn,An.sibling),An=kt(An,Un.children||[]),An.return=Bn,Bn=An;break e}else{At(Bn,An);break}else xt(Bn,An);An=An.sibling}An=Tp(Un,Bn.mode,nr),An.return=Bn,Bn=An}return rn(Bn);case yt:return vr=Un._init,zs(Bn,An,vr(Un._payload),nr)}if(Ft(Un))return ur(Bn,An,Un,nr);if(bt(Un))return fs(Bn,An,Un,nr);tu(Bn,Un)}return typeof Un=="string"&&Un!==""||typeof Un=="number"?(Un=""+Un,An!==null&&An.tag===6?(At(Bn,An.sibling),An=kt(An,Un),An.return=Bn,Bn=An):(At(Bn,An),An=Ep(Un,Bn.mode,nr),An.return=Bn,Bn=An),rn(Bn)):At(Bn,An)}return zs}var Xo=Yp(!0),qp=Yp(!1),El={},Us=Lr(El),Tl=Lr(El),Yo=Lr(El);function qs(gt){if(gt===El)throw Error(it(174));return gt}function ju(gt,xt){Yn(Yo,xt),Yn(Tl,gt),Yn(Us,El),gt=Yt(xt),or(Us),Yn(Us,gt)}function qo(){or(Us),or(Tl),or(Yo)}function Kp(gt){var xt=qs(Yo.current),At=qs(Us.current);xt=Lt(At,gt.type,xt),At!==xt&&(Yn(Tl,gt),Yn(Us,xt))}function Xu(gt){Tl.current===gt&&(or(Us),or(Tl))}var Vr=Lr(0);function nu(gt){for(var xt=gt;xt!==null;){if(xt.tag===13){var At=xt.memoizedState;if(At!==null&&(At=At.dehydrated,At===null||br(At)||gr(At)))return xt}else if(xt.tag===19&&xt.memoizedProps.revealOrder!==void 0){if(xt.flags&128)return xt}else if(xt.child!==null){xt.child.return=xt,xt=xt.child;continue}if(xt===gt)break;for(;xt.sibling===null;){if(xt.return===null||xt.return===gt)return null;xt=xt.return}xt.sibling.return=xt.return,xt=xt.sibling}return null}var Yu=[];function qu(){for(var gt=0;gt<Yu.length;gt++){var xt=Yu[gt];Tn?xt._workInProgressVersionPrimary=null:xt._workInProgressVersionSecondary=null}Yu.length=0}var ru=st.ReactCurrentDispatcher,Ns=st.ReactCurrentBatchConfig,Ko=0,Hr=null,cs=null,ns=null,iu=!1,Al=!1,Cl=0,y0=0;function us(){throw Error(it(321))}function Ku(gt,xt){if(xt===null)return!1;for(var At=0;At<xt.length&&At<gt.length;At++)if(!As(gt[At],xt[At]))return!1;return!0}function Zu(gt,xt,At,Pt,kt,Ut){if(Ko=Ut,Hr=xt,xt.memoizedState=null,xt.updateQueue=null,xt.lanes=0,ru.current=gt===null||gt.memoizedState===null?S0:b0,gt=At(Pt,kt),Al){Ut=0;do{if(Al=!1,Cl=0,25<=Ut)throw Error(it(301));Ut+=1,ns=cs=null,xt.updateQueue=null,ru.current=M0,gt=At(Pt,kt)}while(Al)}if(ru.current=cu,xt=cs!==null&&cs.next!==null,Ko=0,ns=cs=Hr=null,iu=!1,xt)throw Error(it(300));return gt}function Qu(){var gt=Cl!==0;return Cl=0,gt}function lo(){var gt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ns===null?Hr.memoizedState=ns=gt:ns=ns.next=gt,ns}function Ks(){if(cs===null){var gt=Hr.alternate;gt=gt!==null?gt.memoizedState:null}else gt=cs.next;var xt=ns===null?Hr.memoizedState:ns.next;if(xt!==null)ns=xt,cs=gt;else{if(gt===null)throw Error(it(310));cs=gt,gt={memoizedState:cs.memoizedState,baseState:cs.baseState,baseQueue:cs.baseQueue,queue:cs.queue,next:null},ns===null?Hr.memoizedState=ns=gt:ns=ns.next=gt}return ns}function Io(gt,xt){return typeof xt=="function"?xt(gt):xt}function su(gt){var xt=Ks(),At=xt.queue;if(At===null)throw Error(it(311));At.lastRenderedReducer=gt;var Pt=cs,kt=Pt.baseQueue,Ut=At.pending;if(Ut!==null){if(kt!==null){var rn=kt.next;kt.next=Ut.next,Ut.next=rn}Pt.baseQueue=kt=Ut,At.pending=null}if(kt!==null){Ut=kt.next,Pt=Pt.baseState;var bn=rn=null,On=null,Xn=Ut;do{var ir=Xn.lane;if((Ko&ir)===ir)On!==null&&(On=On.next={lane:0,action:Xn.action,hasEagerState:Xn.hasEagerState,eagerState:Xn.eagerState,next:null}),Pt=Xn.hasEagerState?Xn.eagerState:gt(Pt,Xn.action);else{var xr={lane:ir,action:Xn.action,hasEagerState:Xn.hasEagerState,eagerState:Xn.eagerState,next:null};On===null?(bn=On=xr,rn=Pt):On=On.next=xr,Hr.lanes|=ir,Qo|=ir}Xn=Xn.next}while(Xn!==null&&Xn!==Ut);On===null?rn=Pt:On.next=bn,As(Pt,xt.memoizedState)||(Is=!0),xt.memoizedState=Pt,xt.baseState=rn,xt.baseQueue=On,At.lastRenderedState=Pt}if(gt=At.interleaved,gt!==null){kt=gt;do Ut=kt.lane,Hr.lanes|=Ut,Qo|=Ut,kt=kt.next;while(kt!==gt)}else kt===null&&(At.lanes=0);return[xt.memoizedState,At.dispatch]}function ou(gt){var xt=Ks(),At=xt.queue;if(At===null)throw Error(it(311));At.lastRenderedReducer=gt;var Pt=At.dispatch,kt=At.pending,Ut=xt.memoizedState;if(kt!==null){At.pending=null;var rn=kt=kt.next;do Ut=gt(Ut,rn.action),rn=rn.next;while(rn!==kt);As(Ut,xt.memoizedState)||(Is=!0),xt.memoizedState=Ut,xt.baseQueue===null&&(xt.baseState=Ut),At.lastRenderedState=Ut}return[Ut,Pt]}function Zp(){}function Qp(gt,xt){var At=Hr,Pt=Ks(),kt=xt(),Ut=!As(Pt.memoizedState,kt);if(Ut&&(Pt.memoizedState=kt,Is=!0),Pt=Pt.queue,Pl(tm.bind(null,At,Pt,gt),[gt]),Pt.getSnapshot!==xt||Ut||ns!==null&&ns.memoizedState.tag&1){if(At.flags|=2048,Rl(9,em.bind(null,At,Pt,kt,xt),void 0,null),Kr===null)throw Error(it(349));Ko&30||Jp(At,xt,kt)}return kt}function Jp(gt,xt,At){gt.flags|=16384,gt={getSnapshot:xt,value:At},xt=Hr.updateQueue,xt===null?(xt={lastEffect:null,stores:null},Hr.updateQueue=xt,xt.stores=[gt]):(At=xt.stores,At===null?xt.stores=[gt]:At.push(gt))}function em(gt,xt,At,Pt){xt.value=At,xt.getSnapshot=Pt,nm(xt)&&Os(gt,1,-1)}function tm(gt,xt,At){return At(function(){nm(xt)&&Os(gt,1,-1)})}function nm(gt){var xt=gt.getSnapshot;gt=gt.value;try{var At=xt();return!As(gt,At)}catch{return!0}}function Ju(gt){var xt=lo();return typeof gt=="function"&&(gt=gt()),xt.memoizedState=xt.baseState=gt,gt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:gt},xt.queue=gt,gt=gt.dispatch=w0.bind(null,Hr,gt),[xt.memoizedState,gt]}function Rl(gt,xt,At,Pt){return gt={tag:gt,create:xt,destroy:At,deps:Pt,next:null},xt=Hr.updateQueue,xt===null?(xt={lastEffect:null,stores:null},Hr.updateQueue=xt,xt.lastEffect=gt.next=gt):(At=xt.lastEffect,At===null?xt.lastEffect=gt.next=gt:(Pt=At.next,At.next=gt,gt.next=Pt,xt.lastEffect=gt)),gt}function rm(){return Ks().memoizedState}function au(gt,xt,At,Pt){var kt=lo();Hr.flags|=gt,kt.memoizedState=Rl(1|xt,At,void 0,Pt===void 0?null:Pt)}function lu(gt,xt,At,Pt){var kt=Ks();Pt=Pt===void 0?null:Pt;var Ut=void 0;if(cs!==null){var rn=cs.memoizedState;if(Ut=rn.destroy,Pt!==null&&Ku(Pt,rn.deps)){kt.memoizedState=Rl(xt,At,Ut,Pt);return}}Hr.flags|=gt,kt.memoizedState=Rl(1|xt,At,Ut,Pt)}function _h(gt,xt){return au(8390656,8,gt,xt)}function Pl(gt,xt){return lu(2048,8,gt,xt)}function im(gt,xt){return lu(4,2,gt,xt)}function sm(gt,xt){return lu(4,4,gt,xt)}function om(gt,xt){if(typeof xt=="function")return gt=gt(),xt(gt),function(){xt(null)};if(xt!=null)return gt=gt(),xt.current=gt,function(){xt.current=null}}function am(gt,xt,At){return At=At!=null?At.concat([gt]):null,lu(4,4,om.bind(null,xt,gt),At)}function _f(){}function lm(gt,xt){var At=Ks();xt=xt===void 0?null:xt;var Pt=At.memoizedState;return Pt!==null&&xt!==null&&Ku(xt,Pt[1])?Pt[0]:(At.memoizedState=[gt,xt],gt)}function cm(gt,xt){var At=Ks();xt=xt===void 0?null:xt;var Pt=At.memoizedState;return Pt!==null&&xt!==null&&Ku(xt,Pt[1])?Pt[0]:(gt=gt(),At.memoizedState=[gt,xt],gt)}function v0(gt,xt){var At=Sr;Sr=At!==0&&4>At?At:4,gt(!0);var Pt=Ns.transition;Ns.transition={};try{gt(!1),xt()}finally{Sr=At,Ns.transition=Pt}}function um(){return Ks().memoizedState}function _0(gt,xt,At){var Pt=xo(gt);At={lane:Pt,action:At,hasEagerState:!1,eagerState:null,next:null},hm(gt)?fm(xt,At):(dm(gt,xt,At),At=ws(),gt=Os(gt,Pt,At),gt!==null&&pm(gt,xt,Pt))}function w0(gt,xt,At){var Pt=xo(gt),kt={lane:Pt,action:At,hasEagerState:!1,eagerState:null,next:null};if(hm(gt))fm(xt,kt);else{dm(gt,xt,kt);var Ut=gt.alternate;if(gt.lanes===0&&(Ut===null||Ut.lanes===0)&&(Ut=xt.lastRenderedReducer,Ut!==null))try{var rn=xt.lastRenderedState,bn=Ut(rn,At);if(kt.hasEagerState=!0,kt.eagerState=bn,As(bn,rn))return}catch{}finally{}At=ws(),gt=Os(gt,Pt,At),gt!==null&&pm(gt,xt,Pt)}}function hm(gt){var xt=gt.alternate;return gt===Hr||xt!==null&&xt===Hr}function fm(gt,xt){Al=iu=!0;var At=gt.pending;At===null?xt.next=xt:(xt.next=At.next,At.next=xt),gt.pending=xt}function dm(gt,xt,At){Kr!==null&&gt.mode&1&&!(_r&2)?(gt=xt.interleaved,gt===null?(At.next=At,Cs===null?Cs=[xt]:Cs.push(xt)):(At.next=gt.next,gt.next=At),xt.interleaved=At):(gt=xt.pending,gt===null?At.next=At:(At.next=gt.next,gt.next=At),xt.pending=At)}function pm(gt,xt,At){if(At&4194240){var Pt=xt.lanes;Pt&=gt.pendingLanes,At|=Pt,xt.lanes=At,Xs(gt,At)}}var cu={readContext:Yr,useCallback:us,useContext:us,useEffect:us,useImperativeHandle:us,useInsertionEffect:us,useLayoutEffect:us,useMemo:us,useReducer:us,useRef:us,useState:us,useDebugValue:us,useDeferredValue:us,useTransition:us,useMutableSource:us,useSyncExternalStore:us,useId:us,unstable_isNewReconciler:!1},S0={readContext:Yr,useCallback:function(gt,xt){return lo().memoizedState=[gt,xt===void 0?null:xt],gt},useContext:Yr,useEffect:_h,useImperativeHandle:function(gt,xt,At){return At=At!=null?At.concat([gt]):null,au(4194308,4,om.bind(null,xt,gt),At)},useLayoutEffect:function(gt,xt){return au(4194308,4,gt,xt)},useInsertionEffect:function(gt,xt){return au(4,2,gt,xt)},useMemo:function(gt,xt){var At=lo();return xt=xt===void 0?null:xt,gt=gt(),At.memoizedState=[gt,xt],gt},useReducer:function(gt,xt,At){var Pt=lo();return xt=At!==void 0?At(xt):xt,Pt.memoizedState=Pt.baseState=xt,gt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gt,lastRenderedState:xt},Pt.queue=gt,gt=gt.dispatch=_0.bind(null,Hr,gt),[Pt.memoizedState,gt]},useRef:function(gt){var xt=lo();return gt={current:gt},xt.memoizedState=gt},useState:Ju,useDebugValue:_f,useDeferredValue:function(gt){var xt=Ju(gt),At=xt[0],Pt=xt[1];return _h(function(){var kt=Ns.transition;Ns.transition={};try{Pt(gt)}finally{Ns.transition=kt}},[gt]),At},useTransition:function(){var gt=Ju(!1),xt=gt[0];return gt=v0.bind(null,gt[1]),lo().memoizedState=gt,[xt,gt]},useMutableSource:function(){},useSyncExternalStore:function(gt,xt,At){var Pt=Hr,kt=lo();if(Nr){if(At===void 0)throw Error(it(407));At=At()}else{if(At=xt(),Kr===null)throw Error(it(349));Ko&30||Jp(Pt,xt,At)}kt.memoizedState=At;var Ut={value:At,getSnapshot:xt};return kt.queue=Ut,_h(tm.bind(null,Pt,Ut,gt),[gt]),Pt.flags|=2048,Rl(9,em.bind(null,Pt,Ut,At,xt),void 0,null),At},useId:function(){var gt=lo(),xt=Kr.identifierPrefix;if(Nr){var At=ao,Pt=oo;At=(Pt&~(1<<32-ms(Pt)-1)).toString(32)+At,xt=":"+xt+"R"+At,At=Cl++,0<At&&(xt+="H"+At.toString(32)),xt+=":"}else At=y0++,xt=":"+xt+"r"+At.toString(32)+":";return gt.memoizedState=xt},unstable_isNewReconciler:!1},b0={readContext:Yr,useCallback:lm,useContext:Yr,useEffect:Pl,useImperativeHandle:am,useInsertionEffect:im,useLayoutEffect:sm,useMemo:cm,useReducer:su,useRef:rm,useState:function(){return su(Io)},useDebugValue:_f,useDeferredValue:function(gt){var xt=su(Io),At=xt[0],Pt=xt[1];return Pl(function(){var kt=Ns.transition;Ns.transition={};try{Pt(gt)}finally{Ns.transition=kt}},[gt]),At},useTransition:function(){var gt=su(Io)[0],xt=Ks().memoizedState;return[gt,xt]},useMutableSource:Zp,useSyncExternalStore:Qp,useId:um,unstable_isNewReconciler:!1},M0={readContext:Yr,useCallback:lm,useContext:Yr,useEffect:Pl,useImperativeHandle:am,useInsertionEffect:im,useLayoutEffect:sm,useMemo:cm,useReducer:ou,useRef:rm,useState:function(){return ou(Io)},useDebugValue:_f,useDeferredValue:function(gt){var xt=ou(Io),At=xt[0],Pt=xt[1];return Pl(function(){var kt=Ns.transition;Ns.transition={};try{Pt(gt)}finally{Ns.transition=kt}},[gt]),At},useTransition:function(){var gt=ou(Io)[0],xt=Ks().memoizedState;return[gt,xt]},useMutableSource:Zp,useSyncExternalStore:Qp,useId:um,unstable_isNewReconciler:!1};function _d(gt,xt){try{var At="",Pt=xt;do At+=Co(Pt),Pt=Pt.return;while(Pt);var kt=At}catch(Ut){kt=`
Error generating stack: `+Ut.message+`
`+Ut.stack}return{value:gt,source:xt,stack:kt}}function ep(gt,xt){try{console.error(xt.value)}catch(At){setTimeout(function(){throw At})}}var E0=typeof WeakMap=="function"?WeakMap:Map;function mm(gt,xt,At){At=so(-1,At),At.tag=3,At.payload={element:null};var Pt=xt.value;return At.callback=function(){Eu||(Eu=!0,yp=Pt),ep(gt,xt)},At}function gm(gt,xt,At){At=so(-1,At),At.tag=3;var Pt=gt.type.getDerivedStateFromError;if(typeof Pt=="function"){var kt=xt.value;At.payload=function(){return Pt(kt)},At.callback=function(){ep(gt,xt)}}var Ut=gt.stateNode;return Ut!==null&&typeof Ut.componentDidCatch=="function"&&(At.callback=function(){ep(gt,xt),typeof Pt!="function"&&(mo===null?mo=new Set([this]):mo.add(this));var rn=xt.stack;this.componentDidCatch(xt.value,{componentStack:rn!==null?rn:""})}),At}function xm(gt,xt,At){var Pt=gt.pingCache;if(Pt===null){Pt=gt.pingCache=new E0;var kt=new Set;Pt.set(xt,kt)}else kt=Pt.get(xt),kt===void 0&&(kt=new Set,Pt.set(xt,kt));kt.has(At)||(kt.add(At),gt=O0.bind(null,gt,xt,At),xt.then(gt,gt))}function ym(gt){do{var xt;if((xt=gt.tag===13)&&(xt=gt.memoizedState,xt=xt!==null?xt.dehydrated!==null:!0),xt)return gt;gt=gt.return}while(gt!==null);return null}function vm(gt,xt,At,Pt,kt){return gt.mode&1?(gt.flags|=65536,gt.lanes=kt,gt):(gt===xt?gt.flags|=65536:(gt.flags|=128,At.flags|=131072,At.flags&=-52805,At.tag===1&&(At.alternate===null?At.tag=17:(xt=so(-1,1),xt.tag=2,po(At,xt))),At.lanes|=1),gt)}function Zs(gt){gt.flags|=4}function _m(gt,xt){if(gt!==null&&gt.child===xt.child)return!0;if(xt.flags&16)return!1;for(gt=xt.child;gt!==null;){if(gt.flags&12854||gt.subtreeFlags&12854)return!1;gt=gt.sibling}return!0}var Il,Dl,uu,hu;if(yn)Il=function(gt,xt){for(var At=xt.child;At!==null;){if(At.tag===5||At.tag===6)Ht(gt,At.stateNode);else if(At.tag!==4&&At.child!==null){At.child.return=At,At=At.child;continue}if(At===xt)break;for(;At.sibling===null;){if(At.return===null||At.return===xt)return;At=At.return}At.sibling.return=At.return,At=At.sibling}},Dl=function(){},uu=function(gt,xt,At,Pt,kt){if(gt=gt.memoizedProps,gt!==Pt){var Ut=xt.stateNode,rn=qs(Us.current);At=Gt(Ut,At,gt,Pt,kt,rn),(xt.updateQueue=At)&&Zs(xt)}},hu=function(gt,xt,At,Pt){At!==Pt&&Zs(xt)};else if(Vt){Il=function(gt,xt,At,Pt){for(var kt=xt.child;kt!==null;){if(kt.tag===5){var Ut=kt.stateNode;At&&Pt&&(Ut=hn(Ut,kt.type,kt.memoizedProps,kt)),Ht(gt,Ut)}else if(kt.tag===6)Ut=kt.stateNode,At&&Pt&&(Ut=En(Ut,kt.memoizedProps,kt)),Ht(gt,Ut);else if(kt.tag!==4){if(kt.tag===22&&kt.memoizedState!==null)Ut=kt.child,Ut!==null&&(Ut.return=kt),Il(gt,kt,!0,!0);else if(kt.child!==null){kt.child.return=kt,kt=kt.child;continue}}if(kt===xt)break;for(;kt.sibling===null;){if(kt.return===null||kt.return===xt)return;kt=kt.return}kt.sibling.return=kt.return,kt=kt.sibling}};var wm=function(gt,xt,At,Pt){for(var kt=xt.child;kt!==null;){if(kt.tag===5){var Ut=kt.stateNode;At&&Pt&&(Ut=hn(Ut,kt.type,kt.memoizedProps,kt)),hr(gt,Ut)}else if(kt.tag===6)Ut=kt.stateNode,At&&Pt&&(Ut=En(Ut,kt.memoizedProps,kt)),hr(gt,Ut);else if(kt.tag!==4){if(kt.tag===22&&kt.memoizedState!==null)Ut=kt.child,Ut!==null&&(Ut.return=kt),wm(gt,kt,!0,!0);else if(kt.child!==null){kt.child.return=kt,kt=kt.child;continue}}if(kt===xt)break;for(;kt.sibling===null;){if(kt.return===null||kt.return===xt)return;kt=kt.return}kt.sibling.return=kt.return,kt=kt.sibling}};Dl=function(gt,xt){var At=xt.stateNode;if(!_m(gt,xt)){gt=At.containerInfo;var Pt=qn(gt);wm(Pt,xt,!1,!1),At.pendingChildren=Pt,Zs(xt),fr(gt,Pt)}},uu=function(gt,xt,At,Pt,kt){var Ut=gt.stateNode,rn=gt.memoizedProps;if((gt=_m(gt,xt))&&rn===Pt)xt.stateNode=Ut;else{var bn=xt.stateNode,On=qs(Us.current),Xn=null;rn!==Pt&&(Xn=Gt(bn,At,rn,Pt,kt,On)),gt&&Xn===null?xt.stateNode=Ut:(Ut=jn(Ut,Xn,At,rn,Pt,xt,gt,bn),qt(Ut,At,Pt,kt,On)&&Zs(xt),xt.stateNode=Ut,gt?Zs(xt):Il(Ut,xt,!1,!1))}},hu=function(gt,xt,At,Pt){At!==Pt?(gt=qs(Yo.current),At=qs(Us.current),xt.stateNode=Zt(Pt,gt,At,xt),Zs(xt)):xt.stateNode=gt.stateNode}}else Dl=function(){},uu=function(){},hu=function(){};function Ll(gt,xt){if(!Nr)switch(gt.tailMode){case"hidden":xt=gt.tail;for(var At=null;xt!==null;)xt.alternate!==null&&(At=xt),xt=xt.sibling;At===null?gt.tail=null:At.sibling=null;break;case"collapsed":At=gt.tail;for(var Pt=null;At!==null;)At.alternate!==null&&(Pt=At),At=At.sibling;Pt===null?xt||gt.tail===null?gt.tail=null:gt.tail.sibling=null:Pt.sibling=null}}function hs(gt){var xt=gt.alternate!==null&&gt.alternate.child===gt.child,At=0,Pt=0;if(xt)for(var kt=gt.child;kt!==null;)At|=kt.lanes|kt.childLanes,Pt|=kt.subtreeFlags&14680064,Pt|=kt.flags&14680064,kt.return=gt,kt=kt.sibling;else for(kt=gt.child;kt!==null;)At|=kt.lanes|kt.childLanes,Pt|=kt.subtreeFlags,Pt|=kt.flags,kt.return=gt,kt=kt.sibling;return gt.subtreeFlags|=Pt,gt.childLanes=At,xt}function T0(gt,xt,At){var Pt=xt.pendingProps;switch($u(xt),xt.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hs(xt),null;case 1:return Gr(xt.type)&&Cr(),hs(xt),null;case 3:return Pt=xt.stateNode,qo(),or(kr),or(mr),qu(),Pt.pendingContext&&(Pt.context=Pt.pendingContext,Pt.pendingContext=null),(gt===null||gt.child===null)&&(Sl(xt)?Zs(xt):gt===null||gt.memoizedState.isDehydrated&&!(xt.flags&256)||(xt.flags|=1024,Gs!==null&&(wp(Gs),Gs=null))),Dl(gt,xt),hs(xt),null;case 5:Xu(xt),At=qs(Yo.current);var kt=xt.type;if(gt!==null&&xt.stateNode!=null)uu(gt,xt,kt,Pt,At),gt.ref!==xt.ref&&(xt.flags|=512,xt.flags|=2097152);else{if(!Pt){if(xt.stateNode===null)throw Error(it(166));return hs(xt),null}if(gt=qs(Us.current),Sl(xt)){if(!fn)throw Error(it(175));gt=Ur(xt.stateNode,xt.type,xt.memoizedProps,At,gt,xt,!wl),xt.updateQueue=gt,gt!==null&&Zs(xt)}else{var Ut=zt(kt,Pt,At,gt,xt);Il(Ut,xt,!1,!1),xt.stateNode=Ut,qt(Ut,kt,Pt,At,gt)&&Zs(xt)}xt.ref!==null&&(xt.flags|=512,xt.flags|=2097152)}return hs(xt),null;case 6:if(gt&&xt.stateNode!=null)hu(gt,xt,gt.memoizedProps,Pt);else{if(typeof Pt!="string"&&xt.stateNode===null)throw Error(it(166));if(gt=qs(Yo.current),At=qs(Us.current),Sl(xt)){if(!fn)throw Error(it(176));if(gt=xt.stateNode,Pt=xt.memoizedProps,(At=Qr(gt,Pt,xt,!wl))&&(kt=Rs,kt!==null))switch(Ut=(kt.mode&1)!==0,kt.tag){case 3:Qn(kt.stateNode.containerInfo,gt,Pt,Ut);break;case 5:rr(kt.type,kt.memoizedProps,kt.stateNode,gt,Pt,Ut)}At&&Zs(xt)}else xt.stateNode=Zt(Pt,gt,At,xt)}return hs(xt),null;case 13:if(or(Vr),Pt=xt.memoizedState,Nr&&Ps!==null&&xt.mode&1&&!(xt.flags&128)){for(gt=Ps;gt;)gt=Tr(gt);return jo(),xt.flags|=98560,xt}if(Pt!==null&&Pt.dehydrated!==null){if(Pt=Sl(xt),gt===null){if(!Pt)throw Error(it(318));if(!fn)throw Error(it(344));if(gt=xt.memoizedState,gt=gt!==null?gt.dehydrated:null,!gt)throw Error(it(317));$r(gt,xt)}else jo(),!(xt.flags&128)&&(xt.memoizedState=null),xt.flags|=4;return hs(xt),null}return Gs!==null&&(wp(Gs),Gs=null),xt.flags&128?(xt.lanes=At,xt):(Pt=Pt!==null,At=!1,gt===null?Sl(xt):At=gt.memoizedState!==null,Pt&&!At&&(xt.child.flags|=8192,xt.mode&1&&(gt===null||Vr.current&1?Jr===0&&(Jr=3):bp())),xt.updateQueue!==null&&(xt.flags|=4),hs(xt),null);case 4:return qo(),Dl(gt,xt),gt===null&&Jt(xt.stateNode.containerInfo),hs(xt),null;case 10:return ts(xt.type._context),hs(xt),null;case 17:return Gr(xt.type)&&Cr(),hs(xt),null;case 19:if(or(Vr),kt=xt.memoizedState,kt===null)return hs(xt),null;if(Pt=(xt.flags&128)!==0,Ut=kt.rendering,Ut===null)if(Pt)Ll(kt,!1);else{if(Jr!==0||gt!==null&&gt.flags&128)for(gt=xt.child;gt!==null;){if(Ut=nu(gt),Ut!==null){for(xt.flags|=128,Ll(kt,!1),gt=Ut.updateQueue,gt!==null&&(xt.updateQueue=gt,xt.flags|=4),xt.subtreeFlags=0,gt=At,Pt=xt.child;Pt!==null;)At=Pt,kt=gt,At.flags&=14680066,Ut=At.alternate,Ut===null?(At.childLanes=0,At.lanes=kt,At.child=null,At.subtreeFlags=0,At.memoizedProps=null,At.memoizedState=null,At.updateQueue=null,At.dependencies=null,At.stateNode=null):(At.childLanes=Ut.childLanes,At.lanes=Ut.lanes,At.child=Ut.child,At.subtreeFlags=0,At.deletions=null,At.memoizedProps=Ut.memoizedProps,At.memoizedState=Ut.memoizedState,At.updateQueue=Ut.updateQueue,At.type=Ut.type,kt=Ut.dependencies,At.dependencies=kt===null?null:{lanes:kt.lanes,firstContext:kt.firstContext}),Pt=Pt.sibling;return Yn(Vr,Vr.current&1|2),xt.child}gt=gt.sibling}kt.tail!==null&&Or()>xp&&(xt.flags|=128,Pt=!0,Ll(kt,!1),xt.lanes=4194304)}else{if(!Pt)if(gt=nu(Ut),gt!==null){if(xt.flags|=128,Pt=!0,gt=gt.updateQueue,gt!==null&&(xt.updateQueue=gt,xt.flags|=4),Ll(kt,!0),kt.tail===null&&kt.tailMode==="hidden"&&!Ut.alternate&&!Nr)return hs(xt),null}else 2*Or()-kt.renderingStartTime>xp&&At!==1073741824&&(xt.flags|=128,Pt=!0,Ll(kt,!1),xt.lanes=4194304);kt.isBackwards?(Ut.sibling=xt.child,xt.child=Ut):(gt=kt.last,gt!==null?gt.sibling=Ut:xt.child=Ut,kt.last=Ut)}return kt.tail!==null?(xt=kt.tail,kt.rendering=xt,kt.tail=xt.sibling,kt.renderingStartTime=Or(),xt.sibling=null,gt=Vr.current,Yn(Vr,Pt?gt&1|2:gt&1),xt):(hs(xt),null);case 22:case 23:return Sp(),Pt=xt.memoizedState!==null,gt!==null&&gt.memoizedState!==null!==Pt&&(xt.flags|=8192),Pt&&xt.mode&1?ks&1073741824&&(hs(xt),yn&&xt.subtreeFlags&6&&(xt.flags|=8192)):hs(xt),null;case 24:return null;case 25:return null}throw Error(it(156,xt.tag))}var A0=st.ReactCurrentOwner,Is=!1;function _s(gt,xt,At,Pt){xt.child=gt===null?qp(xt,null,At,Pt):Xo(xt,gt.child,At,Pt)}function Sm(gt,xt,At,Pt,kt){At=At.render;var Ut=xt.ref;return Xr(xt,kt),Pt=Zu(gt,xt,At,Pt,Ut,kt),At=Qu(),gt!==null&&!Is?(xt.updateQueue=gt.updateQueue,xt.flags&=-2053,gt.lanes&=~kt,co(gt,xt,kt)):(Nr&&At&&zu(xt),xt.flags|=1,_s(gt,xt,Pt,kt),xt.child)}function bm(gt,xt,At,Pt,kt){if(gt===null){var Ut=At.type;return typeof Ut=="function"&&!Mp(Ut)&&Ut.defaultProps===void 0&&At.compare===null&&At.defaultProps===void 0?(xt.tag=15,xt.type=Ut,Mm(gt,xt,Ut,Pt,kt)):(gt=ku(At.type,null,Pt,xt,xt.mode,kt),gt.ref=xt.ref,gt.return=xt,xt.child=gt)}if(Ut=gt.child,!(gt.lanes&kt)){var rn=Ut.memoizedProps;if(At=At.compare,At=At!==null?At:Ao,At(rn,Pt)&&gt.ref===xt.ref)return co(gt,xt,kt)}return xt.flags|=1,gt=vo(Ut,Pt),gt.ref=xt.ref,gt.return=xt,xt.child=gt}function Mm(gt,xt,At,Pt,kt){if(gt!==null&&Ao(gt.memoizedProps,Pt)&&gt.ref===xt.ref)if(Is=!1,(gt.lanes&kt)!==0)gt.flags&131072&&(Is=!0);else return xt.lanes=gt.lanes,co(gt,xt,kt);return tp(gt,xt,At,Pt,kt)}function Em(gt,xt,At){var Pt=xt.pendingProps,kt=Pt.children,Ut=gt!==null?gt.memoizedState:null;if(Pt.mode==="hidden")if(!(xt.mode&1))xt.memoizedState={baseLanes:0,cachePool:null},Yn(Zo,ks),ks|=At;else if(At&1073741824)xt.memoizedState={baseLanes:0,cachePool:null},Pt=Ut!==null?Ut.baseLanes:At,Yn(Zo,ks),ks|=Pt;else return gt=Ut!==null?Ut.baseLanes|At:At,xt.lanes=xt.childLanes=1073741824,xt.memoizedState={baseLanes:gt,cachePool:null},xt.updateQueue=null,Yn(Zo,ks),ks|=gt,null;else Ut!==null?(Pt=Ut.baseLanes|At,xt.memoizedState=null):Pt=At,Yn(Zo,ks),ks|=Pt;return _s(gt,xt,kt,At),xt.child}function Tm(gt,xt){var At=xt.ref;(gt===null&&At!==null||gt!==null&&gt.ref!==At)&&(xt.flags|=512,xt.flags|=2097152)}function tp(gt,xt,At,Pt,kt){var Ut=Gr(At)?ss:mr.current;return Ut=Fr(xt,Ut),Xr(xt,kt),At=Zu(gt,xt,At,Pt,Ut,kt),Pt=Qu(),gt!==null&&!Is?(xt.updateQueue=gt.updateQueue,xt.flags&=-2053,gt.lanes&=~kt,co(gt,xt,kt)):(Nr&&Pt&&zu(xt),xt.flags|=1,_s(gt,xt,At,kt),xt.child)}function Am(gt,xt,At,Pt,kt){if(Gr(At)){var Ut=!0;jr(xt)}else Ut=!1;if(Xr(xt,kt),xt.stateNode===null)gt!==null&&(gt.alternate=null,xt.alternate=null,xt.flags|=2),zp(xt,At,Pt),Vu(xt,At,Pt,kt),Pt=!0;else if(gt===null){var rn=xt.stateNode,bn=xt.memoizedProps;rn.props=bn;var On=rn.context,Xn=At.contextType;typeof Xn=="object"&&Xn!==null?Xn=Yr(Xn):(Xn=Gr(At)?ss:mr.current,Xn=Fr(xt,Xn));var ir=At.getDerivedStateFromProps,xr=typeof ir=="function"||typeof rn.getSnapshotBeforeUpdate=="function";xr||typeof rn.UNSAFE_componentWillReceiveProps!="function"&&typeof rn.componentWillReceiveProps!="function"||(bn!==Pt||On!==Xn)&&$p(xt,rn,Pt,Xn),fo=!1;var pr=xt.memoizedState;rn.state=pr,Ql(xt,Pt,rn,kt),On=xt.memoizedState,bn!==Pt||pr!==On||kr.current||fo?(typeof ir=="function"&&(Ou(xt,At,ir,Pt),On=xt.memoizedState),(bn=fo||Vp(xt,At,bn,Pt,pr,On,Xn))?(xr||typeof rn.UNSAFE_componentWillMount!="function"&&typeof rn.componentWillMount!="function"||(typeof rn.componentWillMount=="function"&&rn.componentWillMount(),typeof rn.UNSAFE_componentWillMount=="function"&&rn.UNSAFE_componentWillMount()),typeof rn.componentDidMount=="function"&&(xt.flags|=4194308)):(typeof rn.componentDidMount=="function"&&(xt.flags|=4194308),xt.memoizedProps=Pt,xt.memoizedState=On),rn.props=Pt,rn.state=On,rn.context=Xn,Pt=bn):(typeof rn.componentDidMount=="function"&&(xt.flags|=4194308),Pt=!1)}else{rn=xt.stateNode,Fp(gt,xt),bn=xt.memoizedProps,Xn=xt.type===xt.elementType?bn:ys(xt.type,bn),rn.props=Xn,xr=xt.pendingProps,pr=rn.context,On=At.contextType,typeof On=="object"&&On!==null?On=Yr(On):(On=Gr(At)?ss:mr.current,On=Fr(xt,On));var Br=At.getDerivedStateFromProps;(ir=typeof Br=="function"||typeof rn.getSnapshotBeforeUpdate=="function")||typeof rn.UNSAFE_componentWillReceiveProps!="function"&&typeof rn.componentWillReceiveProps!="function"||(bn!==xr||pr!==On)&&$p(xt,rn,Pt,On),fo=!1,pr=xt.memoizedState,rn.state=pr,Ql(xt,Pt,rn,kt);var ur=xt.memoizedState;bn!==xr||pr!==ur||kr.current||fo?(typeof Br=="function"&&(Ou(xt,At,Br,Pt),ur=xt.memoizedState),(Xn=fo||Vp(xt,At,Xn,Pt,pr,ur,On)||!1)?(ir||typeof rn.UNSAFE_componentWillUpdate!="function"&&typeof rn.componentWillUpdate!="function"||(typeof rn.componentWillUpdate=="function"&&rn.componentWillUpdate(Pt,ur,On),typeof rn.UNSAFE_componentWillUpdate=="function"&&rn.UNSAFE_componentWillUpdate(Pt,ur,On)),typeof rn.componentDidUpdate=="function"&&(xt.flags|=4),typeof rn.getSnapshotBeforeUpdate=="function"&&(xt.flags|=1024)):(typeof rn.componentDidUpdate!="function"||bn===gt.memoizedProps&&pr===gt.memoizedState||(xt.flags|=4),typeof rn.getSnapshotBeforeUpdate!="function"||bn===gt.memoizedProps&&pr===gt.memoizedState||(xt.flags|=1024),xt.memoizedProps=Pt,xt.memoizedState=ur),rn.props=Pt,rn.state=ur,rn.context=On,Pt=Xn):(typeof rn.componentDidUpdate!="function"||bn===gt.memoizedProps&&pr===gt.memoizedState||(xt.flags|=4),typeof rn.getSnapshotBeforeUpdate!="function"||bn===gt.memoizedProps&&pr===gt.memoizedState||(xt.flags|=1024),Pt=!1)}return np(gt,xt,At,Pt,Ut,kt)}function np(gt,xt,At,Pt,kt,Ut){Tm(gt,xt);var rn=(xt.flags&128)!==0;if(!Pt&&!rn)return kt&&as(xt,At,!1),co(gt,xt,Ut);Pt=xt.stateNode,A0.current=xt;var bn=rn&&typeof At.getDerivedStateFromError!="function"?null:Pt.render();return xt.flags|=1,gt!==null&&rn?(xt.child=Xo(xt,gt.child,null,Ut),xt.child=Xo(xt,null,bn,Ut)):_s(gt,xt,bn,Ut),xt.memoizedState=Pt.state,kt&&as(xt,At,!0),xt.child}function Cm(gt){var xt=gt.stateNode;xt.pendingContext?ps(gt,xt.pendingContext,xt.pendingContext!==xt.context):xt.context&&ps(gt,xt.context,!1),ju(gt,xt.containerInfo)}function Rm(gt,xt,At,Pt,kt){return jo(),Wu(kt),xt.flags|=256,_s(gt,xt,At,Pt),xt.child}var fu={dehydrated:null,treeContext:null,retryLane:0};function du(gt){return{baseLanes:gt,cachePool:null}}function Pm(gt,xt,At){var Pt=xt.pendingProps,kt=Vr.current,Ut=!1,rn=(xt.flags&128)!==0,bn;if((bn=rn)||(bn=gt!==null&&gt.memoizedState===null?!1:(kt&2)!==0),bn?(Ut=!0,xt.flags&=-129):(gt===null||gt.memoizedState!==null)&&(kt|=1),Yn(Vr,kt&1),gt===null)return Hu(xt),gt=xt.memoizedState,gt!==null&&(gt=gt.dehydrated,gt!==null)?(xt.mode&1?gr(gt)?xt.lanes=8:xt.lanes=1073741824:xt.lanes=1,null):(kt=Pt.children,gt=Pt.fallback,Ut?(Pt=xt.mode,Ut=xt.child,kt={mode:"hidden",children:kt},!(Pt&1)&&Ut!==null?(Ut.childLanes=0,Ut.pendingProps=kt):Ut=Du(kt,Pt,0,null),gt=Uo(gt,Pt,At,null),Ut.return=xt,gt.return=xt,Ut.sibling=gt,xt.child=Ut,xt.child.memoizedState=du(At),xt.memoizedState=fu,gt):rp(xt,kt));if(kt=gt.memoizedState,kt!==null){if(bn=kt.dehydrated,bn!==null){if(rn)return xt.flags&256?(xt.flags&=-257,pu(gt,xt,At,Error(it(422)))):xt.memoizedState!==null?(xt.child=gt.child,xt.flags|=128,null):(Ut=Pt.fallback,kt=xt.mode,Pt=Du({mode:"visible",children:Pt.children},kt,0,null),Ut=Uo(Ut,kt,At,null),Ut.flags|=2,Pt.return=xt,Ut.return=xt,Pt.sibling=Ut,xt.child=Pt,xt.mode&1&&Xo(xt,gt.child,null,At),xt.child.memoizedState=du(At),xt.memoizedState=fu,Ut);if(!(xt.mode&1))xt=pu(gt,xt,At,null);else if(gr(bn))xt=pu(gt,xt,At,Error(it(419)));else if(Pt=(At&gt.childLanes)!==0,Is||Pt){if(Pt=Kr,Pt!==null){switch(At&-At){case 4:Ut=2;break;case 16:Ut=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Ut=32;break;case 536870912:Ut=268435456;break;default:Ut=0}Pt=Ut&(Pt.suspendedLanes|At)?0:Ut,Pt!==0&&Pt!==kt.retryLane&&(kt.retryLane=Pt,Os(gt,Pt,-1))}bp(),xt=pu(gt,xt,At,Error(it(421)))}else br(bn)?(xt.flags|=128,xt.child=gt.child,xt=V0.bind(null,gt),Er(bn,xt),xt=null):(At=kt.treeContext,fn&&(Ps=Wr(bn),Rs=xt,Nr=!0,Gs=null,wl=!1,At!==null&&(Bs[Fs++]=oo,Bs[Fs++]=ao,Bs[Fs++]=Ro,oo=At.id,ao=At.overflow,Ro=xt)),xt=rp(xt,xt.pendingProps.children),xt.flags|=4096);return xt}return Ut?(Pt=km(gt,xt,Pt.children,Pt.fallback,At),Ut=xt.child,kt=gt.child.memoizedState,Ut.memoizedState=kt===null?du(At):{baseLanes:kt.baseLanes|At,cachePool:null},Ut.childLanes=gt.childLanes&~At,xt.memoizedState=fu,Pt):(At=Im(gt,xt,Pt.children,At),xt.memoizedState=null,At)}return Ut?(Pt=km(gt,xt,Pt.children,Pt.fallback,At),Ut=xt.child,kt=gt.child.memoizedState,Ut.memoizedState=kt===null?du(At):{baseLanes:kt.baseLanes|At,cachePool:null},Ut.childLanes=gt.childLanes&~At,xt.memoizedState=fu,Pt):(At=Im(gt,xt,Pt.children,At),xt.memoizedState=null,At)}function rp(gt,xt){return xt=Du({mode:"visible",children:xt},gt.mode,0,null),xt.return=gt,gt.child=xt}function Im(gt,xt,At,Pt){var kt=gt.child;return gt=kt.sibling,At=vo(kt,{mode:"visible",children:At}),!(xt.mode&1)&&(At.lanes=Pt),At.return=xt,At.sibling=null,gt!==null&&(Pt=xt.deletions,Pt===null?(xt.deletions=[gt],xt.flags|=16):Pt.push(gt)),xt.child=At}function km(gt,xt,At,Pt,kt){var Ut=xt.mode;gt=gt.child;var rn=gt.sibling,bn={mode:"hidden",children:At};return!(Ut&1)&&xt.child!==gt?(At=xt.child,At.childLanes=0,At.pendingProps=bn,xt.deletions=null):(At=vo(gt,bn),At.subtreeFlags=gt.subtreeFlags&14680064),rn!==null?Pt=vo(rn,Pt):(Pt=Uo(Pt,Ut,kt,null),Pt.flags|=2),Pt.return=xt,At.return=xt,At.sibling=Pt,xt.child=At,Pt}function pu(gt,xt,At,Pt){return Pt!==null&&Wu(Pt),Xo(xt,gt.child,null,At),gt=rp(xt,xt.pendingProps.children),gt.flags|=2,xt.memoizedState=null,gt}function Dm(gt,xt,At){gt.lanes|=xt;var Pt=gt.alternate;Pt!==null&&(Pt.lanes|=xt),vs(gt.return,xt,At)}function ip(gt,xt,At,Pt,kt){var Ut=gt.memoizedState;Ut===null?gt.memoizedState={isBackwards:xt,rendering:null,renderingStartTime:0,last:Pt,tail:At,tailMode:kt}:(Ut.isBackwards=xt,Ut.rendering=null,Ut.renderingStartTime=0,Ut.last=Pt,Ut.tail=At,Ut.tailMode=kt)}function Lm(gt,xt,At){var Pt=xt.pendingProps,kt=Pt.revealOrder,Ut=Pt.tail;if(_s(gt,xt,Pt.children,At),Pt=Vr.current,Pt&2)Pt=Pt&1|2,xt.flags|=128;else{if(gt!==null&&gt.flags&128)e:for(gt=xt.child;gt!==null;){if(gt.tag===13)gt.memoizedState!==null&&Dm(gt,At,xt);else if(gt.tag===19)Dm(gt,At,xt);else if(gt.child!==null){gt.child.return=gt,gt=gt.child;continue}if(gt===xt)break e;for(;gt.sibling===null;){if(gt.return===null||gt.return===xt)break e;gt=gt.return}gt.sibling.return=gt.return,gt=gt.sibling}Pt&=1}if(Yn(Vr,Pt),!(xt.mode&1))xt.memoizedState=null;else switch(kt){case"forwards":for(At=xt.child,kt=null;At!==null;)gt=At.alternate,gt!==null&&nu(gt)===null&&(kt=At),At=At.sibling;At=kt,At===null?(kt=xt.child,xt.child=null):(kt=At.sibling,At.sibling=null),ip(xt,!1,kt,At,Ut);break;case"backwards":for(At=null,kt=xt.child,xt.child=null;kt!==null;){if(gt=kt.alternate,gt!==null&&nu(gt)===null){xt.child=kt;break}gt=kt.sibling,kt.sibling=At,At=kt,kt=gt}ip(xt,!0,At,null,Ut);break;case"together":ip(xt,!1,null,null,void 0);break;default:xt.memoizedState=null}return xt.child}function co(gt,xt,At){if(gt!==null&&(xt.dependencies=gt.dependencies),Qo|=xt.lanes,!(At&xt.childLanes))return null;if(gt!==null&&xt.child!==gt.child)throw Error(it(153));if(xt.child!==null){for(gt=xt.child,At=vo(gt,gt.pendingProps),xt.child=At,At.return=xt;gt.sibling!==null;)gt=gt.sibling,At=At.sibling=vo(gt,gt.pendingProps),At.return=xt;At.sibling=null}return xt.child}function C0(gt,xt,At){switch(xt.tag){case 3:Cm(xt),jo();break;case 5:Kp(xt);break;case 1:Gr(xt.type)&&jr(xt);break;case 4:ju(xt,xt.stateNode.containerInfo);break;case 10:Kl(xt,xt.type._context,xt.memoizedProps.value);break;case 13:var Pt=xt.memoizedState;if(Pt!==null)return Pt.dehydrated!==null?(Yn(Vr,Vr.current&1),xt.flags|=128,null):At&xt.child.childLanes?Pm(gt,xt,At):(Yn(Vr,Vr.current&1),gt=co(gt,xt,At),gt!==null?gt.sibling:null);Yn(Vr,Vr.current&1);break;case 19:if(Pt=(At&xt.childLanes)!==0,gt.flags&128){if(Pt)return Lm(gt,xt,At);xt.flags|=128}var kt=xt.memoizedState;if(kt!==null&&(kt.rendering=null,kt.tail=null,kt.lastEffect=null),Yn(Vr,Vr.current),Pt)break;return null;case 22:case 23:return xt.lanes=0,Em(gt,xt,At)}return co(gt,xt,At)}function R0(gt,xt){switch($u(xt),xt.tag){case 1:return Gr(xt.type)&&Cr(),gt=xt.flags,gt&65536?(xt.flags=gt&-65537|128,xt):null;case 3:return qo(),or(kr),or(mr),qu(),gt=xt.flags,gt&65536&&!(gt&128)?(xt.flags=gt&-65537|128,xt):null;case 5:return Xu(xt),null;case 13:if(or(Vr),gt=xt.memoizedState,gt!==null&&gt.dehydrated!==null){if(xt.alternate===null)throw Error(it(340));jo()}return gt=xt.flags,gt&65536?(xt.flags=gt&-65537|128,xt):null;case 19:return or(Vr),null;case 4:return qo(),null;case 10:return ts(xt.type._context),null;case 22:case 23:return Sp(),null;case 24:return null;default:return null}}var mu=!1,ko=!1,P0=typeof WeakSet=="function"?WeakSet:Set,tr=null;function gu(gt,xt){var At=gt.ref;if(At!==null)if(typeof At=="function")try{At(null)}catch(Pt){Es(gt,xt,Pt)}else At.current=null}function sp(gt,xt,At){try{At()}catch(Pt){Es(gt,xt,Pt)}}var Bm=!1;function I0(gt,xt){for(Ot(gt.containerInfo),tr=xt;tr!==null;)if(gt=tr,xt=gt.child,(gt.subtreeFlags&1028)!==0&&xt!==null)xt.return=gt,tr=xt;else for(;tr!==null;){gt=tr;try{var At=gt.alternate;if(gt.flags&1024)switch(gt.tag){case 0:case 11:case 15:break;case 1:if(At!==null){var Pt=At.memoizedProps,kt=At.memoizedState,Ut=gt.stateNode,rn=Ut.getSnapshotBeforeUpdate(gt.elementType===gt.type?Pt:ys(gt.type,Pt),kt);Ut.__reactInternalSnapshotBeforeUpdate=rn}break;case 3:yn&&Hn(gt.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(it(163))}}catch(bn){Es(gt,gt.return,bn)}if(xt=gt.sibling,xt!==null){xt.return=gt.return,tr=xt;break}tr=gt.return}return At=Bm,Bm=!1,At}function Do(gt,xt,At){var Pt=xt.updateQueue;if(Pt=Pt!==null?Pt.lastEffect:null,Pt!==null){var kt=Pt=Pt.next;do{if((kt.tag&gt)===gt){var Ut=kt.destroy;kt.destroy=void 0,Ut!==void 0&&sp(xt,At,Ut)}kt=kt.next}while(kt!==Pt)}}function Bl(gt,xt){if(xt=xt.updateQueue,xt=xt!==null?xt.lastEffect:null,xt!==null){var At=xt=xt.next;do{if((At.tag&gt)===gt){var Pt=At.create;At.destroy=Pt()}At=At.next}while(At!==xt)}}function op(gt){var xt=gt.ref;if(xt!==null){var At=gt.stateNode;switch(gt.tag){case 5:gt=$t(At);break;default:gt=At}typeof xt=="function"?xt(gt):xt.current=gt}}function Fm(gt,xt,At){if(Ts&&typeof Ts.onCommitFiberUnmount=="function")try{Ts.onCommitFiberUnmount(Eo,xt)}catch{}switch(xt.tag){case 0:case 11:case 14:case 15:if(gt=xt.updateQueue,gt!==null&&(gt=gt.lastEffect,gt!==null)){var Pt=gt=gt.next;do{var kt=Pt,Ut=kt.destroy;kt=kt.tag,Ut!==void 0&&(kt&2||kt&4)&&sp(xt,At,Ut),Pt=Pt.next}while(Pt!==gt)}break;case 1:if(gu(xt,At),gt=xt.stateNode,typeof gt.componentWillUnmount=="function")try{gt.props=xt.memoizedProps,gt.state=xt.memoizedState,gt.componentWillUnmount()}catch(rn){Es(xt,At,rn)}break;case 5:gu(xt,At);break;case 4:yn?$m(gt,xt,At):Vt&&Vt&&(xt=xt.stateNode.containerInfo,At=qn(xt),jt(xt,At))}}function Um(gt,xt,At){for(var Pt=xt;;)if(Fm(gt,Pt,At),Pt.child===null||yn&&Pt.tag===4){if(Pt===xt)break;for(;Pt.sibling===null;){if(Pt.return===null||Pt.return===xt)return;Pt=Pt.return}Pt.sibling.return=Pt.return,Pt=Pt.sibling}else Pt.child.return=Pt,Pt=Pt.child}function Nm(gt){var xt=gt.alternate;xt!==null&&(gt.alternate=null,Nm(xt)),gt.child=null,gt.deletions=null,gt.sibling=null,gt.tag===5&&(xt=gt.stateNode,xt!==null&&_n(xt)),gt.stateNode=null,gt.return=null,gt.dependencies=null,gt.memoizedProps=null,gt.memoizedState=null,gt.pendingProps=null,gt.stateNode=null,gt.updateQueue=null}function Om(gt){return gt.tag===5||gt.tag===3||gt.tag===4}function Vm(gt){e:for(;;){for(;gt.sibling===null;){if(gt.return===null||Om(gt.return))return null;gt=gt.return}for(gt.sibling.return=gt.return,gt=gt.sibling;gt.tag!==5&&gt.tag!==6&&gt.tag!==18;){if(gt.flags&2||gt.child===null||gt.tag===4)continue e;gt.child.return=gt,gt=gt.child}if(!(gt.flags&2))return gt.stateNode}}function zm(gt){if(yn){e:{for(var xt=gt.return;xt!==null;){if(Om(xt))break e;xt=xt.return}throw Error(it(160))}var At=xt;switch(At.tag){case 5:xt=At.stateNode,At.flags&32&&(er(xt),At.flags&=-33),At=Vm(gt),lp(gt,At,xt);break;case 3:case 4:xt=At.stateNode.containerInfo,At=Vm(gt),ap(gt,At,xt);break;default:throw Error(it(161))}}}function ap(gt,xt,At){var Pt=gt.tag;if(Pt===5||Pt===6)gt=gt.stateNode,xt?Fn(At,gt,xt):Sn(At,gt);else if(Pt!==4&&(gt=gt.child,gt!==null))for(ap(gt,xt,At),gt=gt.sibling;gt!==null;)ap(gt,xt,At),gt=gt.sibling}function lp(gt,xt,At){var Pt=gt.tag;if(Pt===5||Pt===6)gt=gt.stateNode,xt?kn(At,gt,xt):pn(At,gt);else if(Pt!==4&&(gt=gt.child,gt!==null))for(lp(gt,xt,At),gt=gt.sibling;gt!==null;)lp(gt,xt,At),gt=gt.sibling}function $m(gt,xt,At){for(var Pt=xt,kt=!1,Ut,rn;;){if(!kt){kt=Pt.return;e:for(;;){if(kt===null)throw Error(it(160));switch(Ut=kt.stateNode,kt.tag){case 5:rn=!1;break e;case 3:Ut=Ut.containerInfo,rn=!0;break e;case 4:Ut=Ut.containerInfo,rn=!0;break e}kt=kt.return}kt=!0}if(Pt.tag===5||Pt.tag===6)Um(gt,Pt,At),rn?Zn(Ut,Pt.stateNode):Nn(Ut,Pt.stateNode);else if(Pt.tag===18)rn?Cn(Ut,Pt.stateNode):Ln(Ut,Pt.stateNode);else if(Pt.tag===4){if(Pt.child!==null){Ut=Pt.stateNode.containerInfo,rn=!0,Pt.child.return=Pt,Pt=Pt.child;continue}}else if(Fm(gt,Pt,At),Pt.child!==null){Pt.child.return=Pt,Pt=Pt.child;continue}if(Pt===xt)break;for(;Pt.sibling===null;){if(Pt.return===null||Pt.return===xt)return;Pt=Pt.return,Pt.tag===4&&(kt=!1)}Pt.sibling.return=Pt.return,Pt=Pt.sibling}}function cp(gt,xt){if(yn){switch(xt.tag){case 0:case 11:case 14:case 15:Do(3,xt,xt.return),Bl(3,xt),Do(5,xt,xt.return);return;case 1:return;case 5:var At=xt.stateNode;if(At!=null){var Pt=xt.memoizedProps;gt=gt!==null?gt.memoizedProps:Pt;var kt=xt.type,Ut=xt.updateQueue;xt.updateQueue=null,Ut!==null&&Mn(At,Ut,kt,gt,Pt,xt)}return;case 6:if(xt.stateNode===null)throw Error(it(162));At=xt.memoizedProps,gn(xt.stateNode,gt!==null?gt.memoizedProps:At,At);return;case 3:fn&&gt!==null&&gt.memoizedState.isDehydrated&&vn(xt.stateNode.containerInfo);return;case 12:return;case 13:xu(xt);return;case 19:xu(xt);return;case 17:return}throw Error(it(163))}switch(xt.tag){case 0:case 11:case 14:case 15:Do(3,xt,xt.return),Bl(3,xt),Do(5,xt,xt.return);return;case 12:return;case 13:xu(xt);return;case 19:xu(xt);return;case 3:fn&&gt!==null&&gt.memoizedState.isDehydrated&&vn(xt.stateNode.containerInfo);break;case 22:case 23:return}e:if(Vt){switch(xt.tag){case 1:case 5:case 6:break e;case 3:case 4:xt=xt.stateNode,jt(xt.containerInfo,xt.pendingChildren);break e}throw Error(it(163))}}function xu(gt){var xt=gt.updateQueue;if(xt!==null){gt.updateQueue=null;var At=gt.stateNode;At===null&&(At=gt.stateNode=new P0),xt.forEach(function(Pt){var kt=z0.bind(null,gt,Pt);At.has(Pt)||(At.add(Pt),Pt.then(kt,kt))})}}function k0(gt,xt){for(tr=xt;tr!==null;){xt=tr;var At=xt.deletions;if(At!==null)for(var Pt=0;Pt<At.length;Pt++){var kt=At[Pt];try{var Ut=gt;yn?$m(Ut,kt,xt):Um(Ut,kt,xt);var rn=kt.alternate;rn!==null&&(rn.return=null),kt.return=null}catch(lr){Es(kt,xt,lr)}}if(At=xt.child,xt.subtreeFlags&12854&&At!==null)At.return=xt,tr=At;else for(;tr!==null;){xt=tr;try{var bn=xt.flags;if(bn&32&&yn&&er(xt.stateNode),bn&512){var On=xt.alternate;if(On!==null){var Xn=On.ref;Xn!==null&&(typeof Xn=="function"?Xn(null):Xn.current=null)}}if(bn&8192)switch(xt.tag){case 13:if(xt.memoizedState!==null){var ir=xt.alternate;(ir===null||ir.memoizedState===null)&&(gp=Or())}break;case 22:var xr=xt.memoizedState!==null,pr=xt.alternate,Br=pr!==null&&pr.memoizedState!==null;if(At=xt,yn){e:if(Pt=At,kt=xr,Ut=null,yn)for(var ur=Pt;;){if(ur.tag===5){if(Ut===null){Ut=ur;var fs=ur.stateNode;kt?dn(fs):Pn(ur.stateNode,ur.memoizedProps)}}else if(ur.tag===6){if(Ut===null){var zs=ur.stateNode;kt?$n(zs):Dn(zs,ur.memoizedProps)}}else if((ur.tag!==22&&ur.tag!==23||ur.memoizedState===null||ur===Pt)&&ur.child!==null){ur.child.return=ur,ur=ur.child;continue}if(ur===Pt)break;for(;ur.sibling===null;){if(ur.return===null||ur.return===Pt)break e;Ut===ur&&(Ut=null),ur=ur.return}Ut===ur&&(Ut=null),ur.sibling.return=ur.return,ur=ur.sibling}}if(xr&&!Br&&At.mode&1){tr=At;for(var Bn=At.child;Bn!==null;){for(At=tr=Bn;tr!==null;){Pt=tr;var An=Pt.child;switch(Pt.tag){case 0:case 11:case 14:case 15:Do(4,Pt,Pt.return);break;case 1:gu(Pt,Pt.return);var Un=Pt.stateNode;if(typeof Un.componentWillUnmount=="function"){var nr=Pt.return;try{Un.props=Pt.memoizedProps,Un.state=Pt.memoizedState,Un.componentWillUnmount()}catch(lr){Es(Pt,nr,lr)}}break;case 5:gu(Pt,Pt.return);break;case 22:if(Pt.memoizedState!==null){Wm(At);continue}}An!==null?(An.return=Pt,tr=An):Wm(At)}Bn=Bn.sibling}}}switch(bn&4102){case 2:zm(xt),xt.flags&=-3;break;case 6:zm(xt),xt.flags&=-3,cp(xt.alternate,xt);break;case 4096:xt.flags&=-4097;break;case 4100:xt.flags&=-4097,cp(xt.alternate,xt);break;case 4:cp(xt.alternate,xt)}}catch(lr){Es(xt,xt.return,lr)}if(At=xt.sibling,At!==null){At.return=xt.return,tr=At;break}tr=xt.return}}}function D0(gt,xt,At){tr=gt,Gm(gt)}function Gm(gt,xt,At){for(var Pt=(gt.mode&1)!==0;tr!==null;){var kt=tr,Ut=kt.child;if(kt.tag===22&&Pt){var rn=kt.memoizedState!==null||mu;if(!rn){var bn=kt.alternate,On=bn!==null&&bn.memoizedState!==null||ko;bn=mu;var Xn=ko;if(mu=rn,(ko=On)&&!Xn)for(tr=kt;tr!==null;)rn=tr,On=rn.child,rn.tag===22&&rn.memoizedState!==null?jm(kt):On!==null?(On.return=rn,tr=On):jm(kt);for(;Ut!==null;)tr=Ut,Gm(Ut),Ut=Ut.sibling;tr=kt,mu=bn,ko=Xn}Hm(gt)}else kt.subtreeFlags&8772&&Ut!==null?(Ut.return=kt,tr=Ut):Hm(gt)}}function Hm(gt){for(;tr!==null;){var xt=tr;if(xt.flags&8772){var At=xt.alternate;try{if(xt.flags&8772)switch(xt.tag){case 0:case 11:case 15:ko||Bl(5,xt);break;case 1:var Pt=xt.stateNode;if(xt.flags&4&&!ko)if(At===null)Pt.componentDidMount();else{var kt=xt.elementType===xt.type?At.memoizedProps:ys(xt.type,At.memoizedProps);Pt.componentDidUpdate(kt,At.memoizedState,Pt.__reactInternalSnapshotBeforeUpdate)}var Ut=xt.updateQueue;Ut!==null&&Np(xt,Ut,Pt);break;case 3:var rn=xt.updateQueue;if(rn!==null){if(At=null,xt.child!==null)switch(xt.child.tag){case 5:At=$t(xt.child.stateNode);break;case 1:At=xt.child.stateNode}Np(xt,rn,At)}break;case 5:var bn=xt.stateNode;At===null&&xt.flags&4&&Rn(bn,xt.type,xt.memoizedProps,xt);break;case 6:break;case 4:break;case 12:break;case 13:if(fn&&xt.memoizedState===null){var On=xt.alternate;if(On!==null){var Xn=On.memoizedState;if(Xn!==null){var ir=Xn.dehydrated;ir!==null&&In(ir)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(it(163))}ko||xt.flags&512&&op(xt)}catch(xr){Es(xt,xt.return,xr)}}if(xt===gt){tr=null;break}if(At=xt.sibling,At!==null){At.return=xt.return,tr=At;break}tr=xt.return}}function Wm(gt){for(;tr!==null;){var xt=tr;if(xt===gt){tr=null;break}var At=xt.sibling;if(At!==null){At.return=xt.return,tr=At;break}tr=xt.return}}function jm(gt){for(;tr!==null;){var xt=tr;try{switch(xt.tag){case 0:case 11:case 15:var At=xt.return;try{Bl(4,xt)}catch(On){Es(xt,At,On)}break;case 1:var Pt=xt.stateNode;if(typeof Pt.componentDidMount=="function"){var kt=xt.return;try{Pt.componentDidMount()}catch(On){Es(xt,kt,On)}}var Ut=xt.return;try{op(xt)}catch(On){Es(xt,Ut,On)}break;case 5:var rn=xt.return;try{op(xt)}catch(On){Es(xt,rn,On)}}}catch(On){Es(xt,xt.return,On)}if(xt===gt){tr=null;break}var bn=xt.sibling;if(bn!==null){bn.return=xt.return,tr=bn;break}tr=xt.return}}var yu=0,vu=1,_u=2,wu=3,Su=4;if(typeof Symbol=="function"&&Symbol.for){var Fl=Symbol.for;yu=Fl("selector.component"),vu=Fl("selector.has_pseudo_class"),_u=Fl("selector.role"),wu=Fl("selector.test_id"),Su=Fl("selector.text")}function up(gt){var xt=ln(gt);if(xt!=null){if(typeof xt.memoizedProps["data-testname"]!="string")throw Error(it(364));return xt}if(gt=Bt(gt),gt===null)throw Error(it(362));return gt.stateNode.current}function hp(gt,xt){switch(xt.$$typeof){case yu:if(gt.type===xt.value)return!0;break;case vu:e:{xt=xt.value,gt=[gt,0];for(var At=0;At<gt.length;){var Pt=gt[At++],kt=gt[At++],Ut=xt[kt];if(Pt.tag!==5||!mn(Pt)){for(;Ut!=null&&hp(Pt,Ut);)kt++,Ut=xt[kt];if(kt===xt.length){xt=!0;break e}else for(Pt=Pt.child;Pt!==null;)gt.push(Pt,kt),Pt=Pt.sibling}}xt=!1}return xt;case _u:if(gt.tag===5&&sn(gt.stateNode,xt.value))return!0;break;case Su:if((gt.tag===5||gt.tag===6)&&(gt=en(gt),gt!==null&&0<=gt.indexOf(xt.value)))return!0;break;case wu:if(gt.tag===5&&(gt=gt.memoizedProps["data-testname"],typeof gt=="string"&&gt.toLowerCase()===xt.value.toLowerCase()))return!0;break;default:throw Error(it(365))}return!1}function fp(gt){switch(gt.$$typeof){case yu:return"<"+(Et(gt.value)||"Unknown")+">";case vu:return":has("+(fp(gt)||"")+")";case _u:return'[role="'+gt.value+'"]';case Su:return'"'+gt.value+'"';case wu:return'[data-testname="'+gt.value+'"]';default:throw Error(it(365))}}function Xm(gt,xt){var At=[];gt=[gt,0];for(var Pt=0;Pt<gt.length;){var kt=gt[Pt++],Ut=gt[Pt++],rn=xt[Ut];if(kt.tag!==5||!mn(kt)){for(;rn!=null&&hp(kt,rn);)Ut++,rn=xt[Ut];if(Ut===xt.length)At.push(kt);else for(kt=kt.child;kt!==null;)gt.push(kt,Ut),kt=kt.sibling}}return At}function dp(gt,xt){if(!Wt)throw Error(it(363));gt=up(gt),gt=Xm(gt,xt),xt=[],gt=Array.from(gt);for(var At=0;At<gt.length;){var Pt=gt[At++];if(Pt.tag===5)mn(Pt)||xt.push(Pt.stateNode);else for(Pt=Pt.child;Pt!==null;)gt.push(Pt),Pt=Pt.sibling}return xt}var L0=Math.ceil,bu=st.ReactCurrentDispatcher,pp=st.ReactCurrentOwner,qr=st.ReactCurrentBatchConfig,_r=0,Kr=null,Zr=null,ls=0,ks=0,Zo=Lr(0),Jr=0,Ul=null,Qo=0,Mu=0,mp=0,Nl=null,bs=null,gp=0,xp=1/0;function Jo(){xp=Or()+500}var Eu=!1,yp=null,mo=null,Tu=!1,go=null,Au=0,Ol=0,vp=null,Cu=-1,Ru=0;function ws(){return _r&6?Or():Cu!==-1?Cu:Cu=Or()}function xo(gt){return gt.mode&1?_r&2&&ls!==0?ls&-ls:To.transition!==null?(Ru===0&&(gt=eo,eo<<=1,!(eo&4194240)&&(eo=64),Ru=gt),Ru):(gt=Sr,gt!==0?gt:on()):1}function Os(gt,xt,At){if(50<Ol)throw Ol=0,vp=null,Error(it(185));var Pt=Pu(gt,xt);return Pt===null?null:(js(Pt,xt,At),(!(_r&2)||Pt!==Kr)&&(Pt===Kr&&(!(_r&2)&&(Mu|=xt),Jr===4&&yo(Pt,ls)),Ms(Pt,At),xt===1&&_r===0&&!(gt.mode&1)&&(Jo(),Ys&&Ss())),Pt)}function Pu(gt,xt){gt.lanes|=xt;var At=gt.alternate;for(At!==null&&(At.lanes|=xt),At=gt,gt=gt.return;gt!==null;)gt.childLanes|=xt,At=gt.alternate,At!==null&&(At.childLanes|=xt),At=gt,gt=gt.return;return At.tag===3?At.stateNode:null}function Ms(gt,xt){var At=gt.callbackNode;ga(gt,xt);var Pt=bo(gt,gt===Kr?ls:0);if(Pt===0)At!==null&&zo(At),gt.callbackNode=null,gt.callbackPriority=0;else if(xt=Pt&-Pt,gt.callbackPriority!==xt){if(At!=null&&zo(At),xt===1)gt.tag===0?_l(qm.bind(null,gt)):yl(qm.bind(null,gt)),cn?tn(function(){_r===0&&Ss()}):io(Mo,Ss),At=null;else{switch(xa(Pt)){case 1:At=Mo;break;case 4:At=Xl;break;case 16:At=gs;break;case 536870912:At=$a;break;default:At=gs}At=i0(At,Ym.bind(null,gt))}gt.callbackPriority=xt,gt.callbackNode=At}}function Ym(gt,xt){if(Cu=-1,Ru=0,_r&6)throw Error(it(327));var At=gt.callbackNode;if(Fo()&&gt.callbackNode!==At)return null;var Pt=bo(gt,gt===Kr?ls:0);if(Pt===0)return null;if(Pt&30||Pt&gt.expiredLanes||xt)xt=Iu(gt,Pt);else{xt=Pt;var kt=_r;_r|=2;var Ut=Qm();(Kr!==gt||ls!==xt)&&(Jo(),Lo(gt,xt));do try{U0();break}catch(bn){Zm(gt,bn)}while(!0);Go(),bu.current=Ut,_r=kt,Zr!==null?xt=0:(Kr=null,ls=0,xt=Jr)}if(xt!==0){if(xt===2&&(kt=ro(gt),kt!==0&&(Pt=kt,xt=_p(gt,kt))),xt===1)throw At=Ul,Lo(gt,0),yo(gt,Pt),Ms(gt,Or()),At;if(xt===6)yo(gt,Pt);else{if(kt=gt.current.alternate,!(Pt&30)&&!B0(kt)&&(xt=Iu(gt,Pt),xt===2&&(Ut=ro(gt),Ut!==0&&(Pt=Ut,xt=_p(gt,Ut))),xt===1))throw At=Ul,Lo(gt,0),yo(gt,Pt),Ms(gt,Or()),At;switch(gt.finishedWork=kt,gt.finishedLanes=Pt,xt){case 0:case 1:throw Error(it(345));case 2:Bo(gt,bs);break;case 3:if(yo(gt,Pt),(Pt&130023424)===Pt&&(xt=gp+500-Or(),10<xt)){if(bo(gt,0)!==0)break;if(kt=gt.suspendedLanes,(kt&Pt)!==Pt){ws(),gt.pingedLanes|=gt.suspendedLanes&kt;break}gt.timeoutHandle=Qt(Bo.bind(null,gt,bs),xt);break}Bo(gt,bs);break;case 4:if(yo(gt,Pt),(Pt&4194240)===Pt)break;for(xt=gt.eventTimes,kt=-1;0<Pt;){var rn=31-ms(Pt);Ut=1<<rn,rn=xt[rn],rn>kt&&(kt=rn),Pt&=~Ut}if(Pt=kt,Pt=Or()-Pt,Pt=(120>Pt?120:480>Pt?480:1080>Pt?1080:1920>Pt?1920:3e3>Pt?3e3:4320>Pt?4320:1960*L0(Pt/1960))-Pt,10<Pt){gt.timeoutHandle=Qt(Bo.bind(null,gt,bs),Pt);break}Bo(gt,bs);break;case 5:Bo(gt,bs);break;default:throw Error(it(329))}}}return Ms(gt,Or()),gt.callbackNode===At?Ym.bind(null,gt):null}function _p(gt,xt){var At=Nl;return gt.current.memoizedState.isDehydrated&&(Lo(gt,xt).flags|=256),gt=Iu(gt,xt),gt!==2&&(xt=bs,bs=At,xt!==null&&wp(xt)),gt}function wp(gt){bs===null?bs=gt:bs.push.apply(bs,gt)}function B0(gt){for(var xt=gt;;){if(xt.flags&16384){var At=xt.updateQueue;if(At!==null&&(At=At.stores,At!==null))for(var Pt=0;Pt<At.length;Pt++){var kt=At[Pt],Ut=kt.getSnapshot;kt=kt.value;try{if(!As(Ut(),kt))return!1}catch{return!1}}}if(At=xt.child,xt.subtreeFlags&16384&&At!==null)At.return=xt,xt=At;else{if(xt===gt)break;for(;xt.sibling===null;){if(xt.return===null||xt.return===gt)return!0;xt=xt.return}xt.sibling.return=xt.return,xt=xt.sibling}}return!0}function yo(gt,xt){for(xt&=~mp,xt&=~Mu,gt.suspendedLanes|=xt,gt.pingedLanes&=~xt,gt=gt.expirationTimes;0<xt;){var At=31-ms(xt),Pt=1<<At;gt[At]=-1,xt&=~Pt}}function qm(gt){if(_r&6)throw Error(it(327));Fo();var xt=bo(gt,0);if(!(xt&1))return Ms(gt,Or()),null;var At=Iu(gt,xt);if(gt.tag!==0&&At===2){var Pt=ro(gt);Pt!==0&&(xt=Pt,At=_p(gt,Pt))}if(At===1)throw At=Ul,Lo(gt,0),yo(gt,xt),Ms(gt,Or()),At;if(At===6)throw Error(it(345));return gt.finishedWork=gt.current.alternate,gt.finishedLanes=xt,Bo(gt,bs),Ms(gt,Or()),null}function Km(gt){go!==null&&go.tag===0&&!(_r&6)&&Fo();var xt=_r;_r|=1;var At=qr.transition,Pt=Sr;try{if(qr.transition=null,Sr=1,gt)return gt()}finally{Sr=Pt,qr.transition=At,_r=xt,!(_r&6)&&Ss()}}function Sp(){ks=Zo.current,or(Zo)}function Lo(gt,xt){gt.finishedWork=null,gt.finishedLanes=0;var At=gt.timeoutHandle;if(At!==wn&&(gt.timeoutHandle=wn,un(At)),Zr!==null)for(At=Zr.return;At!==null;){var Pt=At;switch($u(Pt),Pt.tag){case 1:Pt=Pt.type.childContextTypes,Pt!=null&&Cr();break;case 3:qo(),or(kr),or(mr),qu();break;case 5:Xu(Pt);break;case 4:qo();break;case 13:or(Vr);break;case 19:or(Vr);break;case 10:ts(Pt.type._context);break;case 22:case 23:Sp()}At=At.return}if(Kr=gt,Zr=gt=vo(gt.current,null),ls=ks=xt,Jr=0,Ul=null,mp=Mu=Qo=0,bs=Nl=null,Cs!==null){for(xt=0;xt<Cs.length;xt++)if(At=Cs[xt],Pt=At.interleaved,Pt!==null){At.interleaved=null;var kt=Pt.next,Ut=At.pending;if(Ut!==null){var rn=Ut.next;Ut.next=kt,Pt.next=rn}At.pending=Pt}Cs=null}return gt}function Zm(gt,xt){do{var At=Zr;try{if(Go(),ru.current=cu,iu){for(var Pt=Hr.memoizedState;Pt!==null;){var kt=Pt.queue;kt!==null&&(kt.pending=null),Pt=Pt.next}iu=!1}if(Ko=0,ns=cs=Hr=null,Al=!1,Cl=0,pp.current=null,At===null||At.return===null){Jr=1,Ul=xt,Zr=null;break}e:{var Ut=gt,rn=At.return,bn=At,On=xt;if(xt=ls,bn.flags|=32768,On!==null&&typeof On=="object"&&typeof On.then=="function"){var Xn=On,ir=bn,xr=ir.tag;if(!(ir.mode&1)&&(xr===0||xr===11||xr===15)){var pr=ir.alternate;pr?(ir.updateQueue=pr.updateQueue,ir.memoizedState=pr.memoizedState,ir.lanes=pr.lanes):(ir.updateQueue=null,ir.memoizedState=null)}var Br=ym(rn);if(Br!==null){Br.flags&=-257,vm(Br,rn,bn,Ut,xt),Br.mode&1&&xm(Ut,Xn,xt),xt=Br,On=Xn;var ur=xt.updateQueue;if(ur===null){var fs=new Set;fs.add(On),xt.updateQueue=fs}else ur.add(On);break e}else{if(!(xt&1)){xm(Ut,Xn,xt),bp();break e}On=Error(it(426))}}else if(Nr&&bn.mode&1){var zs=ym(rn);if(zs!==null){!(zs.flags&65536)&&(zs.flags|=256),vm(zs,rn,bn,Ut,xt),Wu(On);break e}}Ut=On,Jr!==4&&(Jr=2),Nl===null?Nl=[Ut]:Nl.push(Ut),On=_d(On,bn),bn=rn;do{switch(bn.tag){case 3:bn.flags|=65536,xt&=-xt,bn.lanes|=xt;var Bn=mm(bn,On,xt);Up(bn,Bn);break e;case 1:Ut=On;var An=bn.type,Un=bn.stateNode;if(!(bn.flags&128)&&(typeof An.getDerivedStateFromError=="function"||Un!==null&&typeof Un.componentDidCatch=="function"&&(mo===null||!mo.has(Un)))){bn.flags|=65536,xt&=-xt,bn.lanes|=xt;var nr=gm(bn,Ut,xt);Up(bn,nr);break e}}bn=bn.return}while(bn!==null)}e0(At)}catch(lr){xt=lr,Zr===At&&At!==null&&(Zr=At=At.return);continue}break}while(!0)}function Qm(){var gt=bu.current;return bu.current=cu,gt===null?cu:gt}function bp(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),Kr===null||!(Qo&268435455)&&!(Mu&268435455)||yo(Kr,ls)}function Iu(gt,xt){var At=_r;_r|=2;var Pt=Qm();Kr===gt&&ls===xt||Lo(gt,xt);do try{F0();break}catch(kt){Zm(gt,kt)}while(!0);if(Go(),_r=At,bu.current=Pt,Zr!==null)throw Error(it(261));return Kr=null,ls=0,Jr}function F0(){for(;Zr!==null;)Jm(Zr)}function U0(){for(;Zr!==null&&!ba();)Jm(Zr)}function Jm(gt){var xt=r0(gt.alternate,gt,ks);gt.memoizedProps=gt.pendingProps,xt===null?e0(gt):Zr=xt,pp.current=null}function e0(gt){var xt=gt;do{var At=xt.alternate;if(gt=xt.return,xt.flags&32768){if(At=R0(At,xt),At!==null){At.flags&=32767,Zr=At;return}if(gt!==null)gt.flags|=32768,gt.subtreeFlags=0,gt.deletions=null;else{Jr=6,Zr=null;return}}else if(At=T0(At,xt,ks),At!==null){Zr=At;return}if(xt=xt.sibling,xt!==null){Zr=xt;return}Zr=xt=gt}while(xt!==null);Jr===0&&(Jr=5)}function Bo(gt,xt){var At=Sr,Pt=qr.transition;try{qr.transition=null,Sr=1,N0(gt,xt,At)}finally{qr.transition=Pt,Sr=At}return null}function N0(gt,xt,At){do Fo();while(go!==null);if(_r&6)throw Error(it(327));var Pt=gt.finishedWork,kt=gt.finishedLanes;if(Pt===null)return null;if(gt.finishedWork=null,gt.finishedLanes=0,Pt===gt.current)throw Error(it(177));gt.callbackNode=null,gt.callbackPriority=0;var Ut=Pt.lanes|Pt.childLanes;if(uo(gt,Ut),gt===Kr&&(Zr=Kr=null,ls=0),!(Pt.subtreeFlags&2064)&&!(Pt.flags&2064)||Tu||(Tu=!0,i0(gs,function(){return Fo(),null})),Ut=(Pt.flags&15990)!==0,Pt.subtreeFlags&15990||Ut){Ut=qr.transition,qr.transition=null;var rn=Sr;Sr=1;var bn=_r;_r|=4,pp.current=null,I0(gt,Pt),k0(gt,Pt),Nt(gt.containerInfo),gt.current=Pt,D0(Pt),Wl(),_r=bn,Sr=rn,qr.transition=Ut}else gt.current=Pt;if(Tu&&(Tu=!1,go=gt,Au=kt),Ut=gt.pendingLanes,Ut===0&&(mo=null),xl(Pt.stateNode),Ms(gt,Or()),xt!==null)for(At=gt.onRecoverableError,Pt=0;Pt<xt.length;Pt++)At(xt[Pt]);if(Eu)throw Eu=!1,gt=yp,yp=null,gt;return Au&1&&gt.tag!==0&&Fo(),Ut=gt.pendingLanes,Ut&1?gt===vp?Ol++:(Ol=0,vp=gt):Ol=0,Ss(),null}function Fo(){if(go!==null){var gt=xa(Au),xt=qr.transition,At=Sr;try{if(qr.transition=null,Sr=16>gt?16:gt,go===null)var Pt=!1;else{if(gt=go,go=null,Au=0,_r&6)throw Error(it(331));var kt=_r;for(_r|=4,tr=gt.current;tr!==null;){var Ut=tr,rn=Ut.child;if(tr.flags&16){var bn=Ut.deletions;if(bn!==null){for(var On=0;On<bn.length;On++){var Xn=bn[On];for(tr=Xn;tr!==null;){var ir=tr;switch(ir.tag){case 0:case 11:case 15:Do(8,ir,Ut)}var xr=ir.child;if(xr!==null)xr.return=ir,tr=xr;else for(;tr!==null;){ir=tr;var pr=ir.sibling,Br=ir.return;if(Nm(ir),ir===Xn){tr=null;break}if(pr!==null){pr.return=Br,tr=pr;break}tr=Br}}}var ur=Ut.alternate;if(ur!==null){var fs=ur.child;if(fs!==null){ur.child=null;do{var zs=fs.sibling;fs.sibling=null,fs=zs}while(fs!==null)}}tr=Ut}}if(Ut.subtreeFlags&2064&&rn!==null)rn.return=Ut,tr=rn;else e:for(;tr!==null;){if(Ut=tr,Ut.flags&2048)switch(Ut.tag){case 0:case 11:case 15:Do(9,Ut,Ut.return)}var Bn=Ut.sibling;if(Bn!==null){Bn.return=Ut.return,tr=Bn;break e}tr=Ut.return}}var An=gt.current;for(tr=An;tr!==null;){rn=tr;var Un=rn.child;if(rn.subtreeFlags&2064&&Un!==null)Un.return=rn,tr=Un;else e:for(rn=An;tr!==null;){if(bn=tr,bn.flags&2048)try{switch(bn.tag){case 0:case 11:case 15:Bl(9,bn)}}catch(lr){Es(bn,bn.return,lr)}if(bn===rn){tr=null;break e}var nr=bn.sibling;if(nr!==null){nr.return=bn.return,tr=nr;break e}tr=bn.return}}if(_r=kt,Ss(),Ts&&typeof Ts.onPostCommitFiberRoot=="function")try{Ts.onPostCommitFiberRoot(Eo,gt)}catch{}Pt=!0}return Pt}finally{Sr=At,qr.transition=xt}}return!1}function t0(gt,xt,At){xt=_d(At,xt),xt=mm(gt,xt,1),po(gt,xt),xt=ws(),gt=Pu(gt,1),gt!==null&&(js(gt,1,xt),Ms(gt,xt))}function Es(gt,xt,At){if(gt.tag===3)t0(gt,gt,At);else for(;xt!==null;){if(xt.tag===3){t0(xt,gt,At);break}else if(xt.tag===1){var Pt=xt.stateNode;if(typeof xt.type.getDerivedStateFromError=="function"||typeof Pt.componentDidCatch=="function"&&(mo===null||!mo.has(Pt))){gt=_d(At,gt),gt=gm(xt,gt,1),po(xt,gt),gt=ws(),xt=Pu(xt,1),xt!==null&&(js(xt,1,gt),Ms(xt,gt));break}}xt=xt.return}}function O0(gt,xt,At){var Pt=gt.pingCache;Pt!==null&&Pt.delete(xt),xt=ws(),gt.pingedLanes|=gt.suspendedLanes&At,Kr===gt&&(ls&At)===At&&(Jr===4||Jr===3&&(ls&130023424)===ls&&500>Or()-gp?Lo(gt,0):mp|=At),Ms(gt,xt)}function n0(gt,xt){xt===0&&(gt.mode&1?(xt=to,to<<=1,!(to&130023424)&&(to=4194304)):xt=1);var At=ws();gt=Pu(gt,xt),gt!==null&&(js(gt,xt,At),Ms(gt,At))}function V0(gt){var xt=gt.memoizedState,At=0;xt!==null&&(At=xt.retryLane),n0(gt,At)}function z0(gt,xt){var At=0;switch(gt.tag){case 13:var Pt=gt.stateNode,kt=gt.memoizedState;kt!==null&&(At=kt.retryLane);break;case 19:Pt=gt.stateNode;break;default:throw Error(it(314))}Pt!==null&&Pt.delete(xt),n0(gt,At)}var r0;r0=function(gt,xt,At){if(gt!==null)if(gt.memoizedProps!==xt.pendingProps||kr.current)Is=!0;else{if(!(gt.lanes&At)&&!(xt.flags&128))return Is=!1,C0(gt,xt,At);Is=!!(gt.flags&131072)}else Is=!1,Nr&&xt.flags&1048576&&Gp(xt,eu,xt.index);switch(xt.lanes=0,xt.tag){case 2:var Pt=xt.type;gt!==null&&(gt.alternate=null,xt.alternate=null,xt.flags|=2),gt=xt.pendingProps;var kt=Fr(xt,mr.current);Xr(xt,At),kt=Zu(null,xt,Pt,gt,kt,At);var Ut=Qu();return xt.flags|=1,typeof kt=="object"&&kt!==null&&typeof kt.render=="function"&&kt.$$typeof===void 0?(xt.tag=1,xt.memoizedState=null,xt.updateQueue=null,Gr(Pt)?(Ut=!0,jr(xt)):Ut=!1,xt.memoizedState=kt.state!==null&&kt.state!==void 0?kt.state:null,Nu(xt),kt.updater=Jl,xt.stateNode=kt,kt._reactInternals=xt,Vu(xt,Pt,gt,At),xt=np(null,xt,Pt,!0,Ut,At)):(xt.tag=0,Nr&&Ut&&zu(xt),_s(null,xt,kt,At),xt=xt.child),xt;case 16:Pt=xt.elementType;e:{switch(gt!==null&&(gt.alternate=null,xt.alternate=null,xt.flags|=2),gt=xt.pendingProps,kt=Pt._init,Pt=kt(Pt._payload),xt.type=Pt,kt=xt.tag=G0(Pt),gt=ys(Pt,gt),kt){case 0:xt=tp(null,xt,Pt,gt,At);break e;case 1:xt=Am(null,xt,Pt,gt,At);break e;case 11:xt=Sm(null,xt,Pt,gt,At);break e;case 14:xt=bm(null,xt,Pt,ys(Pt.type,gt),At);break e}throw Error(it(306,Pt,""))}return xt;case 0:return Pt=xt.type,kt=xt.pendingProps,kt=xt.elementType===Pt?kt:ys(Pt,kt),tp(gt,xt,Pt,kt,At);case 1:return Pt=xt.type,kt=xt.pendingProps,kt=xt.elementType===Pt?kt:ys(Pt,kt),Am(gt,xt,Pt,kt,At);case 3:e:{if(Cm(xt),gt===null)throw Error(it(387));Pt=xt.pendingProps,Ut=xt.memoizedState,kt=Ut.element,Fp(gt,xt),Ql(xt,Pt,null,At);var rn=xt.memoizedState;if(Pt=rn.element,fn&&Ut.isDehydrated)if(Ut={element:Pt,isDehydrated:!1,cache:rn.cache,transitions:rn.transitions},xt.updateQueue.baseState=Ut,xt.memoizedState=Ut,xt.flags&256){kt=Error(it(423)),xt=Rm(gt,xt,Pt,At,kt);break e}else if(Pt!==kt){kt=Error(it(424)),xt=Rm(gt,xt,Pt,At,kt);break e}else for(fn&&(Ps=wr(xt.stateNode.containerInfo),Rs=xt,Nr=!0,Gs=null,wl=!1),At=qp(xt,null,Pt,At),xt.child=At;At;)At.flags=At.flags&-3|4096,At=At.sibling;else{if(jo(),Pt===kt){xt=co(gt,xt,At);break e}_s(gt,xt,Pt,At)}xt=xt.child}return xt;case 5:return Kp(xt),gt===null&&Hu(xt),Pt=xt.type,kt=xt.pendingProps,Ut=gt!==null?gt.memoizedProps:null,rn=kt.children,Xt(Pt,kt)?rn=null:Ut!==null&&Xt(Pt,Ut)&&(xt.flags|=32),Tm(gt,xt),_s(gt,xt,rn,At),xt.child;case 6:return gt===null&&Hu(xt),null;case 13:return Pm(gt,xt,At);case 4:return ju(xt,xt.stateNode.containerInfo),Pt=xt.pendingProps,gt===null?xt.child=Xo(xt,null,Pt,At):_s(gt,xt,Pt,At),xt.child;case 11:return Pt=xt.type,kt=xt.pendingProps,kt=xt.elementType===Pt?kt:ys(Pt,kt),Sm(gt,xt,Pt,kt,At);case 7:return _s(gt,xt,xt.pendingProps,At),xt.child;case 8:return _s(gt,xt,xt.pendingProps.children,At),xt.child;case 12:return _s(gt,xt,xt.pendingProps.children,At),xt.child;case 10:e:{if(Pt=xt.type._context,kt=xt.pendingProps,Ut=xt.memoizedProps,rn=kt.value,Kl(xt,Pt,rn),Ut!==null)if(As(Ut.value,rn)){if(Ut.children===kt.children&&!kr.current){xt=co(gt,xt,At);break e}}else for(Ut=xt.child,Ut!==null&&(Ut.return=xt);Ut!==null;){var bn=Ut.dependencies;if(bn!==null){rn=Ut.child;for(var On=bn.firstContext;On!==null;){if(On.context===Pt){if(Ut.tag===1){On=so(-1,At&-At),On.tag=2;var Xn=Ut.updateQueue;if(Xn!==null){Xn=Xn.shared;var ir=Xn.pending;ir===null?On.next=On:(On.next=ir.next,ir.next=On),Xn.pending=On}}Ut.lanes|=At,On=Ut.alternate,On!==null&&(On.lanes|=At),vs(Ut.return,At,xt),bn.lanes|=At;break}On=On.next}}else if(Ut.tag===10)rn=Ut.type===xt.type?null:Ut.child;else if(Ut.tag===18){if(rn=Ut.return,rn===null)throw Error(it(341));rn.lanes|=At,bn=rn.alternate,bn!==null&&(bn.lanes|=At),vs(rn,At,xt),rn=Ut.sibling}else rn=Ut.child;if(rn!==null)rn.return=Ut;else for(rn=Ut;rn!==null;){if(rn===xt){rn=null;break}if(Ut=rn.sibling,Ut!==null){Ut.return=rn.return,rn=Ut;break}rn=rn.return}Ut=rn}_s(gt,xt,kt.children,At),xt=xt.child}return xt;case 9:return kt=xt.type,Pt=xt.pendingProps.children,Xr(xt,At),kt=Yr(kt),Pt=Pt(kt),xt.flags|=1,_s(gt,xt,Pt,At),xt.child;case 14:return Pt=xt.type,kt=ys(Pt,xt.pendingProps),kt=ys(Pt.type,kt),bm(gt,xt,Pt,kt,At);case 15:return Mm(gt,xt,xt.type,xt.pendingProps,At);case 17:return Pt=xt.type,kt=xt.pendingProps,kt=xt.elementType===Pt?kt:ys(Pt,kt),gt!==null&&(gt.alternate=null,xt.alternate=null,xt.flags|=2),xt.tag=1,Gr(Pt)?(gt=!0,jr(xt)):gt=!1,Xr(xt,At),zp(xt,Pt,kt),Vu(xt,Pt,kt,At),np(null,xt,Pt,!0,gt,At);case 19:return Lm(gt,xt,At);case 22:return Em(gt,xt,At)}throw Error(it(156,xt.tag))};function i0(gt,xt){return io(gt,xt)}function $0(gt,xt,At,Pt){this.tag=gt,this.key=At,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=xt,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Pt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vs(gt,xt,At,Pt){return new $0(gt,xt,At,Pt)}function Mp(gt){return gt=gt.prototype,!(!gt||!gt.isReactComponent)}function G0(gt){if(typeof gt=="function")return Mp(gt)?1:0;if(gt!=null){if(gt=gt.$$typeof,gt===dt)return 11;if(gt===vt)return 14}return 2}function vo(gt,xt){var At=gt.alternate;return At===null?(At=Vs(gt.tag,xt,gt.key,gt.mode),At.elementType=gt.elementType,At.type=gt.type,At.stateNode=gt.stateNode,At.alternate=gt,gt.alternate=At):(At.pendingProps=xt,At.type=gt.type,At.flags=0,At.subtreeFlags=0,At.deletions=null),At.flags=gt.flags&14680064,At.childLanes=gt.childLanes,At.lanes=gt.lanes,At.child=gt.child,At.memoizedProps=gt.memoizedProps,At.memoizedState=gt.memoizedState,At.updateQueue=gt.updateQueue,xt=gt.dependencies,At.dependencies=xt===null?null:{lanes:xt.lanes,firstContext:xt.firstContext},At.sibling=gt.sibling,At.index=gt.index,At.ref=gt.ref,At}function ku(gt,xt,At,Pt,kt,Ut){var rn=2;if(Pt=gt,typeof gt=="function")Mp(gt)&&(rn=1);else if(typeof gt=="string")rn=5;else e:switch(gt){case lt:return Uo(At.children,kt,Ut,xt);case ct:rn=8,kt|=8;break;case ht:return gt=Vs(12,At,xt,kt|2),gt.elementType=ht,gt.lanes=Ut,gt;case pt:return gt=Vs(13,At,xt,kt),gt.elementType=pt,gt.lanes=Ut,gt;case mt:return gt=Vs(19,At,xt,kt),gt.elementType=mt,gt.lanes=Ut,gt;case _t:return Du(At,kt,Ut,xt);default:if(typeof gt=="object"&&gt!==null)switch(gt.$$typeof){case ut:rn=10;break e;case ft:rn=9;break e;case dt:rn=11;break e;case vt:rn=14;break e;case yt:rn=16,Pt=null;break e}throw Error(it(130,gt==null?gt:typeof gt,""))}return xt=Vs(rn,At,xt,kt),xt.elementType=gt,xt.type=Pt,xt.lanes=Ut,xt}function Uo(gt,xt,At,Pt){return gt=Vs(7,gt,Pt,xt),gt.lanes=At,gt}function Du(gt,xt,At,Pt){return gt=Vs(22,gt,Pt,xt),gt.elementType=_t,gt.lanes=At,gt.stateNode={},gt}function Ep(gt,xt,At){return gt=Vs(6,gt,null,xt),gt.lanes=At,gt}function Tp(gt,xt,At){return xt=Vs(4,gt.children!==null?gt.children:[],gt.key,xt),xt.lanes=At,xt.stateNode={containerInfo:gt.containerInfo,pendingChildren:null,implementation:gt.implementation},xt}function H0(gt,xt,At,Pt,kt){this.tag=xt,this.containerInfo=gt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=wn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vo(0),this.expirationTimes=Vo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vo(0),this.identifierPrefix=Pt,this.onRecoverableError=kt,fn&&(this.mutableSourceEagerHydrationData=null)}function s0(gt,xt,At,Pt,kt,Ut,rn,bn,On){return gt=new H0(gt,xt,At,bn,On),xt===1?(xt=1,Ut===!0&&(xt|=8)):xt=0,Ut=Vs(3,null,null,xt),gt.current=Ut,Ut.stateNode=gt,Ut.memoizedState={element:Pt,isDehydrated:At,cache:null,transitions:null},Nu(Ut),gt}function o0(gt){if(!gt)return Ir;gt=gt._reactInternals;e:{if(Tt(gt)!==gt||gt.tag!==1)throw Error(it(170));var xt=gt;do{switch(xt.tag){case 3:xt=xt.stateNode.context;break e;case 1:if(Gr(xt.type)){xt=xt.stateNode.__reactInternalMemoizedMergedChildContext;break e}}xt=xt.return}while(xt!==null);throw Error(it(171))}if(gt.tag===1){var At=gt.type;if(Gr(At))return Ws(gt,At,xt)}return xt}function a0(gt){var xt=gt._reactInternals;if(xt===void 0)throw typeof gt.render=="function"?Error(it(188)):(gt=Object.keys(gt).join(","),Error(it(268,gt)));return gt=Rt(xt),gt===null?null:gt.stateNode}function l0(gt,xt){if(gt=gt.memoizedState,gt!==null&&gt.dehydrated!==null){var At=gt.retryLane;gt.retryLane=At!==0&&At<xt?At:xt}}function Ap(gt,xt){l0(gt,xt),(gt=gt.alternate)&&l0(gt,xt)}function W0(gt){return gt=Rt(gt),gt===null?null:gt.stateNode}function j0(){return null}return _e.attemptContinuousHydration=function(gt){if(gt.tag===13){var xt=ws();Os(gt,134217728,xt),Ap(gt,134217728)}},_e.attemptHydrationAtCurrentPriority=function(gt){if(gt.tag===13){var xt=ws(),At=xo(gt);Os(gt,At,xt),Ap(gt,At)}},_e.attemptSynchronousHydration=function(gt){switch(gt.tag){case 3:var xt=gt.stateNode;if(xt.current.memoizedState.isDehydrated){var At=no(xt.pendingLanes);At!==0&&(Xs(xt,At|1),Ms(xt,Or()),!(_r&6)&&(Jo(),Ss()))}break;case 13:var Pt=ws();Km(function(){return Os(gt,1,Pt)}),Ap(gt,1)}},_e.batchedUpdates=function(gt,xt){var At=_r;_r|=1;try{return gt(xt)}finally{_r=At,_r===0&&(Jo(),Ys&&Ss())}},_e.createComponentSelector=function(gt){return{$$typeof:yu,value:gt}},_e.createContainer=function(gt,xt,At,Pt,kt,Ut,rn){return s0(gt,xt,!1,null,At,Pt,kt,Ut,rn)},_e.createHasPseudoClassSelector=function(gt){return{$$typeof:vu,value:gt}},_e.createHydrationContainer=function(gt,xt,At,Pt,kt,Ut,rn,bn,On){return gt=s0(At,Pt,!0,gt,kt,Ut,rn,bn,On),gt.context=o0(null),At=gt.current,Pt=ws(),kt=xo(At),Ut=so(Pt,kt),Ut.callback=xt??null,po(At,Ut),gt.current.lanes=kt,js(gt,kt,Pt),Ms(gt,Pt),gt},_e.createPortal=function(gt,xt,At){var Pt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:at,key:Pt==null?null:""+Pt,children:gt,containerInfo:xt,implementation:At}},_e.createRoleSelector=function(gt){return{$$typeof:_u,value:gt}},_e.createTestNameSelector=function(gt){return{$$typeof:wu,value:gt}},_e.createTextSelector=function(gt){return{$$typeof:Su,value:gt}},_e.deferredUpdates=function(gt){var xt=Sr,At=qr.transition;try{return qr.transition=null,Sr=16,gt()}finally{Sr=xt,qr.transition=At}},_e.discreteUpdates=function(gt,xt,At,Pt,kt){var Ut=Sr,rn=qr.transition;try{return qr.transition=null,Sr=1,gt(xt,At,Pt,kt)}finally{Sr=Ut,qr.transition=rn,_r===0&&Jo()}},_e.findAllNodes=dp,_e.findBoundingRects=function(gt,xt){if(!Wt)throw Error(it(363));xt=dp(gt,xt),gt=[];for(var At=0;At<xt.length;At++)gt.push(nn(xt[At]));for(xt=gt.length-1;0<xt;xt--){At=gt[xt];for(var Pt=At.x,kt=Pt+At.width,Ut=At.y,rn=Ut+At.height,bn=xt-1;0<=bn;bn--)if(xt!==bn){var On=gt[bn],Xn=On.x,ir=Xn+On.width,xr=On.y,pr=xr+On.height;if(Pt>=Xn&&Ut>=xr&&kt<=ir&&rn<=pr){gt.splice(xt,1);break}else if(Pt!==Xn||At.width!==On.width||pr<Ut||xr>rn){if(!(Ut!==xr||At.height!==On.height||ir<Pt||Xn>kt)){Xn>Pt&&(On.width+=Xn-Pt,On.x=Pt),ir<kt&&(On.width=kt-Xn),gt.splice(xt,1);break}}else{xr>Ut&&(On.height+=xr-Ut,On.y=Ut),pr<rn&&(On.height=rn-xr),gt.splice(xt,1);break}}}return gt},_e.findHostInstance=a0,_e.findHostInstanceWithNoPortals=function(gt){return gt=Ct(gt),gt=gt!==null?Dt(gt):null,gt===null?null:gt.stateNode},_e.findHostInstanceWithWarning=function(gt){return a0(gt)},_e.flushControlled=function(gt){var xt=_r;_r|=1;var At=qr.transition,Pt=Sr;try{qr.transition=null,Sr=1,gt()}finally{Sr=Pt,qr.transition=At,_r=xt,_r===0&&(Jo(),Ss())}},_e.flushPassiveEffects=Fo,_e.flushSync=Km,_e.focusWithin=function(gt,xt){if(!Wt)throw Error(it(363));for(gt=up(gt),xt=Xm(gt,xt),xt=Array.from(xt),gt=0;gt<xt.length;){var At=xt[gt++];if(!mn(At)){if(At.tag===5&&xn(At.stateNode))return!0;for(At=At.child;At!==null;)xt.push(At),At=At.sibling}}return!1},_e.getCurrentUpdatePriority=function(){return Sr},_e.getFindAllNodesFailureDescription=function(gt,xt){if(!Wt)throw Error(it(363));var At=0,Pt=[];gt=[up(gt),0];for(var kt=0;kt<gt.length;){var Ut=gt[kt++],rn=gt[kt++],bn=xt[rn];if((Ut.tag!==5||!mn(Ut))&&(hp(Ut,bn)&&(Pt.push(fp(bn)),rn++,rn>At&&(At=rn)),rn<xt.length))for(Ut=Ut.child;Ut!==null;)gt.push(Ut,rn),Ut=Ut.sibling}if(At<xt.length){for(gt=[];At<xt.length;At++)gt.push(fp(xt[At]));return`findAllNodes was able to match part of the selector:
  `+(Pt.join(" > ")+`

No matching component was found for:
  `)+gt.join(" > ")}return null},_e.getPublicRootInstance=function(gt){if(gt=gt.current,!gt.child)return null;switch(gt.child.tag){case 5:return $t(gt.child.stateNode);default:return gt.child.stateNode}},_e.injectIntoDevTools=function(gt){if(gt={bundleType:gt.bundleType,version:gt.version,rendererPackageName:gt.rendererPackageName,rendererConfig:gt.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:st.ReactCurrentDispatcher,findHostInstanceByFiber:W0,findFiberByHostInstance:gt.findFiberByHostInstance||j0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")gt=!1;else{var xt=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(xt.isDisabled||!xt.supportsFiber)gt=!0;else{try{Eo=xt.inject(gt),Ts=xt}catch{}gt=!!xt.checkDCE}}return gt},_e.isAlreadyRendering=function(){return!1},_e.observeVisibleRects=function(gt,xt,At,Pt){if(!Wt)throw Error(it(363));gt=dp(gt,xt);var kt=an(gt,At,Pt).disconnect;return{disconnect:function(){kt()}}},_e.registerMutableSourceForHydration=function(gt,xt){var At=xt._getVersion;At=At(xt._source),gt.mutableSourceEagerHydrationData==null?gt.mutableSourceEagerHydrationData=[xt,At]:gt.mutableSourceEagerHydrationData.push(xt,At)},_e.runWithPriority=function(gt,xt){var At=Sr;try{return Sr=gt,xt()}finally{Sr=At}},_e.shouldError=function(){return null},_e.shouldSuspend=function(){return!1},_e.updateContainer=function(gt,xt,At,Pt){var kt=xt.current,Ut=ws(),rn=xo(kt);return At=o0(At),xt.context===null?xt.context=At:xt.pendingContext=At,xt=so(Ut,rn),xt.payload={element:gt},Pt=Pt===void 0?null:Pt,Pt!==null&&(xt.callback=Pt),po(kt,xt),gt=Os(kt,rn,Ut),gt!==null&&Zl(gt,kt,rn),rn},_e};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs(reactReconcilerExports);var scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(et){function _(Lt,Ot){var Nt=Lt.length;Lt.push(Ot);e:for(;0<Nt;){var zt=Nt-1>>>1,Ht=Lt[zt];if(0<nt(Ht,Ot))Lt[zt]=Ot,Lt[Nt]=Ht,Nt=zt;else break e}}function _e(Lt){return Lt.length===0?null:Lt[0]}function tt(Lt){if(Lt.length===0)return null;var Ot=Lt[0],Nt=Lt.pop();if(Nt!==Ot){Lt[0]=Nt;e:for(var zt=0,Ht=Lt.length,qt=Ht>>>1;zt<qt;){var Gt=2*(zt+1)-1,Xt=Lt[Gt],Zt=Gt+1,Qt=Lt[Zt];if(0>nt(Xt,Nt))Zt<Ht&&0>nt(Qt,Xt)?(Lt[zt]=Qt,Lt[Zt]=Nt,zt=Zt):(Lt[zt]=Xt,Lt[Gt]=Nt,zt=Gt);else if(Zt<Ht&&0>nt(Qt,Nt))Lt[zt]=Qt,Lt[Zt]=Nt,zt=Zt;else break e}}return Ot}function nt(Lt,Ot){var Nt=Lt.sortIndex-Ot.sortIndex;return Nt!==0?Nt:Lt.id-Ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var rt=performance;et.unstable_now=function(){return rt.now()}}else{var it=Date,st=it.now();et.unstable_now=function(){return it.now()-st}}var ot=[],at=[],lt=1,ct=null,ht=3,ut=!1,ft=!1,dt=!1,pt=typeof setTimeout=="function"?setTimeout:null,mt=typeof clearTimeout=="function"?clearTimeout:null,vt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(Lt){for(var Ot=_e(at);Ot!==null;){if(Ot.callback===null)tt(at);else if(Ot.startTime<=Lt)tt(at),Ot.sortIndex=Ot.expirationTime,_(ot,Ot);else break;Ot=_e(at)}}function _t(Lt){if(dt=!1,yt(Lt),!ft)if(_e(ot)!==null)ft=!0,$t(St);else{var Ot=_e(at);Ot!==null&&Yt(_t,Ot.startTime-Lt)}}function St(Lt,Ot){ft=!1,dt&&(dt=!1,mt(Mt),Mt=-1),ut=!0;var Nt=ht;try{for(yt(Ot),ct=_e(ot);ct!==null&&(!(ct.expirationTime>Ot)||Lt&&!Ct());){var zt=ct.callback;if(typeof zt=="function"){ct.callback=null,ht=ct.priorityLevel;var Ht=zt(ct.expirationTime<=Ot);Ot=et.unstable_now(),typeof Ht=="function"?ct.callback=Ht:ct===_e(ot)&&tt(ot),yt(Ot)}else tt(ot);ct=_e(ot)}if(ct!==null)var qt=!0;else{var Gt=_e(at);Gt!==null&&Yt(_t,Gt.startTime-Ot),qt=!1}return qt}finally{ct=null,ht=Nt,ut=!1}}var bt=!1,Et=null,Mt=-1,Tt=5,wt=-1;function Ct(){return!(et.unstable_now()-wt<Tt)}function Rt(){if(Et!==null){var Lt=et.unstable_now();wt=Lt;var Ot=!0;try{Ot=Et(!0,Lt)}finally{Ot?It():(bt=!1,Et=null)}}else bt=!1}var It;if(typeof vt=="function")It=function(){vt(Rt)};else if(typeof MessageChannel<"u"){var Dt=new MessageChannel,Ft=Dt.port2;Dt.port1.onmessage=Rt,It=function(){Ft.postMessage(null)}}else It=function(){pt(Rt,0)};function $t(Lt){Et=Lt,bt||(bt=!0,It())}function Yt(Lt,Ot){Mt=pt(function(){Lt(et.unstable_now())},Ot)}et.unstable_IdlePriority=5,et.unstable_ImmediatePriority=1,et.unstable_LowPriority=4,et.unstable_NormalPriority=3,et.unstable_Profiling=null,et.unstable_UserBlockingPriority=2,et.unstable_cancelCallback=function(Lt){Lt.callback=null},et.unstable_continueExecution=function(){ft||ut||(ft=!0,$t(St))},et.unstable_forceFrameRate=function(Lt){0>Lt||125<Lt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Tt=0<Lt?Math.floor(1e3/Lt):5},et.unstable_getCurrentPriorityLevel=function(){return ht},et.unstable_getFirstCallbackNode=function(){return _e(ot)},et.unstable_next=function(Lt){switch(ht){case 1:case 2:case 3:var Ot=3;break;default:Ot=ht}var Nt=ht;ht=Ot;try{return Lt()}finally{ht=Nt}},et.unstable_pauseExecution=function(){},et.unstable_requestPaint=function(){},et.unstable_runWithPriority=function(Lt,Ot){switch(Lt){case 1:case 2:case 3:case 4:case 5:break;default:Lt=3}var Nt=ht;ht=Lt;try{return Ot()}finally{ht=Nt}},et.unstable_scheduleCallback=function(Lt,Ot,Nt){var zt=et.unstable_now();switch(typeof Nt=="object"&&Nt!==null?(Nt=Nt.delay,Nt=typeof Nt=="number"&&0<Nt?zt+Nt:zt):Nt=zt,Lt){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=Nt+Ht,Lt={id:lt++,callback:Ot,priorityLevel:Lt,startTime:Nt,expirationTime:Ht,sortIndex:-1},Nt>zt?(Lt.sortIndex=Nt,_(at,Lt),_e(ot)===null&&Lt===_e(at)&&(dt?(mt(Mt),Mt=-1):dt=!0,Yt(_t,Nt-zt))):(Lt.sortIndex=Ht,_(ot,Lt),ft||ut||(ft=!0,$t(St))),Lt},et.unstable_shouldYield=Ct,et.unstable_wrapCallback=function(Lt){var Ot=ht;return function(){var Nt=ht;ht=Ot;try{return Lt.apply(this,arguments)}finally{ht=Nt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;const catalogue={},extend$3=et=>void Object.assign(catalogue,et);function createRenderer(et,_){function _e(lt,{args:ct=[],attach:ht,...ut},ft){let dt=`${lt[0].toUpperCase()}${lt.slice(1)}`,pt;if(lt==="primitive"){if(ut.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const mt=ut.object;pt=prepare(mt,{type:lt,root:ft,attach:ht,primitive:!0})}else{const mt=catalogue[dt];if(!mt)throw new Error(`R3F: ${dt} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(ct))throw new Error("R3F: The args prop must be an array!");pt=prepare(new mt(...ct),{type:lt,root:ft,attach:ht,memoizedProps:{args:ct}})}return pt.__r3f.attach===void 0&&(pt instanceof BufferGeometry?pt.__r3f.attach="geometry":pt instanceof Material&&(pt.__r3f.attach="material")),dt!=="inject"&&applyProps$1(pt,ut),pt}function tt(lt,ct){let ht=!1;if(ct){var ut,ft;(ut=ct.__r3f)!=null&&ut.attach?attach(lt,ct,ct.__r3f.attach):ct.isObject3D&&lt.isObject3D&&(lt.add(ct),ht=!0),ht||(ft=lt.__r3f)==null||ft.objects.push(ct),ct.__r3f||prepare(ct,{}),ct.__r3f.parent=lt,updateInstance(ct),invalidateInstance(ct)}}function nt(lt,ct,ht){let ut=!1;if(ct){var ft,dt;if((ft=ct.__r3f)!=null&&ft.attach)attach(lt,ct,ct.__r3f.attach);else if(ct.isObject3D&&lt.isObject3D){ct.parent=lt,ct.dispatchEvent({type:"added"}),lt.dispatchEvent({type:"childadded",child:ct});const pt=lt.children.filter(vt=>vt!==ct),mt=pt.indexOf(ht);lt.children=[...pt.slice(0,mt),ct,...pt.slice(mt)],ut=!0}ut||(dt=lt.__r3f)==null||dt.objects.push(ct),ct.__r3f||prepare(ct,{}),ct.__r3f.parent=lt,updateInstance(ct),invalidateInstance(ct)}}function rt(lt,ct,ht=!1){lt&&[...lt].forEach(ut=>it(ct,ut,ht))}function it(lt,ct,ht){if(ct){var ut,ft,dt;if(ct.__r3f&&(ct.__r3f.parent=null),(ut=lt.__r3f)!=null&&ut.objects&&(lt.__r3f.objects=lt.__r3f.objects.filter(_t=>_t!==ct)),(ft=ct.__r3f)!=null&&ft.attach)detach(lt,ct,ct.__r3f.attach);else if(ct.isObject3D&&lt.isObject3D){var pt;lt.remove(ct),(pt=ct.__r3f)!=null&&pt.root&&removeInteractivity(findInitialRoot(ct),ct)}const vt=(dt=ct.__r3f)==null?void 0:dt.primitive,yt=!vt&&(ht===void 0?ct.dispose!==null:ht);if(!vt){var mt;rt((mt=ct.__r3f)==null?void 0:mt.objects,ct,yt),rt(ct.children,ct,yt)}if(delete ct.__r3f,yt&&ct.dispose&&ct.type!=="Scene"){const _t=()=>{try{ct.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,_t):_t()}invalidateInstance(lt)}}function st(lt,ct,ht,ut){var ft;const dt=(ft=lt.__r3f)==null?void 0:ft.parent;if(!dt)return;const pt=_e(ct,ht,lt.__r3f.root);if(lt.children){for(const mt of lt.children)mt.__r3f&&tt(pt,mt);lt.children=lt.children.filter(mt=>!mt.__r3f)}lt.__r3f.objects.forEach(mt=>tt(pt,mt)),lt.__r3f.objects=[],lt.__r3f.autoRemovedBeforeAppend||it(dt,lt),pt.parent&&(pt.__r3f.autoRemovedBeforeAppend=!0),tt(dt,pt),pt.raycast&&pt.__r3f.eventCount&&findInitialRoot(pt).getState().internal.interaction.push(pt),[ut,ut.alternate].forEach(mt=>{mt!==null&&(mt.stateNode=pt,mt.ref&&(typeof mt.ref=="function"?mt.ref(pt):mt.ref.current=pt))})}const ot=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Reconciler({createInstance:_e,removeChild:it,appendChild:tt,appendInitialChild:tt,insertBefore:nt,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(lt,ct)=>{if(!ct)return;const ht=lt.getState().scene;ht.__r3f&&(ht.__r3f.root=lt,tt(ht,ct))},removeChildFromContainer:(lt,ct)=>{ct&&it(lt.getState().scene,ct)},insertInContainerBefore:(lt,ct,ht)=>{if(!ct||!ht)return;const ut=lt.getState().scene;ut.__r3f&&nt(ut,ct,ht)},getRootHostContext:()=>null,getChildHostContext:lt=>lt,finalizeInitialChildren(lt){var ct;return!!((ct=lt==null?void 0:lt.__r3f)!=null?ct:{}).handlers},prepareUpdate(lt,ct,ht,ut){var ft;if(((ft=lt==null?void 0:lt.__r3f)!=null?ft:{}).primitive&&ut.object&&ut.object!==lt)return[!0];{const{args:pt=[],children:mt,...vt}=ut,{args:yt=[],children:_t,...St}=ht;if(!Array.isArray(pt))throw new Error("R3F: the args prop must be an array!");if(pt.some((Et,Mt)=>Et!==yt[Mt]))return[!0];const bt=diffProps(lt,vt,St,!0);return bt.changes.length?[!1,bt]:null}},commitUpdate(lt,[ct,ht],ut,ft,dt,pt){ct?st(lt,ut,dt,pt):applyProps$1(lt,ht)},commitMount(lt,ct,ht,ut){var ft;const dt=(ft=lt.__r3f)!=null?ft:{};lt.raycast&&dt.handlers&&dt.eventCount&&findInitialRoot(lt).getState().internal.interaction.push(lt)},getPublicInstance:lt=>lt,prepareForCommit:()=>null,preparePortalMount:lt=>prepare(lt.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(lt){var ct;const{attach:ht,parent:ut}=(ct=lt.__r3f)!=null?ct:{};ht&&ut&&detach(ut,lt,ht),lt.isObject3D&&(lt.visible=!1),invalidateInstance(lt)},unhideInstance(lt,ct){var ht;const{attach:ut,parent:ft}=(ht=lt.__r3f)!=null?ht:{};ut&&ft&&attach(ft,lt,ut),(lt.isObject3D&&ct.visible==null||ct.visible)&&(lt.visible=!0),invalidateInstance(lt)},createTextInstance:ot,hideTextInstance:ot,unhideTextInstance:ot,getCurrentEventPriority:()=>_?_():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const hasColorSpace=et=>"colorSpace"in et||"outputColorSpace"in et,getColorManagement=()=>{var et;return(et=catalogue.ColorManagement)!=null?et:null},isOrthographicCamera=et=>et&&et.isOrthographicCamera,isRef=et=>et&&et.hasOwnProperty("current"),useIsomorphicLayoutEffect=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(et){const _=reactExports.useRef(et);return useIsomorphicLayoutEffect(()=>void(_.current=et),[et]),_}function Block({set:et}){return useIsomorphicLayoutEffect(()=>(et(new Promise(()=>null)),()=>et(!1)),[et]),null}class ErrorBoundary extends reactExports.Component{constructor(..._){super(..._),this.state={error:!1}}componentDidCatch(_){this.props.set(_)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=et=>et&&!!et.memoized&&!!et.changes;function calculateDpr(et){var _;const _e=typeof window<"u"?(_=window.devicePixelRatio)!=null?_:2:1;return Array.isArray(et)?Math.min(Math.max(et[0],_e),et[1]):et}const getRootState=et=>{var _;return(_=et.__r3f)==null?void 0:_.root.getState()};function findInitialRoot(et){let _=et.__r3f.root;for(;_.getState().previousRoot;)_=_.getState().previousRoot;return _}const is={obj:et=>et===Object(et)&&!is.arr(et)&&typeof et!="function",fun:et=>typeof et=="function",str:et=>typeof et=="string",num:et=>typeof et=="number",boo:et=>typeof et=="boolean",und:et=>et===void 0,arr:et=>Array.isArray(et),equ(et,_,{arrays:_e="shallow",objects:tt="reference",strict:nt=!0}={}){if(typeof et!=typeof _||!!et!=!!_)return!1;if(is.str(et)||is.num(et)||is.boo(et))return et===_;const rt=is.obj(et);if(rt&&tt==="reference")return et===_;const it=is.arr(et);if(it&&_e==="reference")return et===_;if((it||rt)&&et===_)return!0;let st;for(st in et)if(!(st in _))return!1;if(rt&&_e==="shallow"&&tt==="shallow"){for(st in nt?_:et)if(!is.equ(et[st],_[st],{strict:nt,objects:"reference"}))return!1}else for(st in nt?_:et)if(et[st]!==_[st])return!1;if(is.und(st)){if(it&&et.length===0&&_.length===0||rt&&Object.keys(et).length===0&&Object.keys(_).length===0)return!0;if(et!==_)return!1}return!0}};function dispose(et){et.dispose&&et.type!=="Scene"&&et.dispose();for(const _ in et)_.dispose==null||_.dispose(),delete et[_]}function prepare(et,_){const _e=et;return _e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._},et}function resolve(et,_){let _e=et;if(_.includes("-")){const tt=_.split("-"),nt=tt.pop();return _e=tt.reduce((rt,it)=>rt[it],et),{target:_e,key:nt}}else return{target:_e,key:_}}const INDEX_REGEX=/-\d+$/;function attach(et,_,_e){if(is.str(_e)){if(INDEX_REGEX.test(_e)){const rt=_e.replace(INDEX_REGEX,""),{target:it,key:st}=resolve(et,rt);Array.isArray(it[st])||(it[st]=[])}const{target:tt,key:nt}=resolve(et,_e);_.__r3f.previousAttach=tt[nt],tt[nt]=_}else _.__r3f.previousAttach=_e(et,_)}function detach(et,_,_e){var tt,nt;if(is.str(_e)){const{target:rt,key:it}=resolve(et,_e),st=_.__r3f.previousAttach;st===void 0?delete rt[it]:rt[it]=st}else(tt=_.__r3f)==null||tt.previousAttach==null||tt.previousAttach(et,_);(nt=_.__r3f)==null||delete nt.previousAttach}function diffProps(et,{children:_,key:_e,ref:tt,...nt},{children:rt,key:it,ref:st,...ot}={},at=!1){const lt=et.__r3f,ct=Object.entries(nt),ht=[];if(at){const ft=Object.keys(ot);for(let dt=0;dt<ft.length;dt++)nt.hasOwnProperty(ft[dt])||ct.unshift([ft[dt],DEFAULT+"remove"])}ct.forEach(([ft,dt])=>{var pt;if((pt=et.__r3f)!=null&&pt.primitive&&ft==="object"||is.equ(dt,ot[ft]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(ft))return ht.push([ft,dt,!0,[]]);let mt=[];ft.includes("-")&&(mt=ft.split("-")),ht.push([ft,dt,!1,mt]);for(const vt in nt){const yt=nt[vt];vt.startsWith(`${ft}-`)&&ht.push([vt,yt,!1,vt.split("-")])}});const ut={...nt};return lt!=null&&lt.memoizedProps&&lt!=null&&lt.memoizedProps.args&&(ut.args=lt.memoizedProps.args),lt!=null&&lt.memoizedProps&&lt!=null&&lt.memoizedProps.attach&&(ut.attach=lt.memoizedProps.attach),{memoized:ut,changes:ht}}const __DEV__=typeof process<"u"&&!1;function applyProps$1(et,_){var _e;const tt=et.__r3f,nt=tt==null?void 0:tt.root,rt=nt==null||nt.getState==null?void 0:nt.getState(),{memoized:it,changes:st}=isDiffSet(_)?_:diffProps(et,_),ot=tt==null?void 0:tt.eventCount;et.__r3f&&(et.__r3f.memoizedProps=it);for(let lt=0;lt<st.length;lt++){let[ct,ht,ut,ft]=st[lt];if(hasColorSpace(et)){const vt="srgb",yt="srgb-linear";ct==="encoding"?(ct="colorSpace",ht=ht===3001?vt:yt):ct==="outputEncoding"&&(ct="outputColorSpace",ht=ht===3001?vt:yt)}let dt=et,pt=dt[ct];if(ft.length&&(pt=ft.reduce((mt,vt)=>mt[vt],et),!(pt&&pt.set))){const[mt,...vt]=ft.reverse();dt=vt.reverse().reduce((yt,_t)=>yt[_t],et),ct=mt}if(ht===DEFAULT+"remove")if(dt.constructor){let mt=DEFAULTS.get(dt.constructor);mt||(mt=new dt.constructor,DEFAULTS.set(dt.constructor,mt)),ht=mt[ct]}else ht=0;if(ut&&tt)ht?tt.handlers[ct]=ht:delete tt.handlers[ct],tt.eventCount=Object.keys(tt.handlers).length;else if(pt&&pt.set&&(pt.copy||pt instanceof Layers)){if(Array.isArray(ht))pt.fromArray?pt.fromArray(ht):pt.set(...ht);else if(pt.copy&&ht&&ht.constructor&&(__DEV__?pt.constructor.name===ht.constructor.name:pt.constructor===ht.constructor))pt.copy(ht);else if(ht!==void 0){const mt=pt instanceof Color$1;!mt&&pt.setScalar?pt.setScalar(ht):pt instanceof Layers&&ht instanceof Layers?pt.mask=ht.mask:pt.set(ht),!getColorManagement()&&rt&&!rt.linear&&mt&&pt.convertSRGBToLinear()}}else if(dt[ct]=ht,dt[ct]instanceof Texture$1&&dt[ct].format===RGBAFormat&&dt[ct].type===UnsignedByteType&&rt){const mt=dt[ct];hasColorSpace(mt)&&hasColorSpace(rt.gl)?mt.colorSpace=rt.gl.outputColorSpace:mt.encoding=rt.gl.outputEncoding}invalidateInstance(et)}if(tt&&tt.parent&&et.raycast&&ot!==tt.eventCount){const lt=findInitialRoot(et).getState().internal,ct=lt.interaction.indexOf(et);ct>-1&&lt.interaction.splice(ct,1),tt.eventCount&&lt.interaction.push(et)}return!(st.length===1&&st[0][0]==="onUpdate")&&st.length&&(_e=et.__r3f)!=null&&_e.parent&&updateInstance(et),et}function invalidateInstance(et){var _,_e;const tt=(_=et.__r3f)==null||(_e=_.root)==null||_e.getState==null?void 0:_e.getState();tt&&tt.internal.frames===0&&tt.invalidate()}function updateInstance(et){et.onUpdate==null||et.onUpdate(et)}function updateCamera(et,_){et.manual||(isOrthographicCamera(et)?(et.left=_.width/-2,et.right=_.width/2,et.top=_.height/2,et.bottom=_.height/-2):et.aspect=_.width/_.height,et.updateProjectionMatrix(),et.updateMatrixWorld())}function makeId(et){return(et.eventObject||et.object).uuid+"/"+et.index+et.instanceId}function getEventPriority(){var et;const _=typeof self<"u"&&self||typeof window<"u"&&window;if(!_)return constantsExports.DefaultEventPriority;switch((et=_.event)==null?void 0:et.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(et,_,_e,tt){const nt=_e.get(_);nt&&(_e.delete(_),_e.size===0&&(et.delete(tt),nt.target.releasePointerCapture(tt)))}function removeInteractivity(et,_){const{internal:_e}=et.getState();_e.interaction=_e.interaction.filter(tt=>tt!==_),_e.initialHits=_e.initialHits.filter(tt=>tt!==_),_e.hovered.forEach((tt,nt)=>{(tt.eventObject===_||tt.object===_)&&_e.hovered.delete(nt)}),_e.capturedMap.forEach((tt,nt)=>{releaseInternalPointerCapture(_e.capturedMap,_,tt,nt)})}function createEvents(et){function _(ot){const{internal:at}=et.getState(),lt=ot.offsetX-at.initialClick[0],ct=ot.offsetY-at.initialClick[1];return Math.round(Math.sqrt(lt*lt+ct*ct))}function _e(ot){return ot.filter(at=>["Move","Over","Enter","Out","Leave"].some(lt=>{var ct;return(ct=at.__r3f)==null?void 0:ct.handlers["onPointer"+lt]}))}function tt(ot,at){const lt=et.getState(),ct=new Set,ht=[],ut=at?at(lt.internal.interaction):lt.internal.interaction;for(let mt=0;mt<ut.length;mt++){const vt=getRootState(ut[mt]);vt&&(vt.raycaster.camera=void 0)}lt.previousRoot||lt.events.compute==null||lt.events.compute(ot,lt);function ft(mt){const vt=getRootState(mt);if(!vt||!vt.events.enabled||vt.raycaster.camera===null)return[];if(vt.raycaster.camera===void 0){var yt;vt.events.compute==null||vt.events.compute(ot,vt,(yt=vt.previousRoot)==null?void 0:yt.getState()),vt.raycaster.camera===void 0&&(vt.raycaster.camera=null)}return vt.raycaster.camera?vt.raycaster.intersectObject(mt,!0):[]}let dt=ut.flatMap(ft).sort((mt,vt)=>{const yt=getRootState(mt.object),_t=getRootState(vt.object);return!yt||!_t?mt.distance-vt.distance:_t.events.priority-yt.events.priority||mt.distance-vt.distance}).filter(mt=>{const vt=makeId(mt);return ct.has(vt)?!1:(ct.add(vt),!0)});lt.events.filter&&(dt=lt.events.filter(dt,lt));for(const mt of dt){let vt=mt.object;for(;vt;){var pt;(pt=vt.__r3f)!=null&&pt.eventCount&&ht.push({...mt,eventObject:vt}),vt=vt.parent}}if("pointerId"in ot&&lt.internal.capturedMap.has(ot.pointerId))for(let mt of lt.internal.capturedMap.get(ot.pointerId).values())ct.has(makeId(mt.intersection))||ht.push(mt.intersection);return ht}function nt(ot,at,lt,ct){const ht=et.getState();if(ot.length){const ut={stopped:!1};for(const ft of ot){const dt=getRootState(ft.object)||ht,{raycaster:pt,pointer:mt,camera:vt,internal:yt}=dt,_t=new Vector3(mt.x,mt.y,0).unproject(vt),St=wt=>{var Ct,Rt;return(Ct=(Rt=yt.capturedMap.get(wt))==null?void 0:Rt.has(ft.eventObject))!=null?Ct:!1},bt=wt=>{const Ct={intersection:ft,target:at.target};yt.capturedMap.has(wt)?yt.capturedMap.get(wt).set(ft.eventObject,Ct):yt.capturedMap.set(wt,new Map([[ft.eventObject,Ct]])),at.target.setPointerCapture(wt)},Et=wt=>{const Ct=yt.capturedMap.get(wt);Ct&&releaseInternalPointerCapture(yt.capturedMap,ft.eventObject,Ct,wt)};let Mt={};for(let wt in at){let Ct=at[wt];typeof Ct!="function"&&(Mt[wt]=Ct)}let Tt={...ft,...Mt,pointer:mt,intersections:ot,stopped:ut.stopped,delta:lt,unprojectedPoint:_t,ray:pt.ray,camera:vt,stopPropagation(){const wt="pointerId"in at&&yt.capturedMap.get(at.pointerId);if((!wt||wt.has(ft.eventObject))&&(Tt.stopped=ut.stopped=!0,yt.hovered.size&&Array.from(yt.hovered.values()).find(Ct=>Ct.eventObject===ft.eventObject))){const Ct=ot.slice(0,ot.indexOf(ft));rt([...Ct,ft])}},target:{hasPointerCapture:St,setPointerCapture:bt,releasePointerCapture:Et},currentTarget:{hasPointerCapture:St,setPointerCapture:bt,releasePointerCapture:Et},nativeEvent:at};if(ct(Tt),ut.stopped===!0)break}}return ot}function rt(ot){const{internal:at}=et.getState();for(const lt of at.hovered.values())if(!ot.length||!ot.find(ct=>ct.object===lt.object&&ct.index===lt.index&&ct.instanceId===lt.instanceId)){const ht=lt.eventObject.__r3f,ut=ht==null?void 0:ht.handlers;if(at.hovered.delete(makeId(lt)),ht!=null&&ht.eventCount){const ft={...lt,intersections:ot};ut.onPointerOut==null||ut.onPointerOut(ft),ut.onPointerLeave==null||ut.onPointerLeave(ft)}}}function it(ot,at){for(let lt=0;lt<at.length;lt++){const ct=at[lt].__r3f;ct==null||ct.handlers.onPointerMissed==null||ct.handlers.onPointerMissed(ot)}}function st(ot){switch(ot){case"onPointerLeave":case"onPointerCancel":return()=>rt([]);case"onLostPointerCapture":return at=>{const{internal:lt}=et.getState();"pointerId"in at&&lt.capturedMap.has(at.pointerId)&&requestAnimationFrame(()=>{lt.capturedMap.has(at.pointerId)&&(lt.capturedMap.delete(at.pointerId),rt([]))})}}return function(lt){const{onPointerMissed:ct,internal:ht}=et.getState();ht.lastEvent.current=lt;const ut=ot==="onPointerMove",ft=ot==="onClick"||ot==="onContextMenu"||ot==="onDoubleClick",pt=tt(lt,ut?_e:void 0),mt=ft?_(lt):0;ot==="onPointerDown"&&(ht.initialClick=[lt.offsetX,lt.offsetY],ht.initialHits=pt.map(yt=>yt.eventObject)),ft&&!pt.length&&mt<=2&&(it(lt,ht.interaction),ct&&ct(lt)),ut&&rt(pt);function vt(yt){const _t=yt.eventObject,St=_t.__r3f,bt=St==null?void 0:St.handlers;if(St!=null&&St.eventCount)if(ut){if(bt.onPointerOver||bt.onPointerEnter||bt.onPointerOut||bt.onPointerLeave){const Et=makeId(yt),Mt=ht.hovered.get(Et);Mt?Mt.stopped&&yt.stopPropagation():(ht.hovered.set(Et,yt),bt.onPointerOver==null||bt.onPointerOver(yt),bt.onPointerEnter==null||bt.onPointerEnter(yt))}bt.onPointerMove==null||bt.onPointerMove(yt)}else{const Et=bt[ot];Et?(!ft||ht.initialHits.includes(_t))&&(it(lt,ht.interaction.filter(Mt=>!ht.initialHits.includes(Mt))),Et(yt)):ft&&ht.initialHits.includes(_t)&&it(lt,ht.interaction.filter(Mt=>!ht.initialHits.includes(Mt)))}}nt(pt,lt,mt,vt)}}return{handlePointer:st}}const isRenderer=et=>!!(et!=null&&et.render),context$1=reactExports.createContext(null),createStore=(et,_)=>{const _e=create((st,ot)=>{const at=new Vector3,lt=new Vector3,ct=new Vector3;function ht(mt=ot().camera,vt=lt,yt=ot().size){const{width:_t,height:St,top:bt,left:Et}=yt,Mt=_t/St;vt instanceof Vector3?ct.copy(vt):ct.set(...vt);const Tt=mt.getWorldPosition(at).distanceTo(ct);if(isOrthographicCamera(mt))return{width:_t/mt.zoom,height:St/mt.zoom,top:bt,left:Et,factor:1,distance:Tt,aspect:Mt};{const wt=mt.fov*Math.PI/180,Ct=2*Math.tan(wt/2)*Tt,Rt=Ct*(_t/St);return{width:Rt,height:Ct,top:bt,left:Et,factor:_t/Rt,distance:Tt,aspect:Mt}}}let ut;const ft=mt=>st(vt=>({performance:{...vt.performance,current:mt}})),dt=new Vector2;return{set:st,get:ot,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(mt=1)=>et(ot(),mt),advance:(mt,vt)=>_(mt,vt,ot()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:dt,mouse:dt,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const mt=ot();ut&&clearTimeout(ut),mt.performance.current!==mt.performance.min&&ft(mt.performance.min),ut=setTimeout(()=>ft(ot().performance.max),mt.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:ht},setEvents:mt=>st(vt=>({...vt,events:{...vt.events,...mt}})),setSize:(mt,vt,yt,_t,St)=>{const bt=ot().camera,Et={width:mt,height:vt,top:_t||0,left:St||0,updateStyle:yt};st(Mt=>({size:Et,viewport:{...Mt.viewport,...ht(bt,lt,Et)}}))},setDpr:mt=>st(vt=>{const yt=calculateDpr(mt);return{viewport:{...vt.viewport,dpr:yt,initialDpr:vt.viewport.initialDpr||yt}}}),setFrameloop:(mt="always")=>{const vt=ot().clock;vt.stop(),vt.elapsedTime=0,mt!=="never"&&(vt.start(),vt.elapsedTime=0),st(()=>({frameloop:mt}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(mt,vt,yt)=>{const _t=ot().internal;return _t.priority=_t.priority+(vt>0?1:0),_t.subscribers.push({ref:mt,priority:vt,store:yt}),_t.subscribers=_t.subscribers.sort((St,bt)=>St.priority-bt.priority),()=>{const St=ot().internal;St!=null&&St.subscribers&&(St.priority=St.priority-(vt>0?1:0),St.subscribers=St.subscribers.filter(bt=>bt.ref!==mt))}}}}}),tt=_e.getState();let nt=tt.size,rt=tt.viewport.dpr,it=tt.camera;return _e.subscribe(()=>{const{camera:st,size:ot,viewport:at,gl:lt,set:ct}=_e.getState();if(ot.width!==nt.width||ot.height!==nt.height||at.dpr!==rt){var ht;nt=ot,rt=at.dpr,updateCamera(st,ot),lt.setPixelRatio(at.dpr);const ut=(ht=ot.updateStyle)!=null?ht:typeof HTMLCanvasElement<"u"&&lt.domElement instanceof HTMLCanvasElement;lt.setSize(ot.width,ot.height,ut)}st!==it&&(it=st,ct(ut=>({viewport:{...ut.viewport,...ut.viewport.getCurrentViewport(st)}})))}),_e.subscribe(st=>et(st)),_e};let i$4,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;function run$1(et,_){if(et.size)for(const{callback:_e}of et.values())_e(_)}function flushGlobalEffects(et,_){switch(et){case"before":return run$1(globalEffects,_);case"after":return run$1(globalAfterEffects,_);case"tail":return run$1(globalTailEffects,_)}}let subscribers,subscription;function render$1(et,_,_e){let tt=_.clock.getDelta();for(_.frameloop==="never"&&typeof et=="number"&&(tt=et-_.clock.elapsedTime,_.clock.oldTime=_.clock.elapsedTime,_.clock.elapsedTime=et),subscribers=_.internal.subscribers,i$4=0;i$4<subscribers.length;i$4++)subscription=subscribers[i$4],subscription.ref.current(subscription.store.getState(),tt,_e);return!_.internal.priority&&_.gl.render&&_.gl.render(_.scene,_.camera),_.internal.frames=Math.max(0,_.internal.frames-1),_.frameloop==="always"?1:_.internal.frames}function createLoop(et){let _=!1,_e=!1,tt,nt,rt;function it(at){nt=requestAnimationFrame(it),_=!0,tt=0,flushGlobalEffects("before",at),_e=!0;for(const ct of et.values()){var lt;rt=ct.store.getState(),rt.internal.active&&(rt.frameloop==="always"||rt.internal.frames>0)&&!((lt=rt.gl.xr)!=null&&lt.isPresenting)&&(tt+=render$1(at,rt))}if(_e=!1,flushGlobalEffects("after",at),tt===0)return flushGlobalEffects("tail",at),_=!1,cancelAnimationFrame(nt)}function st(at,lt=1){var ct;if(!at)return et.forEach(ht=>st(ht.store.getState(),lt));(ct=at.gl.xr)!=null&&ct.isPresenting||!at.internal.active||at.frameloop==="never"||(lt>1?at.internal.frames=Math.min(60,at.internal.frames+lt):_e?at.internal.frames=2:at.internal.frames=1,_||(_=!0,requestAnimationFrame(it)))}function ot(at,lt=!0,ct,ht){if(lt&&flushGlobalEffects("before",at),ct)render$1(at,ct,ht);else for(const ut of et.values())render$1(at,ut.store.getState());lt&&flushGlobalEffects("after",at)}return{loop:it,invalidate:st,advance:ot}}function useStore(){const et=reactExports.useContext(context$1);if(!et)throw new Error("R3F: Hooks can only be used within the Canvas component!");return et}function useThree(et=_e=>_e,_){return useStore()(et,_)}function useFrame(et,_=0){const _e=useStore(),tt=_e.getState().internal.subscribe,nt=useMutableCallback(et);return useIsomorphicLayoutEffect(()=>tt(nt,_,_e),[_,tt,_e]),null}const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(et,_)=>{const _e=typeof et=="function"?et(_):et;return isRenderer(_e)?_e:new WebGLRenderer({powerPreference:"high-performance",canvas:_,antialias:!0,alpha:!0,...et})};function computeInitialSize(et,_){const _e=typeof HTMLCanvasElement<"u"&&et instanceof HTMLCanvasElement;if(_){const{width:tt,height:nt,top:rt,left:it,updateStyle:st=_e}=_;return{width:tt,height:nt,top:rt,left:it,updateStyle:st}}else if(typeof HTMLCanvasElement<"u"&&et instanceof HTMLCanvasElement&&et.parentElement){const{width:tt,height:nt,top:rt,left:it}=et.parentElement.getBoundingClientRect();return{width:tt,height:nt,top:rt,left:it,updateStyle:_e}}else if(typeof OffscreenCanvas<"u"&&et instanceof OffscreenCanvas)return{width:et.width,height:et.height,top:0,left:0,updateStyle:_e};return{width:0,height:0,top:0,left:0}}function createRoot(et){const _=roots.get(et),_e=_==null?void 0:_.fiber,tt=_==null?void 0:_.store;_&&console.warn("R3F.createRoot should only be called once!");const nt=typeof reportError=="function"?reportError:console.error,rt=tt||createStore(invalidate,advance),it=_e||reconciler.createContainer(rt,constantsExports.ConcurrentRoot,null,!1,null,"",nt,null);_||roots.set(et,{fiber:it,store:rt});let st,ot=!1,at;return{configure(lt={}){let{gl:ct,size:ht,scene:ut,events:ft,onCreated:dt,shadows:pt=!1,linear:mt=!1,flat:vt=!1,legacy:yt=!1,orthographic:_t=!1,frameloop:St="always",dpr:bt=[1,2],performance:Et,raycaster:Mt,camera:Tt,onPointerMissed:wt}=lt,Ct=rt.getState(),Rt=Ct.gl;Ct.gl||Ct.set({gl:Rt=createRendererInstance(ct,et)});let It=Ct.raycaster;It||Ct.set({raycaster:It=new Raycaster});const{params:Dt,...Ft}=Mt||{};if(is.equ(Ft,It,shallowLoose)||applyProps(It,{...Ft}),is.equ(Dt,It.params,shallowLoose)||applyProps(It,{params:{...It.params,...Dt}}),!Ct.camera||Ct.camera===at&&!is.equ(at,Tt,shallowLoose)){at=Tt;const Nt=Tt instanceof Camera,zt=Nt?Tt:_t?new OrthographicCamera(0,0,0,0,.1,1e3):new PerspectiveCamera(75,0,.1,1e3);Nt||(zt.position.z=5,Tt&&(applyProps(zt,Tt),("aspect"in Tt||"left"in Tt||"right"in Tt||"bottom"in Tt||"top"in Tt)&&(zt.manual=!0,zt.updateProjectionMatrix())),!Ct.camera&&!(Tt!=null&&Tt.rotation)&&zt.lookAt(0,0,0)),Ct.set({camera:zt}),It.camera=zt}if(!Ct.scene){let Nt;ut instanceof Scene?Nt=ut:(Nt=new Scene,ut&&applyProps(Nt,ut)),Ct.set({scene:prepare(Nt)})}if(!Ct.xr){var $t;const Nt=(qt,Gt)=>{const Xt=rt.getState();Xt.frameloop!=="never"&&advance(qt,!0,Xt,Gt)},zt=()=>{const qt=rt.getState();qt.gl.xr.enabled=qt.gl.xr.isPresenting,qt.gl.xr.setAnimationLoop(qt.gl.xr.isPresenting?Nt:null),qt.gl.xr.isPresenting||invalidate(qt)},Ht={connect(){const qt=rt.getState().gl;qt.xr.addEventListener("sessionstart",zt),qt.xr.addEventListener("sessionend",zt)},disconnect(){const qt=rt.getState().gl;qt.xr.removeEventListener("sessionstart",zt),qt.xr.removeEventListener("sessionend",zt)}};typeof(($t=Rt.xr)==null?void 0:$t.addEventListener)=="function"&&Ht.connect(),Ct.set({xr:Ht})}if(Rt.shadowMap){const Nt=Rt.shadowMap.enabled,zt=Rt.shadowMap.type;if(Rt.shadowMap.enabled=!!pt,is.boo(pt))Rt.shadowMap.type=PCFSoftShadowMap;else if(is.str(pt)){var Yt;const Ht={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};Rt.shadowMap.type=(Yt=Ht[pt])!=null?Yt:PCFSoftShadowMap}else is.obj(pt)&&Object.assign(Rt.shadowMap,pt);(Nt!==Rt.shadowMap.enabled||zt!==Rt.shadowMap.type)&&(Rt.shadowMap.needsUpdate=!0)}const Lt=getColorManagement();Lt&&("enabled"in Lt?Lt.enabled=!yt:"legacyMode"in Lt&&(Lt.legacyMode=yt)),ot||applyProps(Rt,{outputEncoding:mt?3e3:3001,toneMapping:vt?NoToneMapping:ACESFilmicToneMapping}),Ct.legacy!==yt&&Ct.set(()=>({legacy:yt})),Ct.linear!==mt&&Ct.set(()=>({linear:mt})),Ct.flat!==vt&&Ct.set(()=>({flat:vt})),ct&&!is.fun(ct)&&!isRenderer(ct)&&!is.equ(ct,Rt,shallowLoose)&&applyProps(Rt,ct),ft&&!Ct.events.handlers&&Ct.set({events:ft(rt)});const Ot=computeInitialSize(et,ht);return is.equ(Ot,Ct.size,shallowLoose)||Ct.setSize(Ot.width,Ot.height,Ot.updateStyle,Ot.top,Ot.left),bt&&Ct.viewport.dpr!==calculateDpr(bt)&&Ct.setDpr(bt),Ct.frameloop!==St&&Ct.setFrameloop(St),Ct.onPointerMissed||Ct.set({onPointerMissed:wt}),Et&&!is.equ(Et,Ct.performance,shallowLoose)&&Ct.set(Nt=>({performance:{...Nt.performance,...Et}})),st=dt,ot=!0,this},render(lt){return ot||this.configure(),reconciler.updateContainer(jsxRuntimeExports.jsx(Provider,{store:rt,children:lt,onCreated:st,rootElement:et}),it,null,()=>{}),rt},unmount(){unmountComponentAtNode(et)}}}function Provider({store:et,children:_,onCreated:_e,rootElement:tt}){return useIsomorphicLayoutEffect(()=>{const nt=et.getState();nt.set(rt=>({internal:{...rt.internal,active:!0}})),_e&&_e(nt),et.getState().events.connected||nt.events.connect==null||nt.events.connect(tt)},[]),jsxRuntimeExports.jsx(context$1.Provider,{value:et,children:_})}function unmountComponentAtNode(et,_){const _e=roots.get(et),tt=_e==null?void 0:_e.fiber;if(tt){const nt=_e==null?void 0:_e.store.getState();nt&&(nt.internal.active=!1),reconciler.updateContainer(null,tt,null,()=>{nt&&setTimeout(()=>{try{var rt,it,st,ot;nt.events.disconnect==null||nt.events.disconnect(),(rt=nt.gl)==null||(it=rt.renderLists)==null||it.dispose==null||it.dispose(),(st=nt.gl)==null||st.forceContextLoss==null||st.forceContextLoss(),(ot=nt.gl)!=null&&ot.xr&&nt.xr.disconnect(),dispose(nt),roots.delete(et)}catch{}},500)})}}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});function debounce(et,_,_e){var tt,nt,rt,it,st;_==null&&(_=100);function ot(){var lt=Date.now()-it;lt<_&&lt>=0?tt=setTimeout(ot,_-lt):(tt=null,_e||(st=et.apply(rt,nt),rt=nt=null))}var at=function(){rt=this,nt=arguments,it=Date.now();var lt=_e&&!tt;return tt||(tt=setTimeout(ot,_)),lt&&(st=et.apply(rt,nt),rt=nt=null),st};return at.clear=function(){tt&&(clearTimeout(tt),tt=null)},at.flush=function(){tt&&(st=et.apply(rt,nt),rt=nt=null,clearTimeout(tt),tt=null)},at}debounce.debounce=debounce;var debounce_1=debounce;const createDebounce=getDefaultExportFromCjs(debounce_1);function useMeasure(et){let{debounce:_,scroll:_e,polyfill:tt,offsetSize:nt}=et===void 0?{debounce:0,scroll:!1,offsetSize:!1}:et;const rt=tt||(typeof window>"u"?class{}:window.ResizeObserver);if(!rt)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[it,st]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),ot=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:it}),at=_?typeof _=="number"?_:_.scroll:null,lt=_?typeof _=="number"?_:_.resize:null,ct=reactExports.useRef(!1);reactExports.useEffect(()=>(ct.current=!0,()=>void(ct.current=!1)));const[ht,ut,ft]=reactExports.useMemo(()=>{const vt=()=>{if(!ot.current.element)return;const{left:yt,top:_t,width:St,height:bt,bottom:Et,right:Mt,x:Tt,y:wt}=ot.current.element.getBoundingClientRect(),Ct={left:yt,top:_t,width:St,height:bt,bottom:Et,right:Mt,x:Tt,y:wt};ot.current.element instanceof HTMLElement&&nt&&(Ct.height=ot.current.element.offsetHeight,Ct.width=ot.current.element.offsetWidth),Object.freeze(Ct),ct.current&&!areBoundsEqual(ot.current.lastBounds,Ct)&&st(ot.current.lastBounds=Ct)};return[vt,lt?createDebounce(vt,lt):vt,at?createDebounce(vt,at):vt]},[st,nt,at,lt]);function dt(){ot.current.scrollContainers&&(ot.current.scrollContainers.forEach(vt=>vt.removeEventListener("scroll",ft,!0)),ot.current.scrollContainers=null),ot.current.resizeObserver&&(ot.current.resizeObserver.disconnect(),ot.current.resizeObserver=null)}function pt(){ot.current.element&&(ot.current.resizeObserver=new rt(ft),ot.current.resizeObserver.observe(ot.current.element),_e&&ot.current.scrollContainers&&ot.current.scrollContainers.forEach(vt=>vt.addEventListener("scroll",ft,{capture:!0,passive:!0})))}const mt=vt=>{!vt||vt===ot.current.element||(dt(),ot.current.element=vt,ot.current.scrollContainers=findScrollContainers(vt),pt())};return useOnWindowScroll(ft,!!_e),useOnWindowResize(ut),reactExports.useEffect(()=>{dt(),pt()},[_e,ft,ut]),reactExports.useEffect(()=>dt,[]),[mt,it,ht]}function useOnWindowResize(et){reactExports.useEffect(()=>{const _=et;return window.addEventListener("resize",_),()=>void window.removeEventListener("resize",_)},[et])}function useOnWindowScroll(et,_){reactExports.useEffect(()=>{if(_){const _e=et;return window.addEventListener("scroll",_e,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",_e,!0)}},[et,_])}function findScrollContainers(et){const _=[];if(!et||et===document.body)return _;const{overflow:_e,overflowX:tt,overflowY:nt}=window.getComputedStyle(et);return[_e,tt,nt].some(rt=>rt==="auto"||rt==="scroll")&&_.push(et),[..._,...findScrollContainers(et.parentElement)]}const keys=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(et,_)=>keys.every(_e=>et[_e]===_[_e]);var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(et,_,_e)=>_ in et?__defProp(et,_,{enumerable:!0,configurable:!0,writable:!0,value:_e}):et[_]=_e,__spreadValues=(et,_)=>{for(var _e in _||(_={}))__hasOwnProp.call(_,_e)&&__defNormalProp(et,_e,_[_e]);if(__getOwnPropSymbols)for(var _e of __getOwnPropSymbols(_))__propIsEnum.call(_,_e)&&__defNormalProp(et,_e,_[_e]);return et},__spreadProps=(et,_)=>__defProps(et,__getOwnPropDescs(_)),_a,_b;typeof window<"u"&&((_a=window.document)!=null&&_a.createElement||((_b=window.navigator)==null?void 0:_b.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function traverseFiber(et,_,_e){if(!et)return;if(_e(et)===!0)return et;let tt=et.child;for(;tt;){const nt=traverseFiber(tt,_,_e);if(nt)return nt;tt=tt.sibling}}function wrapContext(et){try{return Object.defineProperties(et,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return et}}const error=console.error;console.error=function(){const et=[...arguments].join("");if(et!=null&&et.startsWith("Warning:")&&et.includes("useContext")){console.error=error;return}return error.apply(this,arguments)};const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}function useFiber(){const et=reactExports.useContext(FiberContext);if(et===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _=reactExports.useId();return reactExports.useMemo(()=>{for(const tt of[et,et==null?void 0:et.alternate]){if(!tt)continue;const nt=traverseFiber(tt,!1,rt=>{let it=rt.memoizedState;for(;it;){if(it.memoizedState===_)return!0;it=it.next}});if(nt)return nt}},[et,_])}function useContextMap(){const et=useFiber(),[_]=reactExports.useState(()=>new Map);_.clear();let _e=et;for(;_e;){if(_e.type&&typeof _e.type=="object"){const nt=_e.type._context===void 0&&_e.type.Provider===_e.type?_e.type:_e.type._context;nt&&nt!==FiberContext&&!_.has(nt)&&_.set(nt,reactExports.useContext(wrapContext(nt)))}_e=_e.return}return _}function useContextBridge(){const et=useContextMap();return reactExports.useMemo(()=>Array.from(et.keys()).reduce((_,_e)=>tt=>reactExports.createElement(_,null,reactExports.createElement(_e.Provider,__spreadProps(__spreadValues({},tt),{value:et.get(_e)}))),_=>reactExports.createElement(FiberProvider,__spreadValues({},_))),[et])}const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(et){const{handlePointer:_}=createEvents(et);return{priority:1,enabled:!0,compute(_e,tt,nt){tt.pointer.set(_e.offsetX/tt.size.width*2-1,-(_e.offsetY/tt.size.height)*2+1),tt.raycaster.setFromCamera(tt.pointer,tt.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((_e,tt)=>({..._e,[tt]:_(tt)}),{}),update:()=>{var _e;const{events:tt,internal:nt}=et.getState();(_e=nt.lastEvent)!=null&&_e.current&&tt.handlers&&tt.handlers.onPointerMove(nt.lastEvent.current)},connect:_e=>{var tt;const{set:nt,events:rt}=et.getState();rt.disconnect==null||rt.disconnect(),nt(it=>({events:{...it.events,connected:_e}})),Object.entries((tt=rt.handlers)!=null?tt:[]).forEach(([it,st])=>{const[ot,at]=DOM_EVENTS[it];_e.addEventListener(ot,st,{passive:at})})},disconnect:()=>{const{set:_e,events:tt}=et.getState();if(tt.connected){var nt;Object.entries((nt=tt.handlers)!=null?nt:[]).forEach(([rt,it])=>{if(tt&&tt.connected instanceof HTMLElement){const[st]=DOM_EVENTS[rt];tt.connected.removeEventListener(st,it)}}),_e(rt=>({events:{...rt.events,connected:void 0}}))}}}}const CanvasImpl=reactExports.forwardRef(function({children:_,fallback:_e,resize:tt,style:nt,gl:rt,events:it=createPointerEvents,eventSource:st,eventPrefix:ot,shadows:at,linear:lt,flat:ct,legacy:ht,orthographic:ut,frameloop:ft,dpr:dt,performance:pt,raycaster:mt,camera:vt,scene:yt,onPointerMissed:_t,onCreated:St,...bt},Et){reactExports.useMemo(()=>extend$3(THREE),[]);const Mt=useContextBridge(),[Tt,wt]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...tt}),Ct=reactExports.useRef(null),Rt=reactExports.useRef(null);reactExports.useImperativeHandle(Et,()=>Ct.current);const It=useMutableCallback(_t),[Dt,Ft]=reactExports.useState(!1),[$t,Yt]=reactExports.useState(!1);if(Dt)throw Dt;if($t)throw $t;const Lt=reactExports.useRef(null);useIsomorphicLayoutEffect(()=>{const Nt=Ct.current;wt.width>0&&wt.height>0&&Nt&&(Lt.current||(Lt.current=createRoot(Nt)),Lt.current.configure({gl:rt,events:it,shadows:at,linear:lt,flat:ct,legacy:ht,orthographic:ut,frameloop:ft,dpr:dt,performance:pt,raycaster:mt,camera:vt,scene:yt,size:wt,onPointerMissed:(...zt)=>It.current==null?void 0:It.current(...zt),onCreated:zt=>{zt.events.connect==null||zt.events.connect(st?isRef(st)?st.current:st:Rt.current),ot&&zt.setEvents({compute:(Ht,qt)=>{const Gt=Ht[ot+"X"],Xt=Ht[ot+"Y"];qt.pointer.set(Gt/qt.size.width*2-1,-(Xt/qt.size.height)*2+1),qt.raycaster.setFromCamera(qt.pointer,qt.camera)}}),St==null||St(zt)}}),Lt.current.render(jsxRuntimeExports.jsx(Mt,{children:jsxRuntimeExports.jsx(ErrorBoundary,{set:Yt,children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Block,{set:Ft}),children:_})})})))}),reactExports.useEffect(()=>{const Nt=Ct.current;if(Nt)return()=>unmountComponentAtNode(Nt)},[]);const Ot=st?"none":"auto";return jsxRuntimeExports.jsx("div",{ref:Rt,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Ot,...nt},...bt,children:jsxRuntimeExports.jsx("div",{ref:Tt,style:{width:"100%",height:"100%"},children:jsxRuntimeExports.jsx("canvas",{ref:Ct,style:{display:"block"},children:_e})})})}),Canvas=reactExports.forwardRef(function(_,_e){return jsxRuntimeExports.jsx(FiberProvider,{children:jsxRuntimeExports.jsx(CanvasImpl,{..._,ref:_e})})});function workerBootstrap(){var et=Object.create(null);function _(nt,rt){var it=nt.id,st=nt.name,ot=nt.dependencies;ot===void 0&&(ot=[]);var at=nt.init;at===void 0&&(at=function(){});var lt=nt.getTransferables;if(lt===void 0&&(lt=null),!et[it])try{ot=ot.map(function(ht){return ht&&ht.isWorkerModule&&(_(ht,function(ut){if(ut instanceof Error)throw ut}),ht=et[ht.id].value),ht}),at=tt("<"+st+">.init",at),lt&&(lt=tt("<"+st+">.getTransferables",lt));var ct=null;typeof at=="function"?ct=at.apply(void 0,ot):console.error("worker module init function failed to rehydrate"),et[it]={id:it,value:ct,getTransferables:lt},rt(ct)}catch(ht){ht&&ht.noLog||console.error(ht),rt(ht)}}function _e(nt,rt){var it,st=nt.id,ot=nt.args;(!et[st]||typeof et[st].value!="function")&&rt(new Error("Worker module "+st+": not found or its 'init' did not return a function"));try{var at=(it=et[st]).value.apply(it,ot);at&&typeof at.then=="function"?at.then(lt,function(ct){return rt(ct instanceof Error?ct:new Error(""+ct))}):lt(at)}catch(ct){rt(ct)}function lt(ct){try{var ht=et[st].getTransferables&&et[st].getTransferables(ct);(!ht||!Array.isArray(ht)||!ht.length)&&(ht=void 0),rt(ct,ht)}catch(ut){console.error(ut),rt(ut)}}}function tt(nt,rt){var it=void 0;self.troikaDefine=function(ot){return it=ot};var st=URL.createObjectURL(new Blob(["/** "+nt.replace(/\*/g,"")+` **/

troikaDefine(
`+rt+`
)`],{type:"application/javascript"}));try{importScripts(st)}catch(ot){console.error(ot)}return URL.revokeObjectURL(st),delete self.troikaDefine,it}self.addEventListener("message",function(nt){var rt=nt.data,it=rt.messageId,st=rt.action,ot=rt.data;try{st==="registerModule"&&_(ot,function(at){at instanceof Error?postMessage({messageId:it,success:!1,error:at.message}):postMessage({messageId:it,success:!0,result:{isCallable:typeof at=="function"}})}),st==="callModule"&&_e(ot,function(at,lt){at instanceof Error?postMessage({messageId:it,success:!1,error:at.message}):postMessage({messageId:it,success:!0,result:at},lt||void 0)})}catch(at){postMessage({messageId:it,success:!1,error:at.stack})}})}function defineMainThreadModule(et){var _=function(){for(var _e=[],tt=arguments.length;tt--;)_e[tt]=arguments[tt];return _._getInitResult().then(function(nt){if(typeof nt=="function")return nt.apply(void 0,_e);throw new Error("Worker module function was called but `init` did not return a callable function")})};return _._getInitResult=function(){var _e=et.dependencies,tt=et.init;_e=Array.isArray(_e)?_e.map(function(rt){return rt&&rt._getInitResult?rt._getInitResult():rt}):[];var nt=Promise.all(_e).then(function(rt){return tt.apply(null,rt)});return _._getInitResult=function(){return nt},nt},_}var supportsWorkers=function(){var et=!1;if(typeof window<"u"&&typeof window.document<"u")try{var _=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));_.terminate(),et=!0}catch(_e){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+_e.message+"]")}return supportsWorkers=function(){return et},et},_workerModuleId=0,_messageId=0,_allowInitAsString=!1,workers=Object.create(null),registeredModules=Object.create(null),openRequests=Object.create(null);function defineWorkerModule(et){if((!et||typeof et.init!="function")&&!_allowInitAsString)throw new Error("requires `options.init` function");var _=et.dependencies,_e=et.init,tt=et.getTransferables,nt=et.workerId;if(!supportsWorkers())return defineMainThreadModule(et);nt==null&&(nt="#default");var rt="workerModule"+ ++_workerModuleId,it=et.name||rt,st=null;_=_&&_.map(function(at){return typeof at=="function"&&!at.workerModuleData&&(_allowInitAsString=!0,at=defineWorkerModule({workerId:nt,name:"<"+it+"> function dependency: "+at.name,init:`function(){return (
`+stringifyFunction(at)+`
)}`}),_allowInitAsString=!1),at&&at.workerModuleData&&(at=at.workerModuleData),at});function ot(){for(var at=[],lt=arguments.length;lt--;)at[lt]=arguments[lt];if(!st){st=callWorker(nt,"registerModule",ot.workerModuleData);var ct=function(){st=null,registeredModules[nt].delete(ct)};(registeredModules[nt]||(registeredModules[nt]=new Set)).add(ct)}return st.then(function(ht){var ut=ht.isCallable;if(ut)return callWorker(nt,"callModule",{id:rt,args:at});throw new Error("Worker module function was called but `init` did not return a callable function")})}return ot.workerModuleData={isWorkerModule:!0,id:rt,name:it,dependencies:_,init:stringifyFunction(_e),getTransferables:tt&&stringifyFunction(tt)},ot}function terminateWorker(et){registeredModules[et]&&registeredModules[et].forEach(function(_){_()}),workers[et]&&(workers[et].terminate(),delete workers[et])}function stringifyFunction(et){var _=et.toString();return!/^function/.test(_)&&/^\w+\s*\(/.test(_)&&(_="function "+_),_}function getWorker(et){var _=workers[et];if(!_){var _e=stringifyFunction(workerBootstrap);_=workers[et]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+et.replace(/\*/g,"")+` **/

;(`+_e+")()"],{type:"application/javascript"}))),_.onmessage=function(tt){var nt=tt.data,rt=nt.messageId,it=openRequests[rt];if(!it)throw new Error("WorkerModule response with empty or unknown messageId");delete openRequests[rt],it(nt)}}return _}function callWorker(et,_,_e){return new Promise(function(tt,nt){var rt=++_messageId;openRequests[rt]=function(it){it.success?tt(it.result):nt(new Error("Error in worker "+_+" call: "+it.error))},getWorker(et).postMessage({messageId:rt,action:_,data:_e})})}function SDFGenerator(){var et=function(_){function _e(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt){var Qt=1-Xt;Zt.x=Qt*Qt*Ot+2*Qt*Xt*zt+Xt*Xt*qt,Zt.y=Qt*Qt*Nt+2*Qt*Xt*Ht+Xt*Xt*Gt}function tt(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,Qt,un){var wn=1-Qt;un.x=wn*wn*wn*Ot+3*wn*wn*Qt*zt+3*wn*Qt*Qt*qt+Qt*Qt*Qt*Xt,un.y=wn*wn*wn*Nt+3*wn*wn*Qt*Ht+3*wn*Qt*Qt*Gt+Qt*Qt*Qt*Zt}function nt(Ot,Nt){for(var zt=/([MLQCZ])([^MLQCZ]*)/g,Ht,qt,Gt,Xt,Zt;Ht=zt.exec(Ot);){var Qt=Ht[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(un){return parseFloat(un)});switch(Ht[1]){case"M":Xt=qt=Qt[0],Zt=Gt=Qt[1];break;case"L":(Qt[0]!==Xt||Qt[1]!==Zt)&&Nt("L",Xt,Zt,Xt=Qt[0],Zt=Qt[1]);break;case"Q":{Nt("Q",Xt,Zt,Xt=Qt[2],Zt=Qt[3],Qt[0],Qt[1]);break}case"C":{Nt("C",Xt,Zt,Xt=Qt[4],Zt=Qt[5],Qt[0],Qt[1],Qt[2],Qt[3]);break}case"Z":(Xt!==qt||Zt!==Gt)&&Nt("L",Xt,Zt,qt,Gt);break}}}function rt(Ot,Nt,zt){zt===void 0&&(zt=16);var Ht={x:0,y:0};nt(Ot,function(qt,Gt,Xt,Zt,Qt,un,wn,Tn,yn){switch(qt){case"L":Nt(Gt,Xt,Zt,Qt);break;case"Q":{for(var Vt=Gt,fn=Xt,ln=1;ln<zt;ln++)_e(Gt,Xt,un,wn,Zt,Qt,ln/(zt-1),Ht),Nt(Vt,fn,Ht.x,Ht.y),Vt=Ht.x,fn=Ht.y;break}case"C":{for(var Jt=Gt,on=Xt,_n=1;_n<zt;_n++)tt(Gt,Xt,un,wn,Tn,yn,Zt,Qt,_n/(zt-1),Ht),Nt(Jt,on,Ht.x,Ht.y),Jt=Ht.x,on=Ht.y;break}}})}var it="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",st="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",ot=new WeakMap,at={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function lt(Ot,Nt){var zt=Ot.getContext?Ot.getContext("webgl",at):Ot,Ht=ot.get(zt);if(!Ht){let wn=function(Jt){var on=Gt[Jt];if(!on&&(on=Gt[Jt]=zt.getExtension(Jt),!on))throw new Error(Jt+" not supported");return on},Tn=function(Jt,on){var _n=zt.createShader(on);return zt.shaderSource(_n,Jt),zt.compileShader(_n),_n},yn=function(Jt,on,_n,cn){if(!Xt[Jt]){var tn={},Wt={},Bt=zt.createProgram();zt.attachShader(Bt,Tn(on,zt.VERTEX_SHADER)),zt.attachShader(Bt,Tn(_n,zt.FRAGMENT_SHADER)),zt.linkProgram(Bt),Xt[Jt]={program:Bt,transaction:function(en){zt.useProgram(Bt),en({setUniform:function(sn,xn){for(var an=[],pn=arguments.length-2;pn-- >0;)an[pn]=arguments[pn+2];var Sn=Wt[xn]||(Wt[xn]=zt.getUniformLocation(Bt,xn));zt["uniform"+sn].apply(zt,[Sn].concat(an))},setAttribute:function(sn,xn,an,pn,Sn){var gn=tn[sn];gn||(gn=tn[sn]={buf:zt.createBuffer(),loc:zt.getAttribLocation(Bt,sn),data:null}),zt.bindBuffer(zt.ARRAY_BUFFER,gn.buf),zt.vertexAttribPointer(gn.loc,xn,zt.FLOAT,!1,0,0),zt.enableVertexAttribArray(gn.loc),qt?zt.vertexAttribDivisor(gn.loc,pn):wn("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(gn.loc,pn),Sn!==gn.data&&(zt.bufferData(zt.ARRAY_BUFFER,Sn,an),gn.data=Sn)}})}}}Xt[Jt].transaction(cn)},Vt=function(Jt,on){Qt++;try{zt.activeTexture(zt.TEXTURE0+Qt);var _n=Zt[Jt];_n||(_n=Zt[Jt]=zt.createTexture(),zt.bindTexture(zt.TEXTURE_2D,_n),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MIN_FILTER,zt.NEAREST),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MAG_FILTER,zt.NEAREST)),zt.bindTexture(zt.TEXTURE_2D,_n),on(_n,Qt)}finally{Qt--}},fn=function(Jt,on,_n){var cn=zt.createFramebuffer();un.push(cn),zt.bindFramebuffer(zt.FRAMEBUFFER,cn),zt.activeTexture(zt.TEXTURE0+on),zt.bindTexture(zt.TEXTURE_2D,Jt),zt.framebufferTexture2D(zt.FRAMEBUFFER,zt.COLOR_ATTACHMENT0,zt.TEXTURE_2D,Jt,0);try{_n(cn)}finally{zt.deleteFramebuffer(cn),zt.bindFramebuffer(zt.FRAMEBUFFER,un[--un.length-1]||null)}},ln=function(){Gt={},Xt={},Zt={},Qt=-1,un.length=0};var qt=typeof WebGL2RenderingContext<"u"&&zt instanceof WebGL2RenderingContext,Gt={},Xt={},Zt={},Qt=-1,un=[];zt.canvas.addEventListener("webglcontextlost",function(Jt){ln(),Jt.preventDefault()},!1),ot.set(zt,Ht={gl:zt,isWebGL2:qt,getExtension:wn,withProgram:yn,withTexture:Vt,withTextureFramebuffer:fn,handleContextLoss:ln})}Nt(Ht)}function ct(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt){Xt===void 0&&(Xt=15),Zt===void 0&&(Zt=null),lt(Ot,function(Qt){var un=Qt.gl,wn=Qt.withProgram,Tn=Qt.withTexture;Tn("copy",function(yn,Vt){un.texImage2D(un.TEXTURE_2D,0,un.RGBA,qt,Gt,0,un.RGBA,un.UNSIGNED_BYTE,Nt),wn("copy",it,st,function(fn){var ln=fn.setUniform,Jt=fn.setAttribute;Jt("aUV",2,un.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ln("1i","image",Vt),un.bindFramebuffer(un.FRAMEBUFFER,Zt||null),un.disable(un.BLEND),un.colorMask(Xt&8,Xt&4,Xt&2,Xt&1),un.viewport(zt,Ht,qt,Gt),un.scissor(zt,Ht,qt,Gt),un.drawArrays(un.TRIANGLES,0,3)})})})}function ht(Ot,Nt,zt){var Ht=Ot.width,qt=Ot.height;lt(Ot,function(Gt){var Xt=Gt.gl,Zt=new Uint8Array(Ht*qt*4);Xt.readPixels(0,0,Ht,qt,Xt.RGBA,Xt.UNSIGNED_BYTE,Zt),Ot.width=Nt,Ot.height=zt,ct(Xt,Zt,0,0,Ht,qt)})}var ut=Object.freeze({__proto__:null,withWebGLContext:lt,renderImageData:ct,resizeWebGLCanvasWithoutClearing:ht});function ft(Ot,Nt,zt,Ht,qt,Gt){Gt===void 0&&(Gt=1);var Xt=new Uint8Array(Ot*Nt),Zt=Ht[2]-Ht[0],Qt=Ht[3]-Ht[1],un=[];rt(zt,function(Jt,on,_n,cn){un.push({x1:Jt,y1:on,x2:_n,y2:cn,minX:Math.min(Jt,_n),minY:Math.min(on,cn),maxX:Math.max(Jt,_n),maxY:Math.max(on,cn)})}),un.sort(function(Jt,on){return Jt.maxX-on.maxX});for(var wn=0;wn<Ot;wn++)for(var Tn=0;Tn<Nt;Tn++){var yn=fn(Ht[0]+Zt*(wn+.5)/Ot,Ht[1]+Qt*(Tn+.5)/Nt),Vt=Math.pow(1-Math.abs(yn)/qt,Gt)/2;yn<0&&(Vt=1-Vt),Vt=Math.max(0,Math.min(255,Math.round(Vt*255))),Xt[Tn*Ot+wn]=Vt}return Xt;function fn(Jt,on){for(var _n=1/0,cn=1/0,tn=un.length;tn--;){var Wt=un[tn];if(Wt.maxX+cn<=Jt)break;if(Jt+cn>Wt.minX&&on-cn<Wt.maxY&&on+cn>Wt.minY){var Bt=mt(Jt,on,Wt.x1,Wt.y1,Wt.x2,Wt.y2);Bt<_n&&(_n=Bt,cn=Math.sqrt(_n))}}return ln(Jt,on)&&(cn=-cn),cn}function ln(Jt,on){for(var _n=0,cn=un.length;cn--;){var tn=un[cn];if(tn.maxX<=Jt)break;var Wt=tn.y1>on!=tn.y2>on&&Jt<(tn.x2-tn.x1)*(on-tn.y1)/(tn.y2-tn.y1)+tn.x1;Wt&&(_n+=tn.y1<tn.y2?1:-1)}return _n!==0}}function dt(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,Qt,un){Gt===void 0&&(Gt=1),Zt===void 0&&(Zt=0),Qt===void 0&&(Qt=0),un===void 0&&(un=0),pt(Ot,Nt,zt,Ht,qt,Gt,Xt,null,Zt,Qt,un)}function pt(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,Qt,un,wn){Gt===void 0&&(Gt=1),Qt===void 0&&(Qt=0),un===void 0&&(un=0),wn===void 0&&(wn=0);for(var Tn=ft(Ot,Nt,zt,Ht,qt,Gt),yn=new Uint8Array(Tn.length*4),Vt=0;Vt<Tn.length;Vt++)yn[Vt*4+wn]=Tn[Vt];ct(Xt,yn,Qt,un,Ot,Nt,1<<3-wn,Zt)}function mt(Ot,Nt,zt,Ht,qt,Gt){var Xt=qt-zt,Zt=Gt-Ht,Qt=Xt*Xt+Zt*Zt,un=Qt?Math.max(0,Math.min(1,((Ot-zt)*Xt+(Nt-Ht)*Zt)/Qt)):0,wn=Ot-(zt+un*Xt),Tn=Nt-(Ht+un*Zt);return wn*wn+Tn*Tn}var vt=Object.freeze({__proto__:null,generate:ft,generateIntoCanvas:dt,generateIntoFramebuffer:pt}),yt="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",_t="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",St="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",bt=new Float32Array([0,0,2,0,0,2]),Et=null,Mt=!1,Tt={},wt=new WeakMap;function Ct(Ot){if(!Mt&&!Ft(Ot))throw new Error("WebGL generation not supported")}function Rt(Ot,Nt,zt,Ht,qt,Gt,Xt){if(Gt===void 0&&(Gt=1),Xt===void 0&&(Xt=null),!Xt&&(Xt=Et,!Xt)){var Zt=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Zt)throw new Error("OffscreenCanvas or DOM canvas not supported");Xt=Et=Zt.getContext("webgl",{depth:!1})}Ct(Xt);var Qt=new Uint8Array(Ot*Nt*4);lt(Xt,function(yn){var Vt=yn.gl,fn=yn.withTexture,ln=yn.withTextureFramebuffer;fn("readable",function(Jt,on){Vt.texImage2D(Vt.TEXTURE_2D,0,Vt.RGBA,Ot,Nt,0,Vt.RGBA,Vt.UNSIGNED_BYTE,null),ln(Jt,on,function(_n){Dt(Ot,Nt,zt,Ht,qt,Gt,Vt,_n,0,0,0),Vt.readPixels(0,0,Ot,Nt,Vt.RGBA,Vt.UNSIGNED_BYTE,Qt)})})});for(var un=new Uint8Array(Ot*Nt),wn=0,Tn=0;wn<Qt.length;wn+=4)un[Tn++]=Qt[wn];return un}function It(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,Qt,un){Gt===void 0&&(Gt=1),Zt===void 0&&(Zt=0),Qt===void 0&&(Qt=0),un===void 0&&(un=0),Dt(Ot,Nt,zt,Ht,qt,Gt,Xt,null,Zt,Qt,un)}function Dt(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,Qt,un,wn){Gt===void 0&&(Gt=1),Qt===void 0&&(Qt=0),un===void 0&&(un=0),wn===void 0&&(wn=0),Ct(Xt);var Tn=[];rt(zt,function(yn,Vt,fn,ln){Tn.push(yn,Vt,fn,ln)}),Tn=new Float32Array(Tn),lt(Xt,function(yn){var Vt=yn.gl,fn=yn.isWebGL2,ln=yn.getExtension,Jt=yn.withProgram,on=yn.withTexture,_n=yn.withTextureFramebuffer,cn=yn.handleContextLoss;if(on("rawDistances",function(tn,Wt){(Ot!==tn._lastWidth||Nt!==tn._lastHeight)&&Vt.texImage2D(Vt.TEXTURE_2D,0,Vt.RGBA,tn._lastWidth=Ot,tn._lastHeight=Nt,0,Vt.RGBA,Vt.UNSIGNED_BYTE,null),Jt("main",yt,_t,function(Bt){var nn=Bt.setAttribute,en=Bt.setUniform,mn=!fn&&ln("ANGLE_instanced_arrays"),sn=!fn&&ln("EXT_blend_minmax");nn("aUV",2,Vt.STATIC_DRAW,0,bt),nn("aLineSegment",4,Vt.DYNAMIC_DRAW,1,Tn),en.apply(void 0,["4f","uGlyphBounds"].concat(Ht)),en("1f","uMaxDistance",qt),en("1f","uExponent",Gt),_n(tn,Wt,function(xn){Vt.enable(Vt.BLEND),Vt.colorMask(!0,!0,!0,!0),Vt.viewport(0,0,Ot,Nt),Vt.scissor(0,0,Ot,Nt),Vt.blendFunc(Vt.ONE,Vt.ONE),Vt.blendEquationSeparate(Vt.FUNC_ADD,fn?Vt.MAX:sn.MAX_EXT),Vt.clear(Vt.COLOR_BUFFER_BIT),fn?Vt.drawArraysInstanced(Vt.TRIANGLES,0,3,Tn.length/4):mn.drawArraysInstancedANGLE(Vt.TRIANGLES,0,3,Tn.length/4)})}),Jt("post",it,St,function(Bt){Bt.setAttribute("aUV",2,Vt.STATIC_DRAW,0,bt),Bt.setUniform("1i","tex",Wt),Vt.bindFramebuffer(Vt.FRAMEBUFFER,Zt),Vt.disable(Vt.BLEND),Vt.colorMask(wn===0,wn===1,wn===2,wn===3),Vt.viewport(Qt,un,Ot,Nt),Vt.scissor(Qt,un,Ot,Nt),Vt.drawArrays(Vt.TRIANGLES,0,3)})}),Vt.isContextLost())throw cn(),new Error("webgl context lost")})}function Ft(Ot){var Nt=!Ot||Ot===Et?Tt:Ot.canvas||Ot,zt=wt.get(Nt);if(zt===void 0){Mt=!0;var Ht=null;try{var qt=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Gt=Rt(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,Ot);zt=Gt&&qt.length===Gt.length&&Gt.every(function(Xt,Zt){return Xt===qt[Zt]}),zt||(Ht="bad trial run results",console.info(qt,Gt))}catch(Xt){zt=!1,Ht=Xt.message}Ht&&console.warn("WebGL SDF generation not supported:",Ht),Mt=!1,wt.set(Nt,zt)}return zt}var $t=Object.freeze({__proto__:null,generate:Rt,generateIntoCanvas:It,generateIntoFramebuffer:Dt,isSupported:Ft});function Yt(Ot,Nt,zt,Ht,qt,Gt){qt===void 0&&(qt=Math.max(Ht[2]-Ht[0],Ht[3]-Ht[1])/2),Gt===void 0&&(Gt=1);try{return Rt.apply($t,arguments)}catch(Xt){return console.info("WebGL SDF generation failed, falling back to JS",Xt),ft.apply(vt,arguments)}}function Lt(Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,Qt,un){qt===void 0&&(qt=Math.max(Ht[2]-Ht[0],Ht[3]-Ht[1])/2),Gt===void 0&&(Gt=1),Zt===void 0&&(Zt=0),Qt===void 0&&(Qt=0),un===void 0&&(un=0);try{return It.apply($t,arguments)}catch(wn){return console.info("WebGL SDF generation failed, falling back to JS",wn),dt.apply(vt,arguments)}}return _.forEachPathCommand=nt,_.generate=Yt,_.generateIntoCanvas=Lt,_.javascript=vt,_.pathToLineSegments=rt,_.webgl=$t,_.webglUtils=ut,Object.defineProperty(_,"__esModule",{value:!0}),_}({});return et}function bidiFactory(){var et=function(_){var _e={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},tt={},nt={};tt.L=1,nt[1]="L",Object.keys(_e).forEach(function(cn,tn){tt[cn]=1<<tn+1,nt[tt[cn]]=cn}),Object.freeze(tt);var rt=tt.LRI|tt.RLI|tt.FSI,it=tt.L|tt.R|tt.AL,st=tt.B|tt.S|tt.WS|tt.ON|tt.FSI|tt.LRI|tt.RLI|tt.PDI,ot=tt.BN|tt.RLE|tt.LRE|tt.RLO|tt.LRO|tt.PDF,at=tt.S|tt.WS|tt.B|rt|tt.PDI|ot,lt=null;function ct(){if(!lt){lt=new Map;var cn=function(Wt){if(_e.hasOwnProperty(Wt)){var Bt=0;_e[Wt].split(",").forEach(function(nn){var en=nn.split("+"),mn=en[0],sn=en[1];mn=parseInt(mn,36),sn=sn?parseInt(sn,36):0,lt.set(Bt+=mn,tt[Wt]);for(var xn=0;xn<sn;xn++)lt.set(++Bt,tt[Wt])})}};for(var tn in _e)cn(tn)}}function ht(cn){return ct(),lt.get(cn.codePointAt(0))||tt.L}function ut(cn){return nt[ht(cn)]}var ft={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function dt(cn,tn){var Wt=36,Bt=0,nn=new Map,en=tn&&new Map,mn;return cn.split(",").forEach(function sn(xn){if(xn.indexOf("+")!==-1)for(var an=+xn;an--;)sn(mn);else{mn=xn;var pn=xn.split(">"),Sn=pn[0],gn=pn[1];Sn=String.fromCodePoint(Bt+=parseInt(Sn,Wt)),gn=String.fromCodePoint(Bt+=parseInt(gn,Wt)),nn.set(Sn,gn),tn&&en.set(gn,Sn)}}),{map:nn,reverseMap:en}}var pt,mt,vt;function yt(){if(!pt){var cn=dt(ft.pairs,!0),tn=cn.map,Wt=cn.reverseMap;pt=tn,mt=Wt,vt=dt(ft.canonical,!1).map}}function _t(cn){return yt(),pt.get(cn)||null}function St(cn){return yt(),mt.get(cn)||null}function bt(cn){return yt(),vt.get(cn)||null}var Et=tt.L,Mt=tt.R,Tt=tt.EN,wt=tt.ES,Ct=tt.ET,Rt=tt.AN,It=tt.CS,Dt=tt.B,Ft=tt.S,$t=tt.ON,Yt=tt.BN,Lt=tt.NSM,Ot=tt.AL,Nt=tt.LRO,zt=tt.RLO,Ht=tt.LRE,qt=tt.RLE,Gt=tt.PDF,Xt=tt.LRI,Zt=tt.RLI,Qt=tt.FSI,un=tt.PDI;function wn(cn,tn){for(var Wt=125,Bt=new Uint32Array(cn.length),nn=0;nn<cn.length;nn++)Bt[nn]=ht(cn[nn]);var en=new Map;function mn(ts,vs){var Xr=Bt[ts];Bt[ts]=vs,en.set(Xr,en.get(Xr)-1),Xr&st&&en.set(st,en.get(st)-1),en.set(vs,(en.get(vs)||0)+1),vs&st&&en.set(st,(en.get(st)||0)+1)}for(var sn=new Uint8Array(cn.length),xn=new Map,an=[],pn=null,Sn=0;Sn<cn.length;Sn++)pn||an.push(pn={start:Sn,end:cn.length-1,level:tn==="rtl"?1:tn==="ltr"?0:Go(Sn,!1)}),Bt[Sn]&Dt&&(pn.end=Sn,pn=null);for(var gn=qt|Ht|zt|Nt|rt|un|Gt|Dt,Rn=function(ts){return ts+(ts&1?1:2)},Mn=function(ts){return ts+(ts&1?2:1)},kn=0;kn<an.length;kn++){pn=an[kn];var Fn=[{_level:pn.level,_override:0,_isolate:0}],Nn=void 0,Zn=0,er=0,dn=0;en.clear();for(var $n=pn.start;$n<=pn.end;$n++){var Pn=Bt[$n];if(Nn=Fn[Fn.length-1],en.set(Pn,(en.get(Pn)||0)+1),Pn&st&&en.set(st,(en.get(st)||0)+1),Pn&gn)if(Pn&(qt|Ht)){sn[$n]=Nn._level;var Dn=(Pn===qt?Mn:Rn)(Nn._level);Dn<=Wt&&!Zn&&!er?Fn.push({_level:Dn,_override:0,_isolate:0}):Zn||er++}else if(Pn&(zt|Nt)){sn[$n]=Nn._level;var Hn=(Pn===zt?Mn:Rn)(Nn._level);Hn<=Wt&&!Zn&&!er?Fn.push({_level:Hn,_override:Pn&zt?Mt:Et,_isolate:0}):Zn||er++}else if(Pn&rt){Pn&Qt&&(Pn=Go($n+1,!0)===1?Zt:Xt),sn[$n]=Nn._level,Nn._override&&mn($n,Nn._override);var jn=(Pn===Zt?Mn:Rn)(Nn._level);jn<=Wt&&Zn===0&&er===0?(dn++,Fn.push({_level:jn,_override:0,_isolate:1,_isolInitIndex:$n})):Zn++}else if(Pn&un){if(Zn>0)Zn--;else if(dn>0){for(er=0;!Fn[Fn.length-1]._isolate;)Fn.pop();var qn=Fn[Fn.length-1]._isolInitIndex;qn!=null&&(xn.set(qn,$n),xn.set($n,qn)),Fn.pop(),dn--}Nn=Fn[Fn.length-1],sn[$n]=Nn._level,Nn._override&&mn($n,Nn._override)}else Pn&Gt?(Zn===0&&(er>0?er--:!Nn._isolate&&Fn.length>1&&(Fn.pop(),Nn=Fn[Fn.length-1])),sn[$n]=Nn._level):Pn&Dt&&(sn[$n]=pn.level);else sn[$n]=Nn._level,Nn._override&&Pn!==Yt&&mn($n,Nn._override)}for(var hr=[],fr=null,jt=pn.start;jt<=pn.end;jt++){var hn=Bt[jt];if(!(hn&ot)){var En=sn[jt],Vn=hn&rt,Gn=hn===un;fr&&En===fr._level?(fr._end=jt,fr._endsWithIsolInit=Vn):hr.push(fr={_start:jt,_end:jt,_level:En,_startsWithPDI:Gn,_endsWithIsolInit:Vn})}}for(var Kn=[],br=0;br<hr.length;br++){var gr=hr[br];if(!gr._startsWithPDI||gr._startsWithPDI&&!xn.has(gr._start)){for(var Er=[fr=gr],Tr=void 0;fr&&fr._endsWithIsolInit&&(Tr=xn.get(fr._end))!=null;)for(var zr=br+1;zr<hr.length;zr++)if(hr[zr]._start===Tr){Er.push(fr=hr[zr]);break}for(var wr=[],Wr=0;Wr<Er.length;Wr++)for(var Ur=Er[Wr],Qr=Ur._start;Qr<=Ur._end;Qr++)wr.push(Qr);for(var $r=sn[wr[0]],Kt=pn.level,vn=wr[0]-1;vn>=0;vn--)if(!(Bt[vn]&ot)){Kt=sn[vn];break}var In=wr[wr.length-1],Ln=sn[In],Cn=pn.level;if(!(Bt[In]&rt)){for(var Wn=In+1;Wn<=pn.end;Wn++)if(!(Bt[Wn]&ot)){Cn=sn[Wn];break}}Kn.push({_seqIndices:wr,_sosType:Math.max(Kt,$r)%2?Mt:Et,_eosType:Math.max(Cn,Ln)%2?Mt:Et})}}for(var Qn=0;Qn<Kn.length;Qn++){var rr=Kn[Qn],zn=rr._seqIndices,ar=rr._sosType,dr=rr._eosType,sr=sn[zn[0]]&1?Mt:Et;if(en.get(Lt))for(var Mr=0;Mr<zn.length;Mr++){var Dr=zn[Mr];if(Bt[Dr]&Lt){for(var Ar=ar,Lr=Mr-1;Lr>=0;Lr--)if(!(Bt[zn[Lr]]&ot)){Ar=Bt[zn[Lr]];break}mn(Dr,Ar&(rt|un)?$t:Ar)}}if(en.get(Tt))for(var or=0;or<zn.length;or++){var Yn=zn[or];if(Bt[Yn]&Tt)for(var Ir=or-1;Ir>=-1;Ir--){var mr=Ir===-1?ar:Bt[zn[Ir]];if(mr&it){mr===Ot&&mn(Yn,Rt);break}}}if(en.get(Ot))for(var kr=0;kr<zn.length;kr++){var ss=zn[kr];Bt[ss]&Ot&&mn(ss,Mt)}if(en.get(wt)||en.get(It))for(var Fr=1;Fr<zn.length-1;Fr++){var Gr=zn[Fr];if(Bt[Gr]&(wt|It)){for(var Cr=0,ps=0,Ws=Fr-1;Ws>=0&&(Cr=Bt[zn[Ws]],!!(Cr&ot));Ws--);for(var jr=Fr+1;jr<zn.length&&(ps=Bt[zn[jr]],!!(ps&ot));jr++);Cr===ps&&(Bt[Gr]===wt?Cr===Tt:Cr&(Tt|Rt))&&mn(Gr,Cr)}}if(en.get(Tt))for(var as=0;as<zn.length;as++){var ms=zn[as];if(Bt[ms]&Tt){for(var Js=as-1;Js>=0&&Bt[zn[Js]]&(Ct|ot);Js--)mn(zn[Js],Tt);for(as++;as<zn.length&&Bt[zn[as]]&(Ct|ot|Tt);as++)Bt[zn[as]]!==Tt&&mn(zn[as],Tt)}}if(en.get(Ct)||en.get(wt)||en.get(It))for(var So=0;So<zn.length;So++){var Gl=zn[So];if(Bt[Gl]&(Ct|wt|It)){mn(Gl,$t);for(var eo=So-1;eo>=0&&Bt[zn[eo]]&ot;eo--)mn(zn[eo],$t);for(var to=So+1;to<zn.length&&Bt[zn[to]]&ot;to++)mn(zn[to],$t)}}if(en.get(Tt))for(var no=0,bo=ar;no<zn.length;no++){var Hl=zn[no],ga=Bt[Hl];ga&Tt?bo===Et&&mn(Hl,Et):ga&it&&(bo=ga)}if(en.get(st)){var ro=Mt|Tt|Rt,Vo=ro|Et,js=[];{for(var uo=[],Xs=0;Xs<zn.length;Xs++)if(Bt[zn[Xs]]&st){var Sr=cn[zn[Xs]],xa=void 0;if(_t(Sr)!==null)if(uo.length<63)uo.push({char:Sr,seqIndex:Xs});else break;else if((xa=St(Sr))!==null)for(var io=uo.length-1;io>=0;io--){var zo=uo[io].char;if(zo===xa||zo===St(bt(Sr))||_t(bt(zo))===Sr){js.push([uo[io].seqIndex,Xs]),uo.length=io;break}}}js.sort(function(ts,vs){return ts[0]-vs[0]})}for(var ba=0;ba<js.length;ba++){for(var Wl=js[ba],Or=Wl[0],Mo=Wl[1],Xl=!1,gs=0,$a=Or+1;$a<Mo;$a++){var Eo=zn[$a];if(Bt[Eo]&Vo){Xl=!0;var Ts=Bt[Eo]&ro?Mt:Et;if(Ts===sr){gs=Ts;break}}}if(Xl&&!gs){gs=ar;for(var xl=Or-1;xl>=0;xl--){var Yl=zn[xl];if(Bt[Yl]&Vo){var As=Bt[Yl]&ro?Mt:Et;As!==sr?gs=As:gs=sr;break}}}if(gs){if(Bt[zn[Or]]=Bt[zn[Mo]]=gs,gs!==sr){for(var xs=Or+1;xs<zn.length;xs++)if(!(Bt[zn[xs]]&ot)){ht(cn[zn[xs]])&Lt&&(Bt[zn[xs]]=gs);break}}if(gs!==sr){for(var Ys=Mo+1;Ys<zn.length;Ys++)if(!(Bt[zn[Ys]]&ot)){ht(cn[zn[Ys]])&Lt&&(Bt[zn[Ys]]=gs);break}}}}for(var Ls=0;Ls<zn.length;Ls++)if(Bt[zn[Ls]]&st){for(var yl=Ls,_l=Ls,Ss=ar,To=Ls-1;To>=0;To--)if(Bt[zn[To]]&ot)yl=To;else{Ss=Bt[zn[To]]&ro?Mt:Et;break}for(var Ao=dr,Co=Ls+1;Co<zn.length;Co++)if(Bt[zn[Co]]&(st|ot))_l=Co;else{Ao=Bt[zn[Co]]&ro?Mt:Et;break}for(var ys=yl;ys<=_l;ys++)Bt[zn[ys]]=Ss===Ao?Ss:sr;Ls=_l}}}for(var es=pn.start;es<=pn.end;es++){var $o=sn[es],$s=Bt[es];if($o&1?$s&(Et|Tt|Rt)&&sn[es]++:$s&Mt?sn[es]++:$s&(Rt|Tt)&&(sn[es]+=2),$s&ot&&(sn[es]=es===0?pn.level:sn[es-1]),es===pn.end||ht(cn[es])&(Ft|Dt))for(var ho=es;ho>=0&&ht(cn[ho])&at;ho--)sn[ho]=pn.level}}return{levels:sn,paragraphs:an};function Go(ts,vs){for(var Xr=ts;Xr<cn.length;Xr++){var Yr=Bt[Xr];if(Yr&(Mt|Ot))return 1;if(Yr&(Dt|Et)||vs&&Yr===un)return 0;if(Yr&rt){var Cs=Kl(Xr);Xr=Cs===-1?cn.length:Cs}}return 0}function Kl(ts){for(var vs=1,Xr=ts+1;Xr<cn.length;Xr++){var Yr=Bt[Xr];if(Yr&Dt)break;if(Yr&un){if(--vs===0)return Xr}else Yr&rt&&vs++}return-1}}var Tn="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",yn;function Vt(){if(!yn){var cn=dt(Tn,!0),tn=cn.map,Wt=cn.reverseMap;Wt.forEach(function(Bt,nn){tn.set(nn,Bt)}),yn=tn}}function fn(cn){return Vt(),yn.get(cn)||null}function ln(cn,tn,Wt,Bt){var nn=cn.length;Wt=Math.max(0,Wt==null?0:+Wt),Bt=Math.min(nn-1,Bt==null?nn-1:+Bt);for(var en=new Map,mn=Wt;mn<=Bt;mn++)if(tn[mn]&1){var sn=fn(cn[mn]);sn!==null&&en.set(mn,sn)}return en}function Jt(cn,tn,Wt,Bt){var nn=cn.length;Wt=Math.max(0,Wt==null?0:+Wt),Bt=Math.min(nn-1,Bt==null?nn-1:+Bt);var en=[];return tn.paragraphs.forEach(function(mn){var sn=Math.max(Wt,mn.start),xn=Math.min(Bt,mn.end);if(sn<xn){for(var an=tn.levels.slice(sn,xn+1),pn=xn;pn>=sn&&ht(cn[pn])&at;pn--)an[pn]=mn.level;for(var Sn=mn.level,gn=1/0,Rn=0;Rn<an.length;Rn++){var Mn=an[Rn];Mn>Sn&&(Sn=Mn),Mn<gn&&(gn=Mn|1)}for(var kn=Sn;kn>=gn;kn--)for(var Fn=0;Fn<an.length;Fn++)if(an[Fn]>=kn){for(var Nn=Fn;Fn+1<an.length&&an[Fn+1]>=kn;)Fn++;Fn>Nn&&en.push([Nn+sn,Fn+sn])}}}),en}function on(cn,tn,Wt,Bt){var nn=_n(cn,tn,Wt,Bt),en=[].concat(cn);return nn.forEach(function(mn,sn){en[sn]=(tn.levels[mn]&1?fn(cn[mn]):null)||cn[mn]}),en.join("")}function _n(cn,tn,Wt,Bt){for(var nn=Jt(cn,tn,Wt,Bt),en=[],mn=0;mn<cn.length;mn++)en[mn]=mn;return nn.forEach(function(sn){for(var xn=sn[0],an=sn[1],pn=en.slice(xn,an+1),Sn=pn.length;Sn--;)en[an-Sn]=pn[Sn]}),en}return _.closingToOpeningBracket=St,_.getBidiCharType=ht,_.getBidiCharTypeName=ut,_.getCanonicalBracket=bt,_.getEmbeddingLevels=wn,_.getMirroredCharacter=fn,_.getMirroredCharactersMap=ln,_.getReorderSegments=Jt,_.getReorderedIndices=_n,_.getReorderedString=on,_.openingToClosingBracket=_t,Object.defineProperty(_,"__esModule",{value:!0}),_}({});return et}const voidMainRegExp=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(et){const _=/^[ \t]*#include +<([\w\d./]+)>/gm;function _e(tt,nt){let rt=ShaderChunk[nt];return rt?expandShaderIncludes(rt):tt}return et.replace(_,_e)}const _lut=[];for(let et=0;et<256;et++)_lut[et]=(et<16?"0":"")+et.toString(16);function generateUUID(){const et=Math.random()*4294967295|0,_=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,tt=Math.random()*4294967295|0;return(_lut[et&255]+_lut[et>>8&255]+_lut[et>>16&255]+_lut[et>>24&255]+"-"+_lut[_&255]+_lut[_>>8&255]+"-"+_lut[_>>16&15|64]+_lut[_>>24&255]+"-"+_lut[_e&63|128]+_lut[_e>>8&255]+"-"+_lut[_e>>16&255]+_lut[_e>>24&255]+_lut[tt&255]+_lut[tt>>8&255]+_lut[tt>>16&255]+_lut[tt>>24&255]).toUpperCase()}const assign$2=Object.assign||function(){let et=arguments[0];for(let _=1,_e=arguments.length;_<_e;_++){let tt=arguments[_];if(tt)for(let nt in tt)Object.prototype.hasOwnProperty.call(tt,nt)&&(et[nt]=tt[nt])}return et},epoch=Date.now(),CONSTRUCTOR_CACHE=new WeakMap,SHADER_UPGRADE_CACHE=new Map;let materialInstanceId=1e10;function createDerivedMaterial(et,_){const _e=getKeyForOptions(_);let tt=CONSTRUCTOR_CACHE.get(et);if(tt||CONSTRUCTOR_CACHE.set(et,tt=Object.create(null)),tt[_e])return new tt[_e];const nt=`_onBeforeCompile${_e}`,rt=function(at,lt){et.onBeforeCompile.call(this,at,lt);const ct=this.customProgramCacheKey()+"|"+at.vertexShader+"|"+at.fragmentShader;let ht=SHADER_UPGRADE_CACHE[ct];if(!ht){const ut=upgradeShaders(this,at,_,_e);ht=SHADER_UPGRADE_CACHE[ct]=ut}at.vertexShader=ht.vertexShader,at.fragmentShader=ht.fragmentShader,assign$2(at.uniforms,this.uniforms),_.timeUniform&&(at.uniforms[_.timeUniform]={get value(){return Date.now()-epoch}}),this[nt]&&this[nt](at)},it=function(){return st(_.chained?et:et.clone())},st=function(at){const lt=Object.create(at,ot);return Object.defineProperty(lt,"baseMaterial",{value:et}),Object.defineProperty(lt,"id",{value:materialInstanceId++}),lt.uuid=generateUUID(),lt.uniforms=assign$2({},at.uniforms,_.uniforms),lt.defines=assign$2({},at.defines,_.defines),lt.defines[`TROIKA_DERIVED_MATERIAL_${_e}`]="",lt.extensions=assign$2({},at.extensions,_.extensions),lt._listeners=void 0,lt},ot={constructor:{value:it},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return et.customProgramCacheKey()+"|"+_e}},onBeforeCompile:{get(){return rt},set(at){this[nt]=at}},copy:{writable:!0,configurable:!0,value:function(at){return et.copy.call(this,at),!et.isShaderMaterial&&!et.isDerivedMaterial&&(assign$2(this.extensions,at.extensions),assign$2(this.defines,at.defines),assign$2(this.uniforms,UniformsUtils.clone(at.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const at=new et.constructor;return st(at).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let at=this._depthMaterial;return at||(at=this._depthMaterial=createDerivedMaterial(et.isDerivedMaterial?et.getDepthMaterial():new MeshDepthMaterial({depthPacking:RGBADepthPacking}),_),at.defines.IS_DEPTH_MATERIAL="",at.uniforms=this.uniforms),at}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let at=this._distanceMaterial;return at||(at=this._distanceMaterial=createDerivedMaterial(et.isDerivedMaterial?et.getDistanceMaterial():new MeshDistanceMaterial,_),at.defines.IS_DISTANCE_MATERIAL="",at.uniforms=this.uniforms),at}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:at,_distanceMaterial:lt}=this;at&&at.dispose(),lt&&lt.dispose(),et.dispose.call(this)}}};return tt[_e]=it,new it}function upgradeShaders(et,{vertexShader:_,fragmentShader:_e},tt,nt){let{vertexDefs:rt,vertexMainIntro:it,vertexMainOutro:st,vertexTransform:ot,fragmentDefs:at,fragmentMainIntro:lt,fragmentMainOutro:ct,fragmentColorTransform:ht,customRewriter:ut,timeUniform:ft}=tt;if(rt=rt||"",it=it||"",st=st||"",at=at||"",lt=lt||"",ct=ct||"",(ot||ut)&&(_=expandShaderIncludes(_)),(ht||ut)&&(_e=_e.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),_e=expandShaderIncludes(_e)),ut){let dt=ut({vertexShader:_,fragmentShader:_e});_=dt.vertexShader,_e=dt.fragmentShader}if(ht){let dt=[];_e=_e.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,pt=>(dt.push(pt),"")),ct=`${ht}
${dt.join(`
`)}
${ct}`}if(ft){const dt=`
uniform float ${ft};
`;rt=dt+rt,at=dt+at}return ot&&(_=`vec3 troika_position_${nt};
vec3 troika_normal_${nt};
vec2 troika_uv_${nt};
${_}
`,rt=`${rt}
void troikaVertexTransform${nt}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${ot}
}
`,it=`
troika_position_${nt} = vec3(position);
troika_normal_${nt} = vec3(normal);
troika_uv_${nt} = vec2(uv);
troikaVertexTransform${nt}(troika_position_${nt}, troika_normal_${nt}, troika_uv_${nt});
${it}
`,_=_.replace(/\b(position|normal|uv)\b/g,(dt,pt,mt,vt)=>/\battribute\s+vec[23]\s+$/.test(vt.substr(0,mt))?pt:`troika_${pt}_${nt}`),et.map&&et.map.channel>0||(_=_.replace(/\bMAP_UV\b/g,`troika_uv_${nt}`))),_=injectIntoShaderCode(_,nt,rt,it,st),_e=injectIntoShaderCode(_e,nt,at,lt,ct),{vertexShader:_,fragmentShader:_e}}function injectIntoShaderCode(et,_,_e,tt,nt){return(tt||nt||_e)&&(et=et.replace(voidMainRegExp,`
${_e}
void troikaOrigMain${_}() {`),et+=`
void main() {
  ${tt}
  troikaOrigMain${_}();
  ${nt}
}`),et}function optionsJsonReplacer(et,_){return et==="uniforms"?void 0:typeof _=="function"?_.toString():_}let _idCtr=0;const optionsHashesToIds=new Map;function getKeyForOptions(et){const _=JSON.stringify(et,optionsJsonReplacer);let _e=optionsHashesToIds.get(_);return _e==null&&optionsHashesToIds.set(_,_e=++_idCtr),_e}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function typrFactory(){return typeof window>"u"&&(self.window=self),function(et){var _={parse:function(nt){var rt=_._bin,it=new Uint8Array(nt);if(rt.readASCII(it,0,4)=="ttcf"){var st=4;rt.readUshort(it,st),st+=2,rt.readUshort(it,st),st+=2;var ot=rt.readUint(it,st);st+=4;for(var at=[],lt=0;lt<ot;lt++){var ct=rt.readUint(it,st);st+=4,at.push(_._readFont(it,ct))}return at}return[_._readFont(it,0)]},_readFont:function(nt,rt){var it=_._bin,st=rt;it.readFixed(nt,rt),rt+=4;var ot=it.readUshort(nt,rt);rt+=2,it.readUshort(nt,rt),rt+=2,it.readUshort(nt,rt),rt+=2,it.readUshort(nt,rt),rt+=2;for(var at=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],lt={_data:nt,_offset:st},ct={},ht=0;ht<ot;ht++){var ut=it.readASCII(nt,rt,4);rt+=4,it.readUint(nt,rt),rt+=4;var ft=it.readUint(nt,rt);rt+=4;var dt=it.readUint(nt,rt);rt+=4,ct[ut]={offset:ft,length:dt}}for(ht=0;ht<at.length;ht++){var pt=at[ht];ct[pt]&&(lt[pt.trim()]=_[pt.trim()].parse(nt,ct[pt].offset,ct[pt].length,lt))}return lt},_tabOffset:function(nt,rt,it){for(var st=_._bin,ot=st.readUshort(nt,it+4),at=it+12,lt=0;lt<ot;lt++){var ct=st.readASCII(nt,at,4);at+=4,st.readUint(nt,at),at+=4;var ht=st.readUint(nt,at);if(at+=4,st.readUint(nt,at),at+=4,ct==rt)return ht}return 0}};_._bin={readFixed:function(nt,rt){return(nt[rt]<<8|nt[rt+1])+(nt[rt+2]<<8|nt[rt+3])/65540},readF2dot14:function(nt,rt){return _._bin.readShort(nt,rt)/16384},readInt:function(nt,rt){return _._bin._view(nt).getInt32(rt)},readInt8:function(nt,rt){return _._bin._view(nt).getInt8(rt)},readShort:function(nt,rt){return _._bin._view(nt).getInt16(rt)},readUshort:function(nt,rt){return _._bin._view(nt).getUint16(rt)},readUshorts:function(nt,rt,it){for(var st=[],ot=0;ot<it;ot++)st.push(_._bin.readUshort(nt,rt+2*ot));return st},readUint:function(nt,rt){return _._bin._view(nt).getUint32(rt)},readUint64:function(nt,rt){return 4294967296*_._bin.readUint(nt,rt)+_._bin.readUint(nt,rt+4)},readASCII:function(nt,rt,it){for(var st="",ot=0;ot<it;ot++)st+=String.fromCharCode(nt[rt+ot]);return st},readUnicode:function(nt,rt,it){for(var st="",ot=0;ot<it;ot++){var at=nt[rt++]<<8|nt[rt++];st+=String.fromCharCode(at)}return st},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(nt,rt,it){var st=_._bin._tdec;return st&&rt==0&&it==nt.length?st.decode(nt):_._bin.readASCII(nt,rt,it)},readBytes:function(nt,rt,it){for(var st=[],ot=0;ot<it;ot++)st.push(nt[rt+ot]);return st},readASCIIArray:function(nt,rt,it){for(var st=[],ot=0;ot<it;ot++)st.push(String.fromCharCode(nt[rt+ot]));return st},_view:function(nt){return nt._dataView||(nt._dataView=nt.buffer?new DataView(nt.buffer,nt.byteOffset,nt.byteLength):new DataView(new Uint8Array(nt).buffer))}},_._lctf={},_._lctf.parse=function(nt,rt,it,st,ot){var at=_._bin,lt={},ct=rt;at.readFixed(nt,rt),rt+=4;var ht=at.readUshort(nt,rt);rt+=2;var ut=at.readUshort(nt,rt);rt+=2;var ft=at.readUshort(nt,rt);return rt+=2,lt.scriptList=_._lctf.readScriptList(nt,ct+ht),lt.featureList=_._lctf.readFeatureList(nt,ct+ut),lt.lookupList=_._lctf.readLookupList(nt,ct+ft,ot),lt},_._lctf.readLookupList=function(nt,rt,it){var st=_._bin,ot=rt,at=[],lt=st.readUshort(nt,rt);rt+=2;for(var ct=0;ct<lt;ct++){var ht=st.readUshort(nt,rt);rt+=2;var ut=_._lctf.readLookupTable(nt,ot+ht,it);at.push(ut)}return at},_._lctf.readLookupTable=function(nt,rt,it){var st=_._bin,ot=rt,at={tabs:[]};at.ltype=st.readUshort(nt,rt),rt+=2,at.flag=st.readUshort(nt,rt),rt+=2;var lt=st.readUshort(nt,rt);rt+=2;for(var ct=at.ltype,ht=0;ht<lt;ht++){var ut=st.readUshort(nt,rt);rt+=2;var ft=it(nt,ct,ot+ut,at);at.tabs.push(ft)}return at},_._lctf.numOfOnes=function(nt){for(var rt=0,it=0;it<32;it++)nt>>>it&1&&rt++;return rt},_._lctf.readClassDef=function(nt,rt){var it=_._bin,st=[],ot=it.readUshort(nt,rt);if(rt+=2,ot==1){var at=it.readUshort(nt,rt);rt+=2;var lt=it.readUshort(nt,rt);rt+=2;for(var ct=0;ct<lt;ct++)st.push(at+ct),st.push(at+ct),st.push(it.readUshort(nt,rt)),rt+=2}if(ot==2){var ht=it.readUshort(nt,rt);for(rt+=2,ct=0;ct<ht;ct++)st.push(it.readUshort(nt,rt)),rt+=2,st.push(it.readUshort(nt,rt)),rt+=2,st.push(it.readUshort(nt,rt)),rt+=2}return st},_._lctf.getInterval=function(nt,rt){for(var it=0;it<nt.length;it+=3){var st=nt[it],ot=nt[it+1];if(nt[it+2],st<=rt&&rt<=ot)return it}return-1},_._lctf.readCoverage=function(nt,rt){var it=_._bin,st={};st.fmt=it.readUshort(nt,rt),rt+=2;var ot=it.readUshort(nt,rt);return rt+=2,st.fmt==1&&(st.tab=it.readUshorts(nt,rt,ot)),st.fmt==2&&(st.tab=it.readUshorts(nt,rt,3*ot)),st},_._lctf.coverageIndex=function(nt,rt){var it=nt.tab;if(nt.fmt==1)return it.indexOf(rt);if(nt.fmt==2){var st=_._lctf.getInterval(it,rt);if(st!=-1)return it[st+2]+(rt-it[st])}return-1},_._lctf.readFeatureList=function(nt,rt){var it=_._bin,st=rt,ot=[],at=it.readUshort(nt,rt);rt+=2;for(var lt=0;lt<at;lt++){var ct=it.readASCII(nt,rt,4);rt+=4;var ht=it.readUshort(nt,rt);rt+=2;var ut=_._lctf.readFeatureTable(nt,st+ht);ut.tag=ct.trim(),ot.push(ut)}return ot},_._lctf.readFeatureTable=function(nt,rt){var it=_._bin,st=rt,ot={},at=it.readUshort(nt,rt);rt+=2,at>0&&(ot.featureParams=st+at);var lt=it.readUshort(nt,rt);rt+=2,ot.tab=[];for(var ct=0;ct<lt;ct++)ot.tab.push(it.readUshort(nt,rt+2*ct));return ot},_._lctf.readScriptList=function(nt,rt){var it=_._bin,st=rt,ot={},at=it.readUshort(nt,rt);rt+=2;for(var lt=0;lt<at;lt++){var ct=it.readASCII(nt,rt,4);rt+=4;var ht=it.readUshort(nt,rt);rt+=2,ot[ct.trim()]=_._lctf.readScriptTable(nt,st+ht)}return ot},_._lctf.readScriptTable=function(nt,rt){var it=_._bin,st=rt,ot={},at=it.readUshort(nt,rt);rt+=2,at>0&&(ot.default=_._lctf.readLangSysTable(nt,st+at));var lt=it.readUshort(nt,rt);rt+=2;for(var ct=0;ct<lt;ct++){var ht=it.readASCII(nt,rt,4);rt+=4;var ut=it.readUshort(nt,rt);rt+=2,ot[ht.trim()]=_._lctf.readLangSysTable(nt,st+ut)}return ot},_._lctf.readLangSysTable=function(nt,rt){var it=_._bin,st={};it.readUshort(nt,rt),rt+=2,st.reqFeature=it.readUshort(nt,rt),rt+=2;var ot=it.readUshort(nt,rt);return rt+=2,st.features=it.readUshorts(nt,rt,ot),st},_.CFF={},_.CFF.parse=function(nt,rt,it){var st=_._bin;(nt=new Uint8Array(nt.buffer,rt,it))[rt=0],nt[++rt],nt[++rt],nt[++rt],rt++;var ot=[];rt=_.CFF.readIndex(nt,rt,ot);for(var at=[],lt=0;lt<ot.length-1;lt++)at.push(st.readASCII(nt,rt+ot[lt],ot[lt+1]-ot[lt]));rt+=ot[ot.length-1];var ct=[];rt=_.CFF.readIndex(nt,rt,ct);var ht=[];for(lt=0;lt<ct.length-1;lt++)ht.push(_.CFF.readDict(nt,rt+ct[lt],rt+ct[lt+1]));rt+=ct[ct.length-1];var ut=ht[0],ft=[];rt=_.CFF.readIndex(nt,rt,ft);var dt=[];for(lt=0;lt<ft.length-1;lt++)dt.push(st.readASCII(nt,rt+ft[lt],ft[lt+1]-ft[lt]));if(rt+=ft[ft.length-1],_.CFF.readSubrs(nt,rt,ut),ut.CharStrings){rt=ut.CharStrings,ft=[],rt=_.CFF.readIndex(nt,rt,ft);var pt=[];for(lt=0;lt<ft.length-1;lt++)pt.push(st.readBytes(nt,rt+ft[lt],ft[lt+1]-ft[lt]));ut.CharStrings=pt}if(ut.ROS){rt=ut.FDArray;var mt=[];for(rt=_.CFF.readIndex(nt,rt,mt),ut.FDArray=[],lt=0;lt<mt.length-1;lt++){var vt=_.CFF.readDict(nt,rt+mt[lt],rt+mt[lt+1]);_.CFF._readFDict(nt,vt,dt),ut.FDArray.push(vt)}rt+=mt[mt.length-1],rt=ut.FDSelect,ut.FDSelect=[];var yt=nt[rt];if(rt++,yt!=3)throw yt;var _t=st.readUshort(nt,rt);for(rt+=2,lt=0;lt<_t+1;lt++)ut.FDSelect.push(st.readUshort(nt,rt),nt[rt+2]),rt+=3}return ut.Encoding&&(ut.Encoding=_.CFF.readEncoding(nt,ut.Encoding,ut.CharStrings.length)),ut.charset&&(ut.charset=_.CFF.readCharset(nt,ut.charset,ut.CharStrings.length)),_.CFF._readFDict(nt,ut,dt),ut},_.CFF._readFDict=function(nt,rt,it){var st;for(var ot in rt.Private&&(st=rt.Private[1],rt.Private=_.CFF.readDict(nt,st,st+rt.Private[0]),rt.Private.Subrs&&_.CFF.readSubrs(nt,st+rt.Private.Subrs,rt.Private)),rt)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(ot)!=-1&&(rt[ot]=it[rt[ot]-426+35])},_.CFF.readSubrs=function(nt,rt,it){var st=_._bin,ot=[];rt=_.CFF.readIndex(nt,rt,ot);var at,lt=ot.length;at=lt<1240?107:lt<33900?1131:32768,it.Bias=at,it.Subrs=[];for(var ct=0;ct<ot.length-1;ct++)it.Subrs.push(st.readBytes(nt,rt+ot[ct],ot[ct+1]-ot[ct]))},_.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],_.CFF.glyphByUnicode=function(nt,rt){for(var it=0;it<nt.charset.length;it++)if(nt.charset[it]==rt)return it;return-1},_.CFF.glyphBySE=function(nt,rt){return rt<0||rt>255?-1:_.CFF.glyphByUnicode(nt,_.CFF.tableSE[rt])},_.CFF.readEncoding=function(nt,rt,it){_._bin;var st=[".notdef"],ot=nt[rt];if(rt++,ot!=0)throw"error: unknown encoding format: "+ot;var at=nt[rt];rt++;for(var lt=0;lt<at;lt++)st.push(nt[rt+lt]);return st},_.CFF.readCharset=function(nt,rt,it){var st=_._bin,ot=[".notdef"],at=nt[rt];if(rt++,at==0)for(var lt=0;lt<it;lt++){var ct=st.readUshort(nt,rt);rt+=2,ot.push(ct)}else{if(at!=1&&at!=2)throw"error: format: "+at;for(;ot.length<it;){ct=st.readUshort(nt,rt),rt+=2;var ht=0;for(at==1?(ht=nt[rt],rt++):(ht=st.readUshort(nt,rt),rt+=2),lt=0;lt<=ht;lt++)ot.push(ct),ct++}}return ot},_.CFF.readIndex=function(nt,rt,it){var st=_._bin,ot=st.readUshort(nt,rt)+1,at=nt[rt+=2];if(rt++,at==1)for(var lt=0;lt<ot;lt++)it.push(nt[rt+lt]);else if(at==2)for(lt=0;lt<ot;lt++)it.push(st.readUshort(nt,rt+2*lt));else if(at==3)for(lt=0;lt<ot;lt++)it.push(16777215&st.readUint(nt,rt+3*lt-1));else if(ot!=1)throw"unsupported offset size: "+at+", count: "+ot;return(rt+=ot*at)-1},_.CFF.getCharString=function(nt,rt,it){var st=_._bin,ot=nt[rt],at=nt[rt+1];nt[rt+2],nt[rt+3],nt[rt+4];var lt=1,ct=null,ht=null;ot<=20&&(ct=ot,lt=1),ot==12&&(ct=100*ot+at,lt=2),21<=ot&&ot<=27&&(ct=ot,lt=1),ot==28&&(ht=st.readShort(nt,rt+1),lt=3),29<=ot&&ot<=31&&(ct=ot,lt=1),32<=ot&&ot<=246&&(ht=ot-139,lt=1),247<=ot&&ot<=250&&(ht=256*(ot-247)+at+108,lt=2),251<=ot&&ot<=254&&(ht=256*-(ot-251)-at-108,lt=2),ot==255&&(ht=st.readInt(nt,rt+1)/65535,lt=5),it.val=ht??"o"+ct,it.size=lt},_.CFF.readCharString=function(nt,rt,it){for(var st=rt+it,ot=_._bin,at=[];rt<st;){var lt=nt[rt],ct=nt[rt+1];nt[rt+2],nt[rt+3],nt[rt+4];var ht=1,ut=null,ft=null;lt<=20&&(ut=lt,ht=1),lt==12&&(ut=100*lt+ct,ht=2),lt!=19&&lt!=20||(ut=lt,ht=2),21<=lt&&lt<=27&&(ut=lt,ht=1),lt==28&&(ft=ot.readShort(nt,rt+1),ht=3),29<=lt&&lt<=31&&(ut=lt,ht=1),32<=lt&&lt<=246&&(ft=lt-139,ht=1),247<=lt&&lt<=250&&(ft=256*(lt-247)+ct+108,ht=2),251<=lt&&lt<=254&&(ft=256*-(lt-251)-ct-108,ht=2),lt==255&&(ft=ot.readInt(nt,rt+1)/65535,ht=5),at.push(ft??"o"+ut),rt+=ht}return at},_.CFF.readDict=function(nt,rt,it){for(var st=_._bin,ot={},at=[];rt<it;){var lt=nt[rt],ct=nt[rt+1];nt[rt+2],nt[rt+3],nt[rt+4];var ht=1,ut=null,ft=null;if(lt==28&&(ft=st.readShort(nt,rt+1),ht=3),lt==29&&(ft=st.readInt(nt,rt+1),ht=5),32<=lt&&lt<=246&&(ft=lt-139,ht=1),247<=lt&&lt<=250&&(ft=256*(lt-247)+ct+108,ht=2),251<=lt&&lt<=254&&(ft=256*-(lt-251)-ct-108,ht=2),lt==255)throw ft=st.readInt(nt,rt+1)/65535,ht=5,"unknown number";if(lt==30){var dt=[];for(ht=1;;){var pt=nt[rt+ht];ht++;var mt=pt>>4,vt=15&pt;if(mt!=15&&dt.push(mt),vt!=15&&dt.push(vt),vt==15)break}for(var yt="",_t=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],St=0;St<dt.length;St++)yt+=_t[dt[St]];ft=parseFloat(yt)}lt<=21&&(ut=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][lt],ht=1,lt==12&&(ut=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][ct],ht=2)),ut!=null?(ot[ut]=at.length==1?at[0]:at,at=[]):at.push(ft),rt+=ht}return ot},_.cmap={},_.cmap.parse=function(nt,rt,it){nt=new Uint8Array(nt.buffer,rt,it),rt=0;var st=_._bin,ot={};st.readUshort(nt,rt),rt+=2;var at=st.readUshort(nt,rt);rt+=2;var lt=[];ot.tables=[];for(var ct=0;ct<at;ct++){var ht=st.readUshort(nt,rt);rt+=2;var ut=st.readUshort(nt,rt);rt+=2;var ft=st.readUint(nt,rt);rt+=4;var dt="p"+ht+"e"+ut,pt=lt.indexOf(ft);if(pt==-1){var mt;pt=ot.tables.length,lt.push(ft);var vt=st.readUshort(nt,ft);vt==0?mt=_.cmap.parse0(nt,ft):vt==4?mt=_.cmap.parse4(nt,ft):vt==6?mt=_.cmap.parse6(nt,ft):vt==12?mt=_.cmap.parse12(nt,ft):console.debug("unknown format: "+vt,ht,ut,ft),ot.tables.push(mt)}if(ot[dt]!=null)throw"multiple tables for one platform+encoding";ot[dt]=pt}return ot},_.cmap.parse0=function(nt,rt){var it=_._bin,st={};st.format=it.readUshort(nt,rt),rt+=2;var ot=it.readUshort(nt,rt);rt+=2,it.readUshort(nt,rt),rt+=2,st.map=[];for(var at=0;at<ot-6;at++)st.map.push(nt[rt+at]);return st},_.cmap.parse4=function(nt,rt){var it=_._bin,st=rt,ot={};ot.format=it.readUshort(nt,rt),rt+=2;var at=it.readUshort(nt,rt);rt+=2,it.readUshort(nt,rt),rt+=2;var lt=it.readUshort(nt,rt);rt+=2;var ct=lt/2;ot.searchRange=it.readUshort(nt,rt),rt+=2,ot.entrySelector=it.readUshort(nt,rt),rt+=2,ot.rangeShift=it.readUshort(nt,rt),rt+=2,ot.endCount=it.readUshorts(nt,rt,ct),rt+=2*ct,rt+=2,ot.startCount=it.readUshorts(nt,rt,ct),rt+=2*ct,ot.idDelta=[];for(var ht=0;ht<ct;ht++)ot.idDelta.push(it.readShort(nt,rt)),rt+=2;for(ot.idRangeOffset=it.readUshorts(nt,rt,ct),rt+=2*ct,ot.glyphIdArray=[];rt<st+at;)ot.glyphIdArray.push(it.readUshort(nt,rt)),rt+=2;return ot},_.cmap.parse6=function(nt,rt){var it=_._bin,st={};st.format=it.readUshort(nt,rt),rt+=2,it.readUshort(nt,rt),rt+=2,it.readUshort(nt,rt),rt+=2,st.firstCode=it.readUshort(nt,rt),rt+=2;var ot=it.readUshort(nt,rt);rt+=2,st.glyphIdArray=[];for(var at=0;at<ot;at++)st.glyphIdArray.push(it.readUshort(nt,rt)),rt+=2;return st},_.cmap.parse12=function(nt,rt){var it=_._bin,st={};st.format=it.readUshort(nt,rt),rt+=2,rt+=2,it.readUint(nt,rt),rt+=4,it.readUint(nt,rt),rt+=4;var ot=it.readUint(nt,rt);rt+=4,st.groups=[];for(var at=0;at<ot;at++){var lt=rt+12*at,ct=it.readUint(nt,lt+0),ht=it.readUint(nt,lt+4),ut=it.readUint(nt,lt+8);st.groups.push([ct,ht,ut])}return st},_.glyf={},_.glyf.parse=function(nt,rt,it,st){for(var ot=[],at=0;at<st.maxp.numGlyphs;at++)ot.push(null);return ot},_.glyf._parseGlyf=function(nt,rt){var it=_._bin,st=nt._data,ot=_._tabOffset(st,"glyf",nt._offset)+nt.loca[rt];if(nt.loca[rt]==nt.loca[rt+1])return null;var at={};if(at.noc=it.readShort(st,ot),ot+=2,at.xMin=it.readShort(st,ot),ot+=2,at.yMin=it.readShort(st,ot),ot+=2,at.xMax=it.readShort(st,ot),ot+=2,at.yMax=it.readShort(st,ot),ot+=2,at.xMin>=at.xMax||at.yMin>=at.yMax)return null;if(at.noc>0){at.endPts=[];for(var lt=0;lt<at.noc;lt++)at.endPts.push(it.readUshort(st,ot)),ot+=2;var ct=it.readUshort(st,ot);if(ot+=2,st.length-ot<ct)return null;at.instructions=it.readBytes(st,ot,ct),ot+=ct;var ht=at.endPts[at.noc-1]+1;for(at.flags=[],lt=0;lt<ht;lt++){var ut=st[ot];if(ot++,at.flags.push(ut),(8&ut)!=0){var ft=st[ot];ot++;for(var dt=0;dt<ft;dt++)at.flags.push(ut),lt++}}for(at.xs=[],lt=0;lt<ht;lt++){var pt=(2&at.flags[lt])!=0,mt=(16&at.flags[lt])!=0;pt?(at.xs.push(mt?st[ot]:-st[ot]),ot++):mt?at.xs.push(0):(at.xs.push(it.readShort(st,ot)),ot+=2)}for(at.ys=[],lt=0;lt<ht;lt++)pt=(4&at.flags[lt])!=0,mt=(32&at.flags[lt])!=0,pt?(at.ys.push(mt?st[ot]:-st[ot]),ot++):mt?at.ys.push(0):(at.ys.push(it.readShort(st,ot)),ot+=2);var vt=0,yt=0;for(lt=0;lt<ht;lt++)vt+=at.xs[lt],yt+=at.ys[lt],at.xs[lt]=vt,at.ys[lt]=yt}else{var _t;at.parts=[];do{_t=it.readUshort(st,ot),ot+=2;var St={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(at.parts.push(St),St.glyphIndex=it.readUshort(st,ot),ot+=2,1&_t){var bt=it.readShort(st,ot);ot+=2;var Et=it.readShort(st,ot);ot+=2}else bt=it.readInt8(st,ot),ot++,Et=it.readInt8(st,ot),ot++;2&_t?(St.m.tx=bt,St.m.ty=Et):(St.p1=bt,St.p2=Et),8&_t?(St.m.a=St.m.d=it.readF2dot14(st,ot),ot+=2):64&_t?(St.m.a=it.readF2dot14(st,ot),ot+=2,St.m.d=it.readF2dot14(st,ot),ot+=2):128&_t&&(St.m.a=it.readF2dot14(st,ot),ot+=2,St.m.b=it.readF2dot14(st,ot),ot+=2,St.m.c=it.readF2dot14(st,ot),ot+=2,St.m.d=it.readF2dot14(st,ot),ot+=2)}while(32&_t);if(256&_t){var Mt=it.readUshort(st,ot);for(ot+=2,at.instr=[],lt=0;lt<Mt;lt++)at.instr.push(st[ot]),ot++}}return at},_.GDEF={},_.GDEF.parse=function(nt,rt,it,st){var ot=rt;rt+=4;var at=_._bin.readUshort(nt,rt);return{glyphClassDef:at===0?null:_._lctf.readClassDef(nt,ot+at)}},_.GPOS={},_.GPOS.parse=function(nt,rt,it,st){return _._lctf.parse(nt,rt,it,st,_.GPOS.subt)},_.GPOS.subt=function(nt,rt,it,st){var ot=_._bin,at=it,lt={};if(lt.fmt=ot.readUshort(nt,it),it+=2,rt==1||rt==2||rt==3||rt==7||rt==8&&lt.fmt<=2){var ct=ot.readUshort(nt,it);it+=2,lt.coverage=_._lctf.readCoverage(nt,ct+at)}if(rt==1&&lt.fmt==1){var ht=ot.readUshort(nt,it);it+=2,ht!=0&&(lt.pos=_.GPOS.readValueRecord(nt,it,ht))}else if(rt==2&&lt.fmt>=1&&lt.fmt<=2){ht=ot.readUshort(nt,it),it+=2;var ut=ot.readUshort(nt,it);it+=2;var ft=_._lctf.numOfOnes(ht),dt=_._lctf.numOfOnes(ut);if(lt.fmt==1){lt.pairsets=[];var pt=ot.readUshort(nt,it);it+=2;for(var mt=0;mt<pt;mt++){var vt=at+ot.readUshort(nt,it);it+=2;var yt=ot.readUshort(nt,vt);vt+=2;for(var _t=[],St=0;St<yt;St++){var bt=ot.readUshort(nt,vt);vt+=2,ht!=0&&(Rt=_.GPOS.readValueRecord(nt,vt,ht),vt+=2*ft),ut!=0&&(It=_.GPOS.readValueRecord(nt,vt,ut),vt+=2*dt),_t.push({gid2:bt,val1:Rt,val2:It})}lt.pairsets.push(_t)}}if(lt.fmt==2){var Et=ot.readUshort(nt,it);it+=2;var Mt=ot.readUshort(nt,it);it+=2;var Tt=ot.readUshort(nt,it);it+=2;var wt=ot.readUshort(nt,it);for(it+=2,lt.classDef1=_._lctf.readClassDef(nt,at+Et),lt.classDef2=_._lctf.readClassDef(nt,at+Mt),lt.matrix=[],mt=0;mt<Tt;mt++){var Ct=[];for(St=0;St<wt;St++){var Rt=null,It=null;ht!=0&&(Rt=_.GPOS.readValueRecord(nt,it,ht),it+=2*ft),ut!=0&&(It=_.GPOS.readValueRecord(nt,it,ut),it+=2*dt),Ct.push({val1:Rt,val2:It})}lt.matrix.push(Ct)}}}else if(rt==4&&lt.fmt==1)lt.markCoverage=_._lctf.readCoverage(nt,ot.readUshort(nt,it)+at),lt.baseCoverage=_._lctf.readCoverage(nt,ot.readUshort(nt,it+2)+at),lt.markClassCount=ot.readUshort(nt,it+4),lt.markArray=_.GPOS.readMarkArray(nt,ot.readUshort(nt,it+6)+at),lt.baseArray=_.GPOS.readBaseArray(nt,ot.readUshort(nt,it+8)+at,lt.markClassCount);else if(rt==6&&lt.fmt==1)lt.mark1Coverage=_._lctf.readCoverage(nt,ot.readUshort(nt,it)+at),lt.mark2Coverage=_._lctf.readCoverage(nt,ot.readUshort(nt,it+2)+at),lt.markClassCount=ot.readUshort(nt,it+4),lt.mark1Array=_.GPOS.readMarkArray(nt,ot.readUshort(nt,it+6)+at),lt.mark2Array=_.GPOS.readBaseArray(nt,ot.readUshort(nt,it+8)+at,lt.markClassCount);else{if(rt==9&&lt.fmt==1){var Dt=ot.readUshort(nt,it);it+=2;var Ft=ot.readUint(nt,it);if(it+=4,st.ltype==9)st.ltype=Dt;else if(st.ltype!=Dt)throw"invalid extension substitution";return _.GPOS.subt(nt,st.ltype,at+Ft)}console.debug("unsupported GPOS table LookupType",rt,"format",lt.fmt)}return lt},_.GPOS.readValueRecord=function(nt,rt,it){var st=_._bin,ot=[];return ot.push(1&it?st.readShort(nt,rt):0),rt+=1&it?2:0,ot.push(2&it?st.readShort(nt,rt):0),rt+=2&it?2:0,ot.push(4&it?st.readShort(nt,rt):0),rt+=4&it?2:0,ot.push(8&it?st.readShort(nt,rt):0),rt+=8&it?2:0,ot},_.GPOS.readBaseArray=function(nt,rt,it){var st=_._bin,ot=[],at=rt,lt=st.readUshort(nt,rt);rt+=2;for(var ct=0;ct<lt;ct++){for(var ht=[],ut=0;ut<it;ut++)ht.push(_.GPOS.readAnchorRecord(nt,at+st.readUshort(nt,rt))),rt+=2;ot.push(ht)}return ot},_.GPOS.readMarkArray=function(nt,rt){var it=_._bin,st=[],ot=rt,at=it.readUshort(nt,rt);rt+=2;for(var lt=0;lt<at;lt++){var ct=_.GPOS.readAnchorRecord(nt,it.readUshort(nt,rt+2)+ot);ct.markClass=it.readUshort(nt,rt),st.push(ct),rt+=4}return st},_.GPOS.readAnchorRecord=function(nt,rt){var it=_._bin,st={};return st.fmt=it.readUshort(nt,rt),st.x=it.readShort(nt,rt+2),st.y=it.readShort(nt,rt+4),st},_.GSUB={},_.GSUB.parse=function(nt,rt,it,st){return _._lctf.parse(nt,rt,it,st,_.GSUB.subt)},_.GSUB.subt=function(nt,rt,it,st){var ot=_._bin,at=it,lt={};if(lt.fmt=ot.readUshort(nt,it),it+=2,rt!=1&&rt!=2&&rt!=4&&rt!=5&&rt!=6)return null;if(rt==1||rt==2||rt==4||rt==5&&lt.fmt<=2||rt==6&&lt.fmt<=2){var ct=ot.readUshort(nt,it);it+=2,lt.coverage=_._lctf.readCoverage(nt,at+ct)}if(rt==1&&lt.fmt>=1&&lt.fmt<=2){if(lt.fmt==1)lt.delta=ot.readShort(nt,it),it+=2;else if(lt.fmt==2){var ht=ot.readUshort(nt,it);it+=2,lt.newg=ot.readUshorts(nt,it,ht),it+=2*lt.newg.length}}else if(rt==2&&lt.fmt==1){ht=ot.readUshort(nt,it),it+=2,lt.seqs=[];for(var ut=0;ut<ht;ut++){var ft=ot.readUshort(nt,it)+at;it+=2;var dt=ot.readUshort(nt,ft);lt.seqs.push(ot.readUshorts(nt,ft+2,dt))}}else if(rt==4)for(lt.vals=[],ht=ot.readUshort(nt,it),it+=2,ut=0;ut<ht;ut++){var pt=ot.readUshort(nt,it);it+=2,lt.vals.push(_.GSUB.readLigatureSet(nt,at+pt))}else if(rt==5&&lt.fmt==2){if(lt.fmt==2){var mt=ot.readUshort(nt,it);it+=2,lt.cDef=_._lctf.readClassDef(nt,at+mt),lt.scset=[];var vt=ot.readUshort(nt,it);for(it+=2,ut=0;ut<vt;ut++){var yt=ot.readUshort(nt,it);it+=2,lt.scset.push(yt==0?null:_.GSUB.readSubClassSet(nt,at+yt))}}}else if(rt==6&&lt.fmt==3){if(lt.fmt==3){for(ut=0;ut<3;ut++){ht=ot.readUshort(nt,it),it+=2;for(var _t=[],St=0;St<ht;St++)_t.push(_._lctf.readCoverage(nt,at+ot.readUshort(nt,it+2*St)));it+=2*ht,ut==0&&(lt.backCvg=_t),ut==1&&(lt.inptCvg=_t),ut==2&&(lt.ahedCvg=_t)}ht=ot.readUshort(nt,it),it+=2,lt.lookupRec=_.GSUB.readSubstLookupRecords(nt,it,ht)}}else{if(rt==7&&lt.fmt==1){var bt=ot.readUshort(nt,it);it+=2;var Et=ot.readUint(nt,it);if(it+=4,st.ltype==9)st.ltype=bt;else if(st.ltype!=bt)throw"invalid extension substitution";return _.GSUB.subt(nt,st.ltype,at+Et)}console.debug("unsupported GSUB table LookupType",rt,"format",lt.fmt)}return lt},_.GSUB.readSubClassSet=function(nt,rt){var it=_._bin.readUshort,st=rt,ot=[],at=it(nt,rt);rt+=2;for(var lt=0;lt<at;lt++){var ct=it(nt,rt);rt+=2,ot.push(_.GSUB.readSubClassRule(nt,st+ct))}return ot},_.GSUB.readSubClassRule=function(nt,rt){var it=_._bin.readUshort,st={},ot=it(nt,rt),at=it(nt,rt+=2);rt+=2,st.input=[];for(var lt=0;lt<ot-1;lt++)st.input.push(it(nt,rt)),rt+=2;return st.substLookupRecords=_.GSUB.readSubstLookupRecords(nt,rt,at),st},_.GSUB.readSubstLookupRecords=function(nt,rt,it){for(var st=_._bin.readUshort,ot=[],at=0;at<it;at++)ot.push(st(nt,rt),st(nt,rt+2)),rt+=4;return ot},_.GSUB.readChainSubClassSet=function(nt,rt){var it=_._bin,st=rt,ot=[],at=it.readUshort(nt,rt);rt+=2;for(var lt=0;lt<at;lt++){var ct=it.readUshort(nt,rt);rt+=2,ot.push(_.GSUB.readChainSubClassRule(nt,st+ct))}return ot},_.GSUB.readChainSubClassRule=function(nt,rt){for(var it=_._bin,st={},ot=["backtrack","input","lookahead"],at=0;at<ot.length;at++){var lt=it.readUshort(nt,rt);rt+=2,at==1&&lt--,st[ot[at]]=it.readUshorts(nt,rt,lt),rt+=2*st[ot[at]].length}return lt=it.readUshort(nt,rt),rt+=2,st.subst=it.readUshorts(nt,rt,2*lt),rt+=2*st.subst.length,st},_.GSUB.readLigatureSet=function(nt,rt){var it=_._bin,st=rt,ot=[],at=it.readUshort(nt,rt);rt+=2;for(var lt=0;lt<at;lt++){var ct=it.readUshort(nt,rt);rt+=2,ot.push(_.GSUB.readLigature(nt,st+ct))}return ot},_.GSUB.readLigature=function(nt,rt){var it=_._bin,st={chain:[]};st.nglyph=it.readUshort(nt,rt),rt+=2;var ot=it.readUshort(nt,rt);rt+=2;for(var at=0;at<ot-1;at++)st.chain.push(it.readUshort(nt,rt)),rt+=2;return st},_.head={},_.head.parse=function(nt,rt,it){var st=_._bin,ot={};return st.readFixed(nt,rt),rt+=4,ot.fontRevision=st.readFixed(nt,rt),rt+=4,st.readUint(nt,rt),rt+=4,st.readUint(nt,rt),rt+=4,ot.flags=st.readUshort(nt,rt),rt+=2,ot.unitsPerEm=st.readUshort(nt,rt),rt+=2,ot.created=st.readUint64(nt,rt),rt+=8,ot.modified=st.readUint64(nt,rt),rt+=8,ot.xMin=st.readShort(nt,rt),rt+=2,ot.yMin=st.readShort(nt,rt),rt+=2,ot.xMax=st.readShort(nt,rt),rt+=2,ot.yMax=st.readShort(nt,rt),rt+=2,ot.macStyle=st.readUshort(nt,rt),rt+=2,ot.lowestRecPPEM=st.readUshort(nt,rt),rt+=2,ot.fontDirectionHint=st.readShort(nt,rt),rt+=2,ot.indexToLocFormat=st.readShort(nt,rt),rt+=2,ot.glyphDataFormat=st.readShort(nt,rt),rt+=2,ot},_.hhea={},_.hhea.parse=function(nt,rt,it){var st=_._bin,ot={};return st.readFixed(nt,rt),rt+=4,ot.ascender=st.readShort(nt,rt),rt+=2,ot.descender=st.readShort(nt,rt),rt+=2,ot.lineGap=st.readShort(nt,rt),rt+=2,ot.advanceWidthMax=st.readUshort(nt,rt),rt+=2,ot.minLeftSideBearing=st.readShort(nt,rt),rt+=2,ot.minRightSideBearing=st.readShort(nt,rt),rt+=2,ot.xMaxExtent=st.readShort(nt,rt),rt+=2,ot.caretSlopeRise=st.readShort(nt,rt),rt+=2,ot.caretSlopeRun=st.readShort(nt,rt),rt+=2,ot.caretOffset=st.readShort(nt,rt),rt+=2,rt+=8,ot.metricDataFormat=st.readShort(nt,rt),rt+=2,ot.numberOfHMetrics=st.readUshort(nt,rt),rt+=2,ot},_.hmtx={},_.hmtx.parse=function(nt,rt,it,st){for(var ot=_._bin,at={aWidth:[],lsBearing:[]},lt=0,ct=0,ht=0;ht<st.maxp.numGlyphs;ht++)ht<st.hhea.numberOfHMetrics&&(lt=ot.readUshort(nt,rt),rt+=2,ct=ot.readShort(nt,rt),rt+=2),at.aWidth.push(lt),at.lsBearing.push(ct);return at},_.kern={},_.kern.parse=function(nt,rt,it,st){var ot=_._bin,at=ot.readUshort(nt,rt);if(rt+=2,at==1)return _.kern.parseV1(nt,rt-2,it,st);var lt=ot.readUshort(nt,rt);rt+=2;for(var ct={glyph1:[],rval:[]},ht=0;ht<lt;ht++){rt+=2,it=ot.readUshort(nt,rt),rt+=2;var ut=ot.readUshort(nt,rt);rt+=2;var ft=ut>>>8;if((ft&=15)!=0)throw"unknown kern table format: "+ft;rt=_.kern.readFormat0(nt,rt,ct)}return ct},_.kern.parseV1=function(nt,rt,it,st){var ot=_._bin;ot.readFixed(nt,rt),rt+=4;var at=ot.readUint(nt,rt);rt+=4;for(var lt={glyph1:[],rval:[]},ct=0;ct<at;ct++){ot.readUint(nt,rt),rt+=4;var ht=ot.readUshort(nt,rt);rt+=2,ot.readUshort(nt,rt),rt+=2;var ut=ht>>>8;if((ut&=15)!=0)throw"unknown kern table format: "+ut;rt=_.kern.readFormat0(nt,rt,lt)}return lt},_.kern.readFormat0=function(nt,rt,it){var st=_._bin,ot=-1,at=st.readUshort(nt,rt);rt+=2,st.readUshort(nt,rt),rt+=2,st.readUshort(nt,rt),rt+=2,st.readUshort(nt,rt),rt+=2;for(var lt=0;lt<at;lt++){var ct=st.readUshort(nt,rt);rt+=2;var ht=st.readUshort(nt,rt);rt+=2;var ut=st.readShort(nt,rt);rt+=2,ct!=ot&&(it.glyph1.push(ct),it.rval.push({glyph2:[],vals:[]}));var ft=it.rval[it.rval.length-1];ft.glyph2.push(ht),ft.vals.push(ut),ot=ct}return rt},_.loca={},_.loca.parse=function(nt,rt,it,st){var ot=_._bin,at=[],lt=st.head.indexToLocFormat,ct=st.maxp.numGlyphs+1;if(lt==0)for(var ht=0;ht<ct;ht++)at.push(ot.readUshort(nt,rt+(ht<<1))<<1);if(lt==1)for(ht=0;ht<ct;ht++)at.push(ot.readUint(nt,rt+(ht<<2)));return at},_.maxp={},_.maxp.parse=function(nt,rt,it){var st=_._bin,ot={},at=st.readUint(nt,rt);return rt+=4,ot.numGlyphs=st.readUshort(nt,rt),rt+=2,at==65536&&(ot.maxPoints=st.readUshort(nt,rt),rt+=2,ot.maxContours=st.readUshort(nt,rt),rt+=2,ot.maxCompositePoints=st.readUshort(nt,rt),rt+=2,ot.maxCompositeContours=st.readUshort(nt,rt),rt+=2,ot.maxZones=st.readUshort(nt,rt),rt+=2,ot.maxTwilightPoints=st.readUshort(nt,rt),rt+=2,ot.maxStorage=st.readUshort(nt,rt),rt+=2,ot.maxFunctionDefs=st.readUshort(nt,rt),rt+=2,ot.maxInstructionDefs=st.readUshort(nt,rt),rt+=2,ot.maxStackElements=st.readUshort(nt,rt),rt+=2,ot.maxSizeOfInstructions=st.readUshort(nt,rt),rt+=2,ot.maxComponentElements=st.readUshort(nt,rt),rt+=2,ot.maxComponentDepth=st.readUshort(nt,rt),rt+=2),ot},_.name={},_.name.parse=function(nt,rt,it){var st=_._bin,ot={};st.readUshort(nt,rt),rt+=2;var at=st.readUshort(nt,rt);rt+=2,st.readUshort(nt,rt);for(var lt,ct=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],ht=rt+=2,ut=0;ut<at;ut++){var ft=st.readUshort(nt,rt);rt+=2;var dt=st.readUshort(nt,rt);rt+=2;var pt=st.readUshort(nt,rt);rt+=2;var mt=st.readUshort(nt,rt);rt+=2;var vt=st.readUshort(nt,rt);rt+=2;var yt=st.readUshort(nt,rt);rt+=2;var _t,St=ct[mt],bt=ht+12*at+yt;if(ft==0)_t=st.readUnicode(nt,bt,vt/2);else if(ft==3&&dt==0)_t=st.readUnicode(nt,bt,vt/2);else if(dt==0)_t=st.readASCII(nt,bt,vt);else if(dt==1)_t=st.readUnicode(nt,bt,vt/2);else if(dt==3)_t=st.readUnicode(nt,bt,vt/2);else{if(ft!=1)throw"unknown encoding "+dt+", platformID: "+ft;_t=st.readASCII(nt,bt,vt),console.debug("reading unknown MAC encoding "+dt+" as ASCII")}var Et="p"+ft+","+pt.toString(16);ot[Et]==null&&(ot[Et]={}),ot[Et][St!==void 0?St:mt]=_t,ot[Et]._lang=pt}for(var Mt in ot)if(ot[Mt].postScriptName!=null&&ot[Mt]._lang==1033)return ot[Mt];for(var Mt in ot)if(ot[Mt].postScriptName!=null&&ot[Mt]._lang==0)return ot[Mt];for(var Mt in ot)if(ot[Mt].postScriptName!=null&&ot[Mt]._lang==3084)return ot[Mt];for(var Mt in ot)if(ot[Mt].postScriptName!=null)return ot[Mt];for(var Mt in ot){lt=Mt;break}return console.debug("returning name table with languageID "+ot[lt]._lang),ot[lt]},_["OS/2"]={},_["OS/2"].parse=function(nt,rt,it){var st=_._bin.readUshort(nt,rt);rt+=2;var ot={};if(st==0)_["OS/2"].version0(nt,rt,ot);else if(st==1)_["OS/2"].version1(nt,rt,ot);else if(st==2||st==3||st==4)_["OS/2"].version2(nt,rt,ot);else{if(st!=5)throw"unknown OS/2 table version: "+st;_["OS/2"].version5(nt,rt,ot)}return ot},_["OS/2"].version0=function(nt,rt,it){var st=_._bin;return it.xAvgCharWidth=st.readShort(nt,rt),rt+=2,it.usWeightClass=st.readUshort(nt,rt),rt+=2,it.usWidthClass=st.readUshort(nt,rt),rt+=2,it.fsType=st.readUshort(nt,rt),rt+=2,it.ySubscriptXSize=st.readShort(nt,rt),rt+=2,it.ySubscriptYSize=st.readShort(nt,rt),rt+=2,it.ySubscriptXOffset=st.readShort(nt,rt),rt+=2,it.ySubscriptYOffset=st.readShort(nt,rt),rt+=2,it.ySuperscriptXSize=st.readShort(nt,rt),rt+=2,it.ySuperscriptYSize=st.readShort(nt,rt),rt+=2,it.ySuperscriptXOffset=st.readShort(nt,rt),rt+=2,it.ySuperscriptYOffset=st.readShort(nt,rt),rt+=2,it.yStrikeoutSize=st.readShort(nt,rt),rt+=2,it.yStrikeoutPosition=st.readShort(nt,rt),rt+=2,it.sFamilyClass=st.readShort(nt,rt),rt+=2,it.panose=st.readBytes(nt,rt,10),rt+=10,it.ulUnicodeRange1=st.readUint(nt,rt),rt+=4,it.ulUnicodeRange2=st.readUint(nt,rt),rt+=4,it.ulUnicodeRange3=st.readUint(nt,rt),rt+=4,it.ulUnicodeRange4=st.readUint(nt,rt),rt+=4,it.achVendID=[st.readInt8(nt,rt),st.readInt8(nt,rt+1),st.readInt8(nt,rt+2),st.readInt8(nt,rt+3)],rt+=4,it.fsSelection=st.readUshort(nt,rt),rt+=2,it.usFirstCharIndex=st.readUshort(nt,rt),rt+=2,it.usLastCharIndex=st.readUshort(nt,rt),rt+=2,it.sTypoAscender=st.readShort(nt,rt),rt+=2,it.sTypoDescender=st.readShort(nt,rt),rt+=2,it.sTypoLineGap=st.readShort(nt,rt),rt+=2,it.usWinAscent=st.readUshort(nt,rt),rt+=2,it.usWinDescent=st.readUshort(nt,rt),rt+=2},_["OS/2"].version1=function(nt,rt,it){var st=_._bin;return rt=_["OS/2"].version0(nt,rt,it),it.ulCodePageRange1=st.readUint(nt,rt),rt+=4,it.ulCodePageRange2=st.readUint(nt,rt),rt+=4},_["OS/2"].version2=function(nt,rt,it){var st=_._bin;return rt=_["OS/2"].version1(nt,rt,it),it.sxHeight=st.readShort(nt,rt),rt+=2,it.sCapHeight=st.readShort(nt,rt),rt+=2,it.usDefault=st.readUshort(nt,rt),rt+=2,it.usBreak=st.readUshort(nt,rt),rt+=2,it.usMaxContext=st.readUshort(nt,rt),rt+=2},_["OS/2"].version5=function(nt,rt,it){var st=_._bin;return rt=_["OS/2"].version2(nt,rt,it),it.usLowerOpticalPointSize=st.readUshort(nt,rt),rt+=2,it.usUpperOpticalPointSize=st.readUshort(nt,rt),rt+=2},_.post={},_.post.parse=function(nt,rt,it){var st=_._bin,ot={};return ot.version=st.readFixed(nt,rt),rt+=4,ot.italicAngle=st.readFixed(nt,rt),rt+=4,ot.underlinePosition=st.readShort(nt,rt),rt+=2,ot.underlineThickness=st.readShort(nt,rt),rt+=2,ot},_==null&&(_={}),_.U==null&&(_.U={}),_.U.codeToGlyph=function(nt,rt){var it=nt.cmap,st=-1;if(it.p0e4!=null?st=it.p0e4:it.p3e1!=null?st=it.p3e1:it.p1e0!=null?st=it.p1e0:it.p0e3!=null&&(st=it.p0e3),st==-1)throw"no familiar platform and encoding!";var ot=it.tables[st];if(ot.format==0)return rt>=ot.map.length?0:ot.map[rt];if(ot.format==4){for(var at=-1,lt=0;lt<ot.endCount.length;lt++)if(rt<=ot.endCount[lt]){at=lt;break}return at==-1||ot.startCount[at]>rt?0:65535&(ot.idRangeOffset[at]!=0?ot.glyphIdArray[rt-ot.startCount[at]+(ot.idRangeOffset[at]>>1)-(ot.idRangeOffset.length-at)]:rt+ot.idDelta[at])}if(ot.format==12){if(rt>ot.groups[ot.groups.length-1][1])return 0;for(lt=0;lt<ot.groups.length;lt++){var ct=ot.groups[lt];if(ct[0]<=rt&&rt<=ct[1])return ct[2]+(rt-ct[0])}return 0}throw"unknown cmap table format "+ot.format},_.U.glyphToPath=function(nt,rt){var it={cmds:[],crds:[]};if(nt.SVG&&nt.SVG.entries[rt]){var st=nt.SVG.entries[rt];return st==null?it:(typeof st=="string"&&(st=_.SVG.toPath(st),nt.SVG.entries[rt]=st),st)}if(nt.CFF){var ot={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:nt.CFF.Private?nt.CFF.Private.defaultWidthX:0,open:!1},at=nt.CFF,lt=nt.CFF.Private;if(at.ROS){for(var ct=0;at.FDSelect[ct+2]<=rt;)ct+=2;lt=at.FDArray[at.FDSelect[ct+1]].Private}_.U._drawCFF(nt.CFF.CharStrings[rt],ot,at,lt,it)}else nt.glyf&&_.U._drawGlyf(rt,nt,it);return it},_.U._drawGlyf=function(nt,rt,it){var st=rt.glyf[nt];st==null&&(st=rt.glyf[nt]=_.glyf._parseGlyf(rt,nt)),st!=null&&(st.noc>-1?_.U._simpleGlyph(st,it):_.U._compoGlyph(st,rt,it))},_.U._simpleGlyph=function(nt,rt){for(var it=0;it<nt.noc;it++){for(var st=it==0?0:nt.endPts[it-1]+1,ot=nt.endPts[it],at=st;at<=ot;at++){var lt=at==st?ot:at-1,ct=at==ot?st:at+1,ht=1&nt.flags[at],ut=1&nt.flags[lt],ft=1&nt.flags[ct],dt=nt.xs[at],pt=nt.ys[at];if(at==st)if(ht){if(!ut){_.U.P.moveTo(rt,dt,pt);continue}_.U.P.moveTo(rt,nt.xs[lt],nt.ys[lt])}else ut?_.U.P.moveTo(rt,nt.xs[lt],nt.ys[lt]):_.U.P.moveTo(rt,(nt.xs[lt]+dt)/2,(nt.ys[lt]+pt)/2);ht?ut&&_.U.P.lineTo(rt,dt,pt):ft?_.U.P.qcurveTo(rt,dt,pt,nt.xs[ct],nt.ys[ct]):_.U.P.qcurveTo(rt,dt,pt,(dt+nt.xs[ct])/2,(pt+nt.ys[ct])/2)}_.U.P.closePath(rt)}},_.U._compoGlyph=function(nt,rt,it){for(var st=0;st<nt.parts.length;st++){var ot={cmds:[],crds:[]},at=nt.parts[st];_.U._drawGlyf(at.glyphIndex,rt,ot);for(var lt=at.m,ct=0;ct<ot.crds.length;ct+=2){var ht=ot.crds[ct],ut=ot.crds[ct+1];it.crds.push(ht*lt.a+ut*lt.b+lt.tx),it.crds.push(ht*lt.c+ut*lt.d+lt.ty)}for(ct=0;ct<ot.cmds.length;ct++)it.cmds.push(ot.cmds[ct])}},_.U._getGlyphClass=function(nt,rt){var it=_._lctf.getInterval(rt,nt);return it==-1?0:rt[it+2]},_.U._applySubs=function(nt,rt,it,st){for(var ot=nt.length-rt-1,at=0;at<it.tabs.length;at++)if(it.tabs[at]!=null){var lt,ct=it.tabs[at];if(!ct.coverage||(lt=_._lctf.coverageIndex(ct.coverage,nt[rt]))!=-1){if(it.ltype==1)nt[rt],ct.fmt==1?nt[rt]=nt[rt]+ct.delta:nt[rt]=ct.newg[lt];else if(it.ltype==4)for(var ht=ct.vals[lt],ut=0;ut<ht.length;ut++){var ft=ht[ut],dt=ft.chain.length;if(!(dt>ot)){for(var pt=!0,mt=0,vt=0;vt<dt;vt++){for(;nt[rt+mt+(1+vt)]==-1;)mt++;ft.chain[vt]!=nt[rt+mt+(1+vt)]&&(pt=!1)}if(pt){for(nt[rt]=ft.nglyph,vt=0;vt<dt+mt;vt++)nt[rt+vt+1]=-1;break}}}else if(it.ltype==5&&ct.fmt==2)for(var yt=_._lctf.getInterval(ct.cDef,nt[rt]),_t=ct.cDef[yt+2],St=ct.scset[_t],bt=0;bt<St.length;bt++){var Et=St[bt],Mt=Et.input;if(!(Mt.length>ot)){for(pt=!0,vt=0;vt<Mt.length;vt++){var Tt=_._lctf.getInterval(ct.cDef,nt[rt+1+vt]);if(yt==-1&&ct.cDef[Tt+2]!=Mt[vt]){pt=!1;break}}if(pt){var wt=Et.substLookupRecords;for(ut=0;ut<wt.length;ut+=2)wt[ut],wt[ut+1]}}}else if(it.ltype==6&&ct.fmt==3){if(!_.U._glsCovered(nt,ct.backCvg,rt-ct.backCvg.length)||!_.U._glsCovered(nt,ct.inptCvg,rt)||!_.U._glsCovered(nt,ct.ahedCvg,rt+ct.inptCvg.length))continue;var Ct=ct.lookupRec;for(bt=0;bt<Ct.length;bt+=2){yt=Ct[bt];var Rt=st[Ct[bt+1]];_.U._applySubs(nt,rt+yt,Rt,st)}}}}},_.U._glsCovered=function(nt,rt,it){for(var st=0;st<rt.length;st++)if(_._lctf.coverageIndex(rt[st],nt[it+st])==-1)return!1;return!0},_.U.glyphsToPath=function(nt,rt,it){for(var st={cmds:[],crds:[]},ot=0,at=0;at<rt.length;at++){var lt=rt[at];if(lt!=-1){for(var ct=at<rt.length-1&&rt[at+1]!=-1?rt[at+1]:0,ht=_.U.glyphToPath(nt,lt),ut=0;ut<ht.crds.length;ut+=2)st.crds.push(ht.crds[ut]+ot),st.crds.push(ht.crds[ut+1]);for(it&&st.cmds.push(it),ut=0;ut<ht.cmds.length;ut++)st.cmds.push(ht.cmds[ut]);it&&st.cmds.push("X"),ot+=nt.hmtx.aWidth[lt],at<rt.length-1&&(ot+=_.U.getPairAdjustment(nt,lt,ct))}}return st},_.U.P={},_.U.P.moveTo=function(nt,rt,it){nt.cmds.push("M"),nt.crds.push(rt,it)},_.U.P.lineTo=function(nt,rt,it){nt.cmds.push("L"),nt.crds.push(rt,it)},_.U.P.curveTo=function(nt,rt,it,st,ot,at,lt){nt.cmds.push("C"),nt.crds.push(rt,it,st,ot,at,lt)},_.U.P.qcurveTo=function(nt,rt,it,st,ot){nt.cmds.push("Q"),nt.crds.push(rt,it,st,ot)},_.U.P.closePath=function(nt){nt.cmds.push("Z")},_.U._drawCFF=function(nt,rt,it,st,ot){for(var at=rt.stack,lt=rt.nStems,ct=rt.haveWidth,ht=rt.width,ut=rt.open,ft=0,dt=rt.x,pt=rt.y,mt=0,vt=0,yt=0,_t=0,St=0,bt=0,Et=0,Mt=0,Tt=0,wt=0,Ct={val:0,size:0};ft<nt.length;){_.CFF.getCharString(nt,ft,Ct);var Rt=Ct.val;if(ft+=Ct.size,Rt=="o1"||Rt=="o18")at.length%2!=0&&!ct&&(ht=at.shift()+st.nominalWidthX),lt+=at.length>>1,at.length=0,ct=!0;else if(Rt=="o3"||Rt=="o23")at.length%2!=0&&!ct&&(ht=at.shift()+st.nominalWidthX),lt+=at.length>>1,at.length=0,ct=!0;else if(Rt=="o4")at.length>1&&!ct&&(ht=at.shift()+st.nominalWidthX,ct=!0),ut&&_.U.P.closePath(ot),pt+=at.pop(),_.U.P.moveTo(ot,dt,pt),ut=!0;else if(Rt=="o5")for(;at.length>0;)dt+=at.shift(),pt+=at.shift(),_.U.P.lineTo(ot,dt,pt);else if(Rt=="o6"||Rt=="o7")for(var It=at.length,Dt=Rt=="o6",Ft=0;Ft<It;Ft++){var $t=at.shift();Dt?dt+=$t:pt+=$t,Dt=!Dt,_.U.P.lineTo(ot,dt,pt)}else if(Rt=="o8"||Rt=="o24"){It=at.length;for(var Yt=0;Yt+6<=It;)mt=dt+at.shift(),vt=pt+at.shift(),yt=mt+at.shift(),_t=vt+at.shift(),dt=yt+at.shift(),pt=_t+at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,dt,pt),Yt+=6;Rt=="o24"&&(dt+=at.shift(),pt+=at.shift(),_.U.P.lineTo(ot,dt,pt))}else{if(Rt=="o11")break;if(Rt=="o1234"||Rt=="o1235"||Rt=="o1236"||Rt=="o1237")Rt=="o1234"&&(vt=pt,yt=(mt=dt+at.shift())+at.shift(),wt=_t=vt+at.shift(),bt=_t,Mt=pt,dt=(Et=(St=(Tt=yt+at.shift())+at.shift())+at.shift())+at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,Tt,wt),_.U.P.curveTo(ot,St,bt,Et,Mt,dt,pt)),Rt=="o1235"&&(mt=dt+at.shift(),vt=pt+at.shift(),yt=mt+at.shift(),_t=vt+at.shift(),Tt=yt+at.shift(),wt=_t+at.shift(),St=Tt+at.shift(),bt=wt+at.shift(),Et=St+at.shift(),Mt=bt+at.shift(),dt=Et+at.shift(),pt=Mt+at.shift(),at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,Tt,wt),_.U.P.curveTo(ot,St,bt,Et,Mt,dt,pt)),Rt=="o1236"&&(mt=dt+at.shift(),vt=pt+at.shift(),yt=mt+at.shift(),wt=_t=vt+at.shift(),bt=_t,Et=(St=(Tt=yt+at.shift())+at.shift())+at.shift(),Mt=bt+at.shift(),dt=Et+at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,Tt,wt),_.U.P.curveTo(ot,St,bt,Et,Mt,dt,pt)),Rt=="o1237"&&(mt=dt+at.shift(),vt=pt+at.shift(),yt=mt+at.shift(),_t=vt+at.shift(),Tt=yt+at.shift(),wt=_t+at.shift(),St=Tt+at.shift(),bt=wt+at.shift(),Et=St+at.shift(),Mt=bt+at.shift(),Math.abs(Et-dt)>Math.abs(Mt-pt)?dt=Et+at.shift():pt=Mt+at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,Tt,wt),_.U.P.curveTo(ot,St,bt,Et,Mt,dt,pt));else if(Rt=="o14"){if(at.length>0&&!ct&&(ht=at.shift()+it.nominalWidthX,ct=!0),at.length==4){var Lt=at.shift(),Ot=at.shift(),Nt=at.shift(),zt=at.shift(),Ht=_.CFF.glyphBySE(it,Nt),qt=_.CFF.glyphBySE(it,zt);_.U._drawCFF(it.CharStrings[Ht],rt,it,st,ot),rt.x=Lt,rt.y=Ot,_.U._drawCFF(it.CharStrings[qt],rt,it,st,ot)}ut&&(_.U.P.closePath(ot),ut=!1)}else if(Rt=="o19"||Rt=="o20")at.length%2!=0&&!ct&&(ht=at.shift()+st.nominalWidthX),lt+=at.length>>1,at.length=0,ct=!0,ft+=lt+7>>3;else if(Rt=="o21")at.length>2&&!ct&&(ht=at.shift()+st.nominalWidthX,ct=!0),pt+=at.pop(),dt+=at.pop(),ut&&_.U.P.closePath(ot),_.U.P.moveTo(ot,dt,pt),ut=!0;else if(Rt=="o22")at.length>1&&!ct&&(ht=at.shift()+st.nominalWidthX,ct=!0),dt+=at.pop(),ut&&_.U.P.closePath(ot),_.U.P.moveTo(ot,dt,pt),ut=!0;else if(Rt=="o25"){for(;at.length>6;)dt+=at.shift(),pt+=at.shift(),_.U.P.lineTo(ot,dt,pt);mt=dt+at.shift(),vt=pt+at.shift(),yt=mt+at.shift(),_t=vt+at.shift(),dt=yt+at.shift(),pt=_t+at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,dt,pt)}else if(Rt=="o26")for(at.length%2&&(dt+=at.shift());at.length>0;)mt=dt,vt=pt+at.shift(),dt=yt=mt+at.shift(),pt=(_t=vt+at.shift())+at.shift(),_.U.P.curveTo(ot,mt,vt,yt,_t,dt,pt);else if(Rt=="o27")for(at.length%2&&(pt+=at.shift());at.length>0;)vt=pt,yt=(mt=dt+at.shift())+at.shift(),_t=vt+at.shift(),dt=yt+at.shift(),pt=_t,_.U.P.curveTo(ot,mt,vt,yt,_t,dt,pt);else if(Rt=="o10"||Rt=="o29"){var Gt=Rt=="o10"?st:it;if(at.length==0)console.debug("error: empty stack");else{var Xt=at.pop(),Zt=Gt.Subrs[Xt+Gt.Bias];rt.x=dt,rt.y=pt,rt.nStems=lt,rt.haveWidth=ct,rt.width=ht,rt.open=ut,_.U._drawCFF(Zt,rt,it,st,ot),dt=rt.x,pt=rt.y,lt=rt.nStems,ct=rt.haveWidth,ht=rt.width,ut=rt.open}}else if(Rt=="o30"||Rt=="o31"){var Qt=at.length,un=(Yt=0,Rt=="o31");for(Yt+=Qt-(It=-3&Qt);Yt<It;)un?(vt=pt,yt=(mt=dt+at.shift())+at.shift(),pt=(_t=vt+at.shift())+at.shift(),It-Yt==5?(dt=yt+at.shift(),Yt++):dt=yt,un=!1):(mt=dt,vt=pt+at.shift(),yt=mt+at.shift(),_t=vt+at.shift(),dt=yt+at.shift(),It-Yt==5?(pt=_t+at.shift(),Yt++):pt=_t,un=!0),_.U.P.curveTo(ot,mt,vt,yt,_t,dt,pt),Yt+=4}else{if((Rt+"").charAt(0)=="o")throw console.debug("Unknown operation: "+Rt,nt),Rt;at.push(Rt)}}}rt.x=dt,rt.y=pt,rt.nStems=lt,rt.haveWidth=ct,rt.width=ht,rt.open=ut};var _e=_,tt={Typr:_e};return et.Typr=_e,et.default=tt,Object.defineProperty(et,"__esModule",{value:!0}),et}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function woff2otfFactory(){return function(et){var _=Uint8Array,_e=Uint16Array,tt=Uint32Array,nt=new _([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rt=new _([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),it=new _([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),st=function(Rt,It){for(var Dt=new _e(31),Ft=0;Ft<31;++Ft)Dt[Ft]=It+=1<<Rt[Ft-1];var $t=new tt(Dt[30]);for(Ft=1;Ft<30;++Ft)for(var Yt=Dt[Ft];Yt<Dt[Ft+1];++Yt)$t[Yt]=Yt-Dt[Ft]<<5|Ft;return[Dt,$t]},ot=st(nt,2),at=ot[0],lt=ot[1];at[28]=258,lt[258]=28;for(var ct=st(rt,0)[0],ht=new _e(32768),ut=0;ut<32768;++ut){var ft=(43690&ut)>>>1|(21845&ut)<<1;ft=(61680&(ft=(52428&ft)>>>2|(13107&ft)<<2))>>>4|(3855&ft)<<4,ht[ut]=((65280&ft)>>>8|(255&ft)<<8)>>>1}var dt=function(Rt,It,Dt){for(var Ft=Rt.length,$t=0,Yt=new _e(It);$t<Ft;++$t)++Yt[Rt[$t]-1];var Lt,Ot=new _e(It);for($t=0;$t<It;++$t)Ot[$t]=Ot[$t-1]+Yt[$t-1]<<1;{Lt=new _e(1<<It);var Nt=15-It;for($t=0;$t<Ft;++$t)if(Rt[$t])for(var zt=$t<<4|Rt[$t],Ht=It-Rt[$t],qt=Ot[Rt[$t]-1]++<<Ht,Gt=qt|(1<<Ht)-1;qt<=Gt;++qt)Lt[ht[qt]>>>Nt]=zt}return Lt},pt=new _(288);for(ut=0;ut<144;++ut)pt[ut]=8;for(ut=144;ut<256;++ut)pt[ut]=9;for(ut=256;ut<280;++ut)pt[ut]=7;for(ut=280;ut<288;++ut)pt[ut]=8;var mt=new _(32);for(ut=0;ut<32;++ut)mt[ut]=5;var vt=dt(pt,9),yt=dt(mt,5),_t=function(Rt){for(var It=Rt[0],Dt=1;Dt<Rt.length;++Dt)Rt[Dt]>It&&(It=Rt[Dt]);return It},St=function(Rt,It,Dt){var Ft=It/8|0;return(Rt[Ft]|Rt[Ft+1]<<8)>>(7&It)&Dt},bt=function(Rt,It){var Dt=It/8|0;return(Rt[Dt]|Rt[Dt+1]<<8|Rt[Dt+2]<<16)>>(7&It)},Et=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Mt=function(Rt,It,Dt){var Ft=new Error(It||Et[Rt]);if(Ft.code=Rt,Error.captureStackTrace&&Error.captureStackTrace(Ft,Mt),!Dt)throw Ft;return Ft},Tt=function(Rt,It,Dt){var Ft=Rt.length;if(!Ft||Dt&&!Dt.l&&Ft<5)return It||new _(0);var $t=!It||Dt,Yt=!Dt||Dt.i;Dt||(Dt={}),It||(It=new _(3*Ft));var Lt,Ot=function(Nn){var Zn=It.length;if(Nn>Zn){var er=new _(Math.max(2*Zn,Nn));er.set(It),It=er}},Nt=Dt.f||0,zt=Dt.p||0,Ht=Dt.b||0,qt=Dt.l,Gt=Dt.d,Xt=Dt.m,Zt=Dt.n,Qt=8*Ft;do{if(!qt){Dt.f=Nt=St(Rt,zt,1);var un=St(Rt,zt+1,3);if(zt+=3,!un){var wn=Rt[(Wt=((Lt=zt)/8|0)+(7&Lt&&1)+4)-4]|Rt[Wt-3]<<8,Tn=Wt+wn;if(Tn>Ft){Yt&&Mt(0);break}$t&&Ot(Ht+wn),It.set(Rt.subarray(Wt,Tn),Ht),Dt.b=Ht+=wn,Dt.p=zt=8*Tn;continue}if(un==1)qt=vt,Gt=yt,Xt=9,Zt=5;else if(un==2){var yn=St(Rt,zt,31)+257,Vt=St(Rt,zt+10,15)+4,fn=yn+St(Rt,zt+5,31)+1;zt+=14;for(var ln=new _(fn),Jt=new _(19),on=0;on<Vt;++on)Jt[it[on]]=St(Rt,zt+3*on,7);zt+=3*Vt;var _n=_t(Jt),cn=(1<<_n)-1,tn=dt(Jt,_n);for(on=0;on<fn;){var Wt,Bt=tn[St(Rt,zt,cn)];if(zt+=15&Bt,(Wt=Bt>>>4)<16)ln[on++]=Wt;else{var nn=0,en=0;for(Wt==16?(en=3+St(Rt,zt,3),zt+=2,nn=ln[on-1]):Wt==17?(en=3+St(Rt,zt,7),zt+=3):Wt==18&&(en=11+St(Rt,zt,127),zt+=7);en--;)ln[on++]=nn}}var mn=ln.subarray(0,yn),sn=ln.subarray(yn);Xt=_t(mn),Zt=_t(sn),qt=dt(mn,Xt),Gt=dt(sn,Zt)}else Mt(1);if(zt>Qt){Yt&&Mt(0);break}}$t&&Ot(Ht+131072);for(var xn=(1<<Xt)-1,an=(1<<Zt)-1,pn=zt;;pn=zt){var Sn=(nn=qt[bt(Rt,zt)&xn])>>>4;if((zt+=15&nn)>Qt){Yt&&Mt(0);break}if(nn||Mt(2),Sn<256)It[Ht++]=Sn;else{if(Sn==256){pn=zt,qt=null;break}var gn=Sn-254;if(Sn>264){var Rn=nt[on=Sn-257];gn=St(Rt,zt,(1<<Rn)-1)+at[on],zt+=Rn}var Mn=Gt[bt(Rt,zt)&an],kn=Mn>>>4;if(Mn||Mt(3),zt+=15&Mn,sn=ct[kn],kn>3&&(Rn=rt[kn],sn+=bt(Rt,zt)&(1<<Rn)-1,zt+=Rn),zt>Qt){Yt&&Mt(0);break}$t&&Ot(Ht+131072);for(var Fn=Ht+gn;Ht<Fn;Ht+=4)It[Ht]=It[Ht-sn],It[Ht+1]=It[Ht+1-sn],It[Ht+2]=It[Ht+2-sn],It[Ht+3]=It[Ht+3-sn];Ht=Fn}}Dt.l=qt,Dt.p=pn,Dt.b=Ht,qt&&(Nt=1,Dt.m=Xt,Dt.d=Gt,Dt.n=Zt)}while(!Nt);return Ht==It.length?It:function(Nn,Zn,er){(er==null||er>Nn.length)&&(er=Nn.length);var dn=new(Nn instanceof _e?_e:Nn instanceof tt?tt:_)(er-Zn);return dn.set(Nn.subarray(Zn,er)),dn}(It,0,Ht)},wt=new _(0),Ct=typeof TextDecoder<"u"&&new TextDecoder;try{Ct.decode(wt,{stream:!0})}catch{}return et.convert_streams=function(Rt){var It=new DataView(Rt),Dt=0;function Ft(){var yn=It.getUint16(Dt);return Dt+=2,yn}function $t(){var yn=It.getUint32(Dt);return Dt+=4,yn}function Yt(yn){wn.setUint16(Tn,yn),Tn+=2}function Lt(yn){wn.setUint32(Tn,yn),Tn+=4}for(var Ot={signature:$t(),flavor:$t(),length:$t(),numTables:Ft(),reserved:Ft(),totalSfntSize:$t(),majorVersion:Ft(),minorVersion:Ft(),metaOffset:$t(),metaLength:$t(),metaOrigLength:$t(),privOffset:$t(),privLength:$t()},Nt=0;Math.pow(2,Nt)<=Ot.numTables;)Nt++;Nt--;for(var zt=16*Math.pow(2,Nt),Ht=16*Ot.numTables-zt,qt=12,Gt=[],Xt=0;Xt<Ot.numTables;Xt++)Gt.push({tag:$t(),offset:$t(),compLength:$t(),origLength:$t(),origChecksum:$t()}),qt+=16;var Zt,Qt=new Uint8Array(12+16*Gt.length+Gt.reduce(function(yn,Vt){return yn+Vt.origLength+4},0)),un=Qt.buffer,wn=new DataView(un),Tn=0;return Lt(Ot.flavor),Yt(Ot.numTables),Yt(zt),Yt(Nt),Yt(Ht),Gt.forEach(function(yn){Lt(yn.tag),Lt(yn.origChecksum),Lt(qt),Lt(yn.origLength),yn.outOffset=qt,(qt+=yn.origLength)%4!=0&&(qt+=4-qt%4)}),Gt.forEach(function(yn){var Vt,fn=Rt.slice(yn.offset,yn.offset+yn.compLength);if(yn.compLength!=yn.origLength){var ln=new Uint8Array(yn.origLength);Vt=new Uint8Array(fn,2),Tt(Vt,ln)}else ln=new Uint8Array(fn);Qt.set(ln,yn.outOffset);var Jt=0;(qt=yn.outOffset+yn.origLength)%4!=0&&(Jt=4-qt%4),Qt.set(new Uint8Array(Jt).buffer,yn.outOffset+yn.origLength),Zt=qt+Jt}),un.slice(0,Zt)},Object.defineProperty(et,"__esModule",{value:!0}),et}({}).convert_streams}function parserFactory(et,_){const _e={M:2,L:2,Q:4,C:6,Z:0},tt={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},nt=1,rt=2,it=4,st=8,ot=16,at=32;let lt;function ct(Et){if(!lt){const Mt={R:rt,L:nt,D:it,C:ot,U:at,T:st};lt=new Map;for(let Tt in tt){let wt=0;tt[Tt].split(",").forEach(Ct=>{let[Rt,It]=Ct.split("+");Rt=parseInt(Rt,36),It=It?parseInt(It,36):0,lt.set(wt+=Rt,Mt[Tt]);for(let Dt=It;Dt--;)lt.set(++wt,Mt[Tt])})}}return lt.get(Et)||at}const ht=1,ut=2,ft=3,dt=4,pt=[null,"isol","init","fina","medi"];function mt(Et){const Mt=new Uint8Array(Et.length);let Tt=at,wt=ht,Ct=-1;for(let Rt=0;Rt<Et.length;Rt++){const It=Et.codePointAt(Rt);let Dt=ct(It)|0,Ft=ht;Dt&st||(Tt&(nt|it|ot)?Dt&(rt|it|ot)?(Ft=ft,(wt===ht||wt===ft)&&Mt[Ct]++):Dt&(nt|at)&&(wt===ut||wt===dt)&&Mt[Ct]--:Tt&(rt|at)&&(wt===ut||wt===dt)&&Mt[Ct]--,wt=Mt[Rt]=Ft,Tt=Dt,Ct=Rt,It>65535&&Rt++)}return Mt}function vt(Et,Mt){const Tt=[];for(let Ct=0;Ct<Mt.length;Ct++){const Rt=Mt.codePointAt(Ct);Rt>65535&&Ct++,Tt.push(et.U.codeToGlyph(Et,Rt))}const wt=Et.GSUB;if(wt){const{lookupList:Ct,featureList:Rt}=wt;let It;const Dt=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,Ft=[];Rt.forEach($t=>{if(Dt.test($t.tag))for(let Yt=0;Yt<$t.tab.length;Yt++){if(Ft[$t.tab[Yt]])continue;Ft[$t.tab[Yt]]=!0;const Lt=Ct[$t.tab[Yt]],Ot=/^(isol|init|fina|medi)$/.test($t.tag);Ot&&!It&&(It=mt(Mt));for(let Nt=0;Nt<Tt.length;Nt++)(!It||!Ot||pt[It[Nt]]===$t.tag)&&et.U._applySubs(Tt,Nt,Lt,Ct)}})}return Tt}function yt(Et,Mt){const Tt=new Int16Array(Mt.length*3);let wt=0;for(;wt<Mt.length;wt++){const Dt=Mt[wt];if(Dt===-1)continue;Tt[wt*3+2]=Et.hmtx.aWidth[Dt];const Ft=Et.GPOS;if(Ft){const $t=Ft.lookupList;for(let Yt=0;Yt<$t.length;Yt++){const Lt=$t[Yt];for(let Ot=0;Ot<Lt.tabs.length;Ot++){const Nt=Lt.tabs[Ot];if(Lt.ltype===1){if(et._lctf.coverageIndex(Nt.coverage,Dt)!==-1&&Nt.pos){It(Nt.pos,wt);break}}else if(Lt.ltype===2){let zt=null,Ht=Ct();if(Ht!==-1){const qt=et._lctf.coverageIndex(Nt.coverage,Mt[Ht]);if(qt!==-1){if(Nt.fmt===1){const Gt=Nt.pairsets[qt];for(let Xt=0;Xt<Gt.length;Xt++)Gt[Xt].gid2===Dt&&(zt=Gt[Xt])}else if(Nt.fmt===2){const Gt=et.U._getGlyphClass(Mt[Ht],Nt.classDef1),Xt=et.U._getGlyphClass(Dt,Nt.classDef2);zt=Nt.matrix[Gt][Xt]}if(zt){zt.val1&&It(zt.val1,Ht),zt.val2&&It(zt.val2,wt);break}}}}else if(Lt.ltype===4){const zt=et._lctf.coverageIndex(Nt.markCoverage,Dt);if(zt!==-1){const Ht=Ct(Rt),qt=Ht===-1?-1:et._lctf.coverageIndex(Nt.baseCoverage,Mt[Ht]);if(qt!==-1){const Gt=Nt.markArray[zt],Xt=Nt.baseArray[qt][Gt.markClass];Tt[wt*3]=Xt.x-Gt.x+Tt[Ht*3]-Tt[Ht*3+2],Tt[wt*3+1]=Xt.y-Gt.y+Tt[Ht*3+1];break}}}else if(Lt.ltype===6){const zt=et._lctf.coverageIndex(Nt.mark1Coverage,Dt);if(zt!==-1){const Ht=Ct();if(Ht!==-1){const qt=Mt[Ht];if(_t(Et,qt)===3){const Gt=et._lctf.coverageIndex(Nt.mark2Coverage,qt);if(Gt!==-1){const Xt=Nt.mark1Array[zt],Zt=Nt.mark2Array[Gt][Xt.markClass];Tt[wt*3]=Zt.x-Xt.x+Tt[Ht*3]-Tt[Ht*3+2],Tt[wt*3+1]=Zt.y-Xt.y+Tt[Ht*3+1];break}}}}}}}}else if(Et.kern&&!Et.cff){const $t=Ct();if($t!==-1){const Yt=Et.kern.glyph1.indexOf(Mt[$t]);if(Yt!==-1){const Lt=Et.kern.rval[Yt].glyph2.indexOf(Dt);Lt!==-1&&(Tt[$t*3+2]+=Et.kern.rval[Yt].vals[Lt])}}}}return Tt;function Ct(Dt){for(let Ft=wt-1;Ft>=0;Ft--)if(Mt[Ft]!==-1&&(!Dt||Dt(Mt[Ft])))return Ft;return-1}function Rt(Dt){return _t(Et,Dt)===1}function It(Dt,Ft){for(let $t=0;$t<3;$t++)Tt[Ft*3+$t]+=Dt[$t]||0}}function _t(Et,Mt){const Tt=Et.GDEF&&Et.GDEF.glyphClassDef;return Tt?et.U._getGlyphClass(Mt,Tt):0}function St(...Et){for(let Mt=0;Mt<Et.length;Mt++)if(typeof Et[Mt]=="number")return Et[Mt]}function bt(Et){const Mt=Object.create(null),Tt=Et["OS/2"],wt=Et.hhea,Ct=Et.head.unitsPerEm,Rt=St(Tt&&Tt.sTypoAscender,wt&&wt.ascender,Ct),It={unitsPerEm:Ct,ascender:Rt,descender:St(Tt&&Tt.sTypoDescender,wt&&wt.descender,0),capHeight:St(Tt&&Tt.sCapHeight,Rt),xHeight:St(Tt&&Tt.sxHeight,Rt),lineGap:St(Tt&&Tt.sTypoLineGap,wt&&wt.lineGap),supportsCodePoint(Dt){return et.U.codeToGlyph(Et,Dt)>0},forEachGlyph(Dt,Ft,$t,Yt){let Lt=0;const Ot=1/It.unitsPerEm*Ft,Nt=vt(Et,Dt);let zt=0;const Ht=yt(Et,Nt);return Nt.forEach((qt,Gt)=>{if(qt!==-1){let Xt=Mt[qt];if(!Xt){const{cmds:Zt,crds:Qt}=et.U.glyphToPath(Et,qt);let un="",wn=0;for(let ln=0,Jt=Zt.length;ln<Jt;ln++){const on=_e[Zt[ln]];un+=Zt[ln];for(let _n=1;_n<=on;_n++)un+=(_n>1?",":"")+Qt[wn++]}let Tn,yn,Vt,fn;if(Qt.length){Tn=yn=1/0,Vt=fn=-1/0;for(let ln=0,Jt=Qt.length;ln<Jt;ln+=2){let on=Qt[ln],_n=Qt[ln+1];on<Tn&&(Tn=on),_n<yn&&(yn=_n),on>Vt&&(Vt=on),_n>fn&&(fn=_n)}}else Tn=Vt=yn=fn=0;Xt=Mt[qt]={index:qt,advanceWidth:Et.hmtx.aWidth[qt],xMin:Tn,yMin:yn,xMax:Vt,yMax:fn,path:un}}Yt.call(null,Xt,Lt+Ht[Gt*3]*Ot,Ht[Gt*3+1]*Ot,zt),Lt+=Ht[Gt*3+2]*Ot,$t&&(Lt+=$t*Ft)}zt+=Dt.codePointAt(zt)>65535?2:1}),Lt}};return It}return function(Mt){const Tt=new Uint8Array(Mt,0,4),wt=et._bin.readASCII(Tt,0,4);if(wt==="wOFF")Mt=_(Mt);else if(wt==="wOF2")throw new Error("woff2 fonts not supported");return bt(et.parse(Mt)[0])}}const workerModule=defineWorkerModule({name:"Typr Font Parser",dependencies:[typrFactory,woff2otfFactory,parserFactory],init(et,_,_e){const tt=et(),nt=_();return _e(tt,nt)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function unicodeFontResolverClientFactory(){return function(et){var _=function(){this.buckets=new Map};_.prototype.add=function(yt){var _t=yt>>5;this.buckets.set(_t,(this.buckets.get(_t)||0)|1<<(31&yt))},_.prototype.has=function(yt){var _t=this.buckets.get(yt>>5);return _t!==void 0&&(_t&1<<(31&yt))!=0},_.prototype.serialize=function(){var yt=[];return this.buckets.forEach(function(_t,St){yt.push((+St).toString(36)+":"+_t.toString(36))}),yt.join(",")},_.prototype.deserialize=function(yt){var _t=this;this.buckets.clear(),yt.split(",").forEach(function(St){var bt=St.split(":");_t.buckets.set(parseInt(bt[0],36),parseInt(bt[1],36))})};var _e=Math.pow(2,8),tt=_e-1,nt=~tt;function rt(yt){var _t=function(bt){return bt&nt}(yt).toString(16),St=function(bt){return(bt&nt)+_e-1}(yt).toString(16);return"codepoint-index/plane"+(yt>>16)+"/"+_t+"-"+St+".json"}function it(yt,_t){var St=yt&tt,bt=_t.codePointAt(St/6|0);return((bt=(bt||48)-48)&1<<St%6)!=0}function st(yt,_t){var St;(St=yt,St.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(bt){return bt.split("-").map(function(Et){return parseInt(Et.trim(),16)})})).forEach(function(bt){var Et=bt[0],Mt=bt[1];Mt===void 0&&(Mt=Et),_t(Et,Mt)})}function ot(yt,_t){st(yt,function(St,bt){for(var Et=St;Et<=bt;Et++)_t(Et)})}var at={},lt={},ct=new WeakMap,ht="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function ut(yt){var _t=ct.get(yt);return _t||(_t=new _,ot(yt.ranges,function(St){return _t.add(St)}),ct.set(yt,_t)),_t}var ft,dt=new Map;function pt(yt,_t,St){return yt[_t]?_t:yt[St]?St:function(bt){for(var Et in bt)return Et}(yt)}function mt(yt,_t){var St=_t;if(!yt.includes(St)){St=1/0;for(var bt=0;bt<yt.length;bt++)Math.abs(yt[bt]-_t)<Math.abs(St-_t)&&(St=yt[bt])}return St}function vt(yt){return ft||(ft=new Set,ot("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(_t){ft.add(_t)})),ft.has(yt)}return et.CodePointSet=_,et.clearCache=function(){at={},lt={}},et.getFontsForString=function(yt,_t){_t===void 0&&(_t={});var St,bt=_t.lang;bt===void 0&&(bt=new RegExp("\\p{Script=Hangul}","u").test(St=yt)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(St)?"ja":"en");var Et=_t.category;Et===void 0&&(Et="sans-serif");var Mt=_t.style;Mt===void 0&&(Mt="normal");var Tt=_t.weight;Tt===void 0&&(Tt=400);var wt=(_t.dataUrl||ht).replace(/\/$/g,""),Ct=new Map,Rt=new Uint8Array(yt.length),It={},Dt={},Ft=new Array(yt.length),$t=new Map,Yt=!1;function Lt(zt){var Ht=dt.get(zt);return Ht||(Ht=fetch(wt+"/"+zt).then(function(qt){if(!qt.ok)throw new Error(qt.statusText);return qt.json().then(function(Gt){if(!Array.isArray(Gt)||Gt[0]!==1)throw new Error("Incorrect schema version; need 1, got "+Gt[0]);return Gt[1]})}).catch(function(qt){if(wt!==ht)return Yt||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+wt+'", trying default CDN. '+qt.message),Yt=!0),wt=ht,dt.delete(zt),Lt(zt);throw qt}),dt.set(zt,Ht)),Ht}for(var Ot=function(zt){var Ht=yt.codePointAt(zt),qt=rt(Ht);Ft[zt]=qt,at[qt]||$t.has(qt)||$t.set(qt,Lt(qt).then(function(Gt){at[qt]=Gt})),Ht>65535&&(zt++,Nt=zt)},Nt=0;Nt<yt.length;Nt++)Ot(Nt);return Promise.all($t.values()).then(function(){$t.clear();for(var zt=function(qt){var Gt=yt.codePointAt(qt),Xt=null,Zt=at[Ft[qt]],Qt=void 0;for(var un in Zt){var wn=Dt[un];if(wn===void 0&&(wn=Dt[un]=new RegExp(un).test(bt||"en")),wn){for(var Tn in Qt=un,Zt[un])if(it(Gt,Zt[un][Tn])){Xt=Tn;break}break}}if(!Xt){e:for(var yn in Zt)if(yn!==Qt){for(var Vt in Zt[yn])if(it(Gt,Zt[yn][Vt])){Xt=Vt;break e}}}Xt||(console.debug("No font coverage for U+"+Gt.toString(16)),Xt="latin"),Ft[qt]=Xt,lt[Xt]||$t.has(Xt)||$t.set(Xt,Lt("font-meta/"+Xt+".json").then(function(fn){lt[Xt]=fn})),Gt>65535&&(qt++,Ht=qt)},Ht=0;Ht<yt.length;Ht++)zt(Ht);return Promise.all($t.values())}).then(function(){for(var zt,Ht=null,qt=0;qt<yt.length;qt++){var Gt=yt.codePointAt(qt);if(Ht&&(vt(Gt)||ut(Ht).has(Gt)))Rt[qt]=Rt[qt-1];else{Ht=lt[Ft[qt]];var Xt=It[Ht.id];if(!Xt){var Zt=Ht.typeforms,Qt=pt(Zt,Et,"sans-serif"),un=pt(Zt[Qt],Mt,"normal"),wn=mt((zt=Zt[Qt])===null||zt===void 0?void 0:zt[un],Tt);Xt=It[Ht.id]=wt+"/font-files/"+Ht.id+"/"+Qt+"."+un+"."+wn+".woff"}var Tn=Ct.get(Xt);Tn==null&&(Tn=Ct.size,Ct.set(Xt,Tn)),Rt[qt]=Tn}Gt>65535&&(qt++,Rt[qt]=Rt[qt-1])}return{fontUrls:Array.from(Ct.keys()),chars:Rt}})},Object.defineProperty(et,"__esModule",{value:!0}),et}({})}function createFontResolver(et,_){const _e=Object.create(null),tt=Object.create(null);function nt(it,st){const ot=at=>{console.error(`Failure loading font ${it}`,at)};try{const at=new XMLHttpRequest;at.open("get",it,!0),at.responseType="arraybuffer",at.onload=function(){if(at.status>=400)ot(new Error(at.statusText));else if(at.status>0)try{const lt=et(at.response);lt.src=it,st(lt)}catch(lt){ot(lt)}},at.onerror=ot,at.send()}catch(at){ot(at)}}function rt(it,st){let ot=_e[it];ot?st(ot):tt[it]?tt[it].push(st):(tt[it]=[st],nt(it,at=>{at.src=it,_e[it]=at,tt[it].forEach(lt=>lt(at)),delete tt[it]}))}return function(it,st,{lang:ot,fonts:at=[],style:lt="normal",weight:ct="normal",unicodeFontsURL:ht}={}){const ut=new Uint8Array(it.length),ft=[];it.length||vt();const dt=new Map,pt=[];if(lt!=="italic"&&(lt="normal"),typeof ct!="number"&&(ct=ct==="bold"?700:400),at&&!Array.isArray(at)&&(at=[at]),at=at.slice().filter(_t=>!_t.lang||_t.lang.test(ot)).reverse(),at.length){let Et=0;(function Mt(Tt=0){for(let wt=Tt,Ct=it.length;wt<Ct;wt++){const Rt=it.codePointAt(wt);if(Et===1&&ft[ut[wt-1]].supportsCodePoint(Rt)||/\s/.test(it[wt]))ut[wt]=ut[wt-1],Et===2&&(pt[pt.length-1][1]=wt);else for(let It=ut[wt],Dt=at.length;It<=Dt;It++)if(It===Dt){const Ft=Et===2?pt[pt.length-1]:pt[pt.length]=[wt,wt];Ft[1]=wt,Et=2}else{ut[wt]=It;const{src:Ft,unicodeRange:$t}=at[It];if(!$t||yt(Rt,$t)){const Yt=_e[Ft];if(!Yt){rt(Ft,()=>{Mt(wt)});return}if(Yt.supportsCodePoint(Rt)){let Lt=dt.get(Yt);typeof Lt!="number"&&(Lt=ft.length,ft.push(Yt),dt.set(Yt,Lt)),ut[wt]=Lt,Et=1;break}}}Rt>65535&&wt+1<Ct&&(ut[wt+1]=ut[wt],wt++,Et===2&&(pt[pt.length-1][1]=wt))}mt()})()}else pt.push([0,it.length-1]),mt();function mt(){if(pt.length){const _t=pt.map(St=>it.substring(St[0],St[1]+1)).join(`
`);_.getFontsForString(_t,{lang:ot||void 0,style:lt,weight:ct,dataUrl:ht}).then(({fontUrls:St,chars:bt})=>{const Et=ft.length;let Mt=0;pt.forEach(wt=>{for(let Ct=0,Rt=wt[1]-wt[0];Ct<=Rt;Ct++)ut[wt[0]+Ct]=bt[Mt++]+Et;Mt++});let Tt=0;St.forEach((wt,Ct)=>{rt(wt,Rt=>{ft[Ct+Et]=Rt,++Tt===St.length&&vt()})})})}else vt()}function vt(){st({chars:ut,fonts:ft})}function yt(_t,St){for(let bt=0;bt<St.length;bt++){const[Et,Mt=Et]=St[bt];if(Et<=_t&&_t<=Mt)return!0}return!1}}}const fontResolverWorkerModule=defineWorkerModule({name:"FontResolver",dependencies:[createFontResolver,workerModule,unicodeFontResolverClientFactory],init(et,_,_e){return et(_,_e())}});function createTypesetter(et,_){const tt=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,nt="[^\\S\\u00A0]",rt=new RegExp(`${nt}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function it({text:ft,lang:dt,fonts:pt,style:mt,weight:vt,preResolvedFonts:yt,unicodeFontsURL:_t},St){const bt=({chars:Et,fonts:Mt})=>{let Tt,wt;const Ct=[];for(let Rt=0;Rt<Et.length;Rt++)Et[Rt]!==wt?(wt=Et[Rt],Ct.push(Tt={start:Rt,end:Rt,fontObj:Mt[Et[Rt]]})):Tt.end=Rt;St(Ct)};yt?bt(yt):et(ft,bt,{lang:dt,fonts:pt,style:mt,weight:vt,unicodeFontsURL:_t})}function st({text:ft="",font:dt,lang:pt,sdfGlyphSize:mt=64,fontSize:vt=400,fontWeight:yt=1,fontStyle:_t="normal",letterSpacing:St=0,lineHeight:bt="normal",maxWidth:Et=1/0,direction:Mt,textAlign:Tt="left",textIndent:wt=0,whiteSpace:Ct="normal",overflowWrap:Rt="normal",anchorX:It=0,anchorY:Dt=0,metricsOnly:Ft=!1,unicodeFontsURL:$t,preResolvedFonts:Yt=null,includeCaretPositions:Lt=!1,chunkedBoundsSize:Ot=8192,colorRanges:Nt=null},zt){const Ht=ct(),qt={fontLoad:0,typesetting:0};ft.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),ft=ft.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),vt=+vt,St=+St,Et=+Et,bt=bt||"normal",wt=+wt,it({text:ft,lang:pt,style:_t,weight:yt,fonts:typeof dt=="string"?[{src:dt}]:dt,unicodeFontsURL:$t,preResolvedFonts:Yt},Gt=>{qt.fontLoad=ct()-Ht;const Xt=isFinite(Et);let Zt=null,Qt=null,un=null,wn=null,Tn=null,yn=null,Vt=null,fn=null,ln=0,Jt=0,on=Ct!=="nowrap";const _n=new Map,cn=ct();let tn=wt,Wt=0,Bt=new ht;const nn=[Bt];Gt.forEach(an=>{const{fontObj:pn}=an,{ascender:Sn,descender:gn,unitsPerEm:Rn,lineGap:Mn,capHeight:kn,xHeight:Fn}=pn;let Nn=_n.get(pn);if(!Nn){const Pn=vt/Rn,Dn=bt==="normal"?(Sn-gn+Mn)*Pn:bt*vt,Hn=(Dn-(Sn-gn)*Pn)/2,jn=Math.min(Dn,(Sn-gn)*Pn),qn=(Sn+gn)/2*Pn+jn/2;Nn={index:_n.size,src:pn.src,fontObj:pn,fontSizeMult:Pn,unitsPerEm:Rn,ascender:Sn*Pn,descender:gn*Pn,capHeight:kn*Pn,xHeight:Fn*Pn,lineHeight:Dn,baseline:-Hn-Sn*Pn,caretTop:qn,caretBottom:qn-jn},_n.set(pn,Nn)}const{fontSizeMult:Zn}=Nn,er=ft.slice(an.start,an.end+1);let dn,$n;pn.forEachGlyph(er,vt,St,(Pn,Dn,Hn,jn)=>{Dn+=Wt,jn+=an.start,dn=Dn,$n=Pn;const qn=ft.charAt(jn),hr=Pn.advanceWidth*Zn,fr=Bt.count;let jt;if("isEmpty"in Pn||(Pn.isWhitespace=!!qn&&new RegExp(nt).test(qn),Pn.canBreakAfter=!!qn&&rt.test(qn),Pn.isEmpty=Pn.xMin===Pn.xMax||Pn.yMin===Pn.yMax||tt.test(qn)),!Pn.isWhitespace&&!Pn.isEmpty&&Jt++,on&&Xt&&!Pn.isWhitespace&&Dn+hr+tn>Et&&fr){if(Bt.glyphAt(fr-1).glyphObj.canBreakAfter)jt=new ht,tn=-Dn;else for(let En=fr;En--;)if(En===0&&Rt==="break-word"){jt=new ht,tn=-Dn;break}else if(Bt.glyphAt(En).glyphObj.canBreakAfter){jt=Bt.splitAt(En+1);const Vn=jt.glyphAt(0).x;tn-=Vn;for(let Gn=jt.count;Gn--;)jt.glyphAt(Gn).x-=Vn;break}jt&&(Bt.isSoftWrapped=!0,Bt=jt,nn.push(Bt),ln=Et)}let hn=Bt.glyphAt(Bt.count);hn.glyphObj=Pn,hn.x=Dn+tn,hn.y=Hn,hn.width=hr,hn.charIndex=jn,hn.fontData=Nn,qn===`
`&&(Bt=new ht,nn.push(Bt),tn=-(Dn+hr+St*vt)+wt)}),Wt=dn+$n.advanceWidth*Zn+St*vt});let en=0;nn.forEach(an=>{let pn=!0;for(let Sn=an.count;Sn--;){const gn=an.glyphAt(Sn);pn&&!gn.glyphObj.isWhitespace&&(an.width=gn.x+gn.width,an.width>ln&&(ln=an.width),pn=!1);let{lineHeight:Rn,capHeight:Mn,xHeight:kn,baseline:Fn}=gn.fontData;Rn>an.lineHeight&&(an.lineHeight=Rn);const Nn=Fn-an.baseline;Nn<0&&(an.baseline+=Nn,an.cap+=Nn,an.ex+=Nn),an.cap=Math.max(an.cap,an.baseline+Mn),an.ex=Math.max(an.ex,an.baseline+kn)}an.baseline-=en,an.cap-=en,an.ex-=en,en+=an.lineHeight});let mn=0,sn=0;if(It&&(typeof It=="number"?mn=-It:typeof It=="string"&&(mn=-ln*(It==="left"?0:It==="center"?.5:It==="right"?1:at(It)))),Dt&&(typeof Dt=="number"?sn=-Dt:typeof Dt=="string"&&(sn=Dt==="top"?0:Dt==="top-baseline"?-nn[0].baseline:Dt==="top-cap"?-nn[0].cap:Dt==="top-ex"?-nn[0].ex:Dt==="middle"?en/2:Dt==="bottom"?en:Dt==="bottom-baseline"?-nn[nn.length-1].baseline:at(Dt)*en)),!Ft){const an=_.getEmbeddingLevels(ft,Mt);Zt=new Uint16Array(Jt),Qt=new Uint8Array(Jt),un=new Float32Array(Jt*2),wn={},Vt=[1/0,1/0,-1/0,-1/0],fn=[],Lt&&(yn=new Float32Array(ft.length*4)),Nt&&(Tn=new Uint8Array(Jt*3));let pn=0,Sn=-1,gn=-1,Rn,Mn;if(nn.forEach((kn,Fn)=>{let{count:Nn,width:Zn}=kn;if(Nn>0){let er=0;for(let jn=Nn;jn--&&kn.glyphAt(jn).glyphObj.isWhitespace;)er++;let dn=0,$n=0;if(Tt==="center")dn=(ln-Zn)/2;else if(Tt==="right")dn=ln-Zn;else if(Tt==="justify"&&kn.isSoftWrapped){let jn=0;for(let qn=Nn-er;qn--;)kn.glyphAt(qn).glyphObj.isWhitespace&&jn++;$n=(ln-Zn)/jn}if($n||dn){let jn=0;for(let qn=0;qn<Nn;qn++){let hr=kn.glyphAt(qn);const fr=hr.glyphObj;hr.x+=dn+jn,$n!==0&&fr.isWhitespace&&qn<Nn-er&&(jn+=$n,hr.width+=$n)}}const Pn=_.getReorderSegments(ft,an,kn.glyphAt(0).charIndex,kn.glyphAt(kn.count-1).charIndex);for(let jn=0;jn<Pn.length;jn++){const[qn,hr]=Pn[jn];let fr=1/0,jt=-1/0;for(let hn=0;hn<Nn;hn++)if(kn.glyphAt(hn).charIndex>=qn){let En=hn,Vn=hn;for(;Vn<Nn;Vn++){let Gn=kn.glyphAt(Vn);if(Gn.charIndex>hr)break;Vn<Nn-er&&(fr=Math.min(fr,Gn.x),jt=Math.max(jt,Gn.x+Gn.width))}for(let Gn=En;Gn<Vn;Gn++){const Kn=kn.glyphAt(Gn);Kn.x=jt-(Kn.x+Kn.width-fr)}break}}let Dn;const Hn=jn=>Dn=jn;for(let jn=0;jn<Nn;jn++){const qn=kn.glyphAt(jn);Dn=qn.glyphObj;const hr=Dn.index,fr=an.levels[qn.charIndex]&1;if(fr){const jt=_.getMirroredCharacter(ft[qn.charIndex]);jt&&qn.fontData.fontObj.forEachGlyph(jt,0,0,Hn)}if(Lt){const{charIndex:jt,fontData:hn}=qn,En=qn.x+mn,Vn=qn.x+qn.width+mn;yn[jt*4]=fr?Vn:En,yn[jt*4+1]=fr?En:Vn,yn[jt*4+2]=kn.baseline+hn.caretBottom+sn,yn[jt*4+3]=kn.baseline+hn.caretTop+sn;const Gn=jt-Sn;Gn>1&&lt(yn,Sn,Gn),Sn=jt}if(Nt){const{charIndex:jt}=qn;for(;jt>gn;)gn++,Nt.hasOwnProperty(gn)&&(Mn=Nt[gn])}if(!Dn.isWhitespace&&!Dn.isEmpty){const jt=pn++,{fontSizeMult:hn,src:En,index:Vn}=qn.fontData,Gn=wn[En]||(wn[En]={});Gn[hr]||(Gn[hr]={path:Dn.path,pathBounds:[Dn.xMin,Dn.yMin,Dn.xMax,Dn.yMax]});const Kn=qn.x+mn,br=qn.y+kn.baseline+sn;un[jt*2]=Kn,un[jt*2+1]=br;const gr=Kn+Dn.xMin*hn,Er=br+Dn.yMin*hn,Tr=Kn+Dn.xMax*hn,zr=br+Dn.yMax*hn;gr<Vt[0]&&(Vt[0]=gr),Er<Vt[1]&&(Vt[1]=Er),Tr>Vt[2]&&(Vt[2]=Tr),zr>Vt[3]&&(Vt[3]=zr),jt%Ot===0&&(Rn={start:jt,end:jt,rect:[1/0,1/0,-1/0,-1/0]},fn.push(Rn)),Rn.end++;const wr=Rn.rect;if(gr<wr[0]&&(wr[0]=gr),Er<wr[1]&&(wr[1]=Er),Tr>wr[2]&&(wr[2]=Tr),zr>wr[3]&&(wr[3]=zr),Zt[jt]=hr,Qt[jt]=Vn,Nt){const Wr=jt*3;Tn[Wr]=Mn>>16&255,Tn[Wr+1]=Mn>>8&255,Tn[Wr+2]=Mn&255}}}}}),yn){const kn=ft.length-Sn;kn>1&&lt(yn,Sn,kn)}}const xn=[];_n.forEach(({index:an,src:pn,unitsPerEm:Sn,ascender:gn,descender:Rn,lineHeight:Mn,capHeight:kn,xHeight:Fn})=>{xn[an]={src:pn,unitsPerEm:Sn,ascender:gn,descender:Rn,lineHeight:Mn,capHeight:kn,xHeight:Fn}}),qt.typesetting=ct()-cn,zt({glyphIds:Zt,glyphFontIndices:Qt,glyphPositions:un,glyphData:wn,fontData:xn,caretPositions:yn,glyphColors:Tn,chunkedBounds:fn,fontSize:vt,topBaseline:sn+nn[0].baseline,blockBounds:[mn,sn-en,mn+ln,sn],visibleBounds:Vt,timings:qt})})}function ot(ft,dt){st({...ft,metricsOnly:!0},pt=>{const[mt,vt,yt,_t]=pt.blockBounds;dt({width:yt-mt,height:_t-vt})})}function at(ft){let dt=ft.match(/^([\d.]+)%$/),pt=dt?parseFloat(dt[1]):NaN;return isNaN(pt)?0:pt/100}function lt(ft,dt,pt){const mt=ft[dt*4],vt=ft[dt*4+1],yt=ft[dt*4+2],_t=ft[dt*4+3],St=(vt-mt)/pt;for(let bt=0;bt<pt;bt++){const Et=(dt+bt)*4;ft[Et]=mt+St*bt,ft[Et+1]=mt+St*(bt+1),ft[Et+2]=yt,ft[Et+3]=_t}}function ct(){return(self.performance||Date).now()}function ht(){this.data=[]}const ut=["glyphObj","x","y","width","charIndex","fontData"];return ht.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/ut.length)},glyphAt(ft){let dt=ht.flyweight;return dt.data=this.data,dt.index=ft,dt},splitAt(ft){let dt=new ht;return dt.data=this.data.splice(ft*ut.length),dt}},ht.flyweight=ut.reduce((ft,dt,pt,mt)=>(Object.defineProperty(ft,dt,{get(){return this.data[this.index*ut.length+pt]},set(vt){this.data[this.index*ut.length+pt]=vt}}),ft),{data:null,index:0}),{typeset:st,measure:ot}}const now=()=>(self.performance||Date).now(),mainThreadGenerator=SDFGenerator();let warned;function generateSDF(et,_,_e,tt,nt,rt,it,st,ot,at,lt=!0){return lt?generateSDF_GL(et,_,_e,tt,nt,rt,it,st,ot,at).then(null,ct=>(warned||(console.warn("WebGL SDF generation failed, falling back to JS",ct),warned=!0),generateSDF_JS_Worker(et,_,_e,tt,nt,rt,it,st,ot,at))):generateSDF_JS_Worker(et,_,_e,tt,nt,rt,it,st,ot,at)}const queue$1=[],chunkTimeBudget=5;let timer=0;function nextChunk(){const et=now();for(;queue$1.length&&now()-et<chunkTimeBudget;)queue$1.shift()();timer=queue$1.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...et)=>new Promise((_,_e)=>{queue$1.push(()=>{const tt=now();try{mainThreadGenerator.webgl.generateIntoCanvas(...et),_({timing:now()-tt})}catch(nt){_e(nt)}}),timer||(timer=setTimeout(nextChunk,0))}),threadCount=4,idleTimeout=2e3,threads={};let callNum=0;function generateSDF_JS_Worker(et,_,_e,tt,nt,rt,it,st,ot,at){const lt="TroikaTextSDFGenerator_JS_"+callNum++%threadCount;let ct=threads[lt];return ct||(ct=threads[lt]={workerModule:defineWorkerModule({name:lt,workerId:lt,dependencies:[SDFGenerator,now],init(ht,ut){const ft=ht().javascript.generate;return function(...dt){const pt=ut();return{textureData:ft(...dt),timing:ut()-pt}}},getTransferables(ht){return[ht.textureData.buffer]}}),requests:0,idleTimer:null}),ct.requests++,clearTimeout(ct.idleTimer),ct.workerModule(et,_,_e,tt,nt,rt).then(({textureData:ht,timing:ut})=>{const ft=now(),dt=new Uint8Array(ht.length*4);for(let pt=0;pt<ht.length;pt++)dt[pt*4+at]=ht[pt];return mainThreadGenerator.webglUtils.renderImageData(it,dt,st,ot,et,_,1<<3-at),ut+=now()-ft,--ct.requests===0&&(ct.idleTimer=setTimeout(()=>{terminateWorker(lt)},idleTimeout)),{timing:ut}})}function warmUpSDFCanvas(et){et._warm||(mainThreadGenerator.webgl.isSupported(et),et._warm=!0)}const resizeWebGLCanvasWithoutClearing=mainThreadGenerator.webglUtils.resizeWebGLCanvasWithoutClearing,CONFIG={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},tempColor=new Color$1;function now$1(){return(self.performance||Date).now()}const atlases=Object.create(null);function getTextRenderInfo(et,_){et=assign$1({},et);const _e=now$1(),{defaultFontURL:tt}=CONFIG,nt=[];if(tt&&nt.push({label:"default",src:toAbsoluteURL(tt)}),et.font&&nt.push({label:"user",src:toAbsoluteURL(et.font)}),et.font=nt,et.text=""+et.text,et.sdfGlyphSize=et.sdfGlyphSize||CONFIG.sdfGlyphSize,et.unicodeFontsURL=et.unicodeFontsURL||CONFIG.unicodeFontsURL,et.colorRanges!=null){let ht={};for(let ut in et.colorRanges)if(et.colorRanges.hasOwnProperty(ut)){let ft=et.colorRanges[ut];typeof ft!="number"&&(ft=tempColor.set(ft).getHex()),ht[ut]=ft}et.colorRanges=ht}Object.freeze(et);const{textureWidth:rt,sdfExponent:it}=CONFIG,{sdfGlyphSize:st}=et,ot=rt/st*4;let at=atlases[st];if(!at){const ht=document.createElement("canvas");ht.width=rt,ht.height=st*256/ot,at=atlases[st]={glyphCount:0,sdfGlyphSize:st,sdfCanvas:ht,sdfTexture:new Texture$1(ht,void 0,void 0,void 0,LinearFilter,LinearFilter),contextLost:!1,glyphsByFont:new Map},at.sdfTexture.generateMipmaps=!1,initContextLossHandling(at)}const{sdfTexture:lt,sdfCanvas:ct}=at;typesetInWorker(et).then(ht=>{const{glyphIds:ut,glyphFontIndices:ft,fontData:dt,glyphPositions:pt,fontSize:mt,timings:vt}=ht,yt=[],_t=new Float32Array(ut.length*4);let St=0,bt=0;const Et=now$1(),Mt=dt.map(It=>{let Dt=at.glyphsByFont.get(It.src);return Dt||at.glyphsByFont.set(It.src,Dt=new Map),Dt});ut.forEach((It,Dt)=>{const Ft=ft[Dt],{src:$t,unitsPerEm:Yt}=dt[Ft];let Lt=Mt[Ft].get(It);if(!Lt){const{path:qt,pathBounds:Gt}=ht.glyphData[$t][It],Xt=Math.max(Gt[2]-Gt[0],Gt[3]-Gt[1])/st*(CONFIG.sdfMargin*st+.5),Zt=at.glyphCount++,Qt=[Gt[0]-Xt,Gt[1]-Xt,Gt[2]+Xt,Gt[3]+Xt];Mt[Ft].set(It,Lt={path:qt,atlasIndex:Zt,sdfViewBox:Qt}),yt.push(Lt)}const{sdfViewBox:Ot}=Lt,Nt=pt[bt++],zt=pt[bt++],Ht=mt/Yt;_t[St++]=Nt+Ot[0]*Ht,_t[St++]=zt+Ot[1]*Ht,_t[St++]=Nt+Ot[2]*Ht,_t[St++]=zt+Ot[3]*Ht,ut[Dt]=Lt.atlasIndex}),vt.quads=(vt.quads||0)+(now$1()-Et);const Tt=now$1();vt.sdf={};const wt=ct.height,Ct=Math.ceil(at.glyphCount/ot),Rt=Math.pow(2,Math.ceil(Math.log2(Ct*st)));Rt>wt&&(console.info(`Increasing SDF texture size ${wt}->${Rt}`),resizeWebGLCanvasWithoutClearing(ct,rt,Rt),lt.dispose()),Promise.all(yt.map(It=>generateGlyphSDF(It,at,et.gpuAccelerateSDF).then(({timing:Dt})=>{vt.sdf[It.atlasIndex]=Dt}))).then(()=>{yt.length&&!at.contextLost&&(safariPre15Workaround(at),lt.needsUpdate=!0),vt.sdfTotal=now$1()-Tt,vt.total=now$1()-_e,_(Object.freeze({parameters:et,sdfTexture:lt,sdfGlyphSize:st,sdfExponent:it,glyphBounds:_t,glyphAtlasIndices:ut,glyphColors:ht.glyphColors,caretPositions:ht.caretPositions,chunkedBounds:ht.chunkedBounds,ascender:ht.ascender,descender:ht.descender,lineHeight:ht.lineHeight,capHeight:ht.capHeight,xHeight:ht.xHeight,topBaseline:ht.topBaseline,blockBounds:ht.blockBounds,visibleBounds:ht.visibleBounds,timings:ht.timings}))})}),Promise.resolve().then(()=>{at.contextLost||warmUpSDFCanvas(ct)})}function generateGlyphSDF({path:et,atlasIndex:_,sdfViewBox:_e},{sdfGlyphSize:tt,sdfCanvas:nt,contextLost:rt},it){if(rt)return Promise.resolve({timing:-1});const{textureWidth:st,sdfExponent:ot}=CONFIG,at=Math.max(_e[2]-_e[0],_e[3]-_e[1]),lt=Math.floor(_/4),ct=lt%(st/tt)*tt,ht=Math.floor(lt/(st/tt))*tt,ut=_%4;return generateSDF(tt,tt,et,_e,at,ot,nt,ct,ht,ut,it)}function initContextLossHandling(et){const _=et.sdfCanvas;_.addEventListener("webglcontextlost",_e=>{console.log("Context Lost",_e),_e.preventDefault(),et.contextLost=!0}),_.addEventListener("webglcontextrestored",_e=>{console.log("Context Restored",_e),et.contextLost=!1;const tt=[];et.glyphsByFont.forEach(nt=>{nt.forEach(rt=>{tt.push(generateGlyphSDF(rt,et,!0))})}),Promise.all(tt).then(()=>{safariPre15Workaround(et),et.sdfTexture.needsUpdate=!0})})}function assign$1(et,_){for(let _e in _)_.hasOwnProperty(_e)&&(et[_e]=_[_e]);return et}let linkEl;function toAbsoluteURL(et){return linkEl||(linkEl=typeof document>"u"?{}:document.createElement("a")),linkEl.href=et,linkEl.href}function safariPre15Workaround(et){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:_,sdfTexture:_e}=et,{width:tt,height:nt}=_,rt=et.sdfCanvas.getContext("webgl");let it=_e.image.data;(!it||it.length!==tt*nt*4)&&(it=new Uint8Array(tt*nt*4),_e.image={width:tt,height:nt,data:it},_e.flipY=!1,_e.isDataTexture=!0),rt.readPixels(0,0,tt,nt,rt.RGBA,rt.UNSIGNED_BYTE,it)}}const typesetterWorkerModule=defineWorkerModule({name:"Typesetter",dependencies:[createTypesetter,fontResolverWorkerModule,bidiFactory],init(et,_,_e){return et(_,_e())}}),typesetInWorker=defineWorkerModule({name:"Typesetter",dependencies:[typesetterWorkerModule],init(et){return function(_){return new Promise(_e=>{et.typeset(_,_e)})}},getTransferables(et){const _=[];for(let _e in et)et[_e]&&et[_e].buffer&&_.push(et[_e].buffer);return _}}),templateGeometries={};function getTemplateGeometry(et){let _=templateGeometries[et];if(!_){const _e=new PlaneGeometry(1,1,et,et),tt=_e.clone(),nt=_e.attributes,rt=tt.attributes,it=new BufferGeometry,st=nt.uv.count;for(let ot=0;ot<st;ot++)rt.position.array[ot*3]*=-1,rt.normal.array[ot*3+2]*=-1;["position","normal","uv"].forEach(ot=>{it.setAttribute(ot,new Float32BufferAttribute([...nt[ot].array,...rt[ot].array],nt[ot].itemSize))}),it.setIndex([..._e.index.array,...tt.index.array.map(ot=>ot+st)]),it.translate(.5,.5,0),_=templateGeometries[et]=it}return _}const glyphBoundsAttrName="aTroikaGlyphBounds",glyphIndexAttrName="aTroikaGlyphIndex",glyphColorAttrName="aTroikaGlyphColor";class GlyphsGeometry extends InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Sphere,this.boundingBox=new Box3}computeBoundingSphere(){}computeBoundingBox(){}setSide(_){const _e=this.getIndex().count;this.setDrawRange(_===BackSide?_e/2:0,_===DoubleSide?_e:_e/2)}set detail(_){if(_!==this._detail){this._detail=_,(typeof _!="number"||_<1)&&(_=1);let _e=getTemplateGeometry(_);["position","normal","uv"].forEach(tt=>{this.attributes[tt]=_e.attributes[tt].clone()}),this.setIndex(_e.getIndex().clone())}}get detail(){return this._detail}set curveRadius(_){_!==this._curveRadius&&(this._curveRadius=_,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(_,_e,tt,nt,rt){updateBufferAttr(this,glyphBoundsAttrName,_,4),updateBufferAttr(this,glyphIndexAttrName,_e,1),updateBufferAttr(this,glyphColorAttrName,rt,3),this._blockBounds=tt,this._chunkedBounds=nt,this.instanceCount=_e.length,this._updateBounds()}_updateBounds(){const _=this._blockBounds;if(_){const{curveRadius:_e,boundingBox:tt}=this;if(_e){const{PI:nt,floor:rt,min:it,max:st,sin:ot,cos:at}=Math,lt=nt/2,ct=nt*2,ht=Math.abs(_e),ut=_[0]/ht,ft=_[2]/ht,dt=rt((ut+lt)/ct)!==rt((ft+lt)/ct)?-ht:it(ot(ut)*ht,ot(ft)*ht),pt=rt((ut-lt)/ct)!==rt((ft-lt)/ct)?ht:st(ot(ut)*ht,ot(ft)*ht),mt=rt((ut+nt)/ct)!==rt((ft+nt)/ct)?ht*2:st(ht-at(ut)*ht,ht-at(ft)*ht);tt.min.set(dt,_[1],_e<0?-mt:0),tt.max.set(pt,_[3],_e<0?0:mt)}else tt.min.set(_[0],_[1],0),tt.max.set(_[2],_[3],0);tt.getBoundingSphere(this.boundingSphere)}}applyClipRect(_){let _e=this.getAttribute(glyphIndexAttrName).count,tt=this._chunkedBounds;if(tt)for(let nt=tt.length;nt--;){_e=tt[nt].end;let rt=tt[nt].rect;if(rt[1]<_.w&&rt[3]>_.y&&rt[0]<_.z&&rt[2]>_.x)break}this.instanceCount=_e}}function updateBufferAttr(et,_,_e,tt){const nt=et.getAttribute(_);_e?nt&&nt.array.length===_e.length?(nt.array.set(_e),nt.needsUpdate=!0):(et.setAttribute(_,new InstancedBufferAttribute(_e,tt)),delete et._maxInstanceCount,et.dispose()):nt&&et.deleteAttribute(_)}const VERTEX_DEFS=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VERTEX_TRANSFORM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,FRAGMENT_DEFS=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,FRAGMENT_TRANSFORM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function createTextDerivedMaterial(et){const _=createDerivedMaterial(et,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vector4(0,0,0,0)},uTroikaClipRect:{value:new Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Color$1},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:VERTEX_DEFS,vertexTransform:VERTEX_TRANSFORM,fragmentDefs:FRAGMENT_DEFS,fragmentColorTransform:FRAGMENT_TRANSFORM,customRewriter({vertexShader:_e,fragmentShader:tt}){let nt=/\buniform\s+vec3\s+diffuse\b/;return nt.test(tt)&&(tt=tt.replace(nt,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),nt.test(_e)||(_e=_e.replace(voidMainRegExp,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:_e,fragmentShader:tt}}});return _.transparent=!0,Object.defineProperties(_,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),_}const defaultMaterial=new MeshBasicMaterial({color:16777215,side:DoubleSide,transparent:!0}),defaultStrokeColor=8421504,tempMat4=new Matrix4,tempVec3a=new Vector3,tempVec3b=new Vector3,tempArray=[],origin=new Vector3,defaultOrient="+x+y";function first(et){return Array.isArray(et)?et[0]:et}let getFlatRaycastMesh=()=>{const et=new Mesh(new PlaneGeometry(1,1),defaultMaterial);return getFlatRaycastMesh=()=>et,et},getCurvedRaycastMesh=()=>{const et=new Mesh(new PlaneGeometry(1,1,32,1),defaultMaterial);return getCurvedRaycastMesh=()=>et,et};const syncStartEvent={type:"syncstart"},syncCompleteEvent={type:"synccomplete"},SYNCABLE_PROPS=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],COPYABLE_PROPS=SYNCABLE_PROPS.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Text$1=class extends Mesh{constructor(){const _=new GlyphsGeometry;super(_,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=defaultStrokeColor,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=defaultOrient,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(_){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(_):(this._isSyncing=!0,this.dispatchEvent(syncStartEvent),getTextRenderInfo({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},_e=>{this._isSyncing=!1,this._textRenderInfo=_e,this.geometry.updateGlyphs(_e.glyphBounds,_e.glyphAtlasIndices,_e.blockBounds,_e.chunkedBounds,_e.glyphColors);const tt=this._queuedSyncs;tt&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{tt.forEach(nt=>nt&&nt())})),this.dispatchEvent(syncCompleteEvent),_&&_()})))}onBeforeRender(_,_e,tt,nt,rt,it){this.sync(),rt.isTroikaTextMaterial&&this._prepareForRender(rt),rt._hadOwnSide=rt.hasOwnProperty("side"),this.geometry.setSide(rt._actualSide=rt.side),rt.side=FrontSide}onAfterRender(_,_e,tt,nt,rt,it){rt._hadOwnSide?rt.side=rt._actualSide:delete rt.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let _=this._derivedMaterial;const _e=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=defaultMaterial.clone());if((!_||_.baseMaterial!==_e)&&(_=this._derivedMaterial=createTextDerivedMaterial(_e),_e.addEventListener("dispose",function tt(){_e.removeEventListener("dispose",tt),_.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let tt=_._outlineMtl;return tt||(tt=_._outlineMtl=Object.create(_,{id:{value:_.id+.1}}),tt.isTextOutlineMaterial=!0,tt.depthWrite=!1,tt.map=null,_.addEventListener("dispose",function nt(){_.removeEventListener("dispose",nt),tt.dispose()})),[tt,_]}else return _}set material(_){_&&_.isTroikaTextMaterial?(this._derivedMaterial=_,this._baseMaterial=_.baseMaterial):this._baseMaterial=_}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(_){this.geometry.detail=_}get curveRadius(){return this.geometry.curveRadius}set curveRadius(_){this.geometry.curveRadius=_}get customDepthMaterial(){return first(this.material).getDepthMaterial()}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}_prepareForRender(_){const _e=_.isTextOutlineMaterial,tt=_.uniforms,nt=this.textRenderInfo;if(nt){const{sdfTexture:st,blockBounds:ot}=nt;tt.uTroikaSDFTexture.value=st,tt.uTroikaSDFTextureSize.value.set(st.image.width,st.image.height),tt.uTroikaSDFGlyphSize.value=nt.sdfGlyphSize,tt.uTroikaSDFExponent.value=nt.sdfExponent,tt.uTroikaTotalBounds.value.fromArray(ot),tt.uTroikaUseGlyphColors.value=!_e&&!!nt.glyphColors;let at=0,lt=0,ct=0,ht,ut,ft,dt=0,pt=0;if(_e){let{outlineWidth:vt,outlineOffsetX:yt,outlineOffsetY:_t,outlineBlur:St,outlineOpacity:bt}=this;at=this._parsePercent(vt)||0,lt=Math.max(0,this._parsePercent(St)||0),ht=bt,dt=this._parsePercent(yt)||0,pt=this._parsePercent(_t)||0}else ct=Math.max(0,this._parsePercent(this.strokeWidth)||0),ct&&(ft=this.strokeColor,tt.uTroikaStrokeColor.value.set(ft??defaultStrokeColor),ut=this.strokeOpacity,ut==null&&(ut=1)),ht=this.fillOpacity;tt.uTroikaDistanceOffset.value=at,tt.uTroikaPositionOffset.value.set(dt,pt),tt.uTroikaBlurRadius.value=lt,tt.uTroikaStrokeWidth.value=ct,tt.uTroikaStrokeOpacity.value=ut,tt.uTroikaFillOpacity.value=ht??1,tt.uTroikaCurveRadius.value=this.curveRadius||0;let mt=this.clipRect;if(mt&&Array.isArray(mt)&&mt.length===4)tt.uTroikaClipRect.value.fromArray(mt);else{const vt=(this.fontSize||.1)*100;tt.uTroikaClipRect.value.set(ot[0]-vt,ot[1]-vt,ot[2]+vt,ot[3]+vt)}this.geometry.applyClipRect(tt.uTroikaClipRect.value)}tt.uTroikaSDFDebug.value=!!this.debugSDF,_.polygonOffset=!!this.depthOffset,_.polygonOffsetFactor=_.polygonOffsetUnits=this.depthOffset||0;const rt=_e?this.outlineColor||0:this.color;if(rt==null)delete _.color;else{const st=_.hasOwnProperty("color")?_.color:_.color=new Color$1;(rt!==st._input||typeof rt=="object")&&st.set(st._input=rt)}let it=this.orientation||defaultOrient;if(it!==_._orientation){let st=tt.uTroikaOrient.value;it=it.replace(/[^-+xyz]/g,"");let ot=it!==defaultOrient&&it.match(/^([-+])([xyz])([-+])([xyz])$/);if(ot){let[,at,lt,ct,ht]=ot;tempVec3a.set(0,0,0)[lt]=at==="-"?1:-1,tempVec3b.set(0,0,0)[ht]=ct==="-"?-1:1,tempMat4.lookAt(origin,tempVec3a.cross(tempVec3b),tempVec3b),st.setFromMatrix4(tempMat4)}else st.identity();_._orientation=it}}_parsePercent(_){if(typeof _=="string"){let _e=_.match(/^(-?[\d.]+)%$/),tt=_e?parseFloat(_e[1]):NaN;_=(isNaN(tt)?0:tt/100)*this.fontSize}return _}localPositionToTextCoords(_,_e=new Vector2){_e.copy(_);const tt=this.curveRadius;return tt&&(_e.x=Math.atan2(_.x,Math.abs(tt)-Math.abs(_.z))*Math.abs(tt)),_e}worldPositionToTextCoords(_,_e=new Vector2){return tempVec3a.copy(_),this.localPositionToTextCoords(this.worldToLocal(tempVec3a),_e)}raycast(_,_e){const{textRenderInfo:tt,curveRadius:nt}=this;if(tt){const rt=tt.blockBounds,it=nt?getCurvedRaycastMesh():getFlatRaycastMesh(),st=it.geometry,{position:ot,uv:at}=st.attributes;for(let lt=0;lt<at.count;lt++){let ct=rt[0]+at.getX(lt)*(rt[2]-rt[0]);const ht=rt[1]+at.getY(lt)*(rt[3]-rt[1]);let ut=0;nt&&(ut=nt-Math.cos(ct/nt)*nt,ct=Math.sin(ct/nt)*nt),ot.setXYZ(lt,ct,ht,ut)}st.boundingSphere=this.geometry.boundingSphere,st.boundingBox=this.geometry.boundingBox,it.matrixWorld=this.matrixWorld,it.material.side=this.material.side,tempArray.length=0,it.raycast(_,tempArray);for(let lt=0;lt<tempArray.length;lt++)tempArray[lt].object=this,_e.push(tempArray[lt])}}copy(_){const _e=this.geometry;return super.copy(_),this.geometry=_e,COPYABLE_PROPS.forEach(tt=>{this[tt]=_[tt]}),this}clone(){return new this.constructor().copy(this)}};SYNCABLE_PROPS.forEach(et=>{const _="_private_"+et;Object.defineProperty(Text$1.prototype,et,{get(){return this[_]},set(_e){_e!==this[_]&&(this[_]=_e,this._needsSync=!0)}})});const fonts={"DM Serif":"/Font/DMSerifText-Regular.ttf","LaBelle Aurore":"/Font/LaBelleAurore-Regular.ttf","League Gothic":"/Font/LeagueGothic-Regular.ttf","Space Mono":"/Font/SpaceMono-Regular.ttf",Caveat:"/Font/Caveat-Regular.ttf"},commonTitleOption={fontSize:10,maxWidth:300,lineHeight:1,letterSpacing:0,textAlign:"center",materialType:"MeshBasicMaterial"},commonTextOption={fontSize:3,maxWidth:300,lineHeight:1,letterSpacing:0,textAlign:"center",materialType:"MeshBasicMaterial"},titleString=["Developer","Extrovert","Magician","Artist","Explorer"],textString=[`Pursuing Frontend
React, Three, Vite`,`I know it looks like it, but
I'm not a shut-in, I touch grass`,`If you have an idea
I can turn it into reality`,`Artists use a brush
I use a keyboard`,`I go wherever
My curiosity takes me`],title=[{...commonTitleOption,fontSize:8,font:fonts["Space Mono"],color:MatterTone.White,text:titleString[0]},{...commonTitleOption,font:fonts.Caveat,color:MatterColor.Red,text:titleString[1]},{...commonTitleOption,font:fonts["DM Serif"],color:MatterColor.Yellow,text:titleString[2]},{...commonTitleOption,font:fonts["LaBelle Aurore"],color:MatterColor.Green,text:titleString[3]},{...commonTitleOption,font:fonts["League Gothic"],color:MatterColor.Blue,text:titleString[4]}],sub=[{...commonTextOption,font:fonts["Space Mono"],color:MatterTone.White,text:textString[0]},{...commonTextOption,font:fonts.Caveat,color:MatterColor.Red,text:textString[1]},{...commonTextOption,font:fonts["DM Serif"],color:MatterColor.Yellow,text:textString[2]},{...commonTextOption,font:fonts["Space Mono"],color:MatterColor.Green,text:textString[3]},{...commonTextOption,font:fonts["League Gothic"],color:MatterColor.Blue,text:textString[4]}],_face=new Triangle,_color$1=new Vector3,_uva=new Vector2,_uvb=new Vector2,_uvc=new Vector2;class MeshSurfaceSampler{constructor(_){this.geometry=_.geometry,this.randomFunction=Math.random,this.indexAttribute=this.geometry.index,this.positionAttribute=this.geometry.getAttribute("position"),this.normalAttribute=this.geometry.getAttribute("normal"),this.colorAttribute=this.geometry.getAttribute("color"),this.uvAttribute=this.geometry.getAttribute("uv"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(_){return this.weightAttribute=_?this.geometry.getAttribute(_):null,this}build(){const _=this.indexAttribute,_e=this.positionAttribute,tt=this.weightAttribute,nt=_?_.count/3:_e.count/3,rt=new Float32Array(nt);for(let ot=0;ot<nt;ot++){let at=1,lt=3*ot,ct=3*ot+1,ht=3*ot+2;_&&(lt=_.getX(lt),ct=_.getX(ct),ht=_.getX(ht)),tt&&(at=tt.getX(lt)+tt.getX(ct)+tt.getX(ht)),_face.a.fromBufferAttribute(_e,lt),_face.b.fromBufferAttribute(_e,ct),_face.c.fromBufferAttribute(_e,ht),at*=_face.getArea(),rt[ot]=at}const it=new Float32Array(nt);let st=0;for(let ot=0;ot<nt;ot++)st+=rt[ot],it[ot]=st;return this.distribution=it,this}setRandomGenerator(_){return this.randomFunction=_,this}sample(_,_e,tt,nt){const rt=this.sampleFaceIndex();return this.sampleFace(rt,_,_e,tt,nt)}sampleFaceIndex(){const _=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*_)}binarySearch(_){const _e=this.distribution;let tt=0,nt=_e.length-1,rt=-1;for(;tt<=nt;){const it=Math.ceil((tt+nt)/2);if(it===0||_e[it-1]<=_&&_e[it]>_){rt=it;break}else _<_e[it]?nt=it-1:tt=it+1}return rt}sampleFace(_,_e,tt,nt,rt){let it=this.randomFunction(),st=this.randomFunction();it+st>1&&(it=1-it,st=1-st);const ot=this.indexAttribute;let at=_*3,lt=_*3+1,ct=_*3+2;return ot&&(at=ot.getX(at),lt=ot.getX(lt),ct=ot.getX(ct)),_face.a.fromBufferAttribute(this.positionAttribute,at),_face.b.fromBufferAttribute(this.positionAttribute,lt),_face.c.fromBufferAttribute(this.positionAttribute,ct),_e.set(0,0,0).addScaledVector(_face.a,it).addScaledVector(_face.b,st).addScaledVector(_face.c,1-(it+st)),tt!==void 0&&(this.normalAttribute!==void 0?(_face.a.fromBufferAttribute(this.normalAttribute,at),_face.b.fromBufferAttribute(this.normalAttribute,lt),_face.c.fromBufferAttribute(this.normalAttribute,ct),tt.set(0,0,0).addScaledVector(_face.a,it).addScaledVector(_face.b,st).addScaledVector(_face.c,1-(it+st)).normalize()):_face.getNormal(tt)),nt!==void 0&&this.colorAttribute!==void 0&&(_face.a.fromBufferAttribute(this.colorAttribute,at),_face.b.fromBufferAttribute(this.colorAttribute,lt),_face.c.fromBufferAttribute(this.colorAttribute,ct),_color$1.set(0,0,0).addScaledVector(_face.a,it).addScaledVector(_face.b,st).addScaledVector(_face.c,1-(it+st)),nt.r=_color$1.x,nt.g=_color$1.y,nt.b=_color$1.z),rt!==void 0&&this.uvAttribute!==void 0&&(_uva.fromBufferAttribute(this.uvAttribute,at),_uvb.fromBufferAttribute(this.uvAttribute,lt),_uvc.fromBufferAttribute(this.uvAttribute,ct),rt.set(0,0).addScaledVector(_uva,it).addScaledVector(_uvb,st).addScaledVector(_uvc,1-(it+st))),this}}const _object_pattern=/^[og]\s*(.+)?/,_material_library_pattern=/^mtllib /,_material_use_pattern=/^usemtl /,_map_use_pattern=/^usemap /,_face_vertex_data_separator_pattern=/\s+/,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_ab=new Vector3,_cb=new Vector3,_color=new Color$1;function ParserState(){const et={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(_,_e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=_,this.object.fromDeclaration=_e!==!1;return}const tt=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:_||"",fromDeclaration:_e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(nt,rt){const it=this._finalize(!1);it&&(it.inherited||it.groupCount<=0)&&this.materials.splice(it.index,1);const st={index:this.materials.length,name:nt||"",mtllib:Array.isArray(rt)&&rt.length>0?rt[rt.length-1]:"",smooth:it!==void 0?it.smooth:this.smooth,groupStart:it!==void 0?it.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(ot){const at={index:typeof ot=="number"?ot:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return at.clone=this.clone.bind(at),at}};return this.materials.push(st),st},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(nt){const rt=this.currentMaterial();if(rt&&rt.groupEnd===-1&&(rt.groupEnd=this.geometry.vertices.length/3,rt.groupCount=rt.groupEnd-rt.groupStart,rt.inherited=!1),nt&&this.materials.length>1)for(let it=this.materials.length-1;it>=0;it--)this.materials[it].groupCount<=0&&this.materials.splice(it,1);return nt&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),rt}},tt&&tt.name&&typeof tt.clone=="function"){const nt=tt.clone(0);nt.inherited=!0,this.object.materials.push(nt)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(_,_e){const tt=parseInt(_,10);return(tt>=0?tt-1:tt+_e/3)*3},parseNormalIndex:function(_,_e){const tt=parseInt(_,10);return(tt>=0?tt-1:tt+_e/3)*3},parseUVIndex:function(_,_e){const tt=parseInt(_,10);return(tt>=0?tt-1:tt+_e/2)*2},addVertex:function(_,_e,tt){const nt=this.vertices,rt=this.object.geometry.vertices;rt.push(nt[_+0],nt[_+1],nt[_+2]),rt.push(nt[_e+0],nt[_e+1],nt[_e+2]),rt.push(nt[tt+0],nt[tt+1],nt[tt+2])},addVertexPoint:function(_){const _e=this.vertices;this.object.geometry.vertices.push(_e[_+0],_e[_+1],_e[_+2])},addVertexLine:function(_){const _e=this.vertices;this.object.geometry.vertices.push(_e[_+0],_e[_+1],_e[_+2])},addNormal:function(_,_e,tt){const nt=this.normals,rt=this.object.geometry.normals;rt.push(nt[_+0],nt[_+1],nt[_+2]),rt.push(nt[_e+0],nt[_e+1],nt[_e+2]),rt.push(nt[tt+0],nt[tt+1],nt[tt+2])},addFaceNormal:function(_,_e,tt){const nt=this.vertices,rt=this.object.geometry.normals;_vA.fromArray(nt,_),_vB.fromArray(nt,_e),_vC.fromArray(nt,tt),_cb.subVectors(_vC,_vB),_ab.subVectors(_vA,_vB),_cb.cross(_ab),_cb.normalize(),rt.push(_cb.x,_cb.y,_cb.z),rt.push(_cb.x,_cb.y,_cb.z),rt.push(_cb.x,_cb.y,_cb.z)},addColor:function(_,_e,tt){const nt=this.colors,rt=this.object.geometry.colors;nt[_]!==void 0&&rt.push(nt[_+0],nt[_+1],nt[_+2]),nt[_e]!==void 0&&rt.push(nt[_e+0],nt[_e+1],nt[_e+2]),nt[tt]!==void 0&&rt.push(nt[tt+0],nt[tt+1],nt[tt+2])},addUV:function(_,_e,tt){const nt=this.uvs,rt=this.object.geometry.uvs;rt.push(nt[_+0],nt[_+1]),rt.push(nt[_e+0],nt[_e+1]),rt.push(nt[tt+0],nt[tt+1])},addDefaultUV:function(){const _=this.object.geometry.uvs;_.push(0,0),_.push(0,0),_.push(0,0)},addUVLine:function(_){const _e=this.uvs;this.object.geometry.uvs.push(_e[_+0],_e[_+1])},addFace:function(_,_e,tt,nt,rt,it,st,ot,at){const lt=this.vertices.length;let ct=this.parseVertexIndex(_,lt),ht=this.parseVertexIndex(_e,lt),ut=this.parseVertexIndex(tt,lt);if(this.addVertex(ct,ht,ut),this.addColor(ct,ht,ut),st!==void 0&&st!==""){const ft=this.normals.length;ct=this.parseNormalIndex(st,ft),ht=this.parseNormalIndex(ot,ft),ut=this.parseNormalIndex(at,ft),this.addNormal(ct,ht,ut)}else this.addFaceNormal(ct,ht,ut);if(nt!==void 0&&nt!==""){const ft=this.uvs.length;ct=this.parseUVIndex(nt,ft),ht=this.parseUVIndex(rt,ft),ut=this.parseUVIndex(it,ft),this.addUV(ct,ht,ut),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(_){this.object.geometry.type="Points";const _e=this.vertices.length;for(let tt=0,nt=_.length;tt<nt;tt++){const rt=this.parseVertexIndex(_[tt],_e);this.addVertexPoint(rt),this.addColor(rt)}},addLineGeometry:function(_,_e){this.object.geometry.type="Line";const tt=this.vertices.length,nt=this.uvs.length;for(let rt=0,it=_.length;rt<it;rt++)this.addVertexLine(this.parseVertexIndex(_[rt],tt));for(let rt=0,it=_e.length;rt<it;rt++)this.addUVLine(this.parseUVIndex(_e[rt],nt))}};return et.startObject("",!1),et}class OBJLoader extends Loader{constructor(_){super(_),this.materials=null}load(_,_e,tt,nt){const rt=this,it=new FileLoader(this.manager);it.setPath(this.path),it.setRequestHeader(this.requestHeader),it.setWithCredentials(this.withCredentials),it.load(_,function(st){try{_e(rt.parse(st))}catch(ot){nt?nt(ot):console.error(ot),rt.manager.itemError(_)}},tt,nt)}setMaterials(_){return this.materials=_,this}parse(_){const _e=new ParserState;_.indexOf(`\r
`)!==-1&&(_=_.replace(/\r\n/g,`
`)),_.indexOf(`\\
`)!==-1&&(_=_.replace(/\\\n/g,""));const tt=_.split(`
`);let nt=[];for(let st=0,ot=tt.length;st<ot;st++){const at=tt[st].trimStart();if(at.length===0)continue;const lt=at.charAt(0);if(lt!=="#")if(lt==="v"){const ct=at.split(_face_vertex_data_separator_pattern);switch(ct[0]){case"v":_e.vertices.push(parseFloat(ct[1]),parseFloat(ct[2]),parseFloat(ct[3])),ct.length>=7?(_color.setRGB(parseFloat(ct[4]),parseFloat(ct[5]),parseFloat(ct[6])).convertSRGBToLinear(),_e.colors.push(_color.r,_color.g,_color.b)):_e.colors.push(void 0,void 0,void 0);break;case"vn":_e.normals.push(parseFloat(ct[1]),parseFloat(ct[2]),parseFloat(ct[3]));break;case"vt":_e.uvs.push(parseFloat(ct[1]),parseFloat(ct[2]));break}}else if(lt==="f"){const ht=at.slice(1).trim().split(_face_vertex_data_separator_pattern),ut=[];for(let dt=0,pt=ht.length;dt<pt;dt++){const mt=ht[dt];if(mt.length>0){const vt=mt.split("/");ut.push(vt)}}const ft=ut[0];for(let dt=1,pt=ut.length-1;dt<pt;dt++){const mt=ut[dt],vt=ut[dt+1];_e.addFace(ft[0],mt[0],vt[0],ft[1],mt[1],vt[1],ft[2],mt[2],vt[2])}}else if(lt==="l"){const ct=at.substring(1).trim().split(" ");let ht=[];const ut=[];if(at.indexOf("/")===-1)ht=ct;else for(let ft=0,dt=ct.length;ft<dt;ft++){const pt=ct[ft].split("/");pt[0]!==""&&ht.push(pt[0]),pt[1]!==""&&ut.push(pt[1])}_e.addLineGeometry(ht,ut)}else if(lt==="p"){const ht=at.slice(1).trim().split(" ");_e.addPointGeometry(ht)}else if((nt=_object_pattern.exec(at))!==null){const ct=(" "+nt[0].slice(1).trim()).slice(1);_e.startObject(ct)}else if(_material_use_pattern.test(at))_e.object.startMaterial(at.substring(7).trim(),_e.materialLibraries);else if(_material_library_pattern.test(at))_e.materialLibraries.push(at.substring(7).trim());else if(_map_use_pattern.test(at))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(lt==="s"){if(nt=at.split(" "),nt.length>1){const ht=nt[1].trim().toLowerCase();_e.object.smooth=ht!=="0"&&ht!=="off"}else _e.object.smooth=!0;const ct=_e.object.currentMaterial();ct&&(ct.smooth=_e.object.smooth)}else{if(at==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+at+'"')}}_e.finalize();const rt=new Group;if(rt.materialLibraries=[].concat(_e.materialLibraries),!(_e.objects.length===1&&_e.objects[0].geometry.vertices.length===0)===!0)for(let st=0,ot=_e.objects.length;st<ot;st++){const at=_e.objects[st],lt=at.geometry,ct=at.materials,ht=lt.type==="Line",ut=lt.type==="Points";let ft=!1;if(lt.vertices.length===0)continue;const dt=new BufferGeometry;dt.setAttribute("position",new Float32BufferAttribute(lt.vertices,3)),lt.normals.length>0&&dt.setAttribute("normal",new Float32BufferAttribute(lt.normals,3)),lt.colors.length>0&&(ft=!0,dt.setAttribute("color",new Float32BufferAttribute(lt.colors,3))),lt.hasUVIndices===!0&&dt.setAttribute("uv",new Float32BufferAttribute(lt.uvs,2));const pt=[];for(let vt=0,yt=ct.length;vt<yt;vt++){const _t=ct[vt],St=_t.name+"_"+_t.smooth+"_"+ft;let bt=_e.materials[St];if(this.materials!==null){if(bt=this.materials.create(_t.name),ht&&bt&&!(bt instanceof LineBasicMaterial)){const Et=new LineBasicMaterial;Material.prototype.copy.call(Et,bt),Et.color.copy(bt.color),bt=Et}else if(ut&&bt&&!(bt instanceof PointsMaterial)){const Et=new PointsMaterial({size:10,sizeAttenuation:!1});Material.prototype.copy.call(Et,bt),Et.color.copy(bt.color),Et.map=bt.map,bt=Et}}bt===void 0&&(ht?bt=new LineBasicMaterial:ut?bt=new PointsMaterial({size:1,sizeAttenuation:!1}):bt=new MeshPhongMaterial,bt.name=_t.name,bt.flatShading=!_t.smooth,bt.vertexColors=ft,_e.materials[St]=bt),pt.push(bt)}let mt;if(pt.length>1){for(let vt=0,yt=ct.length;vt<yt;vt++){const _t=ct[vt];dt.addGroup(_t.groupStart,_t.groupCount,vt)}ht?mt=new LineSegments(dt,pt):ut?mt=new Points(dt,pt):mt=new Mesh(dt,pt)}else ht?mt=new LineSegments(dt,pt[0]):ut?mt=new Points(dt,pt[0]):mt=new Mesh(dt,pt[0]);mt.name=at.name,rt.add(mt)}else if(_e.vertices.length>0){const st=new PointsMaterial({size:1,sizeAttenuation:!1}),ot=new BufferGeometry;ot.setAttribute("position",new Float32BufferAttribute(_e.vertices,3)),_e.colors.length>0&&_e.colors[0]!==void 0&&(ot.setAttribute("color",new Float32BufferAttribute(_e.colors,3)),st.vertexColors=!0);const at=new Points(ot,st);rt.add(at)}return rt}}const loader=new OBJLoader,SamplePoints=(et,_,_e,tt,nt)=>{const rt=(nt==null?void 0:nt.scale)||1,it=(nt==null?void 0:nt.translation)||[0,0,0];loader.load(et,st=>{const ot=[];st.children.forEach((at,lt)=>{const ct=new MeshSurfaceSampler(at).setWeightAttribute(null).build();for(let ht=0;ht<_[lt];ht++){const ut=new Vector3;ct.sample(ut),ot.push([ut.x*rt+it[0],ut.y*rt+it[1],ut.z*rt+it[2]])}}),_e[tt]=ot},()=>{},st=>{console.log(st)})};extend$3({Text:Text$1});const colorOrder=[MatterTone.WhiteRGB,MatterColor.RedRGB,MatterColor.YellowRGB,MatterColor.GreenRGB,MatterColor.BlueRGB],TAU$1=Math.PI*2,pointCount=200,count=title.length;let wheelAnimating=!1,direction="",mousePosition$2={x:0,y:0};function ThreePage({containerRef:et,pageNumber:_}){const{active:_e,ready:tt}=usePage(),nt=reactExports.useRef([]),[rt,it,st]=useState(0);reactExports.useEffect(()=>{et.current.querySelectorAll("div").forEach(at=>{at.style.pointerEvents="none",at.style.backgroundColor="transparent"}),nt.current.forEach(at=>at.style.pointerEvents="auto")},[]),reactExports.useEffect(()=>{_e===_||et.current.classList.remove("show")},[_e]),reactExports.useEffect(()=>{tt===_&&et.current.classList.add("show")},[tt]);const ot=at=>{wheelAnimating||(wheelAnimating=!0,direction=at,it(umod(rt+(at==="up"?1:-1),count)))};return jsxRuntimeExports.jsxs("div",{className:"w-full h-full",children:[jsxRuntimeExports.jsxs(Canvas,{camera:{position:[0,0,200]},dpr:window.devicePixelRatio,children:[jsxRuntimeExports.jsx(Responsive,{}),jsxRuntimeExports.jsx(TextWheel,{index:rt,active:_e,ready:tt,pageNumber:_}),jsxRuntimeExports.jsx(Cloud$1,{index:rt,active:_e,ready:tt,pageNumber:_}),jsxRuntimeExports.jsx(Background,{index:rt,active:_e,ready:tt,pageNumber:_})]}),jsxRuntimeExports.jsx("div",{ref:at=>nt.current.push(at),className:"three-arrow-container left-0",onClick:()=>ot("up"),children:jsxRuntimeExports.jsx("div",{className:"three-arrow three-arrow-left",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",children:jsxRuntimeExports.jsx("path",{className:"fill-white",d:"M24 12.001H2.914l5.294-5.295-.707-.707L1 12.501l6.5 6.5.707-.707-5.293-5.293H24v-1z","data-name":"Left"})})})}),jsxRuntimeExports.jsx("div",{ref:at=>nt.current.push(at),className:"three-arrow-container right-0",onClick:()=>ot("down"),children:jsxRuntimeExports.jsx("div",{className:"three-arrow three-arrow-right",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",children:jsxRuntimeExports.jsx("path",{className:"fill-white",d:"m17.5 5.999-.707.707 5.293 5.293H1v1h21.086l-5.294 5.295.707.707L24 12.499l-6.5-6.5z","data-name":"Right"})})})})]})}const wheelRadius=70,wheelTilt=Math.PI/80,wheelDuration=1e3,subYOffset=10,angleStart=-2*Math.PI/(count-1),angleIncrement=2*Math.PI/count;function TextWheel({index:et,active:_,ready:_e,pageNumber:tt}){const nt=reactExports.useRef(),rt=reactExports.useRef(),it=reactExports.useRef();reactExports.useEffect(()=>{if(!direction)return;const lt=direction==="up"?`+=${angleIncrement}`:`-=${angleIncrement}`;animate(rt.current.rotation,{y:lt,ease:"outElastic(1, .6)",duration:wheelDuration,onComplete:()=>{rt.current.rotation.y%=TAU$1}}),animate(it.current.rotation,{y:lt,ease:"outElastic(1, .6)",duration:wheelDuration,onComplete:()=>{wheelAnimating=!1,it.current.rotation.y%=TAU$1}})},[et]);const st=reactExports.useMemo(()=>jsxRuntimeExports.jsx("group",{ref:rt,rotation:[0,angleStart,0],children:Array.from({length:count},(lt,ct)=>jsxRuntimeExports.jsx("text",{...title[ct],anchorX:"center",anchorY:"middle","position-z":Math.sin(ct/count*Math.PI*2)*wheelRadius,"position-x":Math.cos(ct/count*Math.PI*2)*wheelRadius,"rotation-y":-ct*Math.PI*2/count+Math.PI/2},ct))}),[]),ot=reactExports.useMemo(()=>jsxRuntimeExports.jsx("group",{ref:it,position:[0,-subYOffset,0],rotation:[0,angleStart,0],children:Array.from({length:count},(lt,ct)=>jsxRuntimeExports.jsx("text",{...sub[ct],anchorX:"center",anchorY:"middle","position-z":Math.sin(ct/count*Math.PI*2)*wheelRadius,"position-x":Math.cos(ct/count*Math.PI*2)*wheelRadius,"rotation-y":-ct*Math.PI*2/count+Math.PI/2},ct))}),[]),at=reactExports.useMemo(()=>nt.current?animate(nt.current.rotation,{z:[-wheelTilt,wheelTilt],easing:"easeOutQuad",duration:1e4,loop:!0,alternate:!0,autoplay:!1}):null,[nt.current]);return reactExports.useEffect(()=>{at&&(_e===tt||_===tt?at.play():at.pause())},[_e,_]),jsxRuntimeExports.jsxs("group",{ref:nt,children:[st,ot]})}const particleRadius=1,particleWidth=30,sphereRadius=50,points$1=Array.from({length:count},()=>null);function Cloud$1({index:et,active:_,ready:_e,pageNumber:tt}){const[nt,rt,it]=useState(!1),st=reactExports.useRef([]),ot=reactExports.useRef();reactExports.useEffect(()=>{points$1[0]=Array.from({length:pointCount},(ct,ht)=>{const ut=Math.random()*2-1,ft=Math.random()*2-1,dt=Math.random()*2-1,pt=Math.sqrt(ut*ut+ft*ft+dt*dt);return[sphereRadius*ut/pt,sphereRadius*ft/pt,sphereRadius*dt/pt]}),SamplePoints("/Model/star.obj",distribute(pointCount,[100]),points$1,1,{scale:40,translation:[0,-35,0]}),SamplePoints("/Model/wizard hat.obj",distribute(pointCount,[100]),points$1,2,{scale:20,translation:[10,-40,0]}),SamplePoints("/Model/easel.obj",distribute(pointCount,[50,50]),points$1,3,{scale:15,translation:[0,0,0]}),SamplePoints("/Model/cat.obj",distribute(pointCount,[50,10,10,30]),points$1,4,{scale:15,translation:[0,-20,-20]}),setTimeout(()=>{rt(!0)},1e3)},[]),reactExports.useEffect(()=>{it.current&&st.current.forEach((ct,ht)=>{ct&&(animate(ct.position,{x:points$1[et][ht][0],y:points$1[et][ht][1],z:points$1[et][ht][2],ease:"outElastic(1, .6)",duration:wheelDuration}),animate(ct.material.color,{r:colorOrder[et].r,g:colorOrder[et].g,b:colorOrder[et].b,ease:"outElastic(1, .6)",duration:wheelDuration}))})},[et]);const at=reactExports.useMemo(()=>it.current?jsxRuntimeExports.jsx("group",{ref:ot,children:Array.from({length:pointCount},(ht,ut)=>jsxRuntimeExports.jsxs("lineSegments",{ref:ft=>st.current.push(ft),position:points$1[et]?points$1[et][ut]:[0,0,0],rotation:[Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2],children:[jsxRuntimeExports.jsx("edgesGeometry",{args:[new TetrahedronGeometry(particleRadius)]}),jsxRuntimeExports.jsx("lineBasicMaterial",{color:colorOrder[et],linewidth:particleWidth})]},ut))}):jsxRuntimeExports.jsx("group",{ref:ot}),[it.current]),lt=reactExports.useMemo(()=>ot.current?animate(ot.current.rotation,{y:Math.PI*2,ease:"linear",duration:2e4,loop:!0,autoplay:!1}):null,[ot.current]);return reactExports.useEffect(()=>{lt&&(_e===tt||_===tt?lt.play():lt.pause())},[_e]),at}const backCount=100,cameraMovement=2,back=3,backBounding={x:[-wheelRadius*back,wheelRadius*back],y:[-wheelRadius*back,wheelRadius*back],z:[-80,0]};function Background({index:et,active:_,ready:_e,pageNumber:tt}){const nt=reactExports.useRef([]),{camera:rt}=useThree();return reactExports.useEffect(()=>{const st=ot=>{mousePosition$2.x=ot.clientX/window.innerWidth*2-1,mousePosition$2.y=-(ot.clientY/window.innerHeight)*2+1};return window.addEventListener("mousemove",st),()=>window.removeEventListener("mousemove",st)},[]),hasMouse&&useFrame(()=>{_e!==tt&&_!==tt||(rt.position.x=-mousePosition$2.x*cameraMovement,rt.position.y=-mousePosition$2.y*cameraMovement)}),reactExports.useEffect(()=>{nt.current.forEach((st,ot)=>{animate(st.material.color,{r:colorOrder[et].r,g:colorOrder[et].g,b:colorOrder[et].b,easing:"easeOutElastic(1, .6)",duration:wheelDuration})})},[et]),reactExports.useMemo(()=>jsxRuntimeExports.jsx("group",{children:Array.from({length:backCount},(st,ot)=>{const at=MatterTone.White;return jsxRuntimeExports.jsxs("lineSegments",{ref:lt=>nt.current.push(lt),position:[Math.random()*(backBounding.x[1]-backBounding.x[0])+backBounding.x[0],Math.random()*(backBounding.y[1]-backBounding.y[0])+backBounding.y[0],Math.random()*(backBounding.z[1]-backBounding.z[0])+backBounding.z[0]],rotation:[Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2],children:[jsxRuntimeExports.jsx("edgesGeometry",{args:[new TetrahedronGeometry(particleRadius)]}),jsxRuntimeExports.jsx("lineBasicMaterial",{color:at,linewidth:particleWidth})]},ot)})}),[])}function Responsive(){return useThree(({camera:et})=>{et.position.z=4e3/Math.min(Math.sqrt(window.innerWidth)+5,40)}),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}const particleCount=[40,50],particleSize=.006,wallThickness=300,wallLength=1e4,repulsionRange=300,repulsionForce=2,mouseForce=5,repulsionSqrRange=repulsionRange*repulsionRange;class Cloud{constructor(_){Jn(this,"instance");Jn(this,"engine");Jn(this,"container");Jn(this,"particles");Jn(this,"walls");Jn(this,"adjacentForce");Jn(this,"mouseForce");this.instance=_,this.engine=_.engine,this.container=_.container,this.particles=[],this.walls=[],this.adjacentForce=!0,this.mouseForce=!0}spawnParticles(_){var _e={collisionFilter:{category:MatterCategory.Particle,mask:MatterCategory.Cloud},render:{visible:!0,lineWidth:1,fillStyle:"#ffffff",strokeStyle:"#ffffff"},restitution:.8,friction:.8},tt=Math.floor(Math.random()*(particleCount[1]-particleCount[0])+particleCount[0]);for(let rt=0;rt<tt;rt++){var nt=MatterColor.Random();switch(_e.render.fillStyle=nt,_e.render.strokeStyle=nt,Math.floor(Math.random()*4+1)){case 1:this.particles.push(Matter.Bodies.circle(0,0,_,_e));break;case 2:this.particles.push(Matter.Bodies.polygon(0,0,3,_*Math.sqrt(3),_e));break;case 3:this.particles.push(Matter.Bodies.rectangle(0,0,_*Math.SQRT2,_*Math.SQRT2,_e));break;case 4:case 5:this.particles.push(Matter.Bodies.polygon(0,0,5,_*2*Math.sin(Math.PI/5),_e));break}}Matter.Composite.add(this.engine.world,this.particles)}explodeAtCenter(){this.spawnParticles(particleSize*Math.min(this.instance.width(),this.instance.height())),this.setPosition(this.instance.width()/2,this.instance.height()/2)}applyForce(_,_e){this.particles.forEach(tt=>{var nt=Matter.Vector.create(0,0);if(this.adjacentForce&&this.particles.forEach(st=>{if(tt!=st){var ot=Matter.Vector.sub(tt.position,st.position),at=Matter.Vector.magnitudeSquared(ot);at<repulsionSqrRange&&(nt=Matter.Vector.add(nt,Matter.Vector.mult(Matter.Vector.normalise(ot),tt.mass*st.mass*repulsionForce/at)))}}),this.mouseForce){var rt=Matter.Vector.sub(tt.position,Matter.Vector.create(_,_e)),it=Matter.Vector.magnitudeSquared(rt);it<repulsionSqrRange&&(nt=Matter.Vector.add(nt,Matter.Vector.mult(Matter.Vector.normalise(rt),tt.mass*mouseForce/it)))}Matter.Body.applyForce(tt,tt.position,nt)})}setPosition(_,_e){var tt=40;this.particles.forEach(nt=>{Matter.Body.setPosition(nt,Matter.Vector.create(_+(Math.random()*2*tt-tt),_e+(Math.random()*tt-tt)))})}spawnWalls(){var _={isStatic:!0,render:{visible:!1},collisionFilter:{category:MatterCategory.Cloud,mask:MatterCategory.Particle}};this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth/2,-wallThickness/2,wallLength,wallThickness,_)),this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth+wallThickness/2,this.container.clientHeight/2,wallThickness,wallLength,_)),this.walls.push(Matter.Bodies.rectangle(this.container.clientWidth/2,this.container.clientHeight+wallThickness/2,wallLength,wallThickness,_)),this.walls.push(Matter.Bodies.rectangle(-wallThickness/2,this.container.clientHeight/2,wallThickness,wallLength,_)),Matter.Composite.add(this.engine.world,this.walls)}repositionWalls(){Matter.Body.setPosition(this.walls[0],{x:this.container.clientWidth/2,y:-wallThickness/2}),Matter.Body.setPosition(this.walls[1],{x:this.container.clientWidth+wallThickness/2,y:this.container.clientHeight/2}),Matter.Body.setPosition(this.walls[2],{x:this.container.clientWidth/2,y:this.container.clientHeight+wallThickness/2}),Matter.Body.setPosition(this.walls[3],{x:-wallThickness/2,y:this.container.clientHeight/2})}}const GlyphVertices=`
{"digitVertices":[[{"x":-4,"y":176},{"x":118,"y":-1},{"x":364,"y":2},{"x":498,"y":177},{"x":502,"y":593},{"x":382,"y":800},{"x":112,"y":800},{"x":-2,"y":600}],[{"x":0,"y":90},{"x":176,"y":-2},{"x":320,"y":2},{"x":322,"y":680},{"x":500,"y":678},{"x":496,"y":799},{"x":0,"y":800},{"x":-4,"y":683},{"x":174,"y":680},{"x":176,"y":129},{"x":70,"y":182}],[{"x":-2,"y":138},{"x":122,"y":-1},{"x":420,"y":0},{"x":500,"y":107},{"x":500,"y":330},{"x":154,"y":652},{"x":500,"y":662},{"x":496,"y":803},{"x":-4,"y":798},{"x":0,"y":593},{"x":364,"y":283},{"x":364,"y":187},{"x":324,"y":127},{"x":188,"y":130},{"x":100,"y":235}],[{"x":501,"y":305},{"x":375,"y":403},{"x":496,"y":502},{"x":496,"y":680},{"x":384,"y":803},{"x":140,"y":805},{"x":-6,"y":670},{"x":112,"y":563},{"x":265,"y":683},{"x":364,"y":586},{"x":218,"y":419},{"x":382,"y":259},{"x":376,"y":172},{"x":330,"y":120},{"x":184,"y":116},{"x":84,"y":227},{"x":-2,"y":138},{"x":75.6113,"y":51},{"x":122,"y":-1},{"x":387,"y":0},{"x":500,"y":107}],[{"x":3,"y":424},{"x":225,"y":-1},{"x":383,"y":2},{"x":388,"y":415},{"x":500,"y":420},{"x":502,"y":550},{"x":371,"y":550},{"x":361,"y":797},{"x":238,"y":800},{"x":233,"y":550},{"x":3,"y":550}],[{"x":252,"y":649},{"x":382,"y":593},{"x":378,"y":399},{"x":81,"y":390},{"x":0,"y":285},{"x":8,"y":-1},{"x":500,"y":-2},{"x":500,"y":134},{"x":114,"y":133},{"x":112,"y":241},{"x":420,"y":244},{"x":500,"y":390},{"x":500,"y":700},{"x":241,"y":800},{"x":-4,"y":648},{"x":74,"y":542}],[{"x":106,"y":3},{"x":358,"y":3},{"x":502,"y":133},{"x":408,"y":228},{"x":296,"y":132},{"x":190,"y":131},{"x":122,"y":208},{"x":132,"y":369.312},{"x":418,"y":377},{"x":500,"y":486},{"x":502,"y":686},{"x":364,"y":802},{"x":72,"y":800},{"x":0,"y":705},{"x":0,"y":124}],[{"x":2,"y":1},{"x":500,"y":2},{"x":498,"y":177},{"x":128,"y":800},{"x":0,"y":672},{"x":328,"y":177},{"x":2,"y":174}],[{"x":0,"y":128},{"x":114,"y":-1},{"x":372,"y":1},{"x":500,"y":133},{"x":500,"y":307},{"x":382,"y":410},{"x":496,"y":498},{"x":500,"y":669},{"x":394,"y":800},{"x":98,"y":800},{"x":0,"y":669},{"x":0,"y":514},{"x":126,"y":412},{"x":0,"y":317}],[{"x":-4,"y":178},{"x":106,"y":-3},{"x":392,"y":0},{"x":498,"y":174},{"x":496,"y":797},{"x":350,"y":799},{"x":352,"y":368},{"x":94,"y":370}]],"upperVertices":[[{"x":-4,"y":800},{"x":282,"y":-1},{"x":558,"y":4},{"x":898,"y":803},{"x":614,"y":806},{"x":542,"y":580},{"x":302,"y":554},{"x":276,"y":798}],[{"x":2,"y":-2},{"x":408,"y":-4},{"x":526,"y":112},{"x":524,"y":330},{"x":240,"y":404},{"x":502,"y":505},{"x":512,"y":723},{"x":376,"y":802},{"x":0,"y":802}],[{"x":190,"y":-1},{"x":554,"y":0},{"x":550,"y":160},{"x":262,"y":171},{"x":180,"y":428},{"x":282,"y":630},{"x":580,"y":636},{"x":552,"y":802},{"x":196,"y":806},{"x":-2,"y":680},{"x":-6,"y":202}],[{"x":-2,"y":1},{"x":364,"y":4},{"x":528,"y":171},{"x":530,"y":627},{"x":386,"y":801},{"x":-4,"y":799}],[{"x":-2,"y":-2},{"x":466,"y":-4},{"x":484,"y":190},{"x":216,"y":193},{"x":204,"y":371},{"x":442,"y":377},{"x":418,"y":520},{"x":224,"y":528},{"x":214,"y":688},{"x":480,"y":662},{"x":486,"y":803},{"x":2,"y":804}],[{"x":-4,"y":-1},{"x":444,"y":3},{"x":452,"y":203},{"x":190,"y":228},{"x":186,"y":390},{"x":310,"y":390},{"x":300,"y":542},{"x":176,"y":561},{"x":178,"y":801},{"x":0,"y":805}],[{"x":0,"y":208},{"x":210,"y":-2},{"x":592,"y":-4},{"x":692,"y":197},{"x":672,"y":381},{"x":496,"y":381},{"x":508,"y":162},{"x":206,"y":182},{"x":160,"y":439},{"x":256,"y":662},{"x":492,"y":654},{"x":510,"y":531},{"x":390,"y":536},{"x":388,"y":444},{"x":658,"y":445},{"x":642,"y":803},{"x":180,"y":804},{"x":-2,"y":592}],[{"x":-4,"y":2},{"x":236,"y":3},{"x":238,"y":350},{"x":436,"y":346},{"x":446,"y":6},{"x":656,"y":5},{"x":662,"y":806},{"x":460,"y":794},{"x":434,"y":536},{"x":244,"y":556},{"x":234,"y":804},{"x":0,"y":805}],[{"x":-4,"y":-2},{"x":564,"y":2},{"x":564,"y":177},{"x":358,"y":170},{"x":362,"y":661},{"x":574,"y":665},{"x":574,"y":802},{"x":0,"y":799},{"x":-2,"y":646},{"x":190,"y":658},{"x":182,"y":166},{"x":2,"y":162}],[{"x":14,"y":0},{"x":620,"y":-1},{"x":622,"y":158},{"x":450,"y":150},{"x":470,"y":710},{"x":344,"y":800},{"x":124,"y":800},{"x":2,"y":721},{"x":-4,"y":488},{"x":122,"y":485},{"x":136,"y":641},{"x":272,"y":624},{"x":250,"y":148},{"x":0,"y":140}],[{"x":2,"y":-1},{"x":188,"y":3},{"x":184,"y":261},{"x":356,"y":2},{"x":554,"y":-2},{"x":260,"y":417},{"x":564,"y":800},{"x":354,"y":800},{"x":186,"y":563},{"x":180,"y":800},{"x":-2,"y":803}],[{"x":-2,"y":-1},{"x":222,"y":-3},{"x":216,"y":604},{"x":512,"y":575},{"x":508,"y":800},{"x":0,"y":776}],[{"x":0,"y":800},{"x":-4,"y":-2},{"x":222,"y":-1},{"x":382,"y":352},{"x":526,"y":-4},{"x":734,"y":-1},{"x":796,"y":803},{"x":628,"y":800},{"x":554,"y":461},{"x":478,"y":677},{"x":312,"y":680},{"x":206,"y":433},{"x":192,"y":800}],[{"x":-4,"y":802},{"x":-4,"y":2},{"x":228,"y":-2},{"x":400,"y":322},{"x":420,"y":-6},{"x":594,"y":1},{"x":614,"y":810},{"x":384,"y":803},{"x":180,"y":418},{"x":184,"y":795}],[{"x":180,"y":-2},{"x":594,"y":-3},{"x":750,"y":224},{"x":746,"y":605},{"x":576,"y":801},{"x":208,"y":804},{"x":2,"y":654},{"x":0,"y":183}],[{"x":-4,"y":0},{"x":452,"y":2},{"x":590,"y":166},{"x":582,"y":407},{"x":458,"y":521},{"x":190,"y":523},{"x":204,"y":806},{"x":2,"y":806}],[{"x":-4,"y":175},{"x":176,"y":0},{"x":508,"y":1},{"x":664,"y":222},{"x":646,"y":590},{"x":608,"y":644},{"x":722,"y":728},{"x":644,"y":806},{"x":537,"y":730},{"x":480,"y":796},{"x":196,"y":795},{"x":-2,"y":656}],[{"x":-4,"y":1},{"x":386,"y":1},{"x":534,"y":116},{"x":532,"y":384},{"x":420,"y":492},{"x":264,"y":491},{"x":538,"y":690},{"x":452,"y":800},{"x":188,"y":614},{"x":192,"y":800},{"x":-2,"y":802}],[{"x":124,"y":1},{"x":500,"y":3},{"x":638,"y":120},{"x":634,"y":289},{"x":474,"y":265},{"x":474,"y":164},{"x":174,"y":166},{"x":162,"y":338},{"x":462,"y":350},{"x":602,"y":450},{"x":612,"y":725},{"x":486,"y":804},{"x":128,"y":799},{"x":0,"y":731},{"x":0,"y":550},{"x":134,"y":528},{"x":192,"y":674},{"x":422,"y":675},{"x":440,"y":518},{"x":122,"y":469},{"x":0,"y":382},{"x":0,"y":109}],[{"x":-4,"y":-1},{"x":610,"y":1},{"x":606,"y":209},{"x":396,"y":213},{"x":402,"y":802},{"x":176,"y":800},{"x":198,"y":203},{"x":0,"y":188}],[{"x":0,"y":4},{"x":196,"y":1},{"x":206,"y":543},{"x":462,"y":563},{"x":472,"y":3},{"x":634,"y":0},{"x":646,"y":647},{"x":498,"y":804},{"x":214,"y":804},{"x":2,"y":638}],[{"x":-8,"y":-1},{"x":174,"y":-2},{"x":372,"y":551},{"x":468,"y":2},{"x":660,"y":-1},{"x":506,"y":808},{"x":178,"y":801}],[{"x":-4,"y":-1},{"x":146,"y":-2},{"x":262,"y":405},{"x":364,"y":0},{"x":550,"y":6},{"x":616,"y":411},{"x":698,"y":1},{"x":866,"y":7},{"x":696,"y":802},{"x":502,"y":800},{"x":404,"y":539},{"x":314,"y":800},{"x":122,"y":802}],[{"x":0,"y":-4},{"x":210,"y":2},{"x":308,"y":322},{"x":476,"y":-2},{"x":668,"y":1},{"x":452,"y":421},{"x":656,"y":803},{"x":432,"y":800},{"x":308,"y":536},{"x":190,"y":800},{"x":0,"y":800},{"x":150,"y":433}],[{"x":-2,"y":-2},{"x":240,"y":1},{"x":374,"y":236},{"x":496,"y":-2},{"x":726,"y":0},{"x":486,"y":406},{"x":476,"y":800},{"x":262,"y":801},{"x":244,"y":427}],[{"x":-4,"y":1},{"x":660,"y":13},{"x":674,"y":217},{"x":274,"y":614},{"x":680,"y":616},{"x":676,"y":800},{"x":0,"y":800},{"x":0,"y":590},{"x":398,"y":204},{"x":0,"y":196}]],"lowerVertices":[[{"x":352,"y":551},{"x":336,"y":405},{"x":142,"y":405},{"x":136,"y":465},{"x":0,"y":467},{"x":0,"y":408},{"x":76,"y":292},{"x":412,"y":291},{"x":494,"y":442},{"x":498,"y":705},{"x":402,"y":800},{"x":62,"y":800},{"x":10,"y":718},{"x":14,"y":614},{"x":134,"y":549}],[{"x":-4,"y":1},{"x":148,"y":-4},{"x":144,"y":338},{"x":420,"y":341},{"x":520,"y":472},{"x":524,"y":708},{"x":342,"y":800},{"x":-6,"y":800}],[{"x":0,"y":393},{"x":104,"y":288},{"x":388,"y":281},{"x":468,"y":378},{"x":470,"y":504},{"x":370,"y":515},{"x":362,"y":425},{"x":136,"y":444},{"x":142,"y":678},{"x":356,"y":692},{"x":382,"y":606},{"x":480,"y":616},{"x":470,"y":756},{"x":376,"y":798},{"x":40,"y":798},{"x":2,"y":748}],[{"x":0,"y":413},{"x":144,"y":285},{"x":354,"y":285},{"x":352,"y":1},{"x":498,"y":0},{"x":508,"y":800},{"x":148,"y":800},{"x":0,"y":708}],[{"x":-4,"y":412},{"x":114,"y":282},{"x":368,"y":282},{"x":478,"y":410},{"x":476,"y":536},{"x":138,"y":537},{"x":140,"y":672},{"x":352,"y":691},{"x":344,"y":617},{"x":484,"y":610},{"x":476,"y":800},{"x":120,"y":800},{"x":0,"y":702}],[{"x":-8,"y":387},{"x":0,"y":101},{"x":80,"y":45},{"x":288,"y":49},{"x":344,"y":107},{"x":346,"y":282},{"x":246,"y":272},{"x":236,"y":181},{"x":134,"y":179},{"x":120,"y":395},{"x":262,"y":394},{"x":262,"y":510},{"x":126,"y":507},{"x":132,"y":799},{"x":0,"y":799}],[{"x":146,"y":800},{"x":0,"y":668},{"x":-2,"y":420},{"x":102,"y":291},{"x":372,"y":284},{"x":494,"y":404},{"x":490,"y":896},{"x":378,"y":1002},{"x":126,"y":1003},{"x":0,"y":915},{"x":2,"y":795},{"x":116,"y":800},{"x":122,"y":892},{"x":344,"y":889},{"x":360,"y":800}],[{"x":0,"y":-1},{"x":150,"y":-1},{"x":154,"y":286},{"x":414,"y":282},{"x":534,"y":391},{"x":562,"y":808},{"x":376,"y":799},{"x":334,"y":490},{"x":166,"y":487},{"x":158,"y":800},{"x":-4,"y":805}],[{"x":4,"y":157},{"x":8,"y":34},{"x":148,"y":36},{"x":198,"y":89},{"x":194,"y":194},{"x":134,"y":199},{"x":134,"y":281},{"x":188,"y":281},{"x":200,"y":796},{"x":12,"y":796},{"x":2,"y":281},{"x":56,"y":283},{"x":56,"y":197}],[{"x":-168,"y":1002},{"x":-166,"y":857},{"x":6,"y":850},{"x":2,"y":284},{"x":56,"y":280},{"x":58,"y":196},{"x":6,"y":158},{"x":10,"y":35},{"x":150,"y":38},{"x":198,"y":89},{"x":194,"y":195},{"x":134,"y":200},{"x":134,"y":286},{"x":186,"y":282},{"x":180,"y":941},{"x":82,"y":998}],[{"x":2,"y":49},{"x":156,"y":49},{"x":158,"y":412},{"x":314,"y":197},{"x":404,"y":285},{"x":230,"y":520},{"x":398,"y":714},{"x":310,"y":800},{"x":162,"y":608},{"x":168,"y":800},{"x":0,"y":800}],[{"x":-4,"y":2},{"x":178,"y":0},{"x":198,"y":798},{"x":-4,"y":801}],[{"x":442,"y":423},{"x":390,"y":426},{"x":354,"y":507},{"x":346,"y":797},{"x":226,"y":798},{"x":230,"y":482},{"x":204,"y":432},{"x":128,"y":482},{"x":130,"y":796},{"x":0,"y":800},{"x":0,"y":285},{"x":120,"y":285},{"x":124,"y":364},{"x":200,"y":285},{"x":250,"y":285},{"x":300,"y":359},{"x":360,"y":285},{"x":480,"y":285},{"x":556,"y":387},{"x":557,"y":799},{"x":444,"y":799}],[{"x":350,"y":432},{"x":221,"y":427},{"x":145,"y":484},{"x":141,"y":800},{"x":0,"y":800},{"x":0,"y":285},{"x":131,"y":284},{"x":135,"y":363},{"x":211,"y":284},{"x":427,"y":285},{"x":514,"y":430},{"x":515,"y":800},{"x":361,"y":800}],[{"x":-3,"y":409},{"x":100,"y":287},{"x":351,"y":286},{"x":465,"y":406},{"x":468,"y":686},{"x":345,"y":807},{"x":119,"y":800},{"x":0,"y":661}],[{"x":-2,"y":284},{"x":370,"y":285},{"x":533,"y":427},{"x":525,"y":668},{"x":360,"y":744},{"x":203,"y":749},{"x":203,"y":999},{"x":1,"y":999}],[{"x":330,"y":1000},{"x":330,"y":750},{"x":173,"y":745},{"x":8,"y":669},{"x":0,"y":428},{"x":163,"y":286},{"x":534,"y":286},{"x":528,"y":1000}],[{"x":-3,"y":288},{"x":131,"y":286},{"x":133,"y":382},{"x":217,"y":286},{"x":385,"y":286},{"x":390,"y":434},{"x":222,"y":426},{"x":143,"y":514},{"x":146,"y":798},{"x":0,"y":800}],[{"x":0,"y":379},{"x":119,"y":281},{"x":377,"y":285},{"x":425,"y":345},{"x":422,"y":446},{"x":318,"y":445},{"x":308,"y":373},{"x":134,"y":373},{"x":132,"y":480},{"x":331,"y":493},{"x":426,"y":567},{"x":434,"y":709},{"x":340,"y":797},{"x":136,"y":794},{"x":2,"y":716},{"x":1,"y":598},{"x":112,"y":596},{"x":138,"y":684},{"x":304,"y":685},{"x":303,"y":572},{"x":42,"y":558},{"x":2,"y":498}],[{"x":108,"y":162},{"x":245,"y":162},{"x":244,"y":285},{"x":381,"y":286},{"x":382,"y":380},{"x":245,"y":383},{"x":249,"y":697},{"x":415,"y":696},{"x":410,"y":607},{"x":520,"y":607},{"x":518,"y":800},{"x":112,"y":800},{"x":108,"y":384},{"x":0,"y":381},{"x":0,"y":287},{"x":108,"y":282}],[{"x":-1,"y":284},{"x":134,"y":285},{"x":144,"y":638},{"x":295,"y":641},{"x":300,"y":285},{"x":428,"y":285},{"x":452,"y":800},{"x":374,"y":800},{"x":367,"y":706},{"x":288,"y":800},{"x":84,"y":801},{"x":0,"y":716}],[{"x":-4,"y":288},{"x":136,"y":285},{"x":278,"y":604},{"x":376,"y":287},{"x":530,"y":285},{"x":378,"y":805},{"x":166,"y":800}],[{"x":-6,"y":287},{"x":116,"y":285},{"x":192,"y":554},{"x":260,"y":287},{"x":362,"y":285},{"x":420,"y":497},{"x":508,"y":285},{"x":616,"y":285},{"x":516,"y":800},{"x":394,"y":800},{"x":310,"y":581},{"x":246,"y":795},{"x":88,"y":799}],[{"x":-4,"y":286},{"x":166,"y":287},{"x":252,"y":443},{"x":342,"y":286},{"x":494,"y":285},{"x":338,"y":559},{"x":492,"y":800},{"x":352,"y":800},{"x":238,"y":645},{"x":150,"y":800},{"x":-4,"y":798},{"x":136,"y":545}],[{"x":-4,"y":286},{"x":162,"y":285},{"x":170,"y":550},{"x":336,"y":577},{"x":352,"y":285},{"x":522,"y":286},{"x":522,"y":888},{"x":442,"y":1001},{"x":-4,"y":996},{"x":0,"y":860},{"x":346,"y":871},{"x":352,"y":721},{"x":0,"y":677}],[{"x":-4,"y":287},{"x":510,"y":287},{"x":510,"y":411},{"x":218,"y":647},{"x":512,"y":668},{"x":514,"y":800},{"x":0,"y":800},{"x":0,"y":626},{"x":250,"y":423},{"x":0,"y":421}]],"operVertices":{"+":[{"x":210,"y":116},{"x":374,"y":112},{"x":374,"y":300},{"x":570,"y":298},{"x":568,"y":442},{"x":380,"y":445},{"x":380,"y":642},{"x":222,"y":639},{"x":218,"y":438},{"x":24,"y":440},{"x":24,"y":299},{"x":214,"y":301}],"-":[{"x":23,"y":299},{"x":570,"y":298},{"x":566,"y":442},{"x":23,"y":440}],"/":[{"x":0,"y":800},{"x":354,"y":3},{"x":528,"y":2},{"x":172,"y":804}]},"digitRatio":[0.6317103620474407,0.628428927680798,0.6268656716417911,0.6290322580645161,0.6229712858926342,0.628428927680798,0.6282849792530788,0.6257822277847309,0.6242197253433208,0.6259351620947631],"upperRatio":[1.117719950433705,0.652605459057072,0.7261462205700124,0.6675,0.6039603960396039,0.56575682382134,0.8589108910891089,0.8283582089552238,0.7189054726368159,0.7815230961298377,0.7031055900621118,0.6400996264009963,0.9913258983890955,0.7573529411764706,0.929368029739777,0.7369727047146402,0.9007444168734491,0.6766541822721598,0.7945205479452054,0.7646326276463262,0.8034825870646766,0.8246913580246914,1.0820895522388059,0.8277571251548946,0.9066002490660025,0.8560700876095119],"lowerRatio":[0.9783889980353635,0.6592039800995025,0.9284332688588007,0.635,0.9420849420849421,0.46949602122015915,0.6898470097357441,0.6996291718170581,0.25984251968503935,0.3784901758014478,0.5379494007989347,0.25218476903870163,1.0815533980582523,0.998062015503876,0.9040307101727447,0.7482517482517482,0.7478991596638656,0.7645914396887159,0.8410852713178295,0.8150470219435737,0.8762088974854932,1.0269230769230768,1.2077669902912622,0.9669902912621359,0.7346368715083799,1.0097465886939572],"operRatio":{"+":1.030188679245283,"-":3.798611111111111,"/":0.6583541147132169},"aRatio":0.9783889980353635}
`;class Glyph{constructor(_){Jn(this,"digitVertices");Jn(this,"upperVertices");Jn(this,"lowerVertices");Jn(this,"operVertices");Jn(this,"digitRatio");Jn(this,"upperRatio");Jn(this,"lowerRatio");Jn(this,"operRatio");Jn(this,"aRatio");this.digitVertices=_.digitVertices,this.upperVertices=_.upperVertices,this.lowerVertices=_.lowerVertices,this.operVertices=_.operVertices,this.digitRatio=_.digitRatio,this.upperRatio=_.upperRatio,this.lowerRatio=_.lowerRatio,this.operRatio=_.operRatio,this.aRatio=_.aRatio}get(_){return isDigit(_)?{vertices:this.digitVertices[_.charCodeAt(0)-48],aspectRatio:this.digitRatio[_.charCodeAt(0)-48]}:isUpper(_)?{vertices:this.upperVertices[_.charCodeAt(0)-65],aspectRatio:this.upperRatio[_.charCodeAt(0)-65]}:isLower(_)?{vertices:this.lowerVertices[_.charCodeAt(0)-97],aspectRatio:this.lowerRatio[_.charCodeAt(0)-97]}:{vertices:this.operVertices[_],aspectRatio:this.operRatio[_]}}}const Glyph$1=new Glyph(JSON.parse(GlyphVertices)),RelativeWidth={"+":1.1348684210526316,"-":1.1348684210526316,"/":1.019736842105263,0:.9177631578947368,1:.9177631578947368,2:.9177631578947368,3:.9177631578947368,4:.9177631578947368,5:.9177631578947368,6:.9177631578947368,7:.9177631578947368,8:.9177631578947368,9:.9177631578947368,A:1.644736842105263,B:1.0723684210526316,C:1.1019736842105263,D:1.0460526315789473,E:.9605263157894737,F:.8782894736842105,G:1.2960526315789473,H:1.1973684210526316,I:1.0921052631578947,J:1.1480263157894737,K:.9671052631578947,L:.9506578947368421,M:1.424342105263158,N:1.131578947368421,O:1.368421052631579,P:1.0855263157894737,Q:1.368421052631579,R:1.013157894736842,S:1.1842105263157894,T:1.1611842105263157,U:1.1546052631578947,V:1.2039473684210527,W:1.519736842105263,X:1.194078947368421,Y:1.3026315789473684,Z:1.2203947368421053,a:1,b:.9868421052631579,c:.9671052631578947,d:.9638157894736842,e:.9046052631578947,f:.7072368421052632,g:.9605263157894737,h:1.0296052631578947,i:.48355263157894735,j:.4769736842105263,k:.7697368421052632,l:.4440789473684211,m:1.0476973684210527,n:.9588815789473685,o:.9046052631578947,p:1.011513157894737,q:.975328947368421,r:.7927631578947368,s:.8108552631578947,t:.9588815789473685,u:.8651315789473685,v:.993421052631579,w:1.0855263157894737,x:.930921052631579,y:1.0098684210526316,z:.993421052631579},RelativeBoundingWidth={"+":1.0963855421686748,"-":1.0983935742971886,"/":1.0602409638554218,0:1.0160642570281124,1:1.0120481927710843,2:1.0120481927710843,3:1.0180722891566265,4:1.002008032128514,5:1.0120481927710843,6:1.0080321285140563,7:1.0040160642570282,8:1.0040160642570282,9:1.0080321285140563,A:1.8112449799196788,B:1.0562248995983936,C:1.176706827309237,D:1.072289156626506,E:.9799196787148594,F:.9156626506024096,G:1.393574297188755,H:1.3373493975903614,I:1.1606425702811245,J:1.2570281124497993,K:1.1365461847389557,L:1.0321285140562249,M:1.606425702811245,N:1.2409638554216869,O:1.5060240963855422,P:1.1927710843373494,Q:1.4578313253012047,R:1.0883534136546185,S:1.2811244979919678,T:1.2329317269076305,U:1.2971887550200802,V:1.3413654618473896,W:1.7469879518072289,X:1.3413654618473896,Y:1.461847389558233,Z:1.3734939759036144,a:1,b:1.0642570281124497,c:.963855421686747,d:1.0200803212851406,e:.9799196787148594,f:.7108433734939759,g:.9959839357429718,h:1.1365461847389557,i:.39759036144578314,j:.7349397590361446,k:.8112449799196787,l:.40562248995983935,m:1.1184738955823292,n:1.034136546184739,o:.9457831325301205,p:1.0742971887550201,q:1.072289156626506,r:.7891566265060241,s:.8714859437751004,t:1.0441767068273093,u:.9096385542168675,v:1.072289156626506,w:1.248995983935743,x:1,y:1.0562248995983936,z:1.0401606425702812};var queue={};/**
 * @license MIT
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 *
 * @class
 */let Queue$1=class Ip{constructor(_){this._elements=Array.isArray(_)?_:[],this._offset=0}enqueue(_){return this._elements.push(_),this}push(_){return this.enqueue(_)}dequeue(){if(this.size()===0)return null;const _=this.front();return this._offset+=1,this._offset*2<this._elements.length||(this._elements=this._elements.slice(this._offset),this._offset=0),_}pop(){return this.dequeue()}front(){return this.size()>0?this._elements[this._offset]:null}back(){return this.size()>0?this._elements[this._elements.length-1]:null}size(){return this._elements.length-this._offset}isEmpty(){return this.size()===0}toArray(){return this._elements.slice(this._offset)}clear(){this._elements=[],this._offset=0}clone(){return new Ip(this._elements.slice(this._offset))}static fromArray(_){return new Ip(_)}};queue.Queue=Queue$1;const{Queue}=queue;var Queue_1=Queue;const inBetween=.3,charAscent=.15,capsAscent=.18,numberAdjustment=.15,maximumCharacter=200;class Option{constructor(){Jn(this,"text");Jn(this,"size");Jn(this,"x");Jn(this,"y");Jn(this,"relPosition");Jn(this,"relSize");Jn(this,"wrap");Jn(this,"color");Jn(this,"category");Jn(this,"mask");Jn(this,"velocity");this.text="",this.size=0,this.x=0,this.y=0,this.relPosition=!1,this.relSize=!1,this.wrap=!0,this.color=["#000000"],this.category=MatterCategory.Character,this.mask=MatterCategory.Character,this.velocity={x:0,y:0}}}class Foundry{constructor(_){Jn(this,"instance");Jn(this,"parser");Jn(this,"wrappingBodies");Jn(this,"scalingBodies");Jn(this,"allBodies");Jn(this,"engine");Jn(this,"container");this.instance=_,this.engine=_.engine,this.container=_.container,this.parser=new window.DOMParser,this.wrappingBodies=[],this.scalingBodies=[],this.allBodies=new Queue_1}width(_){_={...new Option,..._},_.relPosition&&(_.x*=this.container.clientWidth,_.y*=this.container.clientHeight);var _e=_.size;_.relSize&&(_e*=Math.min(this.container.clientWidth,this.container.clientHeight));for(var tt=inBetween*_e,nt=0,rt=0;nt<_.text.length;nt++){if(_.text[nt]==" "||!allowedGlyph(_.text[nt])){rt+=_e;continue}rt+=RelativeWidth[_.text[nt]]*_e+tt}return rt}height(_){_={...new Option,..._},_.relPosition&&(_.x*=this.container.clientWidth,_.y*=this.container.clientHeight);var _e=_.size;_.relSize&&(_e*=Math.min(this.container.clientWidth,this.container.clientHeight));var tt=_e*Glyph$1.aRatio;return tt}print(_){_={...new Option,..._},_.relPosition&&(_.x*=this.container.clientWidth,_.y*=this.container.clientHeight);var _e=_.size;_.relSize&&(_e*=Math.min(this.container.clientWidth,this.container.clientHeight));for(var tt=_e*Glyph$1.aRatio,nt=inBetween*_e,rt=[],it=0,st=0;it<_.text.length;it++){if(_.text[it]==" "||!allowedGlyph(_.text[it])){st+=_e;continue}rt.push(this.glyph(_.text[it],_.x+st,_.y,_e,tt,randomElement(_.color),_)),st+=RelativeWidth[_.text[it]]*_e+nt}return rt}printf(_,_e,tt,nt){if(!allowedGlyph(_))return[];const rt={...new Option,text:_,size:nt,x:_e,y:tt,relPosition:!1,relSize:!1,color:MatterColor.Array(),velocity:{x:-this.instance.width()/512,y:-(Math.random()*1-.5)}};return this.print(rt)}glyph(_,_e,tt,nt,rt,it,st){var ot=Matter.Bodies.fromVertices(_e,tt,Glyph$1.get(_).vertices,{render:{fillStyle:it,strokeStyle:it,lineWidth:1},collisionFilter:{category:st.category,mask:st.mask},restitution:.8,friction:.6,label:_});st.wrap&&(ot.plugin.wrap={min:{x:0,y:0},max:{x:this.container.clientWidth,y:this.container.clientHeight}},this.wrappingBodies.push(ot));var at=RelativeBoundingWidth[_]*nt,lt=at/(ot.bounds.max.x-ot.bounds.min.x),ct=((ot.bounds.max.y-ot.bounds.min.y)*lt*Glyph$1.get(_).aspectRatio-rt)/2;if("gjpqy".includes(_)?ct=-rt*charAscent:"fil".includes(_)?ct=rt*charAscent:"79".includes(_)?ct=rt*numberAdjustment:isUpper(_)&&(ct=rt*capsAscent),Matter.Body.scale(ot,lt,lt),Matter.Body.setPosition(ot,{x:_e+at/2,y:tt-ct}),Matter.Composite.add(this.engine.world,ot),Matter.Body.setVelocity(ot,st.velocity),this.allBodies.enqueue(ot),this.allBodies.size()>maximumCharacter){var ht=this.allBodies.dequeue();Matter.Composite.remove(this.engine.world,ht)}return ot}updateWrap(){this.wrappingBodies.forEach(_=>{_.plugin.wrap={min:{x:0,y:0},max:{x:this.container.clientWidth,y:this.container.clientHeight}}})}setOpacity(_){this.wrappingBodies.forEach(_e=>{_e.parts.forEach(tt=>{tt.render.opacity=_})})}}var matterWrap={exports:{}};/*!
 * matter-wrap 0.2.0 by Liam Brummitt 2017-07-04
 * https://github.com/liabru/matter-wrap
 * License MIT
 */(function(et,_){(function(tt,nt){et.exports=nt(matterExports)})(commonjsGlobal,function(_e){return function(tt){var nt={};function rt(it){if(nt[it])return nt[it].exports;var st=nt[it]={i:it,l:!1,exports:{}};return tt[it].call(st.exports,st,st.exports,rt),st.l=!0,st.exports}return rt.m=tt,rt.c=nt,rt.i=function(it){return it},rt.d=function(it,st,ot){rt.o(it,st)||Object.defineProperty(it,st,{configurable:!1,enumerable:!0,get:ot})},rt.n=function(it){var st=it&&it.__esModule?function(){return it.default}:function(){return it};return rt.d(st,"a",st),st},rt.o=function(it,st){return Object.prototype.hasOwnProperty.call(it,st)},rt.p="/libs",rt(rt.s=1)}([function(tt,nt){tt.exports=_e},function(tt,nt,rt){var it=rt(0),st={name:"matter-wrap",version:"0.1.3",for:"matter-js@^0.12.0",install:function(at){at.after("Engine.update",function(){st.Engine.update(this)})},Engine:{update:function(at){for(var lt=at.world,ct=it.Composite.allBodies(lt),ht=it.Composite.allComposites(lt),ut=0;ut<ct.length;ut+=1){var ft=ct[ut];ft.plugin.wrap&&st.Body.wrap(ft,ft.plugin.wrap)}for(ut=0;ut<ht.length;ut+=1){var dt=ht[ut];dt.plugin.wrap&&st.Composite.wrap(dt,dt.plugin.wrap)}}},Bounds:{wrap:function(at,lt){var ct=null,ht=null;if(typeof lt.min.x<"u"&&typeof lt.max.x<"u"&&(at.min.x>lt.max.x?ct=lt.min.x-at.max.x:at.max.x<lt.min.x&&(ct=lt.max.x-at.min.x)),typeof lt.min.y<"u"&&typeof lt.max.y<"u"&&(at.min.y>lt.max.y?ht=lt.min.y-at.max.y:at.max.y<lt.min.y&&(ht=lt.max.y-at.min.y)),ct!==null||ht!==null)return{x:ct||0,y:ht||0}}},Body:{wrap:function(at,lt){var ct=st.Bounds.wrap(at.bounds,lt);return ct&&it.Body.translate(at,ct),ct}},Composite:{bounds:function(at){for(var lt=it.Composite.allBodies(at),ct=[],ht=0;ht<lt.length;ht+=1){var ut=lt[ht];ct.push(ut.bounds.min,ut.bounds.max)}return it.Bounds.create(ct)},wrap:function(at,lt){var ct=st.Bounds.wrap(st.Composite.bounds(at),lt);return ct&&it.Composite.translate(at,ct),ct}}};it.Plugin.register(st),tt.exports=st}])})})(matterWrap);var matterWrapExports=matterWrap.exports;const MatterWrap=getDefaultExportFromCjs(matterWrapExports);var src$4={decomp:polygonDecomp,quickDecomp:polygonQuickDecomp,isSimple:polygonIsSimple,removeCollinearPoints:polygonRemoveCollinearPoints,removeDuplicatePoints:polygonRemoveDuplicatePoints,makeCCW:polygonMakeCCW};function lineInt(et,_,_e){_e=_e||0;var tt=[0,0],nt,rt,it,st,ot,at,lt;return nt=et[1][1]-et[0][1],rt=et[0][0]-et[1][0],it=nt*et[0][0]+rt*et[0][1],st=_[1][1]-_[0][1],ot=_[0][0]-_[1][0],at=st*_[0][0]+ot*_[0][1],lt=nt*ot-st*rt,scalar_eq(lt,0,_e)||(tt[0]=(ot*it-rt*at)/lt,tt[1]=(nt*at-st*it)/lt),tt}function lineSegmentsIntersect(et,_,_e,tt){var nt=_[0]-et[0],rt=_[1]-et[1],it=tt[0]-_e[0],st=tt[1]-_e[1];if(it*rt-st*nt===0)return!1;var ot=(nt*(_e[1]-et[1])+rt*(et[0]-_e[0]))/(it*rt-st*nt),at=(it*(et[1]-_e[1])+st*(_e[0]-et[0]))/(st*nt-it*rt);return ot>=0&&ot<=1&&at>=0&&at<=1}function triangleArea(et,_,_e){return(_[0]-et[0])*(_e[1]-et[1])-(_e[0]-et[0])*(_[1]-et[1])}function isLeft(et,_,_e){return triangleArea(et,_,_e)>0}function isLeftOn(et,_,_e){return triangleArea(et,_,_e)>=0}function isRight(et,_,_e){return triangleArea(et,_,_e)<0}function isRightOn(et,_,_e){return triangleArea(et,_,_e)<=0}var tmpPoint1=[],tmpPoint2=[];function collinear(et,_,_e,tt){if(tt){var nt=tmpPoint1,rt=tmpPoint2;nt[0]=_[0]-et[0],nt[1]=_[1]-et[1],rt[0]=_e[0]-_[0],rt[1]=_e[1]-_[1];var it=nt[0]*rt[0]+nt[1]*rt[1],st=Math.sqrt(nt[0]*nt[0]+nt[1]*nt[1]),ot=Math.sqrt(rt[0]*rt[0]+rt[1]*rt[1]),at=Math.acos(it/(st*ot));return at<tt}else return triangleArea(et,_,_e)===0}function sqdist(et,_){var _e=_[0]-et[0],tt=_[1]-et[1];return _e*_e+tt*tt}function polygonAt(et,_){var _e=et.length;return et[_<0?_%_e+_e:_%_e]}function polygonClear(et){et.length=0}function polygonAppend(et,_,_e,tt){for(var nt=_e;nt<tt;nt++)et.push(_[nt])}function polygonMakeCCW(et){for(var _=0,_e=et,tt=1;tt<et.length;++tt)(_e[tt][1]<_e[_][1]||_e[tt][1]===_e[_][1]&&_e[tt][0]>_e[_][0])&&(_=tt);return isLeft(polygonAt(et,_-1),polygonAt(et,_),polygonAt(et,_+1))?!1:(polygonReverse(et),!0)}function polygonReverse(et){for(var _=[],_e=et.length,tt=0;tt!==_e;tt++)_.push(et.pop());for(var tt=0;tt!==_e;tt++)et[tt]=_[tt]}function polygonIsReflex(et,_){return isRight(polygonAt(et,_-1),polygonAt(et,_),polygonAt(et,_+1))}var tmpLine1=[],tmpLine2=[];function polygonCanSee(et,_,_e){var tt,nt,rt=tmpLine1,it=tmpLine2;if(isLeftOn(polygonAt(et,_+1),polygonAt(et,_),polygonAt(et,_e))&&isRightOn(polygonAt(et,_-1),polygonAt(et,_),polygonAt(et,_e)))return!1;nt=sqdist(polygonAt(et,_),polygonAt(et,_e));for(var st=0;st!==et.length;++st)if(!((st+1)%et.length===_||st===_)&&isLeftOn(polygonAt(et,_),polygonAt(et,_e),polygonAt(et,st+1))&&isRightOn(polygonAt(et,_),polygonAt(et,_e),polygonAt(et,st))&&(rt[0]=polygonAt(et,_),rt[1]=polygonAt(et,_e),it[0]=polygonAt(et,st),it[1]=polygonAt(et,st+1),tt=lineInt(rt,it),sqdist(polygonAt(et,_),tt)<nt))return!1;return!0}function polygonCanSee2(et,_,_e){for(var tt=0;tt!==et.length;++tt)if(!(tt===_||tt===_e||(tt+1)%et.length===_||(tt+1)%et.length===_e)&&lineSegmentsIntersect(polygonAt(et,_),polygonAt(et,_e),polygonAt(et,tt),polygonAt(et,tt+1)))return!1;return!0}function polygonCopy(et,_,_e,tt){var nt=tt||[];if(polygonClear(nt),_<_e)for(var rt=_;rt<=_e;rt++)nt.push(et[rt]);else{for(var rt=0;rt<=_e;rt++)nt.push(et[rt]);for(var rt=_;rt<et.length;rt++)nt.push(et[rt])}return nt}function polygonGetCutEdges(et){for(var _=[],_e=[],tt=[],nt=[],rt=Number.MAX_VALUE,it=0;it<et.length;++it)if(polygonIsReflex(et,it)){for(var st=0;st<et.length;++st)if(polygonCanSee(et,it,st)){_e=polygonGetCutEdges(polygonCopy(et,it,st,nt)),tt=polygonGetCutEdges(polygonCopy(et,st,it,nt));for(var ot=0;ot<tt.length;ot++)_e.push(tt[ot]);_e.length<rt&&(_=_e,rt=_e.length,_.push([polygonAt(et,it),polygonAt(et,st)]))}}return _}function polygonDecomp(et){var _=polygonGetCutEdges(et);return _.length>0?polygonSlice(et,_):[et]}function polygonSlice(et,_){if(_.length===0)return[et];if(_ instanceof Array&&_.length&&_[0]instanceof Array&&_[0].length===2&&_[0][0]instanceof Array){for(var _e=[et],tt=0;tt<_.length;tt++)for(var nt=_[tt],rt=0;rt<_e.length;rt++){var it=_e[rt],st=polygonSlice(it,nt);if(st){_e.splice(rt,1),_e.push(st[0],st[1]);break}}return _e}else{var nt=_,tt=et.indexOf(nt[0]),rt=et.indexOf(nt[1]);return tt!==-1&&rt!==-1?[polygonCopy(et,tt,rt),polygonCopy(et,rt,tt)]:!1}}function polygonIsSimple(et){var _=et,_e;for(_e=0;_e<_.length-1;_e++)for(var tt=0;tt<_e-1;tt++)if(lineSegmentsIntersect(_[_e],_[_e+1],_[tt],_[tt+1]))return!1;for(_e=1;_e<_.length-2;_e++)if(lineSegmentsIntersect(_[0],_[_.length-1],_[_e],_[_e+1]))return!1;return!0}function getIntersectionPoint(et,_,_e,tt,nt){nt=nt||0;var rt=_[1]-et[1],it=et[0]-_[0],st=rt*et[0]+it*et[1],ot=tt[1]-_e[1],at=_e[0]-tt[0],lt=ot*_e[0]+at*_e[1],ct=rt*at-ot*it;return scalar_eq(ct,0,nt)?[0,0]:[(at*st-it*lt)/ct,(rt*lt-ot*st)/ct]}function polygonQuickDecomp(et,_,_e,tt,nt,rt,it){rt=rt||100,it=it||0,nt=nt||25,_=typeof _<"u"?_:[],_e=_e||[],tt=tt||[];var st=[0,0],ot=[0,0],at=[0,0],lt=0,ct=0,ht=0,ut=0,ft=0,dt=0,pt=0,mt=[],vt=[],yt=et,_t=et;if(_t.length<3)return _;if(it++,it>rt)return console.warn("quickDecomp: max level ("+rt+") reached."),_;for(var St=0;St<et.length;++St)if(polygonIsReflex(yt,St)){_e.push(yt[St]),lt=ct=Number.MAX_VALUE;for(var bt=0;bt<et.length;++bt)isLeft(polygonAt(yt,St-1),polygonAt(yt,St),polygonAt(yt,bt))&&isRightOn(polygonAt(yt,St-1),polygonAt(yt,St),polygonAt(yt,bt-1))&&(at=getIntersectionPoint(polygonAt(yt,St-1),polygonAt(yt,St),polygonAt(yt,bt),polygonAt(yt,bt-1)),isRight(polygonAt(yt,St+1),polygonAt(yt,St),at)&&(ht=sqdist(yt[St],at),ht<ct&&(ct=ht,ot=at,dt=bt))),isLeft(polygonAt(yt,St+1),polygonAt(yt,St),polygonAt(yt,bt+1))&&isRightOn(polygonAt(yt,St+1),polygonAt(yt,St),polygonAt(yt,bt))&&(at=getIntersectionPoint(polygonAt(yt,St+1),polygonAt(yt,St),polygonAt(yt,bt),polygonAt(yt,bt+1)),isLeft(polygonAt(yt,St-1),polygonAt(yt,St),at)&&(ht=sqdist(yt[St],at),ht<lt&&(lt=ht,st=at,ft=bt)));if(dt===(ft+1)%et.length)at[0]=(ot[0]+st[0])/2,at[1]=(ot[1]+st[1])/2,tt.push(at),St<ft?(polygonAppend(mt,yt,St,ft+1),mt.push(at),vt.push(at),dt!==0&&polygonAppend(vt,yt,dt,yt.length),polygonAppend(vt,yt,0,St+1)):(St!==0&&polygonAppend(mt,yt,St,yt.length),polygonAppend(mt,yt,0,ft+1),mt.push(at),vt.push(at),polygonAppend(vt,yt,dt,St+1));else{if(dt>ft&&(ft+=et.length),ut=Number.MAX_VALUE,ft<dt)return _;for(var bt=dt;bt<=ft;++bt)isLeftOn(polygonAt(yt,St-1),polygonAt(yt,St),polygonAt(yt,bt))&&isRightOn(polygonAt(yt,St+1),polygonAt(yt,St),polygonAt(yt,bt))&&(ht=sqdist(polygonAt(yt,St),polygonAt(yt,bt)),ht<ut&&polygonCanSee2(yt,St,bt)&&(ut=ht,pt=bt%et.length));St<pt?(polygonAppend(mt,yt,St,pt+1),pt!==0&&polygonAppend(vt,yt,pt,_t.length),polygonAppend(vt,yt,0,St+1)):(St!==0&&polygonAppend(mt,yt,St,_t.length),polygonAppend(mt,yt,0,pt+1),polygonAppend(vt,yt,pt,St+1))}return mt.length<vt.length?(polygonQuickDecomp(mt,_,_e,tt,nt,rt,it),polygonQuickDecomp(vt,_,_e,tt,nt,rt,it)):(polygonQuickDecomp(vt,_,_e,tt,nt,rt,it),polygonQuickDecomp(mt,_,_e,tt,nt,rt,it)),_}return _.push(et),_}function polygonRemoveCollinearPoints(et,_){for(var _e=0,tt=et.length-1;et.length>3&&tt>=0;--tt)collinear(polygonAt(et,tt-1),polygonAt(et,tt),polygonAt(et,tt+1),_)&&(et.splice(tt%et.length,1),_e++);return _e}function polygonRemoveDuplicatePoints(et,_){for(var _e=et.length-1;_e>=1;--_e)for(var tt=et[_e],nt=_e-1;nt>=0;--nt)if(points_eq(tt,et[nt],_)){et.splice(_e,1);continue}}function scalar_eq(et,_,_e){return _e=_e||0,Math.abs(et-_)<=_e}function points_eq(et,_,_e){return scalar_eq(et[0],_[0],_e)&&scalar_eq(et[1],_[1],_e)}const decomp=getDefaultExportFromCjs(src$4),MatterContext=reactExports.createContext(null),useMatterContext=()=>{const et=reactExports.useContext(MatterContext);if(!et)throw new Error("useMatterContext must be used within a MatterContextProvider");return et};let instance,cloud,foundry,mousePosition$1={x:0,y:0};function MatterContextProvider({children:et,containerRef:_,active:_e,ready:tt,pageNumber:nt}){const rt=()=>{instance&&instance.resize(),cloud&&cloud.repositionWalls(),foundry&&foundry.updateWrap()},it=st=>{mousePosition$1={x:st.clientX,y:st.clientY}};return reactExports.useEffect(()=>{if(Matter.use(MatterWrap),Matter.Common.setDecomp(decomp),!!_.current&&(instance||(instance=new MatterInstance(_.current,{category:MatterCategory.Character,mask:MatterCategory.Character})),foundry||(foundry=new Foundry(instance)),cloud||(cloud=new Cloud(instance)),!!_.current))return instance.resize(),cloud.spawnWalls(),cloud.repositionWalls(),Matter.Events.on(instance.engine,"beforeUpdate",()=>{cloud.applyForce(mousePosition$1.x,mousePosition$1.y)}),window.addEventListener("resize",rt),window.addEventListener("mousemove",it),Matter.Events.on(instance.constraint,"mousedown",()=>{var st;(st=document.getElementById("idea-field"))==null||st.blur()}),()=>{window.removeEventListener("resize",rt),window.removeEventListener("mousemove",it),instance&&instance.clear()}},[]),reactExports.useEffect(()=>{_e===nt||(_.current.classList.remove("show"),instance.stop())},[_e]),reactExports.useEffect(()=>{tt===nt&&(_.current.classList.add("show"),instance.run())},[tt]),jsxRuntimeExports.jsx(MatterContext.Provider,{value:{instance,cloud,foundry},children:et})}let letterIndex=0,letterSize=0,letterPosition={x:0,y:0},delayDuration=500,showDuration=1e3;function IdeaField({pageNumber:et}){const[_,_e,tt]=useState(!1),[nt,rt,it]=useState(""),st=reactExports.useRef(null),ot=reactExports.useRef(null),at=reactExports.useRef(null),lt=reactExports.useRef(null),ct=reactExports.useRef(null),ht=reactExports.useRef(null),ut=reactExports.useRef(null),{active:ft}=usePage(),{cloud:dt,foundry:pt}=useMatterContext(),mt=()=>{var St;if(!ht.current)return;letterSize=textWidth("a",getComputedStyle(ht.current).font);const _t=(St=ut.current)==null?void 0:St.getBoundingClientRect();_t?letterPosition={x:_t.left-letterSize,y:_t.top+_t.height/2}:letterPosition={x:0,y:0}},vt=_t=>{_t.key==="Enter"&&st.current&&st.current.value.length!=0&&(_t.preventDefault(),rt(st.current.value),st.current.value="",st.current.placeholder="",st.current.style.pointerEvents="none",st.current.blur())};reactExports.useEffect(()=>(mt(),window.addEventListener("resize",mt),()=>window.removeEventListener("resize",mt)),[]);const yt=()=>{st.current&&(st.current.placeholder="Type something",st.current.style.pointerEvents="auto",hasMouse&&st.current.focus(),rt(""))};return reactExports.useEffect(()=>{!nt||!ht.current||(letterIndex=0,ht.current.querySelectorAll("span").forEach((_t,St)=>{animate(_t,{x:"-100svw",duration:150,delay:100*St,ease:"in",onComplete:()=>{pt.printf(nt[letterIndex],letterPosition.x,letterPosition.y,letterSize),++letterIndex>=nt.length&&yt()}})}))},[nt]),reactExports.useEffect(()=>{if(ft===et&&!tt.current){if(_e(!0),!st.current||!ot.current||!at.current||!lt.current)return;st.current.value="into reality",st.current.style.pointerEvents="none",animate(ot.current,{translateX:{from:"100%",to:"0%"},duration:showDuration,delay:delayDuration+showDuration}),animate(at.current,{translateX:{from:"-100%",to:"0%"},duration:showDuration,delay:delayDuration+showDuration*.7}),animate(lt.current,{height:{from:"0%",to:"100%"},duration:showDuration,delay:delayDuration}),setTimeout(()=>dt.explodeAtCenter(),delayDuration+showDuration),setTimeout(()=>{vt({key:"Enter",preventDefault:()=>{}}),ct.current&&animate(ct.current.querySelectorAll("span"),{translateX:0,duration:showDuration,delay:stagger(showDuration*1.5,{start:2e3})})},delayDuration+showDuration+1e3)}},[ft]),jsxRuntimeExports.jsxs("div",{className:"absolute w-svw h-svh z-50 pointer-events-none",children:[jsxRuntimeExports.jsxs("div",{className:"overflow-hidden absolute top-1/2 translate-y-[-50%] w-full text-white text-idea font-serif flex flex-col justify-center items-center select-none",children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden w-1/2 translate-x-[calc(-50%-min(0.5svw,0.2rem))] flex justify-end",children:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{ref:ot,style:{transform:"translateX(100%)"},children:"Turn your ideas"})})}),jsxRuntimeExports.jsxs("div",{ref:ut,className:"overflow-hidden w-1/2 translate-x-[calc(50%+min(0.5svw,0.2rem))] flex justify-start",children:[jsxRuntimeExports.jsx("div",{ref:at,style:{transform:"translateX(-100%)"},children:jsxRuntimeExports.jsx("input",{className:"border-none outline-none bg-transparent overflow-hidden pointer-events-auto select-auto",ref:st,type:"text",onKeyDown:vt,placeholder:"Type something",maxLength:30})}),jsxRuntimeExports.jsx("div",{ref:ht,className:"absolute overflow-hidden top-0 pointer-events-none select-none w-full h-full flex",children:it.current.split("").map((_t,St)=>jsxRuntimeExports.jsx("span",{children:_t===" "?"":_t},St))})]}),jsxRuntimeExports.jsxs("div",{ref:lt,className:"absolute inset-0 m-auto bg-transparent w-[min(0.5svw,0.2rem)] flex flex-col",style:{height:"0%"},children:[jsxRuntimeExports.jsx("div",{className:"bg-white w-full flex-1"}),jsxRuntimeExports.jsx("div",{className:"bg-white w-full flex-1"})]})]}),jsxRuntimeExports.jsx("div",{className:"text-white font-mono text-ideaHalf w-full h-full flex justify-center items-center pointer-events-none -translate-x-[30%] translate-y-[15%]",children:jsxRuntimeExports.jsxs("div",{ref:ct,className:"overflow-hidden flex flex-col",children:[jsxRuntimeExports.jsxs("span",{className:"flex",style:{transform:"translateX(-100%)"},children:["This is all magic",jsxRuntimeExports.jsx("svg",{className:"inline-svg fill-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:jsxRuntimeExports.jsx("path",{d:"M31 0H15v2h13.59L.29 30.29 1.7 31.7 30 3.41V16h2V1a1 1 0 0 0-1-1z","data-name":"5-Arrow Up"})})]}),jsxRuntimeExports.jsx("span",{style:{transform:"translateX(-100%)"},children:"No seriously,"}),jsxRuntimeExports.jsx("span",{style:{transform:"translateX(-100%)"},children:"Try dragging the letters"})]})})]})}function LetterPage({containerRef:et,pageNumber:_}){const _e=reactExports.useRef(null),[tt,nt]=useState(!1);reactExports.useEffect(()=>nt(!!_e.current),[_e.current]);const{active:rt,ready:it}=usePage();return reactExports.useEffect(()=>{rt===_||et.current.classList.remove("show")},[rt]),reactExports.useEffect(()=>{it===_&&et.current.classList.add("show")},[it]),jsxRuntimeExports.jsxs("div",{className:"w-full h-full",children:[jsxRuntimeExports.jsx("div",{ref:_e,className:"absolute top-0 w-full h-full"}),tt&&jsxRuntimeExports.jsx(MatterContextProvider,{containerRef:_e,active:rt,ready:it,pageNumber:_,children:jsxRuntimeExports.jsx(IdeaField,{pageNumber:_})})]})}const scriptRel="modulepreload",assetsURL=function(et){return"/"+et},seen={},__vitePreload=function(_,_e,tt){let nt=Promise.resolve();if(_e&&_e.length>0){document.getElementsByTagName("link");const rt=document.querySelector("meta[property=csp-nonce]"),it=(rt==null?void 0:rt.nonce)||(rt==null?void 0:rt.getAttribute("nonce"));nt=Promise.all(_e.map(st=>{if(st=assetsURL(st),st in seen)return;seen[st]=!0;const ot=st.endsWith(".css"),at=ot?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${st}"]${at}`))return;const lt=document.createElement("link");if(lt.rel=ot?"stylesheet":scriptRel,ot||(lt.as="script",lt.crossOrigin=""),lt.href=st,it&&lt.setAttribute("nonce",it),document.head.appendChild(lt),ot)return new Promise((ct,ht)=>{lt.addEventListener("load",ct),lt.addEventListener("error",()=>ht(new Error(`Unable to preload CSS for ${st}`)))})}))}return nt.then(()=>_()).catch(rt=>{const it=new Event("vite:preloadError",{cancelable:!0});if(it.payload=rt,window.dispatchEvent(it),!it.defaultPrevented)throw rt})};var ExtensionType=(et=>(et.Application="application",et.WebGLPipes="webgl-pipes",et.WebGLPipesAdaptor="webgl-pipes-adaptor",et.WebGLSystem="webgl-system",et.WebGPUPipes="webgpu-pipes",et.WebGPUPipesAdaptor="webgpu-pipes-adaptor",et.WebGPUSystem="webgpu-system",et.CanvasSystem="canvas-system",et.CanvasPipesAdaptor="canvas-pipes-adaptor",et.CanvasPipes="canvas-pipes",et.Asset="asset",et.LoadParser="load-parser",et.ResolveParser="resolve-parser",et.CacheParser="cache-parser",et.DetectionParser="detection-parser",et.MaskEffect="mask-effect",et.BlendMode="blend-mode",et.TextureSource="texture-source",et.Environment="environment",et.ShapeBuilder="shape-builder",et))(ExtensionType||{});const normalizeExtension=et=>{if(typeof et=="function"||typeof et=="object"&&et.extension){if(!et.extension)throw new Error("Extension class must have an extension object");et={...typeof et.extension!="object"?{type:et.extension}:et.extension,ref:et}}if(typeof et=="object")et={...et};else throw new Error("Invalid extension type");return typeof et.type=="string"&&(et.type=[et.type]),et},normalizeExtensionPriority=(et,_)=>normalizeExtension(et).priority??_,extensions={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...et){return et.map(normalizeExtension).forEach(_=>{_.type.forEach(_e=>{var tt,nt;return(nt=(tt=this._removeHandlers)[_e])==null?void 0:nt.call(tt,_)})}),this},add(...et){return et.map(normalizeExtension).forEach(_=>{_.type.forEach(_e=>{var rt,it;const tt=this._addHandlers,nt=this._queue;tt[_e]?(it=tt[_e])==null||it.call(tt,_):(nt[_e]=nt[_e]||[],(rt=nt[_e])==null||rt.push(_))})}),this},handle(et,_,_e){var it;const tt=this._addHandlers,nt=this._removeHandlers;if(tt[et]||nt[et])throw new Error(`Extension type ${et} already has a handler`);tt[et]=_,nt[et]=_e;const rt=this._queue;return rt[et]&&((it=rt[et])==null||it.forEach(st=>_(st)),delete rt[et]),this},handleByMap(et,_){return this.handle(et,_e=>{_e.name&&(_[_e.name]=_e.ref)},_e=>{_e.name&&delete _[_e.name]})},handleByNamedList(et,_,_e=-1){return this.handle(et,tt=>{_.findIndex(rt=>rt.name===tt.name)>=0||(_.push({name:tt.name,value:tt.ref}),_.sort((rt,it)=>normalizeExtensionPriority(it.value,_e)-normalizeExtensionPriority(rt.value,_e)))},tt=>{const nt=_.findIndex(rt=>rt.name===tt.name);nt!==-1&&_.splice(nt,1)})},handleByList(et,_,_e=-1){return this.handle(et,tt=>{_.includes(tt.ref)||(_.push(tt.ref),_.sort((nt,rt)=>normalizeExtensionPriority(rt,_e)-normalizeExtensionPriority(nt,_e)))},tt=>{const nt=_.indexOf(tt.ref);nt!==-1&&_.splice(nt,1)})}},browserExt={extension:{type:ExtensionType.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await __vitePreload(()=>import("./browserAll-BI18dRaT.js"),__vite__mapDeps([0,1,2,3,4]))}},webworkerExt={extension:{type:ExtensionType.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await __vitePreload(()=>import("./webworkerAll-BmilryU9.js"),__vite__mapDeps([1,2,3,4]))}};class ObservablePoint{constructor(_,_e,tt){this._x=_e||0,this._y=tt||0,this._observer=_}clone(_){return new ObservablePoint(_??this._observer,this._x,this._y)}set(_=0,_e=_){return(this._x!==_||this._y!==_e)&&(this._x=_,this._y=_e,this._observer._onUpdate(this)),this}copyFrom(_){return(this._x!==_.x||this._y!==_.y)&&(this._x=_.x,this._y=_.y,this._observer._onUpdate(this)),this}copyTo(_){return _.set(this._x,this._y),_}equals(_){return _.x===this._x&&_.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(_){this._x!==_&&(this._x=_,this._observer._onUpdate(this))}get y(){return this._y}set y(_){this._y!==_&&(this._y=_,this._observer._onUpdate(this))}}var eventemitter3={exports:{}};(function(et){var _=Object.prototype.hasOwnProperty,_e="~";function tt(){}Object.create&&(tt.prototype=Object.create(null),new tt().__proto__||(_e=!1));function nt(ot,at,lt){this.fn=ot,this.context=at,this.once=lt||!1}function rt(ot,at,lt,ct,ht){if(typeof lt!="function")throw new TypeError("The listener must be a function");var ut=new nt(lt,ct||ot,ht),ft=_e?_e+at:at;return ot._events[ft]?ot._events[ft].fn?ot._events[ft]=[ot._events[ft],ut]:ot._events[ft].push(ut):(ot._events[ft]=ut,ot._eventsCount++),ot}function it(ot,at){--ot._eventsCount===0?ot._events=new tt:delete ot._events[at]}function st(){this._events=new tt,this._eventsCount=0}st.prototype.eventNames=function(){var at=[],lt,ct;if(this._eventsCount===0)return at;for(ct in lt=this._events)_.call(lt,ct)&&at.push(_e?ct.slice(1):ct);return Object.getOwnPropertySymbols?at.concat(Object.getOwnPropertySymbols(lt)):at},st.prototype.listeners=function(at){var lt=_e?_e+at:at,ct=this._events[lt];if(!ct)return[];if(ct.fn)return[ct.fn];for(var ht=0,ut=ct.length,ft=new Array(ut);ht<ut;ht++)ft[ht]=ct[ht].fn;return ft},st.prototype.listenerCount=function(at){var lt=_e?_e+at:at,ct=this._events[lt];return ct?ct.fn?1:ct.length:0},st.prototype.emit=function(at,lt,ct,ht,ut,ft){var dt=_e?_e+at:at;if(!this._events[dt])return!1;var pt=this._events[dt],mt=arguments.length,vt,yt;if(pt.fn){switch(pt.once&&this.removeListener(at,pt.fn,void 0,!0),mt){case 1:return pt.fn.call(pt.context),!0;case 2:return pt.fn.call(pt.context,lt),!0;case 3:return pt.fn.call(pt.context,lt,ct),!0;case 4:return pt.fn.call(pt.context,lt,ct,ht),!0;case 5:return pt.fn.call(pt.context,lt,ct,ht,ut),!0;case 6:return pt.fn.call(pt.context,lt,ct,ht,ut,ft),!0}for(yt=1,vt=new Array(mt-1);yt<mt;yt++)vt[yt-1]=arguments[yt];pt.fn.apply(pt.context,vt)}else{var _t=pt.length,St;for(yt=0;yt<_t;yt++)switch(pt[yt].once&&this.removeListener(at,pt[yt].fn,void 0,!0),mt){case 1:pt[yt].fn.call(pt[yt].context);break;case 2:pt[yt].fn.call(pt[yt].context,lt);break;case 3:pt[yt].fn.call(pt[yt].context,lt,ct);break;case 4:pt[yt].fn.call(pt[yt].context,lt,ct,ht);break;default:if(!vt)for(St=1,vt=new Array(mt-1);St<mt;St++)vt[St-1]=arguments[St];pt[yt].fn.apply(pt[yt].context,vt)}}return!0},st.prototype.on=function(at,lt,ct){return rt(this,at,lt,ct,!1)},st.prototype.once=function(at,lt,ct){return rt(this,at,lt,ct,!0)},st.prototype.removeListener=function(at,lt,ct,ht){var ut=_e?_e+at:at;if(!this._events[ut])return this;if(!lt)return it(this,ut),this;var ft=this._events[ut];if(ft.fn)ft.fn===lt&&(!ht||ft.once)&&(!ct||ft.context===ct)&&it(this,ut);else{for(var dt=0,pt=[],mt=ft.length;dt<mt;dt++)(ft[dt].fn!==lt||ht&&!ft[dt].once||ct&&ft[dt].context!==ct)&&pt.push(ft[dt]);pt.length?this._events[ut]=pt.length===1?pt[0]:pt:it(this,ut)}return this},st.prototype.removeAllListeners=function(at){var lt;return at?(lt=_e?_e+at:at,this._events[lt]&&it(this,lt)):(this._events=new tt,this._eventsCount=0),this},st.prototype.off=st.prototype.removeListener,st.prototype.addListener=st.prototype.on,st.prefixed=_e,st.EventEmitter=st,et.exports=st})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports),PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;class Point{constructor(_=0,_e=0){this.x=0,this.y=0,this.x=_,this.y=_e}clone(){return new Point(this.x,this.y)}copyFrom(_){return this.set(_.x,_.y),this}copyTo(_){return _.set(this.x,this.y),_}equals(_){return _.x===this.x&&_.y===this.y}set(_=0,_e=_){return this.x=_,this.y=_e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return tempPoint.x=0,tempPoint.y=0,tempPoint}}const tempPoint=new Point;let Matrix$4=class u0{constructor(_=1,_e=0,tt=0,nt=1,rt=0,it=0){this.array=null,this.a=_,this.b=_e,this.c=tt,this.d=nt,this.tx=rt,this.ty=it}fromArray(_){this.a=_[0],this.b=_[1],this.c=_[3],this.d=_[4],this.tx=_[2],this.ty=_[5]}set(_,_e,tt,nt,rt,it){return this.a=_,this.b=_e,this.c=tt,this.d=nt,this.tx=rt,this.ty=it,this}toArray(_,_e){this.array||(this.array=new Float32Array(9));const tt=_e||this.array;return _?(tt[0]=this.a,tt[1]=this.b,tt[2]=0,tt[3]=this.c,tt[4]=this.d,tt[5]=0,tt[6]=this.tx,tt[7]=this.ty,tt[8]=1):(tt[0]=this.a,tt[1]=this.c,tt[2]=this.tx,tt[3]=this.b,tt[4]=this.d,tt[5]=this.ty,tt[6]=0,tt[7]=0,tt[8]=1),tt}apply(_,_e){_e=_e||new Point;const tt=_.x,nt=_.y;return _e.x=this.a*tt+this.c*nt+this.tx,_e.y=this.b*tt+this.d*nt+this.ty,_e}applyInverse(_,_e){_e=_e||new Point;const tt=this.a,nt=this.b,rt=this.c,it=this.d,st=this.tx,ot=this.ty,at=1/(tt*it+rt*-nt),lt=_.x,ct=_.y;return _e.x=it*at*lt+-rt*at*ct+(ot*rt-st*it)*at,_e.y=tt*at*ct+-nt*at*lt+(-ot*tt+st*nt)*at,_e}translate(_,_e){return this.tx+=_,this.ty+=_e,this}scale(_,_e){return this.a*=_,this.d*=_e,this.c*=_,this.b*=_e,this.tx*=_,this.ty*=_e,this}rotate(_){const _e=Math.cos(_),tt=Math.sin(_),nt=this.a,rt=this.c,it=this.tx;return this.a=nt*_e-this.b*tt,this.b=nt*tt+this.b*_e,this.c=rt*_e-this.d*tt,this.d=rt*tt+this.d*_e,this.tx=it*_e-this.ty*tt,this.ty=it*tt+this.ty*_e,this}append(_){const _e=this.a,tt=this.b,nt=this.c,rt=this.d;return this.a=_.a*_e+_.b*nt,this.b=_.a*tt+_.b*rt,this.c=_.c*_e+_.d*nt,this.d=_.c*tt+_.d*rt,this.tx=_.tx*_e+_.ty*nt+this.tx,this.ty=_.tx*tt+_.ty*rt+this.ty,this}appendFrom(_,_e){const tt=_.a,nt=_.b,rt=_.c,it=_.d,st=_.tx,ot=_.ty,at=_e.a,lt=_e.b,ct=_e.c,ht=_e.d;return this.a=tt*at+nt*ct,this.b=tt*lt+nt*ht,this.c=rt*at+it*ct,this.d=rt*lt+it*ht,this.tx=st*at+ot*ct+_e.tx,this.ty=st*lt+ot*ht+_e.ty,this}setTransform(_,_e,tt,nt,rt,it,st,ot,at){return this.a=Math.cos(st+at)*rt,this.b=Math.sin(st+at)*rt,this.c=-Math.sin(st-ot)*it,this.d=Math.cos(st-ot)*it,this.tx=_-(tt*this.a+nt*this.c),this.ty=_e-(tt*this.b+nt*this.d),this}prepend(_){const _e=this.tx;if(_.a!==1||_.b!==0||_.c!==0||_.d!==1){const tt=this.a,nt=this.c;this.a=tt*_.a+this.b*_.c,this.b=tt*_.b+this.b*_.d,this.c=nt*_.a+this.d*_.c,this.d=nt*_.b+this.d*_.d}return this.tx=_e*_.a+this.ty*_.c+_.tx,this.ty=_e*_.b+this.ty*_.d+_.ty,this}decompose(_){const _e=this.a,tt=this.b,nt=this.c,rt=this.d,it=_.pivot,st=-Math.atan2(-nt,rt),ot=Math.atan2(tt,_e),at=Math.abs(st+ot);return at<1e-5||Math.abs(PI_2-at)<1e-5?(_.rotation=ot,_.skew.x=_.skew.y=0):(_.rotation=0,_.skew.x=st,_.skew.y=ot),_.scale.x=Math.sqrt(_e*_e+tt*tt),_.scale.y=Math.sqrt(nt*nt+rt*rt),_.position.x=this.tx+(it.x*_e+it.y*nt),_.position.y=this.ty+(it.x*tt+it.y*rt),_}invert(){const _=this.a,_e=this.b,tt=this.c,nt=this.d,rt=this.tx,it=_*nt-_e*tt;return this.a=nt/it,this.b=-_e/it,this.c=-tt/it,this.d=_/it,this.tx=(tt*this.ty-nt*rt)/it,this.ty=-(_*this.ty-_e*rt)/it,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const _=new u0;return _.a=this.a,_.b=this.b,_.c=this.c,_.d=this.d,_.tx=this.tx,_.ty=this.ty,_}copyTo(_){return _.a=this.a,_.b=this.b,_.c=this.c,_.d=this.d,_.tx=this.tx,_.ty=this.ty,_}copyFrom(_){return this.a=_.a,this.b=_.b,this.c=_.c,this.d=_.d,this.tx=_.tx,this.ty=_.ty,this}equals(_){return _.a===this.a&&_.b===this.b&&_.c===this.c&&_.d===this.d&&_.tx===this.tx&&_.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return identityMatrix.identity()}static get shared(){return tempMatrix$2.identity()}};const tempMatrix$2=new Matrix$4,identityMatrix=new Matrix$4,ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init(){for(let et=0;et<16;et++){const _=[];rotationCayley.push(_);for(let _e=0;_e<16;_e++){const tt=signum(ux[et]*ux[_e]+vx[et]*uy[_e]),nt=signum(uy[et]*ux[_e]+vy[et]*uy[_e]),rt=signum(ux[et]*vx[_e]+vx[et]*vy[_e]),it=signum(uy[et]*vx[_e]+vy[et]*vy[_e]);for(let st=0;st<16;st++)if(ux[st]===tt&&uy[st]===nt&&vx[st]===rt&&vy[st]===it){_.push(st);break}}}for(let et=0;et<16;et++){const _=new Matrix$4;_.set(ux[et],uy[et],vx[et],vy[et],0,0),rotationMatrices.push(_)}}init();const groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:et=>ux[et],uY:et=>uy[et],vX:et=>vx[et],vY:et=>vy[et],inv:et=>et&8?et&15:-et&7,add:(et,_)=>rotationCayley[et][_],sub:(et,_)=>rotationCayley[et][groupD8.inv(_)],rotate180:et=>et^4,isVertical:et=>(et&3)===2,byDirection:(et,_)=>Math.abs(et)*2<=Math.abs(_)?_>=0?groupD8.S:groupD8.N:Math.abs(_)*2<=Math.abs(et)?et>0?groupD8.E:groupD8.W:_>0?et>0?groupD8.SE:groupD8.SW:et>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(et,_,_e=0,tt=0)=>{const nt=rotationMatrices[groupD8.inv(_)];nt.tx=_e,nt.ty=tt,et.append(nt)}},tempPoints=[new Point,new Point,new Point,new Point];class Rectangle{constructor(_=0,_e=0,tt=0,nt=0){this.type="rectangle",this.x=Number(_),this.y=Number(_e),this.width=Number(tt),this.height=Number(nt)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFromBounds(_){return this.x=_.minX,this.y=_.minY,this.width=_.maxX-_.minX,this.height=_.maxY-_.minY,this}copyFrom(_){return this.x=_.x,this.y=_.y,this.width=_.width,this.height=_.height,this}copyTo(_){return _.copyFrom(this),_}contains(_,_e){return this.width<=0||this.height<=0?!1:_>=this.x&&_<this.x+this.width&&_e>=this.y&&_e<this.y+this.height}strokeContains(_,_e,tt){const{width:nt,height:rt}=this;if(nt<=0||rt<=0)return!1;const it=this.x,st=this.y,ot=it-tt/2,at=it+nt+tt/2,lt=st-tt/2,ct=st+rt+tt/2,ht=it+tt/2,ut=it+nt-tt/2,ft=st+tt/2,dt=st+rt-tt/2;return _>=ot&&_<=at&&_e>=lt&&_e<=ct&&!(_>ht&&_<ut&&_e>ft&&_e<dt)}intersects(_,_e){if(!_e){const Mt=this.x<_.x?_.x:this.x;if((this.right>_.right?_.right:this.right)<=Mt)return!1;const wt=this.y<_.y?_.y:this.y;return(this.bottom>_.bottom?_.bottom:this.bottom)>wt}const tt=this.left,nt=this.right,rt=this.top,it=this.bottom;if(nt<=tt||it<=rt)return!1;const st=tempPoints[0].set(_.left,_.top),ot=tempPoints[1].set(_.left,_.bottom),at=tempPoints[2].set(_.right,_.top),lt=tempPoints[3].set(_.right,_.bottom);if(at.x<=st.x||ot.y<=st.y)return!1;const ct=Math.sign(_e.a*_e.d-_e.b*_e.c);if(ct===0||(_e.apply(st,st),_e.apply(ot,ot),_e.apply(at,at),_e.apply(lt,lt),Math.max(st.x,ot.x,at.x,lt.x)<=tt||Math.min(st.x,ot.x,at.x,lt.x)>=nt||Math.max(st.y,ot.y,at.y,lt.y)<=rt||Math.min(st.y,ot.y,at.y,lt.y)>=it))return!1;const ht=ct*(ot.y-st.y),ut=ct*(st.x-ot.x),ft=ht*tt+ut*rt,dt=ht*nt+ut*rt,pt=ht*tt+ut*it,mt=ht*nt+ut*it;if(Math.max(ft,dt,pt,mt)<=ht*st.x+ut*st.y||Math.min(ft,dt,pt,mt)>=ht*lt.x+ut*lt.y)return!1;const vt=ct*(st.y-at.y),yt=ct*(at.x-st.x),_t=vt*tt+yt*rt,St=vt*nt+yt*rt,bt=vt*tt+yt*it,Et=vt*nt+yt*it;return!(Math.max(_t,St,bt,Et)<=vt*st.x+yt*st.y||Math.min(_t,St,bt,Et)>=vt*lt.x+yt*lt.y)}pad(_=0,_e=_){return this.x-=_,this.y-=_e,this.width+=_*2,this.height+=_e*2,this}fit(_){const _e=Math.max(this.x,_.x),tt=Math.min(this.x+this.width,_.x+_.width),nt=Math.max(this.y,_.y),rt=Math.min(this.y+this.height,_.y+_.height);return this.x=_e,this.width=Math.max(tt-_e,0),this.y=nt,this.height=Math.max(rt-nt,0),this}ceil(_=1,_e=.001){const tt=Math.ceil((this.x+this.width-_e)*_)/_,nt=Math.ceil((this.y+this.height-_e)*_)/_;return this.x=Math.floor((this.x+_e)*_)/_,this.y=Math.floor((this.y+_e)*_)/_,this.width=tt-this.x,this.height=nt-this.y,this}enlarge(_){const _e=Math.min(this.x,_.x),tt=Math.max(this.x+this.width,_.x+_.width),nt=Math.min(this.y,_.y),rt=Math.max(this.y+this.height,_.y+_.height);return this.x=_e,this.width=tt-_e,this.y=nt,this.height=rt-nt,this}getBounds(_){return _=_||new Rectangle,_.copyFrom(this),_}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const uidCache={default:-1};function uid(et="default"){return uidCache[et]===void 0&&(uidCache[et]=-1),++uidCache[et]}const warnings={},v8_0_0="8.0.0";function deprecation(et,_,_e=3){if(warnings[_])return;let tt=new Error().stack;typeof tt>"u"?console.warn("PixiJS Deprecation Warning: ",`${_}
Deprecated since v${et}`):(tt=tt.split(`
`).splice(_e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${_}
Deprecated since v${et}`),console.warn(tt),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${_}
Deprecated since v${et}`),console.warn(tt))),warnings[_]=!0}const NOOP=()=>{};function nextPow2(et){return et+=et===0?1:0,--et,et|=et>>>1,et|=et>>>2,et|=et>>>4,et|=et>>>8,et|=et>>>16,et+1}function isPow2(et){return!(et&et-1)&&!!et}function definedProps(et){const _={};for(const _e in et)et[_e]!==void 0&&(_[_e]=et[_e]);return _}const idHash=Object.create(null);function createResourceIdFromString(et){const _=idHash[et];return _===void 0&&(idHash[et]=uid("resource")),_}const _TextureStyle=class h0 extends EventEmitter{constructor(_={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,_={...h0.defaultOptions,..._},this.addressMode=_.addressMode,this.addressModeU=_.addressModeU??this.addressModeU,this.addressModeV=_.addressModeV??this.addressModeV,this.addressModeW=_.addressModeW??this.addressModeW,this.scaleMode=_.scaleMode,this.magFilter=_.magFilter??this.magFilter,this.minFilter=_.minFilter??this.minFilter,this.mipmapFilter=_.mipmapFilter??this.mipmapFilter,this.lodMinClamp=_.lodMinClamp,this.lodMaxClamp=_.lodMaxClamp,this.compare=_.compare,this.maxAnisotropy=_.maxAnisotropy??1}set addressMode(_){this.addressModeU=_,this.addressModeV=_,this.addressModeW=_}get addressMode(){return this.addressModeU}set wrapMode(_){deprecation(v8_0_0,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=_}get wrapMode(){return this.addressMode}set scaleMode(_){this.magFilter=_,this.minFilter=_,this.mipmapFilter=_}get scaleMode(){return this.magFilter}set maxAnisotropy(_){this._maxAnisotropy=Math.min(_,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const _=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=createResourceIdFromString(_),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};_TextureStyle.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let TextureStyle=_TextureStyle;const _TextureSource=class f0 extends EventEmitter{constructor(_={}){super(),this.options=_,this.uid=uid("textureSource"),this._resourceType="textureSource",this._resourceId=uid("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,_={...f0.defaultOptions,..._},this.label=_.label??"",this.resource=_.resource,this.autoGarbageCollect=_.autoGarbageCollect,this._resolution=_.resolution,_.width?this.pixelWidth=_.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,_.height?this.pixelHeight=_.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=_.format,this.dimension=_.dimensions,this.mipLevelCount=_.mipLevelCount,this.autoGenerateMipmaps=_.autoGenerateMipmaps,this.sampleCount=_.sampleCount,this.antialias=_.antialias,this.alphaMode=_.alphaMode,this.style=new TextureStyle(definedProps(_)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(_){var _e,tt;this.style!==_&&((_e=this._style)==null||_e.off("change",this._onStyleChange,this),this._style=_,(tt=this._style)==null||tt.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(_){this._style.addressMode=_}get repeatMode(){return this._style.addressMode}set repeatMode(_){this._style.addressMode=_}get magFilter(){return this._style.magFilter}set magFilter(_){this._style.magFilter=_}get minFilter(){return this._style.minFilter}set minFilter(_){this._style.minFilter=_}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(_){this._style.mipmapFilter=_}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(_){this._style.lodMinClamp=_}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(_){this._style.lodMaxClamp=_}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const _=this._resolution;if(this.resize(this.resourceWidth/_,this.resourceHeight/_))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=uid("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:_}=this;return _.naturalWidth||_.videoWidth||_.displayWidth||_.width}get resourceHeight(){const{resource:_}=this;return _.naturalHeight||_.videoHeight||_.displayHeight||_.height}get resolution(){return this._resolution}set resolution(_){this._resolution!==_&&(this._resolution=_,this.width=this.pixelWidth/_,this.height=this.pixelHeight/_)}resize(_,_e,tt){tt=tt||this._resolution,_=_||this.width,_e=_e||this.height;const nt=Math.round(_*tt),rt=Math.round(_e*tt);return this.width=nt/tt,this.height=rt/tt,this._resolution=tt,this.pixelWidth===nt&&this.pixelHeight===rt?!1:(this._refreshPOT(),this.pixelWidth=nt,this.pixelHeight=rt,this.emit("resize",this),this._resourceId=uid("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(_){this._style.wrapMode=_}get wrapMode(){return this._style.wrapMode}set scaleMode(_){this._style.scaleMode=_}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=isPow2(this.pixelWidth)&&isPow2(this.pixelHeight)}static test(_){throw new Error("Unimplemented")}};_TextureSource.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let TextureSource=_TextureSource;class BufferImageSource extends TextureSource{constructor(_){const _e=_.resource||new Float32Array(_.width*_.height*4);let tt=_.format;tt||(_e instanceof Float32Array?tt="rgba32float":_e instanceof Int32Array||_e instanceof Uint32Array?tt="rgba32uint":_e instanceof Int16Array||_e instanceof Uint16Array?tt="rgba16uint":(_e instanceof Int8Array,tt="bgra8unorm")),super({..._,resource:_e,format:tt}),this.uploadMethodId="buffer"}static test(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array}}BufferImageSource.extension=ExtensionType.TextureSource;const tempMat=new Matrix$4;class TextureMatrix{constructor(_,_e){this.mapCoord=new Matrix$4,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof _e>"u"?this.clampMargin=_.width<10?0:.5:this.clampMargin=_e,this.isSimple=!1,this.texture=_}get texture(){return this._texture}set texture(_){var _e;this.texture!==_&&((_e=this._texture)==null||_e.removeListener("update",this.update,this),this._texture=_,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(_,_e){_e===void 0&&(_e=_);const tt=this.mapCoord;for(let nt=0;nt<_.length;nt+=2){const rt=_[nt],it=_[nt+1];_e[nt]=rt*tt.a+it*tt.c+tt.tx,_e[nt+1]=rt*tt.b+it*tt.d+tt.ty}return _e}update(){const _=this._texture;this._updateID++;const _e=_.uvs;this.mapCoord.set(_e.x1-_e.x0,_e.y1-_e.y0,_e.x3-_e.x0,_e.y3-_e.y0,_e.x0,_e.y0);const tt=_.orig,nt=_.trim;nt&&(tempMat.set(tt.width/nt.width,0,0,tt.height/nt.height,-nt.x/nt.width,-nt.y/nt.height),this.mapCoord.append(tempMat));const rt=_.source,it=this.uClampFrame,st=this.clampMargin/rt._resolution,ot=this.clampOffset/rt._resolution;return it[0]=(_.frame.x+st+ot)/rt.width,it[1]=(_.frame.y+st+ot)/rt.height,it[2]=(_.frame.x+_.frame.width-st+ot)/rt.width,it[3]=(_.frame.y+_.frame.height-st+ot)/rt.height,this.uClampOffset[0]=this.clampOffset/rt.pixelWidth,this.uClampOffset[1]=this.clampOffset/rt.pixelHeight,this.isSimple=_.frame.width===rt.width&&_.frame.height===rt.height&&_.rotate===0,!0}}class Texture extends EventEmitter{constructor({source:_,label:_e,frame:tt,orig:nt,trim:rt,defaultAnchor:it,defaultBorders:st,rotate:ot,dynamic:at}={}){if(super(),this.uid=uid("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Rectangle,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=_e,this.source=(_==null?void 0:_.source)??new TextureSource,this.noFrame=!tt,tt)this.frame.copyFrom(tt);else{const{width:lt,height:ct}=this._source;this.frame.width=lt,this.frame.height=ct}this.orig=nt||this.frame,this.trim=rt,this.rotate=ot??0,this.defaultAnchor=it,this.defaultBorders=st,this.destroyed=!1,this.dynamic=at||!1,this.updateUvs()}set source(_){this._source&&this._source.off("resize",this.update,this),this._source=_,_.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new TextureMatrix(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:_,frame:_e}=this,{width:tt,height:nt}=this._source,rt=_e.x/tt,it=_e.y/nt,st=_e.width/tt,ot=_e.height/nt;let at=this.rotate;if(at){const lt=st/2,ct=ot/2,ht=rt+lt,ut=it+ct;at=groupD8.add(at,groupD8.NW),_.x0=ht+lt*groupD8.uX(at),_.y0=ut+ct*groupD8.uY(at),at=groupD8.add(at,2),_.x1=ht+lt*groupD8.uX(at),_.y1=ut+ct*groupD8.uY(at),at=groupD8.add(at,2),_.x2=ht+lt*groupD8.uX(at),_.y2=ut+ct*groupD8.uY(at),at=groupD8.add(at,2),_.x3=ht+lt*groupD8.uX(at),_.y3=ut+ct*groupD8.uY(at)}else _.x0=rt,_.y0=it,_.x1=rt+st,_.y1=it,_.x2=rt+st,_.y2=it+ot,_.x3=rt,_.y3=it+ot}destroy(_=!1){this._source&&_&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return deprecation(v8_0_0,"Texture.baseTexture is now Texture.source"),this._source}}Texture.EMPTY=new Texture({label:"EMPTY",source:new TextureSource({label:"EMPTY"})});Texture.EMPTY.destroy=NOOP;Texture.WHITE=new Texture({source:new BufferImageSource({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Texture.WHITE.destroy=NOOP;function updateQuadBounds(et,_,_e,tt){const{width:nt,height:rt}=_e.orig,it=_e.trim;if(it){const st=it.width,ot=it.height;et.minX=it.x-_._x*nt-tt,et.maxX=et.minX+st,et.minY=it.y-_._y*rt-tt,et.maxY=et.minY+ot}else et.minX=-_._x*nt-tt,et.maxX=et.minX+nt,et.minY=-_._y*rt-tt,et.maxY=et.minY+rt}const defaultMatrix=new Matrix$4;class Bounds{constructor(_=1/0,_e=1/0,tt=-1/0,nt=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=defaultMatrix,this.minX=_,this.minY=_e,this.maxX=tt,this.maxY=nt}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Rectangle);const _=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(_.x=0,_.y=0,_.width=0,_.height=0):_.copyFromBounds(this),_}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=defaultMatrix,this}set(_,_e,tt,nt){this.minX=_,this.minY=_e,this.maxX=tt,this.maxY=nt}addFrame(_,_e,tt,nt,rt){rt||(rt=this.matrix);const it=rt.a,st=rt.b,ot=rt.c,at=rt.d,lt=rt.tx,ct=rt.ty;let ht=this.minX,ut=this.minY,ft=this.maxX,dt=this.maxY,pt=it*_+ot*_e+lt,mt=st*_+at*_e+ct;pt<ht&&(ht=pt),mt<ut&&(ut=mt),pt>ft&&(ft=pt),mt>dt&&(dt=mt),pt=it*tt+ot*_e+lt,mt=st*tt+at*_e+ct,pt<ht&&(ht=pt),mt<ut&&(ut=mt),pt>ft&&(ft=pt),mt>dt&&(dt=mt),pt=it*_+ot*nt+lt,mt=st*_+at*nt+ct,pt<ht&&(ht=pt),mt<ut&&(ut=mt),pt>ft&&(ft=pt),mt>dt&&(dt=mt),pt=it*tt+ot*nt+lt,mt=st*tt+at*nt+ct,pt<ht&&(ht=pt),mt<ut&&(ut=mt),pt>ft&&(ft=pt),mt>dt&&(dt=mt),this.minX=ht,this.minY=ut,this.maxX=ft,this.maxY=dt}addRect(_,_e){this.addFrame(_.x,_.y,_.x+_.width,_.y+_.height,_e)}addBounds(_,_e){this.addFrame(_.minX,_.minY,_.maxX,_.maxY,_e)}addBoundsMask(_){this.minX=this.minX>_.minX?this.minX:_.minX,this.minY=this.minY>_.minY?this.minY:_.minY,this.maxX=this.maxX<_.maxX?this.maxX:_.maxX,this.maxY=this.maxY<_.maxY?this.maxY:_.maxY}applyMatrix(_){const _e=this.minX,tt=this.minY,nt=this.maxX,rt=this.maxY,{a:it,b:st,c:ot,d:at,tx:lt,ty:ct}=_;let ht=it*_e+ot*tt+lt,ut=st*_e+at*tt+ct;this.minX=ht,this.minY=ut,this.maxX=ht,this.maxY=ut,ht=it*nt+ot*tt+lt,ut=st*nt+at*tt+ct,this.minX=ht<this.minX?ht:this.minX,this.minY=ut<this.minY?ut:this.minY,this.maxX=ht>this.maxX?ht:this.maxX,this.maxY=ut>this.maxY?ut:this.maxY,ht=it*_e+ot*rt+lt,ut=st*_e+at*rt+ct,this.minX=ht<this.minX?ht:this.minX,this.minY=ut<this.minY?ut:this.minY,this.maxX=ht>this.maxX?ht:this.maxX,this.maxY=ut>this.maxY?ut:this.maxY,ht=it*nt+ot*rt+lt,ut=st*nt+at*rt+ct,this.minX=ht<this.minX?ht:this.minX,this.minY=ut<this.minY?ut:this.minY,this.maxX=ht>this.maxX?ht:this.maxX,this.maxY=ut>this.maxY?ut:this.maxY}fit(_){return this.minX<_.left&&(this.minX=_.left),this.maxX>_.right&&(this.maxX=_.right),this.minY<_.top&&(this.minY=_.top),this.maxY>_.bottom&&(this.maxY=_.bottom),this}fitBounds(_,_e,tt,nt){return this.minX<_&&(this.minX=_),this.maxX>_e&&(this.maxX=_e),this.minY<tt&&(this.minY=tt),this.maxY>nt&&(this.maxY=nt),this}pad(_,_e=_){return this.minX-=_,this.maxX+=_,this.minY-=_e,this.maxY+=_e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Bounds(this.minX,this.minY,this.maxX,this.maxY)}scale(_,_e=_){return this.minX*=_,this.minY*=_e,this.maxX*=_,this.maxY*=_e,this}get x(){return this.minX}set x(_){const _e=this.maxX-this.minX;this.minX=_,this.maxX=_+_e}get y(){return this.minY}set y(_){const _e=this.maxY-this.minY;this.minY=_,this.maxY=_+_e}get width(){return this.maxX-this.minX}set width(_){this.maxX=this.minX+_}get height(){return this.maxY-this.minY}set height(_){this.maxY=this.minY+_}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(_,_e,tt,nt){let rt=this.minX,it=this.minY,st=this.maxX,ot=this.maxY;nt||(nt=this.matrix);const at=nt.a,lt=nt.b,ct=nt.c,ht=nt.d,ut=nt.tx,ft=nt.ty;for(let dt=_e;dt<tt;dt+=2){const pt=_[dt],mt=_[dt+1],vt=at*pt+ct*mt+ut,yt=lt*pt+ht*mt+ft;rt=vt<rt?vt:rt,it=yt<it?yt:it,st=vt>st?vt:st,ot=yt>ot?yt:ot}this.minX=rt,this.minY=it,this.maxX=st,this.maxY=ot}containsPoint(_,_e){return this.minX<=_&&this.minY<=_e&&this.maxX>=_&&this.maxY>=_e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(et){return typeof et=="string"?et.length>0:typeof et=="number"},n=function(et,_,_e){return _===void 0&&(_=0),_e===void 0&&(_e=Math.pow(10,_)),Math.round(_e*et)/_e+0},e=function(et,_,_e){return _===void 0&&(_=0),_e===void 0&&(_e=1),et>_e?_e:et>_?et:_},u=function(et){return(et=isFinite(et)?et%360:0)>0?et:et+360},a=function(et){return{r:e(et.r,0,255),g:e(et.g,0,255),b:e(et.b,0,255),a:e(et.a)}},o=function(et){return{r:n(et.r),g:n(et.g),b:n(et.b),a:n(et.a,3)}},i$3=/^#([0-9a-f]{3,8})$/i,s=function(et){var _=et.toString(16);return _.length<2?"0"+_:_},h=function(et){var _=et.r,_e=et.g,tt=et.b,nt=et.a,rt=Math.max(_,_e,tt),it=rt-Math.min(_,_e,tt),st=it?rt===_?(_e-tt)/it:rt===_e?2+(tt-_)/it:4+(_-_e)/it:0;return{h:60*(st<0?st+6:st),s:rt?it/rt*100:0,v:rt/255*100,a:nt}},b=function(et){var _=et.h,_e=et.s,tt=et.v,nt=et.a;_=_/360*6,_e/=100,tt/=100;var rt=Math.floor(_),it=tt*(1-_e),st=tt*(1-(_-rt)*_e),ot=tt*(1-(1-_+rt)*_e),at=rt%6;return{r:255*[tt,st,it,it,ot,tt][at],g:255*[ot,tt,tt,st,it,it][at],b:255*[it,it,ot,tt,tt,st][at],a:nt}},g=function(et){return{h:u(et.h),s:e(et.s,0,100),l:e(et.l,0,100),a:e(et.a)}},d=function(et){return{h:n(et.h),s:n(et.s),l:n(et.l),a:n(et.a,3)}},f=function(et){return b((_e=(_=et).s,{h:_.h,s:(_e*=((tt=_.l)<50?tt:100-tt)/100)>0?2*_e/(tt+_e)*100:0,v:tt+_e,a:_.a}));var _,_e,tt},c=function(et){return{h:(_=h(et)).h,s:(nt=(200-(_e=_.s))*(tt=_.v)/100)>0&&nt<200?_e*tt/100/(nt<=100?nt:200-nt)*100:0,l:nt/2,a:_.a};var _,_e,tt,nt},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y={string:[[function(et){var _=i$3.exec(et);return _?(et=_[1]).length<=4?{r:parseInt(et[0]+et[0],16),g:parseInt(et[1]+et[1],16),b:parseInt(et[2]+et[2],16),a:et.length===4?n(parseInt(et[3]+et[3],16)/255,2):1}:et.length===6||et.length===8?{r:parseInt(et.substr(0,2),16),g:parseInt(et.substr(2,2),16),b:parseInt(et.substr(4,2),16),a:et.length===8?n(parseInt(et.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(et){var _=v.exec(et)||m.exec(et);return _?_[2]!==_[4]||_[4]!==_[6]?null:a({r:Number(_[1])/(_[2]?100/255:1),g:Number(_[3])/(_[4]?100/255:1),b:Number(_[5])/(_[6]?100/255:1),a:_[7]===void 0?1:Number(_[7])/(_[8]?100:1)}):null},"rgb"],[function(et){var _=l.exec(et)||p.exec(et);if(!_)return null;var _e,tt,nt=g({h:(_e=_[1],tt=_[2],tt===void 0&&(tt="deg"),Number(_e)*(r[tt]||1)),s:Number(_[3]),l:Number(_[4]),a:_[5]===void 0?1:Number(_[5])/(_[6]?100:1)});return f(nt)},"hsl"]],object:[[function(et){var _=et.r,_e=et.g,tt=et.b,nt=et.a,rt=nt===void 0?1:nt;return t(_)&&t(_e)&&t(tt)?a({r:Number(_),g:Number(_e),b:Number(tt),a:Number(rt)}):null},"rgb"],[function(et){var _=et.h,_e=et.s,tt=et.l,nt=et.a,rt=nt===void 0?1:nt;if(!t(_)||!t(_e)||!t(tt))return null;var it=g({h:Number(_),s:Number(_e),l:Number(tt),a:Number(rt)});return f(it)},"hsl"],[function(et){var _=et.h,_e=et.s,tt=et.v,nt=et.a,rt=nt===void 0?1:nt;if(!t(_)||!t(_e)||!t(tt))return null;var it=function(st){return{h:u(st.h),s:e(st.s,0,100),v:e(st.v,0,100),a:e(st.a)}}({h:Number(_),s:Number(_e),v:Number(tt),a:Number(rt)});return b(it)},"hsv"]]},N=function(et,_){for(var _e=0;_e<_.length;_e++){var tt=_[_e][0](et);if(tt)return[tt,_[_e][1]]}return[null,void 0]},x=function(et){return typeof et=="string"?N(et.trim(),y.string):typeof et=="object"&&et!==null?N(et,y.object):[null,void 0]},M=function(et,_){var _e=c(et);return{h:_e.h,s:e(_e.s+100*_,0,100),l:_e.l,a:_e.a}},H=function(et){return(299*et.r+587*et.g+114*et.b)/1e3/255},$=function(et,_){var _e=c(et);return{h:_e.h,s:_e.s,l:e(_e.l+100*_,0,100),a:_e.a}},j=function(){function et(_){this.parsed=x(_)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return et.prototype.isValid=function(){return this.parsed!==null},et.prototype.brightness=function(){return n(H(this.rgba),2)},et.prototype.isDark=function(){return H(this.rgba)<.5},et.prototype.isLight=function(){return H(this.rgba)>=.5},et.prototype.toHex=function(){return _=o(this.rgba),_e=_.r,tt=_.g,nt=_.b,it=(rt=_.a)<1?s(n(255*rt)):"","#"+s(_e)+s(tt)+s(nt)+it;var _,_e,tt,nt,rt,it},et.prototype.toRgb=function(){return o(this.rgba)},et.prototype.toRgbString=function(){return _=o(this.rgba),_e=_.r,tt=_.g,nt=_.b,(rt=_.a)<1?"rgba("+_e+", "+tt+", "+nt+", "+rt+")":"rgb("+_e+", "+tt+", "+nt+")";var _,_e,tt,nt,rt},et.prototype.toHsl=function(){return d(c(this.rgba))},et.prototype.toHslString=function(){return _=d(c(this.rgba)),_e=_.h,tt=_.s,nt=_.l,(rt=_.a)<1?"hsla("+_e+", "+tt+"%, "+nt+"%, "+rt+")":"hsl("+_e+", "+tt+"%, "+nt+"%)";var _,_e,tt,nt,rt},et.prototype.toHsv=function(){return _=h(this.rgba),{h:n(_.h),s:n(_.s),v:n(_.v),a:n(_.a,3)};var _},et.prototype.invert=function(){return w({r:255-(_=this.rgba).r,g:255-_.g,b:255-_.b,a:_.a});var _},et.prototype.saturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,_))},et.prototype.desaturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,-_))},et.prototype.grayscale=function(){return w(M(this.rgba,-1))},et.prototype.lighten=function(_){return _===void 0&&(_=.1),w($(this.rgba,_))},et.prototype.darken=function(_){return _===void 0&&(_=.1),w($(this.rgba,-_))},et.prototype.rotate=function(_){return _===void 0&&(_=15),this.hue(this.hue()+_)},et.prototype.alpha=function(_){return typeof _=="number"?w({r:(_e=this.rgba).r,g:_e.g,b:_e.b,a:_}):n(this.rgba.a,3);var _e},et.prototype.hue=function(_){var _e=c(this.rgba);return typeof _=="number"?w({h:_,s:_e.s,l:_e.l,a:_e.a}):n(_e.h)},et.prototype.isEqual=function(_){return this.toHex()===w(_).toHex()},et}(),w=function(et){return et instanceof j?et:new j(et)},S=[],k=function(et){et.forEach(function(_){S.indexOf(_)<0&&(_(j,y),S.push(_))})};function namesPlugin(et,_){var _e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},tt={};for(var nt in _e)tt[_e[nt]]=nt;var rt={};et.prototype.toName=function(it){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var st,ot,at=tt[this.toHex()];if(at)return at;if(it!=null&&it.closest){var lt=this.toRgb(),ct=1/0,ht="black";if(!rt.length)for(var ut in _e)rt[ut]=new et(_e[ut]).toRgb();for(var ft in _e){var dt=(st=lt,ot=rt[ft],Math.pow(st.r-ot.r,2)+Math.pow(st.g-ot.g,2)+Math.pow(st.b-ot.b,2));dt<ct&&(ct=dt,ht=ft)}return ht}},_.string.push([function(it){var st=it.toLowerCase(),ot=st==="transparent"?"#0000":_e[st];return ot?new et(ot).toRgb():null},"name"])}k([namesPlugin]);const _Color=class Vl{constructor(_=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=_}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(_){return this.value=_,this}set value(_){if(_ instanceof Vl)this._value=this._cloneSource(_._value),this._int=_._int,this._components.set(_._components);else{if(_===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,_))&&(this._normalize(_),this._value=this._cloneSource(_))}}get value(){return this._value}_cloneSource(_){return typeof _=="string"||typeof _=="number"||_ instanceof Number||_===null?_:Array.isArray(_)||ArrayBuffer.isView(_)?_.slice(0):typeof _=="object"&&_!==null?{..._}:_}_isSourceEqual(_,_e){const tt=typeof _;if(tt!==typeof _e)return!1;if(tt==="number"||tt==="string"||_ instanceof Number)return _===_e;if(Array.isArray(_)&&Array.isArray(_e)||ArrayBuffer.isView(_)&&ArrayBuffer.isView(_e))return _.length!==_e.length?!1:_.every((rt,it)=>rt===_e[it]);if(_!==null&&_e!==null){const rt=Object.keys(_),it=Object.keys(_e);return rt.length!==it.length?!1:rt.every(st=>_[st]===_e[st])}return _===_e}toRgba(){const[_,_e,tt,nt]=this._components;return{r:_,g:_e,b:tt,a:nt}}toRgb(){const[_,_e,tt]=this._components;return{r:_,g:_e,b:tt}}toRgbaString(){const[_,_e,tt]=this.toUint8RgbArray();return`rgba(${_},${_e},${tt},${this.alpha})`}toUint8RgbArray(_){const[_e,tt,nt]=this._components;return this._arrayRgb||(this._arrayRgb=[]),_=_||this._arrayRgb,_[0]=Math.round(_e*255),_[1]=Math.round(tt*255),_[2]=Math.round(nt*255),_}toArray(_){this._arrayRgba||(this._arrayRgba=[]),_=_||this._arrayRgba;const[_e,tt,nt,rt]=this._components;return _[0]=_e,_[1]=tt,_[2]=nt,_[3]=rt,_}toRgbArray(_){this._arrayRgb||(this._arrayRgb=[]),_=_||this._arrayRgb;const[_e,tt,nt]=this._components;return _[0]=_e,_[1]=tt,_[2]=nt,_}toNumber(){return this._int}toBgrNumber(){const[_,_e,tt]=this.toUint8RgbArray();return(tt<<16)+(_e<<8)+_}toLittleEndianNumber(){const _=this._int;return(_>>16)+(_&65280)+((_&255)<<16)}multiply(_){const[_e,tt,nt,rt]=Vl._temp.setValue(_)._components;return this._components[0]*=_e,this._components[1]*=tt,this._components[2]*=nt,this._components[3]*=rt,this._refreshInt(),this._value=null,this}premultiply(_,_e=!0){return _e&&(this._components[0]*=_,this._components[1]*=_,this._components[2]*=_),this._components[3]=_,this._refreshInt(),this._value=null,this}toPremultiplied(_,_e=!0){if(_===1)return(255<<24)+this._int;if(_===0)return _e?0:this._int;let tt=this._int>>16&255,nt=this._int>>8&255,rt=this._int&255;return _e&&(tt=tt*_+.5|0,nt=nt*_+.5|0,rt=rt*_+.5|0),(_*255<<24)+(tt<<16)+(nt<<8)+rt}toHex(){const _=this._int.toString(16);return`#${"000000".substring(0,6-_.length)+_}`}toHexa(){const _e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-_e.length)+_e}setAlpha(_){return this._components[3]=this._clamp(_),this}_normalize(_){let _e,tt,nt,rt;if((typeof _=="number"||_ instanceof Number)&&_>=0&&_<=16777215){const it=_;_e=(it>>16&255)/255,tt=(it>>8&255)/255,nt=(it&255)/255,rt=1}else if((Array.isArray(_)||_ instanceof Float32Array)&&_.length>=3&&_.length<=4)_=this._clamp(_),[_e,tt,nt,rt=1]=_;else if((_ instanceof Uint8Array||_ instanceof Uint8ClampedArray)&&_.length>=3&&_.length<=4)_=this._clamp(_,0,255),[_e,tt,nt,rt=255]=_,_e/=255,tt/=255,nt/=255,rt/=255;else if(typeof _=="string"||typeof _=="object"){if(typeof _=="string"){const st=Vl.HEX_PATTERN.exec(_);st&&(_=`#${st[2]}`)}const it=w(_);it.isValid()&&({r:_e,g:tt,b:nt,a:rt}=it.rgba,_e/=255,tt/=255,nt/=255)}if(_e!==void 0)this._components[0]=_e,this._components[1]=tt,this._components[2]=nt,this._components[3]=rt,this._refreshInt();else throw new Error(`Unable to convert color ${_}`)}_refreshInt(){this._clamp(this._components);const[_,_e,tt]=this._components;this._int=(_*255<<16)+(_e*255<<8)+(tt*255|0)}_clamp(_,_e=0,tt=1){return typeof _=="number"?Math.min(Math.max(_,_e),tt):(_.forEach((nt,rt)=>{_[rt]=Math.min(Math.max(nt,_e),tt)}),_)}static isColorLike(_){return typeof _=="number"||typeof _=="string"||_ instanceof Number||_ instanceof Vl||Array.isArray(_)||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Float32Array||_.r!==void 0&&_.g!==void 0&&_.b!==void 0||_.r!==void 0&&_.g!==void 0&&_.b!==void 0&&_.a!==void 0||_.h!==void 0&&_.s!==void 0&&_.l!==void 0||_.h!==void 0&&_.s!==void 0&&_.l!==void 0&&_.a!==void 0||_.h!==void 0&&_.s!==void 0&&_.v!==void 0||_.h!==void 0&&_.s!==void 0&&_.v!==void 0&&_.a!==void 0}};_Color.shared=new _Color;_Color._temp=new _Color;_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Color=_Color;const cullingMixin={cullArea:null,cullable:!1,cullableChildren:!0};class Pool{constructor(_,_e){this._pool=[],this._count=0,this._index=0,this._classType=_,_e&&this.prepopulate(_e)}prepopulate(_){for(let _e=0;_e<_;_e++)this._pool[this._index++]=new this._classType;this._count+=_}get(_){var tt;let _e;return this._index>0?_e=this._pool[--this._index]:_e=new this._classType,(tt=_e.init)==null||tt.call(_e,_),_e}return(_){var _e;(_e=_.reset)==null||_e.call(_),this._pool[this._index++]=_}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class PoolGroupClass{constructor(){this._poolsByClass=new Map}prepopulate(_,_e){this.getPool(_).prepopulate(_e)}get(_,_e){return this.getPool(_).get(_e)}return(_){this.getPool(_.constructor).return(_)}getPool(_){return this._poolsByClass.has(_)||this._poolsByClass.set(_,new Pool(_)),this._poolsByClass.get(_)}stats(){const _={};return this._poolsByClass.forEach(_e=>{const tt=_[_e._classType.name]?_e._classType.name+_e._classType.ID:_e._classType.name;_[tt]={free:_e.totalFree,used:_e.totalUsed,size:_e.totalSize}}),_}}const BigPool=new PoolGroupClass;function removeItems(et,_,_e){const tt=et.length;let nt;if(_>=tt||_e===0)return;_e=_+_e>tt?tt-_:_e;const rt=tt-_e;for(nt=_;nt<rt;++nt)et[nt]=et[nt+_e];et.length=rt}const childrenHelperMixin={allowChildren:!0,removeChildren(et=0,_){const _e=_??this.children.length,tt=_e-et,nt=[];if(tt>0&&tt<=_e){for(let it=_e-1;it>=et;it--){const st=this.children[it];st&&(nt.push(st),st.parent=null)}removeItems(this.children,et,_e);const rt=this.renderGroup||this.parentRenderGroup;rt&&rt.removeChildren(nt);for(let it=0;it<nt.length;++it)this.emit("childRemoved",nt[it],this,it),nt[it].emit("removed",this);return nt}else if(tt===0&&this.children.length===0)return nt;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(et){const _=this.getChildAt(et);return this.removeChild(_)},getChildAt(et){if(et<0||et>=this.children.length)throw new Error(`getChildAt: Index (${et}) does not exist.`);return this.children[et]},setChildIndex(et,_){if(_<0||_>=this.children.length)throw new Error(`The index ${_} supplied is out of bounds ${this.children.length}`);this.getChildIndex(et),this.addChildAt(et,_)},getChildIndex(et){const _=this.children.indexOf(et);if(_===-1)throw new Error("The supplied Container must be a child of the caller");return _},addChildAt(et,_){this.allowChildren||deprecation(v8_0_0,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:_e}=this;if(_<0||_>_e.length)throw new Error(`${et}addChildAt: The index ${_} supplied is out of bounds ${_e.length}`);if(et.parent){const nt=et.parent.children.indexOf(et);if(et.parent===this&&nt===_)return et;nt!==-1&&et.parent.children.splice(nt,1)}_===_e.length?_e.push(et):_e.splice(_,0,et),et.parent=this,et.didChange=!0,et.didViewUpdate=!1,et._updateFlags=15;const tt=this.renderGroup||this.parentRenderGroup;return tt&&tt.addChild(et),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",et,this,_),et.emit("added",this),et},swapChildren(et,_){if(et===_)return;const _e=this.getChildIndex(et),tt=this.getChildIndex(_);this.children[_e]=_,this.children[tt]=et;const nt=this.renderGroup||this.parentRenderGroup;nt&&(nt.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var et;(et=this.parent)==null||et.removeChild(this)},reparentChild(...et){return et.length===1?this.reparentChildAt(et[0],this.children.length):(et.forEach(_=>this.reparentChildAt(_,this.children.length)),et[0])},reparentChildAt(et,_){if(et.parent===this)return this.setChildIndex(et,_),et;const _e=et.worldTransform.clone();et.removeFromParent(),this.addChildAt(et,_);const tt=this.worldTransform.clone();return tt.invert(),_e.prepend(tt),et.setFromMatrix(_e),et}};class FilterEffect{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let _=0;_<this.filters.length;_++)this.filters[_].destroy();this.filters=null,this.filterArea=null}}class MaskEffectManagerClass{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(_=>{this.add({test:_.test,maskClass:_})}))}add(_){this._tests.push(_)}getMaskEffect(_){this._initialized||this.init();for(let _e=0;_e<this._tests.length;_e++){const tt=this._tests[_e];if(tt.test(_))return BigPool.get(tt.maskClass,_)}return _}returnMaskEffect(_){BigPool.return(_)}}const MaskEffectManager=new MaskEffectManagerClass;extensions.handleByList(ExtensionType.MaskEffect,MaskEffectManager._effectClasses);const effectsMixin={_maskEffect:null,_filterEffect:null,effects:[],addEffect(et){if(this.effects.indexOf(et)!==-1)return;this.effects.push(et),this.effects.sort((tt,nt)=>tt.priority-nt.priority);const _e=this.renderGroup||this.parentRenderGroup;_e&&(_e.structureDidChange=!0),this._updateIsSimple()},removeEffect(et){const _=this.effects.indexOf(et);_!==-1&&(this.effects.splice(_,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(et){const _=this._maskEffect;(_==null?void 0:_.mask)!==et&&(_&&(this.removeEffect(_),MaskEffectManager.returnMaskEffect(_),this._maskEffect=null),et!=null&&(this._maskEffect=MaskEffectManager.getMaskEffect(et),this.addEffect(this._maskEffect)))},get mask(){var et;return(et=this._maskEffect)==null?void 0:et.mask},set filters(et){var rt;!Array.isArray(et)&&et&&(et=[et]);const _=this._filterEffect||(this._filterEffect=new FilterEffect);et=et;const _e=(et==null?void 0:et.length)>0,tt=((rt=_.filters)==null?void 0:rt.length)>0,nt=_e!==tt;et=Array.isArray(et)?et.slice(0):et,_.filters=Object.freeze(et),nt&&(_e?this.addEffect(_):(this.removeEffect(_),_.filters=et??null))},get filters(){var et;return(et=this._filterEffect)==null?void 0:et.filters},set filterArea(et){this._filterEffect||(this._filterEffect=new FilterEffect),this._filterEffect.filterArea=et},get filterArea(){var et;return(et=this._filterEffect)==null?void 0:et.filterArea}},findMixin={label:null,get name(){return deprecation(v8_0_0,"Container.name property has been removed, use Container.label instead"),this.label},set name(et){deprecation(v8_0_0,"Container.name property has been removed, use Container.label instead"),this.label=et},getChildByName(et,_=!1){return this.getChildByLabel(et,_)},getChildByLabel(et,_=!1){const _e=this.children;for(let tt=0;tt<_e.length;tt++){const nt=_e[tt];if(nt.label===et||et instanceof RegExp&&et.test(nt.label))return nt}if(_)for(let tt=0;tt<_e.length;tt++){const rt=_e[tt].getChildByLabel(et,!0);if(rt)return rt}return null},getChildrenByLabel(et,_=!1,_e=[]){const tt=this.children;for(let nt=0;nt<tt.length;nt++){const rt=tt[nt];(rt.label===et||et instanceof RegExp&&et.test(rt.label))&&_e.push(rt)}if(_)for(let nt=0;nt<tt.length;nt++)tt[nt].getChildrenByLabel(et,!0,_e);return _e}},matrixPool=new Pool(Matrix$4),boundsPool=new Pool(Bounds);function getGlobalBounds(et,_,_e){_e.clear();let tt,nt;return et.parent?_?tt=et.parent.worldTransform:(nt=matrixPool.get().identity(),tt=updateTransformBackwards(et,nt)):tt=Matrix$4.IDENTITY,_getGlobalBounds(et,_e,tt,_),nt&&matrixPool.return(nt),_e.isValid||_e.set(0,0,0,0),_e}function _getGlobalBounds(et,_,_e,tt){var st,ot;if(!et.visible||!et.measurable)return;let nt;tt?nt=et.worldTransform:(et.updateLocalTransform(),nt=matrixPool.get(),nt.appendFrom(et.localTransform,_e));const rt=_,it=!!et.effects.length;if(it&&(_=boundsPool.get().clear()),et.boundsArea)_.addRect(et.boundsArea,nt);else{et.addBounds&&(_.matrix=nt,et.addBounds(_));for(let at=0;at<et.children.length;at++)_getGlobalBounds(et.children[at],_,nt,tt)}if(it){for(let at=0;at<et.effects.length;at++)(ot=(st=et.effects[at]).addBounds)==null||ot.call(st,_);rt.addBounds(_,Matrix$4.IDENTITY),boundsPool.return(_)}tt||matrixPool.return(nt)}function updateTransformBackwards(et,_){const _e=et.parent;return _e&&(updateTransformBackwards(_e,_),_e.updateLocalTransform(),_.append(_e.localTransform)),_}let warnCount=0;const maxWarnings=500;function warn(...et){warnCount!==maxWarnings&&(warnCount++,warnCount===maxWarnings?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...et))}function getLocalBounds(et,_,_e){return _.clear(),_e||(_e=Matrix$4.IDENTITY),_getLocalBounds(et,_,_e,et,!0),_.isValid||_.set(0,0,0,0),_}function _getLocalBounds(et,_,_e,tt,nt){var ot,at;let rt;if(nt)rt=matrixPool.get(),rt=_e.copyTo(rt);else{if(!et.visible||!et.measurable)return;et.updateLocalTransform();const lt=et.localTransform;rt=matrixPool.get(),rt.appendFrom(lt,_e)}const it=_,st=!!et.effects.length;if(st&&(_=boundsPool.get().clear()),et.boundsArea)_.addRect(et.boundsArea,rt);else{et.renderPipeId&&(_.matrix=rt,et.addBounds(_));const lt=et.children;for(let ct=0;ct<lt.length;ct++)_getLocalBounds(lt[ct],_,rt,tt,!1)}if(st){for(let lt=0;lt<et.effects.length;lt++)(at=(ot=et.effects[lt]).addLocalBounds)==null||at.call(ot,_,tt);it.addBounds(_,Matrix$4.IDENTITY),boundsPool.return(_)}matrixPool.return(rt)}function checkChildrenDidChange(et,_){const _e=et.children;for(let tt=0;tt<_e.length;tt++){const nt=_e[tt],rt=nt.uid,it=(nt._didViewChangeTick&65535)<<16|nt._didContainerChangeTick&65535,st=_.index;(_.data[st]!==rt||_.data[st+1]!==it)&&(_.data[_.index]=rt,_.data[_.index+1]=it,_.didChange=!0),_.index=st+2,nt.children.length&&checkChildrenDidChange(nt,_)}return _.didChange}const tempMatrix$1=new Matrix$4,measureMixin={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(et,_){const _e=Math.sign(this.scale.x)||1;_!==0?this.scale.x=et/_*_e:this.scale.x=_e},_setHeight(et,_){const _e=Math.sign(this.scale.y)||1;_!==0?this.scale.y=et/_*_e:this.scale.y=_e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Bounds});const et=this._localBoundsCacheData;return et.index=1,et.didChange=!1,et.data[0]!==this._didViewChangeTick&&(et.didChange=!0,et.data[0]=this._didViewChangeTick),checkChildrenDidChange(this,et),et.didChange&&getLocalBounds(this,et.localBounds,tempMatrix$1),et.localBounds},getBounds(et,_){return getGlobalBounds(this,et,_||new Bounds)}},onRenderMixin={_onRender:null,set onRender(et){const _=this.renderGroup||this.parentRenderGroup;if(!et){this._onRender&&(_==null||_.removeOnRender(this)),this._onRender=null;return}this._onRender||_==null||_.addOnRender(this),this._onRender=et},get onRender(){return this._onRender}},sortMixin={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(et){this._zIndex!==et&&(this._zIndex=et,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(sortChildren))}};function sortChildren(et,_){return et._zIndex-_._zIndex}const toLocalGlobalMixin={getGlobalPosition(et=new Point,_=!1){return this.parent?this.parent.toGlobal(this._position,et,_):(et.x=this._position.x,et.y=this._position.y),et},toGlobal(et,_,_e=!1){if(!_e){this.updateLocalTransform();const tt=updateTransformBackwards(this,new Matrix$4);return tt.append(this.localTransform),tt.apply(et,_)}return this.worldTransform.apply(et,_)},toLocal(et,_,_e,tt){if(_&&(et=_.toGlobal(et,_e,tt)),!tt){this.updateLocalTransform();const nt=updateTransformBackwards(this,new Matrix$4);return nt.append(this.localTransform),nt.applyInverse(et,_e)}return this.worldTransform.applyInverse(et,_e)}};let _tick=0;class InstructionSet{constructor(){this.uid=uid("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=_tick++}add(_){this.instructions[this.instructionSize++]=_}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class RenderGroup{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Matrix$4,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new InstructionSet,this._onRenderContainers=[]}init(_){this.root=_,_._onRender&&this.addOnRender(_),_.didChange=!0;const _e=_.children;for(let tt=0;tt<_e.length;tt++)this.addChild(_e[tt])}reset(){this.renderGroupChildren.length=0;for(const _ in this.childrenToUpdate){const _e=this.childrenToUpdate[_];_e.list.fill(null),_e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(_){_.renderGroupParent&&_.renderGroupParent._removeRenderGroupChild(_),_.renderGroupParent=this,this.renderGroupChildren.push(_)}_removeRenderGroupChild(_){const _e=this.renderGroupChildren.indexOf(_);_e>-1&&this.renderGroupChildren.splice(_e,1),_.renderGroupParent=null}addChild(_){if(this.structureDidChange=!0,_.parentRenderGroup=this,_.updateTick=-1,_.parent===this.root?_.relativeRenderGroupDepth=1:_.relativeRenderGroupDepth=_.parent.relativeRenderGroupDepth+1,_.didChange=!0,this.onChildUpdate(_),_.renderGroup){this.addRenderGroupChild(_.renderGroup);return}_._onRender&&this.addOnRender(_);const _e=_.children;for(let tt=0;tt<_e.length;tt++)this.addChild(_e[tt])}removeChild(_){if(this.structureDidChange=!0,_._onRender&&(_.renderGroup||this.removeOnRender(_)),_.parentRenderGroup=null,_.renderGroup){this._removeRenderGroupChild(_.renderGroup);return}const _e=_.children;for(let tt=0;tt<_e.length;tt++)this.removeChild(_e[tt])}removeChildren(_){for(let _e=0;_e<_.length;_e++)this.removeChild(_[_e])}onChildUpdate(_){let _e=this.childrenToUpdate[_.relativeRenderGroupDepth];_e||(_e=this.childrenToUpdate[_.relativeRenderGroupDepth]={index:0,list:[]}),_e.list[_e.index++]=_}updateRenderable(_){_.globalDisplayStatus<7||(_.didViewUpdate=!1,this.instructionSet.renderPipes[_.renderPipeId].updateRenderable(_))}onChildViewUpdate(_){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=_}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(_){this._onRenderContainers.push(_)}removeOnRender(_){this._onRenderContainers.splice(this._onRenderContainers.indexOf(_),1)}runOnRender(){for(let _=0;_<this._onRenderContainers.length;_++)this._onRenderContainers[_]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(_=[]){const _e=this.root.children;for(let tt=0;tt<_e.length;tt++)this._getChildren(_e[tt],_);return _}_getChildren(_,_e=[]){if(_e.push(_),_.renderGroup)return _e;const tt=_.children;for(let nt=0;nt<tt.length;nt++)this._getChildren(tt[nt],_e);return _e}}function assignWithIgnore(et,_,_e={}){for(const tt in _)!_e[tt]&&_[tt]!==void 0&&(et[tt]=_[tt])}const defaultSkew=new ObservablePoint(null),defaultPivot=new ObservablePoint(null),defaultScale=new ObservablePoint(null,1,1),UPDATE_COLOR=1,UPDATE_BLEND=2,UPDATE_VISIBLE=4;class Container extends EventEmitter{constructor(_={}){var _e,tt;super(),this.uid=uid("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new Matrix$4,this.relativeGroupTransform=new Matrix$4,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ObservablePoint(this,0,0),this._scale=defaultScale,this._pivot=defaultPivot,this._skew=defaultSkew,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],assignWithIgnore(this,_,{children:!0,parent:!0,effects:!0}),(_e=_.children)==null||_e.forEach(nt=>this.addChild(nt)),(tt=_.parent)==null||tt.addChild(this)}static mixin(_){Object.defineProperties(Container.prototype,Object.getOwnPropertyDescriptors(_))}set _didChangeId(_){this._didViewChangeTick=_>>12&4095,this._didContainerChangeTick=_&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(..._){if(this.allowChildren||deprecation(v8_0_0,"addChild: Only Containers will be allowed to add children in v8.0.0"),_.length>1){for(let nt=0;nt<_.length;nt++)this.addChild(_[nt]);return _[0]}const _e=_[0];if(_e.parent===this)return this.children.splice(this.children.indexOf(_e),1),this.children.push(_e),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),_e;_e.parent&&_e.parent.removeChild(_e),this.children.push(_e),this.sortableChildren&&(this.sortDirty=!0),_e.parent=this,_e.didChange=!0,_e.didViewUpdate=!1,_e._updateFlags=15;const tt=this.renderGroup||this.parentRenderGroup;return tt&&tt.addChild(_e),this.emit("childAdded",_e,this,this.children.length-1),_e.emit("added",this),this._didViewChangeTick++,_e._zIndex!==0&&_e.depthOfChildModified(),_e}removeChild(..._){if(_.length>1){for(let nt=0;nt<_.length;nt++)this.removeChild(_[nt]);return _[0]}const _e=_[0],tt=this.children.indexOf(_e);return tt>-1&&(this._didViewChangeTick++,this.children.splice(tt,1),this.renderGroup?this.renderGroup.removeChild(_e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(_e),_e.parent=null,this.emit("childRemoved",_e,this,tt),_e.emit("removed",this)),_e}_onUpdate(_){_&&_===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(_){!!this.renderGroup!==_&&(_?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const _=this.parentRenderGroup;_==null||_.removeChild(this),this.renderGroup=BigPool.get(RenderGroup,this),this.groupTransform=Matrix$4.IDENTITY,_==null||_.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const _=this.parentRenderGroup;_==null||_.removeChild(this),BigPool.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,_==null||_.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Matrix$4),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(_){this._position.x=_}get y(){return this._position.y}set y(_){this._position.y=_}get position(){return this._position}set position(_){this._position.copyFrom(_)}get rotation(){return this._rotation}set rotation(_){this._rotation!==_&&(this._rotation=_,this._onUpdate(this._skew))}get angle(){return this.rotation*RAD_TO_DEG}set angle(_){this.rotation=_*DEG_TO_RAD}get pivot(){return this._pivot===defaultPivot&&(this._pivot=new ObservablePoint(this,0,0)),this._pivot}set pivot(_){this._pivot===defaultPivot&&(this._pivot=new ObservablePoint(this,0,0)),typeof _=="number"?this._pivot.set(_):this._pivot.copyFrom(_)}get skew(){return this._skew===defaultSkew&&(this._skew=new ObservablePoint(this,0,0)),this._skew}set skew(_){this._skew===defaultSkew&&(this._skew=new ObservablePoint(this,0,0)),this._skew.copyFrom(_)}get scale(){return this._scale===defaultScale&&(this._scale=new ObservablePoint(this,1,1)),this._scale}set scale(_){this._scale===defaultScale&&(this._scale=new ObservablePoint(this,0,0)),typeof _=="number"?this._scale.set(_):this._scale.copyFrom(_)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(_){const _e=this.getLocalBounds().width;this._setWidth(_,_e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(_){const _e=this.getLocalBounds().height;this._setHeight(_,_e)}getSize(_){_||(_={});const _e=this.getLocalBounds();return _.width=Math.abs(this.scale.x*_e.width),_.height=Math.abs(this.scale.y*_e.height),_}setSize(_,_e){const tt=this.getLocalBounds();let nt,rt;typeof _!="object"?(nt=_,rt=_e??_):(nt=_.width,rt=_.height??_.width),nt!==void 0&&this._setWidth(nt,tt.width),rt!==void 0&&this._setHeight(rt,tt.height)}_updateSkew(){const _=this._rotation,_e=this._skew;this._cx=Math.cos(_+_e._y),this._sx=Math.sin(_+_e._y),this._cy=-Math.sin(_-_e._x),this._sy=Math.cos(_-_e._x)}updateTransform(_){return this.position.set(typeof _.x=="number"?_.x:this.position.x,typeof _.y=="number"?_.y:this.position.y),this.scale.set(typeof _.scaleX=="number"?_.scaleX||1:this.scale.x,typeof _.scaleY=="number"?_.scaleY||1:this.scale.y),this.rotation=typeof _.rotation=="number"?_.rotation:this.rotation,this.skew.set(typeof _.skewX=="number"?_.skewX:this.skew.x,typeof _.skewY=="number"?_.skewY:this.skew.y),this.pivot.set(typeof _.pivotX=="number"?_.pivotX:this.pivot.x,typeof _.pivotY=="number"?_.pivotY:this.pivot.y),this}setFromMatrix(_){_.decompose(this)}updateLocalTransform(){const _=this._didContainerChangeTick;if(this._didLocalTransformChangeId===_)return;this._didLocalTransformChangeId=_;const _e=this.localTransform,tt=this._scale,nt=this._pivot,rt=this._position,it=tt._x,st=tt._y,ot=nt._x,at=nt._y;_e.a=this._cx*it,_e.b=this._sx*it,_e.c=this._cy*st,_e.d=this._sy*st,_e.tx=rt._x-(ot*_e.a+at*_e.c),_e.ty=rt._y-(ot*_e.b+at*_e.d)}set alpha(_){_!==this.localAlpha&&(this.localAlpha=_,this._updateFlags|=UPDATE_COLOR,this._onUpdate())}get alpha(){return this.localAlpha}set tint(_){const tt=Color.shared.setValue(_??16777215).toBgrNumber();tt!==this.localColor&&(this.localColor=tt,this._updateFlags|=UPDATE_COLOR,this._onUpdate())}get tint(){const _=this.localColor;return((_&255)<<16)+(_&65280)+(_>>16&255)}set blendMode(_){this.localBlendMode!==_&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=UPDATE_BLEND,this.localBlendMode=_,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(_){const _e=_?2:0;(this.localDisplayStatus&2)!==_e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=UPDATE_VISIBLE,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(_){const _e=_?0:4;(this.localDisplayStatus&4)!==_e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=UPDATE_VISIBLE,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(_){const _e=_?1:0;(this.localDisplayStatus&1)!==_e&&(this._updateFlags|=UPDATE_VISIBLE,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(_=!1){var nt;if(this.destroyed)return;this.destroyed=!0;const _e=this.removeChildren(0,this.children.length);if(this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),typeof _=="boolean"?_:_==null?void 0:_.children)for(let rt=0;rt<_e.length;++rt)_e[rt].destroy(_);(nt=this.renderGroup)==null||nt.destroy(),this.renderGroup=null}}Container.mixin(childrenHelperMixin);Container.mixin(toLocalGlobalMixin);Container.mixin(onRenderMixin);Container.mixin(measureMixin);Container.mixin(effectsMixin);Container.mixin(findMixin);Container.mixin(sortMixin);Container.mixin(cullingMixin);class ViewContainer extends Container{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new Bounds(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(_){this._roundPixels=_?1:0}containsPoint(_){const _e=this.bounds,{x:tt,y:nt}=_;return tt>=_e.minX&&tt<=_e.maxX&&nt>=_e.minY&&nt<=_e.maxY}destroy(_){super.destroy(_),this._bounds=null}}class Sprite extends ViewContainer{constructor(_=Texture.EMPTY){_ instanceof Texture&&(_={texture:_});const{texture:_e=Texture.EMPTY,anchor:tt,roundPixels:nt,width:rt,height:it,...st}=_;super({label:"Sprite",...st}),this.renderPipeId="sprite",this.batched=!0,this._didSpriteUpdate=!1,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),tt?this.anchor=tt:_e.defaultAnchor&&(this.anchor=_e.defaultAnchor),this.texture=_e,this.allowChildren=!1,this.roundPixels=nt??!1,rt!==void 0&&(this.width=rt),it!==void 0&&(this.height=it)}static from(_,_e=!1){return _ instanceof Texture?new Sprite(_):new Sprite(Texture.from(_,_e))}set texture(_){_||(_=Texture.EMPTY);const _e=this._texture;_e!==_&&(_e&&_e.dynamic&&_e.off("update",this.onViewUpdate,this),_.dynamic&&_.on("update",this.onViewUpdate,this),this._texture=_,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(_){const _e=this.sourceBounds;return _.x>=_e.maxX&&_.x<=_e.minX&&_.y>=_e.maxY&&_.y<=_e.minY}addBounds(_){const _e=this._texture.trim?this.sourceBounds:this.bounds;_.addFrame(_e.minX,_e.minY,_e.maxX,_e.maxY)}onViewUpdate(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const _=this.renderGroup||this.parentRenderGroup;_&&_.onChildViewUpdate(this)}_updateBounds(){updateQuadBounds(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const _=this._anchor,_e=this._texture,tt=this._sourceBounds,{width:nt,height:rt}=_e.orig;tt.maxX=-_._x*nt,tt.minX=tt.maxX+nt,tt.maxY=-_._y*rt,tt.minY=tt.maxY+rt}destroy(_=!1){if(super.destroy(_),typeof _=="boolean"?_:_==null?void 0:_.texture){const tt=typeof _=="boolean"?_:_==null?void 0:_.textureSource;this._texture.destroy(tt)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(_){typeof _=="number"?this._anchor.set(_):this._anchor.copyFrom(_)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(_){this._setWidth(_,this._texture.orig.width),this._width=_}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(_){this._setHeight(_,this._texture.orig.height),this._height=_}getSize(_){return _||(_={}),_.width=Math.abs(this.scale.x)*this._texture.orig.width,_.height=Math.abs(this.scale.y)*this._texture.orig.height,_}setSize(_,_e){let tt,nt;typeof _!="object"?(tt=_,nt=_e??_):(tt=_.width,nt=_.height??_.width),tt!==void 0&&this._setWidth(tt,this._texture.orig.width),nt!==void 0&&this._setHeight(nt,this._texture.orig.height)}}const tempBounds=new Bounds;function addMaskBounds(et,_,_e){const tt=tempBounds;et.measurable=!0,getGlobalBounds(et,_e,tt),_.addBoundsMask(tt),et.measurable=!1}function addMaskLocalBounds(et,_,_e){const tt=boundsPool.get();et.measurable=!0;const nt=matrixPool.get().identity(),rt=getMatrixRelativeToParent(et,_e,nt);getLocalBounds(et,tt,rt),et.measurable=!1,_.addBoundsMask(tt),matrixPool.return(nt),boundsPool.return(tt)}function getMatrixRelativeToParent(et,_,_e){return et?(et!==_&&(getMatrixRelativeToParent(et.parent,_,_e),et.updateLocalTransform(),_e.append(et.localTransform)),_e):(warn("Mask bounds, renderable is not inside the root container"),_e)}class AlphaMask{constructor(_){this.priority=0,this.pipe="alphaMask",_!=null&&_.mask&&this.init(_.mask)}init(_){this.mask=_,this.renderMaskToTexture=!(_ instanceof Sprite),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(_,_e){addMaskBounds(this.mask,_,_e)}addLocalBounds(_,_e){addMaskLocalBounds(this.mask,_,_e)}containsPoint(_,_e){const tt=this.mask;return _e(tt,_)}destroy(){this.reset()}static test(_){return _ instanceof Sprite}}AlphaMask.extension=ExtensionType.MaskEffect;class ColorMask{constructor(_){this.priority=0,this.pipe="colorMask",_!=null&&_.mask&&this.init(_.mask)}init(_){this.mask=_}destroy(){}static test(_){return typeof _=="number"}}ColorMask.extension=ExtensionType.MaskEffect;class StencilMask{constructor(_){this.priority=0,this.pipe="stencilMask",_!=null&&_.mask&&this.init(_.mask)}init(_){this.mask=_,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(_,_e){addMaskBounds(this.mask,_,_e)}addLocalBounds(_,_e){addMaskLocalBounds(this.mask,_,_e)}containsPoint(_,_e){const tt=this.mask;return _e(tt,_)}destroy(){this.reset()}static test(_){return _ instanceof Container}}StencilMask.extension=ExtensionType.MaskEffect;const BrowserAdapter={createCanvas:(et,_)=>{const _e=document.createElement("canvas");return _e.width=et,_e.height=_,_e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(et,_)=>fetch(et,_),parseXML:et=>new DOMParser().parseFromString(et,"text/xml")};let currentAdapter=BrowserAdapter;const DOMAdapter={get(){return currentAdapter},set(et){currentAdapter=et}};class CanvasSource extends TextureSource{constructor(_){_.resource||(_.resource=DOMAdapter.get().createCanvas()),_.width||(_.width=_.resource.width,_.autoDensity||(_.width/=_.resolution)),_.height||(_.height=_.resource.height,_.autoDensity||(_.height/=_.resolution)),super(_),this.uploadMethodId="image",this.autoDensity=_.autoDensity;const _e=_.resource;(this.pixelWidth!==_e.width||this.pixelWidth!==_e.height)&&this.resizeCanvas(),this.transparent=!!_.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(_=this.width,_e=this.height,tt=this._resolution){const nt=super.resize(_,_e,tt);return nt&&this.resizeCanvas(),nt}static test(_){return globalThis.HTMLCanvasElement&&_ instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&_ instanceof OffscreenCanvas}}CanvasSource.extension=ExtensionType.TextureSource;class ImageSource extends TextureSource{constructor(_){if(_.resource&&globalThis.HTMLImageElement&&_.resource instanceof HTMLImageElement){const _e=DOMAdapter.get().createCanvas(_.resource.width,_.resource.height);_e.getContext("2d").drawImage(_.resource,0,0,_.resource.width,_.resource.height),_.resource=_e,warn("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(_),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(_){return globalThis.HTMLImageElement&&_ instanceof HTMLImageElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap||globalThis.VideoFrame&&_ instanceof VideoFrame}}ImageSource.extension=ExtensionType.TextureSource;var UPDATE_PRIORITY=(et=>(et[et.INTERACTION=50]="INTERACTION",et[et.HIGH=25]="HIGH",et[et.NORMAL=0]="NORMAL",et[et.LOW=-25]="LOW",et[et.UTILITY=-50]="UTILITY",et))(UPDATE_PRIORITY||{});class TickerListener{constructor(_,_e=null,tt=0,nt=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=_,this._context=_e,this.priority=tt,this._once=nt}match(_,_e=null){return this._fn===_&&this._context===_e}emit(_){this._fn&&(this._context?this._fn.call(this._context,_):this._fn(_));const _e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),_e}connect(_){this.previous=_,_.next&&(_.next.previous=this),this.next=_.next,_.next=this}destroy(_=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const _e=this.next;return this.next=_?null:_e,this.previous=null,_e}}const _Ticker=class Ds{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/Ds.targetFPMS,this.elapsedMS=1/Ds.targetFPMS,this._tick=_=>{this._requestId=null,this.started&&(this.update(_),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(_,_e,tt=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(_,_e,tt))}addOnce(_,_e,tt=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(_,_e,tt,!0))}_addListener(_){let _e=this._head.next,tt=this._head;if(!_e)_.connect(tt);else{for(;_e;){if(_.priority>_e.priority){_.connect(tt);break}tt=_e,_e=_e.next}_.previous||_.connect(tt)}return this._startIfPossible(),this}remove(_,_e){let tt=this._head.next;for(;tt;)tt.match(_,_e)?tt=tt.destroy():tt=tt.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let _=0,_e=this._head;for(;_e=_e.next;)_++;return _}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let _=this._head.next;for(;_;)_=_.destroy(!0);this._head.destroy(),this._head=null}}update(_=performance.now()){let _e;if(_>this.lastTime){if(_e=this.elapsedMS=_-this.lastTime,_e>this._maxElapsedMS&&(_e=this._maxElapsedMS),_e*=this.speed,this._minElapsedMS){const rt=_-this._lastFrame|0;if(rt<this._minElapsedMS)return;this._lastFrame=_-rt%this._minElapsedMS}this.deltaMS=_e,this.deltaTime=this.deltaMS*Ds.targetFPMS;const tt=this._head;let nt=tt.next;for(;nt;)nt=nt.emit(this);tt.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=_}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(_){const _e=Math.min(this.maxFPS,_),tt=Math.min(Math.max(0,_e)/1e3,Ds.targetFPMS);this._maxElapsedMS=1/tt}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(_){if(_===0)this._minElapsedMS=0;else{const _e=Math.max(this.minFPS,_);this._minElapsedMS=1/(_e/1e3)}}static get shared(){if(!Ds._shared){const _=Ds._shared=new Ds;_.autoStart=!0,_._protected=!0}return Ds._shared}static get system(){if(!Ds._system){const _=Ds._system=new Ds;_.autoStart=!0,_._protected=!0}return Ds._system}};_Ticker.targetFPMS=.06;let Ticker=_Ticker,promise;async function detectVideoAlphaMode(){return promise??(promise=(async()=>{var it;const _=document.createElement("canvas").getContext("webgl");if(!_)return"premultiply-alpha-on-upload";const _e=await new Promise(st=>{const ot=document.createElement("video");ot.onloadeddata=()=>st(ot),ot.onerror=()=>st(null),ot.autoplay=!1,ot.crossOrigin="anonymous",ot.preload="auto",ot.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",ot.load()});if(!_e)return"premultiply-alpha-on-upload";const tt=_.createTexture();_.bindTexture(_.TEXTURE_2D,tt);const nt=_.createFramebuffer();_.bindFramebuffer(_.FRAMEBUFFER,nt),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,tt,0),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_COLORSPACE_CONVERSION_WEBGL,_.NONE),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,_e);const rt=new Uint8Array(4);return _.readPixels(0,0,1,1,_.RGBA,_.UNSIGNED_BYTE,rt),_.deleteFramebuffer(nt),_.deleteTexture(tt),(it=_.getExtension("WEBGL_lose_context"))==null||it.loseContext(),rt[0]<=rt[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),promise}const _VideoSource=class d0 extends TextureSource{constructor(_){super(_),this.isReady=!1,this.uploadMethodId="video",_={...d0.defaultOptions,..._},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=_.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=_.autoPlay!==!1,this.alphaMode=_.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),_.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const _=Ticker.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-_)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const _=this.resource,_e=this.options;return(_.readyState===_.HAVE_ENOUGH_DATA||_.readyState===_.HAVE_FUTURE_DATA)&&_.width&&_.height&&(_.complete=!0),_.addEventListener("play",this._onPlayStart),_.addEventListener("pause",this._onPlayStop),_.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(_e.preload||_.addEventListener("canplay",this._onCanPlay),_.addEventListener("canplaythrough",this._onCanPlayThrough),_.addEventListener("error",this._onError,!0)),this.alphaMode=await detectVideoAlphaMode(),this._load=new Promise((tt,nt)=>{this.isValid?tt(this):(this._resolve=tt,this._reject=nt,_e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${_e.preloadTimeoutMs}ms`))})),_.load())}),this._load}_onError(_){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",_),this._reject&&(this._reject(_),this._reject=null,this._resolve=null)}_isSourcePlaying(){const _=this.resource;return!_.paused&&!_.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const _=this.resource;this.isValid&&(this.isReady=!0,this.resize(_.videoWidth,_.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const _=this.resource;_&&(_.removeEventListener("play",this._onPlayStart),_.removeEventListener("pause",this._onPlayStop),_.removeEventListener("seeked",this._onSeeked),_.removeEventListener("canplay",this._onCanPlay),_.removeEventListener("canplaythrough",this._onCanPlayThrough),_.removeEventListener("error",this._onError,!0),_.pause(),_.src="",_.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(_){_!==this._autoUpdate&&(this._autoUpdate=_,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(_){_!==this._updateFPS&&(this._updateFPS=_,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ticker.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(_){return globalThis.HTMLVideoElement&&_ instanceof HTMLVideoElement}};_VideoSource.extension=ExtensionType.TextureSource;_VideoSource.defaultOptions={...TextureSource.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};_VideoSource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let VideoSource=_VideoSource;const convertToList=(et,_,_e=!1)=>(Array.isArray(et)||(et=[et]),_?et.map(tt=>typeof tt=="string"||_e?_(tt):tt):et);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(_){return this._cache.has(_)}get(_){const _e=this._cache.get(_);return _e||warn(`[Assets] Asset id ${_} was not found in the Cache`),_e}set(_,_e){const tt=convertToList(_);let nt;for(let ot=0;ot<this.parsers.length;ot++){const at=this.parsers[ot];if(at.test(_e)){nt=at.getCacheableAssets(tt,_e);break}}const rt=new Map(Object.entries(nt||{}));nt||tt.forEach(ot=>{rt.set(ot,_e)});const it=[...rt.keys()],st={cacheKeys:it,keys:tt};tt.forEach(ot=>{this._cacheMap.set(ot,st)}),it.forEach(ot=>{const at=nt?nt[ot]:_e;this._cache.has(ot)&&this._cache.get(ot)!==at&&warn("[Cache] already has key:",ot),this._cache.set(ot,rt.get(ot))})}remove(_){if(!this._cacheMap.has(_)){warn(`[Assets] Asset id ${_} was not found in the Cache`);return}const _e=this._cacheMap.get(_);_e.cacheKeys.forEach(nt=>{this._cache.delete(nt)}),_e.keys.forEach(nt=>{this._cacheMap.delete(nt)})}get parsers(){return this._parsers}}const Cache=new CacheClass,sources=[];extensions.handleByList(ExtensionType.TextureSource,sources);function textureSourceFrom(et={}){const _=et&&et.resource,_e=_?et.resource:et,tt=_?et:{resource:et};for(let nt=0;nt<sources.length;nt++){const rt=sources[nt];if(rt.test(_e))return new rt(tt)}throw new Error(`Could not find a source type for resource: ${tt.resource}`)}function resourceToTexture(et={},_=!1){const _e=et&&et.resource,tt=_e?et.resource:et,nt=_e?et:{resource:et};if(!_&&Cache.has(tt))return Cache.get(tt);const rt=new Texture({source:textureSourceFrom(nt)});return rt.on("destroy",()=>{Cache.has(tt)&&Cache.remove(tt)}),_||Cache.set(tt,rt),rt}function textureFrom(et,_=!1){return typeof et=="string"?Cache.get(et):et instanceof TextureSource?new Texture({source:et}):resourceToTexture(et,_)}Texture.from=textureFrom;TextureSource.from=textureSourceFrom;extensions.add(AlphaMask,ColorMask,StencilMask,VideoSource,ImageSource,CanvasSource,BufferImageSource);var LoaderParserPriority=(et=>(et[et.Low=0]="Low",et[et.Normal=1]="Normal",et[et.High=2]="High",et))(LoaderParserPriority||{});function assertPath(et){if(typeof et!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(et)}`)}function removeUrlParams(et){return et.split("?")[0].split("#")[0]}function escapeRegExp(et){return et.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(et,_,_e){return et.replace(new RegExp(escapeRegExp(_),"g"),_e)}function normalizeStringPosix(et,_){let _e="",tt=0,nt=-1,rt=0,it=-1;for(let st=0;st<=et.length;++st){if(st<et.length)it=et.charCodeAt(st);else{if(it===47)break;it=47}if(it===47){if(!(nt===st-1||rt===1))if(nt!==st-1&&rt===2){if(_e.length<2||tt!==2||_e.charCodeAt(_e.length-1)!==46||_e.charCodeAt(_e.length-2)!==46){if(_e.length>2){const ot=_e.lastIndexOf("/");if(ot!==_e.length-1){ot===-1?(_e="",tt=0):(_e=_e.slice(0,ot),tt=_e.length-1-_e.lastIndexOf("/")),nt=st,rt=0;continue}}else if(_e.length===2||_e.length===1){_e="",tt=0,nt=st,rt=0;continue}}}else _e.length>0?_e+=`/${et.slice(nt+1,st)}`:_e=et.slice(nt+1,st),tt=st-nt-1;nt=st,rt=0}else it===46&&rt!==-1?++rt:rt=-1}return _e}const path={toPosix(et){return replaceAll(et,"\\","/")},isUrl(et){return/^https?:/.test(this.toPosix(et))},isDataUrl(et){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(et)},isBlobUrl(et){return et.startsWith("blob:")},hasProtocol(et){return/^[^/:]+:/.test(this.toPosix(et))},getProtocol(et){assertPath(et),et=this.toPosix(et);const _=/^file:\/\/\//.exec(et);if(_)return _[0];const _e=/^[^/:]+:\/{0,2}/.exec(et);return _e?_e[0]:""},toAbsolute(et,_,_e){if(assertPath(et),this.isDataUrl(et)||this.isBlobUrl(et))return et;const tt=removeUrlParams(this.toPosix(_??DOMAdapter.get().getBaseUrl())),nt=removeUrlParams(this.toPosix(_e??this.rootname(tt)));return et=this.toPosix(et),et.startsWith("/")?path.join(nt,et.slice(1)):this.isAbsolute(et)?et:this.join(tt,et)},normalize(et){if(assertPath(et),et.length===0)return".";if(this.isDataUrl(et)||this.isBlobUrl(et))return et;et=this.toPosix(et);let _="";const _e=et.startsWith("/");this.hasProtocol(et)&&(_=this.rootname(et),et=et.slice(_.length));const tt=et.endsWith("/");return et=normalizeStringPosix(et),et.length>0&&tt&&(et+="/"),_e?`/${et}`:_+et},isAbsolute(et){return assertPath(et),et=this.toPosix(et),this.hasProtocol(et)?!0:et.startsWith("/")},join(...et){if(et.length===0)return".";let _;for(let _e=0;_e<et.length;++_e){const tt=et[_e];if(assertPath(tt),tt.length>0)if(_===void 0)_=tt;else{const nt=et[_e-1]??"";this.joinExtensions.includes(this.extname(nt).toLowerCase())?_+=`/../${tt}`:_+=`/${tt}`}}return _===void 0?".":this.normalize(_)},dirname(et){if(assertPath(et),et.length===0)return".";et=this.toPosix(et);let _=et.charCodeAt(0);const _e=_===47;let tt=-1,nt=!0;const rt=this.getProtocol(et),it=et;et=et.slice(rt.length);for(let st=et.length-1;st>=1;--st)if(_=et.charCodeAt(st),_===47){if(!nt){tt=st;break}}else nt=!1;return tt===-1?_e?"/":this.isUrl(it)?rt+et:rt:_e&&tt===1?"//":rt+et.slice(0,tt)},rootname(et){assertPath(et),et=this.toPosix(et);let _="";if(et.startsWith("/")?_="/":_=this.getProtocol(et),this.isUrl(et)){const _e=et.indexOf("/",_.length);_e!==-1?_=et.slice(0,_e):_=et,_.endsWith("/")||(_+="/")}return _},basename(et,_){assertPath(et),_&&assertPath(_),et=removeUrlParams(this.toPosix(et));let _e=0,tt=-1,nt=!0,rt;if(_!==void 0&&_.length>0&&_.length<=et.length){if(_.length===et.length&&_===et)return"";let it=_.length-1,st=-1;for(rt=et.length-1;rt>=0;--rt){const ot=et.charCodeAt(rt);if(ot===47){if(!nt){_e=rt+1;break}}else st===-1&&(nt=!1,st=rt+1),it>=0&&(ot===_.charCodeAt(it)?--it===-1&&(tt=rt):(it=-1,tt=st))}return _e===tt?tt=st:tt===-1&&(tt=et.length),et.slice(_e,tt)}for(rt=et.length-1;rt>=0;--rt)if(et.charCodeAt(rt)===47){if(!nt){_e=rt+1;break}}else tt===-1&&(nt=!1,tt=rt+1);return tt===-1?"":et.slice(_e,tt)},extname(et){assertPath(et),et=removeUrlParams(this.toPosix(et));let _=-1,_e=0,tt=-1,nt=!0,rt=0;for(let it=et.length-1;it>=0;--it){const st=et.charCodeAt(it);if(st===47){if(!nt){_e=it+1;break}continue}tt===-1&&(nt=!1,tt=it+1),st===46?_===-1?_=it:rt!==1&&(rt=1):_!==-1&&(rt=-1)}return _===-1||tt===-1||rt===0||rt===1&&_===tt-1&&_===_e+1?"":et.slice(_,tt)},parse(et){assertPath(et);const _={root:"",dir:"",base:"",ext:"",name:""};if(et.length===0)return _;et=removeUrlParams(this.toPosix(et));let _e=et.charCodeAt(0);const tt=this.isAbsolute(et);let nt;_.root=this.rootname(et),tt||this.hasProtocol(et)?nt=1:nt=0;let rt=-1,it=0,st=-1,ot=!0,at=et.length-1,lt=0;for(;at>=nt;--at){if(_e=et.charCodeAt(at),_e===47){if(!ot){it=at+1;break}continue}st===-1&&(ot=!1,st=at+1),_e===46?rt===-1?rt=at:lt!==1&&(lt=1):rt!==-1&&(lt=-1)}return rt===-1||st===-1||lt===0||lt===1&&rt===st-1&&rt===it+1?st!==-1&&(it===0&&tt?_.base=_.name=et.slice(1,st):_.base=_.name=et.slice(it,st)):(it===0&&tt?(_.name=et.slice(1,rt),_.base=et.slice(1,st)):(_.name=et.slice(it,rt),_.base=et.slice(it,st)),_.ext=et.slice(rt,st)),_.dir=this.dirname(et),_},sep:"/",delimiter:":",joinExtensions:[".html"]};function processX(et,_,_e,tt,nt){const rt=_[_e];for(let it=0;it<rt.length;it++){const st=rt[it];_e<_.length-1?processX(et.replace(tt[_e],st),_,_e+1,tt,nt):nt.push(et.replace(tt[_e],st))}}function createStringVariations(et){const _=/\{(.*?)\}/g,_e=et.match(_),tt=[];if(_e){const nt=[];_e.forEach(rt=>{const it=rt.substring(1,rt.length-1).split(",");nt.push(it)}),processX(et,nt,0,_e,tt)}else tt.push(et);return tt}const isSingleItem=et=>!Array.isArray(et);class Resolver{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(_,_e)=>`${_}${this._bundleIdConnector}${_e}`,extractAssetIdFromBundle:(_,_e)=>_e.replace(`${_}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(_){if(this._bundleIdConnector=_.connector??this._bundleIdConnector,this._createBundleAssetId=_.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=_.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(..._){_.forEach(_e=>{this._preferredOrder.push(_e),_e.priority||(_e.priority=Object.keys(_e.params))}),this._resolverHash={}}set basePath(_){this._basePath=_}get basePath(){return this._basePath}set rootPath(_){this._rootPath=_}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(_){if(typeof _=="string")this._defaultSearchParams=_;else{const _e=_;this._defaultSearchParams=Object.keys(_e).map(tt=>`${encodeURIComponent(tt)}=${encodeURIComponent(_e[tt])}`).join("&")}}getAlias(_){const{alias:_e,src:tt}=_;return convertToList(_e||tt,rt=>typeof rt=="string"?rt:Array.isArray(rt)?rt.map(it=>(it==null?void 0:it.src)??it):rt!=null&&rt.src?rt.src:rt,!0)}addManifest(_){this._manifest&&warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=_,_.bundles.forEach(_e=>{this.addBundle(_e.name,_e.assets)})}addBundle(_,_e){const tt=[];let nt=_e;Array.isArray(_e)||(nt=Object.entries(_e).map(([rt,it])=>typeof it=="string"||Array.isArray(it)?{alias:rt,src:it}:{alias:rt,...it})),nt.forEach(rt=>{const it=rt.src,st=rt.alias;let ot;if(typeof st=="string"){const at=this._createBundleAssetId(_,st);tt.push(at),ot=[st,at]}else{const at=st.map(lt=>this._createBundleAssetId(_,lt));tt.push(...at),ot=[...st,...at]}this.add({...rt,alias:ot,src:it})}),this._bundles[_]=tt}add(_){const _e=[];Array.isArray(_)?_e.push(..._):_e.push(_);let tt;tt=rt=>{this.hasKey(rt)&&warn(`[Resolver] already has key: ${rt} overwriting`)},convertToList(_e).forEach(rt=>{const{src:it}=rt;let{data:st,format:ot,loadParser:at}=rt;const lt=convertToList(it).map(ut=>typeof ut=="string"?createStringVariations(ut):Array.isArray(ut)?ut:[ut]),ct=this.getAlias(rt);Array.isArray(ct)?ct.forEach(tt):tt(ct);const ht=[];lt.forEach(ut=>{ut.forEach(ft=>{let dt={};if(typeof ft!="object"){dt.src=ft;for(let pt=0;pt<this._parsers.length;pt++){const mt=this._parsers[pt];if(mt.test(ft)){dt=mt.parse(ft);break}}}else st=ft.data??st,ot=ft.format??ot,at=ft.loadParser??at,dt={...dt,...ft};if(!ct)throw new Error(`[Resolver] alias is undefined for this asset: ${dt.src}`);dt=this._buildResolvedAsset(dt,{aliases:ct,data:st,format:ot,loadParser:at}),ht.push(dt)})}),ct.forEach(ut=>{this._assetMap[ut]=ht})})}resolveBundle(_){const _e=isSingleItem(_);_=convertToList(_);const tt={};return _.forEach(nt=>{const rt=this._bundles[nt];if(rt){const it=this.resolve(rt),st={};for(const ot in it){const at=it[ot];st[this._extractAssetIdFromBundle(nt,ot)]=at}tt[nt]=st}}),_e?tt[_[0]]:tt}resolveUrl(_){const _e=this.resolve(_);if(typeof _!="string"){const tt={};for(const nt in _e)tt[nt]=_e[nt].src;return tt}return _e.src}resolve(_){const _e=isSingleItem(_);_=convertToList(_);const tt={};return _.forEach(nt=>{if(!this._resolverHash[nt])if(this._assetMap[nt]){let rt=this._assetMap[nt];const it=this._getPreferredOrder(rt);it==null||it.priority.forEach(st=>{it.params[st].forEach(ot=>{const at=rt.filter(lt=>lt[st]?lt[st]===ot:!1);at.length&&(rt=at)})}),this._resolverHash[nt]=rt[0]}else this._resolverHash[nt]=this._buildResolvedAsset({alias:[nt],src:nt},{});tt[nt]=this._resolverHash[nt]}),_e?tt[_[0]]:tt}hasKey(_){return!!this._assetMap[_]}hasBundle(_){return!!this._bundles[_]}_getPreferredOrder(_){for(let _e=0;_e<_.length;_e++){const tt=_[0],nt=this._preferredOrder.find(rt=>rt.params.format.includes(tt.format));if(nt)return nt}return this._preferredOrder[0]}_appendDefaultSearchParams(_){if(!this._defaultSearchParams)return _;const _e=/\?/.test(_)?"&":"?";return`${_}${_e}${this._defaultSearchParams}`}_buildResolvedAsset(_,_e){const{aliases:tt,data:nt,loadParser:rt,format:it}=_e;return(this._basePath||this._rootPath)&&(_.src=path.toAbsolute(_.src,this._basePath,this._rootPath)),_.alias=tt??_.alias??[_.src],_.src=this._appendDefaultSearchParams(_.src),_.data={...nt||{},..._.data},_.loadParser=rt??_.loadParser,_.format=it??_.format??getUrlExtension(_.src),_}}Resolver.RETINA_PREFIX=/@([0-9\.]+)x/;function getUrlExtension(et){return et.split(".").pop().split("?").shift().split("#").shift()}const copySearchParams=(et,_)=>{const _e=_.split("?")[1];return _e&&(et+=`?${_e}`),et},_Spritesheet=class zl{constructor(_,_e){this.linkedSheets=[],this._texture=_ instanceof Texture?_:null,this.textureSource=_.source,this.textures={},this.animations={},this.data=_e;const tt=parseFloat(_e.meta.scale);tt?(this.resolution=tt,_.source.resolution=this.resolution):this.resolution=_.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(_=>{this._callback=_,this._batchIndex=0,this._frameKeys.length<=zl.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(_){let _e=_;const tt=zl.BATCH_SIZE;for(;_e-_<tt&&_e<this._frameKeys.length;){const nt=this._frameKeys[_e],rt=this._frames[nt],it=rt.frame;if(it){let st=null,ot=null;const at=rt.trimmed!==!1&&rt.sourceSize?rt.sourceSize:rt.frame,lt=new Rectangle(0,0,Math.floor(at.w)/this.resolution,Math.floor(at.h)/this.resolution);rt.rotated?st=new Rectangle(Math.floor(it.x)/this.resolution,Math.floor(it.y)/this.resolution,Math.floor(it.h)/this.resolution,Math.floor(it.w)/this.resolution):st=new Rectangle(Math.floor(it.x)/this.resolution,Math.floor(it.y)/this.resolution,Math.floor(it.w)/this.resolution,Math.floor(it.h)/this.resolution),rt.trimmed!==!1&&rt.spriteSourceSize&&(ot=new Rectangle(Math.floor(rt.spriteSourceSize.x)/this.resolution,Math.floor(rt.spriteSourceSize.y)/this.resolution,Math.floor(it.w)/this.resolution,Math.floor(it.h)/this.resolution)),this.textures[nt]=new Texture({source:this.textureSource,frame:st,orig:lt,trim:ot,rotate:rt.rotated?2:0,defaultAnchor:rt.anchor,defaultBorders:rt.borders,label:nt.toString()})}_e++}}_processAnimations(){const _=this.data.animations||{};for(const _e in _){this.animations[_e]=[];for(let tt=0;tt<_[_e].length;tt++){const nt=_[_e][tt];this.animations[_e].push(this.textures[nt])}}}_parseComplete(){const _=this._callback;this._callback=null,this._batchIndex=0,_.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*zl.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*zl.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(_=!1){var _e;for(const tt in this.textures)this.textures[tt].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,_&&((_e=this._texture)==null||_e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};_Spritesheet.BATCH_SIZE=1e3;let Spritesheet=_Spritesheet;const validImages=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function getCacheableAssets(et,_,_e){const tt={};if(et.forEach(nt=>{tt[nt]=_}),Object.keys(_.textures).forEach(nt=>{tt[nt]=_.textures[nt]}),!_e){const nt=path.dirname(et[0]);_.linkedSheets.forEach((rt,it)=>{const st=getCacheableAssets([`${nt}/${_.data.meta.related_multi_packs[it]}`],rt,!0);Object.assign(tt,st)})}return tt}const spritesheetAsset={extension:ExtensionType.Asset,cache:{test:et=>et instanceof Spritesheet,getCacheableAssets:(et,_)=>getCacheableAssets(et,_,!1)},resolver:{extension:{type:ExtensionType.ResolveParser,name:"resolveSpritesheet"},test:et=>{const _e=et.split("?")[0].split("."),tt=_e.pop(),nt=_e.pop();return tt==="json"&&validImages.includes(nt)},parse:et=>{var _e;const _=et.split(".");return{resolution:parseFloat(((_e=Resolver.RETINA_PREFIX.exec(et))==null?void 0:_e[1])??"1"),format:_[_.length-2],src:et}}},loader:{name:"spritesheetLoader",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal,name:"spritesheetLoader"},async testParse(et,_){return path.extname(_.src).toLowerCase()===".json"&&!!et.frames},async parse(et,_,_e){var at,lt;const{texture:tt,imageFilename:nt}=(_==null?void 0:_.data)??{};let rt=path.dirname(_.src);rt&&rt.lastIndexOf("/")!==rt.length-1&&(rt+="/");let it;if(tt instanceof Texture)it=tt;else{const ct=copySearchParams(rt+(nt??et.meta.image),_.src);it=(await _e.load([ct]))[ct]}const st=new Spritesheet(it.source,et);await st.parse();const ot=(at=et==null?void 0:et.meta)==null?void 0:at.related_multi_packs;if(Array.isArray(ot)){const ct=[];for(const ut of ot){if(typeof ut!="string")continue;let ft=rt+ut;(lt=_.data)!=null&&lt.ignoreMultiPack||(ft=copySearchParams(ft,_.src),ct.push(_e.load({src:ft,data:{ignoreMultiPack:!0}})))}const ht=await Promise.all(ct);st.linkedSheets=ht,ht.forEach(ut=>{ut.linkedSheets=[st].concat(st.linkedSheets.filter(ft=>ft!==ut))})}return st},async unload(et,_,_e){await _e.unload(et.textureSource._sourceOrigin),et.destroy(!1)}}};extensions.add(spritesheetAsset);let context;function getTestContext(){return(!context||context!=null&&context.isContextLost())&&(context=DOMAdapter.get().createCanvas().getContext("webgl",{})),context}class BindGroup{constructor(_){this.resources=Object.create(null),this._dirty=!0;let _e=0;for(const tt in _){const nt=_[tt];this.setResource(nt,_e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const _=[];let _e=0;for(const tt in this.resources)_[_e++]=this.resources[tt]._resourceId;this._key=_.join("|")}setResource(_,_e){var nt,rt;const tt=this.resources[_e];_!==tt&&(tt&&((nt=_.off)==null||nt.call(_,"change",this.onResourceChange,this)),(rt=_.on)==null||rt.call(_,"change",this.onResourceChange,this),this.resources[_e]=_,this._dirty=!0)}getResource(_){return this.resources[_]}_touch(_){const _e=this.resources;for(const tt in _e)_e[tt]._touched=_}destroy(){var _e;const _=this.resources;for(const tt in _){const nt=_[tt];(_e=nt.off)==null||_e.call(nt,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(_){if(this._dirty=!0,_.destroyed){const _e=this.resources;for(const tt in _e)_e[tt]===_&&(_e[tt]=null)}else this._updateKey()}}const environments=[];extensions.handleByNamedList(ExtensionType.Environment,environments);async function loadEnvironmentExtensions(et){if(!et)for(let _=0;_<environments.length;_++){const _e=environments[_];if(_e.value.test()){await _e.value.load();return}}}let unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval=="boolean")return unsafeEval;try{unsafeEval=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{unsafeEval=!1}return unsafeEval}var earcut$2={exports:{}};earcut$2.exports=earcut;earcut$2.exports.default=earcut;function earcut(et,_,_e){_e=_e||2;var tt=_&&_.length,nt=tt?_[0]*_e:et.length,rt=linkedList(et,0,nt,_e,!0),it=[];if(!rt||rt.next===rt.prev)return it;var st,ot,at,lt,ct,ht,ut;if(tt&&(rt=eliminateHoles(et,_,rt,_e)),et.length>80*_e){st=at=et[0],ot=lt=et[1];for(var ft=_e;ft<nt;ft+=_e)ct=et[ft],ht=et[ft+1],ct<st&&(st=ct),ht<ot&&(ot=ht),ct>at&&(at=ct),ht>lt&&(lt=ht);ut=Math.max(at-st,lt-ot),ut=ut!==0?32767/ut:0}return earcutLinked(rt,it,_e,st,ot,ut,0),it}function linkedList(et,_,_e,tt,nt){var rt,it;if(nt===signedArea(et,_,_e,tt)>0)for(rt=_;rt<_e;rt+=tt)it=insertNode(rt,et[rt],et[rt+1],it);else for(rt=_e-tt;rt>=_;rt-=tt)it=insertNode(rt,et[rt],et[rt+1],it);return it&&equals(it,it.next)&&(removeNode(it),it=it.next),it}function filterPoints(et,_){if(!et)return et;_||(_=et);var _e=et,tt;do if(tt=!1,!_e.steiner&&(equals(_e,_e.next)||area(_e.prev,_e,_e.next)===0)){if(removeNode(_e),_e=_=_e.prev,_e===_e.next)break;tt=!0}else _e=_e.next;while(tt||_e!==_);return _}function earcutLinked(et,_,_e,tt,nt,rt,it){if(et){!it&&rt&&indexCurve(et,tt,nt,rt);for(var st=et,ot,at;et.prev!==et.next;){if(ot=et.prev,at=et.next,rt?isEarHashed(et,tt,nt,rt):isEar(et)){_.push(ot.i/_e|0),_.push(et.i/_e|0),_.push(at.i/_e|0),removeNode(et),et=at.next,st=at.next;continue}if(et=at,et===st){it?it===1?(et=cureLocalIntersections(filterPoints(et),_,_e),earcutLinked(et,_,_e,tt,nt,rt,2)):it===2&&splitEarcut(et,_,_e,tt,nt,rt):earcutLinked(filterPoints(et),_,_e,tt,nt,rt,1);break}}}}function isEar(et){var _=et.prev,_e=et,tt=et.next;if(area(_,_e,tt)>=0)return!1;for(var nt=_.x,rt=_e.x,it=tt.x,st=_.y,ot=_e.y,at=tt.y,lt=nt<rt?nt<it?nt:it:rt<it?rt:it,ct=st<ot?st<at?st:at:ot<at?ot:at,ht=nt>rt?nt>it?nt:it:rt>it?rt:it,ut=st>ot?st>at?st:at:ot>at?ot:at,ft=tt.next;ft!==_;){if(ft.x>=lt&&ft.x<=ht&&ft.y>=ct&&ft.y<=ut&&pointInTriangle(nt,st,rt,ot,it,at,ft.x,ft.y)&&area(ft.prev,ft,ft.next)>=0)return!1;ft=ft.next}return!0}function isEarHashed(et,_,_e,tt){var nt=et.prev,rt=et,it=et.next;if(area(nt,rt,it)>=0)return!1;for(var st=nt.x,ot=rt.x,at=it.x,lt=nt.y,ct=rt.y,ht=it.y,ut=st<ot?st<at?st:at:ot<at?ot:at,ft=lt<ct?lt<ht?lt:ht:ct<ht?ct:ht,dt=st>ot?st>at?st:at:ot>at?ot:at,pt=lt>ct?lt>ht?lt:ht:ct>ht?ct:ht,mt=zOrder(ut,ft,_,_e,tt),vt=zOrder(dt,pt,_,_e,tt),yt=et.prevZ,_t=et.nextZ;yt&&yt.z>=mt&&_t&&_t.z<=vt;){if(yt.x>=ut&&yt.x<=dt&&yt.y>=ft&&yt.y<=pt&&yt!==nt&&yt!==it&&pointInTriangle(st,lt,ot,ct,at,ht,yt.x,yt.y)&&area(yt.prev,yt,yt.next)>=0||(yt=yt.prevZ,_t.x>=ut&&_t.x<=dt&&_t.y>=ft&&_t.y<=pt&&_t!==nt&&_t!==it&&pointInTriangle(st,lt,ot,ct,at,ht,_t.x,_t.y)&&area(_t.prev,_t,_t.next)>=0))return!1;_t=_t.nextZ}for(;yt&&yt.z>=mt;){if(yt.x>=ut&&yt.x<=dt&&yt.y>=ft&&yt.y<=pt&&yt!==nt&&yt!==it&&pointInTriangle(st,lt,ot,ct,at,ht,yt.x,yt.y)&&area(yt.prev,yt,yt.next)>=0)return!1;yt=yt.prevZ}for(;_t&&_t.z<=vt;){if(_t.x>=ut&&_t.x<=dt&&_t.y>=ft&&_t.y<=pt&&_t!==nt&&_t!==it&&pointInTriangle(st,lt,ot,ct,at,ht,_t.x,_t.y)&&area(_t.prev,_t,_t.next)>=0)return!1;_t=_t.nextZ}return!0}function cureLocalIntersections(et,_,_e){var tt=et;do{var nt=tt.prev,rt=tt.next.next;!equals(nt,rt)&&intersects(nt,tt,tt.next,rt)&&locallyInside(nt,rt)&&locallyInside(rt,nt)&&(_.push(nt.i/_e|0),_.push(tt.i/_e|0),_.push(rt.i/_e|0),removeNode(tt),removeNode(tt.next),tt=et=rt),tt=tt.next}while(tt!==et);return filterPoints(tt)}function splitEarcut(et,_,_e,tt,nt,rt){var it=et;do{for(var st=it.next.next;st!==it.prev;){if(it.i!==st.i&&isValidDiagonal(it,st)){var ot=splitPolygon(it,st);it=filterPoints(it,it.next),ot=filterPoints(ot,ot.next),earcutLinked(it,_,_e,tt,nt,rt,0),earcutLinked(ot,_,_e,tt,nt,rt,0);return}st=st.next}it=it.next}while(it!==et)}function eliminateHoles(et,_,_e,tt){var nt=[],rt,it,st,ot,at;for(rt=0,it=_.length;rt<it;rt++)st=_[rt]*tt,ot=rt<it-1?_[rt+1]*tt:et.length,at=linkedList(et,st,ot,tt,!1),at===at.next&&(at.steiner=!0),nt.push(getLeftmost(at));for(nt.sort(compareX),rt=0;rt<nt.length;rt++)_e=eliminateHole(nt[rt],_e);return _e}function compareX(et,_){return et.x-_.x}function eliminateHole(et,_){var _e=findHoleBridge(et,_);if(!_e)return _;var tt=splitPolygon(_e,et);return filterPoints(tt,tt.next),filterPoints(_e,_e.next)}function findHoleBridge(et,_){var _e=_,tt=et.x,nt=et.y,rt=-1/0,it;do{if(nt<=_e.y&&nt>=_e.next.y&&_e.next.y!==_e.y){var st=_e.x+(nt-_e.y)*(_e.next.x-_e.x)/(_e.next.y-_e.y);if(st<=tt&&st>rt&&(rt=st,it=_e.x<_e.next.x?_e:_e.next,st===tt))return it}_e=_e.next}while(_e!==_);if(!it)return null;var ot=it,at=it.x,lt=it.y,ct=1/0,ht;_e=it;do tt>=_e.x&&_e.x>=at&&tt!==_e.x&&pointInTriangle(nt<lt?tt:rt,nt,at,lt,nt<lt?rt:tt,nt,_e.x,_e.y)&&(ht=Math.abs(nt-_e.y)/(tt-_e.x),locallyInside(_e,et)&&(ht<ct||ht===ct&&(_e.x>it.x||_e.x===it.x&&sectorContainsSector(it,_e)))&&(it=_e,ct=ht)),_e=_e.next;while(_e!==ot);return it}function sectorContainsSector(et,_){return area(et.prev,et,_.prev)<0&&area(_.next,et,et.next)<0}function indexCurve(et,_,_e,tt){var nt=et;do nt.z===0&&(nt.z=zOrder(nt.x,nt.y,_,_e,tt)),nt.prevZ=nt.prev,nt.nextZ=nt.next,nt=nt.next;while(nt!==et);nt.prevZ.nextZ=null,nt.prevZ=null,sortLinked(nt)}function sortLinked(et){var _,_e,tt,nt,rt,it,st,ot,at=1;do{for(_e=et,et=null,rt=null,it=0;_e;){for(it++,tt=_e,st=0,_=0;_<at&&(st++,tt=tt.nextZ,!!tt);_++);for(ot=at;st>0||ot>0&&tt;)st!==0&&(ot===0||!tt||_e.z<=tt.z)?(nt=_e,_e=_e.nextZ,st--):(nt=tt,tt=tt.nextZ,ot--),rt?rt.nextZ=nt:et=nt,nt.prevZ=rt,rt=nt;_e=tt}rt.nextZ=null,at*=2}while(it>1);return et}function zOrder(et,_,_e,tt,nt){return et=(et-_e)*nt|0,_=(_-tt)*nt|0,et=(et|et<<8)&16711935,et=(et|et<<4)&252645135,et=(et|et<<2)&858993459,et=(et|et<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,et|_<<1}function getLeftmost(et){var _=et,_e=et;do(_.x<_e.x||_.x===_e.x&&_.y<_e.y)&&(_e=_),_=_.next;while(_!==et);return _e}function pointInTriangle(et,_,_e,tt,nt,rt,it,st){return(nt-it)*(_-st)>=(et-it)*(rt-st)&&(et-it)*(tt-st)>=(_e-it)*(_-st)&&(_e-it)*(rt-st)>=(nt-it)*(tt-st)}function isValidDiagonal(et,_){return et.next.i!==_.i&&et.prev.i!==_.i&&!intersectsPolygon(et,_)&&(locallyInside(et,_)&&locallyInside(_,et)&&middleInside(et,_)&&(area(et.prev,et,_.prev)||area(et,_.prev,_))||equals(et,_)&&area(et.prev,et,et.next)>0&&area(_.prev,_,_.next)>0)}function area(et,_,_e){return(_.y-et.y)*(_e.x-_.x)-(_.x-et.x)*(_e.y-_.y)}function equals(et,_){return et.x===_.x&&et.y===_.y}function intersects(et,_,_e,tt){var nt=sign(area(et,_,_e)),rt=sign(area(et,_,tt)),it=sign(area(_e,tt,et)),st=sign(area(_e,tt,_));return!!(nt!==rt&&it!==st||nt===0&&onSegment(et,_e,_)||rt===0&&onSegment(et,tt,_)||it===0&&onSegment(_e,et,tt)||st===0&&onSegment(_e,_,tt))}function onSegment(et,_,_e){return _.x<=Math.max(et.x,_e.x)&&_.x>=Math.min(et.x,_e.x)&&_.y<=Math.max(et.y,_e.y)&&_.y>=Math.min(et.y,_e.y)}function sign(et){return et>0?1:et<0?-1:0}function intersectsPolygon(et,_){var _e=et;do{if(_e.i!==et.i&&_e.next.i!==et.i&&_e.i!==_.i&&_e.next.i!==_.i&&intersects(_e,_e.next,et,_))return!0;_e=_e.next}while(_e!==et);return!1}function locallyInside(et,_){return area(et.prev,et,et.next)<0?area(et,_,et.next)>=0&&area(et,et.prev,_)>=0:area(et,_,et.prev)<0||area(et,et.next,_)<0}function middleInside(et,_){var _e=et,tt=!1,nt=(et.x+_.x)/2,rt=(et.y+_.y)/2;do _e.y>rt!=_e.next.y>rt&&_e.next.y!==_e.y&&nt<(_e.next.x-_e.x)*(rt-_e.y)/(_e.next.y-_e.y)+_e.x&&(tt=!tt),_e=_e.next;while(_e!==et);return tt}function splitPolygon(et,_){var _e=new Node$1(et.i,et.x,et.y),tt=new Node$1(_.i,_.x,_.y),nt=et.next,rt=_.prev;return et.next=_,_.prev=et,_e.next=nt,nt.prev=_e,tt.next=_e,_e.prev=tt,rt.next=tt,tt.prev=rt,tt}function insertNode(et,_,_e,tt){var nt=new Node$1(et,_,_e);return tt?(nt.next=tt.next,nt.prev=tt,tt.next.prev=nt,tt.next=nt):(nt.prev=nt,nt.next=nt),nt}function removeNode(et){et.next.prev=et.prev,et.prev.next=et.next,et.prevZ&&(et.prevZ.nextZ=et.nextZ),et.nextZ&&(et.nextZ.prevZ=et.prevZ)}function Node$1(et,_,_e){this.i=et,this.x=_,this.y=_e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}earcut.deviation=function(et,_,_e,tt){var nt=_&&_.length,rt=nt?_[0]*_e:et.length,it=Math.abs(signedArea(et,0,rt,_e));if(nt)for(var st=0,ot=_.length;st<ot;st++){var at=_[st]*_e,lt=st<ot-1?_[st+1]*_e:et.length;it-=Math.abs(signedArea(et,at,lt,_e))}var ct=0;for(st=0;st<tt.length;st+=3){var ht=tt[st]*_e,ut=tt[st+1]*_e,ft=tt[st+2]*_e;ct+=Math.abs((et[ht]-et[ft])*(et[ut+1]-et[ht+1])-(et[ht]-et[ut])*(et[ft+1]-et[ht+1]))}return it===0&&ct===0?0:Math.abs((ct-it)/it)};function signedArea(et,_,_e,tt){for(var nt=0,rt=_,it=_e-tt;rt<_e;rt+=tt)nt+=(et[it]-et[rt])*(et[rt+1]+et[it+1]),it=rt;return nt}earcut.flatten=function(et){for(var _=et[0][0].length,_e={vertices:[],holes:[],dimensions:_},tt=0,nt=0;nt<et.length;nt++){for(var rt=0;rt<et[nt].length;rt++)for(var it=0;it<_;it++)_e.vertices.push(et[nt][rt][it]);nt>0&&(tt+=et[nt-1].length,_e.holes.push(tt))}return _e};var earcutExports=earcut$2.exports;const earcut$1=getDefaultExportFromCjs(earcutExports);var CLEAR=(et=>(et[et.NONE=0]="NONE",et[et.COLOR=16384]="COLOR",et[et.STENCIL=1024]="STENCIL",et[et.DEPTH=256]="DEPTH",et[et.COLOR_DEPTH=16640]="COLOR_DEPTH",et[et.COLOR_STENCIL=17408]="COLOR_STENCIL",et[et.DEPTH_STENCIL=1280]="DEPTH_STENCIL",et[et.ALL=17664]="ALL",et))(CLEAR||{});class SystemRunner{constructor(_){this.items=[],this._name=_}emit(_,_e,tt,nt,rt,it,st,ot){const{name:at,items:lt}=this;for(let ct=0,ht=lt.length;ct<ht;ct++)lt[ct][at](_,_e,tt,nt,rt,it,st,ot);return this}add(_){return _[this._name]&&(this.remove(_),this.items.push(_)),this}remove(_){const _e=this.items.indexOf(_);return _e!==-1&&this.items.splice(_e,1),this}contains(_){return this.items.indexOf(_)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const defaultRunners=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],_AbstractRenderer=class p0 extends EventEmitter{constructor(_){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=_.type,this.name=_.name,this.config=_;const _e=[...defaultRunners,...this.config.runners??[]];this._addRunners(..._e),this._unsafeEvalCheck()}async init(_={}){const _e=_.skipExtensionImports===!0?!0:_.manageImports===!1;await loadEnvironmentExtensions(_e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const tt in this._systemsHash)_={...this._systemsHash[tt].constructor.defaultOptions,..._};_={...p0.defaultOptions,..._},this._roundPixels=_.roundPixels?1:0;for(let tt=0;tt<this.runners.init.items.length;tt++)await this.runners.init.items[tt].init(_);this._initOptions=_}render(_,_e){let tt=_;if(tt instanceof Container&&(tt={container:tt},_e&&(deprecation(v8_0_0,"passing a second argument is deprecated, please use render options instead"),tt.target=_e.renderTexture)),tt.target||(tt.target=this.view.renderTarget),tt.target===this.view.renderTarget&&(this._lastObjectRendered=tt.container,tt.clearColor=this.background.colorRgba),tt.clearColor){const nt=Array.isArray(tt.clearColor)&&tt.clearColor.length===4;tt.clearColor=nt?tt.clearColor:Color.shared.setValue(tt.clearColor).toArray()}tt.transform||(tt.container.updateLocalTransform(),tt.transform=tt.container.localTransform),this.runners.prerender.emit(tt),this.runners.renderStart.emit(tt),this.runners.render.emit(tt),this.runners.renderEnd.emit(tt),this.runners.postrender.emit(tt)}resize(_,_e,tt){this.view.resize(_,_e,tt),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution)}clear(_={}){const _e=this;_.target||(_.target=_e.renderTarget.renderTarget),_.clearColor||(_.clearColor=this.background.colorRgba),_.clear??(_.clear=CLEAR.ALL);const{clear:tt,clearColor:nt,target:rt}=_;Color.shared.setValue(nt??this.background.colorRgba),_e.renderTarget.clear(rt,tt,Color.shared.toArray())}get resolution(){return this.view.resolution}set resolution(_){this.view.resolution=_,this.runners.resolutionChange.emit(_)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(..._){_.forEach(_e=>{this.runners[_e]=new SystemRunner(_e)})}_addSystems(_){let _e;for(_e in _){const tt=_[_e];this._addSystem(tt.value,tt.name)}}_addSystem(_,_e){const tt=new _(this);if(this[_e])throw new Error(`Whoops! The name "${_e}" is already in use`);this[_e]=tt,this._systemsHash[_e]=tt;for(const nt in this.runners)this.runners[nt].add(tt);return this}_addPipes(_,_e){const tt=_e.reduce((nt,rt)=>(nt[rt.name]=rt.value,nt),{});_.forEach(nt=>{const rt=nt.value,it=nt.name,st=tt[it];this.renderPipes[it]=new rt(this,st?new st:null)})}destroy(_=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(_),Object.values(this.runners).forEach(_e=>{_e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(_){return this.textureGenerator.generateTexture(_)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};_AbstractRenderer.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let AbstractRenderer=_AbstractRenderer,_isWebGLSupported;function isWebGLSupported(et){return _isWebGLSupported!==void 0||(_isWebGLSupported=(()=>{var _e;const _={stencil:!0,failIfMajorPerformanceCaveat:et??AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat};try{if(!DOMAdapter.get().getWebGLRenderingContext())return!1;let nt=DOMAdapter.get().createCanvas().getContext("webgl",_);const rt=!!((_e=nt==null?void 0:nt.getContextAttributes())!=null&&_e.stencil);if(nt){const it=nt.getExtension("WEBGL_lose_context");it&&it.loseContext()}return nt=null,rt}catch{return!1}})()),_isWebGLSupported}let _isWebGPUSupported;async function isWebGPUSupported(et={}){return _isWebGPUSupported!==void 0||(_isWebGPUSupported=await(async()=>{const _=DOMAdapter.get().getNavigator().gpu;if(!_)return!1;try{return await(await _.requestAdapter(et)).requestDevice(),!0}catch{return!1}})()),_isWebGPUSupported}const renderPriority=["webgl","webgpu","canvas"];async function autoDetectRenderer(et){let _=[];et.preference?(_.push(et.preference),renderPriority.forEach(rt=>{rt!==et.preference&&_.push(rt)})):_=renderPriority.slice();let _e,tt={};for(let rt=0;rt<_.length;rt++){const it=_[rt];if(it==="webgpu"&&await isWebGPUSupported()){const{WebGPURenderer:st}=await __vitePreload(async()=>{const{WebGPURenderer:ot}=await import("./WebGPURenderer-CzDNaKdr.js");return{WebGPURenderer:ot}},__vite__mapDeps([5,2,6,3]));_e=st,tt={...et,...et.webgpu};break}else if(it==="webgl"&&isWebGLSupported(et.failIfMajorPerformanceCaveat??AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:st}=await __vitePreload(async()=>{const{WebGLRenderer:ot}=await import("./WebGLRenderer-BgztYrGy.js");return{WebGLRenderer:ot}},__vite__mapDeps([7,2,4,6]));_e=st,tt={...et,...et.webgl};break}else if(it==="canvas")throw tt={...et},new Error("CanvasRenderer is not yet implemented")}if(delete tt.webgpu,delete tt.webgl,!_e)throw new Error("No available renderer for the current environment");const nt=new _e;return await nt.init(tt),nt}class ApplicationInitHook{static init(){var _;(_=globalThis.__PIXI_APP_INIT__)==null||_.call(globalThis,this)}static destroy(){}}ApplicationInitHook.extension=ExtensionType.Application;class RendererInitHook{constructor(_){this._renderer=_}init(){var _;(_=globalThis.__PIXI_RENDERER_INIT__)==null||_.call(globalThis,this._renderer)}destroy(){this._renderer=null}}RendererInitHook.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:"initHook",priority:-10};const _Application=class kp{constructor(..._){this.stage=new Container,_[0]!==void 0&&deprecation(v8_0_0,"Application constructor options are deprecated, please use Application.init() instead.")}async init(_){_={..._},this.renderer=await autoDetectRenderer(_),kp._plugins.forEach(_e=>{_e.init.call(this,_)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return deprecation(v8_0_0,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(_=!1,_e=!1){const tt=kp._plugins.slice(0);tt.reverse(),tt.forEach(nt=>{nt.destroy.call(this)}),this.stage.destroy(_e),this.stage=null,this.renderer.destroy(_),this.renderer=null}};_Application._plugins=[];let Application=_Application;extensions.handleByList(ExtensionType.Application,Application._plugins);extensions.add(ApplicationInitHook);const _FillGradient=class Dp{constructor(_,_e,tt,nt){this.uid=uid("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=_,this.y0=_e,this.x1=tt,this.y1=nt}addColorStop(_,_e){return this.gradientStops.push({offset:_,color:Color.shared.setValue(_e).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const _=Dp.defaultTextureSize,{gradientStops:_e}=this,tt=DOMAdapter.get().createCanvas();tt.width=_,tt.height=_;const nt=tt.getContext("2d"),rt=nt.createLinearGradient(0,0,Dp.defaultTextureSize,1);for(let dt=0;dt<_e.length;dt++){const pt=_e[dt];rt.addColorStop(pt.offset,pt.color)}nt.fillStyle=rt,nt.fillRect(0,0,_,_),this.texture=new Texture({source:new ImageSource({resource:tt,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:it,y0:st,x1:ot,y1:at}=this,lt=new Matrix$4,ct=ot-it,ht=at-st,ut=Math.sqrt(ct*ct+ht*ht),ft=Math.atan2(ht,ct);lt.translate(-it,-st),lt.scale(1/_,1/_),lt.rotate(-ft),lt.scale(256/ut,1),this.transform=lt,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const _=this.gradientStops.map(nt=>`${nt.offset}-${nt.color}`).join("-"),_e=this.texture.uid,tt=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${_}-${_e}-${tt}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};_FillGradient.defaultTextureSize=256;let FillGradient=_FillGradient;const repetitionMap={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class FillPattern{constructor(_,_e){this.uid=uid("fillPattern"),this.transform=new Matrix$4,this._styleKey=null,this.texture=_,this.transform.scale(1/_.frame.width,1/_.frame.height),_e&&(_.source.style.addressModeU=repetitionMap[_e].addressModeU,_.source.style.addressModeV=repetitionMap[_e].addressModeV)}setTransform(_){const _e=this.texture;this.transform.copyFrom(_),this.transform.invert(),this.transform.scale(1/_e.frame.width,1/_e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var parseSvgPath=parse$1,length={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},segment=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function parse$1(et){var _=[];return et.replace(segment,function(_e,tt,nt){var rt=tt.toLowerCase();for(nt=parseValues(nt),rt=="m"&&nt.length>2&&(_.push([tt].concat(nt.splice(0,2))),rt="l",tt=tt=="m"?"l":"L");;){if(nt.length==length[rt])return nt.unshift(tt),_.push(nt);if(nt.length<length[rt])throw new Error("malformed path data");_.push([tt].concat(nt.splice(0,length[rt])))}}),_}var number=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function parseValues(et){var _=et.match(number);return _?_.map(Number):[]}const parse$2=getDefaultExportFromCjs(parseSvgPath);function SVGToGraphicsPath(et,_){const _e=parse$2(et),tt=[];let nt=null,rt=0,it=0;for(let st=0;st<_e.length;st++){const ot=_e[st],at=ot[0],lt=ot;switch(at){case"M":rt=lt[1],it=lt[2],_.moveTo(rt,it);break;case"m":rt+=lt[1],it+=lt[2],_.moveTo(rt,it);break;case"H":rt=lt[1],_.lineTo(rt,it);break;case"h":rt+=lt[1],_.lineTo(rt,it);break;case"V":it=lt[1],_.lineTo(rt,it);break;case"v":it+=lt[1],_.lineTo(rt,it);break;case"L":rt=lt[1],it=lt[2],_.lineTo(rt,it);break;case"l":rt+=lt[1],it+=lt[2],_.lineTo(rt,it);break;case"C":rt=lt[5],it=lt[6],_.bezierCurveTo(lt[1],lt[2],lt[3],lt[4],rt,it);break;case"c":_.bezierCurveTo(rt+lt[1],it+lt[2],rt+lt[3],it+lt[4],rt+lt[5],it+lt[6]),rt+=lt[5],it+=lt[6];break;case"S":rt=lt[3],it=lt[4],_.bezierCurveToShort(lt[1],lt[2],rt,it);break;case"s":_.bezierCurveToShort(rt+lt[1],it+lt[2],rt+lt[3],it+lt[4]),rt+=lt[3],it+=lt[4];break;case"Q":rt=lt[3],it=lt[4],_.quadraticCurveTo(lt[1],lt[2],rt,it);break;case"q":_.quadraticCurveTo(rt+lt[1],it+lt[2],rt+lt[3],it+lt[4]),rt+=lt[3],it+=lt[4];break;case"T":rt=lt[1],it=lt[2],_.quadraticCurveToShort(rt,it);break;case"t":rt+=lt[1],it+=lt[2],_.quadraticCurveToShort(rt,it);break;case"A":rt=lt[6],it=lt[7],_.arcToSvg(lt[1],lt[2],lt[3],lt[4],lt[5],rt,it);break;case"a":rt+=lt[6],it+=lt[7],_.arcToSvg(lt[1],lt[2],lt[3],lt[4],lt[5],rt,it);break;case"Z":case"z":_.closePath(),tt.length>0&&(nt=tt.pop(),nt?(rt=nt.startX,it=nt.startY):(rt=0,it=0)),nt=null;break;default:warn(`Unknown SVG path command: ${at}`)}at!=="Z"&&at!=="z"&&nt===null&&(nt={startX:rt,startY:it},tt.push(nt))}return _}class Circle{constructor(_=0,_e=0,tt=0){this.type="circle",this.x=_,this.y=_e,this.radius=tt}clone(){return new Circle(this.x,this.y,this.radius)}contains(_,_e){if(this.radius<=0)return!1;const tt=this.radius*this.radius;let nt=this.x-_,rt=this.y-_e;return nt*=nt,rt*=rt,nt+rt<=tt}strokeContains(_,_e,tt){if(this.radius===0)return!1;const nt=this.x-_,rt=this.y-_e,it=this.radius,st=tt/2,ot=Math.sqrt(nt*nt+rt*rt);return ot<it+st&&ot>it-st}getBounds(_){return _=_||new Rectangle,_.x=this.x-this.radius,_.y=this.y-this.radius,_.width=this.radius*2,_.height=this.radius*2,_}copyFrom(_){return this.x=_.x,this.y=_.y,this.radius=_.radius,this}copyTo(_){return _.copyFrom(this),_}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ellipse{constructor(_=0,_e=0,tt=0,nt=0){this.type="ellipse",this.x=_,this.y=_e,this.halfWidth=tt,this.halfHeight=nt}clone(){return new Ellipse(this.x,this.y,this.halfWidth,this.halfHeight)}contains(_,_e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let tt=(_-this.x)/this.halfWidth,nt=(_e-this.y)/this.halfHeight;return tt*=tt,nt*=nt,tt+nt<=1}strokeContains(_,_e,tt){const{halfWidth:nt,halfHeight:rt}=this;if(nt<=0||rt<=0)return!1;const it=tt/2,st=nt-it,ot=rt-it,at=nt+it,lt=rt+it,ct=_-this.x,ht=_e-this.y,ut=ct*ct/(st*st)+ht*ht/(ot*ot),ft=ct*ct/(at*at)+ht*ht/(lt*lt);return ut>1&&ft<=1}getBounds(_){return _=_||new Rectangle,_.x=this.x-this.halfWidth,_.y=this.y-this.halfHeight,_.width=this.halfWidth*2,_.height=this.halfHeight*2,_}copyFrom(_){return this.x=_.x,this.y=_.y,this.halfWidth=_.halfWidth,this.halfHeight=_.halfHeight,this}copyTo(_){return _.copyFrom(this),_}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function squaredDistanceToLineSegment(et,_,_e,tt,nt,rt){const it=et-_e,st=_-tt,ot=nt-_e,at=rt-tt,lt=it*ot+st*at,ct=ot*ot+at*at;let ht=-1;ct!==0&&(ht=lt/ct);let ut,ft;ht<0?(ut=_e,ft=tt):ht>1?(ut=nt,ft=rt):(ut=_e+ht*ot,ft=tt+ht*at);const dt=et-ut,pt=_-ft;return dt*dt+pt*pt}class Polygon{constructor(..._){this.type="polygon";let _e=Array.isArray(_[0])?_[0]:_;if(typeof _e[0]!="number"){const tt=[];for(let nt=0,rt=_e.length;nt<rt;nt++)tt.push(_e[nt].x,_e[nt].y);_e=tt}this.points=_e,this.closePath=!0}clone(){const _=this.points.slice(),_e=new Polygon(_);return _e.closePath=this.closePath,_e}contains(_,_e){let tt=!1;const nt=this.points.length/2;for(let rt=0,it=nt-1;rt<nt;it=rt++){const st=this.points[rt*2],ot=this.points[rt*2+1],at=this.points[it*2],lt=this.points[it*2+1];ot>_e!=lt>_e&&_<(at-st)*((_e-ot)/(lt-ot))+st&&(tt=!tt)}return tt}strokeContains(_,_e,tt){const nt=tt/2,rt=nt*nt,{points:it}=this,st=it.length-(this.closePath?0:2);for(let ot=0;ot<st;ot+=2){const at=it[ot],lt=it[ot+1],ct=it[(ot+2)%it.length],ht=it[(ot+3)%it.length];if(squaredDistanceToLineSegment(_,_e,at,lt,ct,ht)<=rt)return!0}return!1}getBounds(_){_=_||new Rectangle;const _e=this.points;let tt=1/0,nt=-1/0,rt=1/0,it=-1/0;for(let st=0,ot=_e.length;st<ot;st+=2){const at=_e[st],lt=_e[st+1];tt=at<tt?at:tt,nt=at>nt?at:nt,rt=lt<rt?lt:rt,it=lt>it?lt:it}return _.x=tt,_.width=nt-tt,_.y=rt,_.height=it-rt,_}copyFrom(_){return this.points=_.points.slice(),this.closePath=_.closePath,this}copyTo(_){return _.copyFrom(this),_}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((_,_e)=>`${_}, ${_e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const isCornerWithinStroke=(et,_,_e,tt,nt,rt)=>{const it=et-_e,st=_-tt,ot=Math.sqrt(it*it+st*st);return ot>=nt-rt&&ot<=nt+rt};class RoundedRectangle{constructor(_=0,_e=0,tt=0,nt=0,rt=20){this.type="roundedRectangle",this.x=_,this.y=_e,this.width=tt,this.height=nt,this.radius=rt}getBounds(_){return _=_||new Rectangle,_.x=this.x,_.y=this.y,_.width=this.width,_.height=this.height,_}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}copyFrom(_){return this.x=_.x,this.y=_.y,this.width=_.width,this.height=_.height,this}copyTo(_){return _.copyFrom(this),_}contains(_,_e){if(this.width<=0||this.height<=0)return!1;if(_>=this.x&&_<=this.x+this.width&&_e>=this.y&&_e<=this.y+this.height){const tt=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(_e>=this.y+tt&&_e<=this.y+this.height-tt||_>=this.x+tt&&_<=this.x+this.width-tt)return!0;let nt=_-(this.x+tt),rt=_e-(this.y+tt);const it=tt*tt;if(nt*nt+rt*rt<=it||(nt=_-(this.x+this.width-tt),nt*nt+rt*rt<=it)||(rt=_e-(this.y+this.height-tt),nt*nt+rt*rt<=it)||(nt=_-(this.x+tt),nt*nt+rt*rt<=it))return!0}return!1}strokeContains(_,_e,tt){const{x:nt,y:rt,width:it,height:st,radius:ot}=this,at=tt/2,lt=nt+ot,ct=rt+ot,ht=it-ot*2,ut=st-ot*2,ft=nt+it,dt=rt+st;return(_>=nt-at&&_<=nt+at||_>=ft-at&&_<=ft+at)&&_e>=ct&&_e<=ct+ut||(_e>=rt-at&&_e<=rt+at||_e>=dt-at&&_e<=dt+at)&&_>=lt&&_<=lt+ht?!0:_<lt&&_e<ct&&isCornerWithinStroke(_,_e,lt,ct,ot,at)||_>ft-ot&&_e<ct&&isCornerWithinStroke(_,_e,ft-ot,ct,ot,at)||_>ft-ot&&_e>dt-ot&&isCornerWithinStroke(_,_e,ft-ot,dt-ot,ot,at)||_<lt&&_e>dt-ot&&isCornerWithinStroke(_,_e,lt,dt-ot,ot,at)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(et){let _="";for(let _e=0;_e<et;++_e)_e>0&&(_+=`
else `),_e<et-1&&(_+=`if(test == ${_e}.0){}`);return _}function checkMaxIfStatementsInShader(et,_){if(et===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const _e=_.createShader(_.FRAGMENT_SHADER);try{for(;;){const tt=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(et));if(_.shaderSource(_e,tt),_.compileShader(_e),!_.getShaderParameter(_e,_.COMPILE_STATUS))et=et/2|0;else break}}finally{_.deleteShader(_e)}return et}let maxTexturesPerBatchCache=null;function getMaxTexturesPerBatch(){var _;if(maxTexturesPerBatchCache)return maxTexturesPerBatchCache;const et=getTestContext();return maxTexturesPerBatchCache=et.getParameter(et.MAX_TEXTURE_IMAGE_UNITS),maxTexturesPerBatchCache=checkMaxIfStatementsInShader(maxTexturesPerBatchCache,et),(_=et.getExtension("WEBGL_lose_context"))==null||_.loseContext(),maxTexturesPerBatchCache}const cachedGroups={};function getTextureBatchBindGroup(et,_){let _e=2166136261;for(let tt=0;tt<_;tt++)_e^=et[tt].uid,_e=Math.imul(_e,16777619),_e>>>=0;return cachedGroups[_e]||generateTextureBatchBindGroup(et,_,_e)}let maxTextures=0;function generateTextureBatchBindGroup(et,_,_e){const tt={};let nt=0;maxTextures||(maxTextures=getMaxTexturesPerBatch());for(let it=0;it<maxTextures;it++){const st=it<_?et[it]:Texture.EMPTY.source;tt[nt++]=st.source,tt[nt++]=st.style}const rt=new BindGroup(tt);return cachedGroups[_e]=rt,rt}class ViewableBuffer{constructor(_){typeof _=="number"?this.rawBinaryData=new ArrayBuffer(_):_ instanceof Uint8Array?this.rawBinaryData=_.buffer:this.rawBinaryData=_,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(_){return this[`${_}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(_){switch(_){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${_} isn't a valid view type`)}}}function fastCopy(et,_){const _e=et.byteLength/8|0,tt=new Float64Array(et,0,_e);new Float64Array(_,0,_e).set(tt);const rt=et.byteLength-_e*8;if(rt>0){const it=new Uint8Array(et,_e*8,rt);new Uint8Array(_,_e*8,rt).set(it)}}const BLEND_TO_NPM={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var STENCIL_MODES=(et=>(et[et.DISABLED=0]="DISABLED",et[et.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",et[et.MASK_ACTIVE=2]="MASK_ACTIVE",et[et.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",et[et.NONE=4]="NONE",et))(STENCIL_MODES||{});function getAdjustedBlendModeBlend(et,_){return _.alphaMode==="no-premultiply-alpha"&&BLEND_TO_NPM[et]||et}class BatchTextureArray{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let _=0;_<this.count;_++){const _e=this.textures[_];this.textures[_]=null,this.ids[_e.uid]=null}this.count=0}}class Batch{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new BatchTextureArray,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const batchPool=[];let batchPoolIndex=0;function getBatchFromPool(){return batchPoolIndex>0?batchPool[--batchPoolIndex]:new Batch}function returnBatchToPool(et){batchPool[batchPoolIndex++]=et}let BATCH_TICK=0;const _Batcher=class Fu{constructor(_={}){this.uid=uid("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._vertexSize=6,this._elements=[],Fu.defaultOptions.maxTextures=Fu.defaultOptions.maxTextures??getMaxTexturesPerBatch(),_={...Fu.defaultOptions,..._};const{vertexSize:_e,indexSize:tt,maxTextures:nt}=_;this.attributeBuffer=new ViewableBuffer(_e*this._vertexSize*4),this.indexBuffer=new Uint16Array(tt),this.maxTextures=nt}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let _=0;_<this.batchIndex;_++)returnBatchToPool(this.batches[_]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(_){this._elements[this.elementSize++]=_,_.indexStart=this.indexSize,_.location=this.attributeSize,_.batcher=this,this.indexSize+=_.indexSize,this.attributeSize+=_.vertexSize*this._vertexSize}checkAndUpdateTexture(_,_e){const tt=_.batch.textures.ids[_e._source.uid];return!tt&&tt!==0?!1:(_.textureId=tt,_.texture=_e,!0)}updateElement(_){this.dirty=!0,_.packAttributes(this.attributeBuffer.float32View,this.attributeBuffer.uint32View,_.location,_.textureId)}break(_){const _e=this._elements;if(!_e[this.elementStart])return;let tt=getBatchFromPool(),nt=tt.textures;nt.clear();const rt=_e[this.elementStart];let it=getAdjustedBlendModeBlend(rt.blendMode,rt.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const st=this.attributeBuffer.float32View,ot=this.attributeBuffer.uint32View,at=this.indexBuffer;let lt=this._batchIndexSize,ct=this._batchIndexStart,ht="startBatch";const ut=this.maxTextures;for(let ft=this.elementStart;ft<this.elementSize;++ft){const dt=_e[ft];_e[ft]=null;const mt=dt.texture._source,vt=getAdjustedBlendModeBlend(dt.blendMode,mt),yt=it!==vt;if(mt._batchTick===BATCH_TICK&&!yt){dt.textureId=mt._textureBindLocation,lt+=dt.indexSize,dt.packAttributes(st,ot,dt.location,dt.textureId),dt.packIndex(at,dt.indexStart,dt.location/this._vertexSize),dt.batch=tt;continue}mt._batchTick=BATCH_TICK,(nt.count>=ut||yt)&&(this._finishBatch(tt,ct,lt-ct,nt,it,_,ht),ht="renderBatch",ct=lt,it=vt,tt=getBatchFromPool(),nt=tt.textures,nt.clear(),++BATCH_TICK),dt.textureId=mt._textureBindLocation=nt.count,nt.ids[mt.uid]=nt.count,nt.textures[nt.count++]=mt,dt.batch=tt,lt+=dt.indexSize,dt.packAttributes(st,ot,dt.location,dt.textureId),dt.packIndex(at,dt.indexStart,dt.location/this._vertexSize)}nt.count>0&&(this._finishBatch(tt,ct,lt-ct,nt,it,_,ht),ct=lt,++BATCH_TICK),this.elementStart=this.elementSize,this._batchIndexStart=ct,this._batchIndexSize=lt}_finishBatch(_,_e,tt,nt,rt,it,st){_.gpuBindGroup=null,_.bindGroup=null,_.action=st,_.batcher=this,_.textures=nt,_.blendMode=rt,_.start=_e,_.size=tt,++BATCH_TICK,this.batches[this.batchIndex++]=_,it.add(_)}finish(_){this.break(_)}ensureAttributeBuffer(_){_*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(_*4)}ensureIndexBuffer(_){_<=this.indexBuffer.length||this._resizeIndexBuffer(_)}_resizeAttributeBuffer(_){const _e=Math.max(_,this.attributeBuffer.size*2),tt=new ViewableBuffer(_e);fastCopy(this.attributeBuffer.rawBinaryData,tt.rawBinaryData),this.attributeBuffer=tt}_resizeIndexBuffer(_){const _e=this.indexBuffer;let tt=Math.max(_,_e.length*1.5);tt+=tt%2;const nt=tt>65535?new Uint32Array(tt):new Uint16Array(tt);if(nt.BYTES_PER_ELEMENT!==_e.BYTES_PER_ELEMENT)for(let rt=0;rt<_e.length;rt++)nt[rt]=_e[rt];else fastCopy(_e.buffer,nt.buffer);this.indexBuffer=nt}destroy(){for(let _=0;_<this.batches.length;_++)returnBatchToPool(this.batches[_]);this.batches=null;for(let _=0;_<this._elements.length;_++)this._elements[_].batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};_Batcher.defaultOptions={vertexSize:4,indexSize:6,maxTextures:null};let Batcher=_Batcher;var BufferUsage=(et=>(et[et.MAP_READ=1]="MAP_READ",et[et.MAP_WRITE=2]="MAP_WRITE",et[et.COPY_SRC=4]="COPY_SRC",et[et.COPY_DST=8]="COPY_DST",et[et.INDEX=16]="INDEX",et[et.VERTEX=32]="VERTEX",et[et.UNIFORM=64]="UNIFORM",et[et.STORAGE=128]="STORAGE",et[et.INDIRECT=256]="INDIRECT",et[et.QUERY_RESOLVE=512]="QUERY_RESOLVE",et[et.STATIC=1024]="STATIC",et))(BufferUsage||{});let Buffer$1=class extends EventEmitter{constructor(_){let{data:_e,size:tt}=_;const{usage:nt,label:rt,shrinkToFit:it}=_;super(),this.uid=uid("buffer"),this._resourceType="buffer",this._resourceId=uid("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,_e instanceof Array&&(_e=new Float32Array(_e)),this._data=_e,tt=tt??(_e==null?void 0:_e.byteLength);const st=!!_e;this.descriptor={size:tt,usage:nt,mappedAtCreation:st,label:rt},this.shrinkToFit=it??!0}get data(){return this._data}set data(_){this.setDataWithSize(_,_.length,!0)}get static(){return!!(this.descriptor.usage&BufferUsage.STATIC)}set static(_){_?this.descriptor.usage|=BufferUsage.STATIC:this.descriptor.usage&=~BufferUsage.STATIC}setDataWithSize(_,_e,tt){if(this._updateID++,this._updateSize=_e*_.BYTES_PER_ELEMENT,this._data===_){tt&&this.emit("update",this);return}const nt=this._data;if(this._data=_,nt.length!==_.length){!this.shrinkToFit&&_.byteLength<nt.byteLength?tt&&this.emit("update",this):(this.descriptor.size=_.byteLength,this._resourceId=uid("resource"),this.emit("change",this));return}tt&&this.emit("update",this)}update(_){this._updateSize=_??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function ensureIsBuffer(et,_){if(!(et instanceof Buffer$1)){let _e=_?BufferUsage.INDEX:BufferUsage.VERTEX;et instanceof Array&&(_?(et=new Uint32Array(et),_e=BufferUsage.INDEX|BufferUsage.COPY_DST):(et=new Float32Array(et),_e=BufferUsage.VERTEX|BufferUsage.COPY_DST)),et=new Buffer$1({data:et,label:_?"index-mesh-buffer":"vertex-mesh-buffer",usage:_e})}return et}function getGeometryBounds(et,_,_e){const tt=et.getAttribute(_);if(!tt)return _e.minX=0,_e.minY=0,_e.maxX=0,_e.maxY=0,_e;const nt=tt.buffer.data;let rt=1/0,it=1/0,st=-1/0,ot=-1/0;const at=nt.BYTES_PER_ELEMENT,lt=(tt.offset||0)/at,ct=(tt.stride||2*4)/at;for(let ht=lt;ht<nt.length;ht+=ct){const ut=nt[ht],ft=nt[ht+1];ut>st&&(st=ut),ft>ot&&(ot=ft),ut<rt&&(rt=ut),ft<it&&(it=ft)}return _e.minX=rt,_e.minY=it,_e.maxX=st,_e.maxY=ot,_e}function ensureIsAttribute(et){return(et instanceof Buffer$1||Array.isArray(et)||et.BYTES_PER_ELEMENT)&&(et={buffer:et}),et.buffer=ensureIsBuffer(et.buffer,!1),et}class Geometry extends EventEmitter{constructor(_){const{attributes:_e,indexBuffer:tt,topology:nt}=_;super(),this.uid=uid("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Bounds,this._boundsDirty=!0,this.attributes=_e,this.buffers=[],this.instanceCount=_.instanceCount||1;for(const rt in _e){const it=_e[rt]=ensureIsAttribute(_e[rt]);this.buffers.indexOf(it.buffer)===-1&&(this.buffers.push(it.buffer),it.buffer.on("update",this.onBufferUpdate,this),it.buffer.on("change",this.onBufferUpdate,this))}tt&&(this.indexBuffer=ensureIsBuffer(tt,!0),this.buffers.push(this.indexBuffer)),this.topology=nt||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(_){return this.attributes[_]}getIndex(){return this.indexBuffer}getBuffer(_){return this.getAttribute(_).buffer}getSize(){for(const _ in this.attributes){const _e=this.attributes[_];return _e.buffer.data.length/(_e.stride/4||_e.size)}return 0}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,getGeometryBounds(this,"aPosition",this._bounds)):this._bounds}destroy(_=!1){this.emit("destroy",this),this.removeAllListeners(),_&&this.buffers.forEach(_e=>_e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const placeHolderBufferData=new Float32Array(1),placeHolderIndexData=new Uint32Array(1);class BatchGeometry extends Geometry{constructor(){const _e=new Buffer$1({data:placeHolderBufferData,label:"attribute-batch-buffer",usage:BufferUsage.VERTEX|BufferUsage.COPY_DST,shrinkToFit:!1}),tt=new Buffer$1({data:placeHolderIndexData,label:"index-batch-buffer",usage:BufferUsage.INDEX|BufferUsage.COPY_DST,shrinkToFit:!1}),nt=6*4;super({attributes:{aPosition:{buffer:_e,format:"float32x2",stride:nt,offset:0},aUV:{buffer:_e,format:"float32x2",stride:nt,offset:2*4},aColor:{buffer:_e,format:"unorm8x4",stride:nt,offset:4*4},aTextureIdAndRound:{buffer:_e,format:"uint16x2",stride:nt,offset:5*4}},indexBuffer:tt})}}function buildUvs(et,_,_e,tt,nt,rt,it,st=null){let ot=0;_e*=_,nt*=rt;const at=st.a,lt=st.b,ct=st.c,ht=st.d,ut=st.tx,ft=st.ty;for(;ot<it;){const dt=et[_e],pt=et[_e+1];tt[nt]=at*dt+ct*pt+ut,tt[nt+1]=lt*dt+ht*pt+ft,nt+=rt,_e+=_,ot++}}function buildSimpleUvs(et,_,_e,tt){let nt=0;for(_*=_e;nt<tt;)et[_]=0,et[_+1]=0,_+=_e,nt++}function transformVertices(et,_,_e,tt,nt){const rt=_.a,it=_.b,st=_.c,ot=_.d,at=_.tx,lt=_.ty;_e=_e||0,tt=tt||2,nt=nt||et.length/tt-_e;let ct=_e*tt;for(let ht=0;ht<nt;ht++){const ut=et[ct],ft=et[ct+1];et[ct]=rt*ut+st*ft+at,et[ct+1]=it*ut+ot*ft+lt,ct+=tt}}function multiplyHexColors(et,_){if(et===16777215||!_)return _;if(_===16777215||!et)return et;const _e=et>>16&255,tt=et>>8&255,nt=et&255,rt=_>>16&255,it=_>>8&255,st=_&255,ot=_e*rt/255,at=tt*it/255,lt=nt*st/255;return(ot<<16)+(at<<8)+lt}class BatchableGraphics{constructor(){this.batcher=null,this.batch=null,this.applyTransform=!0,this.roundPixels=0}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}packIndex(_,_e,tt){const nt=this.geometryData.indices;for(let rt=0;rt<this.indexSize;rt++)_[_e++]=nt[rt+this.indexOffset]+tt-this.vertexOffset}packAttributes(_,_e,tt,nt){const rt=this.geometryData,it=this.renderable,st=rt.vertices,ot=rt.uvs,at=this.vertexOffset*2,lt=(this.vertexOffset+this.vertexSize)*2,ct=this.color,ht=ct>>16|ct&65280|(ct&255)<<16;if(this.applyTransform){const ut=multiplyHexColors(ht,it.groupColor)+(this.alpha*it.groupAlpha*255<<24),ft=it.groupTransform,dt=nt<<16|this.roundPixels&65535,pt=ft.a,mt=ft.b,vt=ft.c,yt=ft.d,_t=ft.tx,St=ft.ty;for(let bt=at;bt<lt;bt+=2){const Et=st[bt],Mt=st[bt+1];_[tt]=pt*Et+vt*Mt+_t,_[tt+1]=mt*Et+yt*Mt+St,_[tt+2]=ot[bt],_[tt+3]=ot[bt+1],_e[tt+4]=ut,_e[tt+5]=dt,tt+=6}}else{const ut=ht+(this.alpha*255<<24);for(let ft=at;ft<lt;ft+=2)_[tt]=st[ft],_[tt+1]=st[ft+1],_[tt+2]=ot[ft],_[tt+3]=ot[ft+1],_e[tt+4]=ut,_e[tt+5]=nt<<16,tt+=6}}get vertSize(){return this.vertexSize}copyTo(_){_.indexOffset=this.indexOffset,_.indexSize=this.indexSize,_.vertexOffset=this.vertexOffset,_.vertexSize=this.vertexSize,_.color=this.color,_.alpha=this.alpha,_.texture=this.texture,_.geometryData=this.geometryData}reset(){this.applyTransform=!0}}const buildCircle={extension:{type:ExtensionType.ShapeBuilder,name:"circle"},build(et,_){let _e,tt,nt,rt,it,st;if(et.type==="circle"){const _t=et;_e=_t.x,tt=_t.y,it=st=_t.radius,nt=rt=0}else if(et.type==="ellipse"){const _t=et;_e=_t.x,tt=_t.y,it=_t.halfWidth,st=_t.halfHeight,nt=rt=0}else{const _t=et,St=_t.width/2,bt=_t.height/2;_e=_t.x+St,tt=_t.y+bt,it=st=Math.max(0,Math.min(_t.radius,Math.min(St,bt))),nt=St-it,rt=bt-st}if(!(it>=0&&st>=0&&nt>=0&&rt>=0))return _;const ot=Math.ceil(2.3*Math.sqrt(it+st)),at=ot*8+(nt?4:0)+(rt?4:0);if(at===0)return _;if(ot===0)return _[0]=_[6]=_e+nt,_[1]=_[3]=tt+rt,_[2]=_[4]=_e-nt,_[5]=_[7]=tt-rt,_;let lt=0,ct=ot*4+(nt?2:0)+2,ht=ct,ut=at,ft=nt+it,dt=rt,pt=_e+ft,mt=_e-ft,vt=tt+dt;if(_[lt++]=pt,_[lt++]=vt,_[--ct]=vt,_[--ct]=mt,rt){const _t=tt-dt;_[ht++]=mt,_[ht++]=_t,_[--ut]=_t,_[--ut]=pt}for(let _t=1;_t<ot;_t++){const St=Math.PI/2*(_t/ot),bt=nt+Math.cos(St)*it,Et=rt+Math.sin(St)*st,Mt=_e+bt,Tt=_e-bt,wt=tt+Et,Ct=tt-Et;_[lt++]=Mt,_[lt++]=wt,_[--ct]=wt,_[--ct]=Tt,_[ht++]=Tt,_[ht++]=Ct,_[--ut]=Ct,_[--ut]=Mt}ft=nt,dt=rt+st,pt=_e+ft,mt=_e-ft,vt=tt+dt;const yt=tt-dt;return _[lt++]=pt,_[lt++]=vt,_[--ut]=yt,_[--ut]=pt,nt&&(_[lt++]=mt,_[lt++]=vt,_[--ut]=yt,_[--ut]=mt),_},triangulate(et,_,_e,tt,nt,rt){if(et.length===0)return;let it=0,st=0;for(let lt=0;lt<et.length;lt+=2)it+=et[lt],st+=et[lt+1];it/=et.length/2,st/=et.length/2;let ot=tt;_[ot*_e]=it,_[ot*_e+1]=st;const at=ot++;for(let lt=0;lt<et.length;lt+=2)_[ot*_e]=et[lt],_[ot*_e+1]=et[lt+1],lt>0&&(nt[rt++]=ot,nt[rt++]=at,nt[rt++]=ot-1),ot++;nt[rt++]=at+1,nt[rt++]=at,nt[rt++]=ot-1}},buildEllipse={...buildCircle,extension:{...buildCircle.extension,name:"ellipse"}},buildRoundedRectangle={...buildCircle,extension:{...buildCircle.extension,name:"roundedRectangle"}},closePointEps=1e-4,curveEps=1e-4;function getOrientationOfPoints(et){const _=et.length;if(_<6)return 1;let _e=0;for(let tt=0,nt=et[_-2],rt=et[_-1];tt<_;tt+=2){const it=et[tt],st=et[tt+1];_e+=(it-nt)*(st+rt),nt=it,rt=st}return _e<0?-1:1}function square(et,_,_e,tt,nt,rt,it,st){const ot=et-_e*nt,at=_-tt*nt,lt=et+_e*rt,ct=_+tt*rt;let ht,ut;it?(ht=tt,ut=-_e):(ht=-tt,ut=_e);const ft=ot+ht,dt=at+ut,pt=lt+ht,mt=ct+ut;return st.push(ft,dt),st.push(pt,mt),2}function round$1(et,_,_e,tt,nt,rt,it,st){const ot=_e-et,at=tt-_;let lt=Math.atan2(ot,at),ct=Math.atan2(nt-et,rt-_);st&&lt<ct?lt+=Math.PI*2:!st&&lt>ct&&(ct+=Math.PI*2);let ht=lt;const ut=ct-lt,ft=Math.abs(ut),dt=Math.sqrt(ot*ot+at*at),pt=(15*ft*Math.sqrt(dt)/Math.PI>>0)+1,mt=ut/pt;if(ht+=mt,st){it.push(et,_),it.push(_e,tt);for(let vt=1,yt=ht;vt<pt;vt++,yt+=mt)it.push(et,_),it.push(et+Math.sin(yt)*dt,_+Math.cos(yt)*dt);it.push(et,_),it.push(nt,rt)}else{it.push(_e,tt),it.push(et,_);for(let vt=1,yt=ht;vt<pt;vt++,yt+=mt)it.push(et+Math.sin(yt)*dt,_+Math.cos(yt)*dt),it.push(et,_);it.push(nt,rt),it.push(et,_)}return pt*2}function buildLine(et,_,_e,tt,nt,rt,it,st,ot){const at=closePointEps;if(et.length===0)return;const lt=_;let ct=lt.alignment;if(_.alignment!==.5){let Ht=getOrientationOfPoints(et);ct=(ct-.5)*Ht+.5}const ht=new Point(et[0],et[1]),ut=new Point(et[et.length-2],et[et.length-1]),ft=tt,dt=Math.abs(ht.x-ut.x)<at&&Math.abs(ht.y-ut.y)<at;if(ft){et=et.slice(),dt&&(et.pop(),et.pop(),ut.set(et[et.length-2],et[et.length-1]));const Ht=(ht.x+ut.x)*.5,qt=(ut.y+ht.y)*.5;et.unshift(Ht,qt),et.push(Ht,qt)}const pt=nt,mt=et.length/2;let vt=et.length;const yt=pt.length/2,_t=lt.width/2,St=_t*_t,bt=lt.miterLimit*lt.miterLimit;let Et=et[0],Mt=et[1],Tt=et[2],wt=et[3],Ct=0,Rt=0,It=-(Mt-wt),Dt=Et-Tt,Ft=0,$t=0,Yt=Math.sqrt(It*It+Dt*Dt);It/=Yt,Dt/=Yt,It*=_t,Dt*=_t;const Lt=ct,Ot=(1-Lt)*2,Nt=Lt*2;ft||(lt.cap==="round"?vt+=round$1(Et-It*(Ot-Nt)*.5,Mt-Dt*(Ot-Nt)*.5,Et-It*Ot,Mt-Dt*Ot,Et+It*Nt,Mt+Dt*Nt,pt,!0)+2:lt.cap==="square"&&(vt+=square(Et,Mt,It,Dt,Ot,Nt,!0,pt))),pt.push(Et-It*Ot,Mt-Dt*Ot),pt.push(Et+It*Nt,Mt+Dt*Nt);for(let Ht=1;Ht<mt-1;++Ht){Et=et[(Ht-1)*2],Mt=et[(Ht-1)*2+1],Tt=et[Ht*2],wt=et[Ht*2+1],Ct=et[(Ht+1)*2],Rt=et[(Ht+1)*2+1],It=-(Mt-wt),Dt=Et-Tt,Yt=Math.sqrt(It*It+Dt*Dt),It/=Yt,Dt/=Yt,It*=_t,Dt*=_t,Ft=-(wt-Rt),$t=Tt-Ct,Yt=Math.sqrt(Ft*Ft+$t*$t),Ft/=Yt,$t/=Yt,Ft*=_t,$t*=_t;const qt=Tt-Et,Gt=Mt-wt,Xt=Tt-Ct,Zt=Rt-wt,Qt=qt*Xt+Gt*Zt,un=Gt*Xt-Zt*qt,wn=un<0;if(Math.abs(un)<.001*Math.abs(Qt)){pt.push(Tt-It*Ot,wt-Dt*Ot),pt.push(Tt+It*Nt,wt+Dt*Nt),Qt>=0&&(lt.join==="round"?vt+=round$1(Tt,wt,Tt-It*Ot,wt-Dt*Ot,Tt-Ft*Ot,wt-$t*Ot,pt,!1)+4:vt+=2,pt.push(Tt-Ft*Nt,wt-$t*Nt),pt.push(Tt+Ft*Ot,wt+$t*Ot));continue}const Tn=(-It+Et)*(-Dt+wt)-(-It+Tt)*(-Dt+Mt),yn=(-Ft+Ct)*(-$t+wt)-(-Ft+Tt)*(-$t+Rt),Vt=(qt*yn-Xt*Tn)/un,fn=(Zt*Tn-Gt*yn)/un,ln=(Vt-Tt)*(Vt-Tt)+(fn-wt)*(fn-wt),Jt=Tt+(Vt-Tt)*Ot,on=wt+(fn-wt)*Ot,_n=Tt-(Vt-Tt)*Nt,cn=wt-(fn-wt)*Nt,tn=Math.min(qt*qt+Gt*Gt,Xt*Xt+Zt*Zt),Wt=wn?Ot:Nt,Bt=tn+Wt*Wt*St;ln<=Bt?lt.join==="bevel"||ln/St>bt?(wn?(pt.push(Jt,on),pt.push(Tt+It*Nt,wt+Dt*Nt),pt.push(Jt,on),pt.push(Tt+Ft*Nt,wt+$t*Nt)):(pt.push(Tt-It*Ot,wt-Dt*Ot),pt.push(_n,cn),pt.push(Tt-Ft*Ot,wt-$t*Ot),pt.push(_n,cn)),vt+=2):lt.join==="round"?wn?(pt.push(Jt,on),pt.push(Tt+It*Nt,wt+Dt*Nt),vt+=round$1(Tt,wt,Tt+It*Nt,wt+Dt*Nt,Tt+Ft*Nt,wt+$t*Nt,pt,!0)+4,pt.push(Jt,on),pt.push(Tt+Ft*Nt,wt+$t*Nt)):(pt.push(Tt-It*Ot,wt-Dt*Ot),pt.push(_n,cn),vt+=round$1(Tt,wt,Tt-It*Ot,wt-Dt*Ot,Tt-Ft*Ot,wt-$t*Ot,pt,!1)+4,pt.push(Tt-Ft*Ot,wt-$t*Ot),pt.push(_n,cn)):(pt.push(Jt,on),pt.push(_n,cn)):(pt.push(Tt-It*Ot,wt-Dt*Ot),pt.push(Tt+It*Nt,wt+Dt*Nt),lt.join==="round"?wn?vt+=round$1(Tt,wt,Tt+It*Nt,wt+Dt*Nt,Tt+Ft*Nt,wt+$t*Nt,pt,!0)+2:vt+=round$1(Tt,wt,Tt-It*Ot,wt-Dt*Ot,Tt-Ft*Ot,wt-$t*Ot,pt,!1)+2:lt.join==="miter"&&ln/St<=bt&&(wn?(pt.push(_n,cn),pt.push(_n,cn)):(pt.push(Jt,on),pt.push(Jt,on)),vt+=2),pt.push(Tt-Ft*Ot,wt-$t*Ot),pt.push(Tt+Ft*Nt,wt+$t*Nt),vt+=2)}Et=et[(mt-2)*2],Mt=et[(mt-2)*2+1],Tt=et[(mt-1)*2],wt=et[(mt-1)*2+1],It=-(Mt-wt),Dt=Et-Tt,Yt=Math.sqrt(It*It+Dt*Dt),It/=Yt,Dt/=Yt,It*=_t,Dt*=_t,pt.push(Tt-It*Ot,wt-Dt*Ot),pt.push(Tt+It*Nt,wt+Dt*Nt),ft||(lt.cap==="round"?vt+=round$1(Tt-It*(Ot-Nt)*.5,wt-Dt*(Ot-Nt)*.5,Tt-It*Ot,wt-Dt*Ot,Tt+It*Nt,wt+Dt*Nt,pt,!1)+2:lt.cap==="square"&&(vt+=square(Tt,wt,It,Dt,Ot,Nt,!1,pt)));const zt=curveEps*curveEps;for(let Ht=yt;Ht<vt+yt-2;++Ht)Et=pt[Ht*2],Mt=pt[Ht*2+1],Tt=pt[(Ht+1)*2],wt=pt[(Ht+1)*2+1],Ct=pt[(Ht+2)*2],Rt=pt[(Ht+2)*2+1],!(Math.abs(Et*(wt-Rt)+Tt*(Rt-Mt)+Ct*(Mt-wt))<zt)&&st.push(Ht,Ht+1,Ht+2)}function triangulateWithHoles(et,_,_e,tt,nt,rt,it){const st=earcut$1(et,_,2);if(!st)return;for(let at=0;at<st.length;at+=3)rt[it++]=st[at]+nt,rt[it++]=st[at+1]+nt,rt[it++]=st[at+2]+nt;let ot=nt*tt;for(let at=0;at<et.length;at+=2)_e[ot]=et[at],_e[ot+1]=et[at+1],ot+=tt}const emptyArray=[],buildPolygon={extension:{type:ExtensionType.ShapeBuilder,name:"polygon"},build(et,_){for(let _e=0;_e<et.points.length;_e++)_[_e]=et.points[_e];return _},triangulate(et,_,_e,tt,nt,rt){triangulateWithHoles(et,emptyArray,_,_e,tt,nt,rt)}},buildRectangle={extension:{type:ExtensionType.ShapeBuilder,name:"rectangle"},build(et,_){const _e=et,tt=_e.x,nt=_e.y,rt=_e.width,it=_e.height;return rt>=0&&it>=0&&(_[0]=tt,_[1]=nt,_[2]=tt+rt,_[3]=nt,_[4]=tt+rt,_[5]=nt+it,_[6]=tt,_[7]=nt+it),_},triangulate(et,_,_e,tt,nt,rt){let it=0;tt*=_e,_[tt+it]=et[0],_[tt+it+1]=et[1],it+=_e,_[tt+it]=et[2],_[tt+it+1]=et[3],it+=_e,_[tt+it]=et[6],_[tt+it+1]=et[7],it+=_e,_[tt+it]=et[4],_[tt+it+1]=et[5],it+=_e;const st=tt/_e;nt[rt++]=st,nt[rt++]=st+1,nt[rt++]=st+2,nt[rt++]=st+1,nt[rt++]=st+3,nt[rt++]=st+2}},buildTriangle={extension:{type:ExtensionType.ShapeBuilder,name:"triangle"},build(et,_){return _[0]=et.x,_[1]=et.y,_[2]=et.x2,_[3]=et.y2,_[4]=et.x3,_[5]=et.y3,_},triangulate(et,_,_e,tt,nt,rt){let it=0;tt*=_e,_[tt+it]=et[0],_[tt+it+1]=et[1],it+=_e,_[tt+it]=et[2],_[tt+it+1]=et[3],it+=_e,_[tt+it]=et[4],_[tt+it+1]=et[5];const st=tt/_e;nt[rt++]=st,nt[rt++]=st+1,nt[rt++]=st+2}},shapeBuilders={};extensions.handleByMap(ExtensionType.ShapeBuilder,shapeBuilders);extensions.add(buildRectangle,buildPolygon,buildTriangle,buildCircle,buildEllipse,buildRoundedRectangle);const tempRect=new Rectangle;function buildContextBatches(et,_){const{geometryData:_e,batches:tt}=_;tt.length=0,_e.indices.length=0,_e.vertices.length=0,_e.uvs.length=0;for(let nt=0;nt<et.instructions.length;nt++){const rt=et.instructions[nt];if(rt.action==="texture")addTextureToGeometryData(rt.data,tt,_e);else if(rt.action==="fill"||rt.action==="stroke"){const it=rt.action==="stroke",st=rt.data.path.shapePath,ot=rt.data.style,at=rt.data.hole;it&&at&&addShapePathToGeometryData(at.shapePath,ot,null,!0,tt,_e),addShapePathToGeometryData(st,ot,at,it,tt,_e)}}}function addTextureToGeometryData(et,_,_e){const{vertices:tt,uvs:nt,indices:rt}=_e,it=rt.length,st=tt.length/2,ot=[],at=shapeBuilders.rectangle,lt=tempRect,ct=et.image;lt.x=et.dx,lt.y=et.dy,lt.width=et.dw,lt.height=et.dh;const ht=et.transform;at.build(lt,ot),ht&&transformVertices(ot,ht),at.triangulate(ot,tt,2,st,rt,it);const ut=ct.uvs;nt.push(ut.x0,ut.y0,ut.x1,ut.y1,ut.x3,ut.y3,ut.x2,ut.y2);const ft=BigPool.get(BatchableGraphics);ft.indexOffset=it,ft.indexSize=rt.length-it,ft.vertexOffset=st,ft.vertexSize=tt.length/2-st,ft.color=et.style,ft.alpha=et.alpha,ft.texture=ct,ft.geometryData=_e,_.push(ft)}function addShapePathToGeometryData(et,_,_e,tt,nt,rt){const{vertices:it,uvs:st,indices:ot}=rt,at=et.shapePrimitives.length-1;et.shapePrimitives.forEach(({shape:lt,transform:ct},ht)=>{const ut=ot.length,ft=it.length/2,dt=[],pt=shapeBuilders[lt.type];if(pt.build(lt,dt),ct&&transformVertices(dt,ct),tt){const _t=lt.closePath??!0;buildLine(dt,_,!1,_t,it,2,ft,ot)}else if(_e&&at===ht){at!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const _t=[],St=dt.slice();getHoleArrays(_e.shapePath).forEach(Et=>{_t.push(St.length/2),St.push(...Et)}),triangulateWithHoles(St,_t,it,2,ft,ot,ut)}else pt.triangulate(dt,it,2,ft,ot,ut);const mt=st.length/2,vt=_.texture;if(vt!==Texture.WHITE){const _t=_.matrix;_t&&(ct&&_t.append(ct.clone().invert()),buildUvs(it,2,ft,st,mt,2,it.length/2-ft,_t))}else buildSimpleUvs(st,mt,2,it.length/2-ft);const yt=BigPool.get(BatchableGraphics);yt.indexOffset=ut,yt.indexSize=ot.length-ut,yt.vertexOffset=ft,yt.vertexSize=it.length/2-ft,yt.color=_.color,yt.alpha=_.alpha,yt.texture=vt,yt.geometryData=rt,nt.push(yt)})}function getHoleArrays(et){if(!et)return[];const _=et.shapePrimitives,_e=[];for(let tt=0;tt<_.length;tt++){const nt=_[tt].shape,rt=[];shapeBuilders[nt.type].build(nt,rt),_e.push(rt)}return _e}class GpuGraphicsContext{constructor(){this.batcher=new Batcher,this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class GraphicsContextRenderData{constructor(){this.geometry=new BatchGeometry,this.instructions=new InstructionSet}init(){this.instructions.reset()}}const _GraphicsContextSystem=class Lp{constructor(){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null)}init(_){Lp.defaultOptions.bezierSmoothness=(_==null?void 0:_.bezierSmoothness)??Lp.defaultOptions.bezierSmoothness}getContextRenderData(_){return this._graphicsDataContextHash[_.uid]||this._initContextRenderData(_)}updateGpuContext(_){let _e=this._gpuContextHash[_.uid]||this._initContext(_);if(_.dirty){_e?this._cleanGraphicsContextData(_):_e=this._initContext(_),buildContextBatches(_,_e);const tt=_.batchMode;_.customShader||tt==="no-batch"?_e.isBatchable=!1:tt==="auto"&&(_e.isBatchable=_e.geometryData.vertices.length<400),_.dirty=!1}return _e}getGpuContext(_){return this._gpuContextHash[_.uid]||this._initContext(_)}_initContextRenderData(_){const _e=BigPool.get(GraphicsContextRenderData),{batches:tt,geometryData:nt,batcher:rt}=this._gpuContextHash[_.uid],it=nt.vertices.length,st=nt.indices.length;for(let lt=0;lt<tt.length;lt++)tt[lt].applyTransform=!1;rt.ensureAttributeBuffer(it),rt.ensureIndexBuffer(st),rt.begin();for(let lt=0;lt<tt.length;lt++){const ct=tt[lt];rt.add(ct)}rt.finish(_e.instructions);const ot=_e.geometry;ot.indexBuffer.setDataWithSize(rt.indexBuffer,rt.indexSize,!0),ot.buffers[0].setDataWithSize(rt.attributeBuffer.float32View,rt.attributeSize,!0);const at=rt.batches;for(let lt=0;lt<at.length;lt++){const ct=at[lt];ct.bindGroup=getTextureBatchBindGroup(ct.textures.textures,ct.textures.count)}return this._graphicsDataContextHash[_.uid]=_e,_e}_initContext(_){const _e=new GpuGraphicsContext;return _e.context=_,this._gpuContextHash[_.uid]=_e,_.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[_.uid]}onGraphicsContextDestroy(_){this._cleanGraphicsContextData(_),_.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[_.uid]=null}_cleanGraphicsContextData(_){const _e=this._gpuContextHash[_.uid];_e.isBatchable||this._graphicsDataContextHash[_.uid]&&(BigPool.return(this.getContextRenderData(_)),this._graphicsDataContextHash[_.uid]=null),_e.batches&&_e.batches.forEach(tt=>{BigPool.return(tt)})}destroy(){for(const _ in this._gpuContextHash)this._gpuContextHash[_]&&this.onGraphicsContextDestroy(this._gpuContextHash[_].context)}};_GraphicsContextSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:"graphicsContext"};_GraphicsContextSystem.defaultOptions={bezierSmoothness:.5};let GraphicsContextSystem=_GraphicsContextSystem;const RECURSION_LIMIT$1=8,FLT_EPSILON$1=11920929e-14,PATH_DISTANCE_EPSILON$1=1;function buildAdaptiveBezier(et,_,_e,tt,nt,rt,it,st,ot,at){const ct=Math.min(.99,Math.max(0,at??GraphicsContextSystem.defaultOptions.bezierSmoothness));let ht=(PATH_DISTANCE_EPSILON$1-ct)/1;return ht*=ht,begin$1(_,_e,tt,nt,rt,it,st,ot,et,ht),et}function begin$1(et,_,_e,tt,nt,rt,it,st,ot,at){recursive$1(et,_,_e,tt,nt,rt,it,st,ot,at,0),ot.push(it,st)}function recursive$1(et,_,_e,tt,nt,rt,it,st,ot,at,lt){if(lt>RECURSION_LIMIT$1)return;const ct=(et+_e)/2,ht=(_+tt)/2,ut=(_e+nt)/2,ft=(tt+rt)/2,dt=(nt+it)/2,pt=(rt+st)/2,mt=(ct+ut)/2,vt=(ht+ft)/2,yt=(ut+dt)/2,_t=(ft+pt)/2,St=(mt+yt)/2,bt=(vt+_t)/2;if(lt>0){let Et=it-et,Mt=st-_;const Tt=Math.abs((_e-it)*Mt-(tt-st)*Et),wt=Math.abs((nt-it)*Mt-(rt-st)*Et);if(Tt>FLT_EPSILON$1&&wt>FLT_EPSILON$1){if((Tt+wt)*(Tt+wt)<=at*(Et*Et+Mt*Mt)){ot.push(St,bt);return}}else if(Tt>FLT_EPSILON$1){if(Tt*Tt<=at*(Et*Et+Mt*Mt)){ot.push(St,bt);return}}else if(wt>FLT_EPSILON$1){if(wt*wt<=at*(Et*Et+Mt*Mt)){ot.push(St,bt);return}}else if(Et=St-(et+it)/2,Mt=bt-(_+st)/2,Et*Et+Mt*Mt<=at){ot.push(St,bt);return}}recursive$1(et,_,ct,ht,mt,vt,St,bt,ot,at,lt+1),recursive$1(St,bt,yt,_t,dt,pt,it,st,ot,at,lt+1)}const RECURSION_LIMIT=8,FLT_EPSILON=11920929e-14,PATH_DISTANCE_EPSILON=1;function buildAdaptiveQuadratic(et,_,_e,tt,nt,rt,it,st){const at=Math.min(.99,Math.max(0,st??GraphicsContextSystem.defaultOptions.bezierSmoothness));let lt=(PATH_DISTANCE_EPSILON-at)/1;return lt*=lt,begin(_,_e,tt,nt,rt,it,et,lt),et}function begin(et,_,_e,tt,nt,rt,it,st){recursive(it,et,_,_e,tt,nt,rt,st,0),it.push(nt,rt)}function recursive(et,_,_e,tt,nt,rt,it,st,ot){if(ot>RECURSION_LIMIT)return;const at=(_+tt)/2,lt=(_e+nt)/2,ct=(tt+rt)/2,ht=(nt+it)/2,ut=(at+ct)/2,ft=(lt+ht)/2;let dt=rt-_,pt=it-_e;const mt=Math.abs((tt-rt)*pt-(nt-it)*dt);if(mt>FLT_EPSILON){if(mt*mt<=st*(dt*dt+pt*pt)){et.push(ut,ft);return}}else if(dt=ut-(_+rt)/2,pt=ft-(_e+it)/2,dt*dt+pt*pt<=st){et.push(ut,ft);return}recursive(et,_,_e,at,lt,ut,ft,st,ot+1),recursive(et,ut,ft,ct,ht,rt,it,st,ot+1)}function buildArc(et,_,_e,tt,nt,rt,it,st){let ot=Math.abs(nt-rt);(!it&&nt>rt||it&&rt>nt)&&(ot=2*Math.PI-ot),st=st||Math.max(6,Math.floor(6*Math.pow(tt,1/3)*(ot/Math.PI))),st=Math.max(st,3);let at=ot/st,lt=nt;at*=it?-1:1;for(let ct=0;ct<st+1;ct++){const ht=Math.cos(lt),ut=Math.sin(lt),ft=_+ht*tt,dt=_e+ut*tt;et.push(ft,dt),lt+=at}}function buildArcTo(et,_,_e,tt,nt,rt){const it=et[et.length-2],ot=et[et.length-1]-_e,at=it-_,lt=nt-_e,ct=tt-_,ht=Math.abs(ot*ct-at*lt);if(ht<1e-8||rt===0){(et[et.length-2]!==_||et[et.length-1]!==_e)&&et.push(_,_e);return}const ut=ot*ot+at*at,ft=lt*lt+ct*ct,dt=ot*lt+at*ct,pt=rt*Math.sqrt(ut)/ht,mt=rt*Math.sqrt(ft)/ht,vt=pt*dt/ut,yt=mt*dt/ft,_t=pt*ct+mt*at,St=pt*lt+mt*ot,bt=at*(mt+vt),Et=ot*(mt+vt),Mt=ct*(pt+yt),Tt=lt*(pt+yt),wt=Math.atan2(Et-St,bt-_t),Ct=Math.atan2(Tt-St,Mt-_t);buildArc(et,_t+_,St+_e,rt,wt,Ct,at*lt>ct*ot)}const TAU=Math.PI*2,out={centerX:0,centerY:0,ang1:0,ang2:0},mapToEllipse=({x:et,y:_},_e,tt,nt,rt,it,st,ot)=>{et*=_e,_*=tt;const at=nt*et-rt*_,lt=rt*et+nt*_;return ot.x=at+it,ot.y=lt+st,ot};function approxUnitArc(et,_){const _e=_===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(_/4),tt=_===1.5707963267948966?.551915024494:_e,nt=Math.cos(et),rt=Math.sin(et),it=Math.cos(et+_),st=Math.sin(et+_);return[{x:nt-rt*tt,y:rt+nt*tt},{x:it+st*tt,y:st-it*tt},{x:it,y:st}]}const vectorAngle=(et,_,_e,tt)=>{const nt=et*tt-_*_e<0?-1:1;let rt=et*_e+_*tt;return rt>1&&(rt=1),rt<-1&&(rt=-1),nt*Math.acos(rt)},getArcCenter=(et,_,_e,tt,nt,rt,it,st,ot,at,lt,ct,ht)=>{const ut=Math.pow(nt,2),ft=Math.pow(rt,2),dt=Math.pow(lt,2),pt=Math.pow(ct,2);let mt=ut*ft-ut*pt-ft*dt;mt<0&&(mt=0),mt/=ut*pt+ft*dt,mt=Math.sqrt(mt)*(it===st?-1:1);const vt=mt*nt/rt*ct,yt=mt*-rt/nt*lt,_t=at*vt-ot*yt+(et+_e)/2,St=ot*vt+at*yt+(_+tt)/2,bt=(lt-vt)/nt,Et=(ct-yt)/rt,Mt=(-lt-vt)/nt,Tt=(-ct-yt)/rt,wt=vectorAngle(1,0,bt,Et);let Ct=vectorAngle(bt,Et,Mt,Tt);st===0&&Ct>0&&(Ct-=TAU),st===1&&Ct<0&&(Ct+=TAU),ht.centerX=_t,ht.centerY=St,ht.ang1=wt,ht.ang2=Ct};function buildArcToSvg(et,_,_e,tt,nt,rt,it,st=0,ot=0,at=0){if(rt===0||it===0)return;const lt=Math.sin(st*TAU/360),ct=Math.cos(st*TAU/360),ht=ct*(_-tt)/2+lt*(_e-nt)/2,ut=-lt*(_-tt)/2+ct*(_e-nt)/2;if(ht===0&&ut===0)return;rt=Math.abs(rt),it=Math.abs(it);const ft=Math.pow(ht,2)/Math.pow(rt,2)+Math.pow(ut,2)/Math.pow(it,2);ft>1&&(rt*=Math.sqrt(ft),it*=Math.sqrt(ft)),getArcCenter(_,_e,tt,nt,rt,it,ot,at,lt,ct,ht,ut,out);let{ang1:dt,ang2:pt}=out;const{centerX:mt,centerY:vt}=out;let yt=Math.abs(pt)/(TAU/4);Math.abs(1-yt)<1e-7&&(yt=1);const _t=Math.max(Math.ceil(yt),1);pt/=_t;let St=et[et.length-2],bt=et[et.length-1];const Et={x:0,y:0};for(let Mt=0;Mt<_t;Mt++){const Tt=approxUnitArc(dt,pt),{x:wt,y:Ct}=mapToEllipse(Tt[0],rt,it,ct,lt,mt,vt,Et),{x:Rt,y:It}=mapToEllipse(Tt[1],rt,it,ct,lt,mt,vt,Et),{x:Dt,y:Ft}=mapToEllipse(Tt[2],rt,it,ct,lt,mt,vt,Et);buildAdaptiveBezier(et,St,bt,wt,Ct,Rt,It,Dt,Ft),St=Dt,bt=Ft,dt+=pt}}function roundedShapeArc(et,_,_e){const tt=(it,st)=>{const ot=st.x-it.x,at=st.y-it.y,lt=Math.sqrt(ot*ot+at*at),ct=ot/lt,ht=at/lt;return{len:lt,nx:ct,ny:ht}},nt=(it,st)=>{it===0?et.moveTo(st.x,st.y):et.lineTo(st.x,st.y)};let rt=_[_.length-1];for(let it=0;it<_.length;it++){const st=_[it%_.length],ot=st.radius??_e;if(ot<=0){nt(it,st),rt=st;continue}const at=_[(it+1)%_.length],lt=tt(st,rt),ct=tt(st,at);if(lt.len<1e-4||ct.len<1e-4){nt(it,st),rt=st;continue}let ht=Math.asin(lt.nx*ct.ny-lt.ny*ct.nx),ut=1,ft=!1;lt.nx*ct.nx-lt.ny*-ct.ny<0?ht<0?ht=Math.PI+ht:(ht=Math.PI-ht,ut=-1,ft=!0):ht>0&&(ut=-1,ft=!0);const dt=ht/2;let pt,mt=Math.abs(Math.cos(dt)*ot/Math.sin(dt));mt>Math.min(lt.len/2,ct.len/2)?(mt=Math.min(lt.len/2,ct.len/2),pt=Math.abs(mt*Math.sin(dt)/Math.cos(dt))):pt=ot;const vt=st.x+ct.nx*mt+-ct.ny*pt*ut,yt=st.y+ct.ny*mt+ct.nx*pt*ut,_t=Math.atan2(lt.ny,lt.nx)+Math.PI/2*ut,St=Math.atan2(ct.ny,ct.nx)-Math.PI/2*ut;it===0&&et.moveTo(vt+Math.cos(_t)*pt,yt+Math.sin(_t)*pt),et.arc(vt,yt,pt,_t,St,ft),rt=st}}function roundedShapeQuadraticCurve(et,_,_e,tt){const nt=(st,ot)=>Math.sqrt((st.x-ot.x)**2+(st.y-ot.y)**2),rt=(st,ot,at)=>({x:st.x+(ot.x-st.x)*at,y:st.y+(ot.y-st.y)*at}),it=_.length;for(let st=0;st<it;st++){const ot=_[(st+1)%it],at=ot.radius??_e;if(at<=0){st===0?et.moveTo(ot.x,ot.y):et.lineTo(ot.x,ot.y);continue}const lt=_[st],ct=_[(st+2)%it],ht=nt(lt,ot);let ut;if(ht<1e-4)ut=ot;else{const pt=Math.min(ht/2,at);ut=rt(ot,lt,pt/ht)}const ft=nt(ct,ot);let dt;if(ft<1e-4)dt=ot;else{const pt=Math.min(ft/2,at);dt=rt(ot,ct,pt/ft)}st===0?et.moveTo(ut.x,ut.y):et.lineTo(ut.x,ut.y),et.quadraticCurveTo(ot.x,ot.y,dt.x,dt.y,tt)}}const tempRectangle=new Rectangle;class ShapePath{constructor(_){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Bounds,this._graphicsPath2D=_}moveTo(_,_e){return this.startPoly(_,_e),this}lineTo(_,_e){this._ensurePoly();const tt=this._currentPoly.points,nt=tt[tt.length-2],rt=tt[tt.length-1];return(nt!==_||rt!==_e)&&tt.push(_,_e),this}arc(_,_e,tt,nt,rt,it){this._ensurePoly(!1);const st=this._currentPoly.points;return buildArc(st,_,_e,tt,nt,rt,it),this}arcTo(_,_e,tt,nt,rt){this._ensurePoly();const it=this._currentPoly.points;return buildArcTo(it,_,_e,tt,nt,rt),this}arcToSvg(_,_e,tt,nt,rt,it,st){const ot=this._currentPoly.points;return buildArcToSvg(ot,this._currentPoly.lastX,this._currentPoly.lastY,it,st,_,_e,tt,nt,rt),this}bezierCurveTo(_,_e,tt,nt,rt,it,st){this._ensurePoly();const ot=this._currentPoly;return buildAdaptiveBezier(this._currentPoly.points,ot.lastX,ot.lastY,_,_e,tt,nt,rt,it,st),this}quadraticCurveTo(_,_e,tt,nt,rt){this._ensurePoly();const it=this._currentPoly;return buildAdaptiveQuadratic(this._currentPoly.points,it.lastX,it.lastY,_,_e,tt,nt,rt),this}closePath(){return this.endPoly(!0),this}addPath(_,_e){this.endPoly(),_e&&!_e.isIdentity()&&(_=_.clone(!0),_.transform(_e));for(let tt=0;tt<_.instructions.length;tt++){const nt=_.instructions[tt];this[nt.action](...nt.data)}return this}finish(_=!1){this.endPoly(_)}rect(_,_e,tt,nt,rt){return this.drawShape(new Rectangle(_,_e,tt,nt),rt),this}circle(_,_e,tt,nt){return this.drawShape(new Circle(_,_e,tt),nt),this}poly(_,_e,tt){const nt=new Polygon(_);return nt.closePath=_e,this.drawShape(nt,tt),this}regularPoly(_,_e,tt,nt,rt=0,it){nt=Math.max(nt|0,3);const st=-1*Math.PI/2+rt,ot=Math.PI*2/nt,at=[];for(let lt=0;lt<nt;lt++){const ct=lt*ot+st;at.push(_+tt*Math.cos(ct),_e+tt*Math.sin(ct))}return this.poly(at,!0,it),this}roundPoly(_,_e,tt,nt,rt,it=0,st){if(nt=Math.max(nt|0,3),rt<=0)return this.regularPoly(_,_e,tt,nt,it);const ot=tt*Math.sin(Math.PI/nt)-.001;rt=Math.min(rt,ot);const at=-1*Math.PI/2+it,lt=Math.PI*2/nt,ct=(nt-2)*Math.PI/nt/2;for(let ht=0;ht<nt;ht++){const ut=ht*lt+at,ft=_+tt*Math.cos(ut),dt=_e+tt*Math.sin(ut),pt=ut+Math.PI+ct,mt=ut-Math.PI-ct,vt=ft+rt*Math.cos(pt),yt=dt+rt*Math.sin(pt),_t=ft+rt*Math.cos(mt),St=dt+rt*Math.sin(mt);ht===0?this.moveTo(vt,yt):this.lineTo(vt,yt),this.quadraticCurveTo(ft,dt,_t,St,st)}return this.closePath()}roundShape(_,_e,tt=!1,nt){return _.length<3?this:(tt?roundedShapeQuadraticCurve(this,_,_e,nt):roundedShapeArc(this,_,_e),this.closePath())}filletRect(_,_e,tt,nt,rt){if(rt===0)return this.rect(_,_e,tt,nt);const it=Math.min(tt,nt)/2,st=Math.min(it,Math.max(-it,rt)),ot=_+tt,at=_e+nt,lt=st<0?-st:0,ct=Math.abs(st);return this.moveTo(_,_e+ct).arcTo(_+lt,_e+lt,_+ct,_e,ct).lineTo(ot-ct,_e).arcTo(ot-lt,_e+lt,ot,_e+ct,ct).lineTo(ot,at-ct).arcTo(ot-lt,at-lt,_+tt-ct,at,ct).lineTo(_+ct,at).arcTo(_+lt,at-lt,_,at-ct,ct).closePath()}chamferRect(_,_e,tt,nt,rt,it){if(rt<=0)return this.rect(_,_e,tt,nt);const st=Math.min(rt,Math.min(tt,nt)/2),ot=_+tt,at=_e+nt,lt=[_+st,_e,ot-st,_e,ot,_e+st,ot,at-st,ot-st,at,_+st,at,_,at-st,_,_e+st];for(let ct=lt.length-1;ct>=2;ct-=2)lt[ct]===lt[ct-2]&&lt[ct-1]===lt[ct-3]&&lt.splice(ct-1,2);return this.poly(lt,!0,it)}ellipse(_,_e,tt,nt,rt){return this.drawShape(new Ellipse(_,_e,tt,nt),rt),this}roundRect(_,_e,tt,nt,rt,it){return this.drawShape(new RoundedRectangle(_,_e,tt,nt,rt),it),this}drawShape(_,_e){return this.endPoly(),this.shapePrimitives.push({shape:_,transform:_e}),this}startPoly(_,_e){let tt=this._currentPoly;return tt&&this.endPoly(),tt=new Polygon,tt.points.push(_,_e),this._currentPoly=tt,this}endPoly(_=!1){const _e=this._currentPoly;return _e&&_e.points.length>2&&(_e.closePath=_,this.shapePrimitives.push({shape:_e})),this._currentPoly=null,this}_ensurePoly(_=!0){if(!this._currentPoly&&(this._currentPoly=new Polygon,_)){const _e=this.shapePrimitives[this.shapePrimitives.length-1];if(_e){let tt=_e.shape.x,nt=_e.shape.y;if(_e.transform&&!_e.transform.isIdentity()){const rt=_e.transform,it=tt;tt=rt.a*tt+rt.c*nt+rt.tx,nt=rt.b*it+rt.d*nt+rt.ty}this._currentPoly.points.push(tt,nt)}else this._currentPoly.points.push(0,0)}}buildPath(){const _=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let _e=0;_e<_.instructions.length;_e++){const tt=_.instructions[_e];this[tt.action](...tt.data)}this.finish()}get bounds(){const _=this._bounds;_.clear();const _e=this.shapePrimitives;for(let tt=0;tt<_e.length;tt++){const nt=_e[tt],rt=nt.shape.getBounds(tempRectangle);nt.transform?_.addRect(rt,nt.transform):_.addRect(rt)}return _}}class GraphicsPath{constructor(_){this.instructions=[],this.uid=uid("graphicsPath"),this._dirty=!0,typeof _=="string"?SVGToGraphicsPath(_,this):this.instructions=(_==null?void 0:_.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new ShapePath(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(_,_e){return _=_.clone(),this.instructions.push({action:"addPath",data:[_,_e]}),this._dirty=!0,this}arc(..._){return this.instructions.push({action:"arc",data:_}),this._dirty=!0,this}arcTo(..._){return this.instructions.push({action:"arcTo",data:_}),this._dirty=!0,this}arcToSvg(..._){return this.instructions.push({action:"arcToSvg",data:_}),this._dirty=!0,this}bezierCurveTo(..._){return this.instructions.push({action:"bezierCurveTo",data:_}),this._dirty=!0,this}bezierCurveToShort(_,_e,tt,nt,rt){const it=this.instructions[this.instructions.length-1],st=this.getLastPoint(Point.shared);let ot=0,at=0;if(!it||it.action!=="bezierCurveTo")ot=st.x,at=st.y;else{ot=it.data[2],at=it.data[3];const lt=st.x,ct=st.y;ot=lt+(lt-ot),at=ct+(ct-at)}return this.instructions.push({action:"bezierCurveTo",data:[ot,at,_,_e,tt,nt,rt]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(..._){return this.instructions.push({action:"ellipse",data:_}),this._dirty=!0,this}lineTo(..._){return this.instructions.push({action:"lineTo",data:_}),this._dirty=!0,this}moveTo(..._){return this.instructions.push({action:"moveTo",data:_}),this}quadraticCurveTo(..._){return this.instructions.push({action:"quadraticCurveTo",data:_}),this._dirty=!0,this}quadraticCurveToShort(_,_e,tt){const nt=this.instructions[this.instructions.length-1],rt=this.getLastPoint(Point.shared);let it=0,st=0;if(!nt||nt.action!=="quadraticCurveTo")it=rt.x,st=rt.y;else{it=nt.data[0],st=nt.data[1];const ot=rt.x,at=rt.y;it=ot+(ot-it),st=at+(at-st)}return this.instructions.push({action:"quadraticCurveTo",data:[it,st,_,_e,tt]}),this._dirty=!0,this}rect(_,_e,tt,nt,rt){return this.instructions.push({action:"rect",data:[_,_e,tt,nt,rt]}),this._dirty=!0,this}circle(_,_e,tt,nt){return this.instructions.push({action:"circle",data:[_,_e,tt,nt]}),this._dirty=!0,this}roundRect(..._){return this.instructions.push({action:"roundRect",data:_}),this._dirty=!0,this}poly(..._){return this.instructions.push({action:"poly",data:_}),this._dirty=!0,this}regularPoly(..._){return this.instructions.push({action:"regularPoly",data:_}),this._dirty=!0,this}roundPoly(..._){return this.instructions.push({action:"roundPoly",data:_}),this._dirty=!0,this}roundShape(..._){return this.instructions.push({action:"roundShape",data:_}),this._dirty=!0,this}filletRect(..._){return this.instructions.push({action:"filletRect",data:_}),this._dirty=!0,this}chamferRect(..._){return this.instructions.push({action:"chamferRect",data:_}),this._dirty=!0,this}star(_,_e,tt,nt,rt,it,st){rt=rt||nt/2;const ot=-1*Math.PI/2+it,at=tt*2,lt=Math.PI*2/at,ct=[];for(let ht=0;ht<at;ht++){const ut=ht%2?rt:nt,ft=ht*lt+ot;ct.push(_+ut*Math.cos(ft),_e+ut*Math.sin(ft))}return this.poly(ct,!0,st),this}clone(_=!1){const _e=new GraphicsPath;if(!_)_e.instructions=this.instructions.slice();else for(let tt=0;tt<this.instructions.length;tt++){const nt=this.instructions[tt];_e.instructions.push({action:nt.action,data:nt.data.slice()})}return _e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(_){if(_.isIdentity())return this;const _e=_.a,tt=_.b,nt=_.c,rt=_.d,it=_.tx,st=_.ty;let ot=0,at=0,lt=0,ct=0,ht=0,ut=0,ft=0,dt=0;for(let pt=0;pt<this.instructions.length;pt++){const mt=this.instructions[pt],vt=mt.data;switch(mt.action){case"moveTo":case"lineTo":ot=vt[0],at=vt[1],vt[0]=_e*ot+nt*at+it,vt[1]=tt*ot+rt*at+st;break;case"bezierCurveTo":lt=vt[0],ct=vt[1],ht=vt[2],ut=vt[3],ot=vt[4],at=vt[5],vt[0]=_e*lt+nt*ct+it,vt[1]=tt*lt+rt*ct+st,vt[2]=_e*ht+nt*ut+it,vt[3]=tt*ht+rt*ut+st,vt[4]=_e*ot+nt*at+it,vt[5]=tt*ot+rt*at+st;break;case"quadraticCurveTo":lt=vt[0],ct=vt[1],ot=vt[2],at=vt[3],vt[0]=_e*lt+nt*ct+it,vt[1]=tt*lt+rt*ct+st,vt[2]=_e*ot+nt*at+it,vt[3]=tt*ot+rt*at+st;break;case"arcToSvg":ot=vt[5],at=vt[6],ft=vt[0],dt=vt[1],vt[0]=_e*ft+nt*dt,vt[1]=tt*ft+rt*dt,vt[5]=_e*ot+nt*at+it,vt[6]=tt*ot+rt*at+st;break;case"circle":vt[4]=adjustTransform(vt[3],_);break;case"rect":vt[4]=adjustTransform(vt[4],_);break;case"ellipse":vt[8]=adjustTransform(vt[8],_);break;case"roundRect":vt[5]=adjustTransform(vt[5],_);break;case"addPath":vt[0].transform(_);break;case"poly":vt[2]=adjustTransform(vt[2],_);break;default:warn("unknown transform action",mt.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(_){let _e=this.instructions.length-1,tt=this.instructions[_e];if(!tt)return _.x=0,_.y=0,_;for(;tt.action==="closePath";){if(_e--,_e<0)return _.x=0,_.y=0,_;tt=this.instructions[_e]}switch(tt.action){case"moveTo":case"lineTo":_.x=tt.data[0],_.y=tt.data[1];break;case"quadraticCurveTo":_.x=tt.data[2],_.y=tt.data[3];break;case"bezierCurveTo":_.x=tt.data[4],_.y=tt.data[5];break;case"arc":case"arcToSvg":_.x=tt.data[5],_.y=tt.data[6];break;case"addPath":tt.data[0].getLastPoint(_);break}return _}}function adjustTransform(et,_){return et?et.prepend(_):_.clone()}function SVGParser(et,_){if(typeof et=="string"){const tt=document.createElement("div");tt.innerHTML=et.trim(),et=tt.querySelector("svg")}const _e={context:_,path:new GraphicsPath};return renderChildren(et,_e,null,null),_}function renderChildren(et,_,_e,tt){const nt=et.children,{fillStyle:rt,strokeStyle:it}=parseStyle(et);rt&&_e?_e={..._e,...rt}:rt&&(_e=rt),it&&tt?tt={...tt,...it}:it&&(tt=it),_.context.fillStyle=_e,_.context.strokeStyle=tt;let st,ot,at,lt,ct,ht,ut,ft,dt,pt,mt,vt,yt,_t,St,bt,Et;switch(et.nodeName.toLowerCase()){case"path":_t=et.getAttribute("d"),St=new GraphicsPath(_t),_.context.path(St),_e&&_.context.fill(),tt&&_.context.stroke();break;case"circle":ut=parseFloatAttribute(et,"cx",0),ft=parseFloatAttribute(et,"cy",0),dt=parseFloatAttribute(et,"r",0),_.context.ellipse(ut,ft,dt,dt),_e&&_.context.fill(),tt&&_.context.stroke();break;case"rect":st=parseFloatAttribute(et,"x",0),ot=parseFloatAttribute(et,"y",0),bt=parseFloatAttribute(et,"width",0),Et=parseFloatAttribute(et,"height",0),pt=parseFloatAttribute(et,"rx",0),mt=parseFloatAttribute(et,"ry",0),pt||mt?_.context.roundRect(st,ot,bt,Et,pt||mt):_.context.rect(st,ot,bt,Et),_e&&_.context.fill(),tt&&_.context.stroke();break;case"ellipse":ut=parseFloatAttribute(et,"cx",0),ft=parseFloatAttribute(et,"cy",0),pt=parseFloatAttribute(et,"rx",0),mt=parseFloatAttribute(et,"ry",0),_.context.beginPath(),_.context.ellipse(ut,ft,pt,mt),_e&&_.context.fill(),tt&&_.context.stroke();break;case"line":at=parseFloatAttribute(et,"x1",0),lt=parseFloatAttribute(et,"y1",0),ct=parseFloatAttribute(et,"x2",0),ht=parseFloatAttribute(et,"y2",0),_.context.beginPath(),_.context.moveTo(at,lt),_.context.lineTo(ct,ht),tt&&_.context.stroke();break;case"polygon":yt=et.getAttribute("points"),vt=yt.match(/\d+/g).map(Mt=>parseInt(Mt,10)),_.context.poly(vt,!0),_e&&_.context.fill(),tt&&_.context.stroke();break;case"polyline":yt=et.getAttribute("points"),vt=yt.match(/\d+/g).map(Mt=>parseInt(Mt,10)),_.context.poly(vt,!1),tt&&_.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${et.nodeName}> elements unsupported`);break}}for(let Mt=0;Mt<nt.length;Mt++)renderChildren(nt[Mt],_,_e,tt)}function parseFloatAttribute(et,_,_e){const tt=et.getAttribute(_);return tt?Number(tt):_e}function parseStyle(et){const _=et.getAttribute("style"),_e={},tt={};let nt=!1,rt=!1;if(_){const it=_.split(";");for(let st=0;st<it.length;st++){const ot=it[st],[at,lt]=ot.split(":");switch(at){case"stroke":lt!=="none"&&(_e.color=Color.shared.setValue(lt).toNumber(),rt=!0);break;case"stroke-width":_e.width=Number(lt);break;case"fill":lt!=="none"&&(nt=!0,tt.color=Color.shared.setValue(lt).toNumber());break;case"fill-opacity":tt.alpha=Number(lt);break;case"stroke-opacity":_e.alpha=Number(lt);break;case"opacity":tt.alpha=Number(lt),_e.alpha=Number(lt);break}}}else{const it=et.getAttribute("stroke");it&&it!=="none"&&(rt=!0,_e.color=Color.shared.setValue(it).toNumber(),_e.width=parseFloatAttribute(et,"stroke-width",1));const st=et.getAttribute("fill");st&&st!=="none"&&(nt=!0,tt.color=Color.shared.setValue(st).toNumber())}return{strokeStyle:rt?_e:null,fillStyle:nt?tt:null}}function isColorLike(et){return Color.isColorLike(et)}function isFillPattern(et){return et instanceof FillPattern}function isFillGradient(et){return et instanceof FillGradient}function handleColorLike(et,_,_e){const tt=Color.shared.setValue(_??0);return et.color=tt.toNumber(),et.alpha=tt.alpha===1?_e.alpha:tt.alpha,et.texture=Texture.WHITE,{..._e,...et}}function handleFillPattern(et,_,_e){return et.fill=_,et.color=16777215,et.texture=_.texture,et.matrix=_.transform,{..._e,...et}}function handleFillGradient(et,_,_e){return _.buildLinearGradient(),et.fill=_,et.color=16777215,et.texture=_.texture,et.matrix=_.transform,{..._e,...et}}function handleFillObject(et,_){var nt;const _e={..._,...et};if(_e.texture){if(_e.texture!==Texture.WHITE){const it=((nt=_e.matrix)==null?void 0:nt.invert())||new Matrix$4;it.translate(_e.texture.frame.x,_e.texture.frame.y),it.scale(1/_e.texture.source.width,1/_e.texture.source.height),_e.matrix=it}const rt=_e.texture.source.style;rt.addressMode==="clamp-to-edge"&&(rt.addressMode="repeat",rt.update())}const tt=Color.shared.setValue(_e.color);return _e.alpha*=tt.alpha,_e.color=tt.toNumber(),_e.matrix=_e.matrix?_e.matrix.clone():null,_e}function toFillStyle(et,_){if(et==null)return null;const _e={},tt=et;return isColorLike(et)?handleColorLike(_e,et,_):isFillPattern(et)?handleFillPattern(_e,et,_):isFillGradient(et)?handleFillGradient(_e,et,_):tt.fill&&isFillPattern(tt.fill)?handleFillPattern(tt,tt.fill,_):tt.fill&&isFillGradient(tt.fill)?handleFillGradient(tt,tt.fill,_):handleFillObject(tt,_)}function toStrokeStyle(et,_){const{width:_e,alignment:tt,miterLimit:nt,cap:rt,join:it,...st}=_,ot=toFillStyle(et,st);return ot?{width:_e,alignment:tt,miterLimit:nt,cap:rt,join:it,...ot}:null}const tmpPoint=new Point,tempMatrix=new Matrix$4,_GraphicsContext=class Qs extends EventEmitter{constructor(){super(...arguments),this.uid=uid("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new GraphicsPath,this._transform=new Matrix$4,this._fillStyle={...Qs.defaultFillStyle},this._strokeStyle={...Qs.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Bounds,this._boundsDirty=!0}clone(){const _=new Qs;return _.batchMode=this.batchMode,_.instructions=this.instructions.slice(),_._activePath=this._activePath.clone(),_._transform=this._transform.clone(),_._fillStyle={...this._fillStyle},_._strokeStyle={...this._strokeStyle},_._stateStack=this._stateStack.slice(),_._bounds=this._bounds.clone(),_._boundsDirty=!0,_}get fillStyle(){return this._fillStyle}set fillStyle(_){this._fillStyle=toFillStyle(_,Qs.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(_){this._strokeStyle=toStrokeStyle(_,Qs.defaultStrokeStyle)}setFillStyle(_){return this._fillStyle=toFillStyle(_,Qs.defaultFillStyle),this}setStrokeStyle(_){return this._strokeStyle=toFillStyle(_,Qs.defaultStrokeStyle),this}texture(_,_e,tt,nt,rt,it){return this.instructions.push({action:"texture",data:{image:_,dx:tt||0,dy:nt||0,dw:rt||_.frame.width,dh:it||_.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:_e?Color.shared.setValue(_e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new GraphicsPath,this}fill(_,_e){let tt;const nt=this.instructions[this.instructions.length-1];return this._tick===0&&nt&&nt.action==="stroke"?tt=nt.data.path:tt=this._activePath.clone(),tt?(_!=null&&(_e!==void 0&&typeof _=="number"&&(deprecation(v8_0_0,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),_={color:_,alpha:_e}),this._fillStyle=toFillStyle(_,Qs.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:tt}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:_,y:_e}=this._activePath.getLastPoint(Point.shared);this._activePath.clear(),this._activePath.moveTo(_,_e)}stroke(_){let _e;const tt=this.instructions[this.instructions.length-1];return this._tick===0&&tt&&tt.action==="fill"?_e=tt.data.path:_e=this._activePath.clone(),_e?(_!=null&&(this._strokeStyle=toStrokeStyle(_,Qs.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:_e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let _=0;_<2;_++){const _e=this.instructions[this.instructions.length-1-_],tt=this._activePath.clone();if(_e&&(_e.action==="stroke"||_e.action==="fill"))if(_e.data.hole)_e.data.hole.addPath(tt);else{_e.data.hole=tt;break}}return this._initNextPathLocation(),this}arc(_,_e,tt,nt,rt,it){this._tick++;const st=this._transform;return this._activePath.arc(st.a*_+st.c*_e+st.tx,st.b*_+st.d*_e+st.ty,tt,nt,rt,it),this}arcTo(_,_e,tt,nt,rt){this._tick++;const it=this._transform;return this._activePath.arcTo(it.a*_+it.c*_e+it.tx,it.b*_+it.d*_e+it.ty,it.a*tt+it.c*nt+it.tx,it.b*tt+it.d*nt+it.ty,rt),this}arcToSvg(_,_e,tt,nt,rt,it,st){this._tick++;const ot=this._transform;return this._activePath.arcToSvg(_,_e,tt,nt,rt,ot.a*it+ot.c*st+ot.tx,ot.b*it+ot.d*st+ot.ty),this}bezierCurveTo(_,_e,tt,nt,rt,it,st){this._tick++;const ot=this._transform;return this._activePath.bezierCurveTo(ot.a*_+ot.c*_e+ot.tx,ot.b*_+ot.d*_e+ot.ty,ot.a*tt+ot.c*nt+ot.tx,ot.b*tt+ot.d*nt+ot.ty,ot.a*rt+ot.c*it+ot.tx,ot.b*rt+ot.d*it+ot.ty,st),this}closePath(){var _;return this._tick++,(_=this._activePath)==null||_.closePath(),this}ellipse(_,_e,tt,nt){return this._tick++,this._activePath.ellipse(_,_e,tt,nt,this._transform.clone()),this}circle(_,_e,tt){return this._tick++,this._activePath.circle(_,_e,tt,this._transform.clone()),this}path(_){return this._tick++,this._activePath.addPath(_,this._transform.clone()),this}lineTo(_,_e){this._tick++;const tt=this._transform;return this._activePath.lineTo(tt.a*_+tt.c*_e+tt.tx,tt.b*_+tt.d*_e+tt.ty),this}moveTo(_,_e){this._tick++;const tt=this._transform,nt=this._activePath.instructions,rt=tt.a*_+tt.c*_e+tt.tx,it=tt.b*_+tt.d*_e+tt.ty;return nt.length===1&&nt[0].action==="moveTo"?(nt[0].data[0]=rt,nt[0].data[1]=it,this):(this._activePath.moveTo(rt,it),this)}quadraticCurveTo(_,_e,tt,nt,rt){this._tick++;const it=this._transform;return this._activePath.quadraticCurveTo(it.a*_+it.c*_e+it.tx,it.b*_+it.d*_e+it.ty,it.a*tt+it.c*nt+it.tx,it.b*tt+it.d*nt+it.ty,rt),this}rect(_,_e,tt,nt){return this._tick++,this._activePath.rect(_,_e,tt,nt,this._transform.clone()),this}roundRect(_,_e,tt,nt,rt){return this._tick++,this._activePath.roundRect(_,_e,tt,nt,rt,this._transform.clone()),this}poly(_,_e){return this._tick++,this._activePath.poly(_,_e,this._transform.clone()),this}regularPoly(_,_e,tt,nt,rt=0,it){return this._tick++,this._activePath.regularPoly(_,_e,tt,nt,rt,it),this}roundPoly(_,_e,tt,nt,rt,it){return this._tick++,this._activePath.roundPoly(_,_e,tt,nt,rt,it),this}roundShape(_,_e,tt,nt){return this._tick++,this._activePath.roundShape(_,_e,tt,nt),this}filletRect(_,_e,tt,nt,rt){return this._tick++,this._activePath.filletRect(_,_e,tt,nt,rt),this}chamferRect(_,_e,tt,nt,rt,it){return this._tick++,this._activePath.chamferRect(_,_e,tt,nt,rt,it),this}star(_,_e,tt,nt,rt=0,it=0){return this._tick++,this._activePath.star(_,_e,tt,nt,rt,it,this._transform.clone()),this}svg(_){return this._tick++,SVGParser(_,this),this}restore(){const _=this._stateStack.pop();return _&&(this._transform=_.transform,this._fillStyle=_.fillStyle,this._strokeStyle=_.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(_){return this._transform.rotate(_),this}scale(_,_e=_){return this._transform.scale(_,_e),this}setTransform(_,_e,tt,nt,rt,it){return _ instanceof Matrix$4?(this._transform.set(_.a,_.b,_.c,_.d,_.tx,_.ty),this):(this._transform.set(_,_e,tt,nt,rt,it),this)}transform(_,_e,tt,nt,rt,it){return _ instanceof Matrix$4?(this._transform.append(_),this):(tempMatrix.set(_,_e,tt,nt,rt,it),this._transform.append(tempMatrix),this)}translate(_,_e=_){return this._transform.translate(_,_e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const _=this._bounds;_.clear();for(let _e=0;_e<this.instructions.length;_e++){const tt=this.instructions[_e],nt=tt.action;if(nt==="fill"){const rt=tt.data;_.addBounds(rt.path.bounds)}else if(nt==="texture"){const rt=tt.data;_.addFrame(rt.dx,rt.dy,rt.dx+rt.dw,rt.dy+rt.dh,rt.transform)}if(nt==="stroke"){const rt=tt.data,it=rt.style.width/2,st=rt.path.bounds;_.addFrame(st.minX-it,st.minY-it,st.maxX+it,st.maxY+it)}}return _}containsPoint(_){var nt;if(!this.bounds.containsPoint(_.x,_.y))return!1;const _e=this.instructions;let tt=!1;for(let rt=0;rt<_e.length;rt++){const it=_e[rt],st=it.data,ot=st.path;if(!it.action||!ot)continue;const at=st.style,lt=ot.shapePath.shapePrimitives;for(let ct=0;ct<lt.length;ct++){const ht=lt[ct].shape;if(!at||!ht)continue;const ut=lt[ct].transform,ft=ut?ut.applyInverse(_,tmpPoint):_;it.action==="fill"?tt=ht.contains(ft.x,ft.y):tt=ht.strokeContains(ft.x,ft.y,at.width);const dt=st.hole;if(dt){const pt=(nt=dt.shapePath)==null?void 0:nt.shapePrimitives;if(pt)for(let mt=0;mt<pt.length;mt++)pt[mt].shape.contains(ft.x,ft.y)&&(tt=!1)}if(tt)return!0}}return tt}destroy(_=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof _=="boolean"?_:_==null?void 0:_.texture){const tt=typeof _=="boolean"?_:_==null?void 0:_.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(tt),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(tt)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};_GraphicsContext.defaultFillStyle={color:16777215,alpha:1,texture:Texture.WHITE,matrix:null,fill:null};_GraphicsContext.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Texture.WHITE,matrix:null,fill:null};let GraphicsContext=_GraphicsContext;const valuesToIterateForKeys=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function generateTextStyleKey(et){const _=[];let _e=0;for(let tt=0;tt<valuesToIterateForKeys.length;tt++){const nt=`_${valuesToIterateForKeys[tt]}`;_[_e++]=et[nt]}return _e=addFillStyleKey(et._fill,_,_e),_e=addStokeStyleKey(et._stroke,_,_e),_e=addDropShadowKey(et.dropShadow,_,_e),_.join("-")}function addFillStyleKey(et,_,_e){var tt;return et&&(_[_e++]=et.color,_[_e++]=et.alpha,_[_e++]=(tt=et.fill)==null?void 0:tt.styleKey),_e}function addStokeStyleKey(et,_,_e){return et&&(_e=addFillStyleKey(et,_,_e),_[_e++]=et.width,_[_e++]=et.alignment,_[_e++]=et.cap,_[_e++]=et.join,_[_e++]=et.miterLimit),_e}function addDropShadowKey(et,_,_e){return et&&(_[_e++]=et.alpha,_[_e++]=et.angle,_[_e++]=et.blur,_[_e++]=et.distance,_[_e++]=Color.shared.setValue(et.color).toNumber()),_e}const _TextStyle=class na extends EventEmitter{constructor(_={}){super(),convertV7Tov8Style(_);const _e={...na.defaultTextStyle,..._};for(const tt in _e){const nt=tt;this[nt]=_e[tt]}this.update()}get align(){return this._align}set align(_){this._align=_,this.update()}get breakWords(){return this._breakWords}set breakWords(_){this._breakWords=_,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(_){_!==null&&typeof _=="object"?this._dropShadow=this._createProxy({...na.defaultDropShadow,..._}):this._dropShadow=_?this._createProxy({...na.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(_){this._fontFamily=_,this.update()}get fontSize(){return this._fontSize}set fontSize(_){typeof _=="string"?this._fontSize=parseInt(_,10):this._fontSize=_,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(_){this._fontStyle=_,this.update()}get fontVariant(){return this._fontVariant}set fontVariant(_){this._fontVariant=_,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(_){this._fontWeight=_,this.update()}get leading(){return this._leading}set leading(_){this._leading=_,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(_){this._letterSpacing=_,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(_){this._lineHeight=_,this.update()}get padding(){return this._padding}set padding(_){this._padding=_,this.update()}get trim(){return this._trim}set trim(_){this._trim=_,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(_){this._textBaseline=_,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(_){this._whiteSpace=_,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(_){this._wordWrap=_,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(_){this._wordWrapWidth=_,this.update()}get fill(){return this._originalFill}set fill(_){_!==this._originalFill&&(this._originalFill=_,this._isFillStyle(_)&&(this._originalFill=this._createProxy({...GraphicsContext.defaultFillStyle,..._},()=>{this._fill=toFillStyle({...this._originalFill},GraphicsContext.defaultFillStyle)})),this._fill=toFillStyle(_===0?"black":_,GraphicsContext.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(_){_!==this._originalStroke&&(this._originalStroke=_,this._isFillStyle(_)&&(this._originalStroke=this._createProxy({...GraphicsContext.defaultStrokeStyle,..._},()=>{this._stroke=toStrokeStyle({...this._originalStroke},GraphicsContext.defaultStrokeStyle)})),this._stroke=toStrokeStyle(_,GraphicsContext.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=generateTextStyleKey(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const _=na.defaultTextStyle;for(const _e in _)this[_e]=_[_e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new na({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(_=!1){var tt,nt,rt,it;if(this.removeAllListeners(),typeof _=="boolean"?_:_==null?void 0:_.texture){const st=typeof _=="boolean"?_:_==null?void 0:_.textureSource;(tt=this._fill)!=null&&tt.texture&&this._fill.texture.destroy(st),(nt=this._originalFill)!=null&&nt.texture&&this._originalFill.texture.destroy(st),(rt=this._stroke)!=null&&rt.texture&&this._stroke.texture.destroy(st),(it=this._originalStroke)!=null&&it.texture&&this._originalStroke.texture.destroy(st)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(_,_e){return new Proxy(_,{set:(tt,nt,rt)=>(tt[nt]=rt,_e==null||_e(nt,rt),this.update(),!0)})}_isFillStyle(_){return(_??null)!==null&&!(Color.isColorLike(_)||_ instanceof FillGradient||_ instanceof FillPattern)}};_TextStyle.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};_TextStyle.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let TextStyle=_TextStyle;function convertV7Tov8Style(et){const _=et;if(typeof _.dropShadow=="boolean"&&_.dropShadow){const _e=TextStyle.defaultDropShadow;et.dropShadow={alpha:_.dropShadowAlpha??_e.alpha,angle:_.dropShadowAngle??_e.angle,blur:_.dropShadowBlur??_e.blur,color:_.dropShadowColor??_e.color,distance:_.dropShadowDistance??_e.distance}}if(_.strokeThickness!==void 0){deprecation(v8_0_0,"strokeThickness is now a part of stroke");const _e=_.stroke;let tt={};if(Color.isColorLike(_e))tt.color=_e;else if(_e instanceof FillGradient||_e instanceof FillPattern)tt.fill=_e;else if(Object.hasOwnProperty.call(_e,"color")||Object.hasOwnProperty.call(_e,"fill"))tt=_e;else throw new Error("Invalid stroke value.");et.stroke={...tt,width:_.strokeThickness}}if(Array.isArray(_.fillGradientStops)){deprecation(v8_0_0,"gradient fill is now a fill pattern: `new FillGradient(...)`");let _e;et.fontSize==null?et.fontSize=TextStyle.defaultTextStyle.fontSize:typeof et.fontSize=="string"?_e=parseInt(et.fontSize,10):_e=et.fontSize;const tt=new FillGradient(0,0,0,_e*1.7),nt=_.fillGradientStops.map(rt=>Color.shared.setValue(rt).toNumber());nt.forEach((rt,it)=>{const st=it/(nt.length-1);tt.addColorStop(st,rt)}),et.fill={fill:tt}}}const genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function fontStringFromTextStyle(et){const _=typeof et.fontSize=="number"?`${et.fontSize}px`:et.fontSize;let _e=et.fontFamily;Array.isArray(et.fontFamily)||(_e=et.fontFamily.split(","));for(let tt=_e.length-1;tt>=0;tt--){let nt=_e[tt].trim();!/([\"\'])[^\'\"]+\1/.test(nt)&&!genericFontFamilies.includes(nt)&&(nt=`"${nt}"`),_e[tt]=nt}return`${et.fontStyle} ${et.fontVariant} ${et.fontWeight} ${_} ${_e.join(",")}`}const contextSettings={willReadFrequently:!0},_CanvasTextMetrics=class cr{static get experimentalLetterSpacingSupported(){let _=cr._experimentalLetterSpacingSupported;if(_!==void 0){const _e=DOMAdapter.get().getCanvasRenderingContext2D().prototype;_=cr._experimentalLetterSpacingSupported="letterSpacing"in _e||"textLetterSpacing"in _e}return _}constructor(_,_e,tt,nt,rt,it,st,ot,at){this.text=_,this.style=_e,this.width=tt,this.height=nt,this.lines=rt,this.lineWidths=it,this.lineHeight=st,this.maxLineWidth=ot,this.fontProperties=at}static measureText(_=" ",_e,tt=cr._canvas,nt=_e.wordWrap){var vt;const rt=`${_}:${_e.styleKey}`;if(cr._measurementCache[rt])return cr._measurementCache[rt];const it=fontStringFromTextStyle(_e),st=cr.measureFont(it);st.fontSize===0&&(st.fontSize=_e.fontSize,st.ascent=_e.fontSize);const ot=cr.__context;ot.font=it;const lt=(nt?cr._wordWrap(_,_e,tt):_).split(/(?:\r\n|\r|\n)/),ct=new Array(lt.length);let ht=0;for(let yt=0;yt<lt.length;yt++){const _t=cr._measureText(lt[yt],_e.letterSpacing,ot);ct[yt]=_t,ht=Math.max(ht,_t)}const ut=((vt=_e._stroke)==null?void 0:vt.width)||0;let ft=ht+ut;_e.dropShadow&&(ft+=_e.dropShadow.distance);const dt=_e.lineHeight||st.fontSize;let pt=Math.max(dt,st.fontSize+ut)+(lt.length-1)*(dt+_e.leading);return _e.dropShadow&&(pt+=_e.dropShadow.distance),new cr(_,_e,ft,pt,lt,ct,dt+_e.leading,ht,st)}static _measureText(_,_e,tt){let nt=!1;cr.experimentalLetterSpacingSupported&&(cr.experimentalLetterSpacing?(tt.letterSpacing=`${_e}px`,tt.textLetterSpacing=`${_e}px`,nt=!0):(tt.letterSpacing="0px",tt.textLetterSpacing="0px"));let rt=tt.measureText(_).width;return rt>0&&(nt?rt-=_e:rt+=(cr.graphemeSegmenter(_).length-1)*_e),rt}static _wordWrap(_,_e,tt=cr._canvas){const nt=tt.getContext("2d",contextSettings);let rt=0,it="",st="";const ot=Object.create(null),{letterSpacing:at,whiteSpace:lt}=_e,ct=cr._collapseSpaces(lt),ht=cr._collapseNewlines(lt);let ut=!ct;const ft=_e.wordWrapWidth+at,dt=cr._tokenize(_);for(let pt=0;pt<dt.length;pt++){let mt=dt[pt];if(cr._isNewline(mt)){if(!ht){st+=cr._addLine(it),ut=!ct,it="",rt=0;continue}mt=" "}if(ct){const yt=cr.isBreakingSpace(mt),_t=cr.isBreakingSpace(it[it.length-1]);if(yt&&_t)continue}const vt=cr._getFromCache(mt,at,ot,nt);if(vt>ft)if(it!==""&&(st+=cr._addLine(it),it="",rt=0),cr.canBreakWords(mt,_e.breakWords)){const yt=cr.wordWrapSplit(mt);for(let _t=0;_t<yt.length;_t++){let St=yt[_t],bt=St,Et=1;for(;yt[_t+Et];){const Tt=yt[_t+Et];if(!cr.canBreakChars(bt,Tt,mt,_t,_e.breakWords))St+=Tt;else break;bt=Tt,Et++}_t+=Et-1;const Mt=cr._getFromCache(St,at,ot,nt);Mt+rt>ft&&(st+=cr._addLine(it),ut=!1,it="",rt=0),it+=St,rt+=Mt}}else{it.length>0&&(st+=cr._addLine(it),it="",rt=0);const yt=pt===dt.length-1;st+=cr._addLine(mt,!yt),ut=!1,it="",rt=0}else vt+rt>ft&&(ut=!1,st+=cr._addLine(it),it="",rt=0),(it.length>0||!cr.isBreakingSpace(mt)||ut)&&(it+=mt,rt+=vt)}return st+=cr._addLine(it,!1),st}static _addLine(_,_e=!0){return _=cr._trimRight(_),_=_e?`${_}
`:_,_}static _getFromCache(_,_e,tt,nt){let rt=tt[_];return typeof rt!="number"&&(rt=cr._measureText(_,_e,nt)+_e,tt[_]=rt),rt}static _collapseSpaces(_){return _==="normal"||_==="pre-line"}static _collapseNewlines(_){return _==="normal"}static _trimRight(_){if(typeof _!="string")return"";for(let _e=_.length-1;_e>=0;_e--){const tt=_[_e];if(!cr.isBreakingSpace(tt))break;_=_.slice(0,-1)}return _}static _isNewline(_){return typeof _!="string"?!1:cr._newlines.includes(_.charCodeAt(0))}static isBreakingSpace(_,_e){return typeof _!="string"?!1:cr._breakingSpaces.includes(_.charCodeAt(0))}static _tokenize(_){const _e=[];let tt="";if(typeof _!="string")return _e;for(let nt=0;nt<_.length;nt++){const rt=_[nt],it=_[nt+1];if(cr.isBreakingSpace(rt,it)||cr._isNewline(rt)){tt!==""&&(_e.push(tt),tt=""),_e.push(rt);continue}tt+=rt}return tt!==""&&_e.push(tt),_e}static canBreakWords(_,_e){return _e}static canBreakChars(_,_e,tt,nt,rt){return!0}static wordWrapSplit(_){return cr.graphemeSegmenter(_)}static measureFont(_){if(cr._fonts[_])return cr._fonts[_];const _e=cr._context;_e.font=_;const tt=_e.measureText(cr.METRICS_STRING+cr.BASELINE_SYMBOL),nt={ascent:tt.actualBoundingBoxAscent,descent:tt.actualBoundingBoxDescent,fontSize:tt.actualBoundingBoxAscent+tt.actualBoundingBoxDescent};return cr._fonts[_]=nt,nt}static clearMetrics(_=""){_?delete cr._fonts[_]:cr._fonts={}}static get _canvas(){if(!cr.__canvas){let _;try{const _e=new OffscreenCanvas(0,0),tt=_e.getContext("2d",contextSettings);if(tt!=null&&tt.measureText)return cr.__canvas=_e,_e;_=DOMAdapter.get().createCanvas()}catch{_=DOMAdapter.get().createCanvas()}_.width=_.height=10,cr.__canvas=_}return cr.__canvas}static get _context(){return cr.__context||(cr.__context=cr._canvas.getContext("2d",contextSettings)),cr.__context}};_CanvasTextMetrics.METRICS_STRING="|q";_CanvasTextMetrics.BASELINE_SYMBOL="M";_CanvasTextMetrics.BASELINE_MULTIPLIER=1.4;_CanvasTextMetrics.HEIGHT_MULTIPLIER=2;_CanvasTextMetrics.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const et=new Intl.Segmenter;return _=>[...et.segment(_)].map(_e=>_e.segment)}return et=>[...et]})();_CanvasTextMetrics.experimentalLetterSpacing=!1;_CanvasTextMetrics._fonts={};_CanvasTextMetrics._newlines=[10,13];_CanvasTextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];_CanvasTextMetrics._measurementCache={};let CanvasTextMetrics=_CanvasTextMetrics;class AbstractText extends ViewContainer{constructor(_,_e){const{text:tt,resolution:nt,style:rt,anchor:it,width:st,height:ot,roundPixels:at,...lt}=_;super({...lt}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=_e,this.text=tt??"",this.style=rt,this.resolution=nt??null,this.allowChildren=!1,this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),it&&(this.anchor=it),this.roundPixels=at??!1,st!==void 0&&(this.width=st),ot!==void 0&&(this.height=ot)}get anchor(){return this._anchor}set anchor(_){typeof _=="number"?this._anchor.set(_):this._anchor.copyFrom(_)}set text(_){_=_.toString(),this._text!==_&&(this._text=_,this.onViewUpdate())}get text(){return this._text}set resolution(_){this._autoResolution=_===null,this._resolution=_,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(_){var _e;_=_||{},(_e=this._style)==null||_e.off("update",this.onViewUpdate,this),_ instanceof this._styleClass?this._style=_:this._style=new this._styleClass(_),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(_){this._setWidth(_,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(_){this._setHeight(_,this.bounds.height)}getSize(_){return _||(_={}),_.width=Math.abs(this.scale.x)*this.bounds.width,_.height=Math.abs(this.scale.y)*this.bounds.height,_}setSize(_,_e){let tt,nt;typeof _!="object"?(tt=_,nt=_e??_):(tt=_.width,nt=_.height??_.width),tt!==void 0&&this._setWidth(tt,this.bounds.width),nt!==void 0&&this._setHeight(nt,this.bounds.height)}addBounds(_){const _e=this.bounds;_.addFrame(_e.minX,_e.minY,_e.maxX,_e.maxY)}containsPoint(_){const _e=this.bounds.width,tt=this.bounds.height,nt=-_e*this.anchor.x;let rt=0;return _.x>=nt&&_.x<=nt+_e&&(rt=-tt*this.anchor.y,_.y>=rt&&_.y<=rt+tt)}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0,this._didTextUpdate=!0;const _=this.renderGroup||this.parentRenderGroup;_&&_.onChildViewUpdate(this)}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(_=!1){super.destroy(_),this.owner=null,this._bounds=null,this._anchor=null,(typeof _=="boolean"?_:_!=null&&_.style)&&this._style.destroy(_),this._style=null,this._text=null}}function ensureOptions(et,_){let _e=et[0]??{};return(typeof _e=="string"||et[1])&&(deprecation(v8_0_0,`use new ${_}({ text: "hi!", style }) instead`),_e={text:_e,style:et[1]}),_e}class Text extends AbstractText{constructor(..._){const _e=ensureOptions(_,"Text");super(_e,TextStyle),this.renderPipeId="text"}_updateBounds(){const _=this._bounds,_e=this._anchor,tt=CanvasTextMetrics.measureText(this._text,this._style),{width:nt,height:rt}=tt;_.minX=-_e._x*nt,_.maxX=_.minX+nt,_.minY=-_e._y*rt,_.maxY=_.minY+rt}}extensions.add(browserExt,webworkerExt);const bitMethods={getBit(et){return this.data[getSlot(et)]&1<<getShift(et)?1:0},setBit(et){this.data[getSlot(et)]|=1<<getShift(et)},clearBit(et){this.data[getSlot(et)]&=~(1<<getShift(et))},toggleBit(et){this.data[getSlot(et)]^=1<<getShift(et)},getBitXY(et,_){return et>=this.width||_>=this.height?0:this.getBit(_*this.width+et)},setBitXY(et,_){this.setBit(_*this.width+et)},clearBitXY(et,_){this.clearBit(_*this.width+et)},toggleBitXY(et,_){this.toggleBit(_*this.width+et)}};function getSlot(et){return et>>3}function getShift(et){return 7-(et&7)}function setBitMethods(et){for(const _ in bitMethods)et.prototype[_]=bitMethods[_]}function checkProcessable(et,_={}){let{bitDepth:_e,alpha:tt,colorModel:nt,components:rt,channels:it}=_;if(typeof et!="string"||et.length===0)throw new TypeError("processName must be a string");if(_e&&(Array.isArray(_e)||(_e=[_e]),!_e.includes(this.bitDepth)))throw new TypeError(`The process: ${et} can only be applied if bit depth is in: ${_e}`);if(tt&&(Array.isArray(tt)||(tt=[tt]),!tt.includes(this.alpha)))throw new TypeError(`The process: ${et} can only be applied if alpha is in: ${tt}`);if(nt&&(Array.isArray(nt)||(nt=[nt]),!nt.includes(this.colorModel)))throw new TypeError(`The process: ${et} can only be applied if color model is in: ${nt}`);if(rt&&(Array.isArray(rt)||(rt=[rt]),!rt.includes(this.components))){let st=`The process: ${et} can only be applied if the number of components is in: ${rt}`;throw rt.length===1&&rt[0]===1?new TypeError(`${st}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(st)}if(it&&(Array.isArray(it)||(it=[it]),!it.includes(this.channels)))throw new TypeError(`The process: ${et} can only be applied if the number of channels is in: ${it}`)}function createBlob(et,_){et=et||[],_=_||{},typeof _=="string"&&(_={type:_});try{return new Blob(et,_)}catch(rt){if(rt.name!=="TypeError")throw rt;for(var _e=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,tt=new _e,nt=0;nt<et.length;nt+=1)tt.append(et[nt]);return tt.getBlob(_.type)}}function dataURLToBlob(et){var _=et.match(/data:([^;]+)/)[1],_e=et.replace(/^[^,]+,/,""),tt=binaryStringToArrayBuffer(atob(_e));return createBlob([tt],{type:_})}function canvasToBlob(et,_,_e){return typeof et.toBlob=="function"?new Promise(function(tt){et.toBlob(tt,_,_e)}):Promise.resolve(dataURLToBlob(et.toDataURL(_,_e)))}function binaryStringToArrayBuffer(et){for(var _=et.length,_e=new ArrayBuffer(_),tt=new Uint8Array(_e),nt=-1;++nt<_;)tt[nt]=et.charCodeAt(nt);return _e}(function(et){if(et.TextEncoder&&et.TextDecoder)return!1;function _(tt="utf-8"){if(tt!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${tt}') is invalid.`)}Object.defineProperty(_.prototype,"encoding",{value:"utf-8"}),_.prototype.encode=function(tt,nt={stream:!1}){if(nt.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let rt=0;const it=tt.length;let st=0,ot=Math.max(32,it+(it>>1)+7),at=new Uint8Array(ot>>3<<3);for(;rt<it;){let lt=tt.charCodeAt(rt++);if(lt>=55296&&lt<=56319){if(rt<it){const ct=tt.charCodeAt(rt);(ct&64512)===56320&&(++rt,lt=((lt&1023)<<10)+(ct&1023)+65536)}if(lt>=55296&&lt<=56319)continue}if(st+4>at.length){ot+=8,ot*=1+rt/tt.length*2,ot=ot>>3<<3;const ct=new Uint8Array(ot);ct.set(at),at=ct}if(lt&4294967168)if(!(lt&4294965248))at[st++]=lt>>6&31|192;else if(!(lt&4294901760))at[st++]=lt>>12&15|224,at[st++]=lt>>6&63|128;else if(!(lt&4292870144))at[st++]=lt>>18&7|240,at[st++]=lt>>12&63|128,at[st++]=lt>>6&63|128;else continue;else{at[st++]=lt;continue}at[st++]=lt&63|128}return at.slice(0,st)};function _e(tt="utf-8",nt={fatal:!1}){if(tt!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${tt}') is invalid.`);if(nt.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(_e.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(_e.prototype,"fatal",{value:!1}),Object.defineProperty(_e.prototype,"ignoreBOM",{value:!1}),_e.prototype.decode=function(tt,nt={stream:!1}){if(nt.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const rt=new Uint8Array(tt);let it=0;const st=rt.length,ot=[];for(;it<st;){const at=rt[it++];if(at===0)break;if(!(at&128))ot.push(at);else if((at&224)===192){const lt=rt[it++]&63;ot.push((at&31)<<6|lt)}else if((at&240)===224){const lt=rt[it++]&63,ct=rt[it++]&63;ot.push((at&31)<<12|lt<<6|ct)}else if((at&248)===240){const lt=rt[it++]&63,ct=rt[it++]&63,ht=rt[it++]&63;let ut=(at&7)<<18|lt<<12|ct<<6|ht;ut>65535&&(ut-=65536,ot.push(ut>>>10&1023|55296),ut=56320|ut&1023),ot.push(ut)}}return String.fromCharCode.apply(null,ot)},et.TextEncoder=_,et.TextDecoder=_e})(typeof window<"u"?window:typeof self<"u"?self:void 0);function decode$5(et,_="utf8"){return new TextDecoder(_).decode(et)}const encoder$1=new TextEncoder;function encode$3(et){return encoder$1.encode(et)}const defaultByteLength$1=1024*8,hostBigEndian=(()=>{const et=new Uint8Array(4),_=new Uint32Array(et.buffer);return!((_[0]=1)&et[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};let IOBuffer$4=class m0{constructor(_=defaultByteLength$1,_e={}){let tt=!1;typeof _=="number"?_=new ArrayBuffer(_):(tt=!0,this.lastWrittenByte=_.byteLength);const nt=_e.offset?_e.offset>>>0:0,rt=_.byteLength-nt;let it=nt;(ArrayBuffer.isView(_)||_ instanceof m0)&&(_.byteLength!==_.buffer.byteLength&&(it=_.byteOffset+nt),_=_.buffer),tt?this.lastWrittenByte=rt:this.lastWrittenByte=0,this.buffer=_,this.length=rt,this.byteLength=rt,this.byteOffset=it,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,it,rt),this._mark=0,this._marks=[]}available(_=1){return this.offset+_<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(_=1){return this.offset+=_,this}back(_=1){return this.offset-=_,this}seek(_){return this.offset=_,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const _=this._marks.pop();if(_===void 0)throw new Error("Mark stack empty");return this.seek(_),this}rewind(){return this.offset=0,this}ensureAvailable(_=1){if(!this.available(_)){const tt=(this.offset+_)*2,nt=new Uint8Array(tt);nt.set(new Uint8Array(this.buffer)),this.buffer=nt.buffer,this.length=this.byteLength=tt,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(_=1){return this.readArray(_,"uint8")}readArray(_,_e){const tt=typedArrays[_e].BYTES_PER_ELEMENT*_,nt=this.byteOffset+this.offset,rt=this.buffer.slice(nt,nt+tt);if(this.littleEndian===hostBigEndian&&_e!=="uint8"&&_e!=="int8"){const st=new Uint8Array(this.buffer.slice(nt,nt+tt));st.reverse();const ot=new typedArrays[_e](st.buffer);return this.offset+=tt,ot.reverse(),ot}const it=new typedArrays[_e](rt);return this.offset+=tt,it}readInt16(){const _=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,_}readUint16(){const _=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,_}readInt32(){const _=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,_}readUint32(){const _=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat32(){const _=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat64(){const _=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,_}readBigInt64(){const _=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,_}readBigUint64(){const _=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,_}readChar(){return String.fromCharCode(this.readInt8())}readChars(_=1){let _e="";for(let tt=0;tt<_;tt++)_e+=this.readChar();return _e}readUtf8(_=1){return decode$5(this.readBytes(_))}decodeText(_=1,_e="utf-8"){return decode$5(this.readBytes(_),_e)}writeBoolean(_){return this.writeUint8(_?255:0),this}writeInt8(_){return this.ensureAvailable(1),this._data.setInt8(this.offset++,_),this._updateLastWrittenByte(),this}writeUint8(_){return this.ensureAvailable(1),this._data.setUint8(this.offset++,_),this._updateLastWrittenByte(),this}writeByte(_){return this.writeUint8(_)}writeBytes(_){this.ensureAvailable(_.length);for(let _e=0;_e<_.length;_e++)this._data.setUint8(this.offset++,_[_e]);return this._updateLastWrittenByte(),this}writeInt16(_){return this.ensureAvailable(2),this._data.setInt16(this.offset,_,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(_){return this.ensureAvailable(2),this._data.setUint16(this.offset,_,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(_){return this.ensureAvailable(4),this._data.setInt32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(_){return this.ensureAvailable(4),this._data.setUint32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(_){return this.ensureAvailable(4),this._data.setFloat32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(_){return this.ensureAvailable(8),this._data.setFloat64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(_){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(_){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(_){return this.writeUint8(_.charCodeAt(0))}writeChars(_){for(let _e=0;_e<_.length;_e++)this.writeUint8(_.charCodeAt(_e));return this}writeUtf8(_){return this.writeBytes(encode$3(_))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}};const IOBuffer$5=Object.freeze(Object.defineProperty({__proto__:null,IOBuffer:IOBuffer$4},Symbol.toStringTag,{value:"Module"})),require$$0$4=getAugmentedNamespace(IOBuffer$5);var constants$4={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}};const{IOBuffer:IOBuffer$3}=require$$0$4,constants$3=constants$4,tableLeft=[];for(let et=0;et<=8;et++)tableLeft.push(255<<et);class BMPEncoder extends IOBuffer$3{constructor(_){if(_.bitDepth!==1)throw new Error("Only bitDepth of 1 is supported");if(!_.height||!_.width)throw new Error("ImageData width and height are required");super(_.data),this.width=_.width,this.height=_.height,this.bitDepth=_.bitDepth,this.channels=_.channels,this.components=_.components}encode(){this.encoded=new IOBuffer$3,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const _=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(_),this.encoded.toArray()}writePixelArray(){let _=this.encoded;const _e=Math.floor((this.bitDepth*this.width+31)/32)*4,tt=Math.ceil(this.bitDepth*this.width/8),nt=_e-tt,rt=this.bitDepth*this.width%8,it=rt===0?0:8-rt,st=_e*this.height;let ot,at,lt=0,ct=0,ht=8;_.mark(),at=this.readUint8();for(let ut=this.height-1;ut>=0;ut--){const ft=ut===0;_.reset(),_.skip(ut*_e);for(let dt=0;dt<tt;dt++){const pt=dt===tt-1;ct<=it&&pt?(_.writeByte(at<<ct),(it===0||it===ct)&&!ft&&(ot=at,at=this.readByte())):ct===0?(ot=at,at=this.readUint8(),_.writeByte(ot)):(ot=at,at=this.readUint8(),_.writeByte(ot<<ct&tableLeft[ct]|at>>ht)),pt&&(lt+=rt||0,_.skip(nt),ct=lt%8,ht=8-ct)}}_e>tt&&(_.reset(),_.skip(st-1),_.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(_){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(_)}writeBitmapV5Header(){const _e=Math.floor((this.bitDepth*this.width+31)/32)*4*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(constants$3.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(_e).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(constants$3.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(constants$3.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}var BMPEncoder_1=BMPEncoder;const Encoder=BMPEncoder_1;var encode$2=function(_){return new Encoder(_).encode()};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(et){let _=et.length;for(;--_>=0;)et[_]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(et,_,_e,tt,nt){this.static_tree=et,this.extra_bits=_,this.extra_base=_e,this.elems=tt,this.max_length=nt,this.has_stree=et&&et.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(et,_){this.dyn_tree=et,this.max_code=0,this.stat_desc=_}const d_code=et=>et<256?_dist_code[et]:_dist_code[256+(et>>>7)],put_short=(et,_)=>{et.pending_buf[et.pending++]=_&255,et.pending_buf[et.pending++]=_>>>8&255},send_bits=(et,_,_e)=>{et.bi_valid>Buf_size-_e?(et.bi_buf|=_<<et.bi_valid&65535,put_short(et,et.bi_buf),et.bi_buf=_>>Buf_size-et.bi_valid,et.bi_valid+=_e-Buf_size):(et.bi_buf|=_<<et.bi_valid&65535,et.bi_valid+=_e)},send_code=(et,_,_e)=>{send_bits(et,_e[_*2],_e[_*2+1])},bi_reverse=(et,_)=>{let _e=0;do _e|=et&1,et>>>=1,_e<<=1;while(--_>0);return _e>>>1},bi_flush=et=>{et.bi_valid===16?(put_short(et,et.bi_buf),et.bi_buf=0,et.bi_valid=0):et.bi_valid>=8&&(et.pending_buf[et.pending++]=et.bi_buf&255,et.bi_buf>>=8,et.bi_valid-=8)},gen_bitlen=(et,_)=>{const _e=_.dyn_tree,tt=_.max_code,nt=_.stat_desc.static_tree,rt=_.stat_desc.has_stree,it=_.stat_desc.extra_bits,st=_.stat_desc.extra_base,ot=_.stat_desc.max_length;let at,lt,ct,ht,ut,ft,dt=0;for(ht=0;ht<=MAX_BITS$1;ht++)et.bl_count[ht]=0;for(_e[et.heap[et.heap_max]*2+1]=0,at=et.heap_max+1;at<HEAP_SIZE$1;at++)lt=et.heap[at],ht=_e[_e[lt*2+1]*2+1]+1,ht>ot&&(ht=ot,dt++),_e[lt*2+1]=ht,!(lt>tt)&&(et.bl_count[ht]++,ut=0,lt>=st&&(ut=it[lt-st]),ft=_e[lt*2],et.opt_len+=ft*(ht+ut),rt&&(et.static_len+=ft*(nt[lt*2+1]+ut)));if(dt!==0){do{for(ht=ot-1;et.bl_count[ht]===0;)ht--;et.bl_count[ht]--,et.bl_count[ht+1]+=2,et.bl_count[ot]--,dt-=2}while(dt>0);for(ht=ot;ht!==0;ht--)for(lt=et.bl_count[ht];lt!==0;)ct=et.heap[--at],!(ct>tt)&&(_e[ct*2+1]!==ht&&(et.opt_len+=(ht-_e[ct*2+1])*_e[ct*2],_e[ct*2+1]=ht),lt--)}},gen_codes=(et,_,_e)=>{const tt=new Array(MAX_BITS$1+1);let nt=0,rt,it;for(rt=1;rt<=MAX_BITS$1;rt++)nt=nt+_e[rt-1]<<1,tt[rt]=nt;for(it=0;it<=_;it++){let st=et[it*2+1];st!==0&&(et[it*2]=bi_reverse(tt[st]++,st))}},tr_static_init=()=>{let et,_,_e,tt,nt;const rt=new Array(MAX_BITS$1+1);for(_e=0,tt=0;tt<LENGTH_CODES$1-1;tt++)for(base_length[tt]=_e,et=0;et<1<<extra_lbits[tt];et++)_length_code[_e++]=tt;for(_length_code[_e-1]=tt,nt=0,tt=0;tt<16;tt++)for(base_dist[tt]=nt,et=0;et<1<<extra_dbits[tt];et++)_dist_code[nt++]=tt;for(nt>>=7;tt<D_CODES$1;tt++)for(base_dist[tt]=nt<<7,et=0;et<1<<extra_dbits[tt]-7;et++)_dist_code[256+nt++]=tt;for(_=0;_<=MAX_BITS$1;_++)rt[_]=0;for(et=0;et<=143;)static_ltree[et*2+1]=8,et++,rt[8]++;for(;et<=255;)static_ltree[et*2+1]=9,et++,rt[9]++;for(;et<=279;)static_ltree[et*2+1]=7,et++,rt[7]++;for(;et<=287;)static_ltree[et*2+1]=8,et++,rt[8]++;for(gen_codes(static_ltree,L_CODES$1+1,rt),et=0;et<D_CODES$1;et++)static_dtree[et*2+1]=5,static_dtree[et*2]=bi_reverse(et,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=et=>{let _;for(_=0;_<L_CODES$1;_++)et.dyn_ltree[_*2]=0;for(_=0;_<D_CODES$1;_++)et.dyn_dtree[_*2]=0;for(_=0;_<BL_CODES$1;_++)et.bl_tree[_*2]=0;et.dyn_ltree[END_BLOCK*2]=1,et.opt_len=et.static_len=0,et.sym_next=et.matches=0},bi_windup=et=>{et.bi_valid>8?put_short(et,et.bi_buf):et.bi_valid>0&&(et.pending_buf[et.pending++]=et.bi_buf),et.bi_buf=0,et.bi_valid=0},smaller=(et,_,_e,tt)=>{const nt=_*2,rt=_e*2;return et[nt]<et[rt]||et[nt]===et[rt]&&tt[_]<=tt[_e]},pqdownheap=(et,_,_e)=>{const tt=et.heap[_e];let nt=_e<<1;for(;nt<=et.heap_len&&(nt<et.heap_len&&smaller(_,et.heap[nt+1],et.heap[nt],et.depth)&&nt++,!smaller(_,tt,et.heap[nt],et.depth));)et.heap[_e]=et.heap[nt],_e=nt,nt<<=1;et.heap[_e]=tt},compress_block=(et,_,_e)=>{let tt,nt,rt=0,it,st;if(et.sym_next!==0)do tt=et.pending_buf[et.sym_buf+rt++]&255,tt+=(et.pending_buf[et.sym_buf+rt++]&255)<<8,nt=et.pending_buf[et.sym_buf+rt++],tt===0?send_code(et,nt,_):(it=_length_code[nt],send_code(et,it+LITERALS$1+1,_),st=extra_lbits[it],st!==0&&(nt-=base_length[it],send_bits(et,nt,st)),tt--,it=d_code(tt),send_code(et,it,_e),st=extra_dbits[it],st!==0&&(tt-=base_dist[it],send_bits(et,tt,st)));while(rt<et.sym_next);send_code(et,END_BLOCK,_)},build_tree=(et,_)=>{const _e=_.dyn_tree,tt=_.stat_desc.static_tree,nt=_.stat_desc.has_stree,rt=_.stat_desc.elems;let it,st,ot=-1,at;for(et.heap_len=0,et.heap_max=HEAP_SIZE$1,it=0;it<rt;it++)_e[it*2]!==0?(et.heap[++et.heap_len]=ot=it,et.depth[it]=0):_e[it*2+1]=0;for(;et.heap_len<2;)at=et.heap[++et.heap_len]=ot<2?++ot:0,_e[at*2]=1,et.depth[at]=0,et.opt_len--,nt&&(et.static_len-=tt[at*2+1]);for(_.max_code=ot,it=et.heap_len>>1;it>=1;it--)pqdownheap(et,_e,it);at=rt;do it=et.heap[1],et.heap[1]=et.heap[et.heap_len--],pqdownheap(et,_e,1),st=et.heap[1],et.heap[--et.heap_max]=it,et.heap[--et.heap_max]=st,_e[at*2]=_e[it*2]+_e[st*2],et.depth[at]=(et.depth[it]>=et.depth[st]?et.depth[it]:et.depth[st])+1,_e[it*2+1]=_e[st*2+1]=at,et.heap[1]=at++,pqdownheap(et,_e,1);while(et.heap_len>=2);et.heap[--et.heap_max]=et.heap[1],gen_bitlen(et,_),gen_codes(_e,ot,et.bl_count)},scan_tree=(et,_,_e)=>{let tt,nt=-1,rt,it=_[0*2+1],st=0,ot=7,at=4;for(it===0&&(ot=138,at=3),_[(_e+1)*2+1]=65535,tt=0;tt<=_e;tt++)rt=it,it=_[(tt+1)*2+1],!(++st<ot&&rt===it)&&(st<at?et.bl_tree[rt*2]+=st:rt!==0?(rt!==nt&&et.bl_tree[rt*2]++,et.bl_tree[REP_3_6*2]++):st<=10?et.bl_tree[REPZ_3_10*2]++:et.bl_tree[REPZ_11_138*2]++,st=0,nt=rt,it===0?(ot=138,at=3):rt===it?(ot=6,at=3):(ot=7,at=4))},send_tree=(et,_,_e)=>{let tt,nt=-1,rt,it=_[0*2+1],st=0,ot=7,at=4;for(it===0&&(ot=138,at=3),tt=0;tt<=_e;tt++)if(rt=it,it=_[(tt+1)*2+1],!(++st<ot&&rt===it)){if(st<at)do send_code(et,rt,et.bl_tree);while(--st!==0);else rt!==0?(rt!==nt&&(send_code(et,rt,et.bl_tree),st--),send_code(et,REP_3_6,et.bl_tree),send_bits(et,st-3,2)):st<=10?(send_code(et,REPZ_3_10,et.bl_tree),send_bits(et,st-3,3)):(send_code(et,REPZ_11_138,et.bl_tree),send_bits(et,st-11,7));st=0,nt=rt,it===0?(ot=138,at=3):rt===it?(ot=6,at=3):(ot=7,at=4)}},build_bl_tree=et=>{let _;for(scan_tree(et,et.dyn_ltree,et.l_desc.max_code),scan_tree(et,et.dyn_dtree,et.d_desc.max_code),build_tree(et,et.bl_desc),_=BL_CODES$1-1;_>=3&&et.bl_tree[bl_order[_]*2+1]===0;_--);return et.opt_len+=3*(_+1)+5+5+4,_},send_all_trees=(et,_,_e,tt)=>{let nt;for(send_bits(et,_-257,5),send_bits(et,_e-1,5),send_bits(et,tt-4,4),nt=0;nt<tt;nt++)send_bits(et,et.bl_tree[bl_order[nt]*2+1],3);send_tree(et,et.dyn_ltree,_-1),send_tree(et,et.dyn_dtree,_e-1)},detect_data_type=et=>{let _=4093624447,_e;for(_e=0;_e<=31;_e++,_>>>=1)if(_&1&&et.dyn_ltree[_e*2]!==0)return Z_BINARY;if(et.dyn_ltree[9*2]!==0||et.dyn_ltree[10*2]!==0||et.dyn_ltree[13*2]!==0)return Z_TEXT;for(_e=32;_e<LITERALS$1;_e++)if(et.dyn_ltree[_e*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=et=>{static_init_done||(tr_static_init(),static_init_done=!0),et.l_desc=new TreeDesc(et.dyn_ltree,static_l_desc),et.d_desc=new TreeDesc(et.dyn_dtree,static_d_desc),et.bl_desc=new TreeDesc(et.bl_tree,static_bl_desc),et.bi_buf=0,et.bi_valid=0,init_block(et)},_tr_stored_block$1=(et,_,_e,tt)=>{send_bits(et,(STORED_BLOCK<<1)+(tt?1:0),3),bi_windup(et),put_short(et,_e),put_short(et,~_e),_e&&et.pending_buf.set(et.window.subarray(_,_+_e),et.pending),et.pending+=_e},_tr_align$1=et=>{send_bits(et,STATIC_TREES<<1,3),send_code(et,END_BLOCK,static_ltree),bi_flush(et)},_tr_flush_block$1=(et,_,_e,tt)=>{let nt,rt,it=0;et.level>0?(et.strm.data_type===Z_UNKNOWN$1&&(et.strm.data_type=detect_data_type(et)),build_tree(et,et.l_desc),build_tree(et,et.d_desc),it=build_bl_tree(et),nt=et.opt_len+3+7>>>3,rt=et.static_len+3+7>>>3,rt<=nt&&(nt=rt)):nt=rt=_e+5,_e+4<=nt&&_!==-1?_tr_stored_block$1(et,_,_e,tt):et.strategy===Z_FIXED$1||rt===nt?(send_bits(et,(STATIC_TREES<<1)+(tt?1:0),3),compress_block(et,static_ltree,static_dtree)):(send_bits(et,(DYN_TREES<<1)+(tt?1:0),3),send_all_trees(et,et.l_desc.max_code+1,et.d_desc.max_code+1,it+1),compress_block(et,et.dyn_ltree,et.dyn_dtree)),init_block(et),tt&&bi_windup(et)},_tr_tally$1=(et,_,_e)=>(et.pending_buf[et.sym_buf+et.sym_next++]=_,et.pending_buf[et.sym_buf+et.sym_next++]=_>>8,et.pending_buf[et.sym_buf+et.sym_next++]=_e,_===0?et.dyn_ltree[_e*2]++:(et.matches++,_--,et.dyn_ltree[(_length_code[_e]+LITERALS$1+1)*2]++,et.dyn_dtree[d_code(_)*2]++),et.sym_next===et.sym_end);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32=(et,_,_e,tt)=>{let nt=et&65535|0,rt=et>>>16&65535|0,it=0;for(;_e!==0;){it=_e>2e3?2e3:_e,_e-=it;do nt=nt+_[tt++]|0,rt=rt+nt|0;while(--it);nt%=65521,rt%=65521}return nt|rt<<16|0};var adler32_1=adler32;const makeTable=()=>{let et,_=[];for(var _e=0;_e<256;_e++){et=_e;for(var tt=0;tt<8;tt++)et=et&1?3988292384^et>>>1:et>>>1;_[_e]=et}return _},crcTable$1=new Uint32Array(makeTable()),crc32=(et,_,_e,tt)=>{const nt=crcTable$1,rt=tt+_e;et^=-1;for(let it=tt;it<rt;it++)et=et>>>8^nt[(et^_[it])&255];return et^-1};var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(et,_)=>(et.msg=messages[_],_),rank=et=>et*2-(et>4?9:0),zero=et=>{let _=et.length;for(;--_>=0;)et[_]=0},slide_hash=et=>{let _,_e,tt,nt=et.w_size;_=et.hash_size,tt=_;do _e=et.head[--tt],et.head[tt]=_e>=nt?_e-nt:0;while(--_);_=nt,tt=_;do _e=et.prev[--tt],et.prev[tt]=_e>=nt?_e-nt:0;while(--_)};let HASH_ZLIB=(et,_,_e)=>(_<<et.hash_shift^_e)&et.hash_mask,HASH=HASH_ZLIB;const flush_pending=et=>{const _=et.state;let _e=_.pending;_e>et.avail_out&&(_e=et.avail_out),_e!==0&&(et.output.set(_.pending_buf.subarray(_.pending_out,_.pending_out+_e),et.next_out),et.next_out+=_e,_.pending_out+=_e,et.total_out+=_e,et.avail_out-=_e,_.pending-=_e,_.pending===0&&(_.pending_out=0))},flush_block_only=(et,_)=>{_tr_flush_block(et,et.block_start>=0?et.block_start:-1,et.strstart-et.block_start,_),et.block_start=et.strstart,flush_pending(et.strm)},put_byte=(et,_)=>{et.pending_buf[et.pending++]=_},putShortMSB=(et,_)=>{et.pending_buf[et.pending++]=_>>>8&255,et.pending_buf[et.pending++]=_&255},read_buf=(et,_,_e,tt)=>{let nt=et.avail_in;return nt>tt&&(nt=tt),nt===0?0:(et.avail_in-=nt,_.set(et.input.subarray(et.next_in,et.next_in+nt),_e),et.state.wrap===1?et.adler=adler32_1(et.adler,_,nt,_e):et.state.wrap===2&&(et.adler=crc32_1(et.adler,_,nt,_e)),et.next_in+=nt,et.total_in+=nt,nt)},longest_match=(et,_)=>{let _e=et.max_chain_length,tt=et.strstart,nt,rt,it=et.prev_length,st=et.nice_match;const ot=et.strstart>et.w_size-MIN_LOOKAHEAD?et.strstart-(et.w_size-MIN_LOOKAHEAD):0,at=et.window,lt=et.w_mask,ct=et.prev,ht=et.strstart+MAX_MATCH;let ut=at[tt+it-1],ft=at[tt+it];et.prev_length>=et.good_match&&(_e>>=2),st>et.lookahead&&(st=et.lookahead);do if(nt=_,!(at[nt+it]!==ft||at[nt+it-1]!==ut||at[nt]!==at[tt]||at[++nt]!==at[tt+1])){tt+=2,nt++;do;while(at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&at[++tt]===at[++nt]&&tt<ht);if(rt=MAX_MATCH-(ht-tt),tt=ht-MAX_MATCH,rt>it){if(et.match_start=_,it=rt,rt>=st)break;ut=at[tt+it-1],ft=at[tt+it]}}while((_=ct[_&lt])>ot&&--_e!==0);return it<=et.lookahead?it:et.lookahead},fill_window=et=>{const _=et.w_size;let _e,tt,nt;do{if(tt=et.window_size-et.lookahead-et.strstart,et.strstart>=_+(_-MIN_LOOKAHEAD)&&(et.window.set(et.window.subarray(_,_+_-tt),0),et.match_start-=_,et.strstart-=_,et.block_start-=_,et.insert>et.strstart&&(et.insert=et.strstart),slide_hash(et),tt+=_),et.strm.avail_in===0)break;if(_e=read_buf(et.strm,et.window,et.strstart+et.lookahead,tt),et.lookahead+=_e,et.lookahead+et.insert>=MIN_MATCH)for(nt=et.strstart-et.insert,et.ins_h=et.window[nt],et.ins_h=HASH(et,et.ins_h,et.window[nt+1]);et.insert&&(et.ins_h=HASH(et,et.ins_h,et.window[nt+MIN_MATCH-1]),et.prev[nt&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=nt,nt++,et.insert--,!(et.lookahead+et.insert<MIN_MATCH)););}while(et.lookahead<MIN_LOOKAHEAD&&et.strm.avail_in!==0)},deflate_stored=(et,_)=>{let _e=et.pending_buf_size-5>et.w_size?et.w_size:et.pending_buf_size-5,tt,nt,rt,it=0,st=et.strm.avail_in;do{if(tt=65535,rt=et.bi_valid+42>>3,et.strm.avail_out<rt||(rt=et.strm.avail_out-rt,nt=et.strstart-et.block_start,tt>nt+et.strm.avail_in&&(tt=nt+et.strm.avail_in),tt>rt&&(tt=rt),tt<_e&&(tt===0&&_!==Z_FINISH$3||_===Z_NO_FLUSH$2||tt!==nt+et.strm.avail_in)))break;it=_===Z_FINISH$3&&tt===nt+et.strm.avail_in?1:0,_tr_stored_block(et,0,0,it),et.pending_buf[et.pending-4]=tt,et.pending_buf[et.pending-3]=tt>>8,et.pending_buf[et.pending-2]=~tt,et.pending_buf[et.pending-1]=~tt>>8,flush_pending(et.strm),nt&&(nt>tt&&(nt=tt),et.strm.output.set(et.window.subarray(et.block_start,et.block_start+nt),et.strm.next_out),et.strm.next_out+=nt,et.strm.avail_out-=nt,et.strm.total_out+=nt,et.block_start+=nt,tt-=nt),tt&&(read_buf(et.strm,et.strm.output,et.strm.next_out,tt),et.strm.next_out+=tt,et.strm.avail_out-=tt,et.strm.total_out+=tt)}while(it===0);return st-=et.strm.avail_in,st&&(st>=et.w_size?(et.matches=2,et.window.set(et.strm.input.subarray(et.strm.next_in-et.w_size,et.strm.next_in),0),et.strstart=et.w_size,et.insert=et.strstart):(et.window_size-et.strstart<=st&&(et.strstart-=et.w_size,et.window.set(et.window.subarray(et.w_size,et.w_size+et.strstart),0),et.matches<2&&et.matches++,et.insert>et.strstart&&(et.insert=et.strstart)),et.window.set(et.strm.input.subarray(et.strm.next_in-st,et.strm.next_in),et.strstart),et.strstart+=st,et.insert+=st>et.w_size-et.insert?et.w_size-et.insert:st),et.block_start=et.strstart),et.high_water<et.strstart&&(et.high_water=et.strstart),it?BS_FINISH_DONE:_!==Z_NO_FLUSH$2&&_!==Z_FINISH$3&&et.strm.avail_in===0&&et.strstart===et.block_start?BS_BLOCK_DONE:(rt=et.window_size-et.strstart,et.strm.avail_in>rt&&et.block_start>=et.w_size&&(et.block_start-=et.w_size,et.strstart-=et.w_size,et.window.set(et.window.subarray(et.w_size,et.w_size+et.strstart),0),et.matches<2&&et.matches++,rt+=et.w_size,et.insert>et.strstart&&(et.insert=et.strstart)),rt>et.strm.avail_in&&(rt=et.strm.avail_in),rt&&(read_buf(et.strm,et.window,et.strstart,rt),et.strstart+=rt,et.insert+=rt>et.w_size-et.insert?et.w_size-et.insert:rt),et.high_water<et.strstart&&(et.high_water=et.strstart),rt=et.bi_valid+42>>3,rt=et.pending_buf_size-rt>65535?65535:et.pending_buf_size-rt,_e=rt>et.w_size?et.w_size:rt,nt=et.strstart-et.block_start,(nt>=_e||(nt||_===Z_FINISH$3)&&_!==Z_NO_FLUSH$2&&et.strm.avail_in===0&&nt<=rt)&&(tt=nt>rt?rt:nt,it=_===Z_FINISH$3&&et.strm.avail_in===0&&tt===nt?1:0,_tr_stored_block(et,et.block_start,tt,it),et.block_start+=tt,flush_pending(et.strm)),it?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=(et,_)=>{let _e,tt;for(;;){if(et.lookahead<MIN_LOOKAHEAD){if(fill_window(et),et.lookahead<MIN_LOOKAHEAD&&_===Z_NO_FLUSH$2)return BS_NEED_MORE;if(et.lookahead===0)break}if(_e=0,et.lookahead>=MIN_MATCH&&(et.ins_h=HASH(et,et.ins_h,et.window[et.strstart+MIN_MATCH-1]),_e=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart),_e!==0&&et.strstart-_e<=et.w_size-MIN_LOOKAHEAD&&(et.match_length=longest_match(et,_e)),et.match_length>=MIN_MATCH)if(tt=_tr_tally(et,et.strstart-et.match_start,et.match_length-MIN_MATCH),et.lookahead-=et.match_length,et.match_length<=et.max_lazy_match&&et.lookahead>=MIN_MATCH){et.match_length--;do et.strstart++,et.ins_h=HASH(et,et.ins_h,et.window[et.strstart+MIN_MATCH-1]),_e=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart;while(--et.match_length!==0);et.strstart++}else et.strstart+=et.match_length,et.match_length=0,et.ins_h=et.window[et.strstart],et.ins_h=HASH(et,et.ins_h,et.window[et.strstart+1]);else tt=_tr_tally(et,0,et.window[et.strstart]),et.lookahead--,et.strstart++;if(tt&&(flush_block_only(et,!1),et.strm.avail_out===0))return BS_NEED_MORE}return et.insert=et.strstart<MIN_MATCH-1?et.strstart:MIN_MATCH-1,_===Z_FINISH$3?(flush_block_only(et,!0),et.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):et.sym_next&&(flush_block_only(et,!1),et.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(et,_)=>{let _e,tt,nt;for(;;){if(et.lookahead<MIN_LOOKAHEAD){if(fill_window(et),et.lookahead<MIN_LOOKAHEAD&&_===Z_NO_FLUSH$2)return BS_NEED_MORE;if(et.lookahead===0)break}if(_e=0,et.lookahead>=MIN_MATCH&&(et.ins_h=HASH(et,et.ins_h,et.window[et.strstart+MIN_MATCH-1]),_e=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart),et.prev_length=et.match_length,et.prev_match=et.match_start,et.match_length=MIN_MATCH-1,_e!==0&&et.prev_length<et.max_lazy_match&&et.strstart-_e<=et.w_size-MIN_LOOKAHEAD&&(et.match_length=longest_match(et,_e),et.match_length<=5&&(et.strategy===Z_FILTERED||et.match_length===MIN_MATCH&&et.strstart-et.match_start>4096)&&(et.match_length=MIN_MATCH-1)),et.prev_length>=MIN_MATCH&&et.match_length<=et.prev_length){nt=et.strstart+et.lookahead-MIN_MATCH,tt=_tr_tally(et,et.strstart-1-et.prev_match,et.prev_length-MIN_MATCH),et.lookahead-=et.prev_length-1,et.prev_length-=2;do++et.strstart<=nt&&(et.ins_h=HASH(et,et.ins_h,et.window[et.strstart+MIN_MATCH-1]),_e=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart);while(--et.prev_length!==0);if(et.match_available=0,et.match_length=MIN_MATCH-1,et.strstart++,tt&&(flush_block_only(et,!1),et.strm.avail_out===0))return BS_NEED_MORE}else if(et.match_available){if(tt=_tr_tally(et,0,et.window[et.strstart-1]),tt&&flush_block_only(et,!1),et.strstart++,et.lookahead--,et.strm.avail_out===0)return BS_NEED_MORE}else et.match_available=1,et.strstart++,et.lookahead--}return et.match_available&&(tt=_tr_tally(et,0,et.window[et.strstart-1]),et.match_available=0),et.insert=et.strstart<MIN_MATCH-1?et.strstart:MIN_MATCH-1,_===Z_FINISH$3?(flush_block_only(et,!0),et.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):et.sym_next&&(flush_block_only(et,!1),et.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(et,_)=>{let _e,tt,nt,rt;const it=et.window;for(;;){if(et.lookahead<=MAX_MATCH){if(fill_window(et),et.lookahead<=MAX_MATCH&&_===Z_NO_FLUSH$2)return BS_NEED_MORE;if(et.lookahead===0)break}if(et.match_length=0,et.lookahead>=MIN_MATCH&&et.strstart>0&&(nt=et.strstart-1,tt=it[nt],tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt])){rt=et.strstart+MAX_MATCH;do;while(tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt]&&tt===it[++nt]&&nt<rt);et.match_length=MAX_MATCH-(rt-nt),et.match_length>et.lookahead&&(et.match_length=et.lookahead)}if(et.match_length>=MIN_MATCH?(_e=_tr_tally(et,1,et.match_length-MIN_MATCH),et.lookahead-=et.match_length,et.strstart+=et.match_length,et.match_length=0):(_e=_tr_tally(et,0,et.window[et.strstart]),et.lookahead--,et.strstart++),_e&&(flush_block_only(et,!1),et.strm.avail_out===0))return BS_NEED_MORE}return et.insert=0,_===Z_FINISH$3?(flush_block_only(et,!0),et.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):et.sym_next&&(flush_block_only(et,!1),et.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(et,_)=>{let _e;for(;;){if(et.lookahead===0&&(fill_window(et),et.lookahead===0)){if(_===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(et.match_length=0,_e=_tr_tally(et,0,et.window[et.strstart]),et.lookahead--,et.strstart++,_e&&(flush_block_only(et,!1),et.strm.avail_out===0))return BS_NEED_MORE}return et.insert=0,_===Z_FINISH$3?(flush_block_only(et,!0),et.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):et.sym_next&&(flush_block_only(et,!1),et.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(et,_,_e,tt,nt){this.good_length=et,this.max_lazy=_,this.nice_length=_e,this.max_chain=tt,this.func=nt}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=et=>{et.window_size=2*et.w_size,zero(et.head),et.max_lazy_match=configuration_table[et.level].max_lazy,et.good_match=configuration_table[et.level].good_length,et.nice_match=configuration_table[et.level].nice_length,et.max_chain_length=configuration_table[et.level].max_chain,et.strstart=0,et.block_start=0,et.lookahead=0,et.insert=0,et.match_length=et.prev_length=MIN_MATCH-1,et.match_available=0,et.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=et=>{if(!et)return 1;const _=et.state;return!_||_.strm!==et||_.status!==INIT_STATE&&_.status!==GZIP_STATE&&_.status!==EXTRA_STATE&&_.status!==NAME_STATE&&_.status!==COMMENT_STATE&&_.status!==HCRC_STATE&&_.status!==BUSY_STATE&&_.status!==FINISH_STATE?1:0},deflateResetKeep=et=>{if(deflateStateCheck(et))return err(et,Z_STREAM_ERROR$2);et.total_in=et.total_out=0,et.data_type=Z_UNKNOWN;const _=et.state;return _.pending=0,_.pending_out=0,_.wrap<0&&(_.wrap=-_.wrap),_.status=_.wrap===2?GZIP_STATE:_.wrap?INIT_STATE:BUSY_STATE,et.adler=_.wrap===2?0:1,_.last_flush=-2,_tr_init(_),Z_OK$3},deflateReset=et=>{const _=deflateResetKeep(et);return _===Z_OK$3&&lm_init(et.state),_},deflateSetHeader=(et,_)=>deflateStateCheck(et)||et.state.wrap!==2?Z_STREAM_ERROR$2:(et.state.gzhead=_,Z_OK$3),deflateInit2=(et,_,_e,tt,nt,rt)=>{if(!et)return Z_STREAM_ERROR$2;let it=1;if(_===Z_DEFAULT_COMPRESSION$1&&(_=6),tt<0?(it=0,tt=-tt):tt>15&&(it=2,tt-=16),nt<1||nt>MAX_MEM_LEVEL||_e!==Z_DEFLATED$2||tt<8||tt>15||_<0||_>9||rt<0||rt>Z_FIXED||tt===8&&it!==1)return err(et,Z_STREAM_ERROR$2);tt===8&&(tt=9);const st=new DeflateState;return et.state=st,st.strm=et,st.status=INIT_STATE,st.wrap=it,st.gzhead=null,st.w_bits=tt,st.w_size=1<<st.w_bits,st.w_mask=st.w_size-1,st.hash_bits=nt+7,st.hash_size=1<<st.hash_bits,st.hash_mask=st.hash_size-1,st.hash_shift=~~((st.hash_bits+MIN_MATCH-1)/MIN_MATCH),st.window=new Uint8Array(st.w_size*2),st.head=new Uint16Array(st.hash_size),st.prev=new Uint16Array(st.w_size),st.lit_bufsize=1<<nt+6,st.pending_buf_size=st.lit_bufsize*4,st.pending_buf=new Uint8Array(st.pending_buf_size),st.sym_buf=st.lit_bufsize,st.sym_end=(st.lit_bufsize-1)*3,st.level=_,st.strategy=rt,st.method=_e,deflateReset(et)},deflateInit=(et,_)=>deflateInit2(et,_,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(et,_)=>{if(deflateStateCheck(et)||_>Z_BLOCK$1||_<0)return et?err(et,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const _e=et.state;if(!et.output||et.avail_in!==0&&!et.input||_e.status===FINISH_STATE&&_!==Z_FINISH$3)return err(et,et.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const tt=_e.last_flush;if(_e.last_flush=_,_e.pending!==0){if(flush_pending(et),et.avail_out===0)return _e.last_flush=-1,Z_OK$3}else if(et.avail_in===0&&rank(_)<=rank(tt)&&_!==Z_FINISH$3)return err(et,Z_BUF_ERROR$1);if(_e.status===FINISH_STATE&&et.avail_in!==0)return err(et,Z_BUF_ERROR$1);if(_e.status===INIT_STATE&&_e.wrap===0&&(_e.status=BUSY_STATE),_e.status===INIT_STATE){let nt=Z_DEFLATED$2+(_e.w_bits-8<<4)<<8,rt=-1;if(_e.strategy>=Z_HUFFMAN_ONLY||_e.level<2?rt=0:_e.level<6?rt=1:_e.level===6?rt=2:rt=3,nt|=rt<<6,_e.strstart!==0&&(nt|=PRESET_DICT),nt+=31-nt%31,putShortMSB(_e,nt),_e.strstart!==0&&(putShortMSB(_e,et.adler>>>16),putShortMSB(_e,et.adler&65535)),et.adler=1,_e.status=BUSY_STATE,flush_pending(et),_e.pending!==0)return _e.last_flush=-1,Z_OK$3}if(_e.status===GZIP_STATE){if(et.adler=0,put_byte(_e,31),put_byte(_e,139),put_byte(_e,8),_e.gzhead)put_byte(_e,(_e.gzhead.text?1:0)+(_e.gzhead.hcrc?2:0)+(_e.gzhead.extra?4:0)+(_e.gzhead.name?8:0)+(_e.gzhead.comment?16:0)),put_byte(_e,_e.gzhead.time&255),put_byte(_e,_e.gzhead.time>>8&255),put_byte(_e,_e.gzhead.time>>16&255),put_byte(_e,_e.gzhead.time>>24&255),put_byte(_e,_e.level===9?2:_e.strategy>=Z_HUFFMAN_ONLY||_e.level<2?4:0),put_byte(_e,_e.gzhead.os&255),_e.gzhead.extra&&_e.gzhead.extra.length&&(put_byte(_e,_e.gzhead.extra.length&255),put_byte(_e,_e.gzhead.extra.length>>8&255)),_e.gzhead.hcrc&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending,0)),_e.gzindex=0,_e.status=EXTRA_STATE;else if(put_byte(_e,0),put_byte(_e,0),put_byte(_e,0),put_byte(_e,0),put_byte(_e,0),put_byte(_e,_e.level===9?2:_e.strategy>=Z_HUFFMAN_ONLY||_e.level<2?4:0),put_byte(_e,OS_CODE),_e.status=BUSY_STATE,flush_pending(et),_e.pending!==0)return _e.last_flush=-1,Z_OK$3}if(_e.status===EXTRA_STATE){if(_e.gzhead.extra){let nt=_e.pending,rt=(_e.gzhead.extra.length&65535)-_e.gzindex;for(;_e.pending+rt>_e.pending_buf_size;){let st=_e.pending_buf_size-_e.pending;if(_e.pending_buf.set(_e.gzhead.extra.subarray(_e.gzindex,_e.gzindex+st),_e.pending),_e.pending=_e.pending_buf_size,_e.gzhead.hcrc&&_e.pending>nt&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending-nt,nt)),_e.gzindex+=st,flush_pending(et),_e.pending!==0)return _e.last_flush=-1,Z_OK$3;nt=0,rt-=st}let it=new Uint8Array(_e.gzhead.extra);_e.pending_buf.set(it.subarray(_e.gzindex,_e.gzindex+rt),_e.pending),_e.pending+=rt,_e.gzhead.hcrc&&_e.pending>nt&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending-nt,nt)),_e.gzindex=0}_e.status=NAME_STATE}if(_e.status===NAME_STATE){if(_e.gzhead.name){let nt=_e.pending,rt;do{if(_e.pending===_e.pending_buf_size){if(_e.gzhead.hcrc&&_e.pending>nt&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending-nt,nt)),flush_pending(et),_e.pending!==0)return _e.last_flush=-1,Z_OK$3;nt=0}_e.gzindex<_e.gzhead.name.length?rt=_e.gzhead.name.charCodeAt(_e.gzindex++)&255:rt=0,put_byte(_e,rt)}while(rt!==0);_e.gzhead.hcrc&&_e.pending>nt&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending-nt,nt)),_e.gzindex=0}_e.status=COMMENT_STATE}if(_e.status===COMMENT_STATE){if(_e.gzhead.comment){let nt=_e.pending,rt;do{if(_e.pending===_e.pending_buf_size){if(_e.gzhead.hcrc&&_e.pending>nt&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending-nt,nt)),flush_pending(et),_e.pending!==0)return _e.last_flush=-1,Z_OK$3;nt=0}_e.gzindex<_e.gzhead.comment.length?rt=_e.gzhead.comment.charCodeAt(_e.gzindex++)&255:rt=0,put_byte(_e,rt)}while(rt!==0);_e.gzhead.hcrc&&_e.pending>nt&&(et.adler=crc32_1(et.adler,_e.pending_buf,_e.pending-nt,nt))}_e.status=HCRC_STATE}if(_e.status===HCRC_STATE){if(_e.gzhead.hcrc){if(_e.pending+2>_e.pending_buf_size&&(flush_pending(et),_e.pending!==0))return _e.last_flush=-1,Z_OK$3;put_byte(_e,et.adler&255),put_byte(_e,et.adler>>8&255),et.adler=0}if(_e.status=BUSY_STATE,flush_pending(et),_e.pending!==0)return _e.last_flush=-1,Z_OK$3}if(et.avail_in!==0||_e.lookahead!==0||_!==Z_NO_FLUSH$2&&_e.status!==FINISH_STATE){let nt=_e.level===0?deflate_stored(_e,_):_e.strategy===Z_HUFFMAN_ONLY?deflate_huff(_e,_):_e.strategy===Z_RLE?deflate_rle(_e,_):configuration_table[_e.level].func(_e,_);if((nt===BS_FINISH_STARTED||nt===BS_FINISH_DONE)&&(_e.status=FINISH_STATE),nt===BS_NEED_MORE||nt===BS_FINISH_STARTED)return et.avail_out===0&&(_e.last_flush=-1),Z_OK$3;if(nt===BS_BLOCK_DONE&&(_===Z_PARTIAL_FLUSH?_tr_align(_e):_!==Z_BLOCK$1&&(_tr_stored_block(_e,0,0,!1),_===Z_FULL_FLUSH$1&&(zero(_e.head),_e.lookahead===0&&(_e.strstart=0,_e.block_start=0,_e.insert=0))),flush_pending(et),et.avail_out===0))return _e.last_flush=-1,Z_OK$3}return _!==Z_FINISH$3?Z_OK$3:_e.wrap<=0?Z_STREAM_END$3:(_e.wrap===2?(put_byte(_e,et.adler&255),put_byte(_e,et.adler>>8&255),put_byte(_e,et.adler>>16&255),put_byte(_e,et.adler>>24&255),put_byte(_e,et.total_in&255),put_byte(_e,et.total_in>>8&255),put_byte(_e,et.total_in>>16&255),put_byte(_e,et.total_in>>24&255)):(putShortMSB(_e,et.adler>>>16),putShortMSB(_e,et.adler&65535)),flush_pending(et),_e.wrap>0&&(_e.wrap=-_e.wrap),_e.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=et=>{if(deflateStateCheck(et))return Z_STREAM_ERROR$2;const _=et.state.status;return et.state=null,_===BUSY_STATE?err(et,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary=(et,_)=>{let _e=_.length;if(deflateStateCheck(et))return Z_STREAM_ERROR$2;const tt=et.state,nt=tt.wrap;if(nt===2||nt===1&&tt.status!==INIT_STATE||tt.lookahead)return Z_STREAM_ERROR$2;if(nt===1&&(et.adler=adler32_1(et.adler,_,_e,0)),tt.wrap=0,_e>=tt.w_size){nt===0&&(zero(tt.head),tt.strstart=0,tt.block_start=0,tt.insert=0);let ot=new Uint8Array(tt.w_size);ot.set(_.subarray(_e-tt.w_size,_e),0),_=ot,_e=tt.w_size}const rt=et.avail_in,it=et.next_in,st=et.input;for(et.avail_in=_e,et.next_in=0,et.input=_,fill_window(tt);tt.lookahead>=MIN_MATCH;){let ot=tt.strstart,at=tt.lookahead-(MIN_MATCH-1);do tt.ins_h=HASH(tt,tt.ins_h,tt.window[ot+MIN_MATCH-1]),tt.prev[ot&tt.w_mask]=tt.head[tt.ins_h],tt.head[tt.ins_h]=ot,ot++;while(--at);tt.strstart=ot,tt.lookahead=MIN_MATCH-1,fill_window(tt)}return tt.strstart+=tt.lookahead,tt.block_start=tt.strstart,tt.insert=tt.lookahead,tt.lookahead=0,tt.match_length=tt.prev_length=MIN_MATCH-1,tt.match_available=0,et.next_in=it,et.input=st,et.avail_in=rt,tt.wrap=nt,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has=(et,_)=>Object.prototype.hasOwnProperty.call(et,_);var assign=function(et){const _=Array.prototype.slice.call(arguments,1);for(;_.length;){const _e=_.shift();if(_e){if(typeof _e!="object")throw new TypeError(_e+"must be non-object");for(const tt in _e)_has(_e,tt)&&(et[tt]=_e[tt])}}return et},flattenChunks=et=>{let _=0;for(let tt=0,nt=et.length;tt<nt;tt++)_+=et[tt].length;const _e=new Uint8Array(_);for(let tt=0,nt=0,rt=et.length;tt<rt;tt++){let it=et[tt];_e.set(it,nt),nt+=it.length}return _e},common={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let et=0;et<256;et++)_utf8len[et]=et>=252?6:et>=248?5:et>=240?4:et>=224?3:et>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=et=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(et);let _,_e,tt,nt,rt,it=et.length,st=0;for(nt=0;nt<it;nt++)_e=et.charCodeAt(nt),(_e&64512)===55296&&nt+1<it&&(tt=et.charCodeAt(nt+1),(tt&64512)===56320&&(_e=65536+(_e-55296<<10)+(tt-56320),nt++)),st+=_e<128?1:_e<2048?2:_e<65536?3:4;for(_=new Uint8Array(st),rt=0,nt=0;rt<st;nt++)_e=et.charCodeAt(nt),(_e&64512)===55296&&nt+1<it&&(tt=et.charCodeAt(nt+1),(tt&64512)===56320&&(_e=65536+(_e-55296<<10)+(tt-56320),nt++)),_e<128?_[rt++]=_e:_e<2048?(_[rt++]=192|_e>>>6,_[rt++]=128|_e&63):_e<65536?(_[rt++]=224|_e>>>12,_[rt++]=128|_e>>>6&63,_[rt++]=128|_e&63):(_[rt++]=240|_e>>>18,_[rt++]=128|_e>>>12&63,_[rt++]=128|_e>>>6&63,_[rt++]=128|_e&63);return _};const buf2binstring=(et,_)=>{if(_<65534&&et.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,et.length===_?et:et.subarray(0,_));let _e="";for(let tt=0;tt<_;tt++)_e+=String.fromCharCode(et[tt]);return _e};var buf2string=(et,_)=>{const _e=_||et.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(et.subarray(0,_));let tt,nt;const rt=new Array(_e*2);for(nt=0,tt=0;tt<_e;){let it=et[tt++];if(it<128){rt[nt++]=it;continue}let st=_utf8len[it];if(st>4){rt[nt++]=65533,tt+=st-1;continue}for(it&=st===2?31:st===3?15:7;st>1&&tt<_e;)it=it<<6|et[tt++]&63,st--;if(st>1){rt[nt++]=65533;continue}it<65536?rt[nt++]=it:(it-=65536,rt[nt++]=55296|it>>10&1023,rt[nt++]=56320|it&1023)}return buf2binstring(rt,nt)},utf8border=(et,_)=>{_=_||et.length,_>et.length&&(_=et.length);let _e=_-1;for(;_e>=0&&(et[_e]&192)===128;)_e--;return _e<0||_e===0?_:_e+_utf8len[et[_e]]>_?_e:_},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const toString$1$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2;function Deflate$1(et){this.options=common.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},et||{});let _=this.options;_.raw&&_.windowBits>0?_.windowBits=-_.windowBits:_.gzip&&_.windowBits>0&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let _e=deflate_1$2.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(_e!==Z_OK$2)throw new Error(messages[_e]);if(_.header&&deflate_1$2.deflateSetHeader(this.strm,_.header),_.dictionary){let tt;if(typeof _.dictionary=="string"?tt=strings.string2buf(_.dictionary):toString$1$1.call(_.dictionary)==="[object ArrayBuffer]"?tt=new Uint8Array(_.dictionary):tt=_.dictionary,_e=deflate_1$2.deflateSetDictionary(this.strm,tt),_e!==Z_OK$2)throw new Error(messages[_e]);this._dict_set=!0}}Deflate$1.prototype.push=function(et,_){const _e=this.strm,tt=this.options.chunkSize;let nt,rt;if(this.ended)return!1;for(_===~~_?rt=_:rt=_===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof et=="string"?_e.input=strings.string2buf(et):toString$1$1.call(et)==="[object ArrayBuffer]"?_e.input=new Uint8Array(et):_e.input=et,_e.next_in=0,_e.avail_in=_e.input.length;;){if(_e.avail_out===0&&(_e.output=new Uint8Array(tt),_e.next_out=0,_e.avail_out=tt),(rt===Z_SYNC_FLUSH||rt===Z_FULL_FLUSH)&&_e.avail_out<=6){this.onData(_e.output.subarray(0,_e.next_out)),_e.avail_out=0;continue}if(nt=deflate_1$2.deflate(_e,rt),nt===Z_STREAM_END$2)return _e.next_out>0&&this.onData(_e.output.subarray(0,_e.next_out)),nt=deflate_1$2.deflateEnd(this.strm),this.onEnd(nt),this.ended=!0,nt===Z_OK$2;if(_e.avail_out===0){this.onData(_e.output);continue}if(rt>0&&_e.next_out>0){this.onData(_e.output.subarray(0,_e.next_out)),_e.avail_out=0;continue}if(_e.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(et){this.chunks.push(et)};Deflate$1.prototype.onEnd=function(et){et===Z_OK$2&&(this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=et,this.msg=this.strm.msg};function deflate$1(et,_){const _e=new Deflate$1(_);if(_e.push(et,!0),_e.err)throw _e.msg||messages[_e.err];return _e.result}function deflateRaw$1(et,_){return _=_||{},_.raw=!0,deflate$1(et,_)}function gzip$1(et,_){return _=_||{},_.gzip=!0,deflate$1(et,_)}var Deflate_1$1=Deflate$1,deflate_2=deflate$1,deflateRaw_1$1=deflateRaw$1,gzip_1$1=gzip$1,constants$1=constants$2,deflate_1$1={Deflate:Deflate_1$1,deflate:deflate_2,deflateRaw:deflateRaw_1$1,gzip:gzip_1$1,constants:constants$1};const BAD$1=16209,TYPE$1=16191;var inffast=function(_,_e){let tt,nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt,pt,mt,vt,yt,_t,St,bt,Et,Mt,Tt,wt;const Ct=_.state;tt=_.next_in,Tt=_.input,nt=tt+(_.avail_in-5),rt=_.next_out,wt=_.output,it=rt-(_e-_.avail_out),st=rt+(_.avail_out-257),ot=Ct.dmax,at=Ct.wsize,lt=Ct.whave,ct=Ct.wnext,ht=Ct.window,ut=Ct.hold,ft=Ct.bits,dt=Ct.lencode,pt=Ct.distcode,mt=(1<<Ct.lenbits)-1,vt=(1<<Ct.distbits)-1;e:do{ft<15&&(ut+=Tt[tt++]<<ft,ft+=8,ut+=Tt[tt++]<<ft,ft+=8),yt=dt[ut&mt];t:for(;;){if(_t=yt>>>24,ut>>>=_t,ft-=_t,_t=yt>>>16&255,_t===0)wt[rt++]=yt&65535;else if(_t&16){St=yt&65535,_t&=15,_t&&(ft<_t&&(ut+=Tt[tt++]<<ft,ft+=8),St+=ut&(1<<_t)-1,ut>>>=_t,ft-=_t),ft<15&&(ut+=Tt[tt++]<<ft,ft+=8,ut+=Tt[tt++]<<ft,ft+=8),yt=pt[ut&vt];n:for(;;){if(_t=yt>>>24,ut>>>=_t,ft-=_t,_t=yt>>>16&255,_t&16){if(bt=yt&65535,_t&=15,ft<_t&&(ut+=Tt[tt++]<<ft,ft+=8,ft<_t&&(ut+=Tt[tt++]<<ft,ft+=8)),bt+=ut&(1<<_t)-1,bt>ot){_.msg="invalid distance too far back",Ct.mode=BAD$1;break e}if(ut>>>=_t,ft-=_t,_t=rt-it,bt>_t){if(_t=bt-_t,_t>lt&&Ct.sane){_.msg="invalid distance too far back",Ct.mode=BAD$1;break e}if(Et=0,Mt=ht,ct===0){if(Et+=at-_t,_t<St){St-=_t;do wt[rt++]=ht[Et++];while(--_t);Et=rt-bt,Mt=wt}}else if(ct<_t){if(Et+=at+ct-_t,_t-=ct,_t<St){St-=_t;do wt[rt++]=ht[Et++];while(--_t);if(Et=0,ct<St){_t=ct,St-=_t;do wt[rt++]=ht[Et++];while(--_t);Et=rt-bt,Mt=wt}}}else if(Et+=ct-_t,_t<St){St-=_t;do wt[rt++]=ht[Et++];while(--_t);Et=rt-bt,Mt=wt}for(;St>2;)wt[rt++]=Mt[Et++],wt[rt++]=Mt[Et++],wt[rt++]=Mt[Et++],St-=3;St&&(wt[rt++]=Mt[Et++],St>1&&(wt[rt++]=Mt[Et++]))}else{Et=rt-bt;do wt[rt++]=wt[Et++],wt[rt++]=wt[Et++],wt[rt++]=wt[Et++],St-=3;while(St>2);St&&(wt[rt++]=wt[Et++],St>1&&(wt[rt++]=wt[Et++]))}}else if(_t&64){_.msg="invalid distance code",Ct.mode=BAD$1;break e}else{yt=pt[(yt&65535)+(ut&(1<<_t)-1)];continue n}break}}else if(_t&64)if(_t&32){Ct.mode=TYPE$1;break e}else{_.msg="invalid literal/length code",Ct.mode=BAD$1;break e}else{yt=dt[(yt&65535)+(ut&(1<<_t)-1)];continue t}break}}while(tt<nt&&rt<st);St=ft>>3,tt-=St,ft-=St<<3,ut&=(1<<ft)-1,_.next_in=tt,_.next_out=rt,_.avail_in=tt<nt?5+(nt-tt):5-(tt-nt),_.avail_out=rt<st?257+(st-rt):257-(rt-st),Ct.hold=ut,Ct.bits=ft};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(et,_,_e,tt,nt,rt,it,st)=>{const ot=st.bits;let at=0,lt=0,ct=0,ht=0,ut=0,ft=0,dt=0,pt=0,mt=0,vt=0,yt,_t,St,bt,Et,Mt=null,Tt;const wt=new Uint16Array(MAXBITS+1),Ct=new Uint16Array(MAXBITS+1);let Rt=null,It,Dt,Ft;for(at=0;at<=MAXBITS;at++)wt[at]=0;for(lt=0;lt<tt;lt++)wt[_[_e+lt]]++;for(ut=ot,ht=MAXBITS;ht>=1&&wt[ht]===0;ht--);if(ut>ht&&(ut=ht),ht===0)return nt[rt++]=1<<24|64<<16|0,nt[rt++]=1<<24|64<<16|0,st.bits=1,0;for(ct=1;ct<ht&&wt[ct]===0;ct++);for(ut<ct&&(ut=ct),pt=1,at=1;at<=MAXBITS;at++)if(pt<<=1,pt-=wt[at],pt<0)return-1;if(pt>0&&(et===CODES$1||ht!==1))return-1;for(Ct[1]=0,at=1;at<MAXBITS;at++)Ct[at+1]=Ct[at]+wt[at];for(lt=0;lt<tt;lt++)_[_e+lt]!==0&&(it[Ct[_[_e+lt]]++]=lt);if(et===CODES$1?(Mt=Rt=it,Tt=20):et===LENS$1?(Mt=lbase,Rt=lext,Tt=257):(Mt=dbase,Rt=dext,Tt=0),vt=0,lt=0,at=ct,Et=rt,ft=ut,dt=0,St=-1,mt=1<<ut,bt=mt-1,et===LENS$1&&mt>ENOUGH_LENS$1||et===DISTS$1&&mt>ENOUGH_DISTS$1)return 1;for(;;){It=at-dt,it[lt]+1<Tt?(Dt=0,Ft=it[lt]):it[lt]>=Tt?(Dt=Rt[it[lt]-Tt],Ft=Mt[it[lt]-Tt]):(Dt=96,Ft=0),yt=1<<at-dt,_t=1<<ft,ct=_t;do _t-=yt,nt[Et+(vt>>dt)+_t]=It<<24|Dt<<16|Ft|0;while(_t!==0);for(yt=1<<at-1;vt&yt;)yt>>=1;if(yt!==0?(vt&=yt-1,vt+=yt):vt=0,lt++,--wt[at]===0){if(at===ht)break;at=_[_e+it[lt]]}if(at>ut&&(vt&bt)!==St){for(dt===0&&(dt=ut),Et+=ct,ft=at-dt,pt=1<<ft;ft+dt<ht&&(pt-=wt[ft+dt],!(pt<=0));)ft++,pt<<=1;if(mt+=1<<ft,et===LENS$1&&mt>ENOUGH_LENS$1||et===DISTS$1&&mt>ENOUGH_DISTS$1)return 1;St=vt&bt,nt[St]=ut<<24|ft<<16|Et-rt|0}}return vt!==0&&(nt[Et+vt]=at-dt<<24|64<<16|0),st.bits=ut,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=et=>(et>>>24&255)+(et>>>8&65280)+((et&65280)<<8)+((et&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=et=>{if(!et)return 1;const _=et.state;return!_||_.strm!==et||_.mode<HEAD||_.mode>SYNC?1:0},inflateResetKeep=et=>{if(inflateStateCheck(et))return Z_STREAM_ERROR$1;const _=et.state;return et.total_in=et.total_out=_.total=0,et.msg="",_.wrap&&(et.adler=_.wrap&1),_.mode=HEAD,_.last=0,_.havedict=0,_.flags=-1,_.dmax=32768,_.head=null,_.hold=0,_.bits=0,_.lencode=_.lendyn=new Int32Array(ENOUGH_LENS),_.distcode=_.distdyn=new Int32Array(ENOUGH_DISTS),_.sane=1,_.back=-1,Z_OK$1},inflateReset=et=>{if(inflateStateCheck(et))return Z_STREAM_ERROR$1;const _=et.state;return _.wsize=0,_.whave=0,_.wnext=0,inflateResetKeep(et)},inflateReset2=(et,_)=>{let _e;if(inflateStateCheck(et))return Z_STREAM_ERROR$1;const tt=et.state;return _<0?(_e=0,_=-_):(_e=(_>>4)+5,_<48&&(_&=15)),_&&(_<8||_>15)?Z_STREAM_ERROR$1:(tt.window!==null&&tt.wbits!==_&&(tt.window=null),tt.wrap=_e,tt.wbits=_,inflateReset(et))},inflateInit2=(et,_)=>{if(!et)return Z_STREAM_ERROR$1;const _e=new InflateState;et.state=_e,_e.strm=et,_e.window=null,_e.mode=HEAD;const tt=inflateReset2(et,_);return tt!==Z_OK$1&&(et.state=null),tt},inflateInit=et=>inflateInit2(et,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=et=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let _=0;for(;_<144;)et.lens[_++]=8;for(;_<256;)et.lens[_++]=9;for(;_<280;)et.lens[_++]=7;for(;_<288;)et.lens[_++]=8;for(inftrees(LENS,et.lens,0,288,lenfix,0,et.work,{bits:9}),_=0;_<32;)et.lens[_++]=5;inftrees(DISTS,et.lens,0,32,distfix,0,et.work,{bits:5}),virgin=!1}et.lencode=lenfix,et.lenbits=9,et.distcode=distfix,et.distbits=5},updatewindow=(et,_,_e,tt)=>{let nt;const rt=et.state;return rt.window===null&&(rt.wsize=1<<rt.wbits,rt.wnext=0,rt.whave=0,rt.window=new Uint8Array(rt.wsize)),tt>=rt.wsize?(rt.window.set(_.subarray(_e-rt.wsize,_e),0),rt.wnext=0,rt.whave=rt.wsize):(nt=rt.wsize-rt.wnext,nt>tt&&(nt=tt),rt.window.set(_.subarray(_e-tt,_e-tt+nt),rt.wnext),tt-=nt,tt?(rt.window.set(_.subarray(_e-tt,_e),0),rt.wnext=tt,rt.whave=rt.wsize):(rt.wnext+=nt,rt.wnext===rt.wsize&&(rt.wnext=0),rt.whave<rt.wsize&&(rt.whave+=nt))),0},inflate$2=(et,_)=>{let _e,tt,nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt,pt=0,mt,vt,yt,_t,St,bt,Et,Mt;const Tt=new Uint8Array(4);let wt,Ct;const Rt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(et)||!et.output||!et.input&&et.avail_in!==0)return Z_STREAM_ERROR$1;_e=et.state,_e.mode===TYPE&&(_e.mode=TYPEDO),it=et.next_out,nt=et.output,ot=et.avail_out,rt=et.next_in,tt=et.input,st=et.avail_in,at=_e.hold,lt=_e.bits,ct=st,ht=ot,Mt=Z_OK$1;e:for(;;)switch(_e.mode){case HEAD:if(_e.wrap===0){_e.mode=TYPEDO;break}for(;lt<16;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(_e.wrap&2&&at===35615){_e.wbits===0&&(_e.wbits=15),_e.check=0,Tt[0]=at&255,Tt[1]=at>>>8&255,_e.check=crc32_1(_e.check,Tt,2,0),at=0,lt=0,_e.mode=FLAGS;break}if(_e.head&&(_e.head.done=!1),!(_e.wrap&1)||(((at&255)<<8)+(at>>8))%31){et.msg="incorrect header check",_e.mode=BAD;break}if((at&15)!==Z_DEFLATED){et.msg="unknown compression method",_e.mode=BAD;break}if(at>>>=4,lt-=4,Et=(at&15)+8,_e.wbits===0&&(_e.wbits=Et),Et>15||Et>_e.wbits){et.msg="invalid window size",_e.mode=BAD;break}_e.dmax=1<<_e.wbits,_e.flags=0,et.adler=_e.check=1,_e.mode=at&512?DICTID:TYPE,at=0,lt=0;break;case FLAGS:for(;lt<16;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(_e.flags=at,(_e.flags&255)!==Z_DEFLATED){et.msg="unknown compression method",_e.mode=BAD;break}if(_e.flags&57344){et.msg="unknown header flags set",_e.mode=BAD;break}_e.head&&(_e.head.text=at>>8&1),_e.flags&512&&_e.wrap&4&&(Tt[0]=at&255,Tt[1]=at>>>8&255,_e.check=crc32_1(_e.check,Tt,2,0)),at=0,lt=0,_e.mode=TIME;case TIME:for(;lt<32;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}_e.head&&(_e.head.time=at),_e.flags&512&&_e.wrap&4&&(Tt[0]=at&255,Tt[1]=at>>>8&255,Tt[2]=at>>>16&255,Tt[3]=at>>>24&255,_e.check=crc32_1(_e.check,Tt,4,0)),at=0,lt=0,_e.mode=OS;case OS:for(;lt<16;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}_e.head&&(_e.head.xflags=at&255,_e.head.os=at>>8),_e.flags&512&&_e.wrap&4&&(Tt[0]=at&255,Tt[1]=at>>>8&255,_e.check=crc32_1(_e.check,Tt,2,0)),at=0,lt=0,_e.mode=EXLEN;case EXLEN:if(_e.flags&1024){for(;lt<16;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}_e.length=at,_e.head&&(_e.head.extra_len=at),_e.flags&512&&_e.wrap&4&&(Tt[0]=at&255,Tt[1]=at>>>8&255,_e.check=crc32_1(_e.check,Tt,2,0)),at=0,lt=0}else _e.head&&(_e.head.extra=null);_e.mode=EXTRA;case EXTRA:if(_e.flags&1024&&(ut=_e.length,ut>st&&(ut=st),ut&&(_e.head&&(Et=_e.head.extra_len-_e.length,_e.head.extra||(_e.head.extra=new Uint8Array(_e.head.extra_len)),_e.head.extra.set(tt.subarray(rt,rt+ut),Et)),_e.flags&512&&_e.wrap&4&&(_e.check=crc32_1(_e.check,tt,ut,rt)),st-=ut,rt+=ut,_e.length-=ut),_e.length))break e;_e.length=0,_e.mode=NAME;case NAME:if(_e.flags&2048){if(st===0)break e;ut=0;do Et=tt[rt+ut++],_e.head&&Et&&_e.length<65536&&(_e.head.name+=String.fromCharCode(Et));while(Et&&ut<st);if(_e.flags&512&&_e.wrap&4&&(_e.check=crc32_1(_e.check,tt,ut,rt)),st-=ut,rt+=ut,Et)break e}else _e.head&&(_e.head.name=null);_e.length=0,_e.mode=COMMENT;case COMMENT:if(_e.flags&4096){if(st===0)break e;ut=0;do Et=tt[rt+ut++],_e.head&&Et&&_e.length<65536&&(_e.head.comment+=String.fromCharCode(Et));while(Et&&ut<st);if(_e.flags&512&&_e.wrap&4&&(_e.check=crc32_1(_e.check,tt,ut,rt)),st-=ut,rt+=ut,Et)break e}else _e.head&&(_e.head.comment=null);_e.mode=HCRC;case HCRC:if(_e.flags&512){for(;lt<16;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(_e.wrap&4&&at!==(_e.check&65535)){et.msg="header crc mismatch",_e.mode=BAD;break}at=0,lt=0}_e.head&&(_e.head.hcrc=_e.flags>>9&1,_e.head.done=!0),et.adler=_e.check=0,_e.mode=TYPE;break;case DICTID:for(;lt<32;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}et.adler=_e.check=zswap32(at),at=0,lt=0,_e.mode=DICT;case DICT:if(_e.havedict===0)return et.next_out=it,et.avail_out=ot,et.next_in=rt,et.avail_in=st,_e.hold=at,_e.bits=lt,Z_NEED_DICT$1;et.adler=_e.check=1,_e.mode=TYPE;case TYPE:if(_===Z_BLOCK||_===Z_TREES)break e;case TYPEDO:if(_e.last){at>>>=lt&7,lt-=lt&7,_e.mode=CHECK;break}for(;lt<3;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}switch(_e.last=at&1,at>>>=1,lt-=1,at&3){case 0:_e.mode=STORED;break;case 1:if(fixedtables(_e),_e.mode=LEN_,_===Z_TREES){at>>>=2,lt-=2;break e}break;case 2:_e.mode=TABLE;break;case 3:et.msg="invalid block type",_e.mode=BAD}at>>>=2,lt-=2;break;case STORED:for(at>>>=lt&7,lt-=lt&7;lt<32;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if((at&65535)!==(at>>>16^65535)){et.msg="invalid stored block lengths",_e.mode=BAD;break}if(_e.length=at&65535,at=0,lt=0,_e.mode=COPY_,_===Z_TREES)break e;case COPY_:_e.mode=COPY;case COPY:if(ut=_e.length,ut){if(ut>st&&(ut=st),ut>ot&&(ut=ot),ut===0)break e;nt.set(tt.subarray(rt,rt+ut),it),st-=ut,rt+=ut,ot-=ut,it+=ut,_e.length-=ut;break}_e.mode=TYPE;break;case TABLE:for(;lt<14;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(_e.nlen=(at&31)+257,at>>>=5,lt-=5,_e.ndist=(at&31)+1,at>>>=5,lt-=5,_e.ncode=(at&15)+4,at>>>=4,lt-=4,_e.nlen>286||_e.ndist>30){et.msg="too many length or distance symbols",_e.mode=BAD;break}_e.have=0,_e.mode=LENLENS;case LENLENS:for(;_e.have<_e.ncode;){for(;lt<3;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}_e.lens[Rt[_e.have++]]=at&7,at>>>=3,lt-=3}for(;_e.have<19;)_e.lens[Rt[_e.have++]]=0;if(_e.lencode=_e.lendyn,_e.lenbits=7,wt={bits:_e.lenbits},Mt=inftrees(CODES,_e.lens,0,19,_e.lencode,0,_e.work,wt),_e.lenbits=wt.bits,Mt){et.msg="invalid code lengths set",_e.mode=BAD;break}_e.have=0,_e.mode=CODELENS;case CODELENS:for(;_e.have<_e.nlen+_e.ndist;){for(;pt=_e.lencode[at&(1<<_e.lenbits)-1],mt=pt>>>24,vt=pt>>>16&255,yt=pt&65535,!(mt<=lt);){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(yt<16)at>>>=mt,lt-=mt,_e.lens[_e.have++]=yt;else{if(yt===16){for(Ct=mt+2;lt<Ct;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(at>>>=mt,lt-=mt,_e.have===0){et.msg="invalid bit length repeat",_e.mode=BAD;break}Et=_e.lens[_e.have-1],ut=3+(at&3),at>>>=2,lt-=2}else if(yt===17){for(Ct=mt+3;lt<Ct;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}at>>>=mt,lt-=mt,Et=0,ut=3+(at&7),at>>>=3,lt-=3}else{for(Ct=mt+7;lt<Ct;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}at>>>=mt,lt-=mt,Et=0,ut=11+(at&127),at>>>=7,lt-=7}if(_e.have+ut>_e.nlen+_e.ndist){et.msg="invalid bit length repeat",_e.mode=BAD;break}for(;ut--;)_e.lens[_e.have++]=Et}}if(_e.mode===BAD)break;if(_e.lens[256]===0){et.msg="invalid code -- missing end-of-block",_e.mode=BAD;break}if(_e.lenbits=9,wt={bits:_e.lenbits},Mt=inftrees(LENS,_e.lens,0,_e.nlen,_e.lencode,0,_e.work,wt),_e.lenbits=wt.bits,Mt){et.msg="invalid literal/lengths set",_e.mode=BAD;break}if(_e.distbits=6,_e.distcode=_e.distdyn,wt={bits:_e.distbits},Mt=inftrees(DISTS,_e.lens,_e.nlen,_e.ndist,_e.distcode,0,_e.work,wt),_e.distbits=wt.bits,Mt){et.msg="invalid distances set",_e.mode=BAD;break}if(_e.mode=LEN_,_===Z_TREES)break e;case LEN_:_e.mode=LEN;case LEN:if(st>=6&&ot>=258){et.next_out=it,et.avail_out=ot,et.next_in=rt,et.avail_in=st,_e.hold=at,_e.bits=lt,inffast(et,ht),it=et.next_out,nt=et.output,ot=et.avail_out,rt=et.next_in,tt=et.input,st=et.avail_in,at=_e.hold,lt=_e.bits,_e.mode===TYPE&&(_e.back=-1);break}for(_e.back=0;pt=_e.lencode[at&(1<<_e.lenbits)-1],mt=pt>>>24,vt=pt>>>16&255,yt=pt&65535,!(mt<=lt);){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(vt&&!(vt&240)){for(_t=mt,St=vt,bt=yt;pt=_e.lencode[bt+((at&(1<<_t+St)-1)>>_t)],mt=pt>>>24,vt=pt>>>16&255,yt=pt&65535,!(_t+mt<=lt);){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}at>>>=_t,lt-=_t,_e.back+=_t}if(at>>>=mt,lt-=mt,_e.back+=mt,_e.length=yt,vt===0){_e.mode=LIT;break}if(vt&32){_e.back=-1,_e.mode=TYPE;break}if(vt&64){et.msg="invalid literal/length code",_e.mode=BAD;break}_e.extra=vt&15,_e.mode=LENEXT;case LENEXT:if(_e.extra){for(Ct=_e.extra;lt<Ct;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}_e.length+=at&(1<<_e.extra)-1,at>>>=_e.extra,lt-=_e.extra,_e.back+=_e.extra}_e.was=_e.length,_e.mode=DIST;case DIST:for(;pt=_e.distcode[at&(1<<_e.distbits)-1],mt=pt>>>24,vt=pt>>>16&255,yt=pt&65535,!(mt<=lt);){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(!(vt&240)){for(_t=mt,St=vt,bt=yt;pt=_e.distcode[bt+((at&(1<<_t+St)-1)>>_t)],mt=pt>>>24,vt=pt>>>16&255,yt=pt&65535,!(_t+mt<=lt);){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}at>>>=_t,lt-=_t,_e.back+=_t}if(at>>>=mt,lt-=mt,_e.back+=mt,vt&64){et.msg="invalid distance code",_e.mode=BAD;break}_e.offset=yt,_e.extra=vt&15,_e.mode=DISTEXT;case DISTEXT:if(_e.extra){for(Ct=_e.extra;lt<Ct;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}_e.offset+=at&(1<<_e.extra)-1,at>>>=_e.extra,lt-=_e.extra,_e.back+=_e.extra}if(_e.offset>_e.dmax){et.msg="invalid distance too far back",_e.mode=BAD;break}_e.mode=MATCH;case MATCH:if(ot===0)break e;if(ut=ht-ot,_e.offset>ut){if(ut=_e.offset-ut,ut>_e.whave&&_e.sane){et.msg="invalid distance too far back",_e.mode=BAD;break}ut>_e.wnext?(ut-=_e.wnext,ft=_e.wsize-ut):ft=_e.wnext-ut,ut>_e.length&&(ut=_e.length),dt=_e.window}else dt=nt,ft=it-_e.offset,ut=_e.length;ut>ot&&(ut=ot),ot-=ut,_e.length-=ut;do nt[it++]=dt[ft++];while(--ut);_e.length===0&&(_e.mode=LEN);break;case LIT:if(ot===0)break e;nt[it++]=_e.length,ot--,_e.mode=LEN;break;case CHECK:if(_e.wrap){for(;lt<32;){if(st===0)break e;st--,at|=tt[rt++]<<lt,lt+=8}if(ht-=ot,et.total_out+=ht,_e.total+=ht,_e.wrap&4&&ht&&(et.adler=_e.check=_e.flags?crc32_1(_e.check,nt,ht,it-ht):adler32_1(_e.check,nt,ht,it-ht)),ht=ot,_e.wrap&4&&(_e.flags?at:zswap32(at))!==_e.check){et.msg="incorrect data check",_e.mode=BAD;break}at=0,lt=0}_e.mode=LENGTH;case LENGTH:if(_e.wrap&&_e.flags){for(;lt<32;){if(st===0)break e;st--,at+=tt[rt++]<<lt,lt+=8}if(_e.wrap&4&&at!==(_e.total&4294967295)){et.msg="incorrect length check",_e.mode=BAD;break}at=0,lt=0}_e.mode=DONE;case DONE:Mt=Z_STREAM_END$1;break e;case BAD:Mt=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return et.next_out=it,et.avail_out=ot,et.next_in=rt,et.avail_in=st,_e.hold=at,_e.bits=lt,(_e.wsize||ht!==et.avail_out&&_e.mode<BAD&&(_e.mode<CHECK||_!==Z_FINISH$1))&&updatewindow(et,et.output,et.next_out,ht-et.avail_out),ct-=et.avail_in,ht-=et.avail_out,et.total_in+=ct,et.total_out+=ht,_e.total+=ht,_e.wrap&4&&ht&&(et.adler=_e.check=_e.flags?crc32_1(_e.check,nt,ht,et.next_out-ht):adler32_1(_e.check,nt,ht,et.next_out-ht)),et.data_type=_e.bits+(_e.last?64:0)+(_e.mode===TYPE?128:0)+(_e.mode===LEN_||_e.mode===COPY_?256:0),(ct===0&&ht===0||_===Z_FINISH$1)&&Mt===Z_OK$1&&(Mt=Z_BUF_ERROR),Mt},inflateEnd=et=>{if(inflateStateCheck(et))return Z_STREAM_ERROR$1;let _=et.state;return _.window&&(_.window=null),et.state=null,Z_OK$1},inflateGetHeader=(et,_)=>{if(inflateStateCheck(et))return Z_STREAM_ERROR$1;const _e=et.state;return _e.wrap&2?(_e.head=_,_.done=!1,Z_OK$1):Z_STREAM_ERROR$1},inflateSetDictionary=(et,_)=>{const _e=_.length;let tt,nt,rt;return inflateStateCheck(et)||(tt=et.state,tt.wrap!==0&&tt.mode!==DICT)?Z_STREAM_ERROR$1:tt.mode===DICT&&(nt=1,nt=adler32_1(nt,_,_e,0),nt!==tt.check)?Z_DATA_ERROR$1:(rt=updatewindow(et,_,_e,_e),rt?(tt.mode=MEM,Z_MEM_ERROR$1):(tt.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString$3=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(et){this.options=common.assign({chunkSize:1024*64,windowBits:15,to:""},et||{});const _=this.options;_.raw&&_.windowBits>=0&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),_.windowBits>=0&&_.windowBits<16&&!(et&&et.windowBits)&&(_.windowBits+=32),_.windowBits>15&&_.windowBits<48&&(_.windowBits&15||(_.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let _e=inflate_1$2.inflateInit2(this.strm,_.windowBits);if(_e!==Z_OK)throw new Error(messages[_e]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),_.dictionary&&(typeof _.dictionary=="string"?_.dictionary=strings.string2buf(_.dictionary):toString$3.call(_.dictionary)==="[object ArrayBuffer]"&&(_.dictionary=new Uint8Array(_.dictionary)),_.raw&&(_e=inflate_1$2.inflateSetDictionary(this.strm,_.dictionary),_e!==Z_OK)))throw new Error(messages[_e])}Inflate$1.prototype.push=function(et,_){const _e=this.strm,tt=this.options.chunkSize,nt=this.options.dictionary;let rt,it,st;if(this.ended)return!1;for(_===~~_?it=_:it=_===!0?Z_FINISH:Z_NO_FLUSH,toString$3.call(et)==="[object ArrayBuffer]"?_e.input=new Uint8Array(et):_e.input=et,_e.next_in=0,_e.avail_in=_e.input.length;;){for(_e.avail_out===0&&(_e.output=new Uint8Array(tt),_e.next_out=0,_e.avail_out=tt),rt=inflate_1$2.inflate(_e,it),rt===Z_NEED_DICT&&nt&&(rt=inflate_1$2.inflateSetDictionary(_e,nt),rt===Z_OK?rt=inflate_1$2.inflate(_e,it):rt===Z_DATA_ERROR&&(rt=Z_NEED_DICT));_e.avail_in>0&&rt===Z_STREAM_END&&_e.state.wrap>0&&et[_e.next_in]!==0;)inflate_1$2.inflateReset(_e),rt=inflate_1$2.inflate(_e,it);switch(rt){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(rt),this.ended=!0,!1}if(st=_e.avail_out,_e.next_out&&(_e.avail_out===0||rt===Z_STREAM_END))if(this.options.to==="string"){let ot=strings.utf8border(_e.output,_e.next_out),at=_e.next_out-ot,lt=strings.buf2string(_e.output,ot);_e.next_out=at,_e.avail_out=tt-at,at&&_e.output.set(_e.output.subarray(ot,ot+at),0),this.onData(lt)}else this.onData(_e.output.length===_e.next_out?_e.output:_e.output.subarray(0,_e.next_out));if(!(rt===Z_OK&&st===0)){if(rt===Z_STREAM_END)return rt=inflate_1$2.inflateEnd(this.strm),this.onEnd(rt),this.ended=!0,!0;if(_e.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(et){this.chunks.push(et)};Inflate$1.prototype.onEnd=function(et){et===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=et,this.msg=this.strm.msg};function inflate$1(et,_){const _e=new Inflate$1(_);if(_e.push(et),_e.err)throw _e.msg||messages[_e.err];return _e.result}function inflateRaw$1(et,_){return _=_||{},_.raw=!0,inflate$1(et,_)}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants};const{Deflate,deflate,deflateRaw,gzip}=deflate_1$1,{Inflate,inflate,inflateRaw,ungzip}=inflate_1$1;var deflate_1=deflate,Inflate_1=Inflate,inflate_1=inflate;const pngSignature=[137,80,78,71,13,10,26,10],crcTable=[];for(let et=0;et<256;et++){let _=et;for(let _e=0;_e<8;_e++)_&1?_=3988292384^_>>>1:_=_>>>1;crcTable[et]=_}const initialCrc=4294967295;function updateCrc(et,_,_e){let tt=et;for(let nt=0;nt<_e;nt++)tt=crcTable[(tt^_[nt])&255]^tt>>>8;return tt}function crc(et,_){return(updateCrc(initialCrc,et,_)^initialCrc)>>>0}var ColorType;(function(et){et[et.UNKNOWN=-1]="UNKNOWN",et[et.GREYSCALE=0]="GREYSCALE",et[et.TRUECOLOUR=2]="TRUECOLOUR",et[et.INDEXED_COLOUR=3]="INDEXED_COLOUR",et[et.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",et[et.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"})(ColorType||(ColorType={}));var CompressionMethod;(function(et){et[et.UNKNOWN=-1]="UNKNOWN",et[et.DEFLATE=0]="DEFLATE"})(CompressionMethod||(CompressionMethod={}));var FilterMethod;(function(et){et[et.UNKNOWN=-1]="UNKNOWN",et[et.ADAPTIVE=0]="ADAPTIVE"})(FilterMethod||(FilterMethod={}));var InterlaceMethod;(function(et){et[et.UNKNOWN=-1]="UNKNOWN",et[et.NO_INTERLACE=0]="NO_INTERLACE",et[et.ADAM7=1]="ADAM7"})(InterlaceMethod||(InterlaceMethod={}));const empty=new Uint8Array(0),NULL="\0",uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=uint8[0]===255;class PngDecoder extends IOBuffer$4{constructor(_,_e={}){super(_);const{checkCrc:tt=!1}=_e;this._checkCrc=tt,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let _=0;_<pngSignature.length;_++)if(this.readUint8()!==pngSignature[_])throw new Error(`wrong PNG signature. Byte at ${_} should be ${pngSignature[_]}.`)}decodeChunk(){const _=this.readUint32(),_e=this.readChars(4),tt=this.offset;switch(_e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(_);break;case"IDAT":this.decodeIDAT(_);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(_);break;case"iCCP":this.decodeiCCP(_);break;case"tEXt":this.decodetEXt(_);break;case"pHYs":this.decodepHYs();break;default:this.skip(_);break}if(this.offset-tt!==_)throw new Error(`Length mismatch while decoding chunk ${_e}`);if(this._checkCrc){const nt=this.readUint32(),rt=_+4,it=crc(new Uint8Array(this.buffer,this.byteOffset+this.offset-rt-4,rt),rt);if(it!==nt)throw new Error(`CRC mismatch for chunk ${_e}. Expected ${nt}, found ${it}`)}else this.skip(4)}decodeIHDR(){const _=this._png;_.width=this.readUint32(),_.height=this.readUint32(),_.depth=checkBitDepth(this.readUint8());const _e=this.readUint8();this._colorType=_e;let tt;switch(_e){case ColorType.GREYSCALE:tt=1;break;case ColorType.TRUECOLOUR:tt=3;break;case ColorType.INDEXED_COLOUR:tt=1;break;case ColorType.GREYSCALE_ALPHA:tt=2;break;case ColorType.TRUECOLOUR_ALPHA:tt=4;break;default:throw new Error(`Unknown color type: ${_e}`)}if(this._png.channels=tt,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(_){if(_%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${_}`);const _e=_/3;this._hasPalette=!0;const tt=[];this._palette=tt;for(let nt=0;nt<_e;nt++)tt.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(_){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,_)),this.skip(_)}decodetRNS(_){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:{if(_%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${_}`);if(_/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${_/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(_/2);for(let _e=0;_e<_/2;_e++)this._transparency[_e]=this.readUint16();break}case ColorType.INDEXED_COLOUR:{if(_>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${_} vs ${this._palette.length})`);let _e=0;for(;_e<_;_e++){const tt=this.readByte();this._palette[_e].push(tt)}for(;_e<this._palette.length;_e++)this._palette[_e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(_){let _e="",tt;for(;(tt=this.readChar())!==NULL;)_e+=tt;const nt=this.readUint8();if(nt!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${nt}`);const rt=this.readBytes(_-_e.length-2);this._png.iccEmbeddedProfile={name:_e,profile:inflate_1(rt)}}decodetEXt(_){let _e="",tt;for(;(tt=this.readChar())!==NULL;)_e+=tt;this._png.text[_e]=this.readChars(_-_e.length-1)}decodepHYs(){const _=this.readUint32(),_e=this.readUint32(),tt=this.readByte();this._png.resolution={x:_,y:_e,unit:tt}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const _=this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this.decodeInterlaceNull(_);else throw new Error(`Interlace method ${this._interlaceMethod} not supported`)}decodeInterlaceNull(_){const _e=this._png.height,tt=this._png.channels*this._png.depth/8,nt=this._png.width*tt,rt=new Uint8Array(this._png.height*nt);let it=empty,st=0,ot,at;for(let lt=0;lt<_e;lt++){switch(ot=_.subarray(st+1,st+1+nt),at=rt.subarray(lt*nt,(lt+1)*nt),_[st]){case 0:unfilterNone(ot,at,nt);break;case 1:unfilterSub(ot,at,nt,tt);break;case 2:unfilterUp(ot,at,it,nt);break;case 3:unfilterAverage(ot,at,it,nt,tt);break;case 4:unfilterPaeth(ot,at,it,nt,tt);break;default:throw new Error(`Unsupported filter: ${_[st]}`)}it=at,st+=nt+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),this._png.depth===16){const lt=new Uint16Array(rt.buffer);if(osIsLittleEndian)for(let ct=0;ct<lt.length;ct++)lt[ct]=swap16(lt[ct]);this._png.data=lt}else this._png.data=rt}}function unfilterNone(et,_,_e){for(let tt=0;tt<_e;tt++)_[tt]=et[tt]}function unfilterSub(et,_,_e,tt){let nt=0;for(;nt<tt;nt++)_[nt]=et[nt];for(;nt<_e;nt++)_[nt]=et[nt]+_[nt-tt]&255}function unfilterUp(et,_,_e,tt){let nt=0;if(_e.length===0)for(;nt<tt;nt++)_[nt]=et[nt];else for(;nt<tt;nt++)_[nt]=et[nt]+_e[nt]&255}function unfilterAverage(et,_,_e,tt,nt){let rt=0;if(_e.length===0){for(;rt<nt;rt++)_[rt]=et[rt];for(;rt<tt;rt++)_[rt]=et[rt]+(_[rt-nt]>>1)&255}else{for(;rt<nt;rt++)_[rt]=et[rt]+(_e[rt]>>1)&255;for(;rt<tt;rt++)_[rt]=et[rt]+(_[rt-nt]+_e[rt]>>1)&255}}function unfilterPaeth(et,_,_e,tt,nt){let rt=0;if(_e.length===0){for(;rt<nt;rt++)_[rt]=et[rt];for(;rt<tt;rt++)_[rt]=et[rt]+_[rt-nt]&255}else{for(;rt<nt;rt++)_[rt]=et[rt]+_e[rt]&255;for(;rt<tt;rt++)_[rt]=et[rt]+paethPredictor(_[rt-nt],_e[rt],_e[rt-nt])&255}}function paethPredictor(et,_,_e){const tt=et+_-_e,nt=Math.abs(tt-et),rt=Math.abs(tt-_),it=Math.abs(tt-_e);return nt<=rt&&nt<=it?et:rt<=it?_:_e}function swap16(et){return(et&255)<<8|et>>8&255}function checkBitDepth(et){if(et!==1&&et!==2&&et!==4&&et!==8&&et!==16)throw new Error(`invalid bit depth: ${et}`);return et}const defaultZlibOptions={level:3};class PngEncoder extends IOBuffer$4{constructor(_,_e={}){super(),this._colorType=ColorType.UNKNOWN,this._zlibOptions={...defaultZlibOptions,..._e.zlib},this._png=this._checkData(_),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(pngSignature)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(CompressionMethod.DEFLATE),this.writeByte(FilterMethod.ADAPTIVE),this.writeByte(InterlaceMethod.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(_){this.writeUint32(_.length),this.writeChars("IDAT"),this.writeBytes(_),this.writeCrc(_.length+4)}encodeData(){const{width:_,height:_e,channels:tt,depth:nt,data:rt}=this._png,it=tt*_,st=new IOBuffer$4().setBigEndian();let ot=0;for(let ct=0;ct<_e;ct++)if(st.writeByte(0),nt===8)ot=writeDataBytes(rt,st,it,ot);else if(nt===16)ot=writeDataUint16(rt,st,it,ot);else throw new Error("unreachable");const at=st.toArray(),lt=deflate_1(at,this._zlibOptions);this.encodeIDAT(lt)}_checkData(_){const{colorType:_e,channels:tt,depth:nt}=getColorType(_),rt={width:checkInteger(_.width,"width"),height:checkInteger(_.height,"height"),channels:tt,data:_.data,depth:nt,text:{}};this._colorType=_e;const it=rt.width*rt.height*tt;if(rt.data.length!==it)throw new RangeError(`wrong data size. Found ${rt.data.length}, expected ${it}`);return rt}writeCrc(_){this.writeUint32(crc(new Uint8Array(this.buffer,this.byteOffset+this.offset-_,_),_))}}function checkInteger(et,_){if(Number.isInteger(et)&&et>0)return et;throw new TypeError(`${_} must be a positive integer`)}function getColorType(et){const{channels:_=4,depth:_e=8}=et;if(_!==4&&_!==3&&_!==2&&_!==1)throw new RangeError(`unsupported number of channels: ${_}`);if(_e!==8&&_e!==16)throw new RangeError(`unsupported bit depth: ${_e}`);const tt={channels:_,depth:_e,colorType:ColorType.UNKNOWN};switch(_){case 4:tt.colorType=ColorType.TRUECOLOUR_ALPHA;break;case 3:tt.colorType=ColorType.TRUECOLOUR;break;case 1:tt.colorType=ColorType.GREYSCALE;break;case 2:tt.colorType=ColorType.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return tt}function writeDataBytes(et,_,_e,tt){for(let nt=0;nt<_e;nt++)_.writeByte(et[tt++]);return tt}function writeDataUint16(et,_,_e,tt){for(let nt=0;nt<_e;nt++)_.writeUint16(et[tt++]);return tt}var ResolutionUnitSpecifier;(function(et){et[et.UNKNOWN=0]="UNKNOWN",et[et.METRE=1]="METRE"})(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}));function decodePng(et,_){return new PngDecoder(et,_).decode()}function encodePng$1(et,_){return new PngEncoder(et,_).encode()}var encoder={exports:{}};(function(et){function _(tt){var nt=Math.floor,rt=new Array(64),it=new Array(64),st=new Array(64),ot=new Array(64),at,lt,ct,ht,ut=new Array(65535),ft=new Array(65535),dt=new Array(64),pt=new Array(64),mt=[],vt=0,yt=7,_t=new Array(64),St=new Array(64),bt=new Array(64),Et=new Array(256),Mt=new Array(2048),Tt,wt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Ct=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Rt=[0,1,2,3,4,5,6,7,8,9,10,11],It=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Dt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Ft=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],$t=[0,1,2,3,4,5,6,7,8,9,10,11],Yt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Lt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Ot(tn){for(var Wt=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Bt=0;Bt<64;Bt++){var nn=nt((Wt[Bt]*tn+50)/100);nn<1?nn=1:nn>255&&(nn=255),rt[wt[Bt]]=nn}for(var en=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],mn=0;mn<64;mn++){var sn=nt((en[mn]*tn+50)/100);sn<1?sn=1:sn>255&&(sn=255),it[wt[mn]]=sn}for(var xn=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],an=0,pn=0;pn<8;pn++)for(var Sn=0;Sn<8;Sn++)st[an]=1/(rt[wt[an]]*xn[pn]*xn[Sn]*8),ot[an]=1/(it[wt[an]]*xn[pn]*xn[Sn]*8),an++}function Nt(tn,Wt){for(var Bt=0,nn=0,en=new Array,mn=1;mn<=16;mn++){for(var sn=1;sn<=tn[mn];sn++)en[Wt[nn]]=[],en[Wt[nn]][0]=Bt,en[Wt[nn]][1]=mn,nn++,Bt++;Bt*=2}return en}function zt(){at=Nt(Ct,Rt),lt=Nt(Ft,$t),ct=Nt(It,Dt),ht=Nt(Yt,Lt)}function Ht(){for(var tn=1,Wt=2,Bt=1;Bt<=15;Bt++){for(var nn=tn;nn<Wt;nn++)ft[32767+nn]=Bt,ut[32767+nn]=[],ut[32767+nn][1]=Bt,ut[32767+nn][0]=nn;for(var en=-(Wt-1);en<=-tn;en++)ft[32767+en]=Bt,ut[32767+en]=[],ut[32767+en][1]=Bt,ut[32767+en][0]=Wt-1+en;tn<<=1,Wt<<=1}}function qt(){for(var tn=0;tn<256;tn++)Mt[tn]=19595*tn,Mt[tn+256>>0]=38470*tn,Mt[tn+512>>0]=7471*tn+32768,Mt[tn+768>>0]=-11059*tn,Mt[tn+1024>>0]=-21709*tn,Mt[tn+1280>>0]=32768*tn+8421375,Mt[tn+1536>>0]=-27439*tn,Mt[tn+1792>>0]=-5329*tn}function Gt(tn){for(var Wt=tn[0],Bt=tn[1]-1;Bt>=0;)Wt&1<<Bt&&(vt|=1<<yt),Bt--,yt--,yt<0&&(vt==255?(Xt(255),Xt(0)):Xt(vt),yt=7,vt=0)}function Xt(tn){mt.push(tn)}function Zt(tn){Xt(tn>>8&255),Xt(tn&255)}function Qt(tn,Wt){var Bt,nn,en,mn,sn,xn,an,pn,Sn=0,gn,Rn=8,Mn=64;for(gn=0;gn<Rn;++gn){Bt=tn[Sn],nn=tn[Sn+1],en=tn[Sn+2],mn=tn[Sn+3],sn=tn[Sn+4],xn=tn[Sn+5],an=tn[Sn+6],pn=tn[Sn+7];var kn=Bt+pn,Fn=Bt-pn,Nn=nn+an,Zn=nn-an,er=en+xn,dn=en-xn,$n=mn+sn,Pn=mn-sn,Dn=kn+$n,Hn=kn-$n,jn=Nn+er,qn=Nn-er;tn[Sn]=Dn+jn,tn[Sn+4]=Dn-jn;var hr=(qn+Hn)*.707106781;tn[Sn+2]=Hn+hr,tn[Sn+6]=Hn-hr,Dn=Pn+dn,jn=dn+Zn,qn=Zn+Fn;var fr=(Dn-qn)*.382683433,jt=.5411961*Dn+fr,hn=1.306562965*qn+fr,En=jn*.707106781,Vn=Fn+En,Gn=Fn-En;tn[Sn+5]=Gn+jt,tn[Sn+3]=Gn-jt,tn[Sn+1]=Vn+hn,tn[Sn+7]=Vn-hn,Sn+=8}for(Sn=0,gn=0;gn<Rn;++gn){Bt=tn[Sn],nn=tn[Sn+8],en=tn[Sn+16],mn=tn[Sn+24],sn=tn[Sn+32],xn=tn[Sn+40],an=tn[Sn+48],pn=tn[Sn+56];var Kn=Bt+pn,br=Bt-pn,gr=nn+an,Er=nn-an,Tr=en+xn,zr=en-xn,wr=mn+sn,Wr=mn-sn,Ur=Kn+wr,Qr=Kn-wr,$r=gr+Tr,Kt=gr-Tr;tn[Sn]=Ur+$r,tn[Sn+32]=Ur-$r;var vn=(Kt+Qr)*.707106781;tn[Sn+16]=Qr+vn,tn[Sn+48]=Qr-vn,Ur=Wr+zr,$r=zr+Er,Kt=Er+br;var In=(Ur-Kt)*.382683433,Ln=.5411961*Ur+In,Cn=1.306562965*Kt+In,Wn=$r*.707106781,Qn=br+Wn,rr=br-Wn;tn[Sn+40]=rr+Ln,tn[Sn+24]=rr-Ln,tn[Sn+8]=Qn+Cn,tn[Sn+56]=Qn-Cn,Sn++}var zn;for(gn=0;gn<Mn;++gn)zn=tn[gn]*Wt[gn],dt[gn]=zn>0?zn+.5|0:zn-.5|0;return dt}function un(){Zt(65504),Zt(16),Xt(74),Xt(70),Xt(73),Xt(70),Xt(0),Xt(1),Xt(1),Xt(0),Zt(1),Zt(1),Xt(0),Xt(0)}function wn(tn){if(tn){Zt(65505),tn[0]===69&&tn[1]===120&&tn[2]===105&&tn[3]===102?Zt(tn.length+2):(Zt(tn.length+5+2),Xt(69),Xt(120),Xt(105),Xt(102),Xt(0));for(var Wt=0;Wt<tn.length;Wt++)Xt(tn[Wt])}}function Tn(tn,Wt){Zt(65472),Zt(17),Xt(8),Zt(Wt),Zt(tn),Xt(3),Xt(1),Xt(17),Xt(0),Xt(2),Xt(17),Xt(1),Xt(3),Xt(17),Xt(1)}function yn(){Zt(65499),Zt(132),Xt(0);for(var tn=0;tn<64;tn++)Xt(rt[tn]);Xt(1);for(var Wt=0;Wt<64;Wt++)Xt(it[Wt])}function Vt(){Zt(65476),Zt(418),Xt(0);for(var tn=0;tn<16;tn++)Xt(Ct[tn+1]);for(var Wt=0;Wt<=11;Wt++)Xt(Rt[Wt]);Xt(16);for(var Bt=0;Bt<16;Bt++)Xt(It[Bt+1]);for(var nn=0;nn<=161;nn++)Xt(Dt[nn]);Xt(1);for(var en=0;en<16;en++)Xt(Ft[en+1]);for(var mn=0;mn<=11;mn++)Xt($t[mn]);Xt(17);for(var sn=0;sn<16;sn++)Xt(Yt[sn+1]);for(var xn=0;xn<=161;xn++)Xt(Lt[xn])}function fn(tn){typeof tn>"u"||tn.constructor!==Array||tn.forEach(Wt=>{if(typeof Wt=="string"){Zt(65534);var Bt=Wt.length;Zt(Bt+2);var nn;for(nn=0;nn<Bt;nn++)Xt(Wt.charCodeAt(nn))}})}function ln(){Zt(65498),Zt(12),Xt(3),Xt(1),Xt(0),Xt(2),Xt(17),Xt(3),Xt(17),Xt(0),Xt(63),Xt(0)}function Jt(tn,Wt,Bt,nn,en){for(var mn=en[0],sn=en[240],xn,an=16,pn=63,Sn=64,gn=Qt(tn,Wt),Rn=0;Rn<Sn;++Rn)pt[wt[Rn]]=gn[Rn];var Mn=pt[0]-Bt;Bt=pt[0],Mn==0?Gt(nn[0]):(xn=32767+Mn,Gt(nn[ft[xn]]),Gt(ut[xn]));for(var kn=63;kn>0&&pt[kn]==0;kn--);if(kn==0)return Gt(mn),Bt;for(var Fn=1,Nn;Fn<=kn;){for(var Zn=Fn;pt[Fn]==0&&Fn<=kn;++Fn);var er=Fn-Zn;if(er>=an){Nn=er>>4;for(var dn=1;dn<=Nn;++dn)Gt(sn);er=er&15}xn=32767+pt[Fn],Gt(en[(er<<4)+ft[xn]]),Gt(ut[xn]),Fn++}return kn!=pn&&Gt(mn),Bt}function on(){for(var tn=String.fromCharCode,Wt=0;Wt<256;Wt++)Et[Wt]=tn(Wt)}this.encode=function(tn,Wt){new Date().getTime(),Wt&&_n(Wt),mt=new Array,vt=0,yt=7,Zt(65496),un(),fn(tn.comments),wn(tn.exifBuffer),yn(),Tn(tn.width,tn.height),Vt(),ln();var Bt=0,nn=0,en=0;vt=0,yt=7,this.encode.displayName="_encode_";for(var mn=tn.data,sn=tn.width,xn=tn.height,an=sn*4,pn,Sn=0,gn,Rn,Mn,kn,Fn,Nn,Zn,er;Sn<xn;){for(pn=0;pn<an;){for(kn=an*Sn+pn,Fn=kn,Nn=-1,Zn=0,er=0;er<64;er++)Zn=er>>3,Nn=(er&7)*4,Fn=kn+Zn*an+Nn,Sn+Zn>=xn&&(Fn-=an*(Sn+1+Zn-xn)),pn+Nn>=an&&(Fn-=pn+Nn-an+4),gn=mn[Fn++],Rn=mn[Fn++],Mn=mn[Fn++],_t[er]=(Mt[gn]+Mt[Rn+256>>0]+Mt[Mn+512>>0]>>16)-128,St[er]=(Mt[gn+768>>0]+Mt[Rn+1024>>0]+Mt[Mn+1280>>0]>>16)-128,bt[er]=(Mt[gn+1280>>0]+Mt[Rn+1536>>0]+Mt[Mn+1792>>0]>>16)-128;Bt=Jt(_t,st,Bt,at,ct),nn=Jt(St,ot,nn,lt,ht),en=Jt(bt,ot,en,lt,ht),pn+=32}Sn+=8}if(yt>=0){var dn=[];dn[1]=yt+1,dn[0]=(1<<yt+1)-1,Gt(dn)}return Zt(65497),Buffer.from(mt)};function _n(tn){if(tn<=0&&(tn=1),tn>100&&(tn=100),Tt!=tn){var Wt=0;tn<50?Wt=Math.floor(5e3/tn):Wt=Math.floor(200-tn*2),Ot(Wt),Tt=tn}}function cn(){var tn=new Date().getTime();tt||(tt=50),on(),zt(),Ht(),qt(),_n(tt),new Date().getTime()-tn}cn()}et.exports=_e;function _e(tt,nt){typeof nt>"u"&&(nt=50);var rt=new _(nt),it=rt.encode(tt,nt);return{data:it,width:tt.width,height:tt.height}}})(encoder);var encoderExports=encoder.exports,decoder={exports:{}};(function(et){var _=function(){var nt=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),rt=4017,it=799,st=3406,ot=2276,at=1567,lt=3784,ct=5793,ht=2896;function ut(){}function ft(St,bt){for(var Et=0,Mt=[],Tt,wt,Ct=16;Ct>0&&!St[Ct-1];)Ct--;Mt.push({children:[],index:0});var Rt=Mt[0],It;for(Tt=0;Tt<Ct;Tt++){for(wt=0;wt<St[Tt];wt++){for(Rt=Mt.pop(),Rt.children[Rt.index]=bt[Et];Rt.index>0;){if(Mt.length===0)throw new Error("Could not recreate Huffman Table");Rt=Mt.pop()}for(Rt.index++,Mt.push(Rt);Mt.length<=Tt;)Mt.push(It={children:[],index:0}),Rt.children[Rt.index]=It.children,Rt=It;Et++}Tt+1<Ct&&(Mt.push(It={children:[],index:0}),Rt.children[Rt.index]=It.children,Rt=It)}return Mt[0].children}function dt(St,bt,Et,Mt,Tt,wt,Ct,Rt,It,Dt){Et.precision,Et.samplesPerLine,Et.scanLines;var Ft=Et.mcusPerLine,$t=Et.progressive;Et.maxH,Et.maxV;var Yt=bt,Lt=0,Ot=0;function Nt(){if(Ot>0)return Ot--,Lt>>Ot&1;if(Lt=St[bt++],Lt==255){var xn=St[bt++];if(xn)throw new Error("unexpected marker: "+(Lt<<8|xn).toString(16))}return Ot=7,Lt>>>7}function zt(xn){for(var an=xn,pn;(pn=Nt())!==null;){if(an=an[pn],typeof an=="number")return an;if(typeof an!="object")throw new Error("invalid huffman sequence")}return null}function Ht(xn){for(var an=0;xn>0;){var pn=Nt();if(pn===null)return;an=an<<1|pn,xn--}return an}function qt(xn){var an=Ht(xn);return an>=1<<xn-1?an:an+(-1<<xn)+1}function Gt(xn,an){var pn=zt(xn.huffmanTableDC),Sn=pn===0?0:qt(pn);an[0]=xn.pred+=Sn;for(var gn=1;gn<64;){var Rn=zt(xn.huffmanTableAC),Mn=Rn&15,kn=Rn>>4;if(Mn===0){if(kn<15)break;gn+=16;continue}gn+=kn;var Fn=nt[gn];an[Fn]=qt(Mn),gn++}}function Xt(xn,an){var pn=zt(xn.huffmanTableDC),Sn=pn===0?0:qt(pn)<<It;an[0]=xn.pred+=Sn}function Zt(xn,an){an[0]|=Nt()<<It}var Qt=0;function un(xn,an){if(Qt>0){Qt--;return}for(var pn=wt,Sn=Ct;pn<=Sn;){var gn=zt(xn.huffmanTableAC),Rn=gn&15,Mn=gn>>4;if(Rn===0){if(Mn<15){Qt=Ht(Mn)+(1<<Mn)-1;break}pn+=16;continue}pn+=Mn;var kn=nt[pn];an[kn]=qt(Rn)*(1<<It),pn++}}var wn=0,Tn;function yn(xn,an){for(var pn=wt,Sn=Ct,gn=0;pn<=Sn;){var Rn=nt[pn],Mn=an[Rn]<0?-1:1;switch(wn){case 0:var kn=zt(xn.huffmanTableAC),Fn=kn&15,gn=kn>>4;if(Fn===0)gn<15?(Qt=Ht(gn)+(1<<gn),wn=4):(gn=16,wn=1);else{if(Fn!==1)throw new Error("invalid ACn encoding");Tn=qt(Fn),wn=gn?2:3}continue;case 1:case 2:an[Rn]?an[Rn]+=(Nt()<<It)*Mn:(gn--,gn===0&&(wn=wn==2?3:0));break;case 3:an[Rn]?an[Rn]+=(Nt()<<It)*Mn:(an[Rn]=Tn<<It,wn=0);break;case 4:an[Rn]&&(an[Rn]+=(Nt()<<It)*Mn);break}pn++}wn===4&&(Qt--,Qt===0&&(wn=0))}function Vt(xn,an,pn,Sn,gn){var Rn=pn/Ft|0,Mn=pn%Ft,kn=Rn*xn.v+Sn,Fn=Mn*xn.h+gn;xn.blocks[kn]===void 0&&Dt.tolerantDecoding||an(xn,xn.blocks[kn][Fn])}function fn(xn,an,pn){var Sn=pn/xn.blocksPerLine|0,gn=pn%xn.blocksPerLine;xn.blocks[Sn]===void 0&&Dt.tolerantDecoding||an(xn,xn.blocks[Sn][gn])}var ln=Mt.length,Jt,on,_n,cn,tn,Wt;$t?wt===0?Wt=Rt===0?Xt:Zt:Wt=Rt===0?un:yn:Wt=Gt;var Bt=0,nn,en;ln==1?en=Mt[0].blocksPerLine*Mt[0].blocksPerColumn:en=Ft*Et.mcusPerColumn,Tt||(Tt=en);for(var mn,sn;Bt<en;){for(on=0;on<ln;on++)Mt[on].pred=0;if(Qt=0,ln==1)for(Jt=Mt[0],tn=0;tn<Tt;tn++)fn(Jt,Wt,Bt),Bt++;else for(tn=0;tn<Tt;tn++){for(on=0;on<ln;on++)for(Jt=Mt[on],mn=Jt.h,sn=Jt.v,_n=0;_n<sn;_n++)for(cn=0;cn<mn;cn++)Vt(Jt,Wt,Bt,_n,cn);if(Bt++,Bt===en)break}if(Bt===en)do{if(St[bt]===255&&St[bt+1]!==0)break;bt+=1}while(bt<St.length-2);if(Ot=0,nn=St[bt]<<8|St[bt+1],nn<65280)throw new Error("marker was not found");if(nn>=65488&&nn<=65495)bt+=2;else break}return bt-Yt}function pt(St,bt){var Et=[],Mt=bt.blocksPerLine,Tt=bt.blocksPerColumn,wt=Mt<<3,Ct=new Int32Array(64),Rt=new Uint8Array(64);function It(Ht,qt,Gt){var Xt=bt.quantizationTable,Zt,Qt,un,wn,Tn,yn,Vt,fn,ln,Jt=Gt,on;for(on=0;on<64;on++)Jt[on]=Ht[on]*Xt[on];for(on=0;on<8;++on){var _n=8*on;if(Jt[1+_n]==0&&Jt[2+_n]==0&&Jt[3+_n]==0&&Jt[4+_n]==0&&Jt[5+_n]==0&&Jt[6+_n]==0&&Jt[7+_n]==0){ln=ct*Jt[0+_n]+512>>10,Jt[0+_n]=ln,Jt[1+_n]=ln,Jt[2+_n]=ln,Jt[3+_n]=ln,Jt[4+_n]=ln,Jt[5+_n]=ln,Jt[6+_n]=ln,Jt[7+_n]=ln;continue}Zt=ct*Jt[0+_n]+128>>8,Qt=ct*Jt[4+_n]+128>>8,un=Jt[2+_n],wn=Jt[6+_n],Tn=ht*(Jt[1+_n]-Jt[7+_n])+128>>8,fn=ht*(Jt[1+_n]+Jt[7+_n])+128>>8,yn=Jt[3+_n]<<4,Vt=Jt[5+_n]<<4,ln=Zt-Qt+1>>1,Zt=Zt+Qt+1>>1,Qt=ln,ln=un*lt+wn*at+128>>8,un=un*at-wn*lt+128>>8,wn=ln,ln=Tn-Vt+1>>1,Tn=Tn+Vt+1>>1,Vt=ln,ln=fn+yn+1>>1,yn=fn-yn+1>>1,fn=ln,ln=Zt-wn+1>>1,Zt=Zt+wn+1>>1,wn=ln,ln=Qt-un+1>>1,Qt=Qt+un+1>>1,un=ln,ln=Tn*ot+fn*st+2048>>12,Tn=Tn*st-fn*ot+2048>>12,fn=ln,ln=yn*it+Vt*rt+2048>>12,yn=yn*rt-Vt*it+2048>>12,Vt=ln,Jt[0+_n]=Zt+fn,Jt[7+_n]=Zt-fn,Jt[1+_n]=Qt+Vt,Jt[6+_n]=Qt-Vt,Jt[2+_n]=un+yn,Jt[5+_n]=un-yn,Jt[3+_n]=wn+Tn,Jt[4+_n]=wn-Tn}for(on=0;on<8;++on){var cn=on;if(Jt[8+cn]==0&&Jt[16+cn]==0&&Jt[24+cn]==0&&Jt[32+cn]==0&&Jt[40+cn]==0&&Jt[48+cn]==0&&Jt[56+cn]==0){ln=ct*Gt[on+0]+8192>>14,Jt[0+cn]=ln,Jt[8+cn]=ln,Jt[16+cn]=ln,Jt[24+cn]=ln,Jt[32+cn]=ln,Jt[40+cn]=ln,Jt[48+cn]=ln,Jt[56+cn]=ln;continue}Zt=ct*Jt[0+cn]+2048>>12,Qt=ct*Jt[32+cn]+2048>>12,un=Jt[16+cn],wn=Jt[48+cn],Tn=ht*(Jt[8+cn]-Jt[56+cn])+2048>>12,fn=ht*(Jt[8+cn]+Jt[56+cn])+2048>>12,yn=Jt[24+cn],Vt=Jt[40+cn],ln=Zt-Qt+1>>1,Zt=Zt+Qt+1>>1,Qt=ln,ln=un*lt+wn*at+2048>>12,un=un*at-wn*lt+2048>>12,wn=ln,ln=Tn-Vt+1>>1,Tn=Tn+Vt+1>>1,Vt=ln,ln=fn+yn+1>>1,yn=fn-yn+1>>1,fn=ln,ln=Zt-wn+1>>1,Zt=Zt+wn+1>>1,wn=ln,ln=Qt-un+1>>1,Qt=Qt+un+1>>1,un=ln,ln=Tn*ot+fn*st+2048>>12,Tn=Tn*st-fn*ot+2048>>12,fn=ln,ln=yn*it+Vt*rt+2048>>12,yn=yn*rt-Vt*it+2048>>12,Vt=ln,Jt[0+cn]=Zt+fn,Jt[56+cn]=Zt-fn,Jt[8+cn]=Qt+Vt,Jt[48+cn]=Qt-Vt,Jt[16+cn]=un+yn,Jt[40+cn]=un-yn,Jt[24+cn]=wn+Tn,Jt[32+cn]=wn-Tn}for(on=0;on<64;++on){var tn=128+(Jt[on]+8>>4);qt[on]=tn<0?0:tn>255?255:tn}}_t(wt*Tt*8);for(var Dt,Ft,$t=0;$t<Tt;$t++){var Yt=$t<<3;for(Dt=0;Dt<8;Dt++)Et.push(new Uint8Array(wt));for(var Lt=0;Lt<Mt;Lt++){It(bt.blocks[$t][Lt],Rt,Ct);var Ot=0,Nt=Lt<<3;for(Ft=0;Ft<8;Ft++){var zt=Et[Yt+Ft];for(Dt=0;Dt<8;Dt++)zt[Nt+Dt]=Rt[Ot++]}}}return Et}function mt(St){return St<0?0:St>255?255:St}ut.prototype={load:function(bt){var Et=new XMLHttpRequest;Et.open("GET",bt,!0),Et.responseType="arraybuffer",Et.onload=(function(){var Mt=new Uint8Array(Et.response||Et.mozResponseArrayBuffer);this.parse(Mt),this.onload&&this.onload()}).bind(this),Et.send(null)},parse:function(bt){var Et=this.opts.maxResolutionInMP*1e3*1e3,Mt=0;bt.length;function Tt(){var Mn=bt[Mt]<<8|bt[Mt+1];return Mt+=2,Mn}function wt(){var Mn=Tt(),kn=bt.subarray(Mt,Mt+Mn-2);return Mt+=kn.length,kn}function Ct(Mn){var kn=1,Fn=1,Nn,Zn;for(Zn in Mn.components)Mn.components.hasOwnProperty(Zn)&&(Nn=Mn.components[Zn],kn<Nn.h&&(kn=Nn.h),Fn<Nn.v&&(Fn=Nn.v));var er=Math.ceil(Mn.samplesPerLine/8/kn),dn=Math.ceil(Mn.scanLines/8/Fn);for(Zn in Mn.components)if(Mn.components.hasOwnProperty(Zn)){Nn=Mn.components[Zn];var $n=Math.ceil(Math.ceil(Mn.samplesPerLine/8)*Nn.h/kn),Pn=Math.ceil(Math.ceil(Mn.scanLines/8)*Nn.v/Fn),Dn=er*Nn.h,Hn=dn*Nn.v,jn=Hn*Dn,qn=[];_t(jn*256);for(var hr=0;hr<Hn;hr++){for(var fr=[],jt=0;jt<Dn;jt++)fr.push(new Int32Array(64));qn.push(fr)}Nn.blocksPerLine=$n,Nn.blocksPerColumn=Pn,Nn.blocks=qn}Mn.maxH=kn,Mn.maxV=Fn,Mn.mcusPerLine=er,Mn.mcusPerColumn=dn}var Rt=null,It=null,Dt,Ft,$t=[],Yt=[],Lt=[],Ot=[],Nt=Tt(),zt=-1;if(this.comments=[],Nt!=65496)throw new Error("SOI not found");for(Nt=Tt();Nt!=65497;){var Ht,qt;switch(Nt){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var Gt=wt();if(Nt===65534){var Xt=String.fromCharCode.apply(null,Gt);this.comments.push(Xt)}Nt===65504&&Gt[0]===74&&Gt[1]===70&&Gt[2]===73&&Gt[3]===70&&Gt[4]===0&&(Rt={version:{major:Gt[5],minor:Gt[6]},densityUnits:Gt[7],xDensity:Gt[8]<<8|Gt[9],yDensity:Gt[10]<<8|Gt[11],thumbWidth:Gt[12],thumbHeight:Gt[13],thumbData:Gt.subarray(14,14+3*Gt[12]*Gt[13])}),Nt===65505&&Gt[0]===69&&Gt[1]===120&&Gt[2]===105&&Gt[3]===102&&Gt[4]===0&&(this.exifBuffer=Gt.subarray(5,Gt.length)),Nt===65518&&Gt[0]===65&&Gt[1]===100&&Gt[2]===111&&Gt[3]===98&&Gt[4]===101&&Gt[5]===0&&(It={version:Gt[6],flags0:Gt[7]<<8|Gt[8],flags1:Gt[9]<<8|Gt[10],transformCode:Gt[11]});break;case 65499:for(var Zt=Tt(),Qt=Zt+Mt-2;Mt<Qt;){var un=bt[Mt++];_t(256);var wn=new Int32Array(64);if(un>>4)if(un>>4===1)for(qt=0;qt<64;qt++){var Tn=nt[qt];wn[Tn]=Tt()}else throw new Error("DQT: invalid table spec");else for(qt=0;qt<64;qt++){var Tn=nt[qt];wn[Tn]=bt[Mt++]}$t[un&15]=wn}break;case 65472:case 65473:case 65474:Tt(),Dt={},Dt.extended=Nt===65473,Dt.progressive=Nt===65474,Dt.precision=bt[Mt++],Dt.scanLines=Tt(),Dt.samplesPerLine=Tt(),Dt.components={},Dt.componentsOrder=[];var yn=Dt.scanLines*Dt.samplesPerLine;if(yn>Et){var Vt=Math.ceil((yn-Et)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Vt}MP`)}var fn=bt[Mt++],ln;for(Ht=0;Ht<fn;Ht++){ln=bt[Mt];var Jt=bt[Mt+1]>>4,on=bt[Mt+1]&15,_n=bt[Mt+2];if(Jt<=0||on<=0)throw new Error("Invalid sampling factor, expected values above 0");Dt.componentsOrder.push(ln),Dt.components[ln]={h:Jt,v:on,quantizationIdx:_n},Mt+=3}Ct(Dt),Yt.push(Dt);break;case 65476:var cn=Tt();for(Ht=2;Ht<cn;){var tn=bt[Mt++],Wt=new Uint8Array(16),Bt=0;for(qt=0;qt<16;qt++,Mt++)Bt+=Wt[qt]=bt[Mt];_t(16+Bt);var nn=new Uint8Array(Bt);for(qt=0;qt<Bt;qt++,Mt++)nn[qt]=bt[Mt];Ht+=17+Bt,(tn>>4?Lt:Ot)[tn&15]=ft(Wt,nn)}break;case 65501:Tt(),Ft=Tt();break;case 65500:Tt(),Tt();break;case 65498:Tt();var en=bt[Mt++],mn=[],sn;for(Ht=0;Ht<en;Ht++){sn=Dt.components[bt[Mt++]];var xn=bt[Mt++];sn.huffmanTableDC=Ot[xn>>4],sn.huffmanTableAC=Lt[xn&15],mn.push(sn)}var an=bt[Mt++],pn=bt[Mt++],Sn=bt[Mt++],gn=dt(bt,Mt,Dt,mn,Ft,an,pn,Sn>>4,Sn&15,this.opts);Mt+=gn;break;case 65535:bt[Mt]!==255&&Mt--;break;default:if(bt[Mt-3]==255&&bt[Mt-2]>=192&&bt[Mt-2]<=254){Mt-=3;break}else if(Nt===224||Nt==225){if(zt!==-1)throw new Error(`first unknown JPEG marker at offset ${zt.toString(16)}, second unknown JPEG marker ${Nt.toString(16)} at offset ${(Mt-1).toString(16)}`);zt=Mt-1;const Mn=Tt();if(bt[Mt+Mn-2]===255){Mt+=Mn-2;break}}throw new Error("unknown JPEG marker "+Nt.toString(16))}Nt=Tt()}if(Yt.length!=1)throw new Error("only single frame JPEGs supported");for(var Ht=0;Ht<Yt.length;Ht++){var Rn=Yt[Ht].components;for(var qt in Rn)Rn[qt].quantizationTable=$t[Rn[qt].quantizationIdx],delete Rn[qt].quantizationIdx}this.width=Dt.samplesPerLine,this.height=Dt.scanLines,this.jfif=Rt,this.adobe=It,this.components=[];for(var Ht=0;Ht<Dt.componentsOrder.length;Ht++){var sn=Dt.components[Dt.componentsOrder[Ht]];this.components.push({lines:pt(Dt,sn),scaleX:sn.h/Dt.maxH,scaleY:sn.v/Dt.maxV})}},getData:function(bt,Et){var Mt=this.width/bt,Tt=this.height/Et,wt,Ct,Rt,It,Dt,Ft,$t,Yt,Lt,Ot,Nt=0,zt,Ht,qt,Gt,Xt,Zt,Qt,un,wn,Tn,yn,Vt=bt*Et*this.components.length;_t(Vt);var fn=new Uint8Array(Vt);switch(this.components.length){case 1:for(wt=this.components[0],Ot=0;Ot<Et;Ot++)for(Dt=wt.lines[0|Ot*wt.scaleY*Tt],Lt=0;Lt<bt;Lt++)zt=Dt[0|Lt*wt.scaleX*Mt],fn[Nt++]=zt;break;case 2:for(wt=this.components[0],Ct=this.components[1],Ot=0;Ot<Et;Ot++)for(Dt=wt.lines[0|Ot*wt.scaleY*Tt],Ft=Ct.lines[0|Ot*Ct.scaleY*Tt],Lt=0;Lt<bt;Lt++)zt=Dt[0|Lt*wt.scaleX*Mt],fn[Nt++]=zt,zt=Ft[0|Lt*Ct.scaleX*Mt],fn[Nt++]=zt;break;case 3:for(yn=!0,this.adobe&&this.adobe.transformCode?yn=!0:typeof this.opts.colorTransform<"u"&&(yn=!!this.opts.colorTransform),wt=this.components[0],Ct=this.components[1],Rt=this.components[2],Ot=0;Ot<Et;Ot++)for(Dt=wt.lines[0|Ot*wt.scaleY*Tt],Ft=Ct.lines[0|Ot*Ct.scaleY*Tt],$t=Rt.lines[0|Ot*Rt.scaleY*Tt],Lt=0;Lt<bt;Lt++)yn?(zt=Dt[0|Lt*wt.scaleX*Mt],Ht=Ft[0|Lt*Ct.scaleX*Mt],qt=$t[0|Lt*Rt.scaleX*Mt],un=mt(zt+1.402*(qt-128)),wn=mt(zt-.3441363*(Ht-128)-.71413636*(qt-128)),Tn=mt(zt+1.772*(Ht-128))):(un=Dt[0|Lt*wt.scaleX*Mt],wn=Ft[0|Lt*Ct.scaleX*Mt],Tn=$t[0|Lt*Rt.scaleX*Mt]),fn[Nt++]=un,fn[Nt++]=wn,fn[Nt++]=Tn;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(yn=!1,this.adobe&&this.adobe.transformCode?yn=!0:typeof this.opts.colorTransform<"u"&&(yn=!!this.opts.colorTransform),wt=this.components[0],Ct=this.components[1],Rt=this.components[2],It=this.components[3],Ot=0;Ot<Et;Ot++)for(Dt=wt.lines[0|Ot*wt.scaleY*Tt],Ft=Ct.lines[0|Ot*Ct.scaleY*Tt],$t=Rt.lines[0|Ot*Rt.scaleY*Tt],Yt=It.lines[0|Ot*It.scaleY*Tt],Lt=0;Lt<bt;Lt++)yn?(zt=Dt[0|Lt*wt.scaleX*Mt],Ht=Ft[0|Lt*Ct.scaleX*Mt],qt=$t[0|Lt*Rt.scaleX*Mt],Gt=Yt[0|Lt*It.scaleX*Mt],Xt=255-mt(zt+1.402*(qt-128)),Zt=255-mt(zt-.3441363*(Ht-128)-.71413636*(qt-128)),Qt=255-mt(zt+1.772*(Ht-128))):(Xt=Dt[0|Lt*wt.scaleX*Mt],Zt=Ft[0|Lt*Ct.scaleX*Mt],Qt=$t[0|Lt*Rt.scaleX*Mt],Gt=Yt[0|Lt*It.scaleX*Mt]),fn[Nt++]=255-Xt,fn[Nt++]=255-Zt,fn[Nt++]=255-Qt,fn[Nt++]=255-Gt;break;default:throw new Error("Unsupported color mode")}return fn},copyToImageData:function(bt,Et){var Mt=bt.width,Tt=bt.height,wt=bt.data,Ct=this.getData(Mt,Tt),Rt=0,It=0,Dt,Ft,$t,Yt,Lt,Ot,Nt,zt,Ht;switch(this.components.length){case 1:for(Ft=0;Ft<Tt;Ft++)for(Dt=0;Dt<Mt;Dt++)$t=Ct[Rt++],wt[It++]=$t,wt[It++]=$t,wt[It++]=$t,Et&&(wt[It++]=255);break;case 3:for(Ft=0;Ft<Tt;Ft++)for(Dt=0;Dt<Mt;Dt++)Nt=Ct[Rt++],zt=Ct[Rt++],Ht=Ct[Rt++],wt[It++]=Nt,wt[It++]=zt,wt[It++]=Ht,Et&&(wt[It++]=255);break;case 4:for(Ft=0;Ft<Tt;Ft++)for(Dt=0;Dt<Mt;Dt++)Lt=Ct[Rt++],Ot=Ct[Rt++],$t=Ct[Rt++],Yt=Ct[Rt++],Nt=255-mt(Lt*(1-Yt/255)+Yt),zt=255-mt(Ot*(1-Yt/255)+Yt),Ht=255-mt($t*(1-Yt/255)+Yt),wt[It++]=Nt,wt[It++]=zt,wt[It++]=Ht,Et&&(wt[It++]=255);break;default:throw new Error("Unsupported color mode")}}};var vt=0,yt=0;function _t(St=0){var bt=vt+St;if(bt>yt){var Et=Math.ceil((bt-yt)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${Et}MB`)}vt=bt}return ut.resetMaxMemoryUsage=function(St){vt=0,yt=St},ut.getBytesAllocated=function(){return vt},ut.requestMemoryAllocation=_t,ut}();et.exports=_e;function _e(tt,nt={}){var rt={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},it={...rt,...nt},st=new Uint8Array(tt),ot=new _;ot.opts=it,_.resetMaxMemoryUsage(it.maxMemoryUsageInMB*1024*1024),ot.parse(st);var at=it.formatAsRGBA?4:3,lt=ot.width*ot.height*at;try{_.requestMemoryAllocation(lt);var ct={width:ot.width,height:ot.height,exifBuffer:ot.exifBuffer,data:it.useTArray?new Uint8Array(lt):Buffer.alloc(lt)};ot.comments.length>0&&(ct.comments=ot.comments)}catch(ht){throw ht instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+lt):ht instanceof ReferenceError&&ht.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):ht}return ot.copyToImageData(ct,it.formatAsRGBA),ct}})(decoder);var decoderExports=decoder.exports,encode$1=encoderExports,decode$4=decoderExports,jpegJs={encode:encode$1,decode:decode$4};let chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256);for(let et=0;et<chars.length;et++)lookup[chars.charCodeAt(et)]=et;function encode(et){let _,_e=et.length,tt="";for(_=0;_<_e;_+=3)tt+=chars[et[_]>>2],tt+=chars[(et[_]&3)<<4|et[_+1]>>4],tt+=chars[(et[_+1]&15)<<2|et[_+2]>>6],tt+=chars[et[_+2]&63];return _e%3===2?tt=`${tt.substring(0,tt.length-1)}=`:_e%3===1&&(tt=`${tt.substring(0,tt.length-2)}==`),tt}function decode$3(et){let _=et.length*.75,_e=et.length,tt=0,nt,rt,it,st;et[et.length-1]==="="&&(_--,et[et.length-2]==="="&&_--);const ot=new Uint8Array(_);for(let at=0;at<_e;at+=4)nt=lookup[et.charCodeAt(at)],rt=lookup[et.charCodeAt(at+1)],it=lookup[et.charCodeAt(at+2)],st=lookup[et.charCodeAt(at+3)],ot[tt++]=nt<<2|rt>>4,ot[tt++]=(rt&15)<<4|it>>2,ot[tt++]=(it&3)<<6|st&63;return ot}function toBase64URL(et,_){const _e=encode(et);return`data:${_};base64,${_e}`}const ImageData$1=self.ImageData,DOMImage=self.Image;function createCanvas(et,_){let _e=self.document.createElement("canvas");return _e.width=et,_e.height=_,_e}function fetchBinary(et,{withCredentials:_=!1}={}){return new Promise(function(_e,tt){let nt=new self.XMLHttpRequest;nt.open("GET",et,!0),nt.responseType="arraybuffer",nt.withCredentials=_,nt.onload=function(rt){this.status!==200?tt(rt):_e(this.response)},nt.onerror=tt,nt.send()})}function createWriteStream(){throw new Error("createWriteStream does not exist in the browser")}function writeFile(){throw new Error("writeFile does not exist in the browser")}function getType(et){return et.includes("/")||(et=`image/${et}`),et}function encodeJpeg(et,_={}){const _e={width:et.width,height:et.height,data:et.getRGBAData()};return jpegJs.encode(_e,_.quality).data}function encodePng(et,_){const _e={width:et.width,height:et.height,channels:et.channels,depth:et.bitDepth,data:et.data};return(_e.depth===1||_e.depth===32)&&(_e.depth=8,_e.channels=4,_e.data=et.getRGBAData()),encodePng$1(_e,_)}const exportMethods={save(et,_={}){const{useCanvas:_e=!1,encoder:tt=void 0}=_;let{format:nt}=_;if(!nt){const rt=/\.(?<format>[a-zA-Z]+)$/.exec(et);rt&&(nt=rt.groups.format.toLowerCase())}if(!nt)throw new Error("file format not provided");return new Promise((rt,it)=>{let st,ot;switch(nt.toLowerCase()){case"png":{_e?st=this.getCanvas().pngStream():ot=encodePng(this,tt);break}case"jpg":case"jpeg":_e?st=this.getCanvas().jpegStream():ot=encodeJpeg(this,tt);break;case"bmp":ot=encode$2(this,tt);break;default:throw new RangeError(`invalid output format: ${nt}`)}if(st){let at=createWriteStream();at.on("finish",rt),at.on("error",it),st.pipe(at)}else ot&&writeFile()})},toDataURL(et="image/png",_={}){typeof et=="object"&&(_=et,et="image/png");const{useCanvas:_e=!1,encoder:tt=void 0}=_;et=getType(et);function nt(rt,it){const st=rt(it,tt);return toBase64URL(st,et)}return et==="image/bmp"?nt(encode$2,this):et==="image/png"&&!_e?nt(encodePng,this):et==="image/jpeg"&&!_e?nt(encodeJpeg,this):this.getCanvas().toDataURL(et)},toBuffer(et={}){const{format:_="png",encoder:_e=void 0}=et;switch(_.toLowerCase()){case"png":return encodePng(this,_e);case"jpeg":case"jpg":return encodeJpeg(this,_e);case"bmp":return encode$2(this,_e);default:throw new RangeError(`invalid output format: ${_}`)}},toBase64(et="image/png",_={}){if(_.async)return this.toDataURL(et,_).then(function(_e){return _e.substring(_e.indexOf(",")+1)});{const _e=this.toDataURL(et,_);return _e.substring(_e.indexOf(",")+1)}},toBlob(et="image/png",_=.8){return canvasToBlob(this.getCanvas(),et,_)},getCanvas(){const et=new ImageData$1(this.getRGBAData({clamped:!0}),this.width,this.height);let _=createCanvas(this.width,this.height);return _.getContext("2d").putImageData(et,0,0),_}};function setExportMethods(et){for(const _ in exportMethods)et.prototype[_]=exportMethods[_]}var hasOwn$1={exports:{}};const name="has-own",version="1.0.1",description="A safer .hasOwnProperty() - hasOwn(name, obj)",main="index.js",scripts={test:"make test"},author="Aaron Heckmann <aaron.heckmann+github@gmail.com>",license="MIT",repository={type:"git",url:"git://github.com/aheckmann/has-own.git"},homepage="https://github.com/aheckmann/has-own/",devDependencies={mocha:"^6.2.2"},require$$0$3={name,version,description,main,scripts,author,license,repository,homepage,devDependencies};(function(et,_){var _e=Object.prototype.hasOwnProperty;et.exports=_=function(nt,rt){return _e.call(rt,nt)},_.version=require$$0$3.version})(hasOwn$1,hasOwn$1.exports);var hasOwnExports=hasOwn$1.exports;const hasOwn=getDefaultExportFromCjs(hasOwnExports);let computedPropertyDescriptor$1={configurable:!0,enumerable:!1,get:void 0};function extendMethod(et,_,_e={}){let{inPlace:tt=!1,returnThis:nt=!0,partialArgs:rt=[]}=_e;return tt?Image$1.prototype[et]=function(...it){this.computed=null;let st=_.apply(this,[...rt,...it]);return nt?this:st}:Image$1.prototype[et]=function(...it){return _.apply(this,[...rt,...it])},Image$1}function extendProperty(et,_,_e={}){let{partialArgs:tt=[]}=_e;return computedPropertyDescriptor$1.get=function(){if(this.computed===null)this.computed={};else if(hasOwn(et,this.computed))return this.computed[et];let nt=_.apply(this,tt);return this.computed[et]=nt,nt},Object.defineProperty(Image$1.prototype,et,computedPropertyDescriptor$1),Image$1}const GREY$1="GREY",RGB$1="RGB",HSL="HSL",HSV="HSV",CMYK$1="CMYK",ColorModel=Object.freeze(Object.defineProperty({__proto__:null,CMYK:CMYK$1,GREY:GREY$1,HSL,HSV,RGB:RGB$1},Symbol.toStringTag,{value:"Module"}));function getRGBAData(et={}){const{clamped:_}=et;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const _e=this.width*this.height*4;let tt=_?new Uint8ClampedArray(_e):new Uint8Array(_e);return this.bitDepth===1?fillDataFromBinary(this,tt):this.bitDepth===32?(this.checkProcessable("getRGBAData",{alpha:0}),this.components===1?fillDataFromGrey32(this,tt):this.components===3&&(this.checkProcessable("getRGBAData",{colorModel:[RGB$1]}),fillDataFromRGB32(this,tt))):this.components===1?fillDataFromGrey(this,tt):this.components===3&&(this.checkProcessable("getRGBAData",{colorModel:[RGB$1]}),fillDataFromRGB(this,tt)),this.alpha===1?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),copyAlpha(this,tt)):fillAlpha(this,tt),tt}function fillDataFromBinary(et,_){for(let _e=0;_e<et.size;_e++){const tt=et.getBit(_e);_[_e*4]=tt*255,_[_e*4+1]=tt*255,_[_e*4+2]=tt*255}}function fillDataFromGrey32(et,_){const _e=et.min[0],nt=et.max[0]-_e;for(let rt=0;rt<et.size;rt++){const it=Math.floor(255*(et.data[rt]-_e)/nt);_[rt*4]=it,_[rt*4+1]=it,_[rt*4+2]=it}}function fillDataFromRGB32(et,_){const _e=Math.min(...et.min),nt=Math.max(...et.max)-_e;for(let rt=0;rt<et.size;rt++){const it=Math.floor(255*(et.data[rt*3]-_e)/nt),st=Math.floor(255*(et.data[rt*3+1]-_e)/nt),ot=Math.floor(255*(et.data[rt*3+2]-_e)/nt);_[rt*4]=it,_[rt*4+1]=st,_[rt*4+2]=ot}}function fillDataFromGrey(et,_){for(let _e=0;_e<et.size;_e++)_[_e*4]=et.data[_e*et.channels]>>>et.bitDepth-8,_[_e*4+1]=et.data[_e*et.channels]>>>et.bitDepth-8,_[_e*4+2]=et.data[_e*et.channels]>>>et.bitDepth-8}function fillDataFromRGB(et,_){for(let _e=0;_e<et.size;_e++)_[_e*4]=et.data[_e*et.channels]>>>et.bitDepth-8,_[_e*4+1]=et.data[_e*et.channels+1]>>>et.bitDepth-8,_[_e*4+2]=et.data[_e*et.channels+2]>>>et.bitDepth-8}function copyAlpha(et,_){for(let _e=0;_e<et.size;_e++)_[_e*4+3]=et.data[_e*et.channels+et.components]>>et.bitDepth-8}function fillAlpha(et,_){for(let _e=0;_e<et.size;_e++)_[_e*4+3]=255}const BINARY="BINARY",GREY="GREY",GREYA="GREYA",RGB="RGB",RGBA="RGBA",CMYK="CMYK",CMYKA="CMYKA",kinds={};kinds[BINARY]={components:1,alpha:0,bitDepth:1,colorModel:GREY$1};kinds[GREYA]={components:1,alpha:1,bitDepth:8,colorModel:GREY$1};kinds[GREY]={components:1,alpha:0,bitDepth:8,colorModel:GREY$1};kinds[RGBA]={components:3,alpha:1,bitDepth:8,colorModel:RGB$1};kinds[RGB]={components:3,alpha:0,bitDepth:8,colorModel:RGB$1};kinds[CMYK]={components:4,alpha:0,bitDepth:8,colorModel:CMYK$1};kinds[CMYKA]={components:4,alpha:1,bitDepth:8,colorModel:CMYK$1};function getKind(et){const _=kinds[et];if(!_)throw new RangeError(`invalid image kind: ${et}`);return _}const validBitDepth=[1,8,16,32];function verifyKindDefinition(et){const{components:_,alpha:_e,bitDepth:tt,colorModel:nt}=et;if(!Number.isInteger(_)||_<=0)throw new RangeError(`invalid components: ${_}. Must be a positive integer`);if(_e!==0&&_e!==1&&typeof _e!="boolean")throw new TypeError(`invalid alpha: ${_e}: must be a boolean, 0 or 1`);if(!validBitDepth.includes(tt))throw new RangeError(`invalid bitDepth: ${tt}. Must be one of ${validBitDepth.join(", ")}`);if(!ColorModel[nt])throw new RangeError(`invalid colorModel: ${nt}. Must be one of ${Object.keys(ColorModel).join(", ")}`)}function getTheoreticalPixelArraySize(et,_,_e){let tt=_*et;return _e===1&&(tt=Math.ceil(tt/8)),tt}function createPixelArray(et,_,_e,tt,nt,rt){const it=tt*et;let st;switch(nt){case 1:st=new Uint8Array(Math.ceil(it/8));break;case 8:st=new Uint8Array(it);break;case 16:st=new Uint16Array(it);break;case 32:st=new Float32Array(it);break;default:throw new Error(`Cannot create pixel array for bit depth ${nt}`)}if(_e)for(let ot=_;ot<st.length;ot+=tt)st[ot]=rt;return st}const defaultByteLength=1024*8,charArray=[];let IOBuffer$2=class{constructor(_,_e){_e=_e||{},_===void 0&&(_=defaultByteLength),typeof _=="number"&&(_=new ArrayBuffer(_));let tt=_.byteLength;const nt=_e.offset?_e.offset>>>0:0;_.buffer&&(tt=_.byteLength-nt,_.byteLength!==_.buffer.byteLength?_=_.buffer.slice(_.byteOffset+nt,_.byteOffset+_.byteLength):nt?_=_.buffer.slice(nt):_=_.buffer),this.buffer=_,this.length=tt,this.byteLength=tt,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=tt||defaultByteLength,this._mark=0}available(_){return _===void 0&&(_=1),this.offset+_<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(_){_===void 0&&(_=1),this.offset+=_}seek(_){this.offset=_}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(_){if(_===void 0&&(_=1),!this.available(_)){const _e=this._increment+this._increment;this._increment=_e;const tt=this.length+_e,nt=new Uint8Array(tt);nt.set(new Uint8Array(this.buffer)),this.buffer=nt.buffer,this.length=tt,this._data=new DataView(this.buffer)}}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(_){_===void 0&&(_=1);for(var _e=new Uint8Array(_),tt=0;tt<_;tt++)_e[tt]=this.readByte();return _e}readInt16(){var _=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,_}readUint16(){var _=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,_}readInt32(){var _=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,_}readUint32(){var _=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat32(){var _=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat64(){var _=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,_}readChar(){return String.fromCharCode(this.readInt8())}readChars(_){_===void 0&&(_=1),charArray.length=_;for(var _e=0;_e<_;_e++)charArray[_e]=this.readChar();return charArray.join("")}writeBoolean(_){this.writeUint8(_?255:0)}writeInt8(_){this.ensureAvailable(1),this._data.setInt8(this.offset++,_)}writeUint8(_){this.ensureAvailable(1),this._data.setUint8(this.offset++,_)}writeByte(_){this.writeUint8(_)}writeBytes(_){this.ensureAvailable(_.length);for(var _e=0;_e<_.length;_e++)this._data.setUint8(this.offset++,_[_e])}writeInt16(_){this.ensureAvailable(2),this._data.setInt16(this.offset,_,this.littleEndian),this.offset+=2}writeUint16(_){this.ensureAvailable(2),this._data.setUint16(this.offset,_,this.littleEndian),this.offset+=2}writeInt32(_){this.ensureAvailable(4),this._data.setInt32(this.offset,_,this.littleEndian),this.offset+=4}writeUint32(_){this.ensureAvailable(4),this._data.setUint32(this.offset,_,this.littleEndian),this.offset+=4}writeFloat32(_){this.ensureAvailable(4),this._data.setFloat32(this.offset,_,this.littleEndian),this.offset+=4}writeFloat64(_){this.ensureAvailable(8),this._data.setFloat64(this.offset,_,this.littleEndian),this.offset+=8}writeChar(_){this.writeUint8(_.charCodeAt(0))}writeChars(_){for(var _e=0;_e<_.length;_e++)this.writeUint8(_.charCodeAt(_e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}};var IOBuffer_1=IOBuffer$2,src$3={};const tagsById$5={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},tagsByName$5={};for(var i$2 in tagsById$5)tagsByName$5[tagsById$5[i$2]]=i$2;var standard$1={tagsById:tagsById$5,tagsByName:tagsByName$5};const tagsById$4={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName$4={};for(var i$1 in tagsById$4)tagsByName$4[tagsById$4[i$1]]=i$1;var exif$1={tagsById:tagsById$4,tagsByName:tagsByName$4};const tagsById$3={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},tagsByName$3={};for(var i in tagsById$3)tagsByName$3[tagsById$3[i]]=i;var gps$1={tagsById:tagsById$3,tagsByName:tagsByName$3};const tags$1={standard:standard$1,exif:exif$1,gps:gps$1};let IFD$2=class{constructor(_){if(!_)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=_,this._map=null}get(_){if(typeof _=="number")return this.fields.get(_);if(typeof _=="string")return this.fields.get(tags$1[this.kind].tagsByName[_]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const _e=tags$1[this.kind].tagsById;for(var _ of this.fields.keys())_e[_]&&(this._map[_e[_]]=this.fields.get(_))}return this._map}};var ifd=IFD$2;const Ifd=ifd,dateTimeRegex$1=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;let TiffIfd$1=class extends Ifd{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var _=new Date,_e=dateTimeRegex$1.exec(this.dateTime);return _.setFullYear(_e[1],_e[2]-1,_e[3]),_.setHours(_e[4],_e[5],_e[6]),_}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return alwaysArray$1(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return alwaysArray$1(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}};function alwaysArray$1(et){return typeof et=="number"?[et]:et}var tiffIfd=TiffIfd$1,ifdValue={},types$1=new Map([[1,[1,readByte$1]],[2,[1,readASCII$1]],[3,[2,readShort$1]],[4,[4,readLong$1]],[5,[8,readRational$1]],[6,[1,readSByte$1]],[7,[1,readByte$1]],[8,[2,readSShort$1]],[9,[4,readSLong$1]],[10,[8,readSRational$1]],[11,[4,readFloat$1]],[12,[8,readDouble$1]]]);ifdValue.getByteLength=function(et,_){return types$1.get(et)[0]*_};ifdValue.readData=function(et,_,_e){return types$1.get(_)[1](et,_e)};function readByte$1(et,_){if(_===1)return et.readUint8();for(var _e=new Uint8Array(_),tt=0;tt<_;tt++)_e[tt]=et.readUint8();return _e}function readASCII$1(et,_){for(var _e=[],tt="",nt=0;nt<_;nt++){var rt=String.fromCharCode(et.readUint8());rt==="\0"?(_e.push(tt),tt=""):tt+=rt}return _e.length===1?_e[0]:_e}function readShort$1(et,_){if(_===1)return et.readUint16();for(var _e=new Uint16Array(_),tt=0;tt<_;tt++)_e[tt]=et.readUint16();return _e}function readLong$1(et,_){if(_===1)return et.readUint32();for(var _e=new Uint32Array(_),tt=0;tt<_;tt++)_e[tt]=et.readUint32();return _e}function readRational$1(et,_){if(_===1)return et.readUint32()/et.readUint32();for(var _e=new Array(_),tt=0;tt<_;tt++)_e[tt]=et.readUint32()/et.readUint32();return _e}function readSByte$1(et,_){if(_===1)return et.readInt8();for(var _e=new Int8Array(_),tt=0;tt<_;tt++)_e[tt]=et.readInt8();return _e}function readSShort$1(et,_){if(_===1)return et.readInt16();for(var _e=new Int16Array(_),tt=0;tt<_;tt++)_e[tt]=et.readInt16();return _e}function readSLong$1(et,_){if(_===1)return et.readInt32();for(var _e=new Int32Array(_),tt=0;tt<_;tt++)_e[tt]=et.readInt32();return _e}function readSRational$1(et,_){if(_===1)return et.readInt32()/et.readInt32();for(var _e=new Array(_),tt=0;tt<_;tt++)_e[tt]=et.readInt32()/et.readInt32();return _e}function readFloat$1(et,_){if(_===1)return et.readFloat32();for(var _e=new Float32Array(_),tt=0;tt<_;tt++)_e[tt]=et.readFloat32();return _e}function readDouble$1(et,_){if(_===1)return et.readFloat64();for(var _e=new Float64Array(_),tt=0;tt<_;tt++)_e[tt]=et.readFloat64();return _e}const IOBuffer$1=IOBuffer_1,IFD$1=ifd,TiffIFD=tiffIfd,IFDValue=ifdValue,defaultOptions$d={ignoreImageData:!1,onlyFirst:!1};let TIFFDecoder$2=class extends IOBuffer$1{constructor(_,_e){super(_,_e),this._nextIFD=0}decode(_){_=Object.assign({},defaultOptions$d,_);const _e=[];for(this.decodeHeader();this._nextIFD;)if(_e.push(this.decodeIFD(_)),_.onlyFirst)return _e[0];return _e}decodeHeader(){let _=this.readUint16();if(_===18761)this.setLittleEndian();else if(_===19789)this.setBigEndian();else throw new Error("invalid byte order: 0x"+_.toString(16));if(_=this.readUint16(),_!==42)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(_){this.seek(this._nextIFD);var _e;_.kind?_e=new IFD$1(_.kind):_e=new TiffIFD;const tt=this.readUint16();for(var nt=0;nt<tt;nt++)this.decodeIFDEntry(_e);return _.ignoreImageData||this.decodeImageData(_e),this._nextIFD=this.readUint32(),_e}decodeIFDEntry(_){const _e=this.offset,tt=this.readUint16(),nt=this.readUint16(),rt=this.readUint32();if(nt<1||nt>12){this.skip(4);return}IFDValue.getByteLength(nt,rt)>4&&this.seek(this.readUint32());const st=IFDValue.readData(this,nt,rt);if(_.fields.set(tt,st),tt===34665||tt===34853){let ot=this.offset,at;tt===34665?at="exif":tt===34853&&(at="gps"),this._nextIFD=st,_[at]=this.decodeIFD({kind:at,ignoreImageData:!0}),this.offset=ot}this.seek(_e),this.skip(12)}decodeImageData(_){const _e=_.orientation;switch(_e&&_e!==1&&unsupported$1("orientation",_e),_.type){case 1:case 2:this.readStripData(_);break;default:unsupported$1("image type",_.type);break}}readStripData(_){const _e=_.width,tt=_.height,nt=validateBitDepth(_.bitsPerSample),rt=_.sampleFormat;let it=_e*tt;const st=getDataArray$1(it,1,nt,rt),ot=_.compression,lt=_.rowsPerStrip*_e,ct=_.stripOffsets,ht=_.stripByteCounts;for(var ut=0,ft=0;ft<ct.length;ft++){var dt=this.getStripData(ot,ct[ft],ht[ft]),pt=it>lt?lt:it;it-=pt,nt===8?ut=fill8bit$1(st,dt,ut,pt):nt===16?ut=fill16bit$1(st,dt,ut,pt,this.isLittleEndian()):nt===32&&rt===3?ut=fillFloat32$1(st,dt,ut,pt,this.isLittleEndian()):unsupported$1("bitDepth",nt)}_.data=st}getStripData(_,_e,tt){switch(_){case 1:return new DataView(this.buffer,_e,tt);case 2:case 32773:return unsupported$1("Compression",_);default:throw new Error("invalid compression: "+_)}}};var tiffDecoder=TIFFDecoder$2;function getDataArray$1(et,_,_e,tt){return _e===8?new Uint8Array(et*_):_e===16?new Uint16Array(et*_):_e===32&&tt===3?new Float32Array(et*_):unsupported$1("bit depth / sample format",_e+" / "+tt)}function fill8bit$1(et,_,_e,tt){for(var nt=0;nt<tt;nt++)et[_e++]=_.getUint8(nt);return _e}function fill16bit$1(et,_,_e,tt,nt){for(var rt=0;rt<tt*2;rt+=2)et[_e++]=_.getUint16(rt,nt);return _e}function fillFloat32$1(et,_,_e,tt,nt){for(var rt=0;rt<tt*4;rt+=4)et[_e++]=_.getFloat32(rt,nt);return _e}function unsupported$1(et,_){throw new Error("Unsupported "+et+": "+_)}function validateBitDepth(et){if(et.length){const _e=et;et=_e[0];for(var _=0;_<_e.length;_++)_e[_]!==et&&unsupported$1("bit depth",_e)}return et}const TIFFDecoder$1=tiffDecoder;var decode$2=function(_,_e){return new TIFFDecoder$1(_,_e).decode(_e)};src$3.decode=decode$2;const IOBuffer=IOBuffer_1,tiff=src$3;function decode$1(et){const _=new IOBuffer(et),_e={};if(_.setBigEndian(),_.readUint16()!==65496)throw new Error("SOI marker not found. Not a valid JPEG file");if(_.readUint16()===65505){_.readUint16();const rt=_.readBytes(6);if(rt[0]===69&&rt[1]===120&&rt[2]===105&&rt[3]===102&&rt[4]===0&&rt[5]===0){const it=tiff.decode(_,{onlyFirst:!0,ignoreImageData:!0,offset:_.offset});_e.exif=it}}return _e}var decode_1=decode$1,decode=decode_1,imageType$2={exports:{}},fileType$1={exports:{}};(function(module){const toBytes=et=>[...et].map(_=>_.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(et,_=0){let _e=et[_],tt=1,nt=0;for(;++nt<8;)tt*=256,_e+=et[_+nt]*tt;return _e}const fileType=et=>{if(!(et instanceof Uint8Array||et instanceof ArrayBuffer||Buffer.isBuffer(et)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof et}\``);const _=et instanceof Uint8Array?et:new Uint8Array(et);if(!(_&&_.length>1))return null;const _e=(nt,rt)=>{rt=Object.assign({offset:0},rt);for(let it=0;it<nt.length;it++)if(rt.mask){if(nt[it]!==(rt.mask[it]&_[it+rt.offset]))return!1}else if(nt[it]!==_[it+rt.offset])return!1;return!0},tt=(nt,rt)=>_e(toBytes(nt),rt);if(_e([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(_e([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(_e([71,73,70]))return{ext:"gif",mime:"image/gif"};if(_e([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(_e([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((_e([73,73,42,0])||_e([77,77,0,42]))&&_e([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(_e([73,73,42,0])||_e([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(_e([66,77]))return{ext:"bmp",mime:"image/bmp"};if(_e([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(_e([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(_e([80,75,3,4])){if(_e([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(_e(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(tt("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(tt("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(tt("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const nt=(ot,at=0)=>ot.findIndex((lt,ct,ht)=>ct>=at&&ht[ct]===80&&ht[ct+1]===75&&ht[ct+2]===3&&ht[ct+3]===4);let rt=0,it=!1,st=null;do{const ot=rt+30;if(it||(it=_e(oxmlContentTypes,{offset:ot})||_e(oxmlRels,{offset:ot})),st||(tt("word/",{offset:ot})?st={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:tt("ppt/",{offset:ot})?st={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:tt("xl/",{offset:ot})&&(st={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),it&&st)return st;rt=nt(_,ot)}while(rt>=0);if(st)return st}if(_e([80,75])&&(_[2]===3||_[2]===5||_[2]===7)&&(_[3]===4||_[3]===6||_[3]===8))return{ext:"zip",mime:"application/zip"};if(_e([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(_e([82,97,114,33,26,7])&&(_[6]===0||_[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(_e([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(_e([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(_e([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(_e([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(_e([51,103,112,53])||_e([0,0,0])&&_e([102,116,121,112],{offset:4})&&(_e([109,112,52,49],{offset:8})||_e([109,112,52,50],{offset:8})||_e([105,115,111,109],{offset:8})||_e([105,115,111,50],{offset:8})||_e([109,109,112,52],{offset:8})||_e([77,52,86],{offset:8})||_e([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(_e([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(_e([26,69,223,163])){const nt=_.subarray(4,4100),rt=nt.findIndex((it,st,ot)=>ot[st]===66&&ot[st+1]===130);if(rt!==-1){const it=rt+3,st=ot=>[...ot].every((at,lt)=>nt[it+lt]===at.charCodeAt(0));if(st("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(st("webm"))return{ext:"webm",mime:"video/webm"}}}if(_e([0,0,0,20,102,116,121,112,113,116,32,32])||_e([102,114,101,101],{offset:4})||_e([102,116,121,112,113,116,32,32],{offset:4})||_e([109,100,97,116],{offset:4})||_e([109,111,111,118],{offset:4})||_e([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(_e([82,73,70,70])){if(_e([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(_e([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(_e([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(_e([48,38,178,117,142,102,207,17,166,217])){let nt=30;do{const rt=readUInt64LE(_,nt+16);if(_e([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:nt})){if(_e([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:nt+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(_e([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:nt+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}nt+=rt}while(nt+24<=_.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(_e([0,0,1,186])||_e([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(_e([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let nt=0;nt<2&&nt<_.length-16;nt++){if(_e([73,68,51],{offset:nt})||_e([255,226],{offset:nt,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(_e([255,228],{offset:nt,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(_e([255,248],{offset:nt,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(_e([255,240],{offset:nt,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(_e([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(_e([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(_e([79,103,103,83]))return _e([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:_e([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:_e([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:_e([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:_e([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(_e([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(_e([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(_e([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(_e([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(_e([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(_e([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((_[0]===67||_[0]===70)&&_e([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(_e([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(_e([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(_e([119,79,70,70])&&(_e([0,1,0,0],{offset:4})||_e([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(_e([119,79,70,50])&&(_e([0,1,0,0],{offset:4})||_e([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(_e([76,80],{offset:34})&&(_e([0,0,1],{offset:8})||_e([1,0,2],{offset:8})||_e([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(_e([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(_e([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(_e([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(_e([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(_e([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(_e([37,33]))return{ext:"ps",mime:"application/postscript"};if(_e([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(_e([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(_e([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(_e([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(_e([77,83,67,70])||_e([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(_e([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(_e([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(_e([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(_e([31,160])||_e([31,157]))return{ext:"Z",mime:"application/x-compress"};if(_e([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(_e([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(_e([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(_e([71],{offset:4})&&(_e([71],{offset:192})||_e([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(_e([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(_e([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(_e([0,0,0,12,106,80,32,32,13,10,135,10])){if(_e([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(_e([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(_e([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(_e([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(_e([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(tt("<?xml "))return{ext:"xml",mime:"application/xml"};if(_e([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(_e([102,116,121,112],{offset:4})){if(_e([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(_e([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(_e([104,101,105,99],{offset:8})||_e([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(_e([104,101,118,99],{offset:8})||_e([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return _e([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:_e([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:_e([77,80,43])?{ext:"mpc",mime:"audio/x-musepack"}:_e([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:_e([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:_e([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:_e([212,195,178,161])||_e([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",()=>{const et=new stream.PassThrough,_=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{et.fileType=fileType(_)}catch(_e){reject(_e)}readableStream.unshift(_),stream.pipeline?resolve(stream.pipeline(readableStream,et,()=>{})):resolve(readableStream.pipe(et))})})})(fileType$1);var fileTypeExports=fileType$1.exports;const fileType=fileTypeExports,imageExts=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),imageType=et=>{const _=fileType(et);return imageExts.has(_&&_.ext)?_:null};imageType$2.exports=imageType;imageType$2.exports.default=imageType;Object.defineProperty(imageType,"minimumBytes",{value:fileType.minimumBytes});var imageTypeExports=imageType$2.exports;const imageType$1=getDefaultExportFromCjs(imageTypeExports);function guessStripByteCounts(et){if(et.compression!==1)throw new Error("missing mandatory StripByteCounts field in compressed image");const _=et.rowsPerStrip*et.width*et.samplesPerPixel*(et.bitsPerSample/8);return new Array(et.stripOffsets.length).fill(_)}function applyHorizontalDifferencing8Bit(et,_,_e){let tt=0;for(;tt<et.length;){for(let nt=_e;nt<_*_e;nt+=_e)for(let rt=0;rt<_e;rt++)et[tt+nt+rt]=et[tt+nt+rt]+et[tt+nt-(_e-rt)]&255;tt+=_*_e}}function applyHorizontalDifferencing16Bit(et,_,_e){let tt=0;for(;tt<et.length;){for(let nt=_e;nt<_*_e;nt+=_e)for(let rt=0;rt<_e;rt++)et[tt+nt+rt]=et[tt+nt+rt]+et[tt+nt-(_e-rt)]&65535;tt+=_*_e}}const tagsById$2={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName$2={};for(let et in tagsById$2)tagsByName$2[tagsById$2[et]]=Number(et);const exif=Object.freeze(Object.defineProperty({__proto__:null,tagsById:tagsById$2,tagsByName:tagsByName$2},Symbol.toStringTag,{value:"Module"})),tagsById$1={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},tagsByName$1={};for(let et in tagsById$1)tagsByName$1[tagsById$1[et]]=Number(et);const gps=Object.freeze(Object.defineProperty({__proto__:null,tagsById:tagsById$1,tagsByName:tagsByName$1},Symbol.toStringTag,{value:"Module"})),tagsById={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},tagsByName={};for(let et in tagsById)tagsByName[tagsById[et]]=Number(et);const standard=Object.freeze(Object.defineProperty({__proto__:null,tagsById,tagsByName},Symbol.toStringTag,{value:"Module"})),tags={standard,exif,gps};class IFD{constructor(_){if(!_)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=_,this._hasMap=!1,this._map={}}get(_){if(typeof _=="number")return this.fields.get(_);if(typeof _=="string")return this.fields.get(tags[this.kind].tagsByName[_]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const _=tags[this.kind].tagsById;for(let _e of this.fields.keys())_[_e]&&(this._map[_[_e]]=this.fields.get(_e));this._hasMap=!0}return this._map}}let types=new Map([[1,[1,readByte]],[2,[1,readASCII]],[3,[2,readShort]],[4,[4,readLong]],[5,[8,readRational]],[6,[1,readSByte]],[7,[1,readByte]],[8,[2,readSShort]],[9,[4,readSLong]],[10,[8,readSRational]],[11,[4,readFloat]],[12,[8,readDouble]]]);function getByteLength(et,_){const _e=types.get(et);if(!_e)throw new Error(`type not found: ${et}`);return _e[0]*_}function readData(et,_,_e){const tt=types.get(_);if(!tt)throw new Error(`type not found: ${_}`);return tt[1](et,_e)}function readByte(et,_){if(_===1)return et.readUint8();let _e=new Uint8Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readUint8();return _e}function readASCII(et,_){let _e=[],tt="";for(let nt=0;nt<_;nt++){let rt=String.fromCharCode(et.readUint8());rt==="\0"?(_e.push(tt),tt=""):tt+=rt}return _e.length===1?_e[0]:_e}function readShort(et,_){if(_===1)return et.readUint16();let _e=new Uint16Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readUint16();return _e}function readLong(et,_){if(_===1)return et.readUint32();let _e=new Uint32Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readUint32();return _e}function readRational(et,_){if(_===1)return et.readUint32()/et.readUint32();let _e=new Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readUint32()/et.readUint32();return _e}function readSByte(et,_){if(_===1)return et.readInt8();let _e=new Int8Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readInt8();return _e}function readSShort(et,_){if(_===1)return et.readInt16();let _e=new Int16Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readInt16();return _e}function readSLong(et,_){if(_===1)return et.readInt32();let _e=new Int32Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readInt32();return _e}function readSRational(et,_){if(_===1)return et.readInt32()/et.readInt32();let _e=new Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readInt32()/et.readInt32();return _e}function readFloat(et,_){if(_===1)return et.readFloat32();let _e=new Float32Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readFloat32();return _e}function readDouble(et,_){if(_===1)return et.readFloat64();let _e=new Float64Array(_);for(let tt=0;tt<_;tt++)_e[tt]=et.readFloat64();return _e}const CLEAR_CODE=256,EOI_CODE=257,TABLE_START=258,MIN_BIT_LENGTH=9;let stringTable=[];function initializeStringTable(){if(stringTable.length===0){for(let _=0;_<256;_++)stringTable.push([_]);const et=[];for(let _=256;_<4096;_++)stringTable.push(et)}}const andTable=[511,1023,2047,4095],bitJumps=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class LzwDecoder{constructor(_){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH,this.stripArray=new Uint8Array(_.buffer,_.byteOffset,_.byteLength),this.outData=new IOBuffer$4(_.byteLength),this.initializeTable()}decode(){let _=0,_e=0;for(;(_=this.getNextCode())!==EOI_CODE;)if(_===CLEAR_CODE){if(this.initializeTable(),_=this.getNextCode(),_===EOI_CODE)break;this.writeString(this.stringFromCode(_)),_e=_}else if(this.isInTable(_))this.writeString(this.stringFromCode(_)),this.addStringToTable(this.stringFromCode(_e).concat(this.stringFromCode(_)[0])),_e=_;else{const nt=this.stringFromCode(_e).concat(this.stringFromCode(_e)[0]);this.writeString(nt),this.addStringToTable(nt),_e=_}const tt=this.outData.toArray();return new DataView(tt.buffer,tt.byteOffset,tt.byteLength)}initializeTable(){initializeStringTable(),this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH}writeString(_){this.outData.writeBytes(_)}stringFromCode(_){return stringTable[_]}isInTable(_){return _<this.tableLength}addStringToTable(_){if(stringTable[this.tableLength++]=_,stringTable.length>4096)throw stringTable=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===bitJumps[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|this.stripArray[this.bytePointer++]&255,this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|this.stripArray[this.bytePointer++]&255,this.nextBits+=8);const _=this.nextData>>this.nextBits-this.currentBitLength&andTable[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:_}}function decompressLzw(et){return new LzwDecoder(et).decode()}const dateTimeRegex=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class TiffIfd extends IFD{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let _=new Date,_e=dateTimeRegex.exec(this.dateTime);if(_e===null)throw new Error(`invalid dateTime: ${this.dateTime}`);return _.setFullYear(Number(_e[1]),Number(_e[2])-1,Number(_e[3])),_.setHours(Number(_e[4]),Number(_e[5]),Number(_e[6])),_}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const _=this.get("BitsPerSample");return _&&typeof _!="number"?_[0]:_}get alpha(){const _=this.extraSamples;return _?_[0]!==0:!1}get associatedAlpha(){const _=this.extraSamples;return _?_[0]===1:!1}get extraSamples(){return alwaysArray(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return alwaysArray(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return alwaysArray(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const _=2**this.bitsPerSample,_e=this.get("ColorMap");if(!_e)return;if(_e.length!==3*_)throw new Error(`ColorMap size must be ${_}`);const tt=[];for(let nt=0;nt<_;nt++)tt.push([_e[nt],_e[nt+_],_e[nt+2*_]]);return tt}}function alwaysArray(et){return typeof et=="number"?[et]:et}function decompressZlib(et){const _=new Uint8Array(et.buffer,et.byteOffset,et.byteLength),_e=inflate_1(_);return new DataView(_e.buffer,_e.byteOffset,_e.byteLength)}const defaultOptions$c={ignoreImageData:!1,onlyFirst:!1};class TIFFDecoder extends IOBuffer$4{constructor(_){super(_),this._nextIFD=0}get isMultiPage(){let _=0;for(this.decodeHeader();this._nextIFD;)if(_++,this.decodeIFD({ignoreImageData:!0},!0),_===2)return!0;if(_===1)return!1;throw unsupported("ifdCount",_)}get pageCount(){let _=0;for(this.decodeHeader();this._nextIFD;)_++,this.decodeIFD({ignoreImageData:!0},!0);if(_>0)return _;throw unsupported("ifdCount",_)}decode(_={}){_=Object.assign({},defaultOptions$c,_);const _e=[];for(this.decodeHeader();this._nextIFD;)if(_e.push(this.decodeIFD(_,!0)),_.onlyFirst)return[_e[0]];return _e}decodeHeader(){const _=this.readUint16();if(_===18761)this.setLittleEndian();else if(_===19789)this.setBigEndian();else throw new Error(`invalid byte order: 0x${_.toString(16)}`);if(this.readUint16()!==42)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(_,_e){this.seek(this._nextIFD);let tt;if(_e)tt=new TiffIfd;else{if(!_.kind)throw new Error("kind is missing");tt=new IFD(_.kind)}const nt=this.readUint16();for(let rt=0;rt<nt;rt++)this.decodeIFDEntry(tt);if(!_.ignoreImageData){if(!(tt instanceof TiffIfd))throw new Error("must be a tiff ifd");this.decodeImageData(tt)}return this._nextIFD=this.readUint32(),tt}decodeIFDEntry(_){const _e=this.offset,tt=this.readUint16(),nt=this.readUint16(),rt=this.readUint32();if(nt<1||nt>12){this.skip(4);return}getByteLength(nt,rt)>4&&this.seek(this.readUint32());const st=readData(this,nt,rt);if(_.fields.set(tt,st),tt===34665||tt===34853){let ot=this.offset,at="exif";tt===34665?at="exif":tt===34853&&(at="gps"),this._nextIFD=st,_[at]=this.decodeIFD({kind:at,ignoreImageData:!0},!1),this.offset=ot}this.seek(_e),this.skip(12)}decodeImageData(_){const _e=_.orientation;if(_e&&_e!==1)throw unsupported("orientation",_e);switch(_.type){case 0:case 1:case 2:case 3:this.readStripData(_);break;default:throw unsupported("image type",_.type)}if(this.applyPredictor(_),this.convertAlpha(_),_.type===0){const tt=_.bitsPerSample,nt=Math.pow(2,tt)-1;for(let rt=0;rt<_.data.length;rt++)_.data[rt]=nt-_.data[rt]}}readStripData(_){const _e=_.width,tt=_.height,nt=_.bitsPerSample,rt=_.sampleFormat,it=_e*tt*_.samplesPerPixel,st=getDataArray(it,nt,rt),at=_.rowsPerStrip*_e*_.samplesPerPixel,lt=_.stripOffsets,ct=_.stripByteCounts||guessStripByteCounts(_);let ht=it,ut=0;for(let ft=0;ft<lt.length;ft++){let dt=new DataView(this.buffer,this.byteOffset+lt[ft],ct[ft]),pt=ht>at?at:ht;ht-=pt;let mt=dt;switch(_.compression){case 1:break;case 5:{mt=decompressLzw(dt);break}case 8:{mt=decompressZlib(dt);break}case 2:throw unsupported("Compression","CCITT Group 3");case 32773:throw unsupported("Compression","PackBits");default:throw unsupported("Compression",_.compression)}ut=this.fillUncompressed(nt,rt,st,mt,ut,pt)}_.data=st}fillUncompressed(_,_e,tt,nt,rt,it){if(_===8)return fill8bit(tt,nt,rt,it);if(_===16)return fill16bit(tt,nt,rt,it,this.isLittleEndian());if(_===32&&_e===3)return fillFloat32(tt,nt,rt,it,this.isLittleEndian());throw unsupported("bitDepth",_)}applyPredictor(_){const _e=_.bitsPerSample;switch(_.predictor){case 1:break;case 2:{if(_e===8)applyHorizontalDifferencing8Bit(_.data,_.width,_.components);else if(_e===16)applyHorizontalDifferencing16Bit(_.data,_.width,_.components);else throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${_e}`);break}default:throw new Error(`invalid predictor: ${_.predictor}`)}}convertAlpha(_){if(_.alpha&&_.associatedAlpha){const{data:_e,components:tt,maxSampleValue:nt}=_;for(let rt=0;rt<_e.length;rt+=tt){const it=_e[rt+tt-1];for(let st=0;st<tt-1;st++)_e[rt+st]=Math.round(_e[rt+st]*nt/it)}}}}function getDataArray(et,_,_e){if(_===8)return new Uint8Array(et);if(_===16)return new Uint16Array(et);if(_===32&&_e===3)return new Float32Array(et);throw unsupported("bit depth / sample format",`${_} / ${_e}`)}function fill8bit(et,_,_e,tt){for(let nt=0;nt<tt;nt++)et[_e++]=_.getUint8(nt);return _e}function fill16bit(et,_,_e,tt,nt){for(let rt=0;rt<tt*2;rt+=2)et[_e++]=_.getUint16(rt,nt);return _e}function fillFloat32(et,_,_e,tt,nt){for(let rt=0;rt<tt*4;rt+=4)et[_e++]=_.getFloat32(rt,nt);return _e}function unsupported(et,_){return new Error(`Unsupported ${et}: ${_}`)}function decodeTIFF(et,_){return new TIFFDecoder(et).decode(_)}function matchAndCrop(et={}){let{algorithm:_="matchToPrevious",ignoreBorder:_e=[0,0]}=et;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let tt=_==="matchToPrevious",nt=this[0],rt=[];rt[0]={position:[0,0],image:this[0]};let it=[0,0];for(let ht=1;ht<this.length;ht++){let ut=nt.getBestMatch(this[ht],{border:_e});rt[ht]={position:[ut[0]+it[0],ut[1]+it[1]],image:this[ht]},tt&&(it[0]+=ut[0],it[1]+=ut[1],nt=this[ht])}let st=0,ot=0,at=0,lt=0;for(let ht=0;ht<rt.length;ht++){let ut=rt[ht];ut.position[0]>st&&(st=ut.position[0]),ut.position[0]<ot&&(ot=ut.position[0]),ut.position[1]>at&&(at=ut.position[1]),ut.position[1]<lt&&(lt=ut.position[1])}ot=0-ot,lt=0-lt;for(let ht=0;ht<rt.length;ht++){let ut=rt[ht];ut.crop=ut.image.crop({x:st-ut.position[0],y:at-ut.position[1],width:nt.width-ot-st,height:nt.height-lt-at})}let ct=[];for(let ht=0;ht<rt.length;ht++)ct[ht]=rt[ht].crop;return new Stack(ct)}function min$2(){this.checkProcessable("min",{bitDepth:[8,16]});let et=this[0].min;for(let _=1;_<this.length;_++)for(let _e=0;_e<et.length;_e++)et[_e]=Math.min(et[_e],this[_].min[_e]);return et}function max$2(){this.checkProcessable("min",{bitDepth:[8,16]});let et=this[0].max;for(let _=1;_<this.length;_++)for(let _e=0;_e<et.length;_e++)et[_e]=Math.max(et[_e],this[_].max[_e]);return et}function median$2(et){let _=et.reduce((it,st)=>it+st);if(_===0)throw new Error("unreachable");let _e=0,tt=0,nt=_/2,rt;for(;;){if(et[_e]>0){if(rt!==void 0)return(rt+_e)/2;if(tt+=et[_e],tt>nt)return _e;tt===nt&&(rt=_e)}_e++}}function mean$2(et){let _=0,_e=0;for(let tt=0;tt<et.length;tt++)_+=et[tt],_e+=et[tt]*tt;return _===0?0:_e/_}function median$1(){this.checkProcessable("median",{bitDepth:[8,16]});let et=this.getHistograms({maxSlots:this[0].maxValue+1}),_=new Array(et.length);for(let _e=0;_e<et.length;_e++){let tt=et[_e];_[_e]=median$2(tt)}return _}function histogram(et){this.checkProcessable("min",{bitDepth:[8,16]});let _=this[0].getHistogram(et);for(let _e=1;_e<this.length;_e++){let tt=this[_e].getHistogram(et);for(let nt=0;nt<_.length;nt++)_[nt]+=tt[nt]}return _}function histograms(et){this.checkProcessable("min",{bitDepth:[8,16]});let _=this[0].getHistograms(et),_e=_[0].length;for(let tt=1;tt<this.length;tt++){let nt=this[tt].getHistograms(et);for(let rt=0;rt<_.length;rt++)for(let it=0;it<_e;it++)_[rt][it]+=nt[rt][it]}return _}function averageImage(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let et=new Uint32Array(this[0].data.length);for(let tt=0;tt<this.length;tt++){let nt=this[tt];for(let rt=0;rt<this[0].data.length;rt++)et[rt]+=nt.data[rt]}let _=Image$1.createFrom(this[0]),_e=_.data;for(let tt=0;tt<this[0].data.length;tt++)_e[tt]=et[tt]/this.length;return _}function maxImage(){this.checkProcessable("max",{bitDepth:[8,16]});let et=Image$1.createFrom(this[0]);et.data.fill(0);for(const _ of this)for(let _e=0;_e<et.data.length;_e++)et.data[_e]=Math.max(_.data[_e],et.data[_e]);return et}function minImage(){this.checkProcessable("max",{bitDepth:[8,16]});let et=Image$1.createFrom(this[0]);et.data.fill(et.maxValue);for(const _ of this)for(let _e=0;_e<et.data.length;_e++)et.data[_e]=Math.min(_.data[_e],et.data[_e]);return et}function extend$2(et){et.extendMethod("matchAndCrop",matchAndCrop),et.extendMethod("getMin",min$2),et.extendMethod("getMax",max$2),et.extendMethod("getMedian",median$1),et.extendMethod("getHistogram",histogram),et.extendMethod("getHistograms",histograms),et.extendMethod("getAverage",averageImage),et.extendMethod("getAverageImage",averageImage),et.extendMethod("getMaxImage",maxImage),et.extendMethod("getMinImage",minImage)}let computedPropertyDescriptor={configurable:!0,enumerable:!1,get:void 0};class Stack extends Array{constructor(_){if(Array.isArray(_)){super(_.length);for(let _e=0;_e<_.length;_e++)this[_e]=_[_e]}else typeof _=="number"?super(_):super();this.computed=null}static load(_){return Promise.all(_.map(Image$1.load)).then(_e=>new Stack(_e))}static extendMethod(_,_e,tt={}){let{inPlace:nt=!1,returnThis:rt=!0,partialArgs:it=[]}=tt;return nt?Stack.prototype[_]=function(...st){this.computed=null;let ot=_e.apply(this,[...it,...st]);return rt?this:ot}:Stack.prototype[_]=function(...st){return _e.apply(this,[...it,...st])},Stack}static extendProperty(_,_e,tt={}){let{partialArgs:nt=[]}=tt;return computedPropertyDescriptor.get=function(){if(this.computed===null)this.computed={};else if(hasOwn(_,this.computed))return this.computed[_];let rt=_e.apply(this,nt);return this.computed[_]=rt,rt},Object.defineProperty(Stack.prototype,_,computedPropertyDescriptor),Stack}checkProcessable(_,_e={}){if(typeof _!="string")throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(this.size===0)throw new TypeError(`The process: ${_} can not be applied on an empty stack`);this[0].checkProcessable(_,_e);for(let tt=1;tt<this.length;tt++){if((_e.sameSize===void 0||_e.sameSize)&&this[0].width!==this[tt].width)throw new TypeError(`The process: ${_} can not be applied if width is not identical in all images`);if((_e.sameSize===void 0||_e.sameSize)&&this[0].height!==this[tt].height)throw new TypeError(`The process: ${_} can not be applied if height is not identical in all images`);if((_e.sameAlpha===void 0||_e.sameAlpha)&&this[0].alpha!==this[tt].alpha)throw new TypeError(`The process: ${_} can not be applied if alpha is not identical in all images`);if((_e.sameBitDepth===void 0||_e.sameBitDepth)&&this[0].bitDepth!==this[tt].bitDepth)throw new TypeError(`The process: ${_} can not be applied if bitDepth is not identical in all images`);if((_e.sameColorModel===void 0||_e.sameColorModel)&&this[0].colorModel!==this[tt].colorModel)throw new TypeError(`The process: ${_} can not be applied if colorModel is not identical in all images`);if((_e.sameNumberChannels===void 0||_e.sameNumberChannels)&&this[0].channels!==this[tt].channels)throw new TypeError(`The process: ${_} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Stack.prototype.map=function(et,_){if(typeof et!="function")throw new TypeError(`${et} is not a function`);let _e=new Stack(this.length);for(let tt=0;tt<this.length;tt++)_e[tt]=et.call(_,this[tt],tt,this);return _e});extend$2(Stack);const isDataURL=/^data:[a-z]+\/(?:[a-z]+);base64,/;function load(et,_){if(typeof et=="string")return loadURL(et,_);if(et instanceof ArrayBuffer)return Promise.resolve(loadBinary(new Uint8Array(et),void 0,_&&_.ignorePalette));if(et.buffer)return Promise.resolve(loadBinary(et,void 0,_&&_.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')}function loadBinary(et,_,_e){const tt=imageType$1(et);if(tt)switch(tt.mime){case"image/png":return loadPNG(et);case"image/jpeg":return loadJPEG(et);case"image/tiff":return loadTIFF(et,_e);default:return loadGeneric(nt(tt.mime))}return loadGeneric(nt("application/octet-stream"));function nt(rt){return _||toBase64URL(et,rt)}}function loadURL(et,_){const _e=et.slice(0,64).match(isDataURL);let tt;return _e!==null?tt=Promise.resolve(decode$3(et.slice(_e[0].length))):tt=fetchBinary(et,_),tt.then(nt=>{const rt=new Uint8Array(nt);return loadBinary(rt,_e?et:void 0,_&&_.ignorePalette)})}function loadPNG(et){const _=decodePng(et);let _e=_.channels,tt,nt=0;return _e===2||_e===4?(tt=_e-1,nt=1):tt=_e,_.palette?loadPNGFromPalette(_):new Image$1(_.width,_.height,_.data,{components:tt,alpha:nt,bitDepth:_.depth})}function loadPNGFromPalette(et){const _=et.width*et.height,_e=et.palette[0].length,tt=new Uint8Array(_*_e),nt=8/et.depth,rt=et.depth<8?nt:1,it=parseInt("1".repeat(et.depth),2),st=_e===4;let ot=0;for(let at=0;at<_;at++){const lt=Math.floor(at/rt);let ct=et.data[lt];et.depth<8&&(ct=ct>>>et.depth*(nt-1-at%nt)&it);const ht=et.palette[ct];tt[ot++]=ht[0],tt[ot++]=ht[1],tt[ot++]=ht[2],st&&(tt[ot++]=ht[3])}return new Image$1(et.width,et.height,tt,{components:3,alpha:st,bitDepth:8})}function loadJPEG(et){const _=decode(et);let _e;_.exif&&(_e=getMetadata(_.exif));const tt=jpegJs.decode(et,{useTArray:!0,maxMemoryUsageInMB:1024});let nt=new Image$1(tt.width,tt.height,tt.data,{meta:_e});if(_e&&_e.tiff.tags.Orientation){const rt=_e.tiff.tags.Orientation;rt>2&&(nt=nt.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[rt])),[2,4,5,7].includes(rt)&&(nt=nt.flipX())}return nt}function loadTIFF(et,_){let _e=decodeTIFF(et);return _e.length===1?getImageFromIFD(_e[0],_):new Stack(_e.map(function(tt){return getImageFromIFD(tt,_)}))}function getMetadata(et){const _={tiff:{fields:et.fields,tags:et.map}};return et.exif&&(_.exif=et.exif),et.gps&&(_.gps=et.gps),_}function getImageFromIFD(et,_){if(!_&&et.type===3){const _e=new Uint16Array(3*et.width*et.height),tt=et.palette;let nt=0;for(let rt=0;rt<et.data.length;rt++){const it=et.data[rt],st=tt[it];_e[nt++]=st[0],_e[nt++]=st[1],_e[nt++]=st[2]}return new Image$1(et.width,et.height,_e,{components:3,alpha:et.alpha,colorModel:RGB$1,bitDepth:16,meta:getMetadata(et)})}else return new Image$1(et.width,et.height,et.data,{components:et.type===2?3:1,alpha:et.alpha,colorModel:et.type===2?RGB$1:GREY$1,bitDepth:et.bitsPerSample.length?et.bitsPerSample[0]:et.bitsPerSample,meta:getMetadata(et)})}function loadGeneric(et,_){return _=_||{},new Promise(function(_e,tt){let nt=new DOMImage;nt.onload=function(){let rt=nt.width,it=nt.height,ot=createCanvas(rt,it).getContext("2d");ot.drawImage(nt,0,0,rt,it);let at=ot.getImageData(0,0,rt,it).data;_e(new Image$1(rt,it,at,_))},nt.onerror=function(){tt(new Error(`Could not load ${et}`))},nt.src=et})}const valueMethods={getValueXY(et,_,_e){return this.data[(_*this.width+et)*this.channels+_e]},setValueXY(et,_,_e,tt){return this.data[(_*this.width+et)*this.channels+_e]=tt,this.computed=null,this},getValue(et,_){return this.data[et*this.channels+_]},setValue(et,_,_e){return this.data[et*this.channels+_]=_e,this.computed=null,this},getPixelXY(et,_){return this.getPixel(_*this.width+et)},setPixelXY(et,_,_e){return this.setPixel(_*this.width+et,_e)},getPixel(et){const _=new Array(this.channels),_e=et*this.channels;for(let tt=0;tt<this.channels;tt++)_[tt]=this.data[_e+tt];return _},setPixel(et,_){const _e=et*this.channels;for(let tt=0;tt<_.length;tt++)this.data[_e+tt]=_[tt];return this.computed=null,this}};function setValueMethods(et){for(const _ in valueMethods)et.prototype[_]=valueMethods[_]}function getImageParameters(et){return{width:et.width,height:et.height,components:et.components,alpha:et.alpha,colorModel:et.colorModel,bitDepth:et.bitDepth}}function getOutputImage(et,_,_e,tt={}){const{out:nt}=_;if(nt===void 0)return tt.copy?et.clone():Image$1.createFrom(et,_e);{if(!Image$1.isImage(nt))throw new TypeError("out must be an Image object");const rt=Object.assign(getImageParameters(et),_e);for(const it in rt)if(nt[it]!==rt[it])throw new RangeError(`cannot use out. Its ${it} must be "${rt[it]}" (found "${nt[it]}")`);return nt}}function getOutputImageOrInPlace(et,_,_e){if(_.inPlace!==void 0&&typeof _.inPlace!="boolean")throw new TypeError("inPlace option must be a boolean");if(_.inPlace){if(_.out!==void 0)throw new TypeError("out option must not be set if inPlace option is true");return et}return getOutputImage(et,_,null,_e)}function abs(et={}){this.checkProcessable("abs",{bitDepth:[32]});const _=getOutputImageOrInPlace(this,et);return absolute(this,_),_}function absolute(et,_){for(let _e=0;_e<et.data.length;_e++)_.data[_e]=Math.abs(et.data[_e])}function copyAlphaChannel(et,_){if(et.alpha===1&&_.alpha===1)for(let _e=0;_e<et.size;_e++)_.data[_e*_.channels+_.components]=et.data[_e*et.channels+et.components]}function invert(et={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const _=getOutputImageOrInPlace(this,et);return this.bitDepth===1?invertBinary(this,_):(invertColor(this,_),this!==_&&copyAlphaChannel(this,_)),_}function invertBinary(et,_){for(let _e=0;_e<et.data.length;_e++)_.data[_e]=~et.data[_e]}function invertColor(et,_){for(let _e=0;_e<et.data.length;_e+=et.channels)for(let tt=0;tt<et.components;tt++)_.data[_e+tt]=et.maxValue-et.data[_e+tt]}function flipX(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let et=0;et<this.height;et++){let _=et*this.width*this.channels;for(let _e=0;_e<Math.floor(this.width/2);_e++){let tt=_e*this.channels+_,nt=(this.width-_e-1)*this.channels+_;for(let rt=0;rt<this.channels;rt++){let it=this.data[tt+rt];this.data[tt+rt]=this.data[nt+rt],this.data[nt+rt]=it}}}return this}function flipY(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let et=0;et<Math.floor(this.height/2);et++)for(let _=0;_<this.width;_++){let _e=_*this.channels+et*this.width*this.channels,tt=_*this.channels+(this.height-1-et)*this.channels*this.width;for(let nt=0;nt<this.channels;nt++){let rt=this.data[_e+nt];this.data[_e+nt]=this.data[tt+nt],this.data[tt+nt]=rt}}return this}function blurFilter(et={}){const{radius:_=1}=et;if(_<1)throw new Error("radius must be greater than 1");const _e=2*_+1,tt=new Array(_e);for(let nt=0;nt<_e;nt++){tt[nt]=new Array(_e);for(let rt=0;rt<_e;rt++)tt[nt][rt]=1/(_e*_e)}return this.convolution(tt)}var medianQuickselect_min={exports:{}};(function(et){(function(){function _(nt){for(var rt=0,it=nt.length-1,st=void 0,ot=void 0,at=void 0,lt=tt(rt,it);;){if(it<=rt)return nt[lt];if(it==rt+1)return nt[rt]>nt[it]&&_e(nt,rt,it),nt[lt];for(st=tt(rt,it),nt[st]>nt[it]&&_e(nt,st,it),nt[rt]>nt[it]&&_e(nt,rt,it),nt[st]>nt[rt]&&_e(nt,st,rt),_e(nt,st,rt+1),ot=rt+1,at=it;;){do ot++;while(nt[rt]>nt[ot]);do at--;while(nt[at]>nt[rt]);if(at<ot)break;_e(nt,ot,at)}_e(nt,rt,at),at<=lt&&(rt=ot),at>=lt&&(it=at-1)}}var _e=function(rt,it,st){var ot;return ot=[rt[st],rt[it]],rt[it]=ot[0],rt[st]=ot[1],ot},tt=function(rt,it){return~~((rt+it)/2)};et.exports?et.exports=_:window.median=_})()})(medianQuickselect_min);var medianQuickselect_minExports=medianQuickselect_min.exports;const quickSelectMedian=getDefaultExportFromCjs(medianQuickselect_minExports);function validateArrayOfChannels(et,_={}){let{channels:_e,allowAlpha:tt,defaultAlpha:nt}=_;return typeof tt!="boolean"&&(tt=!0),typeof _e>"u"?allChannels(et,nt):validateChannels(et,_e,tt)}function allChannels(et,_){let _e=_?et.channels:et.components,tt=new Array(_e);for(let nt=0;nt<_e;nt++)tt[nt]=nt;return tt}function validateChannels(et,_,_e){Array.isArray(_)||(_=[_]);for(let tt=0;tt<_.length;tt++)_[tt]=validateChannel(et,_[tt],_e);return _}function validateChannel(et,_,_e=!0){if(_===void 0)throw new RangeError(`validateChannel : the channel has to be >=0 and <${et.channels}`);if(typeof _=="string"){switch(et.colorModel){case GREY$1:break;case RGB$1:if("rgb".includes(_))switch(_){case"r":_=0;break;case"g":_=1;break;case"b":_=2;break}break;case HSL:if("hsl".includes(_))switch(_){case"h":_=0;break;case"s":_=1;break;case"l":_=2;break}break;case HSV:if("hsv".includes(_))switch(_){case"h":_=0;break;case"s":_=1;break;case"v":_=2;break}break;case CMYK$1:if("cmyk".includes(_))switch(_){case"c":_=0;break;case"m":_=1;break;case"y":_=2;break;case"k":_=3;break}break;default:throw new Error(`Unexpected color model: ${et.colorModel}`)}if(_==="a"){if(!et.alpha)throw new Error("validateChannel : the image does not contain alpha channel");_=et.components}if(typeof _=="string")throw new Error(`validateChannel : undefined channel: ${_}`)}if(_>=et.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${et.channels}`);if(!_e&&_>=et.components)throw new RangeError("validateChannel : alpha channel may not be selected");return _}function medianFilter(et={}){let{radius:_=1,border:_e="copy",channels:tt}=et;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),_<1)throw new Error("radius must be greater than 0");tt=validateArrayOfChannels(this,tt);let nt=_,rt=_,it=Image$1.createFrom(this),st=(nt*2+1)*(rt*2+1),ot=new Array(st);for(let at=0;at<tt.length;at++){let lt=tt[at];for(let ct=rt;ct<this.height-rt;ct++)for(let ht=nt;ht<this.width-nt;ht++){let ut=0;for(let dt=-rt;dt<=rt;dt++)for(let pt=-nt;pt<=nt;pt++){let mt=((ct+dt)*this.width+ht+pt)*this.channels+lt;ot[ut++]=this.data[mt]}let ft=(ct*this.width+ht)*this.channels+lt;it.data[ft]=quickSelectMedian(ot)}}if(this.alpha&&!tt.includes(this.channels))for(let at=this.components;at<this.data.length;at=at+this.channels)it.data[at]=this.data[at];return it.setBorder({size:[nt,rt],algorithm:_e}),it}function gaussianFilter(et={}){let{radius:_=1,sigma:_e,channels:tt,border:nt="copy"}=et;this.checkProcessable("gaussian",{bitDepth:[8,16]});const rt=getKernel(_,_e);return this.convolution([rt,rt],{border:nt,channels:tt,algorithm:"separable"})}function getKernel(et,_){const _e=et*2+1,tt=new Array(_e),nt=_||((_e-1)*.5-1)*.3+.8,rt=-.5/(nt*nt);let it=0;for(let st=0;st<_e;st++){const ot=st-et,at=Math.exp(rt*ot*ot);tt[st]=at,it+=at}for(let st=0;st<_e;st++)tt[st]/=it;return tt}const SOBEL_X=[[-1,0,1],[-2,0,2],[-1,0,1]],SOBEL_Y=[[-1,-2,-1],[0,0,0],[1,2,1]],SCHARR_X=[[3,0,-3],[10,0,-10],[3,0,-3]],SCHARR_Y=[[3,10,3],[0,0,0],[-3,-10,-3]];var src$2={},fftlib={};(function(et){(function(){var _;_=et;var _e={release:"0.3.0",date:"2013-03"};_.toString=function(){return"version "+_e.release+", released "+_e.date};for(var tt=0,nt=null,rt=null,it={init:function(at){if(at!==0&&!(at&at-1))tt=at,it._initArray(),it._makeBitReversalTable(),it._makeCosSinTable();else throw new Error("init: radix-2 required")},fft1d:function(at,lt){it.fft(at,lt,1)},ifft1d:function(at,lt){var ct=1/tt;it.fft(at,lt,-1);for(var ht=0;ht<tt;ht++)at[ht]*=ct,lt[ht]*=ct},bt1d:function(at,lt){it.fft(at,lt,-1)},fft2d:function(at,lt){for(var ct=[],ht=[],ut=0,ft=0;ft<tt;ft++){ut=ft*tt;for(var dt=0;dt<tt;dt++)ct[dt]=at[dt+ut],ht[dt]=lt[dt+ut];it.fft1d(ct,ht);for(var pt=0;pt<tt;pt++)at[pt+ut]=ct[pt],lt[pt+ut]=ht[pt]}for(var mt=0;mt<tt;mt++){for(var vt=0;vt<tt;vt++)ut=mt+vt*tt,ct[vt]=at[ut],ht[vt]=lt[ut];it.fft1d(ct,ht);for(var yt=0;yt<tt;yt++)ut=mt+yt*tt,at[ut]=ct[yt],lt[ut]=ht[yt]}},ifft2d:function(at,lt){for(var ct=[],ht=[],ut=0,ft=0;ft<tt;ft++){ut=ft*tt;for(var dt=0;dt<tt;dt++)ct[dt]=at[dt+ut],ht[dt]=lt[dt+ut];it.ifft1d(ct,ht);for(var pt=0;pt<tt;pt++)at[pt+ut]=ct[pt],lt[pt+ut]=ht[pt]}for(var mt=0;mt<tt;mt++){for(var vt=0;vt<tt;vt++)ut=mt+vt*tt,ct[vt]=at[ut],ht[vt]=lt[ut];it.ifft1d(ct,ht);for(var yt=0;yt<tt;yt++)ut=mt+yt*tt,at[ut]=ct[yt],lt[ut]=ht[yt]}},fft:function(at,lt,ct){for(var ht,ut,ft,dt,pt,mt,vt,yt,_t,St=tt>>2,bt=0;bt<tt;bt++)dt=nt[bt],bt<dt&&(pt=at[bt],at[bt]=at[dt],at[dt]=pt,pt=lt[bt],lt[bt]=lt[dt],lt[dt]=pt);for(var Et=1;Et<tt;Et<<=1){ut=0,ht=tt/(Et<<1);for(var Mt=0;Mt<Et;Mt++){mt=rt[ut+St],vt=ct*rt[ut];for(var Tt=Mt;Tt<tt;Tt+=Et<<1)ft=Tt+Et,yt=mt*at[ft]+vt*lt[ft],_t=mt*lt[ft]-vt*at[ft],at[ft]=at[Tt]-yt,at[Tt]+=yt,lt[ft]=lt[Tt]-_t,lt[Tt]+=_t;ut+=ht}}},_initArray:function(){typeof Uint32Array<"u"?nt=new Uint32Array(tt):nt=[],typeof Float64Array<"u"?rt=new Float64Array(tt*1.25):rt=[]},_paddingZero:function(){},_makeBitReversalTable:function(){var at=0,lt=0,ct=0;for(nt[0]=0;++at<tt;){for(ct=tt>>1;ct<=lt;)lt-=ct,ct>>=1;lt+=ct,nt[at]=lt}},_makeCosSinTable:function(){var at=tt>>1,lt=tt>>2,ct=tt>>3,ht=at+lt,ut=Math.sin(Math.PI/tt),ft=2*ut*ut,dt=Math.sqrt(ft*(2-ft)),pt=rt[lt]=1,mt=rt[0]=0;ut=2*ft;for(var vt=1;vt<ct;vt++)pt-=ft,ft+=ut*pt,mt+=dt,dt-=ut*mt,rt[vt]=mt,rt[lt-vt]=pt;ct!==0&&(rt[ct]=Math.sqrt(.5));for(var yt=0;yt<lt;yt++)rt[at-yt]=rt[yt];for(var _t=0;_t<ht;_t++)rt[_t+at]=-rt[_t]}},st=["init","fft1d","ifft1d","fft2d","ifft2d"],ot=0;ot<st.length;ot++)_[st[ot]]=it[st[ot]];return _.bt=it.bt1d,_.fft=it.fft1d,_.ifft=it.ifft1d,_}).call(commonjsGlobal)})(fftlib);var FFT$1=fftlib,FFTUtils$1={DEBUG:!1,ifft2DArray:function(et,_,_e){var tt=new Array(_*_e),nt=_/2,rt=(_e-1)*2;FFT$1.init(nt);for(var it={re:new Array(nt),im:new Array(nt)},st=0;st<_e;st++){for(var ot=nt-1;ot>=0;ot--)it.re[ot]=et[ot*2*_e+st],it.im[ot]=et[(ot*2+1)*_e+st];FFT$1.bt(it.re,it.im);for(var ot=nt-1;ot>=0;ot--)tt[ot*2*_e+st]=it.re[ot],tt[(ot*2+1)*_e+st]=it.im[ot]}var at=new Array(nt*rt);FFT$1.init(rt);for(var lt={re:new Array(rt),im:new Array(rt)},ct=rt*nt,ot=0;ot<_;ot+=2){lt.re[0]=tt[ot*_e],lt.im[0]=tt[(ot+1)*_e];for(var st=1;st<_e;st++)lt.re[st]=tt[ot*_e+st],lt.im[st]=tt[(ot+1)*_e+st],lt.re[rt-st]=tt[ot*_e+st],lt.im[rt-st]=-tt[(ot+1)*_e+st];FFT$1.bt(lt.re,lt.im);for(var ht=ot/2*rt,st=rt-1;st>=0;st--)at[ht+st]=lt.re[st]/ct}return at},fft2DArray:function(et,_,_e,tt){Object.assign({},{inplace:!0});var nt=_e/2+1,rt=_*2,it=new Array(rt*nt);FFT$1.init(_e);for(var st={re:new Array(_e),im:new Array(_e)},ot={re:new Array(_e),im:new Array(_e)},at={re:new Array(_e),im:new Array(_e)},lt,ct,ht,ut,ft,dt=0;dt<_/2;dt++){lt=dt*2*_e,st.re=et.slice(lt,lt+_e),lt=(dt*2+1)*_e,st.im=et.slice(lt,lt+_e),FFT$1.fft1d(st.re,st.im),this.reconstructTwoRealFFT(st,ot,at),ct=dt*4*nt,ht=(dt*4+1)*nt,ut=(dt*4+2)*nt,ft=(dt*4+3)*nt;for(var pt=nt-1;pt>=0;pt--)it[ct+pt]=ot.re[pt],it[ht+pt]=ot.im[pt],it[ut+pt]=at.re[pt],it[ft+pt]=at.im[pt]}ot=null,at=null;var mt=new Array(rt*nt);FFT$1.init(_);for(var vt={re:new Array(_),im:new Array(_)},yt=nt-1;yt>=0;yt--){for(var dt=_-1;dt>=0;dt--)vt.re[dt]=it[dt*2*nt+yt],vt.im[dt]=it[(dt*2+1)*nt+yt],isNaN(vt.re[dt])&&(vt.re[dt]=0),isNaN(vt.im[dt])&&(vt.im[dt]=0);FFT$1.fft1d(vt.re,vt.im);for(var dt=_-1;dt>=0;dt--)mt[dt*2*nt+yt]=vt.re[dt],mt[(dt*2+1)*nt+yt]=vt.im[dt]}return mt},reconstructTwoRealFFT:function(et,_,_e){var tt=et.re.length;_.re[0]=et.re[0],_.im[0]=0,_e.re[0]=et.im[0],_e.im[0]=0;for(var nt,rt,it,st,ot,at=tt/2;at>0;at--)ot=tt-at,nt=.5*(et.re[at]-et.re[ot]),rt=.5*(et.re[at]+et.re[ot]),it=.5*(et.im[at]-et.im[ot]),st=.5*(et.im[at]+et.im[ot]),_.re[at]=rt,_.im[at]=it,_.re[ot]=rt,_.im[ot]=-it,_e.re[at]=st,_e.im[at]=-nt,_e.re[ot]=st,_e.im[ot]=nt},convolute2DI:function(et,_,_e,tt){for(var nt,rt,it=0;it<_e/2;it++)for(var st=0;st<tt;st++)nt=et[it*2*tt+st]*_[it*2*tt+st]-et[(it*2+1)*tt+st]*_[(it*2+1)*tt+st],rt=et[it*2*tt+st]*_[(it*2+1)*tt+st]+et[(it*2+1)*tt+st]*_[it*2*tt+st],et[it*2*tt+st]=nt,et[(it*2+1)*tt+st]=rt},convolute:function(et,_,_e,tt,nt){for(var rt=new Array(tt*_e),it=0;it<_e*tt;it++)rt[it]=et[it];rt=this.fft2DArray(rt,_e,tt);for(var st=_.length,ot=_[0].length,at=new Array(tt*_e),it=0;it<tt*_e;it++)at[it]=0;for(var lt,ct,ht=Math.floor((st-1)/2),ut=Math.floor((ot-1)/2),ft=0;ft<st;ft++){lt=(ft-ht+_e)%_e;for(var dt=0;dt<ot;dt++)ct=(dt-ut+tt)%tt,at[lt*tt+ct]=_[ft][dt]}at=this.fft2DArray(at,_e,tt);var pt=_e*2,mt=tt/2+1;return this.convolute2DI(rt,at,pt,mt),this.ifft2DArray(rt,pt,mt)},toRadix2:function(et,_,_e){var tt,nt,rt,it,st=_e,ot=_;if(!(_e!==0&&!(_e&_e-1))){for(st=0;_e>>++st;);st=1<<st}if(!(_!==0&&!(_&_-1))){for(ot=0;_>>++ot;);ot=1<<ot}if(ot==_&&st==_e)return{data:et,rows:_,cols:_e};var at=new Array(ot*st),lt=Math.floor((ot-_)/2)-_,ct=Math.floor((st-_e)/2)-_e;for(tt=0;tt<ot;tt++)for(rt=tt*st,it=(tt-lt)%_*_e,nt=0;nt<st;nt++)at[rt+nt]=et[it+(nt-ct)%_e];return{data:at,rows:ot,cols:st}},crop:function(et,_,_e,tt,nt,rt){if(_==tt&&_e==nt)return et;Object.assign({},rt);var it=new Array(nt*tt),st=Math.floor((_-tt)/2),ot=Math.floor((_e-nt)/2),at,lt,ct,ht;for(ct=0;ct<tt;ct++)for(at=ct*nt,lt=(ct+st)*_e,ht=0;ht<nt;ht++)it[at+ht]=et[lt+(ht+ot)];return it}},FFTUtils_1=FFTUtils$1;src$2.FFTUtils=FFTUtils_1;src$2.FFT=fftlib;var FFTUtils=src$2.FFTUtils;function convolutionFFT(et,_,_e){var tt=matrix2Array(et),nt=tt.data,rt=Object.assign({normalize:!1,divisor:1,rows:tt.rows,cols:tt.cols},_e),it,st;if(rt.rows&&rt.cols)it=rt.rows,st=rt.cols;else throw new Error("Invalid number of rows or columns "+it+" "+st);var ot=rt.divisor,at,lt,ct=_.length,ht=_[0].length;if(rt.normalize)for(ot=0,at=0;at<ct;at++)for(lt=0;lt<ht;lt++)ot+=_[at][lt];if(ot===0)throw new RangeError("convolution: The divisor is equal to zero");var ut=FFTUtils.toRadix2(nt,it,st),ft=FFTUtils.convolute(ut.data,_,ut.rows,ut.cols);if(ft=FFTUtils.crop(ft,ut.rows,ut.cols,it,st),ot!=0&&ot!=1)for(at=0;at<ft.length;at++)ft[at]/=ot;return ft}function convolutionDirect(et,_,_e){var tt=matrix2Array(et),nt=tt.data,rt=Object.assign({normalize:!1,divisor:1,rows:tt.rows,cols:tt.cols},_e),it,st;if(rt.rows&&rt.cols)it=rt.rows,st=rt.cols;else throw new Error("Invalid number of rows or columns "+it+" "+st);var ot=rt.divisor,at=_.length,lt=_[0].length,ct,ht,ut,ft,dt,pt,mt,vt,yt;if(rt.normalize)for(ot=0,ct=0;ct<at;ct++)for(ht=0;ht<lt;ht++)ot+=_[ct][ht];if(ot===0)throw new RangeError("convolution: The divisor is equal to zero");var _t=new Array(it*st),St=Math.floor(at/2),bt=Math.floor(lt/2);for(ft=0;ft<it;ft++)for(ut=0;ut<st;ut++){for(pt=0,ht=0;ht<at;ht++)for(ct=0;ct<lt;ct++)mt=_[at-ht-1][lt-ct-1],vt=(ft+ht-St+it)%it,yt=(ut+ct-bt+st)%st,dt=vt*st+yt,pt+=nt[dt]*mt;dt=ft*st+ut,_t[dt]=pt/ot}return _t}function LoG(et,_,_e){var tt=1e3;_e&&_e.factor&&(tt=_e.factor);var nt=new Array(_),rt,it,st,ot;tt*=-1;var at=(_-1)/2,lt=2*et*et;for(rt=0;rt<_;rt++)for(nt[rt]=new Array(_),ot=(rt-at)*(rt-at),it=0;it<_;it++)st=-((it-at)*(it-at)+ot)/lt,nt[rt][it]=Math.round(tt*(1+st)*Math.exp(st));return nt}function matrix2Array(et){var _=et,_e,tt;if(typeof et[0]!="number"){_e=et.length,tt=et[0].length,_=new Array(_e*tt);for(var nt=0;nt<_e;nt++)for(var rt=0;rt<tt;rt++)_[nt*tt+rt]=et[nt][rt]}else{var it=Math.sqrt(et.length);Number.isInteger(it)&&(_e=it,tt=it)}return{data:_,rows:_e,cols:tt}}var src$1={fft:convolutionFFT,direct:convolutionDirect,kernelFactory:{LoG},matrix2Array},_isFinite=Number.isFinite||function(et){return!(typeof et!="number"||et!==et||et===1/0||et===-1/0)},isFinite$1=_isFinite,isInteger=Number.isInteger||function(et){return typeof et=="number"&&isFinite$1(et)&&Math.floor(et)===et};const isInteger$1=getDefaultExportFromCjs(isInteger);function validateKernel(et){let _,_e;if(Array.isArray(et))if(Array.isArray(et[0])){if(!(et.length&1)||!(et[0].length&1))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");_=Math.floor(et.length/2),_e=Math.floor(et[0].length/2)}else{let tt=Math.sqrt(et.length);if(isInteger$1(tt))_e=_=Math.floor(Math.sqrt(et.length)/2);else throw new RangeError("validateKernel: Kernel array should be a square");let nt=new Array(tt);for(let rt=0;rt<tt;rt++){nt[rt]=new Array(tt);for(let it=0;it<tt;it++)nt[rt][it]=et[rt*tt+it]}et=nt}else throw new Error(`validateKernel: Invalid Kernel: ${et}`);return{kernel:et,kWidth:_e,kHeight:_}}function clamp(et,_){return Math.round(Math.min(Math.max(et,0),_.maxValue))}function directConvolution(et,_,_e){if(_e===void 0){const rt=et.length+_.length-1;_e=new Array(rt)}fill(_e);for(var tt=0;tt<et.length;tt++)for(var nt=0;nt<_.length;nt++)_e[tt+nt]+=et[tt]*_[nt];return _e}function fill(et){for(var _=0;_<et.length;_++)et[_]=0}function FFT(et){if(this.size=et|0,this.size<=1||this.size&this.size-1)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=et<<1;for(var _=new Array(this.size*2),_e=0;_e<_.length;_e+=2){const ot=Math.PI*_e/this.size;_[_e]=Math.cos(ot),_[_e+1]=-Math.sin(ot)}this.table=_;for(var tt=0,nt=1;this.size>nt;nt<<=1)tt++;this._width=tt%2===0?tt-1:tt,this._bitrev=new Array(1<<this._width);for(var rt=0;rt<this._bitrev.length;rt++){this._bitrev[rt]=0;for(var it=0;it<this._width;it+=2){var st=this._width-it-2;this._bitrev[rt]|=(rt>>>it&3)<<st}}this._out=null,this._data=null,this._inv=0}FFT.prototype.fromComplexArray=function et(_,_e){for(var tt=_e||new Array(_.length>>>1),nt=0;nt<_.length;nt+=2)tt[nt>>>1]=_[nt];return tt};FFT.prototype.createComplexArray=function et(){const _=new Array(this._csize);for(var _e=0;_e<_.length;_e++)_[_e]=0;return _};FFT.prototype.toComplexArray=function et(_,_e){for(var tt=_e||this.createComplexArray(),nt=0;nt<tt.length;nt+=2)tt[nt]=_[nt>>>1],tt[nt+1]=0;return tt};FFT.prototype.completeSpectrum=function et(_){for(var _e=this._csize,tt=_e>>>1,nt=2;nt<tt;nt+=2)_[_e-nt]=_[nt],_[_e-nt+1]=-_[nt+1]};FFT.prototype.transform=function et(_,_e){if(_===_e)throw new Error("Input and output buffers must be different");this._out=_,this._data=_e,this._inv=0,this._transform4(),this._out=null,this._data=null};FFT.prototype.realTransform=function et(_,_e){if(_===_e)throw new Error("Input and output buffers must be different");this._out=_,this._data=_e,this._inv=0,this._realTransform4(),this._out=null,this._data=null};FFT.prototype.inverseTransform=function et(_,_e){if(_===_e)throw new Error("Input and output buffers must be different");this._out=_,this._data=_e,this._inv=1,this._transform4();for(var tt=0;tt<_.length;tt++)_[tt]/=this.size;this._out=null,this._data=null};FFT.prototype._transform4=function et(){var _=this._out,_e=this._csize,tt=this._width,nt=1<<tt,rt=_e/nt<<1,it,st,ot=this._bitrev;if(rt===4)for(it=0,st=0;it<_e;it+=rt,st++){const dt=ot[st];this._singleTransform2(it,dt,nt)}else for(it=0,st=0;it<_e;it+=rt,st++){const dt=ot[st];this._singleTransform4(it,dt,nt)}var at=this._inv?-1:1,lt=this.table;for(nt>>=2;nt>=2;nt>>=2){rt=_e/nt<<1;var ct=rt>>>2;for(it=0;it<_e;it+=rt)for(var ht=it+ct,ut=it,ft=0;ut<ht;ut+=2,ft+=nt){const dt=ut,pt=dt+ct,mt=pt+ct,vt=mt+ct,yt=_[dt],_t=_[dt+1],St=_[pt],bt=_[pt+1],Et=_[mt],Mt=_[mt+1],Tt=_[vt],wt=_[vt+1],Ct=yt,Rt=_t,It=lt[ft],Dt=at*lt[ft+1],Ft=St*It-bt*Dt,$t=St*Dt+bt*It,Yt=lt[2*ft],Lt=at*lt[2*ft+1],Ot=Et*Yt-Mt*Lt,Nt=Et*Lt+Mt*Yt,zt=lt[3*ft],Ht=at*lt[3*ft+1],qt=Tt*zt-wt*Ht,Gt=Tt*Ht+wt*zt,Xt=Ct+Ot,Zt=Rt+Nt,Qt=Ct-Ot,un=Rt-Nt,wn=Ft+qt,Tn=$t+Gt,yn=at*(Ft-qt),Vt=at*($t-Gt),fn=Xt+wn,ln=Zt+Tn,Jt=Xt-wn,on=Zt-Tn,_n=Qt+Vt,cn=un-yn,tn=Qt-Vt,Wt=un+yn;_[dt]=fn,_[dt+1]=ln,_[pt]=_n,_[pt+1]=cn,_[mt]=Jt,_[mt+1]=on,_[vt]=tn,_[vt+1]=Wt}}};FFT.prototype._singleTransform2=function et(_,_e,tt){const nt=this._out,rt=this._data,it=rt[_e],st=rt[_e+1],ot=rt[_e+tt],at=rt[_e+tt+1],lt=it+ot,ct=st+at,ht=it-ot,ut=st-at;nt[_]=lt,nt[_+1]=ct,nt[_+2]=ht,nt[_+3]=ut};FFT.prototype._singleTransform4=function et(_,_e,tt){const nt=this._out,rt=this._data,it=this._inv?-1:1,st=tt*2,ot=tt*3,at=rt[_e],lt=rt[_e+1],ct=rt[_e+tt],ht=rt[_e+tt+1],ut=rt[_e+st],ft=rt[_e+st+1],dt=rt[_e+ot],pt=rt[_e+ot+1],mt=at+ut,vt=lt+ft,yt=at-ut,_t=lt-ft,St=ct+dt,bt=ht+pt,Et=it*(ct-dt),Mt=it*(ht-pt),Tt=mt+St,wt=vt+bt,Ct=yt+Mt,Rt=_t-Et,It=mt-St,Dt=vt-bt,Ft=yt-Mt,$t=_t+Et;nt[_]=Tt,nt[_+1]=wt,nt[_+2]=Ct,nt[_+3]=Rt,nt[_+4]=It,nt[_+5]=Dt,nt[_+6]=Ft,nt[_+7]=$t};FFT.prototype._realTransform4=function et(){var _=this._out,_e=this._csize,tt=this._width,nt=1<<tt,rt=_e/nt<<1,it,st,ot=this._bitrev;if(rt===4)for(it=0,st=0;it<_e;it+=rt,st++){const Fn=ot[st];this._singleRealTransform2(it,Fn>>>1,nt>>>1)}else for(it=0,st=0;it<_e;it+=rt,st++){const Fn=ot[st];this._singleRealTransform4(it,Fn>>>1,nt>>>1)}var at=this._inv?-1:1,lt=this.table;for(nt>>=2;nt>=2;nt>>=2){rt=_e/nt<<1;var ct=rt>>>1,ht=ct>>>1,ut=ht>>>1;for(it=0;it<_e;it+=rt)for(var ft=0,dt=0;ft<=ut;ft+=2,dt+=nt){var pt=it+ft,mt=pt+ht,vt=mt+ht,yt=vt+ht,_t=_[pt],St=_[pt+1],bt=_[mt],Et=_[mt+1],Mt=_[vt],Tt=_[vt+1],wt=_[yt],Ct=_[yt+1],Rt=_t,It=St,Dt=lt[dt],Ft=at*lt[dt+1],$t=bt*Dt-Et*Ft,Yt=bt*Ft+Et*Dt,Lt=lt[2*dt],Ot=at*lt[2*dt+1],Nt=Mt*Lt-Tt*Ot,zt=Mt*Ot+Tt*Lt,Ht=lt[3*dt],qt=at*lt[3*dt+1],Gt=wt*Ht-Ct*qt,Xt=wt*qt+Ct*Ht,Zt=Rt+Nt,Qt=It+zt,un=Rt-Nt,wn=It-zt,Tn=$t+Gt,yn=Yt+Xt,Vt=at*($t-Gt),fn=at*(Yt-Xt),ln=Zt+Tn,Jt=Qt+yn,on=un+fn,_n=wn-Vt;if(_[pt]=ln,_[pt+1]=Jt,_[mt]=on,_[mt+1]=_n,ft===0){var cn=Zt-Tn,tn=Qt-yn;_[vt]=cn,_[vt+1]=tn;continue}if(ft!==ut){var Wt=un,Bt=-wn,nn=Zt,en=-Qt,mn=-at*fn,sn=-at*Vt,xn=-at*yn,an=-at*Tn,pn=Wt+mn,Sn=Bt+sn,gn=nn+an,Rn=en-xn,Mn=it+ht-ft,kn=it+ct-ft;_[Mn]=pn,_[Mn+1]=Sn,_[kn]=gn,_[kn+1]=Rn}}}};FFT.prototype._singleRealTransform2=function et(_,_e,tt){const nt=this._out,rt=this._data,it=rt[_e],st=rt[_e+tt],ot=it+st,at=it-st;nt[_]=ot,nt[_+1]=0,nt[_+2]=at,nt[_+3]=0};FFT.prototype._singleRealTransform4=function et(_,_e,tt){const nt=this._out,rt=this._data,it=this._inv?-1:1,st=tt*2,ot=tt*3,at=rt[_e],lt=rt[_e+tt],ct=rt[_e+st],ht=rt[_e+ot],ut=at+ct,ft=at-ct,dt=lt+ht,pt=it*(lt-ht),mt=ut+dt,vt=ft,yt=-pt,_t=ut-dt,St=ft,bt=pt;nt[_]=mt,nt[_+1]=0,nt[_+2]=vt,nt[_+3]=yt,nt[_+4]=_t,nt[_+5]=0,nt[_+6]=St,nt[_+7]=bt};function convolutionSeparable(et,_,_e,tt){const nt=new Array(et.length);let rt,it,st,ot;ot=_[1],st=(ot.length-1)/2,it=new Array(_e+ot.length-1),rt=new Array(_e);for(let at=0;at<tt;at++){for(let lt=0;lt<_e;lt++)rt[lt]=et[at*_e+lt];directConvolution(rt,ot,it);for(let lt=0;lt<_e;lt++)nt[at*_e+lt]=it[st+lt]}ot=_[0],st=(ot.length-1)/2,it=new Array(tt+ot.length-1),rt=new Array(tt);for(let at=0;at<_e;at++){for(let lt=0;lt<tt;lt++)rt[lt]=nt[lt*_e+at];directConvolution(rt,ot,it);for(let lt=0;lt<tt;lt++)nt[lt*_e+at]=it[st+lt]}return nt}var matrix$2={};const toString$2=Object.prototype.toString;function isAnyArray$1(et){const _=toString$2.call(et);return _.endsWith("Array]")&&!_.includes("Big")}const libEsm=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:isAnyArray$1},Symbol.toStringTag,{value:"Module"})),require$$0$2=getAugmentedNamespace(libEsm);function max$1(et){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!isAnyArray$1(et))throw new TypeError("input must be an array");if(et.length===0)throw new TypeError("input must not be empty");var _e=_.fromIndex,tt=_e===void 0?0:_e,nt=_.toIndex,rt=nt===void 0?et.length:nt;if(tt<0||tt>=et.length||!Number.isInteger(tt))throw new Error("fromIndex must be a positive integer smaller than length");if(rt<=tt||rt>et.length||!Number.isInteger(rt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var it=et[tt],st=tt+1;st<rt;st++)et[st]>it&&(it=et[st]);return it}function min$1(et){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!isAnyArray$1(et))throw new TypeError("input must be an array");if(et.length===0)throw new TypeError("input must not be empty");var _e=_.fromIndex,tt=_e===void 0?0:_e,nt=_.toIndex,rt=nt===void 0?et.length:nt;if(tt<0||tt>=et.length||!Number.isInteger(tt))throw new Error("fromIndex must be a positive integer smaller than length");if(rt<=tt||rt>et.length||!Number.isInteger(rt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var it=et[tt],st=tt+1;st<rt;st++)et[st]<it&&(it=et[st]);return it}function rescale$1(et){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(isAnyArray$1(et)){if(et.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var _e;if(_.output!==void 0){if(!isAnyArray$1(_.output))throw new TypeError("output option must be an array if specified");_e=_.output}else _e=new Array(et.length);var tt=min$1(et),nt=max$1(et);if(tt===nt)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var rt=_.min,it=rt===void 0?_.autoMinMax?tt:0:rt,st=_.max,ot=st===void 0?_.autoMinMax?nt:1:st;if(it>=ot)throw new RangeError("min option must be smaller than max option");for(var at=(ot-it)/(nt-tt),lt=0;lt<et.length;lt++)_e[lt]=(et[lt]-tt)*at+it;return _e}const libEs6=Object.freeze(Object.defineProperty({__proto__:null,default:rescale$1},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(libEs6);Object.defineProperty(matrix$2,"__esModule",{value:!0});var isAnyArray=require$$0$2,rescale=require$$1;const indent=" ".repeat(2),indentData=" ".repeat(4);function inspectMatrix(){return inspectMatrixWithOptions(this)}function inspectMatrixWithOptions(et,_={}){const{maxRows:_e=15,maxColumns:tt=10,maxNumSize:nt=8,padMinus:rt="auto"}=_;return`${et.constructor.name} {
${indent}[
${indentData}${inspectData(et,_e,tt,nt,rt)}
${indent}]
${indent}rows: ${et.rows}
${indent}columns: ${et.columns}
}`}function inspectData(et,_,_e,tt,nt){const{rows:rt,columns:it}=et,st=Math.min(rt,_),ot=Math.min(it,_e),at=[];if(nt==="auto"){nt=!1;e:for(let lt=0;lt<st;lt++)for(let ct=0;ct<ot;ct++)if(et.get(lt,ct)<0){nt=!0;break e}}for(let lt=0;lt<st;lt++){let ct=[];for(let ht=0;ht<ot;ht++)ct.push(formatNumber(et.get(lt,ht),tt,nt));at.push(`${ct.join(" ")}`)}return ot!==it&&(at[at.length-1]+=` ... ${it-_e} more columns`),st!==rt&&at.push(`... ${rt-_} more rows`),at.join(`
${indentData}`)}function formatNumber(et,_,_e){return(et>=0&&_e?` ${formatNumber2(et,_-1)}`:formatNumber2(et,_)).padEnd(_)}function formatNumber2(et,_){let _e=et.toString();if(_e.length<=_)return _e;let tt=et.toFixed(_);if(tt.length>_&&(tt=et.toFixed(Math.max(0,_-(tt.length-_)))),tt.length<=_&&!tt.startsWith("0.000")&&!tt.startsWith("-0.000"))return tt;let nt=et.toExponential(_);return nt.length>_&&(nt=et.toExponential(Math.max(0,_-(nt.length-_)))),nt.slice(0)}function installMathOperations(et,_){et.prototype.add=function(tt){return typeof tt=="number"?this.addS(tt):this.addM(tt)},et.prototype.addS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)+tt);return this},et.prototype.addM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)+tt.get(nt,rt));return this},et.add=function(tt,nt){return new _(tt).add(nt)},et.prototype.sub=function(tt){return typeof tt=="number"?this.subS(tt):this.subM(tt)},et.prototype.subS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)-tt);return this},et.prototype.subM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)-tt.get(nt,rt));return this},et.sub=function(tt,nt){return new _(tt).sub(nt)},et.prototype.subtract=et.prototype.sub,et.prototype.subtractS=et.prototype.subS,et.prototype.subtractM=et.prototype.subM,et.subtract=et.sub,et.prototype.mul=function(tt){return typeof tt=="number"?this.mulS(tt):this.mulM(tt)},et.prototype.mulS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)*tt);return this},et.prototype.mulM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)*tt.get(nt,rt));return this},et.mul=function(tt,nt){return new _(tt).mul(nt)},et.prototype.multiply=et.prototype.mul,et.prototype.multiplyS=et.prototype.mulS,et.prototype.multiplyM=et.prototype.mulM,et.multiply=et.mul,et.prototype.div=function(tt){return typeof tt=="number"?this.divS(tt):this.divM(tt)},et.prototype.divS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)/tt);return this},et.prototype.divM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)/tt.get(nt,rt));return this},et.div=function(tt,nt){return new _(tt).div(nt)},et.prototype.divide=et.prototype.div,et.prototype.divideS=et.prototype.divS,et.prototype.divideM=et.prototype.divM,et.divide=et.div,et.prototype.mod=function(tt){return typeof tt=="number"?this.modS(tt):this.modM(tt)},et.prototype.modS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)%tt);return this},et.prototype.modM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)%tt.get(nt,rt));return this},et.mod=function(tt,nt){return new _(tt).mod(nt)},et.prototype.modulus=et.prototype.mod,et.prototype.modulusS=et.prototype.modS,et.prototype.modulusM=et.prototype.modM,et.modulus=et.mod,et.prototype.and=function(tt){return typeof tt=="number"?this.andS(tt):this.andM(tt)},et.prototype.andS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)&tt);return this},et.prototype.andM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)&tt.get(nt,rt));return this},et.and=function(tt,nt){return new _(tt).and(nt)},et.prototype.or=function(tt){return typeof tt=="number"?this.orS(tt):this.orM(tt)},et.prototype.orS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)|tt);return this},et.prototype.orM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)|tt.get(nt,rt));return this},et.or=function(tt,nt){return new _(tt).or(nt)},et.prototype.xor=function(tt){return typeof tt=="number"?this.xorS(tt):this.xorM(tt)},et.prototype.xorS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)^tt);return this},et.prototype.xorM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)^tt.get(nt,rt));return this},et.xor=function(tt,nt){return new _(tt).xor(nt)},et.prototype.leftShift=function(tt){return typeof tt=="number"?this.leftShiftS(tt):this.leftShiftM(tt)},et.prototype.leftShiftS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)<<tt);return this},et.prototype.leftShiftM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)<<tt.get(nt,rt));return this},et.leftShift=function(tt,nt){return new _(tt).leftShift(nt)},et.prototype.signPropagatingRightShift=function(tt){return typeof tt=="number"?this.signPropagatingRightShiftS(tt):this.signPropagatingRightShiftM(tt)},et.prototype.signPropagatingRightShiftS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)>>tt);return this},et.prototype.signPropagatingRightShiftM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)>>tt.get(nt,rt));return this},et.signPropagatingRightShift=function(tt,nt){return new _(tt).signPropagatingRightShift(nt)},et.prototype.rightShift=function(tt){return typeof tt=="number"?this.rightShiftS(tt):this.rightShiftM(tt)},et.prototype.rightShiftS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)>>>tt);return this},et.prototype.rightShiftM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)>>>tt.get(nt,rt));return this},et.rightShift=function(tt,nt){return new _(tt).rightShift(nt)},et.prototype.zeroFillRightShift=et.prototype.rightShift,et.prototype.zeroFillRightShiftS=et.prototype.rightShiftS,et.prototype.zeroFillRightShiftM=et.prototype.rightShiftM,et.zeroFillRightShift=et.rightShift,et.prototype.not=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,~this.get(tt,nt));return this},et.not=function(tt){return new _(tt).not()},et.prototype.abs=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.abs(this.get(tt,nt)));return this},et.abs=function(tt){return new _(tt).abs()},et.prototype.acos=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.acos(this.get(tt,nt)));return this},et.acos=function(tt){return new _(tt).acos()},et.prototype.acosh=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.acosh(this.get(tt,nt)));return this},et.acosh=function(tt){return new _(tt).acosh()},et.prototype.asin=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.asin(this.get(tt,nt)));return this},et.asin=function(tt){return new _(tt).asin()},et.prototype.asinh=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.asinh(this.get(tt,nt)));return this},et.asinh=function(tt){return new _(tt).asinh()},et.prototype.atan=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.atan(this.get(tt,nt)));return this},et.atan=function(tt){return new _(tt).atan()},et.prototype.atanh=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.atanh(this.get(tt,nt)));return this},et.atanh=function(tt){return new _(tt).atanh()},et.prototype.cbrt=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.cbrt(this.get(tt,nt)));return this},et.cbrt=function(tt){return new _(tt).cbrt()},et.prototype.ceil=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.ceil(this.get(tt,nt)));return this},et.ceil=function(tt){return new _(tt).ceil()},et.prototype.clz32=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.clz32(this.get(tt,nt)));return this},et.clz32=function(tt){return new _(tt).clz32()},et.prototype.cos=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.cos(this.get(tt,nt)));return this},et.cos=function(tt){return new _(tt).cos()},et.prototype.cosh=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.cosh(this.get(tt,nt)));return this},et.cosh=function(tt){return new _(tt).cosh()},et.prototype.exp=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.exp(this.get(tt,nt)));return this},et.exp=function(tt){return new _(tt).exp()},et.prototype.expm1=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.expm1(this.get(tt,nt)));return this},et.expm1=function(tt){return new _(tt).expm1()},et.prototype.floor=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.floor(this.get(tt,nt)));return this},et.floor=function(tt){return new _(tt).floor()},et.prototype.fround=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.fround(this.get(tt,nt)));return this},et.fround=function(tt){return new _(tt).fround()},et.prototype.log=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.log(this.get(tt,nt)));return this},et.log=function(tt){return new _(tt).log()},et.prototype.log1p=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.log1p(this.get(tt,nt)));return this},et.log1p=function(tt){return new _(tt).log1p()},et.prototype.log10=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.log10(this.get(tt,nt)));return this},et.log10=function(tt){return new _(tt).log10()},et.prototype.log2=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.log2(this.get(tt,nt)));return this},et.log2=function(tt){return new _(tt).log2()},et.prototype.round=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.round(this.get(tt,nt)));return this},et.round=function(tt){return new _(tt).round()},et.prototype.sign=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.sign(this.get(tt,nt)));return this},et.sign=function(tt){return new _(tt).sign()},et.prototype.sin=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.sin(this.get(tt,nt)));return this},et.sin=function(tt){return new _(tt).sin()},et.prototype.sinh=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.sinh(this.get(tt,nt)));return this},et.sinh=function(tt){return new _(tt).sinh()},et.prototype.sqrt=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.sqrt(this.get(tt,nt)));return this},et.sqrt=function(tt){return new _(tt).sqrt()},et.prototype.tan=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.tan(this.get(tt,nt)));return this},et.tan=function(tt){return new _(tt).tan()},et.prototype.tanh=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.tanh(this.get(tt,nt)));return this},et.tanh=function(tt){return new _(tt).tanh()},et.prototype.trunc=function(){for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.set(tt,nt,Math.trunc(this.get(tt,nt)));return this},et.trunc=function(tt){return new _(tt).trunc()},et.pow=function(tt,nt){return new _(tt).pow(nt)},et.prototype.pow=function(tt){return typeof tt=="number"?this.powS(tt):this.powM(tt)},et.prototype.powS=function(tt){for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)**tt);return this},et.prototype.powM=function(tt){if(tt=_.checkMatrix(tt),this.rows!==tt.rows||this.columns!==tt.columns)throw new RangeError("Matrices dimensions must be equal");for(let nt=0;nt<this.rows;nt++)for(let rt=0;rt<this.columns;rt++)this.set(nt,rt,this.get(nt,rt)**tt.get(nt,rt));return this}}function checkRowIndex(et,_,_e){let tt=_e?et.rows:et.rows-1;if(_<0||_>tt)throw new RangeError("Row index out of range")}function checkColumnIndex(et,_,_e){let tt=_e?et.columns:et.columns-1;if(_<0||_>tt)throw new RangeError("Column index out of range")}function checkRowVector(et,_){if(_.to1DArray&&(_=_.to1DArray()),_.length!==et.columns)throw new RangeError("vector size must be the same as the number of columns");return _}function checkColumnVector(et,_){if(_.to1DArray&&(_=_.to1DArray()),_.length!==et.rows)throw new RangeError("vector size must be the same as the number of rows");return _}function checkRowIndices(et,_){if(!isAnyArray.isAnyArray(_))throw new TypeError("row indices must be an array");for(let _e=0;_e<_.length;_e++)if(_[_e]<0||_[_e]>=et.rows)throw new RangeError("row indices are out of range")}function checkColumnIndices(et,_){if(!isAnyArray.isAnyArray(_))throw new TypeError("column indices must be an array");for(let _e=0;_e<_.length;_e++)if(_[_e]<0||_[_e]>=et.columns)throw new RangeError("column indices are out of range")}function checkRange(et,_,_e,tt,nt){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(checkNumber("startRow",_),checkNumber("endRow",_e),checkNumber("startColumn",tt),checkNumber("endColumn",nt),_>_e||tt>nt||_<0||_>=et.rows||_e<0||_e>=et.rows||tt<0||tt>=et.columns||nt<0||nt>=et.columns)throw new RangeError("Submatrix indices are out of range")}function newArray$2(et,_=0){let _e=[];for(let tt=0;tt<et;tt++)_e.push(_);return _e}function checkNumber(et,_){if(typeof _!="number")throw new TypeError(`${et} must be a number`)}function checkNonEmpty(et){if(et.isEmpty())throw new Error("Empty matrix has no elements to index")}function sumByRow(et){let _=newArray$2(et.rows);for(let _e=0;_e<et.rows;++_e)for(let tt=0;tt<et.columns;++tt)_[_e]+=et.get(_e,tt);return _}function sumByColumn(et){let _=newArray$2(et.columns);for(let _e=0;_e<et.rows;++_e)for(let tt=0;tt<et.columns;++tt)_[tt]+=et.get(_e,tt);return _}function sumAll(et){let _=0;for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)_+=et.get(_e,tt);return _}function productByRow(et){let _=newArray$2(et.rows,1);for(let _e=0;_e<et.rows;++_e)for(let tt=0;tt<et.columns;++tt)_[_e]*=et.get(_e,tt);return _}function productByColumn(et){let _=newArray$2(et.columns,1);for(let _e=0;_e<et.rows;++_e)for(let tt=0;tt<et.columns;++tt)_[tt]*=et.get(_e,tt);return _}function productAll(et){let _=1;for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)_*=et.get(_e,tt);return _}function varianceByRow(et,_,_e){const tt=et.rows,nt=et.columns,rt=[];for(let it=0;it<tt;it++){let st=0,ot=0,at=0;for(let lt=0;lt<nt;lt++)at=et.get(it,lt)-_e[it],st+=at,ot+=at*at;_?rt.push((ot-st*st/nt)/(nt-1)):rt.push((ot-st*st/nt)/nt)}return rt}function varianceByColumn(et,_,_e){const tt=et.rows,nt=et.columns,rt=[];for(let it=0;it<nt;it++){let st=0,ot=0,at=0;for(let lt=0;lt<tt;lt++)at=et.get(lt,it)-_e[it],st+=at,ot+=at*at;_?rt.push((ot-st*st/tt)/(tt-1)):rt.push((ot-st*st/tt)/tt)}return rt}function varianceAll(et,_,_e){const tt=et.rows,nt=et.columns,rt=tt*nt;let it=0,st=0,ot=0;for(let at=0;at<tt;at++)for(let lt=0;lt<nt;lt++)ot=et.get(at,lt)-_e,it+=ot,st+=ot*ot;return _?(st-it*it/rt)/(rt-1):(st-it*it/rt)/rt}function centerByRow(et,_){for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)et.set(_e,tt,et.get(_e,tt)-_[_e])}function centerByColumn(et,_){for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)et.set(_e,tt,et.get(_e,tt)-_[tt])}function centerAll(et,_){for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)et.set(_e,tt,et.get(_e,tt)-_)}function getScaleByRow(et){const _=[];for(let _e=0;_e<et.rows;_e++){let tt=0;for(let nt=0;nt<et.columns;nt++)tt+=et.get(_e,nt)**2/(et.columns-1);_.push(Math.sqrt(tt))}return _}function scaleByRow(et,_){for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)et.set(_e,tt,et.get(_e,tt)/_[_e])}function getScaleByColumn(et){const _=[];for(let _e=0;_e<et.columns;_e++){let tt=0;for(let nt=0;nt<et.rows;nt++)tt+=et.get(nt,_e)**2/(et.rows-1);_.push(Math.sqrt(tt))}return _}function scaleByColumn(et,_){for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)et.set(_e,tt,et.get(_e,tt)/_[tt])}function getScaleAll(et){const _=et.size-1;let _e=0;for(let tt=0;tt<et.columns;tt++)for(let nt=0;nt<et.rows;nt++)_e+=et.get(nt,tt)**2/_;return Math.sqrt(_e)}function scaleAll(et,_){for(let _e=0;_e<et.rows;_e++)for(let tt=0;tt<et.columns;tt++)et.set(_e,tt,et.get(_e,tt)/_)}let AbstractMatrix$1=class _i{static from1DArray(_,_e,tt){if(_*_e!==tt.length)throw new RangeError("data length does not match given dimensions");let rt=new Matrix$3(_,_e);for(let it=0;it<_;it++)for(let st=0;st<_e;st++)rt.set(it,st,tt[it*_e+st]);return rt}static rowVector(_){let _e=new Matrix$3(1,_.length);for(let tt=0;tt<_.length;tt++)_e.set(0,tt,_[tt]);return _e}static columnVector(_){let _e=new Matrix$3(_.length,1);for(let tt=0;tt<_.length;tt++)_e.set(tt,0,_[tt]);return _e}static zeros(_,_e){return new Matrix$3(_,_e)}static ones(_,_e){return new Matrix$3(_,_e).fill(1)}static rand(_,_e,tt={}){if(typeof tt!="object")throw new TypeError("options must be an object");const{random:nt=Math.random}=tt;let rt=new Matrix$3(_,_e);for(let it=0;it<_;it++)for(let st=0;st<_e;st++)rt.set(it,st,nt());return rt}static randInt(_,_e,tt={}){if(typeof tt!="object")throw new TypeError("options must be an object");const{min:nt=0,max:rt=1e3,random:it=Math.random}=tt;if(!Number.isInteger(nt))throw new TypeError("min must be an integer");if(!Number.isInteger(rt))throw new TypeError("max must be an integer");if(nt>=rt)throw new RangeError("min must be smaller than max");let st=rt-nt,ot=new Matrix$3(_,_e);for(let at=0;at<_;at++)for(let lt=0;lt<_e;lt++){let ct=nt+Math.round(it()*st);ot.set(at,lt,ct)}return ot}static eye(_,_e,tt){_e===void 0&&(_e=_),tt===void 0&&(tt=1);let nt=Math.min(_,_e),rt=this.zeros(_,_e);for(let it=0;it<nt;it++)rt.set(it,it,tt);return rt}static diag(_,_e,tt){let nt=_.length;_e===void 0&&(_e=nt),tt===void 0&&(tt=_e);let rt=Math.min(nt,_e,tt),it=this.zeros(_e,tt);for(let st=0;st<rt;st++)it.set(st,st,_[st]);return it}static min(_,_e){_=this.checkMatrix(_),_e=this.checkMatrix(_e);let tt=_.rows,nt=_.columns,rt=new Matrix$3(tt,nt);for(let it=0;it<tt;it++)for(let st=0;st<nt;st++)rt.set(it,st,Math.min(_.get(it,st),_e.get(it,st)));return rt}static max(_,_e){_=this.checkMatrix(_),_e=this.checkMatrix(_e);let tt=_.rows,nt=_.columns,rt=new this(tt,nt);for(let it=0;it<tt;it++)for(let st=0;st<nt;st++)rt.set(it,st,Math.max(_.get(it,st),_e.get(it,st)));return rt}static checkMatrix(_){return _i.isMatrix(_)?_:new Matrix$3(_)}static isMatrix(_){return _!=null&&_.klass==="Matrix"}get size(){return this.rows*this.columns}apply(_){if(typeof _!="function")throw new TypeError("callback must be a function");for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)_.call(this,_e,tt);return this}to1DArray(){let _=[];for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)_.push(this.get(_e,tt));return _}to2DArray(){let _=[];for(let _e=0;_e<this.rows;_e++){_.push([]);for(let tt=0;tt<this.columns;tt++)_[_e].push(this.get(_e,tt))}return _}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let _=0;_<this.rows;_++)for(let _e=0;_e<=_;_e++)if(this.get(_,_e)!==this.get(_e,_))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let _=0;_<this.rows;_++)if(this.get(_,_)!==0)return!1;return!0}isEchelonForm(){let _=0,_e=0,tt=-1,nt=!0,rt=!1;for(;_<this.rows&&nt;){for(_e=0,rt=!1;_e<this.columns&&rt===!1;)this.get(_,_e)===0?_e++:this.get(_,_e)===1&&_e>tt?(rt=!0,tt=_e):(nt=!1,rt=!0);_++}return nt}isReducedEchelonForm(){let _=0,_e=0,tt=-1,nt=!0,rt=!1;for(;_<this.rows&&nt;){for(_e=0,rt=!1;_e<this.columns&&rt===!1;)this.get(_,_e)===0?_e++:this.get(_,_e)===1&&_e>tt?(rt=!0,tt=_e):(nt=!1,rt=!0);for(let it=_e+1;it<this.rows;it++)this.get(_,it)!==0&&(nt=!1);_++}return nt}echelonForm(){let _=this.clone(),_e=0,tt=0;for(;_e<_.rows&&tt<_.columns;){let nt=_e;for(let rt=_e;rt<_.rows;rt++)_.get(rt,tt)>_.get(nt,tt)&&(nt=rt);if(_.get(nt,tt)===0)tt++;else{_.swapRows(_e,nt);let rt=_.get(_e,tt);for(let it=tt;it<_.columns;it++)_.set(_e,it,_.get(_e,it)/rt);for(let it=_e+1;it<_.rows;it++){let st=_.get(it,tt)/_.get(_e,tt);_.set(it,tt,0);for(let ot=tt+1;ot<_.columns;ot++)_.set(it,ot,_.get(it,ot)-_.get(_e,ot)*st)}_e++,tt++}}return _}reducedEchelonForm(){let _=this.echelonForm(),_e=_.columns,tt=_.rows,nt=tt-1;for(;nt>=0;)if(_.maxRow(nt)===0)nt--;else{let rt=0,it=!1;for(;rt<tt&&it===!1;)_.get(nt,rt)===1?it=!0:rt++;for(let st=0;st<nt;st++){let ot=_.get(st,rt);for(let at=rt;at<_e;at++){let lt=_.get(st,at)-ot*_.get(nt,at);_.set(st,at,lt)}}nt--}return _}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(_={}){if(typeof _!="object")throw new TypeError("options must be an object");const{rows:_e=1,columns:tt=1}=_;if(!Number.isInteger(_e)||_e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(tt)||tt<=0)throw new TypeError("columns must be a positive integer");let nt=new Matrix$3(this.rows*_e,this.columns*tt);for(let rt=0;rt<_e;rt++)for(let it=0;it<tt;it++)nt.setSubMatrix(this,this.rows*rt,this.columns*it);return nt}fill(_){for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,_);return this}neg(){return this.mulS(-1)}getRow(_){checkRowIndex(this,_);let _e=[];for(let tt=0;tt<this.columns;tt++)_e.push(this.get(_,tt));return _e}getRowVector(_){return Matrix$3.rowVector(this.getRow(_))}setRow(_,_e){checkRowIndex(this,_),_e=checkRowVector(this,_e);for(let tt=0;tt<this.columns;tt++)this.set(_,tt,_e[tt]);return this}swapRows(_,_e){checkRowIndex(this,_),checkRowIndex(this,_e);for(let tt=0;tt<this.columns;tt++){let nt=this.get(_,tt);this.set(_,tt,this.get(_e,tt)),this.set(_e,tt,nt)}return this}getColumn(_){checkColumnIndex(this,_);let _e=[];for(let tt=0;tt<this.rows;tt++)_e.push(this.get(tt,_));return _e}getColumnVector(_){return Matrix$3.columnVector(this.getColumn(_))}setColumn(_,_e){checkColumnIndex(this,_),_e=checkColumnVector(this,_e);for(let tt=0;tt<this.rows;tt++)this.set(tt,_,_e[tt]);return this}swapColumns(_,_e){checkColumnIndex(this,_),checkColumnIndex(this,_e);for(let tt=0;tt<this.rows;tt++){let nt=this.get(tt,_);this.set(tt,_,this.get(tt,_e)),this.set(tt,_e,nt)}return this}addRowVector(_){_=checkRowVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)+_[tt]);return this}subRowVector(_){_=checkRowVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)-_[tt]);return this}mulRowVector(_){_=checkRowVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)*_[tt]);return this}divRowVector(_){_=checkRowVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)/_[tt]);return this}addColumnVector(_){_=checkColumnVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)+_[_e]);return this}subColumnVector(_){_=checkColumnVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)-_[_e]);return this}mulColumnVector(_){_=checkColumnVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)*_[_e]);return this}divColumnVector(_){_=checkColumnVector(this,_);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)this.set(_e,tt,this.get(_e,tt)/_[_e]);return this}mulRow(_,_e){checkRowIndex(this,_);for(let tt=0;tt<this.columns;tt++)this.set(_,tt,this.get(_,tt)*_e);return this}mulColumn(_,_e){checkColumnIndex(this,_);for(let tt=0;tt<this.rows;tt++)this.set(tt,_,this.get(tt,_)*_e);return this}max(_){if(this.isEmpty())return NaN;switch(_){case"row":{const _e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)>_e[tt]&&(_e[tt]=this.get(tt,nt));return _e}case"column":{const _e=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)>_e[nt]&&(_e[nt]=this.get(tt,nt));return _e}case void 0:{let _e=this.get(0,0);for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)>_e&&(_e=this.get(tt,nt));return _e}default:throw new Error(`invalid option: ${_}`)}}maxIndex(){checkNonEmpty(this);let _=this.get(0,0),_e=[0,0];for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)>_&&(_=this.get(tt,nt),_e[0]=tt,_e[1]=nt);return _e}min(_){if(this.isEmpty())return NaN;switch(_){case"row":{const _e=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)<_e[tt]&&(_e[tt]=this.get(tt,nt));return _e}case"column":{const _e=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)<_e[nt]&&(_e[nt]=this.get(tt,nt));return _e}case void 0:{let _e=this.get(0,0);for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)<_e&&(_e=this.get(tt,nt));return _e}default:throw new Error(`invalid option: ${_}`)}}minIndex(){checkNonEmpty(this);let _=this.get(0,0),_e=[0,0];for(let tt=0;tt<this.rows;tt++)for(let nt=0;nt<this.columns;nt++)this.get(tt,nt)<_&&(_=this.get(tt,nt),_e[0]=tt,_e[1]=nt);return _e}maxRow(_){if(checkRowIndex(this,_),this.isEmpty())return NaN;let _e=this.get(_,0);for(let tt=1;tt<this.columns;tt++)this.get(_,tt)>_e&&(_e=this.get(_,tt));return _e}maxRowIndex(_){checkRowIndex(this,_),checkNonEmpty(this);let _e=this.get(_,0),tt=[_,0];for(let nt=1;nt<this.columns;nt++)this.get(_,nt)>_e&&(_e=this.get(_,nt),tt[1]=nt);return tt}minRow(_){if(checkRowIndex(this,_),this.isEmpty())return NaN;let _e=this.get(_,0);for(let tt=1;tt<this.columns;tt++)this.get(_,tt)<_e&&(_e=this.get(_,tt));return _e}minRowIndex(_){checkRowIndex(this,_),checkNonEmpty(this);let _e=this.get(_,0),tt=[_,0];for(let nt=1;nt<this.columns;nt++)this.get(_,nt)<_e&&(_e=this.get(_,nt),tt[1]=nt);return tt}maxColumn(_){if(checkColumnIndex(this,_),this.isEmpty())return NaN;let _e=this.get(0,_);for(let tt=1;tt<this.rows;tt++)this.get(tt,_)>_e&&(_e=this.get(tt,_));return _e}maxColumnIndex(_){checkColumnIndex(this,_),checkNonEmpty(this);let _e=this.get(0,_),tt=[0,_];for(let nt=1;nt<this.rows;nt++)this.get(nt,_)>_e&&(_e=this.get(nt,_),tt[0]=nt);return tt}minColumn(_){if(checkColumnIndex(this,_),this.isEmpty())return NaN;let _e=this.get(0,_);for(let tt=1;tt<this.rows;tt++)this.get(tt,_)<_e&&(_e=this.get(tt,_));return _e}minColumnIndex(_){checkColumnIndex(this,_),checkNonEmpty(this);let _e=this.get(0,_),tt=[0,_];for(let nt=1;nt<this.rows;nt++)this.get(nt,_)<_e&&(_e=this.get(nt,_),tt[0]=nt);return tt}diag(){let _=Math.min(this.rows,this.columns),_e=[];for(let tt=0;tt<_;tt++)_e.push(this.get(tt,tt));return _e}norm(_="frobenius"){switch(_){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${_}`)}}cumulativeSum(){let _=0;for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)_+=this.get(_e,tt),this.set(_e,tt,_);return this}dot(_){_i.isMatrix(_)&&(_=_.to1DArray());let _e=this.to1DArray();if(_e.length!==_.length)throw new RangeError("vectors do not have the same size");let tt=0;for(let nt=0;nt<_e.length;nt++)tt+=_e[nt]*_[nt];return tt}mmul(_){_=Matrix$3.checkMatrix(_);let _e=this.rows,tt=this.columns,nt=_.columns,rt=new Matrix$3(_e,nt),it=new Float64Array(tt);for(let st=0;st<nt;st++){for(let ot=0;ot<tt;ot++)it[ot]=_.get(ot,st);for(let ot=0;ot<_e;ot++){let at=0;for(let lt=0;lt<tt;lt++)at+=this.get(ot,lt)*it[lt];rt.set(ot,st,at)}}return rt}strassen2x2(_){_=Matrix$3.checkMatrix(_);let _e=new Matrix$3(2,2);const tt=this.get(0,0),nt=_.get(0,0),rt=this.get(0,1),it=_.get(0,1),st=this.get(1,0),ot=_.get(1,0),at=this.get(1,1),lt=_.get(1,1),ct=(tt+at)*(nt+lt),ht=(st+at)*nt,ut=tt*(it-lt),ft=at*(ot-nt),dt=(tt+rt)*lt,pt=(st-tt)*(nt+it),mt=(rt-at)*(ot+lt),vt=ct+ft-dt+mt,yt=ut+dt,_t=ht+ft,St=ct-ht+ut+pt;return _e.set(0,0,vt),_e.set(0,1,yt),_e.set(1,0,_t),_e.set(1,1,St),_e}strassen3x3(_){_=Matrix$3.checkMatrix(_);let _e=new Matrix$3(3,3);const tt=this.get(0,0),nt=this.get(0,1),rt=this.get(0,2),it=this.get(1,0),st=this.get(1,1),ot=this.get(1,2),at=this.get(2,0),lt=this.get(2,1),ct=this.get(2,2),ht=_.get(0,0),ut=_.get(0,1),ft=_.get(0,2),dt=_.get(1,0),pt=_.get(1,1),mt=_.get(1,2),vt=_.get(2,0),yt=_.get(2,1),_t=_.get(2,2),St=(tt+nt+rt-it-st-lt-ct)*pt,bt=(tt-it)*(-ut+pt),Et=st*(-ht+ut+dt-pt-mt-vt+_t),Mt=(-tt+it+st)*(ht-ut+pt),Tt=(it+st)*(-ht+ut),wt=tt*ht,Ct=(-tt+at+lt)*(ht-ft+mt),Rt=(-tt+at)*(ft-mt),It=(at+lt)*(-ht+ft),Dt=(tt+nt+rt-st-ot-at-lt)*mt,Ft=lt*(-ht+ft+dt-pt-mt-vt+yt),$t=(-rt+lt+ct)*(pt+vt-yt),Yt=(rt-ct)*(pt-yt),Lt=rt*vt,Ot=(lt+ct)*(-vt+yt),Nt=(-rt+st+ot)*(mt+vt-_t),zt=(rt-ot)*(mt-_t),Ht=(st+ot)*(-vt+_t),qt=nt*dt,Gt=ot*yt,Xt=it*ft,Zt=at*ut,Qt=ct*_t,un=wt+Lt+qt,wn=St+Mt+Tt+wt+$t+Lt+Ot,Tn=wt+Ct+It+Dt+Lt+Nt+Ht,yn=bt+Et+Mt+wt+Lt+Nt+zt,Vt=bt+Mt+Tt+wt+Gt,fn=Lt+Nt+zt+Ht+Xt,ln=wt+Ct+Rt+Ft+$t+Yt+Lt,Jt=$t+Yt+Lt+Ot+Zt,on=wt+Ct+Rt+It+Qt;return _e.set(0,0,un),_e.set(0,1,wn),_e.set(0,2,Tn),_e.set(1,0,yn),_e.set(1,1,Vt),_e.set(1,2,fn),_e.set(2,0,ln),_e.set(2,1,Jt),_e.set(2,2,on),_e}mmulStrassen(_){_=Matrix$3.checkMatrix(_);let _e=this.clone(),tt=_e.rows,nt=_e.columns,rt=_.rows,it=_.columns;nt!==rt&&console.warn(`Multiplying ${tt} x ${nt} and ${rt} x ${it} matrix: dimensions do not match.`);function st(ct,ht,ut){let ft=ct.rows,dt=ct.columns;if(ft===ht&&dt===ut)return ct;{let pt=_i.zeros(ht,ut);return pt=pt.setSubMatrix(ct,0,0),pt}}let ot=Math.max(tt,rt),at=Math.max(nt,it);_e=st(_e,ot,at),_=st(_,ot,at);function lt(ct,ht,ut,ft){if(ut<=512||ft<=512)return ct.mmul(ht);ut%2===1&&ft%2===1?(ct=st(ct,ut+1,ft+1),ht=st(ht,ut+1,ft+1)):ut%2===1?(ct=st(ct,ut+1,ft),ht=st(ht,ut+1,ft)):ft%2===1&&(ct=st(ct,ut,ft+1),ht=st(ht,ut,ft+1));let dt=parseInt(ct.rows/2,10),pt=parseInt(ct.columns/2,10),mt=ct.subMatrix(0,dt-1,0,pt-1),vt=ht.subMatrix(0,dt-1,0,pt-1),yt=ct.subMatrix(0,dt-1,pt,ct.columns-1),_t=ht.subMatrix(0,dt-1,pt,ht.columns-1),St=ct.subMatrix(dt,ct.rows-1,0,pt-1),bt=ht.subMatrix(dt,ht.rows-1,0,pt-1),Et=ct.subMatrix(dt,ct.rows-1,pt,ct.columns-1),Mt=ht.subMatrix(dt,ht.rows-1,pt,ht.columns-1),Tt=lt(_i.add(mt,Et),_i.add(vt,Mt),dt,pt),wt=lt(_i.add(St,Et),vt,dt,pt),Ct=lt(mt,_i.sub(_t,Mt),dt,pt),Rt=lt(Et,_i.sub(bt,vt),dt,pt),It=lt(_i.add(mt,yt),Mt,dt,pt),Dt=lt(_i.sub(St,mt),_i.add(vt,_t),dt,pt),Ft=lt(_i.sub(yt,Et),_i.add(bt,Mt),dt,pt),$t=_i.add(Tt,Rt);$t.sub(It),$t.add(Ft);let Yt=_i.add(Ct,It),Lt=_i.add(wt,Rt),Ot=_i.sub(Tt,wt);Ot.add(Ct),Ot.add(Dt);let Nt=_i.zeros(2*$t.rows,2*$t.columns);return Nt=Nt.setSubMatrix($t,0,0),Nt=Nt.setSubMatrix(Yt,$t.rows,0),Nt=Nt.setSubMatrix(Lt,0,$t.columns),Nt=Nt.setSubMatrix(Ot,$t.rows,$t.columns),Nt.subMatrix(0,ut-1,0,ft-1)}return lt(_e,_,ot,at)}scaleRows(_={}){if(typeof _!="object")throw new TypeError("options must be an object");const{min:_e=0,max:tt=1}=_;if(!Number.isFinite(_e))throw new TypeError("min must be a number");if(!Number.isFinite(tt))throw new TypeError("max must be a number");if(_e>=tt)throw new RangeError("min must be smaller than max");let nt=new Matrix$3(this.rows,this.columns);for(let rt=0;rt<this.rows;rt++){const it=this.getRow(rt);it.length>0&&rescale(it,{min:_e,max:tt,output:it}),nt.setRow(rt,it)}return nt}scaleColumns(_={}){if(typeof _!="object")throw new TypeError("options must be an object");const{min:_e=0,max:tt=1}=_;if(!Number.isFinite(_e))throw new TypeError("min must be a number");if(!Number.isFinite(tt))throw new TypeError("max must be a number");if(_e>=tt)throw new RangeError("min must be smaller than max");let nt=new Matrix$3(this.rows,this.columns);for(let rt=0;rt<this.columns;rt++){const it=this.getColumn(rt);it.length&&rescale(it,{min:_e,max:tt,output:it}),nt.setColumn(rt,it)}return nt}flipRows(){const _=Math.ceil(this.columns/2);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<_;tt++){let nt=this.get(_e,tt),rt=this.get(_e,this.columns-1-tt);this.set(_e,tt,rt),this.set(_e,this.columns-1-tt,nt)}return this}flipColumns(){const _=Math.ceil(this.rows/2);for(let _e=0;_e<this.columns;_e++)for(let tt=0;tt<_;tt++){let nt=this.get(tt,_e),rt=this.get(this.rows-1-tt,_e);this.set(tt,_e,rt),this.set(this.rows-1-tt,_e,nt)}return this}kroneckerProduct(_){_=Matrix$3.checkMatrix(_);let _e=this.rows,tt=this.columns,nt=_.rows,rt=_.columns,it=new Matrix$3(_e*nt,tt*rt);for(let st=0;st<_e;st++)for(let ot=0;ot<tt;ot++)for(let at=0;at<nt;at++)for(let lt=0;lt<rt;lt++)it.set(nt*st+at,rt*ot+lt,this.get(st,ot)*_.get(at,lt));return it}kroneckerSum(_){if(_=Matrix$3.checkMatrix(_),!this.isSquare()||!_.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let _e=this.rows,tt=_.rows,nt=this.kroneckerProduct(Matrix$3.eye(tt,tt)),rt=Matrix$3.eye(_e,_e).kroneckerProduct(_);return nt.add(rt)}transpose(){let _=new Matrix$3(this.columns,this.rows);for(let _e=0;_e<this.rows;_e++)for(let tt=0;tt<this.columns;tt++)_.set(tt,_e,this.get(_e,tt));return _}sortRows(_=compareNumbers){for(let _e=0;_e<this.rows;_e++)this.setRow(_e,this.getRow(_e).sort(_));return this}sortColumns(_=compareNumbers){for(let _e=0;_e<this.columns;_e++)this.setColumn(_e,this.getColumn(_e).sort(_));return this}subMatrix(_,_e,tt,nt){checkRange(this,_,_e,tt,nt);let rt=new Matrix$3(_e-_+1,nt-tt+1);for(let it=_;it<=_e;it++)for(let st=tt;st<=nt;st++)rt.set(it-_,st-tt,this.get(it,st));return rt}subMatrixRow(_,_e,tt){if(_e===void 0&&(_e=0),tt===void 0&&(tt=this.columns-1),_e>tt||_e<0||_e>=this.columns||tt<0||tt>=this.columns)throw new RangeError("Argument out of range");let nt=new Matrix$3(_.length,tt-_e+1);for(let rt=0;rt<_.length;rt++)for(let it=_e;it<=tt;it++){if(_[rt]<0||_[rt]>=this.rows)throw new RangeError(`Row index out of range: ${_[rt]}`);nt.set(rt,it-_e,this.get(_[rt],it))}return nt}subMatrixColumn(_,_e,tt){if(_e===void 0&&(_e=0),tt===void 0&&(tt=this.rows-1),_e>tt||_e<0||_e>=this.rows||tt<0||tt>=this.rows)throw new RangeError("Argument out of range");let nt=new Matrix$3(tt-_e+1,_.length);for(let rt=0;rt<_.length;rt++)for(let it=_e;it<=tt;it++){if(_[rt]<0||_[rt]>=this.columns)throw new RangeError(`Column index out of range: ${_[rt]}`);nt.set(it-_e,rt,this.get(it,_[rt]))}return nt}setSubMatrix(_,_e,tt){if(_=Matrix$3.checkMatrix(_),_.isEmpty())return this;let nt=_e+_.rows-1,rt=tt+_.columns-1;checkRange(this,_e,nt,tt,rt);for(let it=0;it<_.rows;it++)for(let st=0;st<_.columns;st++)this.set(_e+it,tt+st,_.get(it,st));return this}selection(_,_e){checkRowIndices(this,_),checkColumnIndices(this,_e);let tt=new Matrix$3(_.length,_e.length);for(let nt=0;nt<_.length;nt++){let rt=_[nt];for(let it=0;it<_e.length;it++){let st=_e[it];tt.set(nt,it,this.get(rt,st))}}return tt}trace(){let _=Math.min(this.rows,this.columns),_e=0;for(let tt=0;tt<_;tt++)_e+=this.get(tt,tt);return _e}clone(){return this.constructor.copy(this,new Matrix$3(this.rows,this.columns))}static copy(_,_e){for(const[tt,nt,rt]of _.entries())_e.set(tt,nt,rt);return _e}sum(_){switch(_){case"row":return sumByRow(this);case"column":return sumByColumn(this);case void 0:return sumAll(this);default:throw new Error(`invalid option: ${_}`)}}product(_){switch(_){case"row":return productByRow(this);case"column":return productByColumn(this);case void 0:return productAll(this);default:throw new Error(`invalid option: ${_}`)}}mean(_){const _e=this.sum(_);switch(_){case"row":{for(let tt=0;tt<this.rows;tt++)_e[tt]/=this.columns;return _e}case"column":{for(let tt=0;tt<this.columns;tt++)_e[tt]/=this.rows;return _e}case void 0:return _e/this.size;default:throw new Error(`invalid option: ${_}`)}}variance(_,_e={}){if(typeof _=="object"&&(_e=_,_=void 0),typeof _e!="object")throw new TypeError("options must be an object");const{unbiased:tt=!0,mean:nt=this.mean(_)}=_e;if(typeof tt!="boolean")throw new TypeError("unbiased must be a boolean");switch(_){case"row":{if(!isAnyArray.isAnyArray(nt))throw new TypeError("mean must be an array");return varianceByRow(this,tt,nt)}case"column":{if(!isAnyArray.isAnyArray(nt))throw new TypeError("mean must be an array");return varianceByColumn(this,tt,nt)}case void 0:{if(typeof nt!="number")throw new TypeError("mean must be a number");return varianceAll(this,tt,nt)}default:throw new Error(`invalid option: ${_}`)}}standardDeviation(_,_e){typeof _=="object"&&(_e=_,_=void 0);const tt=this.variance(_,_e);if(_===void 0)return Math.sqrt(tt);for(let nt=0;nt<tt.length;nt++)tt[nt]=Math.sqrt(tt[nt]);return tt}center(_,_e={}){if(typeof _=="object"&&(_e=_,_=void 0),typeof _e!="object")throw new TypeError("options must be an object");const{center:tt=this.mean(_)}=_e;switch(_){case"row":{if(!isAnyArray.isAnyArray(tt))throw new TypeError("center must be an array");return centerByRow(this,tt),this}case"column":{if(!isAnyArray.isAnyArray(tt))throw new TypeError("center must be an array");return centerByColumn(this,tt),this}case void 0:{if(typeof tt!="number")throw new TypeError("center must be a number");return centerAll(this,tt),this}default:throw new Error(`invalid option: ${_}`)}}scale(_,_e={}){if(typeof _=="object"&&(_e=_,_=void 0),typeof _e!="object")throw new TypeError("options must be an object");let tt=_e.scale;switch(_){case"row":{if(tt===void 0)tt=getScaleByRow(this);else if(!isAnyArray.isAnyArray(tt))throw new TypeError("scale must be an array");return scaleByRow(this,tt),this}case"column":{if(tt===void 0)tt=getScaleByColumn(this);else if(!isAnyArray.isAnyArray(tt))throw new TypeError("scale must be an array");return scaleByColumn(this,tt),this}case void 0:{if(tt===void 0)tt=getScaleAll(this);else if(typeof tt!="number")throw new TypeError("scale must be a number");return scaleAll(this,tt),this}default:throw new Error(`invalid option: ${_}`)}}toString(_){return inspectMatrixWithOptions(this,_)}[Symbol.iterator](){return this.entries()}*entries(){for(let _=0;_<this.rows;_++)for(let _e=0;_e<this.columns;_e++)yield[_,_e,this.get(_,_e)]}*values(){for(let _=0;_<this.rows;_++)for(let _e=0;_e<this.columns;_e++)yield this.get(_,_e)}};AbstractMatrix$1.prototype.klass="Matrix";typeof Symbol<"u"&&(AbstractMatrix$1.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspectMatrix);function compareNumbers(et,_){return et-_}function isArrayOfNumbers(et){return et.every(_=>typeof _=="number")}AbstractMatrix$1.random=AbstractMatrix$1.rand;AbstractMatrix$1.randomInt=AbstractMatrix$1.randInt;AbstractMatrix$1.diagonal=AbstractMatrix$1.diag;AbstractMatrix$1.prototype.diagonal=AbstractMatrix$1.prototype.diag;AbstractMatrix$1.identity=AbstractMatrix$1.eye;AbstractMatrix$1.prototype.negate=AbstractMatrix$1.prototype.neg;AbstractMatrix$1.prototype.tensorProduct=AbstractMatrix$1.prototype.kroneckerProduct;var $l,Bp,No;let Matrix$3=(No=class extends AbstractMatrix$1{constructor(_e,tt){super();Rp(this,$l);Jn(this,"data");if(No.isMatrix(_e))Pp(this,$l,Bp).call(this,_e.rows,_e.columns),No.copy(_e,this);else if(Number.isInteger(_e)&&_e>=0)Pp(this,$l,Bp).call(this,_e,tt);else if(isAnyArray.isAnyArray(_e)){const nt=_e;if(_e=nt.length,tt=_e?nt[0].length:0,typeof tt!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let rt=0;rt<_e;rt++){if(nt[rt].length!==tt)throw new RangeError("Inconsistent array dimensions");if(!isArrayOfNumbers(nt[rt]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(nt[rt]))}this.rows=_e,this.columns=tt}else throw new TypeError("First argument must be a positive number or an array")}set(_e,tt,nt){return this.data[_e][tt]=nt,this}get(_e,tt){return this.data[_e][tt]}removeRow(_e){return checkRowIndex(this,_e),this.data.splice(_e,1),this.rows-=1,this}addRow(_e,tt){return tt===void 0&&(tt=_e,_e=this.rows),checkRowIndex(this,_e,!0),tt=Float64Array.from(checkRowVector(this,tt)),this.data.splice(_e,0,tt),this.rows+=1,this}removeColumn(_e){checkColumnIndex(this,_e);for(let tt=0;tt<this.rows;tt++){const nt=new Float64Array(this.columns-1);for(let rt=0;rt<_e;rt++)nt[rt]=this.data[tt][rt];for(let rt=_e+1;rt<this.columns;rt++)nt[rt-1]=this.data[tt][rt];this.data[tt]=nt}return this.columns-=1,this}addColumn(_e,tt){typeof tt>"u"&&(tt=_e,_e=this.columns),checkColumnIndex(this,_e,!0),tt=checkColumnVector(this,tt);for(let nt=0;nt<this.rows;nt++){const rt=new Float64Array(this.columns+1);let it=0;for(;it<_e;it++)rt[it]=this.data[nt][it];for(rt[it++]=tt[nt];it<this.columns+1;it++)rt[it]=this.data[nt][it-1];this.data[nt]=rt}return this.columns+=1,this}},$l=new WeakSet,Bp=function(_e,tt){if(this.data=[],Number.isInteger(tt)&&tt>=0)for(let nt=0;nt<_e;nt++)this.data.push(new Float64Array(tt));else throw new TypeError("nColumns must be a positive integer");this.rows=_e,this.columns=tt},No);installMathOperations(AbstractMatrix$1,Matrix$3);var ds,Oo;let SymmetricMatrix$1=(Oo=class extends AbstractMatrix$1{constructor(_e){super();Rp(this,ds);if(Matrix$3.isMatrix(_e)){if(!_e.isSymmetric())throw new TypeError("not symmetric data");Lu(this,ds,Matrix$3.copy(_e,new Matrix$3(_e.rows,_e.rows)))}else if(Number.isInteger(_e)&&_e>=0)Lu(this,ds,new Matrix$3(_e,_e));else if(Lu(this,ds,new Matrix$3(_e)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Hs(this,ds).size}get rows(){return Hs(this,ds).rows}get columns(){return Hs(this,ds).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(_e){return Matrix$3.isMatrix(_e)&&_e.klassType==="SymmetricMatrix"}static zeros(_e){return new this(_e)}static ones(_e){return new this(_e).fill(1)}clone(){const _e=new Oo(this.diagonalSize);for(const[tt,nt,rt]of this.upperRightEntries())_e.set(tt,nt,rt);return _e}toMatrix(){return new Matrix$3(this)}get(_e,tt){return Hs(this,ds).get(_e,tt)}set(_e,tt,nt){return Hs(this,ds).set(_e,tt,nt),Hs(this,ds).set(tt,_e,nt),this}removeCross(_e){return Hs(this,ds).removeRow(_e),Hs(this,ds).removeColumn(_e),this}addCross(_e,tt){tt===void 0&&(tt=_e,_e=this.diagonalSize);const nt=tt.slice();return nt.splice(_e,1),Hs(this,ds).addRow(_e,nt),Hs(this,ds).addColumn(_e,tt),this}applyMask(_e){if(_e.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const tt=[];for(const[nt,rt]of _e.entries())rt||tt.push(nt);tt.reverse();for(const nt of tt)this.removeCross(nt);return this}toCompact(){const{diagonalSize:_e}=this,tt=new Array(_e*(_e+1)/2);for(let nt=0,rt=0,it=0;it<tt.length;it++)tt[it]=this.get(rt,nt),++nt>=_e&&(nt=++rt);return tt}static fromCompact(_e){const tt=_e.length,nt=(Math.sqrt(8*tt+1)-1)/2;if(!Number.isInteger(nt))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(_e)}`);const rt=new Oo(nt);for(let it=0,st=0,ot=0;ot<tt;ot++)rt.set(it,st,_e[ot]),++it>=nt&&(it=++st);return rt}*upperRightEntries(){for(let _e=0,tt=0;_e<this.diagonalSize;void 0){const nt=this.get(_e,tt);yield[_e,tt,nt],++tt>=this.diagonalSize&&(tt=++_e)}}*upperRightValues(){for(let _e=0,tt=0;_e<this.diagonalSize;void 0)yield this.get(_e,tt),++tt>=this.diagonalSize&&(tt=++_e)}},ds=new WeakMap,Oo);SymmetricMatrix$1.prototype.klassType="SymmetricMatrix";let DistanceMatrix$1=class g0 extends SymmetricMatrix$1{static isDistanceMatrix(_){return SymmetricMatrix$1.isSymmetricMatrix(_)&&_.klassSubType==="DistanceMatrix"}constructor(_){if(super(_),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(_,_e,tt){return _===_e&&(tt=0),super.set(_,_e,tt)}addCross(_,_e){return _e===void 0&&(_e=_,_=this.diagonalSize),_e=_e.slice(),_e[_]=0,super.addCross(_,_e)}toSymmetricMatrix(){return new SymmetricMatrix$1(this)}clone(){const _=new g0(this.diagonalSize);for(const[_e,tt,nt]of this.upperRightEntries())_e!==tt&&_.set(_e,tt,nt);return _}toCompact(){const{diagonalSize:_}=this,_e=(_-1)*_/2,tt=new Array(_e);for(let nt=1,rt=0,it=0;it<tt.length;it++)tt[it]=this.get(rt,nt),++nt>=_&&(nt=++rt+1);return tt}static fromCompact(_){const _e=_.length;if(_e===0)return new this(0);const tt=(Math.sqrt(8*_e+1)+1)/2;if(!Number.isInteger(tt))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(_)}`);const nt=new this(tt);for(let rt=1,it=0,st=0;st<_e;st++)nt.set(rt,it,_[st]),++rt>=tt&&(rt=++it+1);return nt}};DistanceMatrix$1.prototype.klassSubType="DistanceMatrix";class BaseView extends AbstractMatrix$1{constructor(_,_e,tt){super(),this.matrix=_,this.rows=_e,this.columns=tt}}let MatrixColumnView$1=class extends BaseView{constructor(_,_e){checkColumnIndex(_,_e),super(_,_.rows,1),this.column=_e}set(_,_e,tt){return this.matrix.set(_,this.column,tt),this}get(_){return this.matrix.get(_,this.column)}},MatrixColumnSelectionView$1=class extends BaseView{constructor(_,_e){checkColumnIndices(_,_e),super(_,_.rows,_e.length),this.columnIndices=_e}set(_,_e,tt){return this.matrix.set(_,this.columnIndices[_e],tt),this}get(_,_e){return this.matrix.get(_,this.columnIndices[_e])}},MatrixFlipColumnView$1=class extends BaseView{constructor(_){super(_,_.rows,_.columns)}set(_,_e,tt){return this.matrix.set(_,this.columns-_e-1,tt),this}get(_,_e){return this.matrix.get(_,this.columns-_e-1)}},MatrixFlipRowView$1=class extends BaseView{constructor(_){super(_,_.rows,_.columns)}set(_,_e,tt){return this.matrix.set(this.rows-_-1,_e,tt),this}get(_,_e){return this.matrix.get(this.rows-_-1,_e)}},MatrixRowView$1=class extends BaseView{constructor(_,_e){checkRowIndex(_,_e),super(_,1,_.columns),this.row=_e}set(_,_e,tt){return this.matrix.set(this.row,_e,tt),this}get(_,_e){return this.matrix.get(this.row,_e)}},MatrixRowSelectionView$1=class extends BaseView{constructor(_,_e){checkRowIndices(_,_e),super(_,_e.length,_.columns),this.rowIndices=_e}set(_,_e,tt){return this.matrix.set(this.rowIndices[_],_e,tt),this}get(_,_e){return this.matrix.get(this.rowIndices[_],_e)}},MatrixSelectionView$1=class extends BaseView{constructor(_,_e,tt){checkRowIndices(_,_e),checkColumnIndices(_,tt),super(_,_e.length,tt.length),this.rowIndices=_e,this.columnIndices=tt}set(_,_e,tt){return this.matrix.set(this.rowIndices[_],this.columnIndices[_e],tt),this}get(_,_e){return this.matrix.get(this.rowIndices[_],this.columnIndices[_e])}},MatrixSubView$1=class extends BaseView{constructor(_,_e,tt,nt,rt){checkRange(_,_e,tt,nt,rt),super(_,tt-_e+1,rt-nt+1),this.startRow=_e,this.startColumn=nt}set(_,_e,tt){return this.matrix.set(this.startRow+_,this.startColumn+_e,tt),this}get(_,_e){return this.matrix.get(this.startRow+_,this.startColumn+_e)}},MatrixTransposeView$2=class extends BaseView{constructor(_){super(_,_.columns,_.rows)}set(_,_e,tt){return this.matrix.set(_e,_,tt),this}get(_,_e){return this.matrix.get(_e,_)}},WrapperMatrix1D$1=class extends AbstractMatrix$1{constructor(_,_e={}){const{rows:tt=1}=_e;if(_.length%tt!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=tt,this.columns=_.length/tt,this.data=_}set(_,_e,tt){let nt=this._calculateIndex(_,_e);return this.data[nt]=tt,this}get(_,_e){let tt=this._calculateIndex(_,_e);return this.data[tt]}_calculateIndex(_,_e){return _*this.columns+_e}},WrapperMatrix2D$1=class extends AbstractMatrix$1{constructor(_){super(),this.data=_,this.rows=_.length,this.columns=_[0].length}set(_,_e,tt){return this.data[_][_e]=tt,this}get(_,_e){return this.data[_][_e]}};function wrap$1(et,_){if(isAnyArray.isAnyArray(et))return et[0]&&isAnyArray.isAnyArray(et[0])?new WrapperMatrix2D$1(et):new WrapperMatrix1D$1(et,_);throw new Error("the argument is not an array")}let LuDecomposition$1=class{constructor(_){_=WrapperMatrix2D$1.checkMatrix(_);let _e=_.clone(),tt=_e.rows,nt=_e.columns,rt=new Float64Array(tt),it=1,st,ot,at,lt,ct,ht,ut,ft,dt;for(st=0;st<tt;st++)rt[st]=st;for(ft=new Float64Array(tt),ot=0;ot<nt;ot++){for(st=0;st<tt;st++)ft[st]=_e.get(st,ot);for(st=0;st<tt;st++){for(dt=Math.min(st,ot),ct=0,at=0;at<dt;at++)ct+=_e.get(st,at)*ft[at];ft[st]-=ct,_e.set(st,ot,ft[st])}for(lt=ot,st=ot+1;st<tt;st++)Math.abs(ft[st])>Math.abs(ft[lt])&&(lt=st);if(lt!==ot){for(at=0;at<nt;at++)ht=_e.get(lt,at),_e.set(lt,at,_e.get(ot,at)),_e.set(ot,at,ht);ut=rt[lt],rt[lt]=rt[ot],rt[ot]=ut,it=-it}if(ot<tt&&_e.get(ot,ot)!==0)for(st=ot+1;st<tt;st++)_e.set(st,ot,_e.get(st,ot)/_e.get(ot,ot))}this.LU=_e,this.pivotVector=rt,this.pivotSign=it}isSingular(){let _=this.LU,_e=_.columns;for(let tt=0;tt<_e;tt++)if(_.get(tt,tt)===0)return!0;return!1}solve(_){_=Matrix$3.checkMatrix(_);let _e=this.LU;if(_e.rows!==_.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let nt=_.columns,rt=_.subMatrixRow(this.pivotVector,0,nt-1),it=_e.columns,st,ot,at;for(at=0;at<it;at++)for(st=at+1;st<it;st++)for(ot=0;ot<nt;ot++)rt.set(st,ot,rt.get(st,ot)-rt.get(at,ot)*_e.get(st,at));for(at=it-1;at>=0;at--){for(ot=0;ot<nt;ot++)rt.set(at,ot,rt.get(at,ot)/_e.get(at,at));for(st=0;st<at;st++)for(ot=0;ot<nt;ot++)rt.set(st,ot,rt.get(st,ot)-rt.get(at,ot)*_e.get(st,at))}return rt}get determinant(){let _=this.LU;if(!_.isSquare())throw new Error("Matrix must be square");let _e=this.pivotSign,tt=_.columns;for(let nt=0;nt<tt;nt++)_e*=_.get(nt,nt);return _e}get lowerTriangularMatrix(){let _=this.LU,_e=_.rows,tt=_.columns,nt=new Matrix$3(_e,tt);for(let rt=0;rt<_e;rt++)for(let it=0;it<tt;it++)rt>it?nt.set(rt,it,_.get(rt,it)):rt===it?nt.set(rt,it,1):nt.set(rt,it,0);return nt}get upperTriangularMatrix(){let _=this.LU,_e=_.rows,tt=_.columns,nt=new Matrix$3(_e,tt);for(let rt=0;rt<_e;rt++)for(let it=0;it<tt;it++)rt<=it?nt.set(rt,it,_.get(rt,it)):nt.set(rt,it,0);return nt}get pivotPermutationVector(){return Array.from(this.pivotVector)}};function hypotenuse$1(et,_){let _e=0;return Math.abs(et)>Math.abs(_)?(_e=_/et,Math.abs(et)*Math.sqrt(1+_e*_e)):_!==0?(_e=et/_,Math.abs(_)*Math.sqrt(1+_e*_e)):0}let QrDecomposition$1=class{constructor(_){_=WrapperMatrix2D$1.checkMatrix(_);let _e=_.clone(),tt=_.rows,nt=_.columns,rt=new Float64Array(nt),it,st,ot,at;for(ot=0;ot<nt;ot++){let lt=0;for(it=ot;it<tt;it++)lt=hypotenuse$1(lt,_e.get(it,ot));if(lt!==0){for(_e.get(ot,ot)<0&&(lt=-lt),it=ot;it<tt;it++)_e.set(it,ot,_e.get(it,ot)/lt);for(_e.set(ot,ot,_e.get(ot,ot)+1),st=ot+1;st<nt;st++){for(at=0,it=ot;it<tt;it++)at+=_e.get(it,ot)*_e.get(it,st);for(at=-at/_e.get(ot,ot),it=ot;it<tt;it++)_e.set(it,st,_e.get(it,st)+at*_e.get(it,ot))}}rt[ot]=-lt}this.QR=_e,this.Rdiag=rt}solve(_){_=Matrix$3.checkMatrix(_);let _e=this.QR,tt=_e.rows;if(_.rows!==tt)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let nt=_.columns,rt=_.clone(),it=_e.columns,st,ot,at,lt;for(at=0;at<it;at++)for(ot=0;ot<nt;ot++){for(lt=0,st=at;st<tt;st++)lt+=_e.get(st,at)*rt.get(st,ot);for(lt=-lt/_e.get(at,at),st=at;st<tt;st++)rt.set(st,ot,rt.get(st,ot)+lt*_e.get(st,at))}for(at=it-1;at>=0;at--){for(ot=0;ot<nt;ot++)rt.set(at,ot,rt.get(at,ot)/this.Rdiag[at]);for(st=0;st<at;st++)for(ot=0;ot<nt;ot++)rt.set(st,ot,rt.get(st,ot)-rt.get(at,ot)*_e.get(st,at))}return rt.subMatrix(0,it-1,0,nt-1)}isFullRank(){let _=this.QR.columns;for(let _e=0;_e<_;_e++)if(this.Rdiag[_e]===0)return!1;return!0}get upperTriangularMatrix(){let _=this.QR,_e=_.columns,tt=new Matrix$3(_e,_e),nt,rt;for(nt=0;nt<_e;nt++)for(rt=0;rt<_e;rt++)nt<rt?tt.set(nt,rt,_.get(nt,rt)):nt===rt?tt.set(nt,rt,this.Rdiag[nt]):tt.set(nt,rt,0);return tt}get orthogonalMatrix(){let _=this.QR,_e=_.rows,tt=_.columns,nt=new Matrix$3(_e,tt),rt,it,st,ot;for(st=tt-1;st>=0;st--){for(rt=0;rt<_e;rt++)nt.set(rt,st,0);for(nt.set(st,st,1),it=st;it<tt;it++)if(_.get(st,st)!==0){for(ot=0,rt=st;rt<_e;rt++)ot+=_.get(rt,st)*nt.get(rt,it);for(ot=-ot/_.get(st,st),rt=st;rt<_e;rt++)nt.set(rt,it,nt.get(rt,it)+ot*_.get(rt,st))}}return nt}},SingularValueDecomposition$1=class{constructor(_,_e={}){if(_=WrapperMatrix2D$1.checkMatrix(_),_.isEmpty())throw new Error("Matrix must be non-empty");let tt=_.rows,nt=_.columns;const{computeLeftSingularVectors:rt=!0,computeRightSingularVectors:it=!0,autoTranspose:st=!1}=_e;let ot=!!rt,at=!!it,lt=!1,ct;if(tt<nt)if(!st)ct=_.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{ct=_.transpose(),tt=ct.rows,nt=ct.columns,lt=!0;let wt=ot;ot=at,at=wt}else ct=_.clone();let ht=Math.min(tt,nt),ut=Math.min(tt+1,nt),ft=new Float64Array(ut),dt=new Matrix$3(tt,ht),pt=new Matrix$3(nt,nt),mt=new Float64Array(nt),vt=new Float64Array(tt),yt=new Float64Array(ut);for(let wt=0;wt<ut;wt++)yt[wt]=wt;let _t=Math.min(tt-1,nt),St=Math.max(0,Math.min(nt-2,tt)),bt=Math.max(_t,St);for(let wt=0;wt<bt;wt++){if(wt<_t){ft[wt]=0;for(let Ct=wt;Ct<tt;Ct++)ft[wt]=hypotenuse$1(ft[wt],ct.get(Ct,wt));if(ft[wt]!==0){ct.get(wt,wt)<0&&(ft[wt]=-ft[wt]);for(let Ct=wt;Ct<tt;Ct++)ct.set(Ct,wt,ct.get(Ct,wt)/ft[wt]);ct.set(wt,wt,ct.get(wt,wt)+1)}ft[wt]=-ft[wt]}for(let Ct=wt+1;Ct<nt;Ct++){if(wt<_t&&ft[wt]!==0){let Rt=0;for(let It=wt;It<tt;It++)Rt+=ct.get(It,wt)*ct.get(It,Ct);Rt=-Rt/ct.get(wt,wt);for(let It=wt;It<tt;It++)ct.set(It,Ct,ct.get(It,Ct)+Rt*ct.get(It,wt))}mt[Ct]=ct.get(wt,Ct)}if(ot&&wt<_t)for(let Ct=wt;Ct<tt;Ct++)dt.set(Ct,wt,ct.get(Ct,wt));if(wt<St){mt[wt]=0;for(let Ct=wt+1;Ct<nt;Ct++)mt[wt]=hypotenuse$1(mt[wt],mt[Ct]);if(mt[wt]!==0){mt[wt+1]<0&&(mt[wt]=0-mt[wt]);for(let Ct=wt+1;Ct<nt;Ct++)mt[Ct]/=mt[wt];mt[wt+1]+=1}if(mt[wt]=-mt[wt],wt+1<tt&&mt[wt]!==0){for(let Ct=wt+1;Ct<tt;Ct++)vt[Ct]=0;for(let Ct=wt+1;Ct<tt;Ct++)for(let Rt=wt+1;Rt<nt;Rt++)vt[Ct]+=mt[Rt]*ct.get(Ct,Rt);for(let Ct=wt+1;Ct<nt;Ct++){let Rt=-mt[Ct]/mt[wt+1];for(let It=wt+1;It<tt;It++)ct.set(It,Ct,ct.get(It,Ct)+Rt*vt[It])}}if(at)for(let Ct=wt+1;Ct<nt;Ct++)pt.set(Ct,wt,mt[Ct])}}let Et=Math.min(nt,tt+1);if(_t<nt&&(ft[_t]=ct.get(_t,_t)),tt<Et&&(ft[Et-1]=0),St+1<Et&&(mt[St]=ct.get(St,Et-1)),mt[Et-1]=0,ot){for(let wt=_t;wt<ht;wt++){for(let Ct=0;Ct<tt;Ct++)dt.set(Ct,wt,0);dt.set(wt,wt,1)}for(let wt=_t-1;wt>=0;wt--)if(ft[wt]!==0){for(let Ct=wt+1;Ct<ht;Ct++){let Rt=0;for(let It=wt;It<tt;It++)Rt+=dt.get(It,wt)*dt.get(It,Ct);Rt=-Rt/dt.get(wt,wt);for(let It=wt;It<tt;It++)dt.set(It,Ct,dt.get(It,Ct)+Rt*dt.get(It,wt))}for(let Ct=wt;Ct<tt;Ct++)dt.set(Ct,wt,-dt.get(Ct,wt));dt.set(wt,wt,1+dt.get(wt,wt));for(let Ct=0;Ct<wt-1;Ct++)dt.set(Ct,wt,0)}else{for(let Ct=0;Ct<tt;Ct++)dt.set(Ct,wt,0);dt.set(wt,wt,1)}}if(at)for(let wt=nt-1;wt>=0;wt--){if(wt<St&&mt[wt]!==0)for(let Ct=wt+1;Ct<nt;Ct++){let Rt=0;for(let It=wt+1;It<nt;It++)Rt+=pt.get(It,wt)*pt.get(It,Ct);Rt=-Rt/pt.get(wt+1,wt);for(let It=wt+1;It<nt;It++)pt.set(It,Ct,pt.get(It,Ct)+Rt*pt.get(It,wt))}for(let Ct=0;Ct<nt;Ct++)pt.set(Ct,wt,0);pt.set(wt,wt,1)}let Mt=Et-1,Tt=Number.EPSILON;for(;Et>0;){let wt,Ct;for(wt=Et-2;wt>=-1&&wt!==-1;wt--){const Rt=Number.MIN_VALUE+Tt*Math.abs(ft[wt]+Math.abs(ft[wt+1]));if(Math.abs(mt[wt])<=Rt||Number.isNaN(mt[wt])){mt[wt]=0;break}}if(wt===Et-2)Ct=4;else{let Rt;for(Rt=Et-1;Rt>=wt&&Rt!==wt;Rt--){let It=(Rt!==Et?Math.abs(mt[Rt]):0)+(Rt!==wt+1?Math.abs(mt[Rt-1]):0);if(Math.abs(ft[Rt])<=Tt*It){ft[Rt]=0;break}}Rt===wt?Ct=3:Rt===Et-1?Ct=1:(Ct=2,wt=Rt)}switch(wt++,Ct){case 1:{let Rt=mt[Et-2];mt[Et-2]=0;for(let It=Et-2;It>=wt;It--){let Dt=hypotenuse$1(ft[It],Rt),Ft=ft[It]/Dt,$t=Rt/Dt;if(ft[It]=Dt,It!==wt&&(Rt=-$t*mt[It-1],mt[It-1]=Ft*mt[It-1]),at)for(let Yt=0;Yt<nt;Yt++)Dt=Ft*pt.get(Yt,It)+$t*pt.get(Yt,Et-1),pt.set(Yt,Et-1,-$t*pt.get(Yt,It)+Ft*pt.get(Yt,Et-1)),pt.set(Yt,It,Dt)}break}case 2:{let Rt=mt[wt-1];mt[wt-1]=0;for(let It=wt;It<Et;It++){let Dt=hypotenuse$1(ft[It],Rt),Ft=ft[It]/Dt,$t=Rt/Dt;if(ft[It]=Dt,Rt=-$t*mt[It],mt[It]=Ft*mt[It],ot)for(let Yt=0;Yt<tt;Yt++)Dt=Ft*dt.get(Yt,It)+$t*dt.get(Yt,wt-1),dt.set(Yt,wt-1,-$t*dt.get(Yt,It)+Ft*dt.get(Yt,wt-1)),dt.set(Yt,It,Dt)}break}case 3:{const Rt=Math.max(Math.abs(ft[Et-1]),Math.abs(ft[Et-2]),Math.abs(mt[Et-2]),Math.abs(ft[wt]),Math.abs(mt[wt])),It=ft[Et-1]/Rt,Dt=ft[Et-2]/Rt,Ft=mt[Et-2]/Rt,$t=ft[wt]/Rt,Yt=mt[wt]/Rt,Lt=((Dt+It)*(Dt-It)+Ft*Ft)/2,Ot=It*Ft*(It*Ft);let Nt=0;(Lt!==0||Ot!==0)&&(Lt<0?Nt=0-Math.sqrt(Lt*Lt+Ot):Nt=Math.sqrt(Lt*Lt+Ot),Nt=Ot/(Lt+Nt));let zt=($t+It)*($t-It)+Nt,Ht=$t*Yt;for(let qt=wt;qt<Et-1;qt++){let Gt=hypotenuse$1(zt,Ht);Gt===0&&(Gt=Number.MIN_VALUE);let Xt=zt/Gt,Zt=Ht/Gt;if(qt!==wt&&(mt[qt-1]=Gt),zt=Xt*ft[qt]+Zt*mt[qt],mt[qt]=Xt*mt[qt]-Zt*ft[qt],Ht=Zt*ft[qt+1],ft[qt+1]=Xt*ft[qt+1],at)for(let Qt=0;Qt<nt;Qt++)Gt=Xt*pt.get(Qt,qt)+Zt*pt.get(Qt,qt+1),pt.set(Qt,qt+1,-Zt*pt.get(Qt,qt)+Xt*pt.get(Qt,qt+1)),pt.set(Qt,qt,Gt);if(Gt=hypotenuse$1(zt,Ht),Gt===0&&(Gt=Number.MIN_VALUE),Xt=zt/Gt,Zt=Ht/Gt,ft[qt]=Gt,zt=Xt*mt[qt]+Zt*ft[qt+1],ft[qt+1]=-Zt*mt[qt]+Xt*ft[qt+1],Ht=Zt*mt[qt+1],mt[qt+1]=Xt*mt[qt+1],ot&&qt<tt-1)for(let Qt=0;Qt<tt;Qt++)Gt=Xt*dt.get(Qt,qt)+Zt*dt.get(Qt,qt+1),dt.set(Qt,qt+1,-Zt*dt.get(Qt,qt)+Xt*dt.get(Qt,qt+1)),dt.set(Qt,qt,Gt)}mt[Et-2]=zt;break}case 4:{if(ft[wt]<=0&&(ft[wt]=ft[wt]<0?-ft[wt]:0,at))for(let Rt=0;Rt<=Mt;Rt++)pt.set(Rt,wt,-pt.get(Rt,wt));for(;wt<Mt&&!(ft[wt]>=ft[wt+1]);){let Rt=ft[wt];if(ft[wt]=ft[wt+1],ft[wt+1]=Rt,at&&wt<nt-1)for(let It=0;It<nt;It++)Rt=pt.get(It,wt+1),pt.set(It,wt+1,pt.get(It,wt)),pt.set(It,wt,Rt);if(ot&&wt<tt-1)for(let It=0;It<tt;It++)Rt=dt.get(It,wt+1),dt.set(It,wt+1,dt.get(It,wt)),dt.set(It,wt,Rt);wt++}Et--;break}}}if(lt){let wt=pt;pt=dt,dt=wt}this.m=tt,this.n=nt,this.s=ft,this.U=dt,this.V=pt}solve(_){let _e=_,tt=this.threshold,nt=this.s.length,rt=Matrix$3.zeros(nt,nt);for(let ht=0;ht<nt;ht++)Math.abs(this.s[ht])<=tt?rt.set(ht,ht,0):rt.set(ht,ht,1/this.s[ht]);let it=this.U,st=this.rightSingularVectors,ot=st.mmul(rt),at=st.rows,lt=it.rows,ct=Matrix$3.zeros(at,lt);for(let ht=0;ht<at;ht++)for(let ut=0;ut<lt;ut++){let ft=0;for(let dt=0;dt<nt;dt++)ft+=ot.get(ht,dt)*it.get(ut,dt);ct.set(ht,ut,ft)}return ct.mmul(_e)}solveForDiagonal(_){return this.solve(Matrix$3.diag(_))}inverse(){let _=this.V,_e=this.threshold,tt=_.rows,nt=_.columns,rt=new Matrix$3(tt,this.s.length);for(let lt=0;lt<tt;lt++)for(let ct=0;ct<nt;ct++)Math.abs(this.s[ct])>_e&&rt.set(lt,ct,_.get(lt,ct)/this.s[ct]);let it=this.U,st=it.rows,ot=it.columns,at=new Matrix$3(tt,st);for(let lt=0;lt<tt;lt++)for(let ct=0;ct<st;ct++){let ht=0;for(let ut=0;ut<ot;ut++)ht+=rt.get(lt,ut)*it.get(ct,ut);at.set(lt,ct,ht)}return at}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let _=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,_e=0,tt=this.s;for(let nt=0,rt=tt.length;nt<rt;nt++)tt[nt]>_&&_e++;return _e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Matrix$3.diag(this.s)}};function inverse$1(et,_=!1){return et=WrapperMatrix2D$1.checkMatrix(et),_?new SingularValueDecomposition$1(et).inverse():solve$1(et,Matrix$3.eye(et.rows))}function solve$1(et,_,_e=!1){return et=WrapperMatrix2D$1.checkMatrix(et),_=WrapperMatrix2D$1.checkMatrix(_),_e?new SingularValueDecomposition$1(et).solve(_):et.isSquare()?new LuDecomposition$1(et).solve(_):new QrDecomposition$1(et).solve(_)}function determinant$1(et){if(et=Matrix$3.checkMatrix(et),et.isSquare()){if(et.columns===0)return 1;let _,_e,tt,nt;if(et.columns===2)return _=et.get(0,0),_e=et.get(0,1),tt=et.get(1,0),nt=et.get(1,1),_*nt-_e*tt;if(et.columns===3){let rt,it,st;return rt=new MatrixSelectionView$1(et,[1,2],[1,2]),it=new MatrixSelectionView$1(et,[1,2],[0,2]),st=new MatrixSelectionView$1(et,[1,2],[0,1]),_=et.get(0,0),_e=et.get(0,1),tt=et.get(0,2),_*determinant$1(rt)-_e*determinant$1(it)+tt*determinant$1(st)}else return new LuDecomposition$1(et).determinant}else throw Error("determinant can only be calculated for a square matrix")}function xrange(et,_){let _e=[];for(let tt=0;tt<et;tt++)tt!==_&&_e.push(tt);return _e}function dependenciesOneRow(et,_,_e,tt=1e-9,nt=1e-9){if(et>nt)return new Array(_.rows+1).fill(0);{let rt=_.addRow(_e,[0]);for(let it=0;it<rt.rows;it++)Math.abs(rt.get(it,0))<tt&&rt.set(it,0,0);return rt.to1DArray()}}function linearDependencies$1(et,_={}){const{thresholdValue:_e=1e-9,thresholdError:tt=1e-9}=_;et=Matrix$3.checkMatrix(et);let nt=et.rows,rt=new Matrix$3(nt,nt);for(let it=0;it<nt;it++){let st=Matrix$3.columnVector(et.getRow(it)),ot=et.subMatrixRow(xrange(nt,it)).transpose(),lt=new SingularValueDecomposition$1(ot).solve(st),ct=Matrix$3.sub(st,ot.mmul(lt)).abs().max();rt.setRow(it,dependenciesOneRow(ct,lt,it,_e,tt))}return rt}function pseudoInverse$1(et,_=Number.EPSILON){if(et=Matrix$3.checkMatrix(et),et.isEmpty())return et.transpose();let _e=new SingularValueDecomposition$1(et,{autoTranspose:!0}),tt=_e.leftSingularVectors,nt=_e.rightSingularVectors,rt=_e.diagonal;for(let it=0;it<rt.length;it++)Math.abs(rt[it])>_?rt[it]=1/rt[it]:rt[it]=0;return nt.mmul(Matrix$3.diag(rt).mmul(tt.transpose()))}function covariance$1(et,_=et,_e={}){et=new Matrix$3(et);let tt=!1;if(typeof _=="object"&&!Matrix$3.isMatrix(_)&&!isAnyArray.isAnyArray(_)?(_e=_,_=et,tt=!0):_=new Matrix$3(_),et.rows!==_.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:nt=!0}=_e;nt&&(et=et.center("column"),tt||(_=_.center("column")));const rt=et.transpose().mmul(_);for(let it=0;it<rt.rows;it++)for(let st=0;st<rt.columns;st++)rt.set(it,st,rt.get(it,st)*(1/(et.rows-1)));return rt}function correlation$1(et,_=et,_e={}){et=new Matrix$3(et);let tt=!1;if(typeof _=="object"&&!Matrix$3.isMatrix(_)&&!isAnyArray.isAnyArray(_)?(_e=_,_=et,tt=!0):_=new Matrix$3(_),et.rows!==_.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:nt=!0,scale:rt=!0}=_e;nt&&(et.center("column"),tt||_.center("column")),rt&&(et.scale("column"),tt||_.scale("column"));const it=et.standardDeviation("column",{unbiased:!0}),st=tt?it:_.standardDeviation("column",{unbiased:!0}),ot=et.transpose().mmul(_);for(let at=0;at<ot.rows;at++)for(let lt=0;lt<ot.columns;lt++)ot.set(at,lt,ot.get(at,lt)*(1/(it[at]*st[lt]))*(1/(et.rows-1)));return ot}let EigenvalueDecomposition$1=class{constructor(_,_e={}){const{assumeSymmetric:tt=!1}=_e;if(_=WrapperMatrix2D$1.checkMatrix(_),!_.isSquare())throw new Error("Matrix is not a square matrix");if(_.isEmpty())throw new Error("Matrix must be non-empty");let nt=_.columns,rt=new Matrix$3(nt,nt),it=new Float64Array(nt),st=new Float64Array(nt),ot=_,at,lt,ct=!1;if(tt?ct=!0:ct=_.isSymmetric(),ct){for(at=0;at<nt;at++)for(lt=0;lt<nt;lt++)rt.set(at,lt,ot.get(at,lt));tred2(nt,st,it,rt),tql2(nt,st,it,rt)}else{let ht=new Matrix$3(nt,nt),ut=new Float64Array(nt);for(lt=0;lt<nt;lt++)for(at=0;at<nt;at++)ht.set(at,lt,ot.get(at,lt));orthes(nt,ht,ut,rt),hqr2(nt,st,it,rt,ht)}this.n=nt,this.e=st,this.d=it,this.V=rt}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let _=this.n,_e=this.e,tt=this.d,nt=new Matrix$3(_,_),rt,it;for(rt=0;rt<_;rt++){for(it=0;it<_;it++)nt.set(rt,it,0);nt.set(rt,rt,tt[rt]),_e[rt]>0?nt.set(rt,rt+1,_e[rt]):_e[rt]<0&&nt.set(rt,rt-1,_e[rt])}return nt}};function tred2(et,_,_e,tt){let nt,rt,it,st,ot,at,lt,ct;for(ot=0;ot<et;ot++)_e[ot]=tt.get(et-1,ot);for(st=et-1;st>0;st--){for(ct=0,it=0,at=0;at<st;at++)ct=ct+Math.abs(_e[at]);if(ct===0)for(_[st]=_e[st-1],ot=0;ot<st;ot++)_e[ot]=tt.get(st-1,ot),tt.set(st,ot,0),tt.set(ot,st,0);else{for(at=0;at<st;at++)_e[at]/=ct,it+=_e[at]*_e[at];for(nt=_e[st-1],rt=Math.sqrt(it),nt>0&&(rt=-rt),_[st]=ct*rt,it=it-nt*rt,_e[st-1]=nt-rt,ot=0;ot<st;ot++)_[ot]=0;for(ot=0;ot<st;ot++){for(nt=_e[ot],tt.set(ot,st,nt),rt=_[ot]+tt.get(ot,ot)*nt,at=ot+1;at<=st-1;at++)rt+=tt.get(at,ot)*_e[at],_[at]+=tt.get(at,ot)*nt;_[ot]=rt}for(nt=0,ot=0;ot<st;ot++)_[ot]/=it,nt+=_[ot]*_e[ot];for(lt=nt/(it+it),ot=0;ot<st;ot++)_[ot]-=lt*_e[ot];for(ot=0;ot<st;ot++){for(nt=_e[ot],rt=_[ot],at=ot;at<=st-1;at++)tt.set(at,ot,tt.get(at,ot)-(nt*_[at]+rt*_e[at]));_e[ot]=tt.get(st-1,ot),tt.set(st,ot,0)}}_e[st]=it}for(st=0;st<et-1;st++){if(tt.set(et-1,st,tt.get(st,st)),tt.set(st,st,1),it=_e[st+1],it!==0){for(at=0;at<=st;at++)_e[at]=tt.get(at,st+1)/it;for(ot=0;ot<=st;ot++){for(rt=0,at=0;at<=st;at++)rt+=tt.get(at,st+1)*tt.get(at,ot);for(at=0;at<=st;at++)tt.set(at,ot,tt.get(at,ot)-rt*_e[at])}}for(at=0;at<=st;at++)tt.set(at,st+1,0)}for(ot=0;ot<et;ot++)_e[ot]=tt.get(et-1,ot),tt.set(et-1,ot,0);tt.set(et-1,et-1,1),_[0]=0}function tql2(et,_,_e,tt){let nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt,pt,mt,vt,yt;for(it=1;it<et;it++)_[it-1]=_[it];_[et-1]=0;let _t=0,St=0,bt=Number.EPSILON;for(at=0;at<et;at++){for(St=Math.max(St,Math.abs(_e[at])+Math.abs(_[at])),lt=at;lt<et&&!(Math.abs(_[lt])<=bt*St);)lt++;if(lt>at)do{for(nt=_e[at],ct=(_e[at+1]-nt)/(2*_[at]),ht=hypotenuse$1(ct,1),ct<0&&(ht=-ht),_e[at]=_[at]/(ct+ht),_e[at+1]=_[at]*(ct+ht),ut=_e[at+1],rt=nt-_e[at],it=at+2;it<et;it++)_e[it]-=rt;for(_t=_t+rt,ct=_e[lt],ft=1,dt=ft,pt=ft,mt=_[at+1],vt=0,yt=0,it=lt-1;it>=at;it--)for(pt=dt,dt=ft,yt=vt,nt=ft*_[it],rt=ft*ct,ht=hypotenuse$1(ct,_[it]),_[it+1]=vt*ht,vt=_[it]/ht,ft=ct/ht,ct=ft*_e[it]-vt*nt,_e[it+1]=rt+vt*(ft*nt+vt*_e[it]),ot=0;ot<et;ot++)rt=tt.get(ot,it+1),tt.set(ot,it+1,vt*tt.get(ot,it)+ft*rt),tt.set(ot,it,ft*tt.get(ot,it)-vt*rt);ct=-vt*yt*pt*mt*_[at]/ut,_[at]=vt*ct,_e[at]=ft*ct}while(Math.abs(_[at])>bt*St);_e[at]=_e[at]+_t,_[at]=0}for(it=0;it<et-1;it++){for(ot=it,ct=_e[it],st=it+1;st<et;st++)_e[st]<ct&&(ot=st,ct=_e[st]);if(ot!==it)for(_e[ot]=_e[it],_e[it]=ct,st=0;st<et;st++)ct=tt.get(st,it),tt.set(st,it,tt.get(st,ot)),tt.set(st,ot,ct)}}function orthes(et,_,_e,tt){let nt=0,rt=et-1,it,st,ot,at,lt,ct,ht;for(ct=nt+1;ct<=rt-1;ct++){for(ht=0,at=ct;at<=rt;at++)ht=ht+Math.abs(_.get(at,ct-1));if(ht!==0){for(ot=0,at=rt;at>=ct;at--)_e[at]=_.get(at,ct-1)/ht,ot+=_e[at]*_e[at];for(st=Math.sqrt(ot),_e[ct]>0&&(st=-st),ot=ot-_e[ct]*st,_e[ct]=_e[ct]-st,lt=ct;lt<et;lt++){for(it=0,at=rt;at>=ct;at--)it+=_e[at]*_.get(at,lt);for(it=it/ot,at=ct;at<=rt;at++)_.set(at,lt,_.get(at,lt)-it*_e[at])}for(at=0;at<=rt;at++){for(it=0,lt=rt;lt>=ct;lt--)it+=_e[lt]*_.get(at,lt);for(it=it/ot,lt=ct;lt<=rt;lt++)_.set(at,lt,_.get(at,lt)-it*_e[lt])}_e[ct]=ht*_e[ct],_.set(ct,ct-1,ht*st)}}for(at=0;at<et;at++)for(lt=0;lt<et;lt++)tt.set(at,lt,at===lt?1:0);for(ct=rt-1;ct>=nt+1;ct--)if(_.get(ct,ct-1)!==0){for(at=ct+1;at<=rt;at++)_e[at]=_.get(at,ct-1);for(lt=ct;lt<=rt;lt++){for(st=0,at=ct;at<=rt;at++)st+=_e[at]*tt.get(at,lt);for(st=st/_e[ct]/_.get(ct,ct-1),at=ct;at<=rt;at++)tt.set(at,lt,tt.get(at,lt)+st*_e[at])}}}function hqr2(et,_,_e,tt,nt){let rt=et-1,it=0,st=et-1,ot=Number.EPSILON,at=0,lt=0,ct=0,ht=0,ut=0,ft=0,dt=0,pt=0,mt,vt,yt,_t,St,bt,Et,Mt,Tt,wt,Ct,Rt,It,Dt,Ft;for(mt=0;mt<et;mt++)for((mt<it||mt>st)&&(_e[mt]=nt.get(mt,mt),_[mt]=0),vt=Math.max(mt-1,0);vt<et;vt++)lt=lt+Math.abs(nt.get(mt,vt));for(;rt>=it;){for(_t=rt;_t>it&&(ft=Math.abs(nt.get(_t-1,_t-1))+Math.abs(nt.get(_t,_t)),ft===0&&(ft=lt),!(Math.abs(nt.get(_t,_t-1))<ot*ft));)_t--;if(_t===rt)nt.set(rt,rt,nt.get(rt,rt)+at),_e[rt]=nt.get(rt,rt),_[rt]=0,rt--,pt=0;else if(_t===rt-1){if(Et=nt.get(rt,rt-1)*nt.get(rt-1,rt),ct=(nt.get(rt-1,rt-1)-nt.get(rt,rt))/2,ht=ct*ct+Et,dt=Math.sqrt(Math.abs(ht)),nt.set(rt,rt,nt.get(rt,rt)+at),nt.set(rt-1,rt-1,nt.get(rt-1,rt-1)+at),Mt=nt.get(rt,rt),ht>=0){for(dt=ct>=0?ct+dt:ct-dt,_e[rt-1]=Mt+dt,_e[rt]=_e[rt-1],dt!==0&&(_e[rt]=Mt-Et/dt),_[rt-1]=0,_[rt]=0,Mt=nt.get(rt,rt-1),ft=Math.abs(Mt)+Math.abs(dt),ct=Mt/ft,ht=dt/ft,ut=Math.sqrt(ct*ct+ht*ht),ct=ct/ut,ht=ht/ut,vt=rt-1;vt<et;vt++)dt=nt.get(rt-1,vt),nt.set(rt-1,vt,ht*dt+ct*nt.get(rt,vt)),nt.set(rt,vt,ht*nt.get(rt,vt)-ct*dt);for(mt=0;mt<=rt;mt++)dt=nt.get(mt,rt-1),nt.set(mt,rt-1,ht*dt+ct*nt.get(mt,rt)),nt.set(mt,rt,ht*nt.get(mt,rt)-ct*dt);for(mt=it;mt<=st;mt++)dt=tt.get(mt,rt-1),tt.set(mt,rt-1,ht*dt+ct*tt.get(mt,rt)),tt.set(mt,rt,ht*tt.get(mt,rt)-ct*dt)}else _e[rt-1]=Mt+ct,_e[rt]=Mt+ct,_[rt-1]=dt,_[rt]=-dt;rt=rt-2,pt=0}else{if(Mt=nt.get(rt,rt),Tt=0,Et=0,_t<rt&&(Tt=nt.get(rt-1,rt-1),Et=nt.get(rt,rt-1)*nt.get(rt-1,rt)),pt===10){for(at+=Mt,mt=it;mt<=rt;mt++)nt.set(mt,mt,nt.get(mt,mt)-Mt);ft=Math.abs(nt.get(rt,rt-1))+Math.abs(nt.get(rt-1,rt-2)),Mt=Tt=.75*ft,Et=-.4375*ft*ft}if(pt===30&&(ft=(Tt-Mt)/2,ft=ft*ft+Et,ft>0)){for(ft=Math.sqrt(ft),Tt<Mt&&(ft=-ft),ft=Mt-Et/((Tt-Mt)/2+ft),mt=it;mt<=rt;mt++)nt.set(mt,mt,nt.get(mt,mt)-ft);at+=ft,Mt=Tt=Et=.964}for(pt=pt+1,St=rt-2;St>=_t&&(dt=nt.get(St,St),ut=Mt-dt,ft=Tt-dt,ct=(ut*ft-Et)/nt.get(St+1,St)+nt.get(St,St+1),ht=nt.get(St+1,St+1)-dt-ut-ft,ut=nt.get(St+2,St+1),ft=Math.abs(ct)+Math.abs(ht)+Math.abs(ut),ct=ct/ft,ht=ht/ft,ut=ut/ft,!(St===_t||Math.abs(nt.get(St,St-1))*(Math.abs(ht)+Math.abs(ut))<ot*(Math.abs(ct)*(Math.abs(nt.get(St-1,St-1))+Math.abs(dt)+Math.abs(nt.get(St+1,St+1))))));)St--;for(mt=St+2;mt<=rt;mt++)nt.set(mt,mt-2,0),mt>St+2&&nt.set(mt,mt-3,0);for(yt=St;yt<=rt-1&&(Dt=yt!==rt-1,yt!==St&&(ct=nt.get(yt,yt-1),ht=nt.get(yt+1,yt-1),ut=Dt?nt.get(yt+2,yt-1):0,Mt=Math.abs(ct)+Math.abs(ht)+Math.abs(ut),Mt!==0&&(ct=ct/Mt,ht=ht/Mt,ut=ut/Mt)),Mt!==0);yt++)if(ft=Math.sqrt(ct*ct+ht*ht+ut*ut),ct<0&&(ft=-ft),ft!==0){for(yt!==St?nt.set(yt,yt-1,-ft*Mt):_t!==St&&nt.set(yt,yt-1,-nt.get(yt,yt-1)),ct=ct+ft,Mt=ct/ft,Tt=ht/ft,dt=ut/ft,ht=ht/ct,ut=ut/ct,vt=yt;vt<et;vt++)ct=nt.get(yt,vt)+ht*nt.get(yt+1,vt),Dt&&(ct=ct+ut*nt.get(yt+2,vt),nt.set(yt+2,vt,nt.get(yt+2,vt)-ct*dt)),nt.set(yt,vt,nt.get(yt,vt)-ct*Mt),nt.set(yt+1,vt,nt.get(yt+1,vt)-ct*Tt);for(mt=0;mt<=Math.min(rt,yt+3);mt++)ct=Mt*nt.get(mt,yt)+Tt*nt.get(mt,yt+1),Dt&&(ct=ct+dt*nt.get(mt,yt+2),nt.set(mt,yt+2,nt.get(mt,yt+2)-ct*ut)),nt.set(mt,yt,nt.get(mt,yt)-ct),nt.set(mt,yt+1,nt.get(mt,yt+1)-ct*ht);for(mt=it;mt<=st;mt++)ct=Mt*tt.get(mt,yt)+Tt*tt.get(mt,yt+1),Dt&&(ct=ct+dt*tt.get(mt,yt+2),tt.set(mt,yt+2,tt.get(mt,yt+2)-ct*ut)),tt.set(mt,yt,tt.get(mt,yt)-ct),tt.set(mt,yt+1,tt.get(mt,yt+1)-ct*ht)}}}if(lt!==0){for(rt=et-1;rt>=0;rt--)if(ct=_e[rt],ht=_[rt],ht===0)for(_t=rt,nt.set(rt,rt,1),mt=rt-1;mt>=0;mt--){for(Et=nt.get(mt,mt)-ct,ut=0,vt=_t;vt<=rt;vt++)ut=ut+nt.get(mt,vt)*nt.get(vt,rt);if(_[mt]<0)dt=Et,ft=ut;else if(_t=mt,_[mt]===0?nt.set(mt,rt,Et!==0?-ut/Et:-ut/(ot*lt)):(Mt=nt.get(mt,mt+1),Tt=nt.get(mt+1,mt),ht=(_e[mt]-ct)*(_e[mt]-ct)+_[mt]*_[mt],bt=(Mt*ft-dt*ut)/ht,nt.set(mt,rt,bt),nt.set(mt+1,rt,Math.abs(Mt)>Math.abs(dt)?(-ut-Et*bt)/Mt:(-ft-Tt*bt)/dt)),bt=Math.abs(nt.get(mt,rt)),ot*bt*bt>1)for(vt=mt;vt<=rt;vt++)nt.set(vt,rt,nt.get(vt,rt)/bt)}else if(ht<0)for(_t=rt-1,Math.abs(nt.get(rt,rt-1))>Math.abs(nt.get(rt-1,rt))?(nt.set(rt-1,rt-1,ht/nt.get(rt,rt-1)),nt.set(rt-1,rt,-(nt.get(rt,rt)-ct)/nt.get(rt,rt-1))):(Ft=cdiv(0,-nt.get(rt-1,rt),nt.get(rt-1,rt-1)-ct,ht),nt.set(rt-1,rt-1,Ft[0]),nt.set(rt-1,rt,Ft[1])),nt.set(rt,rt-1,0),nt.set(rt,rt,1),mt=rt-2;mt>=0;mt--){for(wt=0,Ct=0,vt=_t;vt<=rt;vt++)wt=wt+nt.get(mt,vt)*nt.get(vt,rt-1),Ct=Ct+nt.get(mt,vt)*nt.get(vt,rt);if(Et=nt.get(mt,mt)-ct,_[mt]<0)dt=Et,ut=wt,ft=Ct;else if(_t=mt,_[mt]===0?(Ft=cdiv(-wt,-Ct,Et,ht),nt.set(mt,rt-1,Ft[0]),nt.set(mt,rt,Ft[1])):(Mt=nt.get(mt,mt+1),Tt=nt.get(mt+1,mt),Rt=(_e[mt]-ct)*(_e[mt]-ct)+_[mt]*_[mt]-ht*ht,It=(_e[mt]-ct)*2*ht,Rt===0&&It===0&&(Rt=ot*lt*(Math.abs(Et)+Math.abs(ht)+Math.abs(Mt)+Math.abs(Tt)+Math.abs(dt))),Ft=cdiv(Mt*ut-dt*wt+ht*Ct,Mt*ft-dt*Ct-ht*wt,Rt,It),nt.set(mt,rt-1,Ft[0]),nt.set(mt,rt,Ft[1]),Math.abs(Mt)>Math.abs(dt)+Math.abs(ht)?(nt.set(mt+1,rt-1,(-wt-Et*nt.get(mt,rt-1)+ht*nt.get(mt,rt))/Mt),nt.set(mt+1,rt,(-Ct-Et*nt.get(mt,rt)-ht*nt.get(mt,rt-1))/Mt)):(Ft=cdiv(-ut-Tt*nt.get(mt,rt-1),-ft-Tt*nt.get(mt,rt),dt,ht),nt.set(mt+1,rt-1,Ft[0]),nt.set(mt+1,rt,Ft[1]))),bt=Math.max(Math.abs(nt.get(mt,rt-1)),Math.abs(nt.get(mt,rt))),ot*bt*bt>1)for(vt=mt;vt<=rt;vt++)nt.set(vt,rt-1,nt.get(vt,rt-1)/bt),nt.set(vt,rt,nt.get(vt,rt)/bt)}for(mt=0;mt<et;mt++)if(mt<it||mt>st)for(vt=mt;vt<et;vt++)tt.set(mt,vt,nt.get(mt,vt));for(vt=et-1;vt>=it;vt--)for(mt=it;mt<=st;mt++){for(dt=0,yt=it;yt<=Math.min(vt,st);yt++)dt=dt+tt.get(mt,yt)*nt.get(yt,vt);tt.set(mt,vt,dt)}}}function cdiv(et,_,_e,tt){let nt,rt;return Math.abs(_e)>Math.abs(tt)?(nt=tt/_e,rt=_e+nt*tt,[(et+nt*_)/rt,(_-nt*et)/rt]):(nt=_e/tt,rt=tt+nt*_e,[(nt*et+_)/rt,(nt*_-et)/rt])}let CholeskyDecomposition$1=class{constructor(_){if(_=WrapperMatrix2D$1.checkMatrix(_),!_.isSymmetric())throw new Error("Matrix is not symmetric");let _e=_,tt=_e.rows,nt=new Matrix$3(tt,tt),rt=!0,it,st,ot;for(st=0;st<tt;st++){let at=0;for(ot=0;ot<st;ot++){let lt=0;for(it=0;it<ot;it++)lt+=nt.get(ot,it)*nt.get(st,it);lt=(_e.get(st,ot)-lt)/nt.get(ot,ot),nt.set(st,ot,lt),at=at+lt*lt}for(at=_e.get(st,st)-at,rt&=at>0,nt.set(st,st,Math.sqrt(Math.max(at,0))),ot=st+1;ot<tt;ot++)nt.set(st,ot,0)}this.L=nt,this.positiveDefinite=!!rt}isPositiveDefinite(){return this.positiveDefinite}solve(_){_=WrapperMatrix2D$1.checkMatrix(_);let _e=this.L,tt=_e.rows;if(_.rows!==tt)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let nt=_.columns,rt=_.clone(),it,st,ot;for(ot=0;ot<tt;ot++)for(st=0;st<nt;st++){for(it=0;it<ot;it++)rt.set(ot,st,rt.get(ot,st)-rt.get(it,st)*_e.get(ot,it));rt.set(ot,st,rt.get(ot,st)/_e.get(ot,ot))}for(ot=tt-1;ot>=0;ot--)for(st=0;st<nt;st++){for(it=ot+1;it<tt;it++)rt.set(ot,st,rt.get(ot,st)-rt.get(it,st)*_e.get(it,ot));rt.set(ot,st,rt.get(ot,st)/_e.get(ot,ot))}return rt}get lowerTriangularMatrix(){return this.L}};class nipals{constructor(_,_e={}){_=WrapperMatrix2D$1.checkMatrix(_);let{Y:tt}=_e;const{scaleScores:nt=!1,maxIterations:rt=1e3,terminationCriteria:it=1e-10}=_e;let st;if(tt){if(isAnyArray.isAnyArray(tt)&&typeof tt[0]=="number"?tt=Matrix$3.columnVector(tt):tt=WrapperMatrix2D$1.checkMatrix(tt),tt.rows!==_.rows)throw new Error("Y should have the same number of rows as X");st=tt.getColumnVector(0)}else st=_.getColumnVector(0);let ot=1,at,lt,ct,ht;for(let ut=0;ut<rt&&ot>it;ut++)ct=_.transpose().mmul(st).div(st.transpose().mmul(st).get(0,0)),ct=ct.div(ct.norm()),at=_.mmul(ct).div(ct.transpose().mmul(ct).get(0,0)),ut>0&&(ot=at.clone().sub(ht).pow(2).sum()),ht=at.clone(),tt?(lt=tt.transpose().mmul(at).div(at.transpose().mmul(at).get(0,0)),lt=lt.div(lt.norm()),st=tt.mmul(lt).div(lt.transpose().mmul(lt).get(0,0))):st=at;if(tt){let ut=_.transpose().mmul(at).div(at.transpose().mmul(at).get(0,0));ut=ut.div(ut.norm());let ft=_.clone().sub(at.clone().mmul(ut.transpose())),dt=st.transpose().mmul(at).div(at.transpose().mmul(at).get(0,0)),pt=tt.clone().sub(at.clone().mulS(dt.get(0,0)).mmul(lt.transpose()));this.t=at,this.p=ut.transpose(),this.w=ct.transpose(),this.q=lt,this.u=st,this.s=at.transpose().mmul(at),this.xResidual=ft,this.yResidual=pt,this.betas=dt}else this.w=ct.transpose(),this.s=at.transpose().mmul(at).sqrt(),nt?this.t=at.clone().div(this.s.get(0,0)):this.t=at,this.xResidual=_.sub(at.mmul(ct.transpose()))}}var AbstractMatrix_1=matrix$2.AbstractMatrix=AbstractMatrix$1,CHO$1=matrix$2.CHO=CholeskyDecomposition$1,CholeskyDecomposition_1=matrix$2.CholeskyDecomposition=CholeskyDecomposition$1,DistanceMatrix_1=matrix$2.DistanceMatrix=DistanceMatrix$1,EVD$1=matrix$2.EVD=EigenvalueDecomposition$1,EigenvalueDecomposition_1=matrix$2.EigenvalueDecomposition=EigenvalueDecomposition$1,LU$1=matrix$2.LU=LuDecomposition$1,LuDecomposition_1=matrix$2.LuDecomposition=LuDecomposition$1,Matrix_1=matrix$2.Matrix=Matrix$3,MatrixColumnSelectionView_1=matrix$2.MatrixColumnSelectionView=MatrixColumnSelectionView$1,MatrixColumnView_1=matrix$2.MatrixColumnView=MatrixColumnView$1,MatrixFlipColumnView_1=matrix$2.MatrixFlipColumnView=MatrixFlipColumnView$1,MatrixFlipRowView_1=matrix$2.MatrixFlipRowView=MatrixFlipRowView$1,MatrixRowSelectionView_1=matrix$2.MatrixRowSelectionView=MatrixRowSelectionView$1,MatrixRowView_1=matrix$2.MatrixRowView=MatrixRowView$1,MatrixSelectionView_1=matrix$2.MatrixSelectionView=MatrixSelectionView$1,MatrixSubView_1=matrix$2.MatrixSubView=MatrixSubView$1,MatrixTransposeView_1=matrix$2.MatrixTransposeView=MatrixTransposeView$2,NIPALS$1=matrix$2.NIPALS=nipals,Nipals$1=matrix$2.Nipals=nipals,QR$1=matrix$2.QR=QrDecomposition$1,QrDecomposition_1=matrix$2.QrDecomposition=QrDecomposition$1,SVD$1=matrix$2.SVD=SingularValueDecomposition$1,SingularValueDecomposition_1=matrix$2.SingularValueDecomposition=SingularValueDecomposition$1,SymmetricMatrix_1=matrix$2.SymmetricMatrix=SymmetricMatrix$1,WrapperMatrix1D_1=matrix$2.WrapperMatrix1D=WrapperMatrix1D$1,WrapperMatrix2D_1=matrix$2.WrapperMatrix2D=WrapperMatrix2D$1,correlation_1=matrix$2.correlation=correlation$1,covariance_1=matrix$2.covariance=covariance$1,_default=matrix$2.default=Matrix$3,determinant_1=matrix$2.determinant=determinant$1,inverse_1=matrix$2.inverse=inverse$1,linearDependencies_1=matrix$2.linearDependencies=linearDependencies$1,pseudoInverse_1=matrix$2.pseudoInverse=pseudoInverse$1,solve_1=matrix$2.solve=solve$1,wrap_1=matrix$2.wrap=wrap$1;const AbstractMatrix=AbstractMatrix_1,CHO=CHO$1,CholeskyDecomposition=CholeskyDecomposition_1,DistanceMatrix=DistanceMatrix_1,EVD=EVD$1,EigenvalueDecomposition=EigenvalueDecomposition_1,LU=LU$1,LuDecomposition=LuDecomposition_1,Matrix$2=Matrix_1,MatrixColumnSelectionView=MatrixColumnSelectionView_1,MatrixColumnView=MatrixColumnView_1,MatrixFlipColumnView=MatrixFlipColumnView_1,MatrixFlipRowView=MatrixFlipRowView_1,MatrixRowSelectionView=MatrixRowSelectionView_1,MatrixRowView=MatrixRowView_1,MatrixSelectionView=MatrixSelectionView_1,MatrixSubView=MatrixSubView_1,MatrixTransposeView$1=MatrixTransposeView_1,NIPALS=NIPALS$1,Nipals=Nipals$1,QR=QR$1,QrDecomposition=QrDecomposition_1,SVD=SVD$1,SingularValueDecomposition=SingularValueDecomposition_1,SymmetricMatrix=SymmetricMatrix_1,WrapperMatrix1D=WrapperMatrix1D_1,WrapperMatrix2D=WrapperMatrix2D_1,correlation=correlation_1,covariance=covariance_1,matrix=_default.Matrix?_default.Matrix:Matrix_1,determinant=determinant_1,inverse=inverse_1,linearDependencies=linearDependencies_1,pseudoInverse=pseudoInverse_1,solve=solve_1,wrap=wrap_1,matrix$1=Object.freeze(Object.defineProperty({__proto__:null,AbstractMatrix,CHO,CholeskyDecomposition,DistanceMatrix,EVD,EigenvalueDecomposition,LU,LuDecomposition,Matrix:Matrix$2,MatrixColumnSelectionView,MatrixColumnView,MatrixFlipColumnView,MatrixFlipRowView,MatrixRowSelectionView,MatrixRowView,MatrixSelectionView,MatrixSubView,MatrixTransposeView:MatrixTransposeView$1,NIPALS,Nipals,QR,QrDecomposition,SVD,SingularValueDecomposition,SymmetricMatrix,WrapperMatrix1D,WrapperMatrix2D,correlation,covariance,default:matrix,determinant,inverse,linearDependencies,pseudoInverse,solve,wrap},Symbol.toStringTag,{value:"Module"}));function getSeparatedKernel(et){const _=new SVD(et,{autoTranspose:!0});if(_.rank!==1)return null;const _e=Math.sqrt(_.s[0]),tt=_.U.to2DArray().map(rt=>rt[0]*_e),nt=_.V.to2DArray().map(rt=>rt[0]*_e);return[tt,nt]}function convolution(et,_={}){let{channels:_e,bitDepth:tt,normalize:nt=!1,divisor:rt=1,border:it="copy",algorithm:st="auto"}=_,ot={};tt&&(ot.bitDepth=tt);let at=Image$1.createFrom(this,ot);if(_e=validateArrayOfChannels(this,_e),st!=="separable")({kernel:et}=validateKernel(et));else if(!Array.isArray(et)||et.length!==2)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if(st==="auto"){let _t=getSeparatedKernel(et);_t!==null?(st="separable",et=_t):(et.length>9||et[0].length>9)&&this.width<=4096&&this.height<=4096?st="fft":st="direct"}let lt,ct;st==="separable"?(lt=Math.floor(et[0].length/2),ct=Math.floor(et[1].length/2)):(lt=Math.floor(et.length/2),ct=Math.floor(et[0].length/2));let ht=at.isClamped,ut=new Array(this.height*this.width),ft,dt,pt,mt,vt,yt;for(mt=0;mt<_e.length;mt++){for(vt=_e[mt],pt=0;pt<this.height;pt++)for(dt=0;dt<this.width;dt++)ft=pt*this.width+dt,ut[ft]=this.data[ft*this.channels+vt];if(st==="direct")yt=src$1.direct(ut,et,{rows:this.height,cols:this.width,normalize:nt,divisor:rt});else if(st==="separable"){if(yt=convolutionSeparable(ut,et,this.width,this.height),nt){rt=0;for(let _t=0;_t<et[0].length;_t++)for(let St=0;St<et[1].length;St++)rt+=et[0][_t]*et[1][St]}if(rt!==1)for(let _t=0;_t<yt.length;_t++)yt[_t]/=rt}else yt=src$1.fft(ut,et,{rows:this.height,cols:this.width,normalize:nt,divisor:rt});for(pt=0;pt<this.height;pt++)for(dt=0;dt<this.width;dt++)ft=pt*this.width+dt,ht?at.data[ft*this.channels+vt]=clamp(yt[ft],at):at.data[ft*this.channels+vt]=yt[ft]}if(this.alpha&&!_e.includes(this.channels))for(dt=this.components;dt<this.data.length;dt=dt+this.channels)at.data[dt]=this.data[dt];return it!=="periodic"&&at.setBorder({size:[ct,lt],algorithm:it}),at}function gradientFilter(et={}){let{direction:_="xy",border:_e="copy",kernelX:tt,kernelY:nt,channels:rt,bitDepth:it=this.bitDepth}=et;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),_){case"x":if(!tt)throw new Error("kernelX option is missing");return convolution.call(this,tt,{channels:rt,border:_e,bitDepth:it});case"y":if(!nt)throw new Error("kernelY option is missing");return convolution.call(this,nt,{channels:rt,border:_e,bitDepth:it});case"xy":{if(!tt)throw new Error("kernelX option is missing");if(!nt)throw new Error("kernelY option is missing");const st=convolution.call(this,tt,{channels:rt,border:_e,bitDepth:32}),ot=convolution.call(this,nt,{channels:rt,border:_e,bitDepth:32});return st.hypotenuse(ot,{bitDepth:it,channels:rt})}default:throw new Error(`Unknown parameter direction: ${_}`)}}function sobelFilter(et){return gradientFilter.call(this,Object.assign({},et,{kernelX:SOBEL_X,kernelY:SOBEL_Y}))}function scharrFilter(et){return gradientFilter.call(this,Object.assign({},et,{kernelX:SCHARR_X,kernelY:SCHARR_Y}))}var newArray_1=newArray;function newArray(et,_){et=et||0;for(var _e=new Array(et),tt=0;tt<et;tt++)_e[tt]=_;return _e}const newArray$1=getDefaultExportFromCjs(newArray_1);function level(et={}){let{algorithm:_="range",channels:_e,min:tt=this.min,max:nt=this.max}=et;switch(this.checkProcessable("level",{bitDepth:[8,16,32]}),_e=validateArrayOfChannels(this,{channels:_e}),_e.length!==this.channel&&(Array.isArray(tt)&&tt.length===this.channels&&(tt=tt.filter((rt,it)=>_e.includes(it))),Array.isArray(nt)&&nt.length===this.channels&&(nt=nt.filter((rt,it)=>_e.includes(it)))),_){case"range":tt<0&&(tt=0),nt>this.maxValue&&(nt=this.maxValue),Array.isArray(tt)||(tt=newArray$1(_e.length,tt)),Array.isArray(nt)||(nt=newArray$1(_e.length,nt)),processImage(this,tt,nt,_e);break;default:throw new Error(`level: algorithm not implement: ${_}`)}return this}function processImage(et,_,_e,tt){let nt=1e-5,rt=new Array(tt.length);for(let it=0;it<tt.length;it++)_[it]===0&&_e[it]===et.maxValue||_e[it]===_[it]?rt[it]=0:rt[it]=(et.maxValue+1-nt)/(_e[it]-_[it]),_[it]+=(.5-nt/2)/rt[it];for(let it=0;it<tt.length;it++){let st=tt[it];if(rt[it]!==0)for(let ot=0;ot<et.data.length;ot+=et.channels)et.data[ot+st]=Math.min(Math.max(0,(et.data[ot+st]-_[it])*rt[it]+.5|0),et.maxValue)}}var toString$1=Object.prototype.toString,isArrayType=function et(_){return toString$1.call(_).substr(-6,5)==="Array"};const isArray=getDefaultExportFromCjs(isArrayType);function checkNumberArray(et){if(isNaN(et)){if(et instanceof Image$1)return et.data;if(!isArray(et))throw new Error("checkNumberArray: the value should be either a number, array or Image");return et}else{if(et<=0)throw new Error("checkNumberArray: the value must be greater than 0");return et}}function add(et,_={}){let{channels:_e}=_;if(this.checkProcessable("add",{bitDepth:[8,16]}),_e=validateArrayOfChannels(this,{channels:_e}),et=checkNumberArray(et),isNaN(et)){if(this.data.length!==et.length)throw new Error("add: the data size is different");for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.max(0,Math.min(this.maxValue,this.data[rt+nt]+et[rt+nt]>>0))}}else for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.min(this.maxValue,this.data[rt+nt]+et>>0)}return this}function subtract(et,_={}){let{channels:_e}=_;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),_e=validateArrayOfChannels(this,{channels:_e}),et=checkNumberArray(et),isNaN(et)){if(this.data.length!==et.length)throw new Error("subtract: the data size is different");for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.max(0,Math.min(this.maxValue,this.data[rt+nt]-et[rt+nt]>>0))}}else for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.max(0,this.data[rt+nt]-et>>0)}return this}function subtractImage(et,_={}){let{channels:_e,absolute:tt=!1}=_;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==et.width||this.height!==et.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==et.alpha||this.bitDepth!==et.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==et.channels)throw new Error("subtractImage: both images must have the same number of channels");let nt=this.clone();_e=validateArrayOfChannels(this,{channels:_e});for(let rt=0;rt<_e.length;rt++){let it=_e[rt];for(let st=it;st<this.data.length;st+=this.channels){let ot=this.data[st]-et.data[st];tt?nt.data[st]=Math.abs(ot):nt.data[st]=Math.max(ot,0)}}return nt}function hypotenuse(et,_={}){let{bitDepth:_e=this.bitDepth,channels:tt}=_;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==et.width||this.height!==et.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==et.alpha||this.bitDepth!==et.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==et.channels)throw new Error("hypotenuse: both images must have the same number of channels");let nt=Image$1.createFrom(this,{bitDepth:_e});tt=validateArrayOfChannels(this,{channels:tt});let rt=nt.isClamped;for(let it=0;it<tt.length;it++){let st=tt[it];for(let ot=st;ot<this.data.length;ot+=this.channels){let at=Math.hypot(this.data[ot],et.data[ot]);rt?nt.data[ot]=Math.min(Math.max(Math.round(at),0),nt.maxValue):nt.data[ot]=at}}return nt}function multiply(et,_={}){let{channels:_e}=_;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),et<=0)throw new Error("multiply: the value must be greater than 0");if(_e=validateArrayOfChannels(this,{channels:_e}),et=checkNumberArray(et),isNaN(et)){if(this.data.length!==et.length)throw new Error("multiply: the data size is different");for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.max(0,Math.min(this.maxValue,this.data[rt+nt]*et[rt+nt]>>0))}}else for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.min(this.maxValue,this.data[rt+nt]*et>>0)}return this}function divide(et,_={}){let{channels:_e}=_;if(this.checkProcessable("divide",{bitDepth:[8,16]}),_e=validateArrayOfChannels(this,{channels:_e}),et=checkNumberArray(et),isNaN(et)){if(this.data.length!==et.length)throw new Error("divide: the: the data size is different");for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.max(0,Math.min(this.maxValue,this.data[rt+nt]/et[rt+nt]>>0))}}else for(let tt=0;tt<_e.length;tt++){let nt=_e[tt];for(let rt=0;rt<this.data.length;rt+=this.channels)this.data[rt+nt]=Math.min(this.maxValue,this.data[rt+nt]/et>>0)}return this}class BaseRegression{constructor(){if(new.target===BaseRegression)throw new Error("BaseRegression must be subclassed")}predict(_){if(typeof _=="number")return this._predict(_);if(isAnyArray$1(_)){const _e=[];for(let tt=0;tt<_.length;tt++)_e.push(this._predict(_[tt]));return _e}else throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(_,_e){if(!isAnyArray$1(_)||!isAnyArray$1(_e)||_.length!==_e.length)throw new Error("x and y must be arrays of the same length");const tt=_.length,nt=new Array(tt);for(let ut=0;ut<tt;ut++)nt[ut]=this._predict(_[ut]);let rt=0,it=0,st=0,ot=0,at=0,lt=0,ct=0;for(let ut=0;ut<tt;ut++)rt+=nt[ut],it+=_e[ut],at+=nt[ut]*nt[ut],lt+=_e[ut]*_e[ut],ct+=nt[ut]*_e[ut],_e[ut]!==0&&(st+=(_e[ut]-nt[ut])*(_e[ut]-nt[ut])/_e[ut]),ot+=(_e[ut]-nt[ut])*(_e[ut]-nt[ut]);const ht=(tt*ct-rt*it)/Math.sqrt((tt*at-rt*rt)*(tt*lt-it*it));return{r:ht,r2:ht*ht,chi2:st,rmsd:Math.sqrt(ot/tt)}}}const require$$0$1=getAugmentedNamespace(matrix$1);function squaredEuclidean$4(et,_){let _e=0;for(let tt=0;tt<et.length;tt++)_e+=(et[tt]-_[tt])*(et[tt]-_[tt]);return _e}function euclidean$2(et,_){return Math.sqrt(squaredEuclidean$4(et,_))}const euclidean$3=Object.freeze(Object.defineProperty({__proto__:null,euclidean:euclidean$2,squaredEuclidean:squaredEuclidean$4},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(euclidean$3),{squaredEuclidean:squaredEuclidean$3}=require$$0,defaultOptions$b={sigma:1};let GaussianKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$b,_),this.sigma=_.sigma,this.divisor=2*_.sigma*_.sigma}compute(_,_e){const tt=squaredEuclidean$3(_,_e);return Math.exp(-tt/this.divisor)}};var gaussianKernel=GaussianKernel$1;const defaultOptions$a={degree:1,constant:1,scale:1};let PolynomialKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$a,_),this.degree=_.degree,this.constant=_.constant,this.scale=_.scale}compute(_,_e){for(var tt=0,nt=0;nt<_.length;nt++)tt+=_[nt]*_e[nt];return Math.pow(this.scale*tt+this.constant,this.degree)}};var polynomialKernel=PolynomialKernel$1;const defaultOptions$9={alpha:.01,constant:-Math.E};let SigmoidKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$9,_),this.alpha=_.alpha,this.constant=_.constant}compute(_,_e){for(var tt=0,nt=0;nt<_.length;nt++)tt+=_[nt]*_e[nt];return Math.tanh(this.alpha*tt+this.constant)}};var sigmoidKernel=SigmoidKernel$1;const defaultOptions$8={sigma:1,degree:1};let ANOVAKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$8,_),this.sigma=_.sigma,this.degree=_.degree}compute(_,_e){for(var tt=0,nt=Math.min(_.length,_e.length),rt=1;rt<=nt;++rt)tt+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(_[rt-1],rt)-Math.pow(_e[rt-1],rt),2)),this.degree);return tt}};var anovaKernel=ANOVAKernel$1;const{squaredEuclidean:squaredEuclidean$2}=require$$0,defaultOptions$7={sigma:1};let CauchyKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$7,_),this.sigma=_.sigma}compute(_,_e){return 1/(1+squaredEuclidean$2(_,_e)/(this.sigma*this.sigma))}};var cauchyKernel=CauchyKernel$1;const{euclidean:euclidean$1}=require$$0,defaultOptions$6={sigma:1};let ExponentialKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$6,_),this.sigma=_.sigma,this.divisor=2*_.sigma*_.sigma}compute(_,_e){const tt=euclidean$1(_,_e);return Math.exp(-tt/this.divisor)}};var exponentialKernel=ExponentialKernel$1;class HistogramIntersectionKernel{compute(_,_e){for(var tt=Math.min(_.length,_e.length),nt=0,rt=0;rt<tt;++rt)nt+=Math.min(_[rt],_e[rt]);return nt}}var histogramIntersectionKernel=HistogramIntersectionKernel;const{euclidean}=require$$0,defaultOptions$5={sigma:1};let LaplacianKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$5,_),this.sigma=_.sigma}compute(_,_e){const tt=euclidean(_,_e);return Math.exp(-tt/this.sigma)}};var laplacianKernel=LaplacianKernel$1;const{squaredEuclidean:squaredEuclidean$1}=require$$0,defaultOptions$4={constant:1};let MultiquadraticKernel$1=class{constructor(_){_=Object.assign({},defaultOptions$4,_),this.constant=_.constant}compute(_,_e){return Math.sqrt(squaredEuclidean$1(_,_e)+this.constant*this.constant)}};var multiquadraticKernel=MultiquadraticKernel$1;const{squaredEuclidean}=require$$0,defaultOptions$3={constant:1};class RationalQuadraticKernel{constructor(_){_=Object.assign({},defaultOptions$3,_),this.constant=_.constant}compute(_,_e){const tt=squaredEuclidean(_,_e);return 1-tt/(tt+this.constant)}}var rationalQuadraticKernel=RationalQuadraticKernel;const{Matrix:Matrix$1,MatrixTransposeView}=require$$0$1,GaussianKernel=gaussianKernel,PolynomialKernel=polynomialKernel,SigmoidKernel=sigmoidKernel,ANOVAKernel=anovaKernel,CauchyKernel=cauchyKernel,ExponentialKernel=exponentialKernel,HistogramKernel=histogramIntersectionKernel,LaplacianKernel=laplacianKernel,MultiquadraticKernel=multiquadraticKernel,RationalKernel=rationalQuadraticKernel,kernelType={gaussian:GaussianKernel,rbf:GaussianKernel,polynomial:PolynomialKernel,poly:PolynomialKernel,anova:ANOVAKernel,cauchy:CauchyKernel,exponential:ExponentialKernel,histogram:HistogramKernel,min:HistogramKernel,laplacian:LaplacianKernel,multiquadratic:MultiquadraticKernel,rational:RationalKernel,sigmoid:SigmoidKernel,mlp:SigmoidKernel};class Kernel{constructor(_,_e){if(this.kernelType=_,_!=="linear")if(typeof _=="string"){_=_.toLowerCase();var tt=kernelType[_];if(tt)this.kernelFunction=new tt(_e);else throw new Error(`unsupported kernel type: ${_}`)}else if(typeof _=="object"&&typeof _.compute=="function")this.kernelFunction=_;else throw new TypeError("first argument must be a valid kernel type or instance")}compute(_,_e){if(_=Matrix$1.checkMatrix(_),_e===void 0?_e=_:_e=Matrix$1.checkMatrix(_e),this.kernelType==="linear")return _.mmul(new MatrixTransposeView(_e));const tt=new Matrix$1(_.rows,_e.rows);if(_===_e)for(let nt=0;nt<_.rows;nt++)for(let rt=nt;rt<_.rows;rt++){const it=this.kernelFunction.compute(_.getRow(nt),_.getRow(rt));tt.set(nt,rt,it),tt.set(rt,nt,it)}else for(let nt=0;nt<_.rows;nt++)for(let rt=0;rt<_e.rows;rt++)tt.set(nt,rt,this.kernelFunction.compute(_.getRow(nt),_e.getRow(rt)));return tt}}var kernel=Kernel;const Kernel$1=getDefaultExportFromCjs(kernel),defaultOptions$2={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class KernelRidgeRegression extends BaseRegression{constructor(_,_e,tt){if(super(),_===!0)this.alpha=_e.alpha,this.inputs=_e.inputs,this.kernelType=_e.kernelType,this.kernelOptions=_e.kernelOptions,this.kernel=new Kernel$1(_e.kernelType,_e.kernelOptions);else{_=Matrix$2.checkMatrix(_),tt=Object.assign({},defaultOptions$2,tt);const nt=new Kernel$1(tt.kernelType,tt.kernelOptions),rt=nt.compute(_),it=_.rows;rt.add(Matrix$2.eye(it,it).mul(tt.lambda)),this.alpha=solve(rt,_e),this.inputs=_,this.kernelType=tt.kernelType,this.kernelOptions=tt.kernelOptions,this.kernel=nt}}_predict(_){return this.kernel.compute([_],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(_){if(_.name!=="kernelRidgeRegression")throw new TypeError("not a KRR model");return new KernelRidgeRegression(!0,_)}}function background$1(et,_,_e){const tt=new KernelRidgeRegression(et,_,_e),nt=new Array(this.size);for(let st=0;st<this.width;st++)for(let ot=0;ot<this.height;ot++)nt[ot*this.width+st]=[st,ot];const rt=tt.predict(nt),it=Image$1.createFrom(this);for(let st=0;st<this.size;st++)it.data[st]=Math.min(this.maxValue,Math.max(0,rt[st][0]));return it}function dilate(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),_.columns%2===0||_.rows%2===0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let tt=!0;e:for(const rt of _)for(const it of rt)if(it!==1){tt=!1;break e}let nt=this;for(let rt=0;rt<_e;rt++)if(this.bitDepth===1)if(tt){const it=nt.clone();nt=dilateOnceBinaryOnlyOnes(nt,it,_.length,_[0].length)}else{const it=Image$1.createFrom(nt);nt=dilateOnceBinary(nt,it,_)}else if(tt){const it=Image$1.createFrom(nt);nt=dilateOnceGreyOnlyOnes(nt,it,_.length,_[0].length)}else{const it=Image$1.createFrom(nt);nt=dilateOnceGrey(nt,it,_)}return nt}function dilateOnceGrey(et,_,_e){const tt=_e.length,nt=_e[0].length;let rt=(tt-1)/2,it=(nt-1)/2;for(let st=0;st<et.height;st++)for(let ot=0;ot<et.width;ot++){let at=0;for(let lt=0;lt<nt;lt++)for(let ct=0;ct<tt;ct++){if(_e[ct][lt]!==1)continue;let ht=ct-rt+ot,ut=lt-it+st;if(ht<0||ut<0||ht>=et.width||ut>=et.height)continue;const ft=et.getValueXY(ht,ut,0);ft>at&&(at=ft)}_.setValueXY(ot,st,0,at)}return _}function dilateOnceGreyOnlyOnes(et,_,_e,tt){const nt=(_e-1)/2,rt=(tt-1)/2,it=[];for(let st=0;st<et.width;st++)it.push(0);for(let st=0;st<et.height;st++){for(let ot=0;ot<et.width;ot++){let at=0;for(let lt=Math.max(0,st-rt);lt<Math.min(et.height,st+rt+1);lt++){const ct=et.getValueXY(ot,lt,0);ct>at&&(at=ct)}it[ot]=at}for(let ot=0;ot<et.width;ot++){let at=0;for(let lt=Math.max(0,ot-nt);lt<Math.min(et.width,ot+nt+1);lt++)it[lt]>at&&(at=it[lt]);_.setValueXY(ot,st,0,at)}}return _}function dilateOnceBinary(et,_,_e){const tt=_e.length,nt=_e[0].length;let rt=(tt-1)/2,it=(nt-1)/2;for(let st=0;st<et.height;st++)for(let ot=0;ot<et.width;ot++){let at=0;e:for(let lt=0;lt<nt;lt++)for(let ct=0;ct<tt;ct++){if(_e[ct][lt]!==1)continue;let ht=ct-rt+ot,ut=lt-it+st;if(ut<0||ht<0||ht>=et.width||ut>=et.height)continue;if(et.getBitXY(ht,ut)===1){at=1;break e}}at===1&&_.setBitXY(ot,st)}return _}function dilateOnceBinaryOnlyOnes(et,_,_e,tt){const nt=(_e-1)/2,rt=(tt-1)/2,it=[];for(let st=0;st<et.width;st++)it.push(1);for(let st=0;st<et.height;st++){for(let ot=0;ot<et.width;ot++){it[ot]=0;for(let at=Math.max(0,st-rt);at<Math.min(et.height,st+rt+1);at++)if(et.getBitXY(ot,at)===1){it[ot]=1;break}}for(let ot=0;ot<et.width;ot++)if(_.getBitXY(ot,st)!==1){for(let at=Math.max(0,ot-nt);at<Math.min(et.width,ot+nt+1);at++)if(it[at]===1){_.setBitXY(ot,st);break}}}return _}function erode(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),_.columns%2===0||_.rows%2===0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let tt=!0;e:for(const rt of _)for(const it of rt)if(it!==1){tt=!1;break e}let nt=this;for(let rt=0;rt<_e;rt++)if(this.bitDepth===1)if(tt){const it=nt.clone();nt=erodeOnceBinaryOnlyOnes(nt,it,_.length,_[0].length)}else{const it=Image$1.createFrom(nt);nt=erodeOnceBinary(nt,it,_)}else if(tt){const it=Image$1.createFrom(nt);nt=erodeOnceGreyOnlyOnes(nt,it,_.length,_[0].length)}else{const it=Image$1.createFrom(nt);nt=erodeOnceGrey(nt,it,_)}return nt}function erodeOnceGrey(et,_,_e){const tt=_e.length,nt=_e[0].length;let rt=(tt-1)/2,it=(nt-1)/2;for(let st=0;st<et.height;st++)for(let ot=0;ot<et.width;ot++){let at=et.maxValue;for(let lt=0;lt<nt;lt++)for(let ct=0;ct<tt;ct++){if(_e[ct][lt]!==1)continue;let ht=ct-rt+ot,ut=lt-it+st;if(ht<0||ut<0||ht>=et.width||ut>=et.height)continue;const ft=et.getValueXY(ht,ut,0);ft<at&&(at=ft)}_.setValueXY(ot,st,0,at)}return _}function erodeOnceGreyOnlyOnes(et,_,_e,tt){const nt=(_e-1)/2,rt=(tt-1)/2,it=[];for(let st=0;st<et.width;st++)it.push(0);for(let st=0;st<et.height;st++){for(let ot=0;ot<et.width;ot++){let at=et.maxValue;for(let lt=Math.max(0,st-rt);lt<Math.min(et.height,st+rt+1);lt++){const ct=et.getValueXY(ot,lt,0);ct<at&&(at=ct)}it[ot]=at}for(let ot=0;ot<et.width;ot++){let at=et.maxValue;for(let lt=Math.max(0,ot-nt);lt<Math.min(et.width,ot+nt+1);lt++)it[lt]<at&&(at=it[lt]);_.setValueXY(ot,st,0,at)}}return _}function erodeOnceBinary(et,_,_e){const tt=_e.length,nt=_e[0].length;let rt=(tt-1)/2,it=(nt-1)/2;for(let st=0;st<et.height;st++)for(let ot=0;ot<et.width;ot++){let at=1;e:for(let lt=0;lt<nt;lt++)for(let ct=0;ct<tt;ct++){if(_e[ct][lt]!==1)continue;let ht=ct-rt+ot,ut=lt-it+st;if(ut<0||ht<0||ht>=et.width||ut>=et.height)continue;if(et.getBitXY(ht,ut)===0){at=0;break e}}at===1&&_.setBitXY(ot,st)}return _}function erodeOnceBinaryOnlyOnes(et,_,_e,tt){const nt=(_e-1)/2,rt=(tt-1)/2,it=[];for(let st=0;st<et.width;st++)it.push(0);for(let st=0;st<et.height;st++){for(let ot=0;ot<et.width;ot++){it[ot]=1;for(let at=Math.max(0,st-rt);at<Math.min(et.height,st+rt+1);at++)if(et.getBitXY(ot,at)===0){it[ot]=0;break}}for(let ot=0;ot<et.width;ot++)if(_.getBitXY(ot,st)!==0){for(let at=Math.max(0,ot-nt);at<Math.min(et.width,ot+nt+1);at++)if(it[at]===0){_.clearBitXY(ot,st);break}}}return _}function open(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),_.columns%2===0||_.rows%2===0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let tt=this;for(let nt=0;nt<_e;nt++)tt=tt.erode({kernel:_}),tt=tt.dilate({kernel:_});return tt}function close(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),_.columns%2===0||_.rows%2===0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let tt=this;for(let nt=0;nt<_e;nt++)tt=tt.dilate({kernel:_}).erode({kernel:_});return tt}function topHat(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),_.length%2===0||_[0].length%2===0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let tt=this;for(let nt=0;nt<_e;nt++)tt=tt.open({kernel:_}).subtractImage(tt,{absolute:!0});return tt}function blackHat(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),_.columns%2===0||_.rows%2===0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let tt=this;for(let nt=0;nt<_e;nt++)tt=tt.close({kernel:_}).subtractImage(tt,{absolute:!0});return tt}function morphologicalGradient(et={}){let{kernel:_=[[1,1,1],[1,1,1],[1,1,1]],iterations:_e=1}=et;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),_.columns%2===0||_.rows%2===0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let tt=this;for(let nt=0;nt<_e;nt++){let rt=tt.dilate({kernel:_}),it=tt.erode({kernel:_});tt=rt.subtractImage(it,{absolute:!0})}return tt}function order4Points(et){let _=0,_e=0,tt=0,nt=0,rt=et[0][0],it=0;for(let at=1;at<et.length;at++)et[at][0]<rt&&(rt=et[at][0],it=at);let st=et[(it+1)%et.length][0],ot=(it+1)%et.length;for(let at=1;at<et.length;at++)et[at][0]<st&&at!==it&&(st=et[at][0],ot=at);return et[ot][1]<et[it][1]?(_=et[ot],nt=et[it],it!==(ot+1)%4?(_e=et[(ot+1)%4],tt=et[(ot+2)%4]):(_e=et[(ot+2)%4],tt=et[(ot+3)%4])):(nt=et[ot],_=et[it],ot!==(it+1)%4?(_e=et[(it+1)%4],tt=et[(it+2)%4]):(_e=et[(it+2)%4],tt=et[(it+3)%4])),[_,_e,tt,nt]}function distance2Points(et,_){return Math.sqrt(Math.pow(et[0]-_[0],2)+Math.pow(et[1]-_[1],2))}function crossVect(et,_){return[et[1]*_[2]-et[2]*_[1],et[2]*_[0]-et[0]*_[2],et[0]*_[1]-et[1]*_[0]]}function dotVect(et,_){return et[0]*_[0]+et[1]*_[1]+et[2]*_[2]}function computeWidthAndHeigth(et,_,_e,tt,nt,rt){let it=Math.max(distance2Points(et,_),distance2Points(tt,_e)),st=Math.max(distance2Points(et,tt),distance2Points(_,_e)),ot=0,at=0,lt=Math.ceil(nt/2),ct=Math.ceil(rt/2),ht=it/st,ut=[et[0],et[1],1],ft=[_[0],_[1],1],dt=[tt[0],tt[1],1],pt=[_e[0],_e[1],1],mt=dotVect(crossVect(ut,pt),dt)/dotVect(crossVect(ft,pt),dt),vt=dotVect(crossVect(ut,pt),ft)/dotVect(crossVect(dt,pt),ft),yt=[mt*ft[0]-ut[0],mt*ft[1]-ut[1],mt*ft[2]-ut[2]],_t=[vt*dt[0]-ut[0],vt*dt[1]-ut[1],vt*dt[2]-ut[2]],St=yt[0],bt=yt[1],Et=yt[2],Mt=_t[0],Tt=_t[1],wt=_t[2],Ct=1/(Et*wt)*(St*Mt-(St*wt+Et*Mt)*lt+Et*wt*lt*lt+(bt*Tt-(bt*wt+Et*Tt)*ct+Et*wt*ct*ct));Ct>=0?Ct=Math.sqrt(Ct):Ct=Math.sqrt(-Ct);let Rt=new Matrix$2([[Ct,0,lt],[0,Ct,ct],[0,0,1]]),It=Rt.transpose(),Dt=inverse(It),Ft=inverse(Rt),$t=Matrix$2.rowVector(yt),Yt=Matrix$2.rowVector(_t),Lt=Math.sqrt(dotVect($t.mmul(Dt).mmul(Ft).to1DArray(),yt)/dotVect(Yt.mmul(Dt).mmul(Ft).to1DArray(),_t));return Lt===0||ht===0?(ot=Math.ceil(it),at=Math.ceil(st)):Lt<ht?(ot=Math.ceil(it),at=Math.ceil(ot/Lt)):(at=Math.ceil(st),ot=Math.ceil(Lt*at)),[ot,at]}function projectionPoint(et,_,_e,tt,nt,rt,it,st,ot,at,lt,ct){let[ht,ut]=[(_e*et+tt*_+nt)/(ot*et+at*_+1),(rt*et+it*_+st)/(ot*et+at*_+1)];return lt.getValueXY(Math.floor(ht),Math.floor(ut),ct)}function warpingFourPoints(et,_={}){let{calculateRatio:_e=!0}=_;if(et.length!==4)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${et.length} elements`);let[tt,nt,rt,it]=et,st=[tt,nt,rt,it],[ot,at,lt,ct]=order4Points(st),ht,ut;_e?[ht,ut]=computeWidthAndHeigth(ot,at,lt,ct,this.width,this.height):(ht=Math.ceil(Math.max(distance2Points(ot,at),distance2Points(ct,lt))),ut=Math.ceil(Math.max(distance2Points(ot,ct),distance2Points(at,lt))));let ft=Image$1.createFrom(this,{width:ht,height:ut}),[dt,pt]=ot,[mt,vt]=at,[yt,_t]=lt,[St,bt]=ct,[Et,Mt]=[0,0],[Tt,wt]=[0,ht-1],[Ct,Rt]=[ut-1,ht-1],[It,Dt]=[ut-1,0],Ft=new Matrix$2([[Et,Mt,1,0,0,0,-Et*dt,-Mt*dt],[Tt,wt,1,0,0,0,-Tt*mt,-wt*mt],[Ct,Rt,1,0,0,0,-Ct*yt,-Mt*yt],[It,Dt,1,0,0,0,-It*St,-Dt*St],[0,0,0,Et,Mt,1,-Et*pt,-Mt*pt],[0,0,0,Tt,wt,1,-Tt*vt,-wt*vt],[0,0,0,Ct,Rt,1,-Ct*_t,-Rt*_t],[0,0,0,It,Dt,1,-It*bt,-Dt*bt]]),$t=Matrix$2.columnVector([dt,mt,yt,St,pt,vt,_t,bt]),Lt=new SingularValueDecomposition(Ft).solve($t),[Ot,Nt,zt,Ht,qt,Gt,Xt,Zt]=Lt.to1DArray(),Qt=new Matrix$2(ut,ht);for(let un=0;un<this.channels;un++){for(let wn=0;wn<ut;wn++)for(let Tn=0;Tn<ht;Tn++)Qt.set(wn,Tn,projectionPoint(wn,Tn,Ot,Nt,zt,Ht,qt,Gt,Xt,Zt,this,un));ft.setMatrix(Qt,{channel:un})}return ft}function crop(et={}){let{x:_=0,y:_e=0,width:tt=this.width-_,height:nt=this.height-_e}=et;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),_=Math.round(_),_e=Math.round(_e),tt=Math.round(tt),nt=Math.round(nt),_>this.width-1||_e>this.height-1)throw new RangeError(`crop: origin (x:${_}, y:${_e}) out of range (${this.width-1}; ${this.height-1})`);if(tt<=0||nt<=0)throw new RangeError(`crop: width and height (width:${tt}; height:${nt}) must be positive numbers`);if(_<0||_e<0)throw new RangeError(`crop: x and y (x:${_}, y:${_e}) must be positive numbers`);if(tt>this.width-_||nt>this.height-_e)throw new RangeError(`crop: (x: ${_}, y:${_e}, width:${tt}, height:${nt}) size is out of range`);let rt=this;if(this.bitDepth===1){const it=new Image$1(tt,nt,{kind:"BINARY",parent:this});rt=cropBinary(this,it,_,_e,tt,nt)}else{const it=Image$1.createFrom(this,{width:tt,height:nt,position:[_,_e]});rt=cropDefault(this,it,_,_e,tt,nt)}return rt}function cropDefault(et,_,_e,tt,nt,rt){let it=nt*et.channels,st=tt+rt,ot=0,at=_e*et.channels;for(let lt=tt;lt<st;lt++){let ct=lt*et.width*et.channels+at,ht=ct+it;for(;ct<ht;ct++)_.data[ot++]=et.data[ct]}return _}function cropBinary(et,_,_e,tt,nt,rt){let it=nt*et.channels,st=tt+rt,ot=0,at=_e*et.channels;for(let lt=tt;lt<st;lt++){let ct=lt*et.width*et.channels+at,ht=ct+it;for(;ct<ht;ct++)et.getBit(ct)&&_.setBit(ot),++ot}return _}function cropAlpha(et={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:_=this.maxValue}=et;let _e=findLeft(this,_,this.components);if(_e===-1)throw new Error("Could not find new dimensions. Threshold may be too high.");let tt=findTop(this,_,this.components,_e),nt=findBottom(this,_,this.components,_e),rt=findRight(this,_,this.components,_e,tt,nt);return this.crop({x:_e,y:tt,width:rt-_e+1,height:nt-tt+1})}function findLeft(et,_,_e){for(let tt=0;tt<et.width;tt++)for(let nt=0;nt<et.height;nt++)if(et.getValueXY(tt,nt,_e)>=_)return tt;return-1}function findTop(et,_,_e,tt){for(let nt=0;nt<et.height;nt++)for(let rt=tt;rt<et.width;rt++)if(et.getValueXY(rt,nt,_e)>=_)return nt;return-1}function findBottom(et,_,_e,tt){for(let nt=et.height-1;nt>=0;nt--)for(let rt=tt;rt<et.width;rt++)if(et.getValueXY(rt,nt,_e)>=_)return nt;return-1}function findRight(et,_,_e,tt,nt,rt){for(let it=et.width-1;it>=tt;it--)for(let st=nt;st<=rt;st++)if(et.getValueXY(it,st,_e)>=_)return it;return-1}function getFactor(et){if(typeof et=="string"){const _=et[et.length-1];et=parseFloat(et),_==="%"&&(et/=100)}return et}function getThreshold$1(et,_){if(!_)throw Error("getThreshold : the maxValue should be specified");if(typeof et=="string"){if(et[et.length-1]!=="%")throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(et)/100*_}else{if(typeof et=="number")return et<1?et*_:et;throw Error("getThreshold : the value is not valid")}}function factorDimensions(et,_,_e){et=getFactor(et);let tt=Math.round(et*_),nt=Math.round(et*_e);return tt<=0&&(tt=1),nt<=0&&(nt=1),{width:tt,height:nt}}function checkRow(et,_){if(_<0||_>=et.height)throw new RangeError(`row must be included between 0 and ${et.height-1}. Current value: ${_}`)}function checkColumn(et,_){if(_<0||_>=et.width)throw new RangeError(`column must be included between 0 and ${et.width-1}. Current value: ${_}`)}function checkChannel(et,_){if(_<0||_>=et.channels)throw new RangeError(`channel must be included between 0 and ${et.channels-1}. Current value: ${_}`)}const validInterpolations={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function checkInterpolation(et){if(typeof et!="string")throw new TypeError("interpolation must be a string");if(et=et.toLowerCase(),!validInterpolations[et])throw new RangeError(`invalid interpolation algorithm: ${et}`);return validInterpolations[et]}function nearestNeighbor(et,_,_e){const tt=this.width/_,nt=this.height/_e;if(this.bitDepth>1)for(let rt=0;rt<_;rt++){const it=Math.floor((rt+.5)*tt);for(let st=0;st<_e;st++){const ot=Math.floor((st+.5)*nt);for(let at=0;at<this.channels;at++)et.setValueXY(rt,st,at,this.getValueXY(it,ot,at))}}else for(let rt=0;rt<_;rt++){const it=Math.floor((rt+.5)*tt);for(let st=0;st<_e;st++){const ot=Math.floor((st+.5)*nt);this.getBitXY(it,ot)&&et.setBitXY(rt,st)}}}function resize(et={}){const{factor:_=1,interpolation:_e=validInterpolations.nearestneighbor,preserveAspectRatio:tt=!0}=et,nt=checkInterpolation(_e);let rt=et.width,it=et.height;if(rt||(it&&tt?rt=Math.round(it*(this.width/this.height)):rt=this.width),it||(tt?it=Math.round(rt*(this.height/this.width)):it=this.height),{width:rt,height:it}=factorDimensions(_,rt,it),rt===this.width&&it===this.height){const lt=this.clone();return lt.position=[0,0],lt}let st=Math.round((this.width-rt)/2),ot=Math.round((this.height-it)/2);const at=Image$1.createFrom(this,{width:rt,height:it,position:[st,ot]});switch(nt){case validInterpolations.nearestneighbor:nearestNeighbor.call(this,at,rt,it);break;default:throw new Error(`unsupported resize interpolation: ${nt}`)}return at}function hsv(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let et=Image$1.createFrom(this,{colorModel:HSV}),_=0,_e=this.data;for(let tt=0;tt<_e.length;tt+=this.channels){let nt=_e[tt],rt=_e[tt+1],it=_e[tt+2],st=Math.min(nt,rt,it),ot=Math.max(nt,rt,it),at=ot-st,lt=0,ct=ot===0?0:at/ot,ht=ot;if(ot!==st){switch(ot){case nt:lt=(rt-it)/at+(rt<it?6:0);break;case rt:lt=(it-nt)/at+2;break;case it:lt=(nt-rt)/at+4;break;default:throw new Error("unreachable")}lt/=6}et.data[_++]=lt*this.maxValue,et.data[_++]=ct*this.maxValue,et.data[_++]=ht,this.alpha&&(et.data[_++]=_e[tt+3])}return et}function hsl$1(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let et=Image$1.createFrom(this,{colorModel:HSL}),_=Math.floor(this.maxValue/2),_e=0,tt=this.data;for(let nt=0;nt<tt.length;nt+=this.channels){let rt=tt[nt],it=tt[nt+1],st=tt[nt+2],ot=Math.max(rt,it,st),at=Math.min(rt,it,st),lt=0,ct=0,ht=(ot+at)/2;if(ot!==at){let ut=ot-at;switch(ct=ht>_?ut/(2-ot-at):ut/(ot+at),ot){case rt:lt=(it-st)/ut+(it<st?6:0);break;case it:lt=(st-rt)/ut+2;break;case st:lt=(rt-it)/ut+4;break;default:throw new Error("unreachable")}lt/=6}et.data[_e++]=lt*this.maxValue,et.data[_e++]=ct*this.maxValue,et.data[_e++]=ht,this.alpha&&(et.data[_e++]=tt[nt+3])}return et}function cmyk(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let et=Image$1.createFrom(this,{components:4,colorModel:CMYK$1}),_=0,_e=this.data;for(let tt=0;tt<_e.length;tt+=this.channels){let nt=_e[tt],rt=_e[tt+1],it=_e[tt+2],st=Math.min(this.maxValue-nt,this.maxValue-rt,this.maxValue-it),ot=(this.maxValue-nt-st)/(1-st/this.maxValue),at=(this.maxValue-rt-st)/(1-st/this.maxValue),lt=(this.maxValue-it-st)/(1-st/this.maxValue);et.data[_++]=Math.round(ot),et.data[_++]=Math.round(at),et.data[_++]=Math.round(lt),et.data[_++]=Math.round(st),this.alpha&&(et.data[_++]=_e[tt+3])}return et}function rgba8(){return new Image$1(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const methods$1={luma709(et,_,_e){return et*6966+_*23436+_e*2366>>15},luma601(et,_,_e){return et*9798+_*19235+_e*3735>>15},maximum(et,_,_e){return Math.max(et,_,_e)},minimum(et,_,_e){return Math.min(et,_,_e)},average(et,_,_e){return(et+_+_e)/3>>0},minmax(et,_,_e){return(Math.max(et,_,_e)+Math.min(et,_,_e))/2},red(et){return et},green(et,_){return _},blue(et,_,_e){return _e},cyan(et,_,_e,tt){let nt=methods$1.black(et,_,_e,tt);return(tt.maxValue-et-nt)/(1-nt/tt.maxValue)>>0},magenta(et,_,_e,tt){let nt=methods$1.black(et,_,_e,tt);return(tt.maxValue-_-nt)/(1-nt/tt.maxValue)>>0},yellow(et,_,_e,tt){let nt=methods$1.black(et,_,_e,tt);return(tt.maxValue-_e-nt)/(1-nt/tt.maxValue)>>0},black(et,_,_e,tt){return Math.min(tt.maxValue-et,tt.maxValue-_,tt.maxValue-_e)},hue(et,_,_e,tt){let nt=methods$1.min(et,_,_e),rt=methods$1.max(et,_,_e);if(rt===nt)return 0;let it=0,st=rt-nt;switch(rt){case et:it=(_-_e)/st+(_<_e?6:0);break;case _:it=(_e-et)/st+2;break;case _e:it=(et-_)/st+4;break;default:throw new Error("unreachable")}return it/6*tt.maxValue>>0},saturation(et,_,_e,tt){let nt=methods$1.min(et,_,_e),rt=methods$1.max(et,_,_e),it=rt-nt;return rt===0?0:it/rt*tt.maxValue},lightness(et,_,_e){let tt=methods$1.min(et,_,_e);return(methods$1.max(et,_,_e)+tt)/2}};Object.defineProperty(methods$1,"luminosity",{enumerable:!1,value:methods$1.lightness});Object.defineProperty(methods$1,"luminance",{enumerable:!1,value:methods$1.lightness});Object.defineProperty(methods$1,"min",{enumerable:!1,value:methods$1.minimum});Object.defineProperty(methods$1,"max",{enumerable:!1,value:methods$1.maximum});Object.defineProperty(methods$1,"brightness",{enumerable:!1,value:methods$1.maximum});Object.keys(methods$1).forEach(et=>{});function grey(et={}){let{algorithm:_="luma709",keepAlpha:_e=!1,mergeAlpha:tt=!0}=et;if(typeof _!="string"&&typeof _!="function")throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),this.components===1&&(_="red"),_e&=this.alpha,tt&=this.alpha,_e&&(tt=!1);let nt=getOutputImage(this,et,{components:1,alpha:_e,colorModel:GREY$1}),rt;if(typeof _=="function")rt=_;else if(rt=methods$1[_.toLowerCase()],!rt)throw new Error(`unsupported grey algorithm: ${_}`);let it=0;for(let st=0;st<this.data.length;st+=this.channels)tt?nt.data[it++]=clamp(rt(this.data[st],this.data[st+1],this.data[st+2],this)*this.data[st+this.components]/this.maxValue,this):(nt.data[it++]=clamp(rt(this.data[st],this.data[st+1],this.data[st+2],this),this),nt.alpha&&(nt.data[it++]=this.data[st+this.components]));return nt}function huang(et){let _=0;for(let lt=0;lt<et.length;lt++)if(et[lt]!==0){_=lt;break}let _e=et.length-1;for(let lt=et.length-1;lt>=_;lt--)if(et[lt]!==0){_e=lt;break}let tt=1/(_e-_),nt=new Array(et.length),rt=0,it=0;for(let lt=_;lt<et.length;lt++)rt+=lt*et[lt],it+=et[lt],nt[lt]=rt/it;let st=new Array(et.length);rt=it=0;for(let lt=_e;lt>0;lt--)rt+=lt*et[lt],it+=et[lt],st[lt-1]=rt/it;let ot=-1,at=Number.MAX_VALUE;for(let lt=0;lt<et.length;lt++){let ct=0,ht;for(let ut=0;ut<=lt;ut++)ht=1/(1+tt*Math.abs(ut-nt[lt])),ht<1e-6||ht>.999999||(ct+=et[ut]*(-ht*Math.log(ht)-(1-ht)*Math.log(1-ht)));for(let ut=lt+1;ut<et.length;ut++)ht=1/(1+tt*Math.abs(ut-st[lt])),ht<1e-6||ht>.999999||(ct+=et[ut]*(-ht*Math.log(ht)-(1-ht)*Math.log(1-ht)));ct<at&&(at=ct,ot=lt)}return ot}function intermodes(et){let _=et.slice(),_e=0;for(;!bimodalTest$1(_);){let nt=0,rt=0,it=_[0];for(let st=0;st<et.length-1;st++)nt=rt,rt=it,it=_[st+1],_[st]=(nt+rt+it)/3;if(_[et.length-1]=(rt+it)/3,_e++,_e>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let tt=0;for(let nt=1;nt<et.length-1;nt++)_[nt-1]<_[nt]&&_[nt+1]<_[nt]&&(tt+=nt);return Math.floor(tt/2)}function bimodalTest$1(et){let _=!1,_e=0;for(let tt=1;tt<et.length-1;tt++)if(et[tt-1]<et[tt]&&et[tt+1]<et[tt]&&(_e++,_e>2))return!1;return _e===2&&(_=!0),_}function isodata(et){let _,_e,tt,nt,rt=0;for(let it=1;it<et.length;it++)if(et[it]>0){rt=it+1;break}for(;;){_=0,tt=0;for(let it=0;it<rt;it++)tt=tt+et[it],_=_+et[it]*it;nt=0,_e=0;for(let it=rt+1;it<et.length;it++)_e+=et[it],nt+=et[it]*it;if(tt>0&&_e>0&&(_/=tt,nt/=_e,rt===Math.round((_+nt)/2)))break;if(rt++,rt>et.length-2)throw new Error("Threshold not found")}return rt}function li(et,_){let _e,tt,nt,rt,it,st,ot,at,lt,ct,ht,ut;ht=.5,ct=0;for(let ft=0;ft<et.length;ft++)ct+=ft*et[ft];ct/=_,ot=ct;do{st=ot,_e=st+.5|0,tt=0,rt=0;for(let ft=0;ft<=_e;ft++)tt+=ft*et[ft],rt+=et[ft];at=rt===0?0:tt/rt,nt=0,it=0;for(let ft=_e+1;ft<et.length;ft++)nt+=ft*et[ft],it+=et[ft];lt=it===0?0:nt/it,ut=(at-lt)/(Math.log(at)-Math.log(lt)),ut<-Number.EPSILON?ot=ut-.5|0:ot=ut+.5|0}while(Math.abs(ot-st)>ht);return _e}function maxEntropy(et,_){let _e=new Array(et.length);for(let ht=0;ht<et.length;ht++)_e[ht]=et[ht]/_;let tt=new Array(et.length),nt=new Array(et.length);tt[0]=_e[0],nt[0]=1-tt[0];for(let ht=1;ht<et.length;ht++)tt[ht]=tt[ht-1]+_e[ht],nt[ht]=1-tt[ht];let rt=0;for(let ht=0;ht<et.length;ht++)if(Math.abs(tt[ht])>=Number.EPSILON){rt=ht;break}let it=et.length-1;for(let ht=et.length-1;ht>=rt;ht--)if(Math.abs(nt[ht])>=Number.EPSILON){it=ht;break}let st=-1,ot,at=Number.MIN_VALUE,lt,ct;for(let ht=rt;ht<=it;ht++){lt=0;for(let ut=0;ut<=ht;ut++)et[ut]!==0&&(lt-=_e[ut]/tt[ht]*Math.log(_e[ut]/tt[ht]));ct=0;for(let ut=ht+1;ut<et.length;ut++)et[ut]!==0&&(ct-=_e[ut]/nt[ht]*Math.log(_e[ut]/nt[ht]));ot=lt+ct,at<ot&&(at=ot,st=ht)}return st}function mean$1(et,_){let _e=0;for(let tt=0;tt<et.length;tt++)_e+=tt*et[tt];return Math.floor(_e/_)}function minError(et,_){let _e,tt=-2,nt,rt,it,st,ot,at,lt,ct,ht,ut,ft,dt=0;for(let pt=0;pt<et.length;pt++)dt+=pt*et[pt];for(dt/=_,_e=dt;_e!==tt;){let pt=sumA(et,_e),mt=sumA(et,et.length-1),vt=sumB(et,_e),yt=sumB(et,et.length-1),_t=sumC(et,_e),St=sumC(et,et.length-1);if(nt=vt/pt,rt=(yt-vt)/(mt-pt),it=pt/mt,st=(mt-pt)/mt,ot=_t/pt-nt*nt,at=(St-_t)/(mt-pt)-rt*rt,lt=1/ot-1/at,ct=nt/ot-rt/at,ht=nt*nt/ot-rt*rt/at+Math.log10(ot*(st*st)/(at*(it*it))),ut=ct*ct-lt*ht,ut<0)return _e;tt=_e,ft=(ct+Math.sqrt(ut))/lt,isNaN(ft)?_e=tt:_e=Math.floor(ft)}return _e}function sumA(et,_){let _e=0;for(let tt=0;tt<=_;tt++)_e+=et[tt];return _e}function sumB(et,_){let _e=0;for(let tt=0;tt<=_;tt++)_e+=tt*et[tt];return _e}function sumC(et,_){let _e=0;for(let tt=0;tt<=_;tt++)_e+=tt*tt*et[tt];return _e}function minimum(et){if(et.length<2)return 0;let _=0,_e=-1,tt=-1,nt=new Array(et.length);for(let rt=0;rt<et.length;rt++)nt[rt]=et[rt],et[rt]>0&&(tt=rt);for(;!bimodalTest(nt);)if(nt=smoothed(nt),_++,_>1e4)return _e;return _e=minimumBetweenPeeks(nt,tt),_e}function smoothed(et){let _=new Array(et.length);for(let _e=1;_e<et.length-1;_e++)_[_e]=(et[_e-1]+et[_e]+et[_e+1])/3;return _[0]=(et[0]+et[1])/3,_[et.length-1]=(et[et.length-2]+et[et.length-1])/3,_}function minimumBetweenPeeks(et,_){let _e;for(let tt=1;tt<_;tt++)if(et[tt-1]>et[tt]&&et[tt+1]>=et[tt]){_e=tt;break}return _e}function bimodalTest(et){let _=et.length,_e=!1,tt=0;for(let nt=1;nt<_-1;nt++)if(et[nt-1]<et[nt]&&et[nt+1]<et[nt]&&(tt++,tt>2))return!1;return tt===2&&(_e=!0),_e}function moments(et,_){let _e=1,tt=0,nt=0,rt=0,it=0,st,ot,at,lt,ct,ht,ut=-1,ft=et.length,dt=new Array(ft);for(let pt=0;pt<ft;pt++)dt[pt]=et[pt]/_;for(let pt=0;pt<ft;pt++)tt+=pt*dt[pt],nt+=pt*pt*dt[pt],rt+=pt*pt*pt*dt[pt];ot=_e*nt-tt*tt,at=(-nt*nt+tt*rt)/ot,lt=(_e*-rt+nt*tt)/ot,ct=.5*(-lt-Math.sqrt(lt*lt-4*at)),ht=.5*(-lt+Math.sqrt(lt*lt-4*at)),st=(ht-tt)/(ht-ct);for(let pt=0;pt<ft;pt++)if(it+=dt[pt],it>st){ut=pt;break}return ut}function otsu(et,_){let _e=0,tt=0,nt=0,rt=0,it=0;for(let st=0;st<et.length;st++)it+=st*et[st];for(let st=0;st<et.length;st++){tt=tt+et[st];const ot=_-tt;if(tt===0||ot===0)continue;_e=_e+st*et[st];const at=(it-_e)/ot,lt=tt*ot*(_e/tt-at)*(_e/tt-at);lt>=nt&&(rt=st,nt=lt)}return rt}function percentile(et){let _=-1,_e=.5,tt=new Array(et.length),nt=partialSum(et,et.length-1),rt=1;for(let it=0;it<et.length;it++)tt[it]=Math.abs(partialSum(et,it)/nt-_e),tt[it]<rt&&(rt=tt[it],_=it);return _}function partialSum(et,_){let _e=0;for(let tt=0;tt<=_;tt++)_e+=et[tt];return _e}function renyiEntropy(et,_){let _e,tt,nt,rt=new Array(et.length),it=new Array(et.length),st=new Array(et.length),ot=0,at=0,lt=0,ct=0,ht=0,ut=0,dt=1/(1-.5),mt=1/(1-2);for(let St=0;St<et.length;St++)rt[St]=et[St]/_;it[0]=rt[0],st[0]=1-it[0];for(let St=1;St<et.length;St++)it[St]=it[St-1]+rt[St],st[St]=1-it[St];tt=0;for(let St=0;St<et.length;St++)if(Math.abs(it[St])>=Number.EPSILON){tt=St;break}nt=et.length-1;for(let St=et.length-1;St>=tt;St--)if(Math.abs(st[St])>=Number.EPSILON){nt=St;break}for(let St=tt;St<=nt;St++){let bt=0,Et=0,Mt=0;for(let Ft=0;Ft<=St;Ft++)et[Ft]!==0&&(bt-=rt[Ft]/it[St]*Math.log(rt[Ft]/it[St])),Et+=Math.sqrt(rt[Ft]/it[St]),Mt+=rt[Ft]*rt[Ft]/(it[St]*it[St]);let Tt=0,wt=0,Ct=0;for(let Ft=St+1;Ft<et.length;Ft++)et[Ft]!==0&&(Tt-=rt[Ft]/st[St]*Math.log(rt[Ft]/st[St])),wt+=Math.sqrt(rt[Ft]/st[St]),Ct+=rt[Ft]*rt[Ft]/(st[St]*st[St]);let Rt=bt+Tt,It=dt*(Et*wt>0?Math.log(Et*wt):0),Dt=mt*(Mt*Ct>0?Math.log(Mt*Ct):0);Rt>ct&&(ct=Rt,ot=St),It>ht&&(ht=It,at=St),Dt>ut&&(ut=Dt,lt=St)}let vt=[ot,at,lt];vt.sort((St,bt)=>St-bt);let yt;Math.abs(vt[0]-vt[1])<=5?Math.abs(vt[1]-vt[2])<=5?yt=[1,2,1]:yt=[0,1,3]:Math.abs(vt[1]-vt[2])<=5?yt=[3,1,0]:yt=[1,2,1];let _t=it[vt[2]]-it[vt[0]];return _e=Math.round(vt[0]*(it[vt[0]]+.25*_t*yt[0])+.25*vt[1]*_t*yt[1]+vt[2]*(st[vt[2]]+.25*_t*yt[2])),_e}function shanbhag(et,_){let _e=new Array(et.length);for(let ut=0;ut<et.length;ut++)_e[ut]=et[ut]/_;let tt=new Array(et.length),nt=new Array(et.length);tt[0]=_e[0],nt[0]=1-tt[0];for(let ut=1;ut<et.length;ut++)tt[ut]=tt[ut-1]+_e[ut],nt[ut]=1-tt[ut];let rt=0;for(let ut=0;ut<et.length;ut++)if(Math.abs(tt[ut])>=Number.EPSILON){rt=ut;break}let it=et.length-1;for(let ut=et.length-1;ut>=rt;ut--)if(Math.abs(nt[ut])>=Number.EPSILON){it=ut;break}let st=-1,ot=Number.MAX_VALUE,at,lt,ct,ht;for(let ut=rt;ut<=it;ut++){ct=0,at=.5/tt[ut];for(let ft=1;ft<=ut;ft++)ct-=_e[ft]*Math.log(1-at*tt[ft-1]);ct*=at,ht=0,at=.5/nt[ut];for(let ft=ut+1;ft<et.length;ft++)ht-=_e[ft]*Math.log(1-at*nt[ft]);ht*=at,lt=Math.abs(ct-ht),lt<ot&&(ot=lt,st=ut)}return st}function triangle$1(et){let _=0,_e=0,tt=0,nt=0;for(let ct=0;ct<et.length;ct++)if(et[ct]>0){_=ct;break}_>0&&_--;for(let ct=et.length-1;ct>0;ct--)if(et[ct]>0){nt=ct;break}nt<et.length-1&&nt++;for(let ct=0;ct<et.length;ct++)et[ct]>_e&&(tt=ct,_e=et[ct]);let rt=!1;if(tt-_<nt-tt){rt=!0;let ct=0,ht=et.length-1;for(;ct<ht;){let ut=et[ct];et[ct]=et[ht],et[ht]=ut,ct++,ht--}_=et.length-1-nt,tt=et.length-1-tt}if(_===tt)return _;let it,st,ot;it=et[tt],st=_-tt,ot=Math.sqrt(it*it+st*st),it/=ot,st/=ot,ot=it*_+st*et[_];let at=_,lt=0;for(let ct=_+1;ct<=tt;ct++){let ht=it*ct+st*et[ct]-ot;ht>lt&&(at=ct,lt=ht)}if(at--,rt){let ct=0,ht=et.length-1;for(;ct<ht;){let ut=et[ct];et[ct]=et[ht],et[ht]=ut,ct++,ht--}return et.length-1-at}else return at}function yen(et,_){let _e=new Array(et.length);for(let at=0;at<et.length;at++)_e[at]=et[at]/_;let tt=new Array(et.length);tt[0]=_e[0];for(let at=1;at<et.length;at++)tt[at]=tt[at-1]+_e[at];let nt=new Array(et.length);nt[0]=_e[0]*_e[0];for(let at=1;at<et.length;at++)nt[at]=nt[at-1]+_e[at]*_e[at];let rt=new Array(et.length);rt[et.length-1]=0;for(let at=et.length-2;at>=0;at--)rt[at]=rt[at+1]+_e[at+1]*_e[at+1];let it=-1,st=Number.MIN_VALUE,ot;for(let at=0;at<et.length;at++)ot=-1*(nt[at]*rt[at]>0?Math.log(nt[at]*rt[at]):0)+2*(tt[at]*(1-tt[at])>0?Math.log(tt[at]*(1-tt[at])):0),ot>st&&(st=ot,it=at);return it}const methods={huang,intermodes,isodata,li,maxentropy:maxEntropy,mean:mean$1,minerror:minError,minimum,moments,otsu,percentile,renyientropy:renyiEntropy,shanbhag,triangle:triangle$1,yen},names={};Object.keys(methods).forEach(et=>{names[et]=et});function getThreshold(et={}){let{algorithm:_=names.otsu}=et;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let _e=methods[_.toLowerCase()];if(_e){let tt=this.getHistogram();return _e(tt,this.size)}else throw new Error(`unknown thresholding algorithm: ${_}`)}const THRESHOLD="threshold";function mask(et={}){let{algorithm:_=THRESHOLD,threshold:_e=.5,useAlpha:tt=!0,invert:nt=!1}=et;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),_===THRESHOLD?_e=getThreshold$1(_e,this.maxValue):_e=getThreshold.call(this,et);let rt=new Image$1(this.width,this.height,{kind:"BINARY",parent:this}),it=0;if(this.alpha&&tt)for(let st=0;st<this.data.length;st+=this.channels){let ot=this.data[st]+(this.maxValue-this.data[st])*(this.maxValue-this.data[st+1])/this.maxValue;(nt&&ot<=_e||!nt&&ot>=_e)&&rt.setBit(it),it++}else for(let st=0;st<this.data.length;st+=this.channels)(nt&&this.data[st]<=_e||!nt&&this.data[st]>=_e)&&rt.setBit(it),it++;return rt}function copyImage(et,_,_e,tt){let nt=et.width,rt=et.height,it=_.width,st=et.channels;for(let ot=0;ot<nt;ot++)for(let at=0;at<rt;at++)for(let lt=0;lt<st;lt++){let ct=(at*nt+ot)*st+lt,ht=((tt+at)*it+_e+ot)*st+lt;_.data[ht]=et.data[ct]}}function pad(et={}){let{size:_=0,algorithm:_e="copy",color:tt}=et;if(this.checkProcessable("pad",{bitDepth:[8,16]}),_e==="set"){if(tt.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let ot=0;ot<tt.length;ot++)tt[ot]===0&&(tt[ot]=.001)}else tt=newArray$1(this.channels,null);Array.isArray(_)||(_=[_,_]);let nt=this.width+_[0]*2,rt=this.height+_[1]*2,it=this.channels,st=Image$1.createFrom(this,{width:nt,height:rt});copyImage(this,st,_[0],_[1]);for(let ot=_[0];ot<nt-_[0];ot++)for(let at=0;at<it;at++){let lt=tt[at]||st.data[(_[1]*nt+ot)*it+at];for(let ct=0;ct<_[1];ct++)st.data[(ct*nt+ot)*it+at]=lt;lt=tt[at]||st.data[((rt-_[1]-1)*nt+ot)*it+at];for(let ct=rt-_[1];ct<rt;ct++)st.data[(ct*nt+ot)*it+at]=lt}for(let ot=0;ot<rt;ot++)for(let at=0;at<it;at++){let lt=tt[at]||st.data[(ot*nt+_[0])*it+at];for(let ct=0;ct<_[0];ct++)st.data[(ot*nt+ct)*it+at]=lt;lt=tt[at]||st.data[(ot*nt+nt-_[0]-1)*it+at];for(let ct=nt-_[0];ct<nt;ct++)st.data[(ot*nt+ct)*it+at]=lt}return st}function colorDepth(et=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(et))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===et)return this.clone();let _=Image$1.createFrom(this,{bitDepth:et});switch(et){case 8:if(this.bitDepth===1)for(let _e=0;_e<this.size;_e++)this.getBit(_e)&&(_.data[_e]=255);else for(let _e=0;_e<this.data.length;_e++)_.data[_e]=this.data[_e]>>8;break;case 16:if(this.bitDepth===1)for(let _e=0;_e<this.size;_e++)this.getBit(_e)&&(_.data[_e]=65535);else for(let _e=0;_e<this.data.length;_e++)_.data[_e]=this.data[_e]<<8|this.data[_e];break;default:throw new Error("colorDepth conversion unexpected case")}return _}function rotateFree(et,_={}){const{interpolation:_e=validInterpolations.nearestneighbor,width:tt=this.width,height:nt=this.height}=_;if(typeof et!="number")throw new TypeError("degrees must be a number");const rt=checkInterpolation(_e),it=et*Math.PI/180,st=Math.floor(Math.abs(tt*Math.cos(it))+Math.abs(nt*Math.sin(it))),ot=Math.floor(Math.abs(nt*Math.cos(it))+Math.abs(tt*Math.sin(it))),at=Math.cos(-it),lt=Math.sin(-it);let ct=st/2,ht=ot/2;st%2===0?(ct=ct-.5,ot%2===0?ht=ht-.5:ht=Math.floor(ht)):(ct=Math.floor(ct),ot%2===0?ht=ht-.5:ht=Math.floor(ht));const ut=Math.floor(tt/2-ct),ft=Math.floor(nt/2-ht);if(this.bitDepth===1){const dt=new Image$1(st,ot,{kind:"BINARY",parent:this});switch(rt){case validInterpolations.nearestneighbor:return rotateBinaryNearestNeighbor(this,dt,ut,ft,ct,ht,at,lt);case validInterpolations.bilinear:return rotateBinaryBilinear(this,dt,ut,ft,ct,ht,at,lt);default:throw new Error(`unsupported rotate interpolation: ${rt}`)}}else{const dt=Image$1.createFrom(this,{width:st,height:ot});switch(rt){case validInterpolations.nearestneighbor:return rotateNearestNeighbor(this,dt,ut,ft,ct,ht,at,lt);case validInterpolations.bilinear:return rotateBilinear(this,dt,ut,ft,ct,ht,at,lt);default:throw new Error(`unsupported rotate interpolation: ${rt}`)}}}function rotateNearestNeighbor(et,_,_e,tt,nt,rt,it,st){for(let ot=0;ot<_.width;ot+=1)for(let at=0;at<_.height;at+=1)for(let lt=0;lt<et.channels;lt++){let ct=Math.round((ot-nt)*it-(at-rt)*st+nt)+_e,ht=Math.round((at-rt)*it+(ot-nt)*st+rt)+tt;ct<0||ct>=et.width||ht<0||ht>=et.height?et.alpha===1&&lt===et.channels-1?_.setValueXY(ot,at,lt,0):_.setValueXY(ot,at,lt,et.maxValue):_.setValueXY(ot,at,lt,et.getValueXY(ct,ht,lt))}return _}function rotateBinaryNearestNeighbor(et,_,_e,tt,nt,rt,it,st){for(let ot=0;ot<_.width;ot+=1)for(let at=0;at<_.height;at+=1){let lt=Math.round((ot-nt)*it-(at-rt)*st+nt)+_e,ct=Math.round((at-rt)*it+(ot-nt)*st+rt)+tt;(lt<0||lt>=et.width||ct<0||ct>=et.height||et.getBitXY(lt,ct))&&_.setBitXY(ot,at)}return _}function rotateBilinear(et,_,_e,tt,nt,rt,it,st){let ot=et.width*et.channels;for(let at=0;at<_.height;at++)for(let lt=0;lt<_.width;lt++){let ct=(lt-nt)*it-(at-rt)*st+nt+_e,ht=(at-rt)*it+(lt-nt)*st+rt+tt,ut=ct|0,ft=ht|0,dt=ct-ut,pt=ht-ft;for(let mt=0;mt<et.channels;mt++)if(ct<0||ct>=et.width||ht<0||ht>=et.height)et.alpha===1&&mt===et.channels-1?_.setValueXY(lt,at,mt,0):_.setValueXY(lt,at,mt,et.maxValue);else{let vt=(ft*et.width+ut)*et.channels+mt,yt=et.data[vt],_t=et.data[vt+et.channels],St=et.data[vt+ot],bt=et.data[vt+ot+et.channels],Et=yt+dt*(_t-yt)+pt*(St-yt)+dt*pt*(yt-_t-St+bt)|0;_.setValueXY(lt,at,mt,Et)}}return _}function rotateBinaryBilinear(et,_,_e,tt,nt,rt,it,st){let ot=et.width;for(let at=0;at<_.height;at++)for(let lt=0;lt<_.width;lt++){let ct=(lt-nt)*it-(at-rt)*st+nt+_e,ht=(at-rt)*it+(lt-nt)*st+rt+tt,ut=ct|0,ft=ht|0,dt=ct-ut,pt=ht-ft;if(ct<0||ct>=et.width||ht<0||ht>=et.height)_.setBitXY(lt,at);else{let mt=ft*et.width+ut,vt=et.getBit(mt),yt=et.getBit(mt+1),_t=et.getBit(mt+ot),St=et.getBit(mt+1+ot);(vt|dt&yt-vt|pt&_t-vt|dt&pt&vt-yt-_t+St)>0&&_.setBitXY(lt,at)}}return _}function rotate$1(et,_){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),typeof et!="number")throw new TypeError("angle must be a number");switch(et<0&&(et=Math.ceil(-et/360)*360+et),et%360){case 0:return this.clone();case 90:return rotateRight.call(this);case 180:return rotate180.call(this);case 270:return rotateLeft.call(this);default:return rotateFree.call(this,et,_)}}function rotateLeft(){if(this.bitDepth===1){const et=new Image$1(this.height,this.width,{kind:"BINARY",parent:this}),_=et.height-1;for(let _e=0;_e<this.height;_e++)for(let tt=0;tt<this.width;tt++)this.getBitXY(tt,_e)&&et.setBitXY(_e,_-tt);return et}else{const et=Image$1.createFrom(this,{width:this.height,height:this.width}),_=et.height-1;for(let _e=0;_e<this.height;_e++)for(let tt=0;tt<this.width;tt++)for(let nt=0;nt<this.channels;nt++)et.setValueXY(_e,_-tt,nt,this.getValueXY(tt,_e,nt));return et}}function rotateRight(){if(this.bitDepth===1){const et=new Image$1(this.height,this.width,{kind:"BINARY",parent:this}),_=et.width-1;for(let _e=0;_e<this.height;_e++)for(let tt=0;tt<this.width;tt++)this.getBitXY(tt,_e)&&et.setBitXY(_-_e,tt);return et}else{const et=Image$1.createFrom(this,{width:this.height,height:this.width}),_=et.width-1;for(let _e=0;_e<this.height;_e++)for(let tt=0;tt<this.width;tt++)for(let nt=0;nt<this.channels;nt++)et.setValueXY(_-_e,tt,nt,this.getValueXY(tt,_e,nt));return et}}function rotate180(){if(this.bitDepth===1){const et=new Image$1(this.width,this.height,{kind:"BINARY",parent:this}),_=et.width-1,_e=et.height-1;for(let tt=0;tt<this.height;tt++)for(let nt=0;nt<this.width;nt++)this.getBitXY(nt,tt)&&et.setBitXY(_-nt,_e-tt);return et}else{const et=Image$1.createFrom(this),_=et.width-1,_e=et.height-1;for(let tt=0;tt<this.height;tt++)for(let nt=0;nt<this.width;nt++)for(let rt=0;rt<this.channels;rt++)et.setValueXY(_-nt,_e-tt,rt,this.getValueXY(nt,tt,rt));return et}}function insert(et,_={}){const _e=getImageParameters(et);this.checkProcessable("insert",_e);let{x:tt=0,y:nt=0}=_;const rt=getOutputImageOrInPlace(this,_,{copy:!0}),it=Math.min(rt.height,nt+et.height),st=Math.min(rt.width,tt+et.width);if(rt.bitDepth===1)for(let ot=nt;ot<it;ot++)for(let at=tt;at<st;at++)et.getBitXY(at-tt,ot-nt)?rt.setBitXY(at,ot):rt.clearBitXY(at,ot);else for(let ot=nt;ot<it;ot++)for(let at=tt;at<st;at++)rt.setPixelXY(at,ot,et.getPixelXY(at-tt,ot-nt));return rt}function setBorder(et={}){let{size:_=0,algorithm:_e="copy",color:tt}=et;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),_e==="set"){if(tt.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let st=0;st<tt.length;st++)tt[st]===0&&(tt[st]=.001)}else tt=newArray$1(this.channels,null);Array.isArray(_)||(_=[_,_]);let nt=_[0],rt=_[1],it=this.channels;for(let st=nt;st<this.width-nt;st++)for(let ot=0;ot<it;ot++){let at=tt[ot]||this.data[(st+this.width*rt)*it+ot];for(let lt=0;lt<rt;lt++)this.data[(lt*this.width+st)*it+ot]=at;at=tt[ot]||this.data[(st+this.width*(this.height-rt-1))*it+ot];for(let lt=this.height-rt;lt<this.height;lt++)this.data[(lt*this.width+st)*it+ot]=at}for(let st=0;st<this.height;st++)for(let ot=0;ot<it;ot++){let at=tt[ot]||this.data[(st*this.width+nt)*it+ot];for(let lt=0;lt<nt;lt++)this.data[(st*this.width+lt)*it+ot]=at;at=tt[ot]||this.data[(st*this.width+this.width-nt-1)*it+ot];for(let lt=this.width-nt;lt<this.width;lt++)this.data[(st*this.width+lt)*it+ot]=at}return this}function split(et={}){let{preserveAlpha:_=!0}=et;if(this.checkProcessable("split",{bitDepth:[8,16]}),this.components===1)return new Stack([this.clone()]);let _e=new Stack,tt=this.data;if(this.alpha&&_)for(let nt=0;nt<this.components;nt++){let rt=Image$1.createFrom(this,{components:1,alpha:!0,colorModel:GREY$1}),it=0;for(let st=0;st<tt.length;st+=this.channels)rt.data[it++]=tt[st+nt],rt.data[it++]=tt[st+this.components];_e.push(rt)}else for(let nt=0;nt<this.channels;nt++){let rt=Image$1.createFrom(this,{components:1,alpha:!1,colorModel:GREY$1}),it=0;for(let st=0;st<tt.length;st+=this.channels)rt.data[it++]=tt[st+nt];_e.push(rt)}return _e}function getChannel(et,_={}){let{keepAlpha:_e=!1,mergeAlpha:tt=!1}=_;_e&=this.alpha,tt&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),et=validateChannel(this,et);let nt=Image$1.createFrom(this,{components:1,alpha:_e,colorModel:GREY$1}),rt=0;for(let it=0;it<this.data.length;it+=this.channels)tt?nt.data[rt++]=this.data[it+et]*this.data[it+this.components]/this.maxValue:(nt.data[rt++]=this.data[it+et],_e&&(nt.data[rt++]=this.data[it+this.components]));return nt}function combineChannels(et=defaultCombineMethod,_={}){let{mergeAlpha:_e=!1,keepAlpha:tt=!1}=_;_e&=this.alpha,tt&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let nt=Image$1.createFrom(this,{components:1,alpha:tt,colorModel:GREY$1}),rt=0;for(let it=0;it<this.size;it++){let st=et(this.getPixel(it));_e?nt.data[rt++]=st*this.data[it*this.channels+this.components]/this.maxValue:(nt.data[rt++]=st,tt&&(nt.data[rt++]=this.data[it*this.channels+this.components]))}return nt}function defaultCombineMethod(et){return(et[0]+et[1]+et[2])/3}function setChannel(et,_){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),_.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),_.width!==this.width||_.height!==this.height)throw new Error("Images must have exactly the same width and height");et=validateChannel(this,et);let _e=et;for(let tt=0;tt<_.data.length;tt++)this.data[_e]=_.data[tt],_e+=this.channels;return this}function getSimilarity(et,_={}){let{shift:_e=[0,0],average:tt,channels:nt,defaultAlpha:rt,normalize:it,border:st=[0,0]}=_;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(st)||(st=[st,st]),nt=validateArrayOfChannels(this,{channels:nt,defaultAlpha:rt}),this.bitDepth!==et.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==et.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==et.colorModel)throw new Error("Both images must have the same colorModel");typeof tt>"u"&&(tt=!0);let ot=Math.max(st[0],-_e[0]),at=Math.min(this.width-st[0],this.width-_e[0]),lt=Math.max(st[1],-_e[1]),ct=Math.min(this.height-st[1],this.height-_e[1]),ht=newArray$1(nt.length,0);for(let ut=0;ut<nt.length;ut++){let ft=nt[ut],dt=it?this.sum[ft]:Math.max(this.sum[ft],et.sum[ft]),pt=it?et.sum[ft]:Math.max(this.sum[ft],et.sum[ft]);if(dt!==0&&pt!==0)for(let mt=ot;mt<at;mt++)for(let vt=lt;vt<ct;vt++){let yt=mt*this.multiplierX+vt*this.multiplierY+ft,_t=yt+_e[0]*this.multiplierX+_e[1]*this.multiplierY;ht[ut]+=Math.min(this.data[yt]/dt,et.data[_t]/pt)}}return tt?ht.reduce((ut,ft)=>ut+ft)/ht.length:ht}function getPixelsGrid(et={}){let{sampling:_=[10,10],painted:_e=!1,mask:tt}=et;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(_)||(_=[_,_]);const nt=_[0],rt=_[1],it=[],st=[],ot=this.width/nt,at=this.height/rt;let lt=Math.floor(ot/2);for(let ht=0;ht<nt;ht++){let ut=Math.floor(at/2);for(let ft=0;ft<rt;ft++){let dt=Math.round(lt),pt=Math.round(ut);(!tt||tt.getBitXY(dt,pt))&&(it.push([dt,pt]),st.push(this.getPixelXY(dt,pt))),ut+=at}lt+=ot}const ct={xyS:it,zS:st};return _e&&(ct.painted=this.rgba8().paintPoints(it)),ct}function Matrix(et,_,_e){const tt=new Array(et);for(let nt=0;nt<et;nt++)tt[nt]=new Array(_);if(_e)for(let nt=0;nt<et;nt++)for(let rt=0;rt<_;rt++)tt[nt][rt]=_e;return tt.width=et,tt.height=_,Object.setPrototypeOf(tt,Matrix.prototype),tt}Matrix.prototype.localMin=function(et,_){let _e=this[et][_],tt=[et,_];for(let nt=Math.max(0,et-1);nt<Math.min(this.length,et+2);nt++)for(let rt=Math.max(0,_-1);rt<Math.min(this[0].length,_+2);rt++)this[nt][rt]<_e&&(_e=this[nt][rt],tt=[nt,rt]);return{position:tt,value:_e}};Matrix.prototype.localMax=function(et,_){let _e=this[et][_],tt=[et,_];for(let nt=Math.max(0,et-1);nt<Math.min(this.length,et+2);nt++)for(let rt=Math.max(0,_-1);rt<Math.min(this[0].length,_+2);rt++)this[nt][rt]>_e&&(_e=this[nt][rt],tt=[nt,rt]);return{position:tt,value:_e}};Matrix.prototype.localSearch=function(et,_,_e){let tt=[];for(let nt=Math.max(0,et-1);nt<Math.min(this.length,et+2);nt++)for(let rt=Math.max(0,_-1);rt<Math.min(this[0].length,_+2);rt++)this[nt][rt]===_e&&tt.push([nt,rt]);return tt};function getBestMatch(et,_={}){let{border:_e}=_;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==et.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==et.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==et.colorModel)throw new Error("Both images must have the same colorModel");let tt=new Matrix(et.width,et.height,-1/0),nt=Math.floor(et.width/2),rt=Math.floor(et.height/2),it=nt,st=rt,ot=!1;for(;!ot;){let at=tt.localSearch(nt,rt,-1/0);for(let ct=0;ct<at.length;ct++){let ht=at[ct],ut=this.getSimilarity(et,{border:_e,shift:[it-ht[0],st-ht[1]]});tt[ht[0]][ht[1]]=ut}let lt=tt.localMax(nt,rt);lt.position[0]!==nt||lt.position[1]!==rt?(nt=lt.position[0],rt=lt.position[1]):ot=!0}return[nt-it,rt-st]}function getRow(et,_=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),checkRow(this,et),checkChannel(this,_);let _e=new Array(this.width),tt=0,nt=et*this.width*this.channels+_,rt=nt+this.width*this.channels;for(let it=nt;it<rt;it+=this.channels)_e[tt++]=this.data[it];return _e}function getColumn(et,_=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),checkColumn(this,et),checkChannel(this,_);let _e=new Array(this.height),tt=0,nt=this.width*this.channels;for(let rt=_+et*this.channels;rt<this.data.length;rt+=nt)_e[tt++]=this.data[rt];return _e}function getMatrix(et={}){let{channel:_}=et;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),_===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");_=0}let _e=new Matrix$2(this.height,this.width);for(let tt=0;tt<this.height;tt++)for(let nt=0;nt<this.width;nt++)_e.set(tt,nt,this.getValueXY(nt,tt,_));return _e}function setMatrix(et,_={}){et=new Matrix$2(et);let{channel:_e}=_;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),_e===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");_e=0}if(this.width!==et.columns||this.height!==et.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let tt=0;tt<this.height;tt++)for(let nt=0;nt<this.width;nt++)this.setValueXY(nt,tt,_e,et.get(tt,nt));return this}function getPixelsArray(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let et=new Array(this.size),_=0;for(let _e=0;_e<this.data.length;_e+=this.channels){let tt=new Array(this.components);for(let nt=0;nt<this.components;nt++)tt[nt]=this.data[_e+nt];et[_++]=tt}return et}function getIntersection(et){let _=this,_e=_.getClosestCommonParent(et),tt=_.getRelativePosition(_e,{defaultFurther:!0}),nt=getRelativePositionForAllPixels(_,tt),rt=et.getRelativePosition(_e,{defaultFurther:!0}),it=getRelativePositionForAllPixels(et,rt),st=getCommonSurface(nt,it),ot={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let at=0;at<st.length;at++){let lt=st[at],ct=[lt[0]-tt[0],lt[1]-tt[1]],ht=[lt[0]-rt[0],lt[1]-rt[1]],ut=_.getBitXY(ct[0],ct[1]),ft=et.getBitXY(ht[0],ht[1]);ut===1&&ft===1&&ot.commonWhitePixels.push(lt)}for(let at=0;at<nt.length;at++){let lt,ct;at!==0&&(lt=Math.floor(at/_.width),ct=at%_.width),_.getBitXY(lt,ct)===1&&ot.whitePixelsMask1.push(nt[at])}for(let at=0;at<it.length;at++){let lt=0,ct=0;at!==0&&(lt=Math.floor(at/et.width),ct=at%et.width),et.getBitXY(lt,ct)===1&&ot.whitePixelsMask2.push(it[at])}return ot}function getRelativePositionForAllPixels(et,_){let _e=[];for(let tt=0;tt<et.height;tt++)for(let nt=0;nt<et.width;nt++){let rt=[tt,nt];_e.push([rt[0]+_[0],rt[1]+_[1]])}return _e}function getCommonSurface(et,_){let _e=0,tt=0,nt=[];for(;_e<et.length&&tt<_.length;)et[_e][0]===_[tt][0]&&et[_e][1]===_[tt][1]?(nt.push(et[_e]),_e++,tt++):et[_e][0]<_[tt][0]||et[_e][0]===_[tt][0]&&et[_e][1]<_[tt][1]?_e++:tt++;return nt}function getClosestCommonParent(et){let _=getDepth(this),_e=getDepth(et),tt;if(_>=_e?tt=getFurthestParent(this,_):tt=getFurthestParent(et,_e),_===0||_e===0)return tt;let nt=this,rt=et;for(;_!==_e;)if(_>_e){if(nt=nt.parent,nt===null)return tt;_=_-1}else{if(rt=rt.parent,rt===null)return tt;_e=_e-1}for(;nt!==rt&&nt!==null&&rt!==null;)if(nt=nt.parent,rt=rt.parent,nt===null||rt===null)return tt;return nt!==rt?tt:nt}function getDepth(et){let _=0,_e=et;for(;_e.parent!=null;)_e=_e.parent,_++;return _}function getFurthestParent(et,_){let _e=et;for(;_>0;)_e=_e.parent,_=_-1;return _e}const defaultOptions$1={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Gx=[[-1,0,1],[-2,0,2],[-1,0,1]],Gy=[[-1,-2,-1],[0,0,0],[1,2,1]],convOptions={bitDepth:32,mode:"periodic"};function cannyEdgeDetector(et,_){et.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),_=Object.assign({},defaultOptions$1,_);const _e=et.width,tt=et.height,nt=et.maxValue,rt={sigma:_.gaussianBlur,radius:3},it=et.gaussianFilter(rt),st=it.convolution(Gy,convOptions),ot=it.convolution(Gx,convOptions),at=ot.hypotenuse(st),lt=et.constructor,ct=new lt(_e,tt,{kind:"GREY",bitDepth:32}),ht=new lt(_e,tt,{kind:"GREY",bitDepth:32}),ut=new lt(_e,tt,{kind:"GREY"});for(var ft=1;ft<_e-1;ft++)for(var dt=1;dt<tt-1;dt++){var pt=(Math.round(Math.atan2(ot.getValueXY(ft,dt,0),st.getValueXY(ft,dt,0))*(5/Math.PI))+5)%5;pt===0&&(at.getValueXY(ft,dt,0)<=at.getValueXY(ft,dt-1,0)||at.getValueXY(ft,dt,0)<=at.getValueXY(ft,dt+1,0))||pt===1&&(at.getValueXY(ft,dt,0)<=at.getValueXY(ft-1,dt+1,0)||at.getValueXY(ft,dt,0)<=at.getValueXY(ft+1,dt-1,0))||pt===2&&(at.getValueXY(ft,dt,0)<=at.getValueXY(ft-1,dt,0)||at.getValueXY(ft,dt,0)<=at.getValueXY(ft+1,dt,0))||pt===3&&(at.getValueXY(ft,dt,0)<=at.getValueXY(ft-1,dt-1,0)||at.getValueXY(ft,dt,0)<=at.getValueXY(ft+1,dt+1,0))||ct.setValueXY(ft,dt,0,at.getValueXY(ft,dt,0))}for(ft=0;ft<_e*tt;++ft){var mt=ct.data[ft],vt=0;mt>_.highThreshold&&(vt++,ut.data[ft]=nt),mt>_.lowThreshold&&vt++,ht.data[ft]=vt}var yt=[];for(ft=1;ft<_e-1;++ft)for(dt=1;dt<tt-1;++dt)if(ht.getValueXY(ft,dt,0)===1){e:for(var _t=ft-1;_t<ft+2;++_t)for(var St=dt-1;St<dt+2;++St)if(ht.getValueXY(_t,St,0)===2){yt.push([ft,dt]),ut.setValueXY(ft,dt,0,nt);break e}}for(;yt.length>0;){var bt=[];for(ft=0;ft<yt.length;++ft)for(dt=-1;dt<2;++dt)for(_t=-1;_t<2;++_t)if(!(dt===0&&_t===0)){var Et=yt[ft][0]+dt,Mt=yt[ft][1]+_t;ht.getValueXY(Et,Mt,0)===1&&ut.getValueXY(Et,Mt,0)===0&&(bt.push([Et,Mt]),ut.setValueXY(Et,Mt,0,nt))}yt=bt}return ut}function cannyEdge(et){return cannyEdgeDetector(this,et)}function extract(et,_={}){let{position:_e}=_;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!_e&&(_e=et.getRelativePosition(this),!_e))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let tt=Image$1.createFrom(this,{width:et.width,height:et.height,alpha:1,position:_e,parent:this});for(let nt=0;nt<et.width;nt++)for(let rt=0;rt<et.height;rt++){for(let it=0;it<this.channels;it++){let st=this.getValueXY(nt+_e[0],rt+_e[1],it);tt.setValueXY(nt,rt,it,st)}et.getBitXY(nt,rt)||tt.setValueXY(nt,rt,this.components,0)}return tt}else{let tt=Image$1.createFrom(this,{width:et.width,height:et.height,position:_e,parent:this});for(let nt=0;nt<et.height;nt++)for(let rt=0;rt<et.width;rt++)et.getBitXY(rt,nt)&&this.getBitXY(rt+_e[0],nt+_e[1])&&tt.setBitXY(rt,nt);return tt}}var fastList={exports:{}};(function(et,_){(function(){function _e(nt,rt,it){this.next=it,it&&(it.prev=this),this.prev=rt,rt&&(rt.next=this),this.data=nt}function tt(){if(!(this instanceof tt))return new tt;this._head=null,this._tail=null,this.length=0}tt.prototype={push:function(nt){this._tail=new _e(nt,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(this.length!==0){var nt=this._tail;return this._tail=nt.prev,nt.prev&&(nt.prev=this._tail.next=null),this.length--,this.length===1?this._head=this._tail:this.length===0&&(this._head=this._tail=null),nt.data}},unshift:function(nt){this._head=new _e(nt,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(this.length!==0){var nt=this._head;return this._head=nt.next,nt.next&&(nt.next=this._head.prev=null),this.length--,this.length===1?this._tail=this._head:this.length===0&&(this._head=this._tail=null),nt.data}},item:function(nt){nt<0&&(nt=this.length+nt);for(var rt=this._head;nt-- >0&&rt;)rt=rt.next;return rt?rt.data:void 0},slice:function(nt,rt){if(nt||(nt=0),rt||(rt=this.length),rt<0&&(rt=this.length+rt),nt<0&&(nt=this.length+nt),rt===nt)return[];if(rt<nt)throw new Error("invalid offset: "+nt+","+rt+" (length="+this.length+")");for(var it=rt-nt,st=new Array(it),ot=0,at=this._head;nt-- >0&&at;)at=at.next;for(;ot<it&&at;)st[ot++]=at.data,at=at.next;return st},drop:function(){tt.call(this)},forEach:function(nt,rt){for(var it=this._head,st=0,ot=this.length;st<ot&&it;)nt.call(rt||this,it.data,st,this),it=it.next,st++},map:function(nt,rt){var it=new tt;return this.forEach(function(st,ot,at){it.push(nt.call(rt||at,st,ot,at))}),it},filter:function(nt,rt){var it=new tt;return this.forEach(function(st,ot,at){nt.call(rt||at,st,ot,at)&&it.push(st)}),it},reduce:function(nt,rt,it){var st=0,ot=this._head,at=this.length;for(rt||(st=1,rt=ot&&ot.data,ot=ot&&ot.next);st<at&&ot;)rt=nt.call(it||this,rt,ot.data,this),st++,ot=ot.next;return rt}},et.exports=tt})()})(fastList);var fastListExports=fastList.exports;const LinkedList=getDefaultExportFromCjs(fastListExports);function floodFill(et={}){const{x:_=0,y:_e=0,inPlace:tt=!0}=et,nt=tt?this:Image$1.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(_,_e))return nt;const it=new LinkedList;for(it.push(new Node(_,_e));it.length>0;){const st=it.shift();nt.setBitXY(st.x,st.y);for(let ot=st.x+1;ot<this.width&&(!nt.getBitXY(ot,st.y)&&!this.getBitXY(ot,st.y));ot++)nt.setBitXY(ot,st.y),st.y+1<this.height&&!this.getBitXY(ot,st.y+1)&&it.push(new Node(ot,st.y+1)),st.y-1>=0&&!this.getBitXY(ot,st.y-1)&&it.push(new Node(ot,st.y-1));for(let ot=st.x-1;ot>=0&&(!nt.getBitXY(ot,st.y)&&!this.getBitXY(ot,st.y));ot++)nt.setBitXY(ot,st.y),st.y+1<this.height&&!this.getBitXY(ot,st.y+1)&&it.push(new Node(ot,st.y+1)),st.y-1>=0&&!this.getBitXY(ot,st.y-1)&&it.push(new Node(ot,st.y-1))}return nt}function Node(et,_){this.x=et,this.y=_}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(et){for(var _=1;_<arguments.length;_++){var _e=arguments[_];for(var tt in _e)({}).hasOwnProperty.call(_e,tt)&&(et[tt]=_e[tt])}return et},_extends$1.apply(null,arguments)}function hsv2rgb(et,_,_e){_=_/100,_e=_e/100;var tt=[],nt=_e*_,rt=et/60,it=nt*(1-Math.abs(rt%2-1)),st=_e-nt;return rt>=0&&rt<1?tt=[nt,it,0]:rt>=1&&rt<2?tt=[it,nt,0]:rt>=2&&rt<3?tt=[0,nt,it]:et>=3&&rt<4?tt=[0,it,nt]:et>=4&&rt<5?tt=[it,0,nt]:et>=5&&rt<=6?tt=[nt,0,it]:tt=[0,0,0],{r:Math.round(255*(tt[0]+st)),g:Math.round(255*(tt[1]+st)),b:Math.round(255*(tt[2]+st))}}function hsl2hsv(et,_,_e){return _*=(_e<50?_e:100-_e)/100,{h:et,s:2*_/(_e+_)*100,v:_e+_}}function hsl2rgb$1(et,_,_e){var tt=hsl2hsv(et,_,_e);return hsv2rgb(tt.h,tt.s,tt.v)}var colors={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function parse(et){return named(et)||hex3(et)||hex6(et)||rgb(et)||rgba$1(et)||hsl(et)||hsla(et)}function named(et){var _=colors[et.toLowerCase()];if(_)return{r:_[0],g:_[1],b:_[2],a:100}}function rgb(et){var _=et.match(/rgb\(([^)]+)\)/);if(_){var _e=_[1].split(/ *, */).map(Number);return{r:_e[0],g:_e[1],b:_e[2],a:100}}}function rgba$1(et){var _=et.match(/rgba\(([^)]+)\)/);if(_){var _e=_[1].split(/ *, */).map(Number);return{r:_e[0],g:_e[1],b:_e[2],a:_e[3]*100}}}function hex6(et){if(et[0]==="#"&&et.length===7)return{r:parseInt(et.slice(1,3),16),g:parseInt(et.slice(3,5),16),b:parseInt(et.slice(5,7),16),a:100}}function hex3(et){if(et[0]==="#"&&et.length===4)return{r:parseInt(et[1]+et[1],16),g:parseInt(et[2]+et[2],16),b:parseInt(et[3]+et[3],16),a:100}}function hsl(et){var _=et.match(/hsl\(([^)]+)\)/);if(_){var _e=_[1].split(/ *, */),tt=parseInt(_e[0],10),nt=parseInt(_e[1],10),rt=parseInt(_e[2],10),it=hsl2rgb$1(tt,nt,rt);return _extends$1({},it,{a:100})}}function hsla(et){var _=et.match(/hsla\(([^)]+)\)/);if(_){var _e=_[1].split(/ *, */),tt=parseInt(_e[0],10),nt=parseInt(_e[1],10),rt=parseInt(_e[2],10),it=parseInt(parseFloat(_e[3])*100,10),st=hsl2rgb$1(tt,nt,rt);return _extends$1({},st,{a:it})}}function css2array(et){let _=parse(et);return[_.r,_.g,_.b,Math.round(_.a*255/100)]}function hue2rgb(et,_,_e){return _e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?et+(_-et)*6*_e:_e<1/2?_:_e<2/3?et+(_-et)*(2/3-_e)*6:et}function hsl2rgb(et,_,_e){let tt,nt,rt,it,st,ot;return _/=100,_e/=100,_===0?it=st=ot=_e*255:(_e<=.5?nt=_e*(_+1):nt=_e+_-_e*_,tt=_e*2-nt,rt=et/360,it=hue2rgb(tt,nt,rt+1/3),st=hue2rgb(tt,nt,rt),ot=hue2rgb(tt,nt,rt-1/3)),{r:it,g:st,b:ot}}function getDistinctColors(et){let _=new Array(et),_e=0;for(let tt=0;tt<360;tt+=360/et){_e++;let nt=hsl2rgb(tt,100,30+_e%4*15);_[_e-1]=[Math.round(nt.r*255),Math.round(nt.g*255),Math.round(nt.b*255)]}return _}function getRandomColor(){return[Math.floor(Math.random()*256),Math.floor(Math.random()*256),Math.floor(Math.random()*256)]}function getColors(et){let{color:_,colors:_e,randomColors:tt,numberColors:nt=50}=et;if(_&&!Array.isArray(_)&&(_=css2array(_)),_)return[_];if(_e)return _e=_e.map(function(rt){return Array.isArray(rt)?rt:css2array(rt)}),_e;if(tt){_e=new Array(nt);for(let rt=0;rt<nt;rt++)_e[rt]=getRandomColor()}return getDistinctColors(nt)}function paintLabels(et,_,_e={}){let{color:tt="blue",colors:nt,font:rt="12px Helvetica",rotate:it=0}=_e;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB$1}),!Array.isArray(et))throw Error("paintLabels: labels must be an array");if(!Array.isArray(_))throw Error("paintLabels: positions must be an array");if(tt&&!Array.isArray(tt)&&(tt=css2array(tt)),nt?nt=nt.map(function(at){return Array.isArray(at)?at:css2array(at)}):nt=[tt],et.length!==_.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(rt)||(rt=[rt]),Array.isArray(it)||(it=[it]);let ot=this.getCanvas().getContext("2d");for(let at=0;at<et.length;at++){ot.save();let lt=nt[at%nt.length];ot.fillStyle=`rgba(${lt[0]},${lt[1]},${lt[2]},${lt[3]/this.maxValue})`,ot.font=rt[at%rt.length];let ct=_[at];ot.translate(ct[0],ct[1]),ot.rotate(it[at%it.length]/180*Math.PI),ot.fillText(et[at],0,0),ot.restore()}return this.data=Uint8Array.from(ot.getImageData(0,0,this.width,this.height).data),this}function paintMasks(et,_={}){let{alpha:_e=255,labels:tt=[],labelsPosition:nt=[],labelColor:rt="blue",labelFont:it="12px Helvetica"}=_;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB$1});let st=getColors(Object.assign({},_,{numberColors:et.length}));Array.isArray(et)||(et=[et]);for(let ot=0;ot<et.length;ot++){let at=et[ot],lt=st[ot%st.length];for(let ct=0;ct<at.width;ct++)for(let ht=0;ht<at.height;ht++)if(at.getBitXY(ct,ht))for(let ut=0;ut<Math.min(this.components,lt.length);ut++)if(_e===255)this.setValueXY(ct+at.position[0],ht+at.position[1],ut,lt[ut]);else{let ft=this.getValueXY(ct+at.position[0],ht+at.position[1],ut);ft=Math.round((ft*(255-_e)+lt[ut]*_e)/255),this.setValueXY(ct+at.position[0],ht+at.position[1],ut,ft)}}if(Array.isArray(tt)&&tt.length>0){let at=this.getCanvas().getContext("2d");at.fillStyle=rt,at.font=it;for(let lt=0;lt<Math.min(et.length,tt.length);lt++){let ct=nt[lt]?nt[lt]:et[lt].position;at.fillText(tt[lt],ct[0],ct[1])}this.data=Uint8Array.from(at.getImageData(0,0,this.width,this.height).data)}return this}function zerosMatrix(et,_){let _e=new Array(et);for(let tt=0;tt<et;tt++)_e[tt]=new Array(_).fill(0);return _e}const cross=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],smallCross=[[0,1,0],[1,1,1],[0,1,0]];class Shape{constructor(_={}){let{kind:_e="cross",shape:tt,size:nt,width:rt,height:it,filled:st=!0}=_;if(nt&&(rt=nt,it=nt),tt)switch(tt.toLowerCase()){case"square":case"rectangle":this.matrix=rectangle(rt,it,{filled:st});break;case"circle":case"ellipse":this.matrix=ellipse(rt,it,{filled:st});break;case"triangle":this.matrix=triangle(rt,it,{filled:st});break;default:throw new Error(`Shape: unexpected shape: ${tt}`)}else if(_e)switch(_e.toLowerCase()){case"cross":this.matrix=cross;break;case"smallcross":this.matrix=smallCross;break;default:throw new Error(`Shape: unexpected kind: ${_e}`)}else throw new Error("Shape: expected a kind or a shape option");this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let _=this.matrix,_e=[];for(let tt=0;tt<_.length;tt++)for(let nt=0;nt<_[0].length;nt++)_[tt][nt]&&_e.push([nt-this.halfWidth,tt-this.halfHeight]);return _e}getMask(){let _=new Image$1(this.width,this.height,{kind:BINARY});for(let _e=0;_e<this.matrix.length;_e++)for(let tt=0;tt<this.matrix[0].length;tt++)this.matrix[_e][tt]&&_.setBitXY(tt,_e);return _}}function rectangle(et,_,_e){const tt=zerosMatrix(_,et);if(_e.filled)for(let nt=0;nt<_;nt++)for(let rt=0;rt<et;rt++)tt[nt][rt]=1;else{for(let nt of[0,_-1])for(let rt=0;rt<et;rt++)tt[nt][rt]=1;for(let nt=0;nt<_;nt++)for(let rt of[0,et-1])tt[nt][rt]=1}return tt}function ellipse(et,_,_e){const tt=zerosMatrix(_,et);let nt=1-_%2,rt=1-et%2,it=Math.floor((et-1)/2),st=Math.floor((_-1)/2),ot=it*it,at=st*st;if(_e.filled)for(let lt=0;lt<=st;lt++){let ct=Math.floor(Math.sqrt(ot-ot*lt*lt/at));for(let ht=it-ct;ht<=it;ht++)tt[st-lt][ht]=1,tt[st+lt+nt][ht]=1,tt[st-lt][et-ht-1]=1,tt[st+lt+nt][et-ht-1]=1}else{for(let lt=0;lt<=st;lt++){let ct=Math.floor(Math.sqrt(ot-ot*lt*lt/at)),ht=it-ct;tt[st-lt][ht]=1,tt[st+lt+nt][ht]=1,tt[st-lt][et-ht-1]=1,tt[st+lt+nt][et-ht-1]=1}for(let lt=0;lt<=it;lt++){let ct=Math.floor(Math.sqrt(at-at*lt*lt/ot)),ht=st-ct;tt[ht][it-lt]=1,tt[ht][it+lt+rt]=1,tt[_-ht-1][it-lt]=1,tt[_-ht-1][it+lt+rt]=1}}return tt}function triangle(et,_,_e){if(!_e.filled)throw new Error("Non filled triangle is not implemented");const tt=zerosMatrix(_,et);for(let nt=0;nt<_;nt++){let rt=Math.floor((1-nt/_)*et/2);for(let it=rt;it<et-rt;it++)tt[nt][it]=1}return tt}function paintPoints(et,_={}){let{shape:_e}=_;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let tt=getColors(Object.assign({},_,{numberColors:et.length})),nt=new Shape(_e).getPoints(),rt=Math.min(this.channels,tt[0].length);for(let it=0;it<et.length;it++){let st=tt[it%tt.length],ot=et[it][0],at=et[it][1];for(let lt=0;lt<nt.length;lt++){let ct=nt[lt][0],ht=nt[lt][1];if(ot+ct>=0&&at+ht>=0&&ot+ct<this.width&&at+ht<this.height){let ut=(ot+ct+(at+ht)*this.width)*this.channels;for(let ft=0;ft<rt;ft++)this.data[ut+ft]=st[ft]}}}return this}function paintPolyline(et,_={}){let{color:_e=[this.maxValue,0,0],closed:tt=!1}=_;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let nt=Math.min(this.channels,_e.length);for(let rt=0;rt<et.length-1+tt;rt++){let it=et[rt],st=et[(rt+1)%et.length],ot=st[0]-it[0],at=st[1]-it[1],lt=Math.max(Math.abs(ot),Math.abs(at)),ct=ot/lt,ht=at/lt,ut=it[0],ft=it[1];for(let dt=0;dt<=lt;dt++){let pt=Math.round(ut),mt=Math.round(ft);if(pt>=0&&mt>=0&&pt<this.width&&mt<this.height)if(this.bitDepth===1)this.setBitXY(pt,mt);else{let vt=(pt+mt*this.width)*this.channels;for(let yt=0;yt<nt;yt++)this.data[vt+yt]=_e[yt]}ut=ut+ct,ft=ft+ht}}return this}function paintPolylines(et,_={}){let _e=Object.assign({},_);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let tt=getColors(Object.assign({},_,{numberColors:et.length}));for(let nt=0;nt<et.length;nt++)_e.color=tt[nt%tt.length],this.paintPolyline(et[nt],_e);return this}function paintPolygon(et,_={}){let{color:_e=[this.maxValue,0,0],filled:tt=!1}=_;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),_.closed=!0;let nt=deleteDouble(et);if(tt===!1)return this.paintPolyline(et,_);{let rt=Array(this.height);for(let it=0;it<this.height;it++){rt[it]=[];for(let st=0;st<this.width;st++)rt[it].push(0)}for(let it=0;it<nt.length;it++){const st=lineBetweenTwoPoints(nt[it],nt[(it+1)%nt.length]);for(let ot=0;ot<this.height;ot++)for(let at=0;at<this.width;at++)isAtTheRightOfTheLine(at,ot,st,this.height)&&(rt[ot][at]=rt[ot][at]===0?1:0)}for(let it=0;it<this.height;it++)for(let st=0;st<this.width;st++)if(rt[it][st]===1)if(this.bitDepth===1)this.setBitXY(st,it);else{let ot=Math.min(this.channels,_e.length),at=(st+it*this.width)*this.channels;for(let lt=0;lt<ot;lt++)this.data[at+lt]=_e[lt]}return this.paintPolyline(et,_)}}function deleteDouble(et){let _=[];for(let _e=0;_e<et.length;_e++)if(!(et[_e][0]===et[(_e+1)%et.length][0]&&et[_e][1]===et[(_e+1)%et.length][1])){if(et[_e][0]===et[(_e-1+et.length)%et.length][0]&&et[_e][1]===et[(_e-1+et.length)%et.length][1])continue;if(et[(_e+1)%et.length][0]===et[(_e-1+et.length)%et.length][0]&&et[(_e-1+et.length)%et.length][1]===et[(_e+1)%et.length][1])continue;_.push(et[_e])}return _}function lineBetweenTwoPoints(et,_){if(et[0]===_[0])return{a:0,b:et[0],vertical:!0};{const _e=(_[1]-et[1])/(_[0]-et[0]),tt=et[1]-_e*et[0];return{a:_e,b:tt,vertical:!1}}}function isAtTheRightOfTheLine(et,_,_e,tt){if(_e.vertical===!0)return _e.b<=et;if(_e.a===0)return!1;{const nt=(_-_e.b)/_e.a;return nt<et&&nt>=0&&nt<=tt}}function paintPolygons(et,_={}){let _e=Object.assign({},_);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let tt=getColors(Object.assign({},_,{numberColors:et.length}));for(let nt=0;nt<et.length;nt++)_e.color=tt[nt%tt.length],this.paintPolygon(et[nt],_e);return this}function getHistogram(et={}){let{maxSlots:_=256,channel:_e,useAlpha:tt=!0}=et;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),_e===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");_e=0}return getChannelHistogram.call(this,_e,{useAlpha:tt,maxSlots:_})}function getHistograms(et={}){const{maxSlots:_=256,useAlpha:_e=!0}=et;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let tt=new Array(_e?this.components:this.channels);for(let nt=0;nt<tt.length;nt++)tt[nt]=getChannelHistogram.call(this,nt,{useAlpha:_e,maxSlots:_});return tt}function getChannelHistogram(et,_){let{useAlpha:_e,maxSlots:tt}=_;if(this.bitDepth===1){let ot=[0,0];for(let at=0;at<this.height;at++)for(let lt=0;lt<this.width;lt++){let ct=this.getBitXY(at,lt);ct===0?ot[0]+=1:ct===1&&(ot[1]+=1)}return ot}let nt=Math.log2(tt);if(!isInteger$1(nt))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let rt=0;this.bitDepth>nt&&(rt=this.bitDepth-nt);let it=this.data,st=newArray$1(Math.pow(2,Math.min(this.bitDepth,nt)),0);if(_e&&this.alpha){let ot=this.channels-et-1;for(let at=et;at<it.length;at+=this.channels)st[it[at]>>rt]+=it[at+ot]/this.maxValue}else for(let ot=et;ot<it.length;ot+=this.channels)st[it[ot]>>rt]++;return st}function getColorHistogram(et={}){let{useAlpha:_=!0,nbSlots:_e=512}=et;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let tt=Math.log(_e)/Math.log(8);if(tt!==Math.floor(tt))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let nt=this.bitDepth-tt,rt=this.data,it=newArray$1(Math.pow(8,tt),0),st=Math.pow(2,tt*2),ot=Math.pow(2,tt);for(let at=0;at<rt.length;at+=this.channels){let lt=(rt[at]>>nt)*st+(rt[at+1]>>nt)*ot+(rt[at+2]>>nt);_&&this.alpha?it[lt]+=rt[at+this.channels-1]/this.maxValue:it[lt]++}return it}function min(){this.checkProcessable("min",{bitDepth:[8,16,32]});let et=newArray$1(this.channels,1/0);for(let _=0;_<this.data.length;_+=this.channels)for(let _e=0;_e<this.channels;_e++)this.data[_+_e]<et[_e]&&(et[_e]=this.data[_+_e]);return et}function max(){this.checkProcessable("max",{bitDepth:[8,16,32]});let et=newArray$1(this.channels,-1/0);for(let _=0;_<this.data.length;_+=this.channels)for(let _e=0;_e<this.channels;_e++)this.data[_+_e]>et[_e]&&(et[_e]=this.data[_+_e]);return et}function sum(){this.checkProcessable("sum",{bitDepth:[8,16]});let et=newArray$1(this.channels,0);for(let _=0;_<this.data.length;_+=this.channels)for(let _e=0;_e<this.channels;_e++)et[_e]+=this.data[_+_e];return et}function getMoment(et=0,_=0){this.checkProcessable("getMoment",{bitDepth:[1]});let _e=0;for(let tt=0;tt<this.width;tt++)for(let nt=0;nt<this.height;nt++)this.getBitXY(tt,nt)===1&&(_e+=tt**et*nt**_);return _e}function localMaxima(et={}){let{mask:_,region:_e=3,removeClosePoints:tt=0,invert:nt=!1,maxEquals:rt=2}=et,it=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),_e*=4;let st=nt?0:1,ot=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],at=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],lt=_e<=8?1:2,ct=[];for(let ht=lt;ht<it.height-lt;ht++)for(let ut=lt;ut<it.width-lt;ut++){if(_&&_.getBitXY(ut,ht)!==st)continue;let ft=0,dt=0,pt=it.data[ut+ht*it.width];for(let mt=0;mt<_e;mt++)nt?it.data[ut+ot[mt]+(ht+at[mt])*it.width]>pt&&ft++:it.data[ut+ot[mt]+(ht+at[mt])*it.width]<pt&&ft++,it.data[ut+ot[mt]+(ht+at[mt])*it.width]===pt&&dt++;ft+dt===_e&&dt<=rt&&ct.push([ut,ht])}if(tt>0)for(let ht=0;ht<ct.length;ht++)for(let ut=ht+1;ut<ct.length;ut++)Math.sqrt(Math.pow(ct[ht][0]-ct[ut][0],2)+Math.pow(ct[ht][1]-ct[ut][1],2))<tt&&(ct[ht][0]=ct[ht][0]+ct[ut][0]>>1,ct[ht][1]=ct[ht][1]+ct[ut][1]>>1,ct.splice(ut,1),ut--);return ct}function mean(){let et=this.getHistograms({maxSlots:this.maxValue+1}),_=new Array(et.length);for(let _e=0;_e<et.length;_e++){let tt=et[_e];_[_e]=mean$2(tt)}return _}function median(){let et=this.getHistograms({maxSlots:this.maxValue+1}),_=new Array(et.length);for(let _e=0;_e<et.length;_e++){let tt=et[_e];_[_e]=median$2(tt)}return _}function points(){this.checkProcessable("points",{bitDepth:[1]});const et=[];for(let _=0;_<this.width;_++)for(let _e=0;_e<this.height;_e++)this.getBitXY(_,_e)===1&&et.push([_,_e]);return et}function extendedPoints(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const et=[];for(let _=0;_<this.height;_++)for(let _e=0;_e<this.width;_e++)if(this.getBitXY(_e,_)===1)for(et.push([_e,_]),this.getBitXY(_e+1,_)!==1?(et.push([_e+1,_]),et.push([_e+1,_+1]),this.getBitXY(_e,_+1)!==1&&et.push([_e,_+1])):this.getBitXY(_e,_+1)!==1&&(et.push([_e,_+1]),et.push([_e+1,_+1]));_e<this.width-2&&this.getBitXY(_e+1,_)===1&&this.getBitXY(_e+2,_)===1;)_e++;return et}function getRelativePosition(et,_={}){if(this===et)return[0,0];let _e=[0,0],tt=this;for(;tt;){if(tt===et)return _e;tt.position&&(_e[0]+=tt.position[0],_e[1]+=tt.position[1]),tt=tt.parent}return _.defaultFurther?_e:!1}function countAlphaPixels(et={}){let{alpha:_=1}=et;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let _e=0;if(_!==void 0){for(let tt=this.components;tt<this.data.length;tt+=this.channels)this.data[tt]===_&&_e++;return _e}else return this.size}function monotoneChainConvexHull$1(et,_={}){const{sorted:_e}=_;_e||(et=et.slice().sort(byXThenY));const tt=et.length,nt=new Array(tt*2);let rt=0;for(let st=0;st<tt;st++){const ot=et[st];for(;rt>=2&&cw(nt[rt-2],nt[rt-1],ot)<=0;)rt--;nt[rt++]=ot}const it=rt+1;for(let st=tt-2;st>=0;st--){const ot=et[st];for(;rt>=it&&cw(nt[rt-2],nt[rt-1],ot)<=0;)rt--;nt[rt++]=ot}return nt.slice(0,rt-1)}function cw(et,_,_e){return(_[1]-et[1])*(_e[0]-et[0])-(_[0]-et[0])*(_e[1]-et[1])}function byXThenY(et,_){return et[0]===_[0]?et[1]-_[1]:et[0]-_[0]}function monotoneChainConvexHull(){return monotoneChainConvexHull$1(this.extendedPoints,{sorted:!1})}function round(et){for(let _=0;_<et.length;_++)et[_][0]=Math.round(et[_][0]),et[_][1]=Math.round(et[_][1]);return et}function difference(et,_){return[et[0]-_[0],et[1]-_[1]]}function normalize(et){let _=Math.sqrt(et[0]**2+et[1]**2);return[et[0]/_,et[1]/_]}function rotate(et,_,_e){_e===void 0&&(_e=new Array(_.length));let tt=Math.cos(et),nt=Math.sin(et);for(let rt=0;rt<_e.length;++rt)_e[rt]=[tt*_[rt][0]-nt*_[rt][1],nt*_[rt][0]+tt*_[rt][1]];return _e}function perimeter(et){let _=0;for(let _e=0;_e<et.length;_e++){let tt=et[_e][0],nt=et[_e][1],rt=et[_e===et.length-1?0:_e+1][0],it=et[_e===et.length-1?0:_e+1][1];_+=Math.sqrt((rt-tt)**2+(it-nt)**2)}return _}function surface(et){let _=0;for(let _e=0;_e<et.length;_e++){let tt=et[_e][0],nt=et[_e===et.length-1?0:_e+1][1],rt=et[_e===et.length-1?0:_e+1][0],it=et[_e][1];_+=tt*nt*.5,_-=rt*it*.5}return Math.abs(_)}function minMax(et){let _=1/0,_e=1/0,tt=-1/0,nt=-1/0;for(let rt=0;rt<et.length;rt++)et[rt][0]<_&&(_=et[rt][0]),et[rt][0]>tt&&(tt=et[rt][0]),et[rt][1]<_e&&(_e=et[rt][1]),et[rt][1]>nt&&(nt=et[rt][1]);return[[_,_e],[tt,nt]]}function moveToZeroZero(et,_){_===void 0&&(_=new Array(et.length).fill(0).map(()=>[]));let _e=minMax(et),tt=_e[0][0],nt=_e[0][1];for(let rt=0;rt<et.length;rt++)_[rt][0]=et[rt][0]-tt,_[rt][1]=et[rt][1]-nt;return _}function minimalBoundingRectangle(et={}){const{originalPoints:_=monotoneChainConvexHull.call(this)}=et;if(_.length===0)return[];if(_.length===1)return[_[0],_[0],_[0],_[0]];const _e=new Array(_.length);let tt=1/0,nt=0,rt;for(let it=0;it<_e.length;it++){let st=getAngle$1(_[it],_[(it+1)%_e.length]);rotate(-st,_,_e);let ot=_e[it][0],at=_e[it][1],lt=_e[(it+1)%_e.length][0],ct=_e[(it+1)%_e.length][1],ht=!0,ut=0,ft=0,dt=0;for(let yt=0;yt<_e.length;yt++){let _t=_e[yt][0],St=_e[yt][1],bt=(_t-ot)/(lt-ot);ht===!0?(ht=!1,ut=bt,ft=bt):(bt<ut&&(ut=bt),bt>ft&&(ft=bt));let Et=(-(lt-ot)*St+lt*at-ct*ot)/(lt-ot);Math.abs(Et)>Math.abs(dt)&&(dt=Et)}let pt=[ot+ut*(lt-ot),at],mt=[ot+ft*(lt-ot),at],vt=Math.abs(dt*(ut-ft)*(lt-ot));vt<tt&&(nt=st,tt=vt,rt=[pt,mt,[mt[0],mt[1]-dt],[pt[0],pt[1]-dt]])}return rotate(nt,rt,rt),rt}function getAngle$1(et,_){let _e=difference(_,et),tt=normalize(_e),nt=Math.acos(tt[0]);return tt[1]<0?-nt:nt}function extend$1(et){let _={inPlace:!0};et.extendMethod("invert",invert),et.extendMethod("abs",abs),et.extendMethod("level",level,_),et.extendMethod("add",add,_),et.extendMethod("subtract",subtract,_),et.extendMethod("subtractImage",subtractImage),et.extendMethod("multiply",multiply,_),et.extendMethod("divide",divide,_),et.extendMethod("hypotenuse",hypotenuse),et.extendMethod("background",background$1),et.extendMethod("flipX",flipX),et.extendMethod("flipY",flipY),et.extendMethod("blurFilter",blurFilter),et.extendMethod("medianFilter",medianFilter),et.extendMethod("gaussianFilter",gaussianFilter),et.extendMethod("sobelFilter",sobelFilter),et.extendMethod("gradientFilter",gradientFilter),et.extendMethod("scharrFilter",scharrFilter),et.extendMethod("dilate",dilate),et.extendMethod("erode",erode),et.extendMethod("open",open),et.extendMethod("close",close),et.extendMethod("topHat",topHat),et.extendMethod("blackHat",blackHat),et.extendMethod("morphologicalGradient",morphologicalGradient),et.extendMethod("warpingFourPoints",warpingFourPoints),et.extendMethod("crop",crop),et.extendMethod("cropAlpha",cropAlpha),et.extendMethod("resize",resize).extendMethod("scale",resize),et.extendMethod("hsv",hsv),et.extendMethod("hsl",hsl$1),et.extendMethod("cmyk",cmyk),et.extendMethod("rgba8",rgba8),et.extendMethod("grey",grey).extendMethod("gray",grey),et.extendMethod("mask",mask),et.extendMethod("pad",pad),et.extendMethod("colorDepth",colorDepth),et.extendMethod("setBorder",setBorder,_),et.extendMethod("rotate",rotate$1),et.extendMethod("rotateLeft",rotateLeft),et.extendMethod("rotateRight",rotateRight),et.extendMethod("insert",insert),et.extendMethod("getRow",getRow),et.extendMethod("getColumn",getColumn),et.extendMethod("getMatrix",getMatrix),et.extendMethod("setMatrix",setMatrix),et.extendMethod("getPixelsArray",getPixelsArray),et.extendMethod("getIntersection",getIntersection),et.extendMethod("getClosestCommonParent",getClosestCommonParent),et.extendMethod("getThreshold",getThreshold),et.extendMethod("split",split),et.extendMethod("getChannel",getChannel),et.extendMethod("combineChannels",combineChannels),et.extendMethod("setChannel",setChannel),et.extendMethod("getSimilarity",getSimilarity),et.extendMethod("getPixelsGrid",getPixelsGrid),et.extendMethod("getBestMatch",getBestMatch),et.extendMethod("cannyEdge",cannyEdge),et.extendMethod("convolution",convolution),et.extendMethod("extract",extract),et.extendMethod("floodFill",floodFill),et.extendMethod("paintLabels",paintLabels,_),et.extendMethod("paintMasks",paintMasks,_),et.extendMethod("paintPoints",paintPoints,_),et.extendMethod("paintPolyline",paintPolyline,_),et.extendMethod("paintPolylines",paintPolylines,_),et.extendMethod("paintPolygon",paintPolygon,_),et.extendMethod("paintPolygons",paintPolygons,_),et.extendMethod("countAlphaPixels",countAlphaPixels),et.extendMethod("monotoneChainConvexHull",monotoneChainConvexHull),et.extendMethod("minimalBoundingRectangle",minimalBoundingRectangle),et.extendMethod("getHistogram",getHistogram).extendProperty("histogram",getHistogram),et.extendMethod("getHistograms",getHistograms).extendProperty("histograms",getHistograms),et.extendMethod("getColorHistogram",getColorHistogram).extendProperty("colorHistogram",getColorHistogram),et.extendMethod("getMin",min).extendProperty("min",min),et.extendMethod("getMax",max).extendProperty("max",max),et.extendMethod("getSum",sum).extendProperty("sum",sum),et.extendMethod("getMoment",getMoment).extendProperty("moment",getMoment),et.extendMethod("getLocalMaxima",localMaxima),et.extendMethod("getMedian",median).extendProperty("median",median),et.extendMethod("getMean",mean).extendProperty("mean",mean),et.extendMethod("getPoints",points).extendProperty("points",points),et.extendMethod("getExtendedPoints",extendedPoints).extendProperty("extendedPoints",extendedPoints),et.extendMethod("getRelativePosition",getRelativePosition)}var quantities={exports:{}};(function(et,_){(function(_e,tt){et.exports=tt()})(commonjsGlobal,function(){function _e(jt){return typeof jt=="string"||jt instanceof String}var tt=Number.isFinite||window.isFinite;function nt(jt){return tt(jt)}function rt(jt){return jt}function it(jt){var hn={};return jt.filter(function(En){return hn.hasOwnProperty(En)?!1:hn[En]=!0})}function st(jt,hn){if(hn.length!==jt.length)return!1;for(var En=0;En<jt.length;En++)if(hn[En].compareArray&&!hn[En].compareArray(jt[En])||hn[En]!==jt[En])return!1;return!0}function ot(jt,hn){Object.keys(hn).forEach(function(En){jt[En]=hn[En]})}function at(){for(var jt=1,hn=0,En=0;En<arguments.length;En++){var Vn=arguments[En];hn=hn+ht(Vn),jt*=Vn}return hn!==0?ct(jt,hn):jt}function lt(jt,hn){if(hn===0)throw new Error("Divide by zero");var En=Math.pow(10,ht(hn)),Vn=En/(En*hn);return at(jt,Vn)}function ct(jt,hn){return Math.round(jt*Math.pow(10,hn))/Math.pow(10,hn)}function ht(jt){if(!isFinite(jt))return 0;for(var hn=0;jt%1!==0;)jt*=10,hn++;return hn}function ut(){var jt;if(!this)return jt=Object.create(ut.prototype),ut.apply(jt,arguments),jt;jt=Error.apply(this,arguments),this.name="QtyError",this.message=jt.message,this.stack=jt.stack}ut.prototype=Object.create(Error.prototype,{constructor:{value:ut}});function ft(jt,hn){throw new ut("Incompatible units: "+jt+" and "+hn)}var dt={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","","","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],3600*24,"time",["<second>"]],"<week>":[["wk","week","weeks"],7*3600*24,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","",""],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},pt=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],mt="<1>",vt=[mt];function yt(jt,hn){var En=hn[1],Vn=hn[3]||[],Gn=hn[4]||[];if(!nt(En))throw new ut(jt+": Invalid unit definition. 'scalar' must be a number");Vn.forEach(function(Kn){if(dt[Kn]===void 0)throw new ut(jt+": Invalid unit definition. Unit "+Kn+" in 'numerator' is not recognized")}),Gn.forEach(function(Kn){if(dt[Kn]===void 0)throw new ut(jt+": Invalid unit definition. Unit "+Kn+" in 'denominator' is not recognized")})}var _t={},St={},bt={},Et={},Mt={};for(var Tt in dt)if(dt.hasOwnProperty(Tt)){var wt=dt[Tt];if(wt[2]==="prefix"){_t[Tt]=wt[1];for(var Ct=0;Ct<wt[0].length;Ct++)St[wt[0][Ct]]=Tt}else{yt(Tt,wt),bt[Tt]={scalar:wt[1],numerator:wt[3],denominator:wt[4]};for(var Rt=0;Rt<wt[0].length;Rt++)Et[wt[0][Rt]]=Tt}Mt[Tt]=wt[0][0]}function It(jt){var hn,En=[],Vn=Object.keys(dt);if(typeof jt>"u")for(hn=0;hn<Vn.length;hn++)["","prefix"].indexOf(dt[Vn[hn]][2])===-1&&En.push(Vn[hn].substr(1,Vn[hn].length-2));else{if(this.getKinds().indexOf(jt)===-1)throw new ut("Kind not recognized");for(hn=0;hn<Vn.length;hn++)dt[Vn[hn]][2]===jt&&En.push(Vn[hn].substr(1,Vn[hn].length-2))}return En.sort(function(Gn,Kn){return Gn.toLowerCase()<Kn.toLowerCase()?-1:Gn.toLowerCase()>Kn.toLowerCase()?1:0})}function Dt(jt){if(!Et[jt])throw new ut("Unit not recognized");return dt[Et[jt]][0]}var Ft=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function $t(){if(this.signature)return this.signature;for(var jt=Yt.call(this),hn=0;hn<jt.length;hn++)jt[hn]*=Math.pow(20,hn);return jt.reduce(function(En,Vn){return En+Vn},0)}function Yt(){if(!this.isBase())return Yt.call(this.toBase());for(var jt=new Array(Ft.length),hn=0;hn<jt.length;hn++)jt[hn]=0;for(var En,Vn,Gn=0;Gn<this.numerator.length;Gn++)(En=dt[this.numerator[Gn]])&&(Vn=Ft.indexOf(En[2]),Vn>=0&&(jt[Vn]=jt[Vn]+1));for(var Kn=0;Kn<this.denominator.length;Kn++)(En=dt[this.denominator[Kn]])&&(Vn=Ft.indexOf(En[2]),Vn>=0&&(jt[Vn]=jt[Vn]-1));return jt}var Lt="[+-]",Ot="\\d+",Nt=Lt+"?"+Ot,zt="\\."+Ot,Ht="(?:"+Ot+"(?:"+zt+")?)|(?:"+zt+")",qt="[Ee]"+Nt,Gt="(?:"+Ht+")(?:"+qt+")?",Xt=Lt+"?\\s*"+Gt,Zt="("+Xt+")?\\s*([^/]*)(?:/(.+))?",Qt=new RegExp("^"+Zt+"$"),un="\\^|\\*{2}",wn="[01234]",Tn=new RegExp("([^ \\*\\d]+?)(?:"+un+")?(-?"+wn+"(?![a-zA-Z]))"),yn=new RegExp("([^ \\*\\d]+?)(?:"+un+")?("+wn+"(?![a-zA-Z]))");function Vt(jt){_e(jt)||(jt=jt.toString()),jt=jt.trim();var hn=Qt.exec(jt);if(!hn)throw new ut(jt+": Quantity not recognized");var En=hn[1];En?(En=En.replace(/\s/g,""),this.scalar=parseFloat(En)):this.scalar=1;for(var Vn=hn[2],Gn=hn[3],Kn,br,gr;hn=Tn.exec(Vn);){if(Kn=parseFloat(hn[2]),isNaN(Kn))throw new ut("Unit exponent is not a number");if(Kn===0&&!_n.test(hn[1]))throw new ut("Unit not recognized");br=hn[1]+" ",gr="";for(var Er=0;Er<Math.abs(Kn);Er++)gr+=br;Kn>=0?Vn=Vn.replace(hn[0],gr):(Gn=Gn?Gn+gr:gr,Vn=Vn.replace(hn[0],""))}for(;hn=yn.exec(Gn);){if(Kn=parseFloat(hn[2]),isNaN(Kn))throw new ut("Unit exponent is not a number");if(Kn===0&&!_n.test(hn[1]))throw new ut("Unit not recognized");br=hn[1]+" ",gr="";for(var Tr=0;Tr<Kn;Tr++)gr+=br;Gn=Gn.replace(hn[0],gr)}Vn&&(this.numerator=Wt(Vn.trim())),Gn&&(this.denominator=Wt(Gn.trim()))}var fn=Object.keys(St).sort(function(jt,hn){return hn.length-jt.length}).join("|"),ln=Object.keys(Et).sort(function(jt,hn){return hn.length-jt.length}).join("|"),Jt="\\b|$",on="("+fn+")??("+ln+")(?:"+Jt+")",_n=new RegExp("^\\s*("+on+"[\\s\\*]*)+$"),cn=new RegExp(on,"g"),tn={};function Wt(jt){var hn=tn[jt];if(hn)return hn;var En,Vn=[];if(!_n.test(jt))throw new ut("Unit not recognized");for(;En=cn.exec(jt);)Vn.push(En.slice(1));return Vn=Vn.map(function(Gn){return St[Gn[0]]?[St[Gn[0]],Et[Gn[1]]]:[Et[Gn[1]]]}),Vn=Vn.reduce(function(Gn,Kn){return Gn.concat(Kn)},[]),Vn=Vn.filter(function(Gn){return Gn}),tn[jt]=Vn,Vn}function Bt(jt){if(!_e(jt))throw new ut("Argument should be a string");try{return this(jt)}catch{return null}}function nn(jt){return jt instanceof en}function en(jt,hn){if(mn.apply(null,arguments),!nn(this))return new en(jt,hn);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=vt,this.denominator=vt,sn(jt)?(this.scalar=jt.scalar,this.numerator=jt.numerator&&jt.numerator.length!==0?jt.numerator:vt,this.denominator=jt.denominator&&jt.denominator.length!==0?jt.denominator:vt):hn?(Vt.call(this,hn),this.scalar=jt):Vt.call(this,jt),this.denominator.join("*").indexOf("temp")>=0)throw new ut("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new ut("Cannot multiply by temperatures");if(!st(this.denominator,vt))throw new ut("Cannot divide with temperatures")}if(this.initValue=jt,xn.call(this),this.isTemperature()&&this.baseScalar<0)throw new ut("Temperatures must not be less than absolute zero")}en.prototype={constructor:en};function mn(jt,hn){if(hn){if(!(nt(jt)&&_e(hn)))throw new ut("Only number accepted as initialization value when units are explicitly provided")}else if(!(_e(jt)||nt(jt)||nn(jt)||sn(jt)))throw new ut("Only string, number or quantity accepted as single initialization value")}function sn(jt){return jt&&typeof jt=="object"&&jt.hasOwnProperty("scalar")}function xn(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=$t.call(this);else{var jt=this.toBase();this.baseScalar=jt.scalar,this.signature=jt.signature}}var an={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency","25599999980":"information_rate","25600000000":"information","511999999980":"angular_velocity","512000000000":"angle"};function pn(){return it(Object.keys(an).map(function(jt){return an[jt]}))}en.prototype.kind=function(){return an[this.signature.toString()]},ot(en.prototype,{isDegrees:function(){return(this.signature===null||this.signature===400)&&this.numerator.length===1&&st(this.denominator,vt)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}});function Sn(jt,hn){var En=jt.units(),Vn=hn.to(En),Gn=en(Mn(En));return en({scalar:jt.scalar-Vn.scalar,numerator:Gn.numerator,denominator:Gn.denominator})}function gn(jt,hn){var En=hn.to(Mn(jt.units()));return en({scalar:jt.scalar-En.scalar,numerator:jt.numerator,denominator:jt.denominator})}function Rn(jt,hn){var En=hn.to(Mn(jt.units()));return en({scalar:jt.scalar+En.scalar,numerator:jt.numerator,denominator:jt.denominator})}function Mn(jt){if(jt==="tempK")return"degK";if(jt==="tempC")return"degC";if(jt==="tempF")return"degF";if(jt==="tempR")return"degR";throw new ut("Unknown type for temp conversion from: "+jt)}function kn(jt,hn){var En=Fn(jt),Vn=hn.units(),Gn;if(Vn==="degK")Gn=En.scalar;else if(Vn==="degC")Gn=En.scalar;else if(Vn==="degF")Gn=En.scalar*9/5;else if(Vn==="degR")Gn=En.scalar*9/5;else throw new ut("Unknown type for degree conversion to: "+Vn);return en({scalar:Gn,numerator:hn.numerator,denominator:hn.denominator})}function Fn(jt){var hn=jt.units(),En;if(hn.match(/(deg)[CFRK]/))En=jt.baseScalar;else if(hn==="tempK")En=jt.scalar;else if(hn==="tempC")En=jt.scalar;else if(hn==="tempF")En=jt.scalar*5/9;else if(hn==="tempR")En=jt.scalar*5/9;else throw new ut("Unknown type for temp conversion from: "+hn);return en({scalar:En,numerator:["<kelvin>"],denominator:vt})}function Nn(jt,hn){var En=hn.units(),Vn;if(En==="tempK")Vn=jt.baseScalar;else if(En==="tempC")Vn=jt.baseScalar-273.15;else if(En==="tempF")Vn=jt.baseScalar*9/5-459.67;else if(En==="tempR")Vn=jt.baseScalar*9/5;else throw new ut("Unknown type for temp conversion to: "+En);return en({scalar:Vn,numerator:hn.numerator,denominator:hn.denominator})}function Zn(jt){var hn=jt.units(),En;if(hn.match(/(deg)[CFRK]/))En=jt.baseScalar;else if(hn==="tempK")En=jt.scalar;else if(hn==="tempC")En=jt.scalar+273.15;else if(hn==="tempF")En=(jt.scalar+459.67)*5/9;else if(hn==="tempR")En=jt.scalar*5/9;else throw new ut("Unknown type for temp conversion from: "+hn);return en({scalar:En,numerator:["<temp-K>"],denominator:vt})}ot(en.prototype,{to:function(jt){var hn,En;if(jt==null)return this;if(!_e(jt))return this.to(jt.units());if(hn=this._conversionCache[jt],hn)return hn;if(En=en(jt),En.units()===this.units())return this;if(!this.isCompatible(En))this.isInverse(En)?En=this.inverse().to(jt):ft(this.units(),En.units());else if(En.isTemperature())En=Nn(this,En);else if(En.isDegrees())En=kn(this,En);else{var Vn=lt(this.baseScalar,En.baseScalar);En=en({scalar:Vn,numerator:En.numerator,denominator:En.denominator})}return this._conversionCache[jt]=En,En},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return Zn(this);var jt=dn[this.units()];return jt||(jt=$n(this.numerator,this.denominator),dn[this.units()]=jt),jt.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new ut("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(jt){if(_e(jt)&&(jt=en(jt)),nt(jt)&&(jt=en(jt+" "+this.units())),this.isUnitless()?jt.isUnitless()||ft(this.units(),jt.units()):jt=jt.to(this.units()),jt.scalar===0)throw new ut("Divide by zero");var hn=at(Math.round(this.scalar/jt.scalar),jt.scalar);return en(hn+this.units())}});function er(jt,hn){var En=en(jt),Vn=en(hn);if(En.eq(Vn))return rt;var Gn;return En.isTemperature()?Gn=function(Kn){return En.mul(Kn).to(Vn).scalar}:Gn=function(Kn){return Kn*En.baseScalar/Vn.baseScalar},function(br){var gr,Er,Tr;if(Array.isArray(br)){for(Er=br.length,Tr=[],gr=0;gr<Er;gr++)Tr.push(Gn(br[gr]));return Tr}else return Gn(br)}}var dn={};function $n(jt,hn){for(var En=[],Vn=[],Gn=1,Kn,br=0;br<jt.length;br++)Kn=jt[br],_t[Kn]?Gn=at(Gn,_t[Kn]):bt[Kn]&&(Gn*=bt[Kn].scalar,bt[Kn].numerator&&En.push(bt[Kn].numerator),bt[Kn].denominator&&Vn.push(bt[Kn].denominator));for(var gr=0;gr<hn.length;gr++)Kn=hn[gr],_t[Kn]?Gn/=_t[Kn]:bt[Kn]&&(Gn/=bt[Kn].scalar,bt[Kn].numerator&&Vn.push(bt[Kn].numerator),bt[Kn].denominator&&En.push(bt[Kn].denominator));return En=En.reduce(function(Er,Tr){return Er.concat(Tr)},[]),Vn=Vn.reduce(function(Er,Tr){return Er.concat(Tr)},[]),en({scalar:Gn,numerator:En,denominator:Vn})}en.parse=Bt,en.getUnits=It,en.getAliases=Dt,en.mulSafe=at,en.divSafe=lt,en.getKinds=pn,en.swiftConverter=er,en.Error=ut,ot(en.prototype,{add:function(jt){if(_e(jt)&&(jt=en(jt)),this.isCompatible(jt)||ft(this.units(),jt.units()),this.isTemperature()&&jt.isTemperature())throw new ut("Cannot add two temperatures");return this.isTemperature()?Rn(this,jt):jt.isTemperature()?Rn(jt,this):en({scalar:this.scalar+jt.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(jt){if(_e(jt)&&(jt=en(jt)),this.isCompatible(jt)||ft(this.units(),jt.units()),this.isTemperature()&&jt.isTemperature())return Sn(this,jt);if(this.isTemperature())return gn(this,jt);if(jt.isTemperature())throw new ut("Cannot subtract a temperature from a differential degree unit");return en({scalar:this.scalar-jt.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(jt){if(nt(jt))return en({scalar:at(this.scalar,jt),numerator:this.numerator,denominator:this.denominator});if(_e(jt)&&(jt=en(jt)),(this.isTemperature()||jt.isTemperature())&&!(this.isUnitless()||jt.isUnitless()))throw new ut("Cannot multiply by temperatures");var hn=this,En=jt;hn.isCompatible(En)&&hn.signature!==400&&(En=En.to(hn));var Vn=Pn(hn.numerator,hn.denominator,En.numerator,En.denominator);return en({scalar:at(hn.scalar,En.scalar,Vn[2]),numerator:Vn[0],denominator:Vn[1]})},div:function(jt){if(nt(jt)){if(jt===0)throw new ut("Divide by zero");return en({scalar:this.scalar/jt,numerator:this.numerator,denominator:this.denominator})}else _e(jt)&&(jt=en(jt));if(jt.scalar===0)throw new ut("Divide by zero");if(jt.isTemperature())throw new ut("Cannot divide with temperatures");if(this.isTemperature()&&!jt.isUnitless())throw new ut("Cannot divide with temperatures");var hn=this,En=jt;hn.isCompatible(En)&&hn.signature!==400&&(En=En.to(hn));var Vn=Pn(hn.numerator,hn.denominator,En.denominator,En.numerator);return en({scalar:at(hn.scalar,Vn[2])/En.scalar,numerator:Vn[0],denominator:Vn[1]})},inverse:function(){if(this.isTemperature())throw new ut("Cannot divide with temperatures");if(this.scalar===0)throw new ut("Divide by zero");return en({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}});function Pn(jt,hn,En,Vn){function Gn(Ur){return Ur!==mt}jt=jt.filter(Gn),En=En.filter(Gn),hn=hn.filter(Gn),Vn=Vn.filter(Gn);var Kn={};function br(Ur,Qr){for(var $r,Kt,vn,In=0;In<Ur.length;In++)if(_t[Ur[In]]?($r=Ur[In+1],Kt=Ur[In],vn=_t[Kt],In++):($r=Ur[In],Kt=null,vn=1),$r&&$r!==mt)if(Kn[$r]){Kn[$r][0]+=Qr;var Ln=Kn[$r][2]?_t[Kn[$r][2]]:1;Kn[$r][Qr===1?3:4]*=lt(vn,Ln)}else Kn[$r]=[Qr,$r,Kt,1,1]}br(jt,1),br(hn,-1),br(En,1),br(Vn,-1);var gr=[],Er=[],Tr=1;for(var zr in Kn)if(Kn.hasOwnProperty(zr)){var wr=Kn[zr],Wr;if(wr[0]>0)for(Wr=0;Wr<wr[0];Wr++)gr.push(wr[2]===null?wr[1]:[wr[2],wr[1]]);else if(wr[0]<0)for(Wr=0;Wr<-wr[0];Wr++)Er.push(wr[2]===null?wr[1]:[wr[2],wr[1]]);Tr*=lt(wr[3],wr[4])}return gr.length===0&&(gr=vt),Er.length===0&&(Er=vt),gr=gr.reduce(function(Ur,Qr){return Ur.concat(Qr)},[]),Er=Er.reduce(function(Ur,Qr){return Ur.concat(Qr)},[]),[gr,Er,Tr]}ot(en.prototype,{eq:function(jt){return this.compareTo(jt)===0},lt:function(jt){return this.compareTo(jt)===-1},lte:function(jt){return this.eq(jt)||this.lt(jt)},gt:function(jt){return this.compareTo(jt)===1},gte:function(jt){return this.eq(jt)||this.gt(jt)},compareTo:function(jt){if(_e(jt))return this.compareTo(en(jt));if(this.isCompatible(jt)||ft(this.units(),jt.units()),this.baseScalar<jt.baseScalar)return-1;if(this.baseScalar===jt.baseScalar)return 0;if(this.baseScalar>jt.baseScalar)return 1},same:function(jt){return this.scalar===jt.scalar&&this.units()===jt.units()}}),ot(en.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every(function(jt){return st(jt,vt)})},isCompatible:function(jt){return _e(jt)?this.isCompatible(en(jt)):nn(jt)&&jt.signature!==void 0?this.signature===jt.signature:!1},isInverse:function(jt){return this.inverse().isCompatible(jt)},isBase:function(){return this._isBase!==void 0?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach(function(jt){jt!==mt&&pt.indexOf(jt)===-1&&(this._isBase=!1)},this),this._isBase===!1?this._isBase:(this._isBase=!0,this._isBase))}});function Dn(){}Dn.prototype.get=function(jt){return arguments.length>1&&(jt=Array.apply(null,arguments)),jt.reduce(function(hn,En,Vn){if(hn){var Gn=hn[En];return Vn===jt.length-1?Gn?Gn.data:void 0:Gn}},this)},Dn.prototype.set=function(jt,hn){return arguments.length>2&&(jt=Array.prototype.slice.call(arguments,0,-1),hn=arguments[arguments.length-1]),jt.reduce(function(En,Vn,Gn){var Kn=En[Vn];return Kn===void 0&&(Kn=En[Vn]={}),Gn===jt.length-1?(Kn.data=hn,hn):Kn},this)};function Hn(jt,hn){return(jt+" "+hn).trim()}en.formatter=Hn,ot(en.prototype,{units:function(){if(this._units!==void 0)return this._units;var jt=st(this.numerator,vt),hn=st(this.denominator,vt);if(jt&&hn)return this._units="",this._units;var En=qn(this.numerator),Vn=qn(this.denominator);return this._units=En+(hn?"":"/"+Vn),this._units},toString:function(jt,hn){var En;if(nt(jt))En=this.units(),hn=jt;else if(_e(jt))En=jt;else if(nn(jt))return this.toPrec(jt).toString(hn);var Vn=this.to(En),Gn=hn!==void 0?ct(Vn.scalar,hn):Vn.scalar;return Vn=(Gn+" "+Vn.units()).trim(),Vn},format:function(jt,hn){arguments.length===1&&typeof jt=="function"&&(hn=jt,jt=void 0),hn=hn||en.formatter;var En=this.to(jt);return hn.call(this,En.scalar,En.units())}});var jn=new Dn;function qn(jt){var hn=jn.get(jt);if(hn)return hn;var En=st(jt,vt);return En?hn="1":hn=fr(hr(jt)).join("*"),jn.set(jt,hn),hn}function hr(jt){for(var hn=[],En,Vn,Gn=0;Gn<jt.length;Gn++)En=jt[Gn],Vn=jt[Gn+1],_t[En]?(hn.push(Mt[En]+Mt[Vn]),Gn++):hn.push(Mt[En]);return hn}function fr(jt){var hn=jt.reduce(function(En,Vn){var Gn=En[Vn];return Gn||En.push(Gn=En[Vn]=[Vn,0]),Gn[1]++,En},[]);return hn.map(function(En){return En[0]+(En[1]>1?En[1]:"")})}return en.version="1.8.0",en})})(quantities);var quantitiesExports=quantities.exports;const Qty=getDefaultExportFromCjs(quantitiesExports);function deepValue(et,_=""){let _e=_.split(".");for(let tt of _e){if(et[tt]===void 0)return;et=et[tt]}return et}var orientation={exports:{}},twoProduct_1=twoProduct$1,SPLITTER=+(Math.pow(2,27)+1);function twoProduct$1(et,_,_e){var tt=et*_,nt=SPLITTER*et,rt=nt-et,it=nt-rt,st=et-it,ot=SPLITTER*_,at=ot-_,lt=ot-at,ct=_-lt,ht=tt-it*lt,ut=ht-st*lt,ft=ut-it*ct,dt=st*ct-ft;return _e?(_e[0]=dt,_e[1]=tt,_e):[dt,tt]}var robustSum=linearExpansionSum;function scalarScalar$1(et,_){var _e=et+_,tt=_e-et,nt=_e-tt,rt=_-tt,it=et-nt,st=it+rt;return st?[st,_e]:[_e]}function linearExpansionSum(et,_){var _e=et.length|0,tt=_.length|0;if(_e===1&&tt===1)return scalarScalar$1(et[0],_[0]);var nt=_e+tt,rt=new Array(nt),it=0,st=0,ot=0,at=Math.abs,lt=et[st],ct=at(lt),ht=_[ot],ut=at(ht),ft,dt;ct<ut?(dt=lt,st+=1,st<_e&&(lt=et[st],ct=at(lt))):(dt=ht,ot+=1,ot<tt&&(ht=_[ot],ut=at(ht))),st<_e&&ct<ut||ot>=tt?(ft=lt,st+=1,st<_e&&(lt=et[st],ct=at(lt))):(ft=ht,ot+=1,ot<tt&&(ht=_[ot],ut=at(ht)));for(var pt=ft+dt,mt=pt-ft,vt=dt-mt,yt=vt,_t=pt,St,bt,Et,Mt,Tt;st<_e&&ot<tt;)ct<ut?(ft=lt,st+=1,st<_e&&(lt=et[st],ct=at(lt))):(ft=ht,ot+=1,ot<tt&&(ht=_[ot],ut=at(ht))),dt=yt,pt=ft+dt,mt=pt-ft,vt=dt-mt,vt&&(rt[it++]=vt),St=_t+pt,bt=St-_t,Et=St-bt,Mt=pt-bt,Tt=_t-Et,yt=Tt+Mt,_t=St;for(;st<_e;)ft=lt,dt=yt,pt=ft+dt,mt=pt-ft,vt=dt-mt,vt&&(rt[it++]=vt),St=_t+pt,bt=St-_t,Et=St-bt,Mt=pt-bt,Tt=_t-Et,yt=Tt+Mt,_t=St,st+=1,st<_e&&(lt=et[st]);for(;ot<tt;)ft=ht,dt=yt,pt=ft+dt,mt=pt-ft,vt=dt-mt,vt&&(rt[it++]=vt),St=_t+pt,bt=St-_t,Et=St-bt,Mt=pt-bt,Tt=_t-Et,yt=Tt+Mt,_t=St,ot+=1,ot<tt&&(ht=_[ot]);return yt&&(rt[it++]=yt),_t&&(rt[it++]=_t),it||(rt[it++]=0),rt.length=it,rt}var twoSum$1=fastTwoSum;function fastTwoSum(et,_,_e){var tt=et+_,nt=tt-et,rt=tt-nt,it=_-nt,st=et-rt;return _e?(_e[0]=st+it,_e[1]=tt,_e):[st+it,tt]}var twoProduct=twoProduct_1,twoSum=twoSum$1,robustScale=scaleLinearExpansion;function scaleLinearExpansion(et,_){var _e=et.length;if(_e===1){var tt=twoProduct(et[0],_);return tt[0]?tt:[tt[1]]}var nt=new Array(2*_e),rt=[.1,.1],it=[.1,.1],st=0;twoProduct(et[0],_,rt),rt[0]&&(nt[st++]=rt[0]);for(var ot=1;ot<_e;++ot){twoProduct(et[ot],_,it);var at=rt[1];twoSum(at,it[0],rt),rt[0]&&(nt[st++]=rt[0]);var lt=it[1],ct=rt[1],ht=lt+ct,ut=ht-lt,ft=ct-ut;rt[1]=ht,ft&&(nt[st++]=ft)}return rt[1]&&(nt[st++]=rt[1]),st===0&&(nt[st++]=0),nt.length=st,nt}var robustDiff=robustSubtract;function scalarScalar(et,_){var _e=et+_,tt=_e-et,nt=_e-tt,rt=_-tt,it=et-nt,st=it+rt;return st?[st,_e]:[_e]}function robustSubtract(et,_){var _e=et.length|0,tt=_.length|0;if(_e===1&&tt===1)return scalarScalar(et[0],-_[0]);var nt=_e+tt,rt=new Array(nt),it=0,st=0,ot=0,at=Math.abs,lt=et[st],ct=at(lt),ht=-_[ot],ut=at(ht),ft,dt;ct<ut?(dt=lt,st+=1,st<_e&&(lt=et[st],ct=at(lt))):(dt=ht,ot+=1,ot<tt&&(ht=-_[ot],ut=at(ht))),st<_e&&ct<ut||ot>=tt?(ft=lt,st+=1,st<_e&&(lt=et[st],ct=at(lt))):(ft=ht,ot+=1,ot<tt&&(ht=-_[ot],ut=at(ht)));for(var pt=ft+dt,mt=pt-ft,vt=dt-mt,yt=vt,_t=pt,St,bt,Et,Mt,Tt;st<_e&&ot<tt;)ct<ut?(ft=lt,st+=1,st<_e&&(lt=et[st],ct=at(lt))):(ft=ht,ot+=1,ot<tt&&(ht=-_[ot],ut=at(ht))),dt=yt,pt=ft+dt,mt=pt-ft,vt=dt-mt,vt&&(rt[it++]=vt),St=_t+pt,bt=St-_t,Et=St-bt,Mt=pt-bt,Tt=_t-Et,yt=Tt+Mt,_t=St;for(;st<_e;)ft=lt,dt=yt,pt=ft+dt,mt=pt-ft,vt=dt-mt,vt&&(rt[it++]=vt),St=_t+pt,bt=St-_t,Et=St-bt,Mt=pt-bt,Tt=_t-Et,yt=Tt+Mt,_t=St,st+=1,st<_e&&(lt=et[st]);for(;ot<tt;)ft=ht,dt=yt,pt=ft+dt,mt=pt-ft,vt=dt-mt,vt&&(rt[it++]=vt),St=_t+pt,bt=St-_t,Et=St-bt,Mt=pt-bt,Tt=_t-Et,yt=Tt+Mt,_t=St,ot+=1,ot<tt&&(ht=-_[ot]);return yt&&(rt[it++]=yt),_t&&(rt[it++]=_t),it||(rt[it++]=0),rt.length=it,rt}(function(et){var _=twoProduct_1,_e=robustSum,tt=robustScale,nt=robustDiff,rt=5,it=11102230246251565e-32,st=(3+16*it)*it,ot=(7+56*it)*it;function at(yt,_t,St,bt){return function(Mt,Tt,wt){var Ct=yt(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0]))),Rt=yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),It=bt(Ct,Rt);return It[It.length-1]}}function lt(yt,_t,St,bt){return function(Mt,Tt,wt,Ct){var Rt=yt(yt(St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Tt[2]),yt(St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),-wt[2]),St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Ct[2]))),yt(St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),Ct[2])))),It=yt(yt(St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),-wt[2]),St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),Ct[2]))),yt(St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),wt[2])))),Dt=bt(Rt,It);return Dt[Dt.length-1]}}function ct(yt,_t,St,bt){return function(Mt,Tt,wt,Ct,Rt){var It=yt(yt(yt(St(yt(St(yt(_t(Ct[1],Rt[0]),_t(-Rt[1],Ct[0])),wt[2]),yt(St(yt(_t(wt[1],Rt[0]),_t(-Rt[1],wt[0])),-Ct[2]),St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Rt[2]))),Tt[3]),yt(St(yt(St(yt(_t(Ct[1],Rt[0]),_t(-Rt[1],Ct[0])),Tt[2]),yt(St(yt(_t(Tt[1],Rt[0]),_t(-Rt[1],Tt[0])),-Ct[2]),St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),Rt[2]))),-wt[3]),St(yt(St(yt(_t(wt[1],Rt[0]),_t(-Rt[1],wt[0])),Tt[2]),yt(St(yt(_t(Tt[1],Rt[0]),_t(-Rt[1],Tt[0])),-wt[2]),St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Rt[2]))),Ct[3]))),yt(St(yt(St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Tt[2]),yt(St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),-wt[2]),St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Ct[2]))),-Rt[3]),yt(St(yt(St(yt(_t(Ct[1],Rt[0]),_t(-Rt[1],Ct[0])),Tt[2]),yt(St(yt(_t(Tt[1],Rt[0]),_t(-Rt[1],Tt[0])),-Ct[2]),St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),Rt[2]))),Mt[3]),St(yt(St(yt(_t(Ct[1],Rt[0]),_t(-Rt[1],Ct[0])),Mt[2]),yt(St(yt(_t(Mt[1],Rt[0]),_t(-Rt[1],Mt[0])),-Ct[2]),St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),Rt[2]))),-Tt[3])))),yt(yt(St(yt(St(yt(_t(Tt[1],Rt[0]),_t(-Rt[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Rt[0]),_t(-Rt[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),Rt[2]))),Ct[3]),yt(St(yt(St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),Ct[2]))),-Rt[3]),St(yt(St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Tt[2]),yt(St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),-wt[2]),St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Ct[2]))),Mt[3]))),yt(St(yt(St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),-wt[2]),St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),Ct[2]))),-Tt[3]),yt(St(yt(St(yt(_t(Tt[1],Ct[0]),_t(-Ct[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),Ct[2]))),wt[3]),St(yt(St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),wt[2]))),-Ct[3]))))),Dt=yt(yt(yt(St(yt(St(yt(_t(Ct[1],Rt[0]),_t(-Rt[1],Ct[0])),wt[2]),yt(St(yt(_t(wt[1],Rt[0]),_t(-Rt[1],wt[0])),-Ct[2]),St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Rt[2]))),Mt[3]),St(yt(St(yt(_t(Ct[1],Rt[0]),_t(-Rt[1],Ct[0])),Mt[2]),yt(St(yt(_t(Mt[1],Rt[0]),_t(-Rt[1],Mt[0])),-Ct[2]),St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),Rt[2]))),-wt[3])),yt(St(yt(St(yt(_t(wt[1],Rt[0]),_t(-Rt[1],wt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Rt[0]),_t(-Rt[1],Mt[0])),-wt[2]),St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),Rt[2]))),Ct[3]),St(yt(St(yt(_t(wt[1],Ct[0]),_t(-Ct[1],wt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Ct[0]),_t(-Ct[1],Mt[0])),-wt[2]),St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),Ct[2]))),-Rt[3]))),yt(yt(St(yt(St(yt(_t(wt[1],Rt[0]),_t(-Rt[1],wt[0])),Tt[2]),yt(St(yt(_t(Tt[1],Rt[0]),_t(-Rt[1],Tt[0])),-wt[2]),St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Rt[2]))),Mt[3]),St(yt(St(yt(_t(wt[1],Rt[0]),_t(-Rt[1],wt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Rt[0]),_t(-Rt[1],Mt[0])),-wt[2]),St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),Rt[2]))),-Tt[3])),yt(St(yt(St(yt(_t(Tt[1],Rt[0]),_t(-Rt[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],Rt[0]),_t(-Rt[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),Rt[2]))),wt[3]),St(yt(St(yt(_t(Tt[1],wt[0]),_t(-wt[1],Tt[0])),Mt[2]),yt(St(yt(_t(Mt[1],wt[0]),_t(-wt[1],Mt[0])),-Tt[2]),St(yt(_t(Mt[1],Tt[0]),_t(-Tt[1],Mt[0])),wt[2]))),-Rt[3])))),Ft=bt(It,Dt);return Ft[Ft.length-1]}}function ht(yt){var _t=yt===3?at:yt===4?lt:ct;return _t(_e,_,tt,nt)}var ut=ht(3),ft=ht(4),dt=[function(){return 0},function(){return 0},function(_t,St){return St[0]-_t[0]},function(_t,St,bt){var Et=(_t[1]-bt[1])*(St[0]-bt[0]),Mt=(_t[0]-bt[0])*(St[1]-bt[1]),Tt=Et-Mt,wt;if(Et>0){if(Mt<=0)return Tt;wt=Et+Mt}else if(Et<0){if(Mt>=0)return Tt;wt=-(Et+Mt)}else return Tt;var Ct=st*wt;return Tt>=Ct||Tt<=-Ct?Tt:ut(_t,St,bt)},function(_t,St,bt,Et){var Mt=_t[0]-Et[0],Tt=St[0]-Et[0],wt=bt[0]-Et[0],Ct=_t[1]-Et[1],Rt=St[1]-Et[1],It=bt[1]-Et[1],Dt=_t[2]-Et[2],Ft=St[2]-Et[2],$t=bt[2]-Et[2],Yt=Tt*It,Lt=wt*Rt,Ot=wt*Ct,Nt=Mt*It,zt=Mt*Rt,Ht=Tt*Ct,qt=Dt*(Yt-Lt)+Ft*(Ot-Nt)+$t*(zt-Ht),Gt=(Math.abs(Yt)+Math.abs(Lt))*Math.abs(Dt)+(Math.abs(Ot)+Math.abs(Nt))*Math.abs(Ft)+(Math.abs(zt)+Math.abs(Ht))*Math.abs($t),Xt=ot*Gt;return qt>Xt||-qt>Xt?qt:ft(_t,St,bt,Et)}];function pt(yt){var _t=dt[yt.length];return _t||(_t=dt[yt.length]=ht(yt.length)),_t.apply(void 0,yt)}function mt(yt,_t,St,bt,Et,Mt,Tt){return function(Ct,Rt,It,Dt,Ft){switch(arguments.length){case 0:case 1:return 0;case 2:return bt(Ct,Rt);case 3:return Et(Ct,Rt,It);case 4:return Mt(Ct,Rt,It,Dt);case 5:return Tt(Ct,Rt,It,Dt,Ft)}for(var $t=new Array(arguments.length),Yt=0;Yt<arguments.length;++Yt)$t[Yt]=arguments[Yt];return yt($t)}}function vt(){for(;dt.length<=rt;)dt.push(ht(dt.length));et.exports=mt.apply(void 0,[pt].concat(dt));for(var yt=0;yt<=rt;++yt)et.exports[yt]=dt[yt]}vt()})(orientation);var orientationExports=orientation.exports,robustPnp=robustPointInPolygon,orient=orientationExports;function robustPointInPolygon(et,_){for(var _e=_[0],tt=_[1],nt=et.length,rt=1,it=nt,st=0,ot=nt-1;st<it;ot=st++){var at=et[st],lt=et[ot],ct=at[1],ht=lt[1];if(ht<ct){if(ht<tt&&tt<ct){var ut=orient(at,lt,_);if(ut===0)return 0;rt^=0<ut|0}else if(tt===ct){var ft=et[(st+1)%nt],dt=ft[1];if(ct<dt){var ut=orient(at,lt,_);if(ut===0)return 0;rt^=0<ut|0}}}else if(ct<ht){if(ct<tt&&tt<ht){var ut=orient(at,lt,_);if(ut===0)return 0;rt^=ut<0|0}else if(tt===ct){var ft=et[(st+1)%nt],dt=ft[1];if(dt<ct){var ut=orient(at,lt,_);if(ut===0)return 0;rt^=ut<0|0}}}else if(tt===ct){var pt=Math.min(at[0],lt[0]),mt=Math.max(at[0],lt[0]);if(st===0){for(;ot>0;){var vt=(ot+nt-1)%nt,yt=et[vt];if(yt[1]!==tt)break;var _t=yt[0];pt=Math.min(pt,_t),mt=Math.max(mt,_t),ot=vt}if(ot===0)return pt<=_e&&_e<=mt?0:1;it=ot+1}for(var St=et[(ot+nt-1)%nt][1];st+1<it;){var yt=et[st+1];if(yt[1]!==tt)break;var _t=yt[0];pt=Math.min(pt,_t),mt=Math.max(mt,_t),st+=1}if(pt<=_e&&_e<=mt)return 0;var bt=et[(st+1)%nt][1];_e<pt&&St<tt!=bt<tt&&(rt^=1)}}return 2*rt-1}const robustPointInPolygon$1=getDefaultExportFromCjs(robustPnp);function feretDiameters(et={}){const{originalPoints:_=monotoneChainConvexHull.call(this)}=et;if(_.length===0)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(_.length===1)return{min:1,max:1,minLine:[_[0],_[0]],maxLine:[_[0],_[0]],aspectRatio:1};const _e=new Array(_.length);let tt=1/0,nt=0,rt=[];for(let at=0;at<_.length;at++){let lt=getAngle(_[at],_[(at+1)%_.length]);rotate(-lt,_,_e);let ct=0,ht=[];for(let ut=0;ut<_.length;ut++){let ft=Math.abs(_e[at][1]-_e[ut][1]);ft>ct&&(ct=ft,ht=[],ht.push([_e[ut][0],_e[at][1]],[_e[ut][0],_e[ut][1]]))}ct<tt&&(tt=ct,nt=lt,rt=ht)}rotate(nt,rt,rt);let it=0,st=[],ot=0;for(let at=0;at<_.length-1;at++)for(let lt=at+1;lt<_.length;lt++){let ct=(_[at][0]-_[lt][0])**2+(_[at][1]-_[lt][1])**2;ct>ot&&(ot=ct,it=Math.sqrt(ct),st=[_[at],_[lt]])}return{min:tt,minLine:rt,max:it,maxLine:st,aspectRatio:tt/it}}function getAngle(et,_){let _e=difference(_,et),tt=normalize(_e),nt=Math.acos(tt[0]);return tt[1]<0?-nt:nt}class Roi{constructor(_,_e){this.map=_,this.id=_e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(_={}){const{scale:_e=1,kind:tt=""}=_;let nt;switch(tt){case"contour":nt=this.contourMask;break;case"box":nt=this.boxMask;break;case"filled":nt=this.filledMask;break;case"center":nt=this.centerMask;break;case"mbr":nt=this.mbrFilledMask;break;case"hull":nt=this.convexHullFilledMask;break;case"hullContour":nt=this.convexHullMask;break;case"mbrContour":nt=this.mbrMask;break;case"feret":nt=this.feretMask;break;default:nt=this.mask}return _e<1&&(nt=nt.resize({factor:_e}),nt.parent=this.mask.parent,nt.position[0]+=this.minX,nt.position[1]+=this.minY),nt}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let _=this.borderIDs,_e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let tt=this.internalIDs;for(let nt=0;nt<_.length;nt++)tt.includes(_[nt])||(this.computed.externalIDs.push(_[nt]),this.computed.externalLengths.push(_e[nt]))}get externalIDs(){return this.computed.externalIDs?this.computed.externalIDs:(this._computExternalIDs(),this.computed.externalIDs)}get externalLengths(){return this.computed.externalLengths?this.computed.externalLengths:(this._computExternalIDs(),this.computed.externalLengths)}_computeBorderIDs(){let _=getBorders(this);this.computed.borderIDs=_.ids,this.computed.borderLengths=_.lengths}get borderIDs(){return this.computed.borderIDs?this.computed.borderIDs:(this._computeBorderIDs(),this.computed.borderIDs)}get borderLengths(){return this.computed.borderLengths?this.computed.borderLengths:(this._computeBorderIDs(),this.computed.borderLengths)}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=getBoxIDs(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=getInternalIDs(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=getBox(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=getExternal(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=getHolesInfo(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=getBorder(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let _=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let _e=0;_e<this.width;_e++)for(let tt=0;tt<this.height;tt++)this.map.data[_e+this.minX+(tt+this.minY)*this.map.width]===this.id&&(_e>0&&_e<this.width-1&&tt>0&&tt<this.height-1?(this.map.data[_e-1+this.minX+(tt+this.minY)*this.map.width]!==this.id||this.map.data[_e+1+this.minX+(tt+this.minY)*this.map.width]!==this.id||this.map.data[_e+this.minX+(tt-1+this.minY)*this.map.width]!==this.id||this.map.data[_e+this.minX+(tt+1+this.minY)*this.map.width]!==this.id)&&_.setBitXY(_e,tt):_.setBitXY(_e,tt));this.computed.contourMask=_}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let _=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let _e=0;_e<this.width;_e++)_.setBitXY(_e,0),_.setBitXY(_e,this.height-1);for(let _e=0;_e<this.height;_e++)_.setBitXY(0,_e),_.setBitXY(this.width-1,_e);this.computed.boxMask=_}return this.computed.boxMask}get mask(){if(!this.computed.mask){let _=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let _e=0;_e<this.width;_e++)for(let tt=0;tt<this.height;tt++)this.map.data[_e+this.minX+(tt+this.minY)*this.map.width]===this.id&&_.setBitXY(_e,tt);this.computed.mask=_}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let _=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let _e=0;_e<this.width;_e++)for(let tt=0;tt<this.height;tt++){let nt=_e+this.minX+(tt+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[nt])&&_.setBitXY(_e,tt)}this.computed.filledMask=_}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let _=new Shape({kind:"smallCross"}).getMask();_.parent=this.map.parent,_.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=_}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const _=[];for(let tt=0;tt<this.width;tt++)for(let nt=0;nt<this.height;nt++)this.map.data[tt+this.minX+(nt+this.minY)*this.map.width]===this.id&&(tt>0&&tt<this.width-1&&nt>0&&nt<this.height-1?(this.map.data[tt-1+this.minX+(nt+this.minY)*this.map.width]!==this.id||this.map.data[tt+1+this.minX+(nt+this.minY)*this.map.width]!==this.id||this.map.data[tt+this.minX+(nt-1+this.minY)*this.map.width]!==this.id||this.map.data[tt+this.minX+(nt+1+this.minY)*this.map.width]!==this.id)&&(_.push([tt,nt]),_.push([tt+1,nt]),_.push([tt,nt+1]),_.push([tt+1,nt+1])):(_.push([tt,nt]),_.push([tt+1,nt]),_.push([tt,nt+1]),_.push([tt+1,nt+1])));const _e=monotoneChainConvexHull$1(_);this.computed.convexHull={polyline:_e,surface:surface(_e),perimeter:perimeter(_e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const _=this.convexHull,_e=new Image$1(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});_e.paintPolyline(_.polyline,{closed:!0}),this.computed.convexHullMask=_e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const _=this.convexHull,_e=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let tt=0;tt<this.width;tt++)for(let nt=0;nt<this.height;nt++)robustPointInPolygon$1(_.polyline,[tt,nt])!==1&&_e.setBitXY(tt,nt);this.computed.convexHullFilledMask=_e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let _=minimalBoundingRectangle({originalPoints:this.convexHull.polyline});if(_.length===0)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:_};else{let _e=_[0],tt=_[1],nt=_[2],rt=Math.sqrt((_e[0]-tt[0])**2+(_e[1]-tt[1])**2),it=Math.sqrt((nt[0]-tt[0])**2+(nt[1]-tt[1])**2);this.computed.mbr={width:rt,height:it,elongation:1-rt/it,aspectRatio:rt/it,surface:rt*it,perimeter:(rt+it)*2,rectangle:_}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=feretDiameters({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=getPerimeterInfo(this)),this.computed.perimeterInfo}get perimeter(){let _=this.perimeterInfo,_e=2-Math.sqrt(2);return _.one+_.two*2+_.three*3+_.four*4-_e*(_.two+_.three*2+_.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const _=new Image$1(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});_.paintPolyline(this.feretDiameters.minLine),_.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=_}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let _=round(this.mbr.rectangle);if(_.length>0){const _e=minMax(_),tt=new Image$1(_e[1][0]-_e[0][0]+1,_e[1][1]-_e[0][1]+1,{kind:BINARY,position:[this.minX+_e[0][0],this.minY+_e[0][1]],parent:this.map.parent});_=moveToZeroZero(_),tt.paintPolyline(_,{closed:!0}),this.computed.mbrMask=tt}else this.computed.mbrMask=new Image$1(1,1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const _=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent}),_e=this.mask.minimalBoundingRectangle();for(let tt=0;tt<this.width;tt++)for(let nt=0;nt<this.height;nt++)robustPointInPolygon$1(_e,[tt,nt])!==1&&_.setBitXY(tt,nt);this.computed.mbrFilledMask=_}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let _=[];for(let _e=0;_e<this.height;_e++)for(let tt=0;tt<this.width;tt++){let nt=(_e+this.minY)*this.map.width+tt+this.minX;this.map.data[nt]===this.id&&_.push([tt,_e])}this.computed.points=_}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let _=0,_e;const tt=this.points;for(let nt=0;nt<tt.length;nt++)for(let rt=nt+1;rt<tt.length;rt++){let it=Math.pow(tt[nt][0]-tt[rt][0],2)+Math.pow(tt[nt][1]-tt[rt][1],2);it>=_&&(_=it,_e=[tt[nt],tt[rt]])}this.computed.maxLengthPoints=_e}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let _=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=_}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let _=this.maxLengthPoints,_e=-Math.atan2(_[0][1]-_[1][1],_[0][0]-_[1][0])*180/Math.PI;this.computed.angle=_e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}function getBorders(et){let _=et.map,_e=_.data,tt=new Set,nt=new Map,rt=new Set,it=[1,0,-1,0],st=[0,1,0,-1];for(let lt=et.minX;lt<=et.maxX;lt++)for(let ct=et.minY;ct<=et.maxY;ct++){let ht=lt+ct*_.width;if(_e[ht]===et.id)for(let ut=0;ut<4;ut++){let ft=lt+it[ut],dt=ct+st[ut];if(ft>=0&&dt>=0&&ft<_.width&&dt<_.height){let pt=ft+dt*_.width;if(_e[pt]!==et.id&&!rt.has(pt)){rt.add(pt),tt.add(_e[pt]);let mt=nt.get(_e[pt]);mt?nt.set(_e[pt],++mt):nt.set(_e[pt],1)}}}}let ot=Array.from(tt),at=ot.map(function(lt){return nt.get(lt)});return{ids:ot,lengths:at}}function getBoxIDs(et){let _=new Set,_e=et.map,tt=_e.data;for(let nt of[0,et.height-1])for(let rt=0;rt<et.width;rt++){let it=(nt+et.minY)*_e.width+rt+et.minX;if(rt-et.minX>0&&tt[it]===et.id&&tt[it-1]!==et.id){let st=tt[it-1];_.add(st)}if(_e.width-rt-et.minX>1&&tt[it]===et.id&&tt[it+1]!==et.id){let st=tt[it+1];_.add(st)}}for(let nt of[0,et.width-1])for(let rt=0;rt<et.height;rt++){let it=(rt+et.minY)*_e.width+nt+et.minX;if(rt-et.minY>0&&tt[it]===et.id&&tt[it-_e.width]!==et.id){let st=tt[it-_e.width];_.add(st)}if(_e.height-rt-et.minY>1&&tt[it]===et.id&&tt[it+_e.width]!==et.id){let st=tt[it+_e.width];_.add(st)}}return Array.from(_)}function getBox(et){let _=0,_e=et.map,tt=_e.data,nt=[0];et.height>1&&(nt[1]=et.height-1);for(let it of nt)for(let st=1;st<et.width-1;st++){let ot=(it+et.minY)*_e.width+st+et.minX;tt[ot]===et.id&&_++}let rt=[0];et.width>1&&(rt[1]=et.width-1);for(let it of rt)for(let st=0;st<et.height;st++){let ot=(st+et.minY)*_e.width+it+et.minX;tt[ot]===et.id&&_++}return _}function getBorder(et){let _=0,_e=et.map,tt=_e.data;for(let nt=1;nt<et.width-1;nt++)for(let rt=1;rt<et.height-1;rt++){let it=(rt+et.minY)*_e.width+nt+et.minX;tt[it]===et.id&&(tt[it-1]!==et.id||tt[it+1]!==et.id||tt[it-_e.width]!==et.id||tt[it+_e.width]!==et.id)&&_++}return _+et.box}function getPerimeterInfo(et){let _=et.map,_e=_.data,tt=0,nt=0,rt=0,it=0;for(let st=0;st<et.width;st++)for(let ot=0;ot<et.height;ot++){let at=(ot+et.minY)*_.width+st+et.minX;if(_e[at]===et.id){let lt=0;switch((st===0||et.externalIDs.includes(_e[at-1]))&&lt++,(st===et.width-1||et.externalIDs.includes(_e[at+1]))&&lt++,(ot===0||et.externalIDs.includes(_e[at-_.width]))&&lt++,(ot===et.height-1||et.externalIDs.includes(_e[at+_.width]))&&lt++,lt){case 1:tt++;break;case 2:nt++;break;case 3:rt++;break;case 4:it++;break}}}return{one:tt,two:nt,three:rt,four:it}}function getExternal(et){let _=0,_e=et.map,tt=_e.data;for(let nt=1;nt<et.width-1;nt++)for(let rt=1;rt<et.height-1;rt++){let it=(rt+et.minY)*_e.width+nt+et.minX;tt[it]===et.id&&(et.externalIDs.includes(tt[it-1])||et.externalIDs.includes(tt[it+1])||et.externalIDs.includes(tt[it-_e.width])||et.externalIDs.includes(tt[it+_e.width]))&&_++}return _+et.box}function getHolesInfo(et){let _=0,_e=et.map.width,tt=et.map.data;for(let nt=1;nt<et.width-1;nt++)for(let rt=1;rt<et.height-1;rt++){let it=(rt+et.minY)*_e+nt+et.minX;et.internalIDs.includes(tt[it])&&tt[it]!==et.id&&_++}return{number:et.internalIDs.length-1,surface:_}}function getInternalIDs(et){let _=[et.id],_e=et.map,tt=_e.data;if(et.height>2)for(let rt=0;rt<et.width;rt++){let it=et.minY*_e.width+rt+et.minX;if(_.includes(tt[it])){let st=tt[it+_e.width];!_.includes(st)&&!et.boxIDs.includes(st)&&_.push(st)}}let nt=new Array(4);for(let rt=1;rt<et.width-1;rt++)for(let it=1;it<et.height-1;it++){let st=(it+et.minY)*_e.width+rt+et.minX;if(_.includes(tt[st])){nt[0]=tt[st-1],nt[1]=tt[st+1],nt[2]=tt[st-_e.width],nt[3]=tt[st+_e.width];for(let ot=0;ot<4;ot++){let at=nt[ot];!_.includes(at)&&!et.boxIDs.includes(at)&&_.push(at)}}}return _}class RoiLayer{constructor(_,_e){this.roiMap=_,this.options=_e,this.roi=this.createRoi()}createRoi(){let _=this.roiMap.data,_e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let st=0;st<_.length;st++)_[st]&&!_e[_[st]]&&(_e[_[st]]=!0,_[st]>0?this.roiMap.positive++:this.roiMap.negative++);let tt={};for(let st in _e)tt[st]=new Roi(this.roiMap,st*1);let nt=this.roiMap.width,rt=this.roiMap.height;for(let st=0;st<rt;st++)for(let ot=0;ot<nt;ot++){let at=st*nt+ot;if(_[at]!==0){const lt=_[at],ct=tt[lt];ot<ct.minX&&(ct.minX=ot),ot>ct.maxX&&(ct.maxX=ot),st<ct.minY&&(ct.minY=st),st>ct.maxY&&(ct.maxY=st),ct.meanX+=ot,ct.meanY+=st,ct.surface++}}let it=[];for(let st in _e)tt[st].meanX/=tt[st].surface,tt[st].meanY/=tt[st].surface,it.push(tt[st]);return it}}function commonBorderLength(et){let _=et.data,_e=[1,0,-1,0],tt=[0,1,0,-1],nt=et.minMax,rt=-nt.min,it=nt.max+rt,st=[];for(let at=0;at<=it;at++)st.push(Object.create(null));for(let at=0;at<et.width;at++)for(let lt=0;lt<et.height;lt++){let ct=at+lt*et.width,ht=_[ct];if(ht!==0){let ut=Object.create(null),ft=!1;for(let dt=0;dt<4;dt++){let pt=at+_e[dt],mt=lt+tt[dt];if(pt>=0&&mt>=0&&pt<et.width&&mt<et.height){let vt=_[pt+mt*et.width];ht!==vt&&(ft=!0,vt!==0&&ut[vt]===void 0&&(ut[vt]=!0,st[vt+rt][ht]?st[vt+rt][ht]++:st[vt+rt][ht]=1))}else ft=!0}ft&&(st[ht+rt][ht]?st[ht+rt][ht]++:st[ht+rt][ht]=1)}}let ot={};for(let at=0;at<st.length;at++)Object.keys(st[at]).length>0&&(ot[at-rt]=st[at]);return ot}function mergeRoi(et={}){const{algorithm:_="commonBorderLength",minCommonBorderLength:_e=5,maxCommonBorderLength:tt=100,minCommonBorderRatio:nt=.3,maxCommonBorderRatio:rt=1}=et;let it=function(pt,mt,vt){return pt[vt]>=_e&&pt[vt]<=tt};typeof _=="function"&&(it=_),_.toLowerCase()==="commonborderratio"&&(it=function(pt,mt,vt){let yt=Math.min(pt[vt]/pt[mt],1);return yt>=nt&&yt<=rt});const st=this,ot=st.commonBorderLength;let at={},lt={};for(let pt of Object.keys(ot)){let mt=ot[pt],vt=Object.keys(mt);for(let yt of vt)if(yt!==pt&&it(mt,pt,yt)){let _t=yt;lt[yt]&&(_t=lt[yt]);let St=pt;if(lt[pt]&&(St=lt[pt]),Number(_t)!==St){let bt=Math.min(_t,St),Et=Math.max(_t,St);if(at[bt]||(at[bt]={}),at[bt][Et]=!0,lt[Et]=bt,at[Et]){for(let Mt of Object.keys(at[Et]))at[bt][Mt]=!0,lt[Mt]=bt;delete at[Et]}}}}let ct=st.minMax,ht=-ct.min,ut=ct.max+ht,ft=new Array(ut+1).fill(0);for(let pt of Object.keys(lt))ft[Number(pt)+ht]=lt[pt];let dt=st.data;for(let pt=0;pt<dt.length;pt++){let mt=dt[pt];if(mt!==0){let vt=ft[mt+ht];vt!==0&&(dt[pt]=vt)}}return st.computed={},st}class RoiMap{constructor(_,_e){this.parent=_,this.width=_.width,this.height=_.height,this.data=_e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let _=Number.MAX_SAFE_INTEGER,_e=Number.MIN_SAFE_INTEGER;for(let tt=0;tt<this.data.length;tt++)this.data[tt]<_&&(_=this.data[tt]),this.data[tt]>_e&&(_e=this.data[tt]);return{min:_,max:_e}}get commonBorderLength(){return commonBorderLength(this)}mergeRoi(_={}){return mergeRoi.call(this,_)}mergeRois(_){const _e=_[0],tt=_.slice(1);for(let nt=0;nt<this.data.length;nt++)tt.includes(this.data[nt])&&(this.data[nt]=_e)}rowsInfo(){let _=new Array(this.height),_e=0;for(let tt=0;tt<this.data.length;tt+=this.width){let nt={row:_e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};_[_e++]=nt;let rt={},it={},st=[],ot=this.data[tt],at=0;for(let lt=tt;lt<tt+this.width;lt++){let ct=this.data[lt];ot!==ct&&(ot=ct,st.push(at),at=0),at++,ct>0?(nt.positivePixel++,rt[ct]||(rt[ct]=!0)):ct<0?(nt.negativePixel++,it[ct]||(it[ct]=!0)):nt.zeroPixel++}st.push(at),nt.medianChange=st.sort((lt,ct)=>lt-ct)[Math.floor(st.length/2)],nt.positiveRoiIDs=Object.keys(rt),nt.negativeRoiIDs=Object.keys(it),nt.positiveRoi=nt.positiveRoiIDs.length,nt.negativeRoi=nt.negativeRoiIDs.length}return _}colsInfo(){let _=new Array(this.width),_e=0;for(let tt=0;tt<this.width;tt++){let nt={col:_e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};_[_e++]=nt;let rt={},it={},st=[],ot=this.data[tt],at=0;for(let lt=tt;lt<tt+this.data.length;lt+=this.width){let ct=this.data[lt];ot!==ct&&(ot=ct,st.push(at),at=0),at++,ct>0?(nt.positivePixel++,rt[ct]||(rt[ct]=!0)):ct<0?(nt.negativePixel++,it[ct]||(it[ct]=!0)):nt.zeroPixel++}st.push(at),nt.medianChange=st.sort((lt,ct)=>lt-ct)[Math.floor(st.length/2)],nt.positiveRoiIDs=Object.keys(rt),nt.negativeRoiIDs=Object.keys(it),nt.positiveRoi=nt.positiveRoiIDs.length,nt.negativeRoi=nt.negativeRoiIDs.length}return _}}function fromMask(et,_={}){const{allowCorners:_e=!1}=_,tt=65535;let nt=new Int16Array(et.size),rt=0,it=0,st=new Uint16Array(tt+1),ot=new Uint16Array(tt+1);for(let lt=0;lt<et.width;lt++)for(let ct=0;ct<et.height;ct++)nt[ct*et.width+lt]===0&&at(lt,ct);function at(lt,ct){let ht=0,ut=0,ft=et.getBitXY(lt,ct),dt=ft?++rt:--it;if(rt>32767||it<-32768)throw new Error("Too many regions of interest");for(st[0]=lt,ot[0]=ct;ht<=ut;){let pt=st[ht&tt],mt=ot[ht&tt];if(nt[mt*et.width+pt]=dt,pt>0&&nt[mt*et.width+pt-1]===0&&et.getBitXY(pt-1,mt)===ft&&(ut++,st[ut&tt]=pt-1,ot[ut&tt]=mt,nt[mt*et.width+pt-1]=-32768),mt>0&&nt[(mt-1)*et.width+pt]===0&&et.getBitXY(pt,mt-1)===ft&&(ut++,st[ut&tt]=pt,ot[ut&tt]=mt-1,nt[(mt-1)*et.width+pt]=-32768),pt<et.width-1&&nt[mt*et.width+pt+1]===0&&et.getBitXY(pt+1,mt)===ft&&(ut++,st[ut&tt]=pt+1,ot[ut&tt]=mt,nt[mt*et.width+pt+1]=-32768),mt<et.height-1&&nt[(mt+1)*et.width+pt]===0&&et.getBitXY(pt,mt+1)===ft&&(ut++,st[ut&tt]=pt,ot[ut&tt]=mt+1,nt[(mt+1)*et.width+pt]=-32768),_e&&(pt>0&&mt>0&&nt[(mt-1)*et.width+pt-1]===0&&et.getBitXY(pt-1,mt-1)===ft&&(ut++,st[ut&tt]=pt-1,ot[ut&tt]=mt-1,nt[(mt-1)*et.width+pt-1]=-32768),pt<et.width-1&&mt>0&&nt[(mt-1)*et.width+pt+1]===0&&et.getBitXY(pt+1,mt-1)===ft&&(ut++,st[ut&tt]=pt+1,ot[ut&tt]=mt-1,nt[(mt-1)*et.width+pt+1]=-32768),pt>0&&mt<et.height-1&&nt[(mt+1)*et.width+pt-1]===0&&et.getBitXY(pt-1,mt+1)===ft&&(ut++,st[ut&tt]=pt-1,ot[ut&tt]=mt+1,nt[(mt+1)*et.width+pt-1]=-32768),pt<et.width-1&&mt<et.height-1&&nt[(mt+1)*et.width+pt+1]===0&&et.getBitXY(pt+1,mt+1)===ft&&(ut++,st[ut&tt]=pt+1,ot[ut&tt]=mt+1,nt[(mt+1)*et.width+pt+1]=-32768)),ht++,ut-ht>tt)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new RoiMap(et,nt)}class DisjointSet{constructor(){this.nodes=new Map}add(_){var _e=this.nodes.get(_);return _e||(_e=new DisjointSetNode(_),this.nodes.set(_,_e)),_e}union(_,_e){const tt=this.find(_),nt=this.find(_e);tt!==nt&&(tt.rank<nt.rank?tt.parent=nt:tt.rank>nt.rank?nt.parent=tt:(nt.parent=tt,tt.rank++))}find(_){for(var _e=_;_e.parent!==null;)_e=_e.parent;for(var tt=_;tt.parent!==null;){var nt=tt;tt=tt.parent,nt.parent=_e}return _e}connected(_,_e){return this.find(_)===this.find(_e)}}var DisjointSet_1=DisjointSet;function DisjointSetNode(et){this.value=et,this.parent=null,this.rank=0}const DisjointSet$1=getDefaultExportFromCjs(DisjointSet_1),direction4X=[-1,0],direction4Y=[0,-1],neighbours4=[null,null],direction8X=[-1,-1,0,1],direction8Y=[0,-1,-1,-1],neighbours8=[null,null,null,null];function fromMaskConnectedComponentLabelingAlgorithm(et,_={}){const{allowCorners:_e=!1}=_;let tt=4;_e&&(tt=8);let nt,rt,it;if(tt===8)nt=direction8X,rt=direction8Y,it=neighbours8;else if(tt===4)nt=direction4X,rt=direction4Y,it=neighbours4;else throw new RangeError(`unsupported neighbours count: ${tt}`);const st=et.size,ot=et.width,at=et.height,lt=new Array(st),ct=new Uint32Array(st),ht=new DisjointSet$1;let ut=1;for(let ft=0;ft<at;ft++)for(let dt=0;dt<ot;dt++){const pt=dt+ft*ot;if(et.getBit(pt)){let mt=null;for(let vt=0;vt<it.length;vt++){const yt=dt+nt[vt],_t=ft+rt[vt];if(yt>=0&&_t>=0&&yt<ot&&_t<at){const St=yt+_t*ot;let bt=lt[St];bt?(it[vt]=bt,(!mt||it[vt].value<mt.value)&&(mt=it[vt])):it[vt]=null}}if(!mt)lt[pt]=ht.add(ut++);else{lt[pt]=mt;for(let vt=0;vt<it.length;vt++)it[vt]&&it[vt]!==mt&&ht.union(mt,it[vt])}}}for(let ft=0;ft<at;ft++)for(let dt=0;dt<ot;dt++){const pt=dt+ft*ot;et.getBit(pt)&&(ct[pt]=ht.find(lt[pt]).value)}return new RoiMap(et,ct)}function fromMaxima(et={}){let{allowCorner:_=!0,onlyTop:_e=!1,invert:tt=!1}=et,nt=this;nt.checkProcessable("fromMaxima",{components:[1]});const rt=1,it=2;let st=0,ot=0,at=new Int16Array(nt.size),lt=new Int8Array(nt.size),ct=new Float32Array(nt.size),ht=1048575,ut=new Uint16Array(ht+1),ft=new Uint16Array(ht+1),dt=0,pt=0,mt=new Uint16Array(ht+1),vt=new Uint16Array(ht+1),yt=0,_t=0;for(St(nt);dt<pt;){let Mt=ut[dt&ht],Tt=ft[dt&ht];Et(Mt,Tt,it),dt++}return new RoiMap(nt,at);function St({maxima:Mt=!0}){for(let Tt=1;Tt<nt.height-1;Tt++)for(let wt=1;wt<nt.width-1;wt++){let Ct=wt+Tt*nt.width;if(lt[Ct]===0){let Rt=Mt?nt.data[Ct]:-nt.data[wt+Tt*nt.width];if(nt.data[Tt*nt.width+wt-1]>Rt||nt.data[Tt*nt.width+wt+1]>Rt||nt.data[(Tt-1)*nt.width+wt]>Rt||nt.data[(Tt+1)*nt.width+wt]>Rt||_&&(nt.data[(Tt-1)*nt.width+wt-1]>Rt||nt.data[(Tt-1)*nt.width+wt+1]>Rt||nt.data[(Tt+1)*nt.width+wt-1]>Rt||nt.data[(Tt+1)*nt.width+wt+1]>Rt))continue;at[Ct]=Mt?++st:--ot,bt(wt,Tt)||(Mt?--st:++ot)}}}function bt(Mt,Tt){let wt=pt;yt=0,_t=1,mt[0]=Mt,vt[0]=Tt;let Ct=!0;for(;yt<_t;){let Rt=mt[yt&ht],It=vt[yt&ht];Ct&=Et(Rt,It,rt),yt++}if(!Ct){for(let Rt=0;Rt<_t;Rt++){let It=mt[Rt&ht],Ft=vt[Rt&ht]*nt.width+It;at[Ft]=0}pt=wt}return Ct}function Et(Mt,Tt,wt){let Ct=at[Tt*nt.width+Mt],Rt=nt.data[Tt*nt.width+Mt];for(let It=Tt-1;It<=Tt+1;It++)for(let Dt=Mt-1;Dt<=Mt+1;Dt++){let Ft=It*nt.width+Dt;if(lt[Ft]===0)switch(lt[Ft]=1,ct[Ft]=nt.data[Ft]-Rt,wt){case rt:if(ct[Ft]===0){if(Dt===0||It===0||Dt===nt.width-1||It===nt.height-1)return!1;at[Ft]=Ct,mt[_t&ht]=Dt,vt[_t&ht]=It,_t++}else{if(ct[Ft]>0)return!1;_e||(at[Ft]=Ct,ut[pt&ht]=Dt,ft[pt&ht]=It,pt++)}break;case it:ct[Ft]<=0&&(at[Ft]=Ct,ut[pt&ht]=Dt,ft[pt&ht]=It,pt++);break;default:throw new Error("unreachable")}}return!0}}function fromPoints(et,_={}){let _e=new Shape(_),tt=new Int16Array(this.size),nt=0,rt=_e.getPoints();for(let it=0;it<et.length;it++){nt++;let st=et[it][0],ot=et[it][1];for(let at=0;at<rt.length;at++){let lt=rt[at][0],ct=rt[at][1];st+lt>=0&&ot+ct>=0&&st+lt<this.width&&ot+ct<this.height&&(tt[st+lt+(ot+ct)*this.width]=nt)}}return new RoiMap(this,tt)}function commonjsRequire(et){throw new Error('Could not dynamically require "'+et+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var priorityQueue={exports:{}};(function(et,_){(function(_e){et.exports=_e()})(function(){return function _e(tt,nt,rt){function it(at,lt){if(!nt[at]){if(!tt[at]){var ct=typeof commonjsRequire=="function"&&commonjsRequire;if(!lt&&ct)return ct(at,!0);if(st)return st(at,!0);var ht=new Error("Cannot find module '"+at+"'");throw ht.code="MODULE_NOT_FOUND",ht}var ut=nt[at]={exports:{}};tt[at][0].call(ut.exports,function(ft){var dt=tt[at][1][ft];return it(dt||ft)},ut,ut.exports,_e,tt,nt,rt)}return nt[at].exports}for(var st=typeof commonjsRequire=="function"&&commonjsRequire,ot=0;ot<rt.length;ot++)it(rt[ot]);return it}({1:[function(_e,tt,nt){var rt,it,st,ot,at,lt=function(ht,ut){for(var ft in ut)ct.call(ut,ft)&&(ht[ft]=ut[ft]);function dt(){this.constructor=ht}return dt.prototype=ut.prototype,ht.prototype=new dt,ht.__super__=ut.prototype,ht},ct={}.hasOwnProperty;rt=_e("./PriorityQueue/AbstractPriorityQueue"),it=_e("./PriorityQueue/ArrayStrategy"),ot=_e("./PriorityQueue/BinaryHeapStrategy"),st=_e("./PriorityQueue/BHeapStrategy"),at=function(ht){lt(ut,ht);function ut(ft){ft||(ft={}),ft.strategy||(ft.strategy=ot),ft.comparator||(ft.comparator=function(dt,pt){return(dt||0)-(pt||0)}),ut.__super__.constructor.call(this,ft)}return ut}(rt),at.ArrayStrategy=it,at.BinaryHeapStrategy=ot,at.BHeapStrategy=st,tt.exports=at},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(_e,tt,nt){tt.exports=function(){function rt(it){var st;if((it!=null?it.strategy:void 0)==null)throw"Must pass options.strategy, a strategy";if((it!=null?it.comparator:void 0)==null)throw"Must pass options.comparator, a comparator";this.priv=new it.strategy(it),this.length=(it!=null&&(st=it.initialValues)!=null?st.length:void 0)||0}return rt.prototype.queue=function(it){this.length++,this.priv.queue(it)},rt.prototype.dequeue=function(it){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},rt.prototype.peek=function(it){if(!this.length)throw"Empty queue";return this.priv.peek()},rt.prototype.clear=function(){return this.length=0,this.priv.clear()},rt}()},{}],3:[function(_e,tt,nt){var rt;rt=function(it,st,ot){var at,lt,ct;for(lt=0,at=it.length;lt<at;)ct=lt+at>>>1,ot(it[ct],st)>=0?lt=ct+1:at=ct;return lt},tt.exports=function(){function it(st){var ot;this.options=st,this.comparator=this.options.comparator,this.data=((ot=this.options.initialValues)!=null?ot.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return it.prototype.queue=function(st){var ot;ot=rt(this.data,st,this.comparator),this.data.splice(ot,0,st)},it.prototype.dequeue=function(){return this.data.pop()},it.prototype.peek=function(){return this.data[this.data.length-1]},it.prototype.clear=function(){this.data.length=0},it}()},{}],4:[function(_e,tt,nt){tt.exports=function(){function rt(it){var st,ot,at,lt,ct,ht,ut,ft;for(this.comparator=(it!=null?it.comparator:void 0)||function(dt,pt){return dt-pt},this.pageSize=(it!=null?it.pageSize:void 0)||512,this.length=0,ut=0;1<<ut<this.pageSize;)ut+=1;if(1<<ut!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=ut,this._emptyMemoryPageTemplate=st=[],ot=0,ct=this.pageSize;0<=ct?ot<ct:ot>ct;0<=ct?++ot:--ot)st.push(null);if(this._memory=[],this._mask=this.pageSize-1,it.initialValues)for(ht=it.initialValues,at=0,lt=ht.length;at<lt;at++)ft=ht[at],this.queue(ft)}return rt.prototype.queue=function(it){this.length+=1,this._write(this.length,it),this._bubbleUp(this.length,it)},rt.prototype.dequeue=function(){var it,st;return it=this._read(1),st=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,st),this._bubbleDown(1,st)),it},rt.prototype.peek=function(){return this._read(1)},rt.prototype.clear=function(){this.length=0,this._memory.length=0},rt.prototype._write=function(it,st){var ot;for(ot=it>>this._shift;ot>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[ot][it&this._mask]=st},rt.prototype._read=function(it){return this._memory[it>>this._shift][it&this._mask]},rt.prototype._bubbleUp=function(it,st){var ot,at,lt,ct;for(ot=this.comparator;it>1&&(at=it&this._mask,it<this.pageSize||at>3?lt=it&~this._mask|at>>1:at<2?(lt=it-this.pageSize>>this._shift,lt+=lt&~(this._mask>>1),lt|=this.pageSize>>1):lt=it-2,ct=this._read(lt),!(ot(ct,st)<0));)this._write(lt,st),this._write(it,ct),it=lt},rt.prototype._bubbleDown=function(it,st){var ot,at,lt,ct,ht;for(ht=this.comparator;it<this.length;)if(it>this._mask&&!(it&this._mask-1)?ot=at=it+2:it&this.pageSize>>1?(ot=(it&~this._mask)>>1,ot|=it&this._mask>>1,ot=ot+1<<this._shift,at=ot+1):(ot=it+(it&this._mask),at=ot+1),ot!==at&&at<=this.length)if(lt=this._read(ot),ct=this._read(at),ht(lt,st)<0&&ht(lt,ct)<=0)this._write(ot,st),this._write(it,lt),it=ot;else if(ht(ct,st)<0)this._write(at,st),this._write(it,ct),it=at;else break;else if(ot<=this.length)if(lt=this._read(ot),ht(lt,st)<0)this._write(ot,st),this._write(it,lt),it=ot;else break;else break},rt}()},{}],5:[function(_e,tt,nt){tt.exports=function(){function rt(it){var st;this.comparator=(it!=null?it.comparator:void 0)||function(ot,at){return ot-at},this.length=0,this.data=((st=it.initialValues)!=null?st.slice(0):void 0)||[],this._heapify()}return rt.prototype._heapify=function(){var it,st,ot;if(this.data.length>0)for(it=st=1,ot=this.data.length;1<=ot?st<ot:st>ot;it=1<=ot?++st:--st)this._bubbleUp(it)},rt.prototype.queue=function(it){this.data.push(it),this._bubbleUp(this.data.length-1)},rt.prototype.dequeue=function(){var it,st;return st=this.data[0],it=this.data.pop(),this.data.length>0&&(this.data[0]=it,this._bubbleDown(0)),st},rt.prototype.peek=function(){return this.data[0]},rt.prototype.clear=function(){this.length=0,this.data.length=0},rt.prototype._bubbleUp=function(it){for(var st,ot;it>0&&(st=it-1>>>1,this.comparator(this.data[it],this.data[st])<0);)ot=this.data[st],this.data[st]=this.data[it],this.data[it]=ot,it=st},rt.prototype._bubbleDown=function(it){var st,ot,at,lt,ct;for(st=this.data.length-1;ot=(it<<1)+1,lt=ot+1,at=it,ot<=st&&this.comparator(this.data[ot],this.data[at])<0&&(at=ot),lt<=st&&this.comparator(this.data[lt],this.data[at])<0&&(at=lt),at!==it;)ct=this.data[at],this.data[at]=this.data[it],this.data[it]=ct,it=at},rt}()},{}]},{},[1])(1)})})(priorityQueue);var priorityQueueExports=priorityQueue.exports;const PriorityQueue=getDefaultExportFromCjs(priorityQueueExports),dxs=[1,0,-1,0,1,1,-1,-1],dys=[0,1,0,-1,1,-1,1,-1];function fromWaterShed(et={}){let{points:_,mask:_e,image:tt,fillMaxValue:nt=this.maxValue,invert:rt=!1}=et,it=tt||this;it.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),rt=!rt,_||(_=it.getLocalMaxima({invert:rt,mask:_e}));let st=rt?0:1,ot=new Int16Array(it.size),at=it.width,lt=it.height,ct=new PriorityQueue({comparator:(ht,ut)=>ht[2]-ut[2],strategy:PriorityQueue.BinaryHeapStrategy});for(let ht=0;ht<_.length;ht++){let ut=_[ht][0]+_[ht][1]*at;ot[ut]=ht+1;let ft=it.data[ut];(rt&&ft<=nt||!rt&&ft>=nt)&&ct.queue([_[ht][0],_[ht][1],ft])}for(;ct.length>0;){let ht=ct.dequeue(),ut=ht[0]+ht[1]*at;for(let ft=0;ft<4;ft++){let dt=ht[0]+dxs[ft],pt=ht[1]+dys[ft];if(dt>=0&&pt>=0&&dt<at&&pt<lt){let mt=dt+pt*at;if(!_e||_e.getBit(mt)===st){let vt=it.data[mt];(rt&&vt<=nt||!rt&&vt>=nt)&&ot[mt]===0&&(ot[mt]=ot[ut],ct.queue([ht[0]+dxs[ft],ht[1]+dys[ft],vt]))}}}}return new RoiMap(it,ot)}class RoiManager{constructor(_,_e={}){this._image=_,this._options=_e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(_={}){let _e=Object.assign({},this._options,_),tt=fromMaxima.call(this._image,_);this._layers[_e.label]=new RoiLayer(tt,_e)}fromPoints(_,_e={}){let tt=Object.assign({},this._options,_e),nt=fromPoints.call(this._image,_,_e);return this._layers[tt.label]=new RoiLayer(nt,tt),this}putMap(_,_e={}){let tt=new RoiMap(this._image,_),nt=Object.assign({},this._options,_e);return this._layers[nt.label]=new RoiLayer(tt,nt),this}fromWaterShed(_={}){let _e=Object.assign({},this._options,_),tt=fromWaterShed.call(this._image,_);this._layers[_e.label]=new RoiLayer(tt,_e)}fromMask(_,_e={}){let tt=Object.assign({},this._options,_e),nt=fromMask.call(this._image,_,_e);return this._layers[tt.label]=new RoiLayer(nt,tt),this}fromMaskConnectedComponentLabelingAlgorithm(_,_e={}){let tt=Object.assign({},this._options,_e),nt=fromMaskConnectedComponentLabelingAlgorithm.call(this._image,_,_e);return this._layers[tt.label]=new RoiLayer(nt,tt),this}getMap(_={}){let _e=Object.assign({},this._options,_);return this._assertLayerWithLabel(_e.label),this._layers[_e.label].roiMap}rowsInfo(_={}){return this.getMap(_).rowsInfo()}colsInfo(_={}){return this.getMap(_).rowsInfo()}getRoiIds(_={}){let _e=this.getRois(_);if(_e){let tt=new Array(_e.length);for(let nt=0;nt<_e.length;nt++)tt[nt]=_e[nt].id;return tt}throw new Error("ROIs not found")}getRois(_={}){let{label:_e=this._options.label,positive:tt=!0,negative:nt=!0,minSurface:rt=0,maxSurface:it=Number.POSITIVE_INFINITY,minWidth:st=0,maxWidth:ot=Number.POSITIVE_INFINITY,minHeight:at=0,maxHeight:lt=Number.POSITIVE_INFINITY,minRatio:ct=0,maxRatio:ht=Number.POSITIVE_INFINITY}=_;if(!this._layers[_e])throw new Error(`this Roi layer (${_e}) does not exist`);const ut=this._layers[_e].roi,ft=[];for(const dt of ut)(dt.id<0&&nt||dt.id>0&&tt)&&dt.surface>=rt&&dt.surface<=it&&dt.width>=st&&dt.width<=ot&&dt.height>=at&&dt.height<=lt&&dt.ratio>=ct&&dt.ratio<=ht&&ft.push(dt);return ft}getRoi(_,_e={}){const{label:tt=this._options.label}=_e;if(!this._layers[tt])throw new Error(`this Roi layer (${tt}) does not exist`);const nt=this._layers[tt].roi.find(rt=>rt.id===_);if(!nt)throw new Error(`found no Roi with id ${_}`);return nt}getMasks(_={}){let _e=this.getRois(_),tt=new Array(_e.length);for(let nt=0;nt<_e.length;nt++)tt[nt]=_e[nt].getMask(_);return tt}getAnalysisMasks(_={}){const{analysisProperty:_e}=_;let tt=`${_e}Mask`,nt=this.getRois(_);return nt.length===0||!nt[0][tt]?[]:nt.map(rt=>rt[tt])}getData(_={}){let _e=Object.assign({},this._options,_);return this._assertLayerWithLabel(_e.label),this._layers[_e.label].roiMap.data}paint(_={}){let{labelProperty:_e,analysisProperty:tt}=_;this._painted||(this._painted=this._image.rgba8());let nt=this.getMasks(_);if(_e){const rt=this.getRois(_);_.labels=rt.map(at=>deepValue(at,_e));const it=Math.max(..._.labels);let st=!1,ot=!1;if(_e.includes("surface")?st=!0:/(?:perimeter|min|max|external|width|height|length)/.test(_e)&&(ot=!0),isFinite(it)){let at="";if(_.unit!=="pixel"&&_.pixelSize&&(ot||st)){at=st?`${_.unit}^2`:_.unit;let lt=st?"m^2":"m",ct=st?_.pixelSize**2:_.pixelSize;const ht=Qty.swiftConverter(lt,at);_.labels=_.labels.map(ut=>ht(ct*ut))}it>50?_.labels=_.labels.map(lt=>Math.round(lt)+at):it>10?_.labels=_.labels.map(lt=>lt.toFixed(1)+at):_.labels=_.labels.map(lt=>lt.toFixed(2)+at)}_.labelsPosition=rt.map(at=>[at.meanX,at.meanY])}if(this._painted.paintMasks(nt,_),tt){let rt=this.getAnalysisMasks(_);this._painted.paintMasks(rt,{color:_.analysisColor,alpha:_.analysisAlpha})}return this._painted}getMask(_={}){let _e=new Image$1(this._image.width,this._image.height,{kind:"BINARY"}),tt=this.getMasks(_);for(let nt=0;nt<tt.length;nt++){let rt=tt[nt];for(let it=0;it<rt.width;it++)for(let st=0;st<rt.height;st++)rt.getBitXY(it,st)&&_e.setBitXY(it+rt.position[0],st+rt.position[1])}return _e}resetPainted(_={}){const{image:_e}=_;_e?this._painted=this.image.rgba8():this._painted=this._image.rgba8()}mergeRoi(_={}){const _e=this.getMap(_);return _e.mergeRoi(_),this.putMap(_e.data,_),this}mergeRois(_,_e={}){if(!Array.isArray(_)||_.some(nt=>!Number.isInteger(nt)))throw new Error("Roi ids must be an array of integers");if(_.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(_).size!==_.length)throw new Error("Roi ids must be all different");_.forEach(nt=>this.getRoi(nt));const tt=this.getMap(_e);return tt.mergeRois(_),this.putMap(tt.data,_e),this}findCorrespondingRoi(_,_e={}){let tt=this.getRois(_e),nt=[];for(let rt=0;rt<tt.length;rt++){let it=tt[rt],st=it.minX,ot=it.minY,at=it.points,lt=Math.sign(it.id),ct=correspondingRoisInformation(st,ot,at,_,lt);nt.push(ct)}return nt}_assertLayerWithLabel(_){if(!this._layers[_])throw new Error(`no layer with label ${_}`)}}function correspondingRoisInformation(et,_,_e,tt,nt){let rt={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let it=0;it<_e.length;it++){let st=_e[it],ot=st[0],at=st[1],lt=ot+et+(at+_)*tt.width,ct=tt.data[lt];(ct>0||ct<0)&&(rt.id.includes(ct)?rt.surface[rt.id.indexOf(ct)]+=1:(rt.id.push(ct),rt.surface.push(1)))}for(let it=0;it<rt.id.length;it++)Math.sign(rt.id[it])===nt?rt.same+=rt.surface[it]:rt.opposite+=rt.surface[it],rt.roiSurfaceCovered[it]=rt.surface[it]/_e.length;return rt.total=rt.opposite+rt.same,rt}const objectToString=Object.prototype.toString;let Image$1=class Uu{constructor(_,_e,tt,nt){if(arguments.length===1?(nt=_,{width:_,height:_e,data:tt}=nt):tt&&!tt.length&&(nt=tt,{data:tt}=nt),_===void 0&&(_=1),_e===void 0&&(_e=1),nt===void 0&&(nt={}),typeof nt!="object"||nt===null)throw new TypeError("options must be an object");if(!Number.isInteger(_)||_<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(_e)||_e<=0)throw new RangeError("height must be a positive integer");const{kind:rt=RGBA}=nt;if(typeof rt!="string")throw new TypeError("kind must be a string");const it=getKind(rt),st=Object.assign({},nt);for(const dt in it)st[dt]===void 0&&(st[dt]=it[dt]);verifyKindDefinition(st);const{components:ot,bitDepth:at,colorModel:lt}=st,ct=st.alpha+0,ht=_*_e,ut=ot+ct,ft=at===32?Number.MAX_VALUE:2**at-1;if(tt===void 0)tt=createPixelArray(ht,ot,ct,ut,at,ft);else{const dt=getTheoreticalPixelArraySize(ht,ut,at);if(tt.length!==dt)throw new RangeError(`incorrect data size: ${tt.length}. Should be ${dt}`)}this.width=_,this.height=_e,this.data=tt,this.size=ht,this.components=ot,this.alpha=ct,this.bitDepth=at,this.maxValue=ft,this.colorModel=lt,this.channels=ut,this.meta=nt.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:nt.parent||null}),this.position=nt.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(_){return objectToString.call(_)==="[object IJSImage]"}static fromCanvas(_){const tt=_.getContext("2d").getImageData(0,0,_.width,_.height);return new Uu(tt.width,tt.height,tt.data)}static createFrom(_,_e){const tt=getImageParameters(_);return Object.assign(tt,{parent:_,position:[0,0]},_e),new Uu(tt)}getRoiManager(_){return new RoiManager(this,_)}clone(){const _=this.data.slice();return new Uu(this.width,this.height,_,this)}apply(_){for(let _e=0;_e<this.height;_e++)for(let tt=0;tt<this.width;tt++){let nt=(_e*this.width+tt)*this.channels;_.call(this,nt)}}};setValueMethods(Image$1);setBitMethods(Image$1);setExportMethods(Image$1);Image$1.prototype.checkProcessable=checkProcessable;Image$1.prototype.getRGBAData=getRGBAData;Image$1.load=load;Image$1.extendMethod=extendMethod;Image$1.extendProperty=extendProperty;extend$1(Image$1);var workerTemplate$1={},worker$1=function(){self.window=self;function et(){this._listeners={}}et.prototype.on=function(_e,tt){if(this._listeners[_e])throw new RangeError("there is already a listener for "+_e);if(typeof tt!="function")throw new TypeError("callback argument must be a function");this._listeners[_e]=tt},et.prototype._send=function(_e,tt,nt){nt===void 0?nt=[]:Array.isArray(nt)||(nt=[nt]),self.postMessage({id:_e,data:tt},nt)},et.prototype._trigger=function(_e,tt){if(!this._listeners[_e])throw new Error("event "+_e+" is not defined");this._listeners[_e].apply(null,tt)};var _=new et;self.onmessage=function(_e){switch(_e.data.action){case"exec":_e.data.args.unshift(function(tt,nt){_._send(_e.data.id,tt,nt)}),_._trigger(_e.data.event,_e.data.args);break;case"ping":_._send(_e.data.id,"pong");break;default:throw new Error("unexpected action: "+_e.data.action)}}},workerStr=worker$1.toString().split('"CODE";');workerTemplate$1.newWorkerURL=function et(_,_e){var tt=new Blob(["(",workerStr[0],"importScripts.apply(self, "+JSON.stringify(_e)+`);
`,"(",_,")();",workerStr[1],")();"],{type:"application/javascript"});return URL.createObjectURL(tt)};var workerTemplate=workerTemplate$1,CORES=navigator.hardwareConcurrency||1;function WorkerManager(et,_){if(typeof et!="string"&&typeof et!="function")throw new TypeError("func argument must be a function");if(_===void 0&&(_={}),typeof _!="object"||_===null)throw new TypeError("options argument must be an object");this._workerCode=et.toString(),_.maxWorkers===void 0||_.maxWorkers==="auto"?this._numWorkers=Math.min(CORES-1,1):_.maxWorkers>0?this._numWorkers=Math.min(_.maxWorkers,CORES):this._numWorkers=CORES,this._workers=new Map,this._timeout=_.timeout||0,this._terminateOnError=!!_.terminateOnError;var _e=_.deps;typeof _e=="string"&&(_e=[_e]),Array.isArray(_e)||(_e=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(_e)}WorkerManager.prototype._init=function(et){for(var _=workerTemplate.newWorkerURL(this._workerCode,et),_e=0;_e<this._numWorkers;_e++){var tt=new Worker(_);tt.onmessage=this._onmessage.bind(this,tt),tt.onerror=this._onerror.bind(this,tt),tt.running=!1,tt.id=_e,this._workers.set(tt,null)}URL.revokeObjectURL(_)};WorkerManager.prototype._onerror=function(et,_){if(!this._terminated){this._working--,et.running=!1;var _e=this._workers.get(et);_e&&_e[1](_.message),this._workers.set(et,null),this._terminateOnError?this.terminate():this._exec()}};WorkerManager.prototype._onmessage=function(et,_){if(!this._terminated){this._working--,et.running=!1;var _e=this._workers.get(et);_e&&_e[0](_.data.data),this._workers.set(et,null),this._exec()}};WorkerManager.prototype._exec=function(){for(var et of this._workers.keys()){if(this._working===this._numWorkers||this._waiting.length===0)return;if(!et.running)for(var _=0;_<this._waiting.length;_++){var _e=this._waiting[_];if(!(typeof _e[4]=="number"&&_e[4]!==et.id)){this._waiting.splice(_,1),et.postMessage({action:"exec",event:_e[0],args:_e[1]},_e[2]),et.running=!0,et.time=Date.now(),this._workers.set(et,_e[3]),this._working++;break}}}};WorkerManager.prototype.terminate=function(){if(!this._terminated){for(var et of this._workers)et[0].terminate(),et[1]&&et[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}};WorkerManager.prototype.postAll=function(et,_){if(this._terminated)throw new Error("Cannot post (terminated)");var _e=[];for(var tt of this._workers.keys())_e.push(this.post(et,_,[],tt.id));return Promise.all(_e)};WorkerManager.prototype.post=function(et,_,_e,tt){_===void 0&&(_=[]),_e===void 0&&(_e=[]),Array.isArray(_)||(_=[_]),Array.isArray(_e)||(_e=[_e]);var nt=this;return new Promise(function(rt,it){if(nt._terminated)throw new Error("Cannot post (terminated)");nt._waiting.push([et,_,_e,[rt,it],tt]),nt._exec()})};var src=WorkerManager;const WorkerManager$1=getDefaultExportFromCjs(src),defaultOptions={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function run(et,_,_e){_=Object.assign({},defaultOptions,_);const tt=this.manager;return Array.isArray(et)?Promise.all(et.map(function(nt){const rt=runOnce(tt,nt,_);return typeof _e=="function"&&rt.then(_e),rt})):runOnce(tt,et,_)}function runOnce(et,_,_e){return et.post("data",[_,_e]).then(function(tt){for(let nt in tt)tt[nt]=new Image$1(tt[nt]);return tt})}function work(){worker.on("data",function(et,_,_e){_=new IJS(_);const tt={},nt=[],rt=_.grey(),it=rt.sobelFilter();ut("sobel",it);const st=it.level().mask({threshold:_e.threshold});ut("mask",st);const ot=it.getRoiManager();ot.fromMask(st);const at=ot.getMask(_e.roi);ut("realMask",at);const lt=rt.getPixelsGrid({sampling:_e.sampling,mask:at}),ct=_.getBackground(lt.xyS,lt.zS,_e.regression);ut("background",ct);const ht=_.subtract(ct);tt.result=ht,nt.push(ht.data.buffer),et(tt,nt);function ut(ft,dt){_e.include.includes(ft)&&(tt[ft]=dt,nt.push(dt.data.buffer))}})}const background={run,work};function extend(et){et.extendMethod("background",background)}let Worker$1=class x0{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(this._url===null)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(_){if(typeof _!="string")throw new TypeError("worker URL must be a string");this._url=_,this._deps[0]=_}static extendMethod(_,_e){let tt,nt,rt={};function it(...st){return tt||(this.checkUrl(),nt=this.url,tt=new WorkerManager$1(_e.work,{deps:nt}),rt.manager=tt),_e.run.call(rt,...st)}it.reset=function(){tt&&(tt.terminate(),tt=new WorkerManager$1(_e.work,{deps:nt}),rt.manager=tt)},x0.prototype[_]=it}};extend(Worker$1);const size=40,pixelText="athousandwordsisworthapicturebutahundredwordsandsomecodeisworthagif";var scaleFrames=[],colorFrames=[];const frameCount=151,directory="/pacmanFrames/";Array.from({length:frameCount},(et,_)=>`${directory}frame_${_.toString().padStart(3,"0")}.jpg`);const minRow=15,maxRow=25,starting=minRow*size,ending=maxRow*size,textHighlights=[{pattern:"a",occurance:6},{pattern:"thousand",occurance:3},{pattern:"words",occurance:7},{pattern:"is",occurance:8},{pattern:"worth",occurance:10},{pattern:"a",occurance:31},{pattern:"picture",occurance:7},{pattern:"but",occurance:8},{pattern:"a",occurance:93},{pattern:"hundred",occurance:17},{pattern:"words",occurance:36},{pattern:"and",occurance:37},{pattern:"some",occurance:19},{pattern:"code",occurance:20},{pattern:"is",occurance:43},{pattern:"worth",occurance:44},{pattern:"a",occurance:135},{pattern:"gif",occurance:23}];class Painter{constructor(_){Jn(this,"container");Jn(this,"app");Jn(this,"pixels",[]);Jn(this,"animatingPixels",[]);Jn(this,"textPixels",[]);Jn(this,"currentFrame",0);Jn(this,"animationTimer");Jn(this,"finishedInitial",!1);this.animationTimer=createTimer({frameRate:24,onUpdate:()=>{this.animatingPixels.forEach((_e,tt)=>{_e.scale.set(scaleFrames[this.currentFrame][tt]),_e.tint=colorFrames[this.currentFrame][tt]}),this.currentFrame=(this.currentFrame+1)%frameCount},autoplay:!1}),this.container=_,(async()=>{const _e=new Application;this.app=_e,await _e.init({resizeTo:_,backgroundAlpha:0,resolution:window.devicePixelRatio}),_.appendChild(_e.canvas);const nt=_.clientWidth/size,rt=.5,it=.5;for(let at=0;at<size*size;at++){const lt=new Text({text:pixelText.charAt(at%pixelText.length),style:new TextStyle({fontFamily:"Azeret Mono",fontSize:2.3*parseFloat(utils.get(_,"font-size","px")),fill:"white"})});lt.x=at%size*nt+nt*it,lt.y=Math.floor(at/size)*nt+nt*rt,lt.anchor.set(.5,.5),lt.scale.set(.5,.5),lt.tint=MatterTone.Black,lt.alpha=0,this.pixels.push(lt),_e.stage.addChild(lt)}await fetch("/LoadedFrames/ColorFrame.txt").then(at=>at.text()).then(at=>colorFrames=JSON.parse(lzw_decode(at))),await fetch("/LoadedFrames/ScaleFrame.txt").then(at=>at.text()).then(at=>scaleFrames=JSON.parse(lzw_decode(at))),this.animatingPixels=this.pixels.slice(starting,ending);const st=Math.floor(size*size/pixelText.length),ot=pixelText.repeat(st);textHighlights.forEach(({pattern:at,occurance:lt})=>{const ct=nthSubstring(ot,at,lt),ht=[];for(let ut=ct;ut<ct+at.length;ut++)ht.push(this.pixels[ut]);this.textPixels.push(ht)})})()}play(){this.animationTimer.play()}pause(){this.animationTimer.pause()}show(){setTimeout(()=>{this.textPixels.forEach((_,_e)=>{setTimeout(()=>{_.forEach(tt=>{tt.scale.set(1.2,1.2),tt.tint=MatterTone.White,tt.alpha=1}),_e===this.textPixels.length-1&&animate(this.pixels,{tint:(tt,nt)=>nt===void 0?5066061:this.pixels[nt].scale.x===1.2?{from:MatterTone.White,to:MatterTone.White}:nt<starting||nt>=ending?{from:MatterTone.Black,to:colorFrames[this.currentFrame][0]}:{from:MatterTone.Black,to:colorFrames[this.currentFrame][nt-starting]},alpha:1,duration:150,delay:stagger(25,{start:1e3,grid:[size,size],from:size*size-size/2}),onBegin:()=>{this.animatingPixels.forEach((tt,nt)=>{tt.scale.set(scaleFrames[this.currentFrame][nt])})},onComplete:()=>{setTimeout(()=>{this.play(),this.finishedInitial=!0},500)}})},_e>7?550*_e+1e3:550*_e)})},1e3)}resize(){const _e=this.container.clientWidth/size,tt=.5,nt=.5;for(var rt=0;rt<size*size;rt++){const it=this.pixels[rt];it.style.fontSize=2.3*parseFloat(utils.get(this.container,"font-size","px")),it.x=rt%size*_e+_e*nt,it.y=Math.floor(rt/size)*_e+_e*tt}}}let painter;function PaintPage({containerRef:et,pageNumber:_}){const{active:_e,ready:tt}=usePage(),[nt,rt,it]=useState(!1),st=reactExports.useRef(null),ot=reactExports.useRef(!1),at=()=>{painter.resize()};return reactExports.useEffect(()=>(window.addEventListener("resize",at),()=>window.removeEventListener("resize",at)),[]),reactExports.useEffect(()=>{if(_e===_){if(!it.current){if(rt(!0),!painter)return;painter.show()}ot.current=!0}else et.current.classList.remove("show"),painter&&painter.pause(),ot.current=!1},[_e]),reactExports.useEffect(()=>{tt===_&&(et.current.classList.add("show"),painter&&painter.finishedInitial&&it.current&&painter.play())},[tt]),reactExports.useEffect(()=>{st.current&&(painter||(painter=new Painter(st.current)))},[st.current]),jsxRuntimeExports.jsx("div",{className:"w-full h-full relative",children:jsxRuntimeExports.jsx("div",{ref:st,className:"paint-grid"})})}const word="explorer",rows=6,duration=800,isInner=et=>et>0&&et<5,isInnerInner=et=>isInner(Math.floor(et/word.length)),desc=[jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["What better way to show you ",jsxRuntimeExports.jsx("br",{})," that I'm an explorer"]}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Than to show you ",jsxRuntimeExports.jsx("br",{})," the journey itself?"]}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["What you are seeing is the ",jsxRuntimeExports.jsx("br",{}),"process of taking a single word"]}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["And me experimenting with the ",jsxRuntimeExports.jsx("br",{})," different ways it can be animated"]}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["I let curiosity take the wheel ",jsxRuntimeExports.jsx("br",{})," because it can lead to some..."]}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Mesmerizing ",jsxRuntimeExports.jsx("br",{})," effects"]})];function KineticWord({wordRef:et,pivotRef:_,charRef:_e}){return jsxRuntimeExports.jsxs("div",{ref:tt=>et.current.push(tt),className:"flex kinetic-word pointer-events-all",children:[word.split("").map((tt,nt)=>jsxRuntimeExports.jsx("div",{ref:rt=>_.current.push(rt),className:"kinetic-pivot",children:jsxRuntimeExports.jsx("span",{ref:rt=>_e.current.push(rt),className:"kinetic-char",style:{WebkitTextStrokeColor:MatterTone.White,transform:`translateX(${.28+(nt-word.length/2)*.63}em)`},children:tt},nt)},nt)),jsxRuntimeExports.jsx("div",{className:"opacity-0",children:""})]})}function KineticSlider({setLevel:et,level:_,levelRef:_e,animatingRef:tt}){const nt=reactExports.useRef(null),rt=reactExports.useMemo(()=>desc.map((st,ot)=>jsxRuntimeExports.jsx("div",{className:`pointer-events-none cursor-none no-select text-text flex justify-center 
        items-center flex-shrink-0 text-center w-full h-full bg-black`,children:st},ot)),[]),it=st=>{if(!tt.current){if(st==="left"){if(_e.current>0){if(et(ot=>ot-1),!nt.current)return;animate(nt.current,{translateX:{to:"+=100%"},duration:duration/2})}}else if(_e.current<desc.length-1){if(et(ot=>ot+1),!nt.current)return;animate(nt.current,{translateX:{to:"-=100%"},duration:duration/2})}}};return jsxRuntimeExports.jsxs("div",{className:"h-max w-max gap-3 text-transparent text-kinetic pointer-events-auto relative no-select",children:["explorer",jsxRuntimeExports.jsxs("div",{className:"absolute w-full h-full top-0 flex text-text text-white",children:[jsxRuntimeExports.jsx("button",{className:"level-button self-center z-50",onClick:()=>it("left"),children:_===0?jsxRuntimeExports.jsxs("svg",{className:"w-[1em]",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:[jsxRuntimeExports.jsx("path",{className:"fill-white",d:"m4.12 6.137 1.521-1.52 7 7-1.52 1.52z"}),jsxRuntimeExports.jsx("path",{className:"fill-white",d:"m4.12 11.61 7.001-7 1.52 1.52-7 7z"})]}):jsxRuntimeExports.jsx("svg",{className:"w-[1em]",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",children:jsxRuntimeExports.jsx("path",{className:"fill-white",d:"M24 12.001H2.914l5.294-5.295-.707-.707L1 12.501l6.5 6.5.707-.707-5.293-5.293H24v-1z","data-name":"Left"})})}),jsxRuntimeExports.jsx("div",{className:"pointer-events-none cursor-none text-text flex-grow max-w-[20000px] overflow-hidden w-full h-full",children:jsxRuntimeExports.jsx("div",{ref:nt,className:"w-full h-full flex justify-start text-center",children:rt})}),jsxRuntimeExports.jsx("button",{className:"level-button self-center z-50",onClick:()=>it("right"),children:_===desc.length-1?jsxRuntimeExports.jsxs("svg",{className:"w-[1em]",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:[jsxRuntimeExports.jsx("path",{className:"fill-white",d:"m4.12 6.137 1.521-1.52 7 7-1.52 1.52z"}),jsxRuntimeExports.jsx("path",{className:"fill-white",d:"m4.12 11.61 7.001-7 1.52 1.52-7 7z"})]}):jsxRuntimeExports.jsx("svg",{className:"w-[1em]",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",children:jsxRuntimeExports.jsx("path",{className:"fill-white",d:"m17.5 5.999-.707.707 5.293 5.293H1v1h21.086l-5.294 5.295.707.707L24 12.499l-6.5-6.5z","data-name":"Right"})})})]})]})}const EMPTY="rgba(255, 255, 255, 0)",cols=word.length,gap=25,colIndexes=Array.from({length:cols},(et,_)=>_),moveLeft=(et,_)=>{if(et&&utils.get(et,"left")!==_)return animate(et,{left:_,duration:duration/2})},moveY=(et,_)=>animate(et,{translateY:(_e,tt)=>tt===void 0?0:_[tt]+"svh",duration:duration/2}),colorFill=(et,_)=>animate(et,{color:_||EMPTY,duration});var colorStroked=!1;const colorStroke=et=>{colorStroked||(colorStroked=!0,et.forEach(_=>{_.style.webkitTextStrokeColor=MatterColor.Random()}))},whiteStroke=et=>{colorStroked&&(colorStroked=!1,et.forEach(_=>{_.style.webkitTextStrokeColor=MatterTone.White}))};var isBouncing=!1;const bounces=[],charByCol=[],charBounce=(et,_,_e,tt)=>{if(!isBouncing){if(isBouncing=!0,charByCol.length===0)for(let rt=0;rt<cols;rt++){const it=[];for(let st=rt;st<et.length;st+=cols)it.push(et[st]);charByCol.push(it)}var nt=cols;charByCol.forEach((rt,it)=>{animate(rt,{translateY:"+="+_+"lvh",duration:duration/2,delay:it*100,ease:"inOutQuad",onComplete:()=>{--nt===0&&setTimeout(()=>{tt()},200),rt.forEach((st,ot)=>{setTimeout(()=>{bounces.push(animate(st,{translateY:"-="+_e+"lvh",duration,loop:!0,alternate:!0}))},ot*50)})}})})}},stopBounce=()=>{isBouncing&&(isBouncing=!1,bounces.forEach(et=>{et.pause()}),bounces.length=0,charByCol.forEach(et=>{animate(et,{translateY:0,duration:duration/2})}))},shiftStrokeDown=(et,_,_e=!0)=>{for(var tt=et[_].style.webkitTextStrokeColor,nt=1;nt<rows;nt++){var rt=et[_+nt*cols].style.webkitTextStrokeColor;et[_+nt*cols].style.webkitTextStrokeColor=tt,tt=rt}_e&&(et[_].style.webkitTextStrokeColor=tt)};var lastVerticalAnimation=null;const shiftDown=(et,_)=>{flashing&&lastSpawned[_]>1&&Math.random()<lastSpawned[_]/10&&(lastSpawned[_]=0,flashes[_].add(new Flash(_)));for(let _e=0;_e<rows;_e++)lastVerticalAnimation=animate(et[_+_e*cols],{translateY:{from:0,to:gap+"lvh"},duration:duration/2,onComplete:()=>{_e===rows-1&&(isShifting[_]=!1,hasShifted[_]=!0)}})},resetShiftAll=(et,_)=>{setTimeout(()=>{for(let _e=0;_e<cols;_e++)if(hasShifted[_e]){shiftStrokeDown(et,_e),flashes[_e].forEach(tt=>tt.moveDown());for(let tt=0;tt<rows;tt++)utils.set(et[_e+tt*cols],{translateY:0});hasShifted[_e]=!1}_&&_()},lastVerticalAnimation?lastVerticalAnimation.completed?0:lastVerticalAnimation.duration-lastVerticalAnimation.currentTime+50:0)};var verticallyMoving=!1,verticalTimer=null;const isShifting=Array.from({length:cols},()=>!1),hasShifted=Array.from({length:cols},()=>!1),startVertical=et=>{verticallyMoving||(verticallyMoving=!0,verticalTimer=createTimer({duration,loop:!0,onLoop:()=>{shuffle(colIndexes);for(var _=randomInt(1,cols/2),_e=0;_e<_;_e++)hasShifted[colIndexes[_e]]&&(shiftStrokeDown(et,colIndexes[_e]),lastSpawned[colIndexes[_e]]++,flashes[colIndexes[_e]].forEach(tt=>{tt.moveDown()||flashes[colIndexes[_e]].delete(tt)})),shiftDown(et,colIndexes[_e]),isShifting[colIndexes[_e]]=!0}}))},resetVertical=et=>{et.forEach(_=>{utils.set(_,{translateY:0})}),hasShifted.fill(!1)},stopVertical=()=>{verticallyMoving&&(verticallyMoving=!1,verticalTimer&&(verticalTimer.pause(),verticalTimer=null))};var flashing=!1;const wo=class wo{constructor(_){Jn(this,"row");Jn(this,"col");Jn(this,"current");this.row=0,this.col=_,this.current=wo.targets[_+this.row*cols],this.current.style.color=this.current.style.webkitTextStrokeColor}moveDown(){return this.current.style.color=EMPTY,this.row++,this.row>=rows?!1:(hasShifted[this.col]?this.current=wo.targets[this.col+this.row*cols]:this.current=wo.targets[this.col+(this.row-1)*cols],this.current.style.color=this.current.style.webkitTextStrokeColor,!0)}moveRight(){return this.current.style.color=EMPTY,this.col=(this.col+1)%cols,hasShifted[this.col]?this.current=wo.targets[this.col+this.row*cols]:this.current=wo.targets[this.col+(this.row-1)*cols],this.current.style.color=this.current.style.webkitTextStrokeColor,!0}};Jn(wo,"targets");let Flash=wo;const flashes={};Array.from({length:cols},(et,_)=>{flashes[_]=new Set});const lastSpawned=Array.from({length:cols},()=>1/0),startFlashing=et=>{flashing||(flashing=!0,Flash.targets=et,lastSpawned.fill(1/0))},stopFlashing=()=>{flashing&&(flashing=!1,Object.entries(flashes).forEach(([et,_])=>{_.clear()}))};var ringAnimation=null;const pivotRing=(et,_)=>{animate(et,{rotateY:(_e,tt)=>tt===void 0?0:tt%cols*360/cols,duration:duration/2,onComplete:()=>{_(),ringAnimation=animate(et,{rotateY:"+=360",duration:duration*10,loop:!0,ease:"linear"})}})},charRing=[],charFaceCenter=et=>{charRing.length===0&&et.forEach(_=>{charRing.push(utils.get(_,"translateX"))}),animate(et,{translateX:0,translateZ:"3em",duration:duration/2})},pivotLinear=et=>(ringAnimation&&(ringAnimation.pause(),ringAnimation=null),animate(et,{rotateY:0,duration:duration/2,ease:"linear"})),charFaceLinear=et=>{charRing.length!==0&&animate(et,{translateX:(_,_e)=>_e===void 0?0:charRing[_e],translateZ:0,duration:duration/2,ease:"linear"})};var sphereAnimation=null;const startSphere=et=>animate(et,{rotateZ:(_,_e)=>_e===void 0?0:_e/et.length*180,duration:duration/2,onComplete:()=>{sphereAnimation=animate(et,{rotateX:360,rotateY:360,duration:1e4,ease:"linear",loop:!0})}}),stopSphere=et=>{sphereAnimation!==null&&(sphereAnimation.pause(),animate(et,{rotateX:0,rotateZ:0,rotateY:0,duration:duration/2}),sphereAnimation=null)},pauseAll=()=>{bounces.length&&bounces.forEach(et=>et.pause()),verticalTimer&&verticalTimer.pause(),ringAnimation&&ringAnimation.pause(),sphereAnimation&&sphereAnimation.pause()},resumeAll=()=>{bounces.length&&bounces.forEach(et=>et.play()),verticalTimer&&verticalTimer.play(),ringAnimation&&ringAnimation.play(),sphereAnimation&&sphereAnimation.play()};function KineticPage({containerRef:et,pageNumber:_}){const{active:_e,ready:tt}=usePage(),nt=reactExports.useRef([]),rt=reactExports.useRef([]),it=reactExports.useRef([]),st=reactExports.useRef(null),[ot,at,lt]=useState(0),ct=reactExports.useRef(!1);reactExports.useEffect(()=>{_e===_||(et.current.classList.remove("show"),pauseAll())},[_e]),reactExports.useEffect(()=>{tt===_&&(et.current.classList.add("show"),resumeAll())},[tt]);const ht=reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{ref:st,className:"w-full h-[150%] max-h-[20000px] flex flex-col justify-around items-center kinetic-container",children:Array.from({length:rows}).map((ut,ft)=>jsxRuntimeExports.jsx(KineticWord,{wordRef:nt,pivotRef:rt,charRef:it},ft))}),[]);return reactExports.useEffect(()=>{switch(ct.current=!0,ot){case 0:stopBounce(),moveY(nt.current,[0,25,0,-25,-50,0]),colorFill(it.current,"#ffffffff").onComplete=()=>ct.current=!1,whiteStroke(it.current),resetVertical(it.current),moveLeft(st.current,"-0.25em");break;case 1:charBounce(it.current.filter((ut,ft)=>isInnerInner(ft)),20,20,()=>ct.current=!1),moveY(nt.current,[0,25,0,-25,-50,0]),moveLeft(st.current,"-0.25em");break;case 2:stopBounce(),colorStroke(it.current),moveY(nt.current,[0,0,0,0,0,0]),stopVertical(),stopFlashing(),colorFill(it.current,"#ffffff00").onComplete=()=>resetShiftAll(it.current,()=>ct.current=!1),moveLeft(st.current,"-0.25em");break;case 3:startVertical(it.current),startFlashing(it.current),pivotLinear(rt.current).onComplete=()=>ct.current=!1,charFaceLinear(it.current),moveLeft(st.current,"-0.25em");break;case 4:startVertical(it.current),pivotRing(rt.current,()=>ct.current=!1),charFaceCenter(it.current),moveY(nt.current.filter((ut,ft)=>isInner(ft)),[0,0,0,0]),stopSphere(nt.current.filter((ut,ft)=>isInner(ft))),moveLeft(st.current,"0");break;case 5:stopVertical(),resetShiftAll(it.current,()=>{moveY(nt.current.filter((ut,ft)=>isInner(ft)),[37.5,12.5,-12.5,-37.5]).onComplete=()=>ct.current=!1,startSphere(nt.current.filter((ut,ft)=>isInner(ft)))}),moveLeft(st.current,"0");break}},[ot]),jsxRuntimeExports.jsxs("div",{className:"w-full h-full flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-full absolute top-0 flex justify-center items-center text-kinetic",children:jsxRuntimeExports.jsx(KineticSlider,{level:ot,setLevel:at,levelRef:lt,animatingRef:ct})}),ht]})}var lib={},uaParser_min={exports:{}};(function(et,_){(function(_e,tt){var nt="1.0.38",rt="",it="?",st="function",ot="undefined",at="object",lt="string",ct="major",ht="model",ut="name",ft="type",dt="vendor",pt="version",mt="architecture",vt="console",yt="mobile",_t="tablet",St="smarttv",bt="wearable",Et="embedded",Mt=500,Tt="Amazon",wt="Apple",Ct="ASUS",Rt="BlackBerry",It="Browser",Dt="Chrome",Ft="Edge",$t="Firefox",Yt="Google",Lt="Huawei",Ot="LG",Nt="Microsoft",zt="Motorola",Ht="Opera",qt="Samsung",Gt="Sharp",Xt="Sony",Zt="Xiaomi",Qt="Zebra",un="Facebook",wn="Chromium OS",Tn="Mac OS",yn=function(sn,xn){var an={};for(var pn in sn)xn[pn]&&xn[pn].length%2===0?an[pn]=xn[pn].concat(sn[pn]):an[pn]=sn[pn];return an},Vt=function(sn){for(var xn={},an=0;an<sn.length;an++)xn[sn[an].toUpperCase()]=sn[an];return xn},fn=function(sn,xn){return typeof sn===lt?ln(xn).indexOf(ln(sn))!==-1:!1},ln=function(sn){return sn.toLowerCase()},Jt=function(sn){return typeof sn===lt?sn.replace(/[^\d\.]/g,rt).split(".")[0]:tt},on=function(sn,xn){if(typeof sn===lt)return sn=sn.replace(/^\s\s*/,rt),typeof xn===ot?sn:sn.substring(0,Mt)},_n=function(sn,xn){for(var an=0,pn,Sn,gn,Rn,Mn,kn;an<xn.length&&!Mn;){var Fn=xn[an],Nn=xn[an+1];for(pn=Sn=0;pn<Fn.length&&!Mn&&Fn[pn];)if(Mn=Fn[pn++].exec(sn),Mn)for(gn=0;gn<Nn.length;gn++)kn=Mn[++Sn],Rn=Nn[gn],typeof Rn===at&&Rn.length>0?Rn.length===2?typeof Rn[1]==st?this[Rn[0]]=Rn[1].call(this,kn):this[Rn[0]]=Rn[1]:Rn.length===3?typeof Rn[1]===st&&!(Rn[1].exec&&Rn[1].test)?this[Rn[0]]=kn?Rn[1].call(this,kn,Rn[2]):tt:this[Rn[0]]=kn?kn.replace(Rn[1],Rn[2]):tt:Rn.length===4&&(this[Rn[0]]=kn?Rn[3].call(this,kn.replace(Rn[1],Rn[2])):tt):this[Rn]=kn||tt;an+=2}},cn=function(sn,xn){for(var an in xn)if(typeof xn[an]===at&&xn[an].length>0){for(var pn=0;pn<xn[an].length;pn++)if(fn(xn[an][pn],sn))return an===it?tt:an}else if(fn(xn[an],sn))return an===it?tt:an;return sn},tn={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Wt={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Bt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[pt,[ut,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[pt,[ut,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[ut,pt],[/opios[\/ ]+([\w\.]+)/i],[pt,[ut,Ht+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[pt,[ut,Ht+" GX"]],[/\bopr\/([\w\.]+)/i],[pt,[ut,Ht]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[pt,[ut,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[ut,pt],[/\bddg\/([\w\.]+)/i],[pt,[ut,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[pt,[ut,"UC"+It]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[pt,[ut,"WeChat"]],[/konqueror\/([\w\.]+)/i],[pt,[ut,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[pt,[ut,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[pt,[ut,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[pt,[ut,"Smart Lenovo "+It]],[/(avast|avg)\/([\w\.]+)/i],[[ut,/(.+)/,"$1 Secure "+It],pt],[/\bfocus\/([\w\.]+)/i],[pt,[ut,$t+" Focus"]],[/\bopt\/([\w\.]+)/i],[pt,[ut,Ht+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[pt,[ut,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[pt,[ut,"Dolphin"]],[/coast\/([\w\.]+)/i],[pt,[ut,Ht+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[pt,[ut,"MIUI "+It]],[/fxios\/([-\w\.]+)/i],[pt,[ut,$t]],[/\bqihu|(qi?ho?o?|360)browser/i],[[ut,"360 "+It]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[ut,/(.+)/,"$1 "+It],pt],[/samsungbrowser\/([\w\.]+)/i],[pt,[ut,qt+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[ut,/_/g," "],pt],[/metasr[\/ ]?([\d\.]+)/i],[pt,[ut,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[ut,"Sogou Mobile"],pt],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[ut,pt],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[ut],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[ut,un],pt],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[ut,pt],[/\bgsa\/([\w\.]+) .*safari\//i],[pt,[ut,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[pt,[ut,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[pt,[ut,Dt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[ut,Dt+" WebView"],pt],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[pt,[ut,"Android "+It]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[ut,pt],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[pt,[ut,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[pt,ut],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[ut,[pt,cn,tn]],[/(webkit|khtml)\/([\w\.]+)/i],[ut,pt],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[ut,"Netscape"],pt],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[pt,[ut,$t+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[ut,pt],[/(cobalt)\/([\w\.]+)/i],[ut,[pt,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[mt,"amd64"]],[/(ia32(?=;))/i],[[mt,ln]],[/((?:i[346]|x)86)[;\)]/i],[[mt,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[mt,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[mt,"armhf"]],[/windows (ce|mobile); ppc;/i],[[mt,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[mt,/ower/,rt,ln]],[/(sun4\w)[;\)]/i],[[mt,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[mt,ln]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[ht,[dt,qt],[ft,_t]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[ht,[dt,qt],[ft,yt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[ht,[dt,wt],[ft,yt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[ht,[dt,wt],[ft,_t]],[/(macintosh);/i],[ht,[dt,wt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[ht,[dt,Gt],[ft,yt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[ht,[dt,Lt],[ft,_t]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[ht,[dt,Lt],[ft,yt]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[ht,/_/g," "],[dt,Zt],[ft,yt]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[ht,/_/g," "],[dt,Zt],[ft,_t]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[ht,[dt,"OPPO"],[ft,yt]],[/\b(opd2\d{3}a?) bui/i],[ht,[dt,"OPPO"],[ft,_t]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[ht,[dt,"Vivo"],[ft,yt]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[ht,[dt,"Realme"],[ft,yt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[ht,[dt,zt],[ft,yt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[ht,[dt,zt],[ft,_t]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[ht,[dt,Ot],[ft,_t]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[ht,[dt,Ot],[ft,yt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[ht,[dt,"Lenovo"],[ft,_t]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[ht,/_/g," "],[dt,"Nokia"],[ft,yt]],[/(pixel c)\b/i],[ht,[dt,Yt],[ft,_t]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[ht,[dt,Yt],[ft,yt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[ht,[dt,Xt],[ft,yt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[ht,"Xperia Tablet"],[dt,Xt],[ft,_t]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[ht,[dt,"OnePlus"],[ft,yt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[ht,[dt,Tt],[ft,_t]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[ht,/(.+)/g,"Fire Phone $1"],[dt,Tt],[ft,yt]],[/(playbook);[-\w\),; ]+(rim)/i],[ht,dt,[ft,_t]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[ht,[dt,Rt],[ft,yt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[ht,[dt,Ct],[ft,_t]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[ht,[dt,Ct],[ft,yt]],[/(nexus 9)/i],[ht,[dt,"HTC"],[ft,_t]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[dt,[ht,/_/g," "],[ft,yt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[ht,[dt,"Acer"],[ft,_t]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[ht,[dt,"Meizu"],[ft,yt]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[ht,[dt,"Ulefone"],[ft,yt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[dt,ht,[ft,yt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[dt,ht,[ft,_t]],[/(surface duo)/i],[ht,[dt,Nt],[ft,_t]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[ht,[dt,"Fairphone"],[ft,yt]],[/(u304aa)/i],[ht,[dt,"AT&T"],[ft,yt]],[/\bsie-(\w*)/i],[ht,[dt,"Siemens"],[ft,yt]],[/\b(rct\w+) b/i],[ht,[dt,"RCA"],[ft,_t]],[/\b(venue[\d ]{2,7}) b/i],[ht,[dt,"Dell"],[ft,_t]],[/\b(q(?:mv|ta)\w+) b/i],[ht,[dt,"Verizon"],[ft,_t]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[ht,[dt,"Barnes & Noble"],[ft,_t]],[/\b(tm\d{3}\w+) b/i],[ht,[dt,"NuVision"],[ft,_t]],[/\b(k88) b/i],[ht,[dt,"ZTE"],[ft,_t]],[/\b(nx\d{3}j) b/i],[ht,[dt,"ZTE"],[ft,yt]],[/\b(gen\d{3}) b.+49h/i],[ht,[dt,"Swiss"],[ft,yt]],[/\b(zur\d{3}) b/i],[ht,[dt,"Swiss"],[ft,_t]],[/\b((zeki)?tb.*\b) b/i],[ht,[dt,"Zeki"],[ft,_t]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[dt,"Dragon Touch"],ht,[ft,_t]],[/\b(ns-?\w{0,9}) b/i],[ht,[dt,"Insignia"],[ft,_t]],[/\b((nxa|next)-?\w{0,9}) b/i],[ht,[dt,"NextBook"],[ft,_t]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[dt,"Voice"],ht,[ft,yt]],[/\b(lvtel\-)?(v1[12]) b/i],[[dt,"LvTel"],ht,[ft,yt]],[/\b(ph-1) /i],[ht,[dt,"Essential"],[ft,yt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[ht,[dt,"Envizen"],[ft,_t]],[/\b(trio[-\w\. ]+) b/i],[ht,[dt,"MachSpeed"],[ft,_t]],[/\btu_(1491) b/i],[ht,[dt,"Rotor"],[ft,_t]],[/(shield[\w ]+) b/i],[ht,[dt,"Nvidia"],[ft,_t]],[/(sprint) (\w+)/i],[dt,ht,[ft,yt]],[/(kin\.[onetw]{3})/i],[[ht,/\./g," "],[dt,Nt],[ft,yt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[ht,[dt,Qt],[ft,_t]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[ht,[dt,Qt],[ft,yt]],[/smart-tv.+(samsung)/i],[dt,[ft,St]],[/hbbtv.+maple;(\d+)/i],[[ht,/^/,"SmartTV"],[dt,qt],[ft,St]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[dt,Ot],[ft,St]],[/(apple) ?tv/i],[dt,[ht,wt+" TV"],[ft,St]],[/crkey/i],[[ht,Dt+"cast"],[dt,Yt],[ft,St]],[/droid.+aft(\w+)( bui|\))/i],[ht,[dt,Tt],[ft,St]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[ht,[dt,Gt],[ft,St]],[/(bravia[\w ]+)( bui|\))/i],[ht,[dt,Xt],[ft,St]],[/(mitv-\w{5}) bui/i],[ht,[dt,Zt],[ft,St]],[/Hbbtv.*(technisat) (.*);/i],[dt,ht,[ft,St]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[dt,on],[ht,on],[ft,St]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[ft,St]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[dt,ht,[ft,vt]],[/droid.+; (shield) bui/i],[ht,[dt,"Nvidia"],[ft,vt]],[/(playstation [345portablevi]+)/i],[ht,[dt,Xt],[ft,vt]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[ht,[dt,Nt],[ft,vt]],[/((pebble))app/i],[dt,ht,[ft,bt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[ht,[dt,wt],[ft,bt]],[/droid.+; (glass) \d/i],[ht,[dt,Yt],[ft,bt]],[/droid.+; (wt63?0{2,3})\)/i],[ht,[dt,Qt],[ft,bt]],[/(quest( \d| pro)?)/i],[ht,[dt,un],[ft,bt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[dt,[ft,Et]],[/(aeobc)\b/i],[ht,[dt,Tt],[ft,Et]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[ht,[ft,yt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[ht,[ft,_t]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[ft,_t]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[ft,yt]],[/(android[-\w\. ]{0,9});.+buil/i],[ht,[dt,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[pt,[ut,Ft+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[pt,[ut,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[ut,pt],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[pt,ut]],os:[[/microsoft (windows) (vista|xp)/i],[ut,pt],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[ut,[pt,cn,Wt]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[pt,cn,Wt],[ut,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[pt,/_/g,"."],[ut,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[ut,Tn],[pt,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[pt,ut],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[ut,pt],[/\(bb(10);/i],[pt,[ut,Rt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[pt,[ut,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[pt,[ut,$t+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[pt,[ut,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[pt,[ut,"watchOS"]],[/crkey\/([\d\.]+)/i],[pt,[ut,Dt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[ut,wn],pt],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[ut,pt],[/(sunos) ?([\w\.\d]*)/i],[[ut,"Solaris"],pt],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[ut,pt]]},nn=function(sn,xn){if(typeof sn===at&&(xn=sn,sn=tt),!(this instanceof nn))return new nn(sn,xn).getResult();var an=typeof _e!==ot&&_e.navigator?_e.navigator:tt,pn=sn||(an&&an.userAgent?an.userAgent:rt),Sn=an&&an.userAgentData?an.userAgentData:tt,gn=xn?yn(Bt,xn):Bt,Rn=an&&an.userAgent==pn;return this.getBrowser=function(){var Mn={};return Mn[ut]=tt,Mn[pt]=tt,_n.call(Mn,pn,gn.browser),Mn[ct]=Jt(Mn[pt]),Rn&&an&&an.brave&&typeof an.brave.isBrave==st&&(Mn[ut]="Brave"),Mn},this.getCPU=function(){var Mn={};return Mn[mt]=tt,_n.call(Mn,pn,gn.cpu),Mn},this.getDevice=function(){var Mn={};return Mn[dt]=tt,Mn[ht]=tt,Mn[ft]=tt,_n.call(Mn,pn,gn.device),Rn&&!Mn[ft]&&Sn&&Sn.mobile&&(Mn[ft]=yt),Rn&&Mn[ht]=="Macintosh"&&an&&typeof an.standalone!==ot&&an.maxTouchPoints&&an.maxTouchPoints>2&&(Mn[ht]="iPad",Mn[ft]=_t),Mn},this.getEngine=function(){var Mn={};return Mn[ut]=tt,Mn[pt]=tt,_n.call(Mn,pn,gn.engine),Mn},this.getOS=function(){var Mn={};return Mn[ut]=tt,Mn[pt]=tt,_n.call(Mn,pn,gn.os),Rn&&!Mn[ut]&&Sn&&Sn.platform&&Sn.platform!="Unknown"&&(Mn[ut]=Sn.platform.replace(/chrome os/i,wn).replace(/macos/i,Tn)),Mn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return pn},this.setUA=function(Mn){return pn=typeof Mn===lt&&Mn.length>Mt?on(Mn,Mt):Mn,this},this.setUA(pn),this};nn.VERSION=nt,nn.BROWSER=Vt([ut,pt,ct]),nn.CPU=Vt([mt]),nn.DEVICE=Vt([ht,dt,ft,vt,yt,St,_t,bt,Et]),nn.ENGINE=nn.OS=Vt([ut,pt]),et.exports&&(_=et.exports=nn),_.UAParser=nn;var en=typeof _e!==ot&&(_e.jQuery||_e.Zepto);if(en&&!en.ua){var mn=new nn;en.ua=mn.getResult(),en.ua.get=function(){return mn.getUA()},en.ua.set=function(sn){mn.setUA(sn);var xn=mn.getResult();for(var an in xn)en.ua[an]=xn[an]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser_min,uaParser_min.exports);var uaParser_minExports=uaParser_min.exports;Object.defineProperty(lib,"__esModule",{value:!0});function _interopDefault(et){return et&&typeof et=="object"&&"default"in et?et.default:et}var React=reactExports,React__default=_interopDefault(React),UAParser=uaParser_minExports,ClientUAInstance=new UAParser,browser=ClientUAInstance.getBrowser(),cpu=ClientUAInstance.getCPU(),device=ClientUAInstance.getDevice(),engine=ClientUAInstance.getEngine(),os=ClientUAInstance.getOS(),ua=ClientUAInstance.getUA(),setUa=function et(_){return ClientUAInstance.setUA(_)},parseUserAgent=function et(_){if(!_){console.error("No userAgent string was provided");return}var _e=new UAParser(_);return{UA:_e,browser:_e.getBrowser(),cpu:_e.getCPU(),device:_e.getDevice(),engine:_e.getEngine(),os:_e.getOS(),ua:_e.getUA(),setUserAgent:function(nt){return _e.setUA(nt)}}},UAHelper=Object.freeze({ClientUAInstance,browser,cpu,device,engine,os,ua,setUa,parseUserAgent});function ownKeys(et,_){var _e=Object.keys(et);if(Object.getOwnPropertySymbols){var tt=Object.getOwnPropertySymbols(et);_&&(tt=tt.filter(function(nt){return Object.getOwnPropertyDescriptor(et,nt).enumerable})),_e.push.apply(_e,tt)}return _e}function _objectSpread2(et){for(var _=1;_<arguments.length;_++){var _e=arguments[_]!=null?arguments[_]:{};_%2?ownKeys(Object(_e),!0).forEach(function(tt){_defineProperty(et,tt,_e[tt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(et,Object.getOwnPropertyDescriptors(_e)):ownKeys(Object(_e)).forEach(function(tt){Object.defineProperty(et,tt,Object.getOwnPropertyDescriptor(_e,tt))})}return et}function _typeof(et){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(_){return typeof _}:_typeof=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof(et)}function _classCallCheck(et,_){if(!(et instanceof _))throw new TypeError("Cannot call a class as a function")}function _defineProperties(et,_){for(var _e=0;_e<_.length;_e++){var tt=_[_e];tt.enumerable=tt.enumerable||!1,tt.configurable=!0,"value"in tt&&(tt.writable=!0),Object.defineProperty(et,tt.key,tt)}}function _createClass(et,_,_e){return _&&_defineProperties(et.prototype,_),et}function _defineProperty(et,_,_e){return _ in et?Object.defineProperty(et,_,{value:_e,enumerable:!0,configurable:!0,writable:!0}):et[_]=_e,et}function _extends(){return _extends=Object.assign||function(et){for(var _=1;_<arguments.length;_++){var _e=arguments[_];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(et[tt]=_e[tt])}return et},_extends.apply(this,arguments)}function _inherits(et,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");et.prototype=Object.create(_&&_.prototype,{constructor:{value:et,writable:!0,configurable:!0}}),_&&_setPrototypeOf(et,_)}function _getPrototypeOf(et){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf(et)}function _setPrototypeOf(et,_){return _setPrototypeOf=Object.setPrototypeOf||function(tt,nt){return tt.__proto__=nt,tt},_setPrototypeOf(et,_)}function _objectWithoutPropertiesLoose(et,_){if(et==null)return{};var _e={},tt=Object.keys(et),nt,rt;for(rt=0;rt<tt.length;rt++)nt=tt[rt],!(_.indexOf(nt)>=0)&&(_e[nt]=et[nt]);return _e}function _objectWithoutProperties(et,_){if(et==null)return{};var _e=_objectWithoutPropertiesLoose(et,_),tt,nt;if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(et);for(nt=0;nt<rt.length;nt++)tt=rt[nt],!(_.indexOf(tt)>=0)&&Object.prototype.propertyIsEnumerable.call(et,tt)&&(_e[tt]=et[tt])}return _e}function _assertThisInitialized(et){if(et===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return et}function _possibleConstructorReturn(et,_){if(_&&(typeof _=="object"||typeof _=="function"))return _;if(_!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(et)}function _slicedToArray(et,_){return _arrayWithHoles(et)||_iterableToArrayLimit(et,_)||_unsupportedIterableToArray(et,_)||_nonIterableRest()}function _arrayWithHoles(et){if(Array.isArray(et))return et}function _iterableToArrayLimit(et,_){var _e=et==null?null:typeof Symbol<"u"&&et[Symbol.iterator]||et["@@iterator"];if(_e!=null){var tt=[],nt=!0,rt=!1,it,st;try{for(_e=_e.call(et);!(nt=(it=_e.next()).done)&&(tt.push(it.value),!(_&&tt.length===_));nt=!0);}catch(ot){rt=!0,st=ot}finally{try{!nt&&_e.return!=null&&_e.return()}finally{if(rt)throw st}}return tt}}function _unsupportedIterableToArray(et,_){if(et){if(typeof et=="string")return _arrayLikeToArray(et,_);var _e=Object.prototype.toString.call(et).slice(8,-1);if(_e==="Object"&&et.constructor&&(_e=et.constructor.name),_e==="Map"||_e==="Set")return Array.from(et);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return _arrayLikeToArray(et,_)}}function _arrayLikeToArray(et,_){(_==null||_>et.length)&&(_=et.length);for(var _e=0,tt=new Array(_);_e<_;_e++)tt[_e]=et[_e];return tt}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var DeviceTypes={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},BrowserTypes={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},OsTypes={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},InitialDeviceTypes={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},checkDeviceType=function et(_){switch(_){case DeviceTypes.Mobile:return{isMobile:!0};case DeviceTypes.Tablet:return{isTablet:!0};case DeviceTypes.SmartTv:return{isSmartTV:!0};case DeviceTypes.Console:return{isConsole:!0};case DeviceTypes.Wearable:return{isWearable:!0};case DeviceTypes.Browser:return{isBrowser:!0};case DeviceTypes.Embedded:return{isEmbedded:!0};default:return InitialDeviceTypes}},setUserAgent=function et(_){return setUa(_)},setDefaults=function et(_){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return _||_e},getNavigatorInstance=function et(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},isIOS13Check=function et(_){var _e=getNavigatorInstance();return _e&&_e.platform&&(_e.platform.indexOf(_)!==-1||_e.platform==="MacIntel"&&_e.maxTouchPoints>1&&!window.MSStream)},browserPayload=function et(_,_e,tt,nt,rt){return{isBrowser:_,browserMajorVersion:setDefaults(_e.major),browserFullVersion:setDefaults(_e.version),browserName:setDefaults(_e.name),engineName:setDefaults(tt.name),engineVersion:setDefaults(tt.version),osName:setDefaults(nt.name),osVersion:setDefaults(nt.version),userAgent:setDefaults(rt)}},mobilePayload=function et(_,_e,tt,nt){return _objectSpread2({},_,{vendor:setDefaults(_e.vendor),model:setDefaults(_e.model),os:setDefaults(tt.name),osVersion:setDefaults(tt.version),ua:setDefaults(nt)})},smartTvPayload=function et(_,_e,tt,nt){return{isSmartTV:_,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(tt.name),osVersion:setDefaults(tt.version),userAgent:setDefaults(nt)}},consolePayload=function et(_,_e,tt,nt){return{isConsole:_,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(tt.name),osVersion:setDefaults(tt.version),userAgent:setDefaults(nt)}},wearablePayload=function et(_,_e,tt,nt){return{isWearable:_,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(tt.name),osVersion:setDefaults(tt.version),userAgent:setDefaults(nt)}},embeddedPayload=function et(_,_e,tt,nt,rt){return{isEmbedded:_,vendor:setDefaults(_e.vendor),model:setDefaults(_e.model),engineName:setDefaults(tt.name),engineVersion:setDefaults(tt.version),osName:setDefaults(nt.name),osVersion:setDefaults(nt.version),userAgent:setDefaults(rt)}};function deviceDetect(et){var _=et?parseUserAgent(et):UAHelper,_e=_.device,tt=_.browser,nt=_.engine,rt=_.os,it=_.ua,st=checkDeviceType(_e.type),ot=st.isBrowser,at=st.isMobile,lt=st.isTablet,ct=st.isSmartTV,ht=st.isConsole,ut=st.isWearable,ft=st.isEmbedded;if(ot)return browserPayload(ot,tt,nt,rt,it);if(ct)return smartTvPayload(ct,nt,rt,it);if(ht)return consolePayload(ht,nt,rt,it);if(at||lt)return mobilePayload(st,_e,rt,it);if(ut)return wearablePayload(ut,nt,rt,it);if(ft)return embeddedPayload(ft,_e,nt,rt,it)}var isMobileType=function et(_){var _e=_.type;return _e===DeviceTypes.Mobile},isTabletType=function et(_){var _e=_.type;return _e===DeviceTypes.Tablet},isMobileAndTabletType=function et(_){var _e=_.type;return _e===DeviceTypes.Mobile||_e===DeviceTypes.Tablet},isSmartTVType=function et(_){var _e=_.type;return _e===DeviceTypes.SmartTv},isBrowserType=function et(_){var _e=_.type;return _e===DeviceTypes.Browser},isWearableType=function et(_){var _e=_.type;return _e===DeviceTypes.Wearable},isConsoleType=function et(_){var _e=_.type;return _e===DeviceTypes.Console},isEmbeddedType=function et(_){var _e=_.type;return _e===DeviceTypes.Embedded},getMobileVendor=function et(_){var _e=_.vendor;return setDefaults(_e)},getMobileModel=function et(_){var _e=_.model;return setDefaults(_e)},getDeviceType=function et(_){var _e=_.type;return setDefaults(_e,"browser")},isAndroidType=function et(_){var _e=_.name;return _e===OsTypes.Android},isWindowsType=function et(_){var _e=_.name;return _e===OsTypes.Windows},isMacOsType=function et(_){var _e=_.name;return _e===OsTypes.MAC_OS},isWinPhoneType=function et(_){var _e=_.name;return _e===OsTypes.WindowsPhone},isIOSType=function et(_){var _e=_.name;return _e===OsTypes.IOS},getOsVersion=function et(_){var _e=_.version;return setDefaults(_e)},getOsName=function et(_){var _e=_.name;return setDefaults(_e)},isChromeType=function et(_){var _e=_.name;return _e===BrowserTypes.Chrome},isFirefoxType=function et(_){var _e=_.name;return _e===BrowserTypes.Firefox},isChromiumType=function et(_){var _e=_.name;return _e===BrowserTypes.Chromium},isEdgeType=function et(_){var _e=_.name;return _e===BrowserTypes.Edge},isYandexType=function et(_){var _e=_.name;return _e===BrowserTypes.Yandex},isSafariType=function et(_){var _e=_.name;return _e===BrowserTypes.Safari||_e===BrowserTypes.MobileSafari},isMobileSafariType=function et(_){var _e=_.name;return _e===BrowserTypes.MobileSafari},isOperaType=function et(_){var _e=_.name;return _e===BrowserTypes.Opera},isIEType=function et(_){var _e=_.name;return _e===BrowserTypes.InternetExplorer||_e===BrowserTypes.Ie},isMIUIType=function et(_){var _e=_.name;return _e===BrowserTypes.MIUI},isSamsungBrowserType=function et(_){var _e=_.name;return _e===BrowserTypes.SamsungBrowser},getBrowserFullVersion=function et(_){var _e=_.version;return setDefaults(_e)},getBrowserVersion=function et(_){var _e=_.major;return setDefaults(_e)},getBrowserName=function et(_){var _e=_.name;return setDefaults(_e)},getEngineName=function et(_){var _e=_.name;return setDefaults(_e)},getEngineVersion=function et(_){var _e=_.version;return setDefaults(_e)},isElectronType=function et(){var _=getNavigatorInstance(),_e=_&&_.userAgent&&_.userAgent.toLowerCase();return typeof _e=="string"?/electron/.test(_e):!1},isEdgeChromiumType=function et(_){return typeof _=="string"&&_.indexOf("Edg/")!==-1},getIOS13=function et(){var _=getNavigatorInstance();return _&&(/iPad|iPhone|iPod/.test(_.platform)||_.platform==="MacIntel"&&_.maxTouchPoints>1)&&!window.MSStream},getIPad13=function et(){return isIOS13Check("iPad")},getIphone13=function et(){return isIOS13Check("iPhone")},getIPod13=function et(){return isIOS13Check("iPod")},getUseragent=function et(_){return setDefaults(_)};function buildSelectorsObject(et){var _=et||UAHelper,_e=_.device,tt=_.browser,nt=_.os,rt=_.engine,it=_.ua;return{isSmartTV:isSmartTVType(_e),isConsole:isConsoleType(_e),isWearable:isWearableType(_e),isEmbedded:isEmbeddedType(_e),isMobileSafari:isMobileSafariType(tt)||getIPad13(),isChromium:isChromiumType(tt),isMobile:isMobileAndTabletType(_e)||getIPad13(),isMobileOnly:isMobileType(_e),isTablet:isTabletType(_e)||getIPad13(),isBrowser:isBrowserType(_e),isDesktop:isBrowserType(_e),isAndroid:isAndroidType(nt),isWinPhone:isWinPhoneType(nt),isIOS:isIOSType(nt)||getIPad13(),isChrome:isChromeType(tt),isFirefox:isFirefoxType(tt),isSafari:isSafariType(tt),isOpera:isOperaType(tt),isIE:isIEType(tt),osVersion:getOsVersion(nt),osName:getOsName(nt),fullBrowserVersion:getBrowserFullVersion(tt),browserVersion:getBrowserVersion(tt),browserName:getBrowserName(tt),mobileVendor:getMobileVendor(_e),mobileModel:getMobileModel(_e),engineName:getEngineName(rt),engineVersion:getEngineVersion(rt),getUA:getUseragent(it),isEdge:isEdgeType(tt)||isEdgeChromiumType(it),isYandex:isYandexType(tt),deviceType:getDeviceType(_e),isIOS13:getIOS13(),isIPad13:getIPad13(),isIPhone13:getIphone13(),isIPod13:getIPod13(),isElectron:isElectronType(),isEdgeChromium:isEdgeChromiumType(it),isLegacyEdge:isEdgeType(tt)&&!isEdgeChromiumType(it),isWindows:isWindowsType(nt),isMacOs:isMacOsType(nt),isMIUI:isMIUIType(tt),isSamsungBrowser:isSamsungBrowserType(tt)}}var isSmartTV=isSmartTVType(device),isConsole=isConsoleType(device),isWearable=isWearableType(device),isEmbedded=isEmbeddedType(device),isMobileSafari=isMobileSafariType(browser)||getIPad13(),isChromium=isChromiumType(browser),isMobile=isMobileAndTabletType(device)||getIPad13(),isMobileOnly=isMobileType(device),isTablet=isTabletType(device)||getIPad13(),isBrowser=isBrowserType(device),isDesktop=isBrowserType(device),isAndroid=isAndroidType(os),isWinPhone=isWinPhoneType(os),isIOS=isIOSType(os)||getIPad13(),isChrome=isChromeType(browser),isFirefox=isFirefoxType(browser),isSafari=isSafariType(browser),isOpera=isOperaType(browser),isIE=isIEType(browser),osVersion=getOsVersion(os),osName=getOsName(os),fullBrowserVersion=getBrowserFullVersion(browser),browserVersion=getBrowserVersion(browser),browserName=getBrowserName(browser),mobileVendor=getMobileVendor(device),mobileModel=getMobileModel(device),engineName=getEngineName(engine),engineVersion=getEngineVersion(engine),getUA=getUseragent(ua),isEdge=isEdgeType(browser)||isEdgeChromiumType(ua),isYandex=isYandexType(browser),deviceType=getDeviceType(device),isIOS13=getIOS13(),isIPad13=getIPad13(),isIPhone13=getIphone13(),isIPod13=getIPod13(),isElectron=isElectronType(),isEdgeChromium=isEdgeChromiumType(ua),isLegacyEdge=isEdgeType(browser)&&!isEdgeChromiumType(ua),isWindows=isWindowsType(os),isMacOs=isMacOsType(os),isMIUI=isMIUIType(browser),isSamsungBrowser=isSamsungBrowserType(browser),getSelectorsByUserAgent=function et(_){if(!_||typeof _!="string"){console.error("No valid user agent string was provided");return}var _e=parseUserAgent(_),tt=_e.device,nt=_e.browser,rt=_e.os,it=_e.engine,st=_e.ua;return buildSelectorsObject({device:tt,browser:nt,os:rt,engine:it,ua:st})},AndroidView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isAndroid?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},BrowserView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isBrowser?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},IEView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isIE?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},IOSView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isIOS?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},MobileView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isMobile?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},TabletView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isTablet?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},WinPhoneView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isWinPhone?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},MobileOnlyView=function et(_){var _e=_.renderWithFragment,tt=_.children;_.viewClassName,_.style;var nt=_objectWithoutProperties(_,["renderWithFragment","children","viewClassName","style"]);return isMobileOnly?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},SmartTVView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isSmartTV?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},ConsoleView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isConsole?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},WearableView=function et(_){var _e=_.renderWithFragment,tt=_.children,nt=_objectWithoutProperties(_,["renderWithFragment","children"]);return isWearable?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",nt,tt):null},CustomView=function et(_){var _e=_.renderWithFragment,tt=_.children;_.viewClassName,_.style;var nt=_.condition,rt=_objectWithoutProperties(_,["renderWithFragment","children","viewClassName","style","condition"]);return nt?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null};function withOrientationChange(et){return function(_){_inherits(_e,_);function _e(tt){var nt;return _classCallCheck(this,_e),nt=_possibleConstructorReturn(this,_getPrototypeOf(_e).call(this,tt)),nt.isEventListenerAdded=!1,nt.handleOrientationChange=nt.handleOrientationChange.bind(_assertThisInitialized(nt)),nt.onOrientationChange=nt.onOrientationChange.bind(_assertThisInitialized(nt)),nt.onPageLoad=nt.onPageLoad.bind(_assertThisInitialized(nt)),nt.state={isLandscape:!1,isPortrait:!1},nt}return _createClass(_e,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var nt=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:nt===0,isLandscape:nt===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":_typeof(window))!==void 0&&isMobile&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return React__default.createElement(et,_extends({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),_e}(React__default.Component)}function useMobileOrientation(){var et=React.useState(function(){var rt=window.innerWidth>window.innerHeight?90:0;return{isPortrait:rt===0,isLandscape:rt===90,orientation:rt===0?"portrait":"landscape"}}),_=_slicedToArray(et,2),_e=_[0],tt=_[1],nt=React.useCallback(function(){var rt=window.innerWidth>window.innerHeight?90:0,it={isPortrait:rt===0,isLandscape:rt===90,orientation:rt===0?"portrait":"landscape"};_e.orientation!==it.orientation&&tt(it)},[_e.orientation]);return React.useEffect(function(){return(typeof window>"u"?"undefined":_typeof(window))!==void 0&&isMobile&&(nt(),window.addEventListener("load",nt,!1),window.addEventListener("resize",nt,!1)),function(){window.removeEventListener("resize",nt,!1),window.removeEventListener("load",nt,!1)}},[nt]),_e}function useDeviceData(et){var _=et||window.navigator.userAgent;return parseUserAgent(_)}function useDeviceSelectors(et){var _=et||window.navigator.userAgent,_e=useDeviceData(_),tt=buildSelectorsObject(_e);return[tt,_e]}lib.AndroidView=AndroidView;lib.BrowserTypes=BrowserTypes;lib.BrowserView=BrowserView;lib.ConsoleView=ConsoleView;lib.CustomView=CustomView;lib.IEView=IEView;lib.IOSView=IOSView;lib.MobileOnlyView=MobileOnlyView;lib.MobileView=MobileView;lib.OsTypes=OsTypes;lib.SmartTVView=SmartTVView;lib.TabletView=TabletView;lib.WearableView=WearableView;lib.WinPhoneView=WinPhoneView;lib.browserName=browserName;lib.browserVersion=browserVersion;lib.deviceDetect=deviceDetect;lib.deviceType=deviceType;lib.engineName=engineName;lib.engineVersion=engineVersion;lib.fullBrowserVersion=fullBrowserVersion;lib.getSelectorsByUserAgent=getSelectorsByUserAgent;lib.getUA=getUA;lib.isAndroid=isAndroid;lib.isBrowser=isBrowser;lib.isChrome=isChrome;lib.isChromium=isChromium;lib.isConsole=isConsole;lib.isDesktop=isDesktop;lib.isEdge=isEdge;lib.isEdgeChromium=isEdgeChromium;lib.isElectron=isElectron;lib.isEmbedded=isEmbedded;lib.isFirefox=isFirefox;lib.isIE=isIE;lib.isIOS=isIOS;lib.isIOS13=isIOS13;lib.isIPad13=isIPad13;lib.isIPhone13=isIPhone13;lib.isIPod13=isIPod13;lib.isLegacyEdge=isLegacyEdge;lib.isMIUI=isMIUI;lib.isMacOs=isMacOs;lib.isMobile=isMobile;var isMobileOnly_1=lib.isMobileOnly=isMobileOnly;lib.isMobileSafari=isMobileSafari;lib.isOpera=isOpera;var isSafari_1=lib.isSafari=isSafari;lib.isSamsungBrowser=isSamsungBrowser;lib.isSmartTV=isSmartTV;lib.isTablet=isTablet;lib.isWearable=isWearable;lib.isWinPhone=isWinPhone;lib.isWindows=isWindows;lib.isYandex=isYandex;lib.mobileModel=mobileModel;lib.mobileVendor=mobileVendor;lib.osName=osName;lib.osVersion=osVersion;lib.parseUserAgent=parseUserAgent;lib.setUserAgent=setUserAgent;lib.useDeviceData=useDeviceData;lib.useDeviceSelectors=useDeviceSelectors;lib.useMobileOrientation=useMobileOrientation;lib.withOrientationChange=withOrientationChange;const pages=[{type:"slate",color:MatterTone.White,bg:"white",page:SlatePage,flowerPosition:"bottom-center",text:jsxRuntimeExports.jsxs("div",{className:"full-stack items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-heading",children:"playground"}),jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"ikjunim@gmail.com"}),isMobileOnly_1?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("span",{className:"text-text",children:"A laptop is recommended"})}):isSafari_1?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"text-text",children:"A modern browser is recommended"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"like Chrome or Firefox"})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]}),inner:isMobileOnly_1||isSafari_1?jsxRuntimeExports.jsxs("div",{className:"full-stack bg-black text-white items-center justify-center text-text",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"press here"}),jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"again to hide"})]}):jsxRuntimeExports.jsxs("div",{className:"full-stack bg-black text-white items-center justify-center text-text",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"press on the grid"}),jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"(on the squares)"}),jsxRuntimeExports.jsx("span",{children:"press here again to hide"})]}),effect:waterEffect,tutorial:!0},{type:"fun",color:MatterTone.Black,bg:"black",page:ThreePage,flowerPosition:"bottom-right"},{type:"slate",color:MatterColor.Red,bg:"red",page:SlatePage,flowerPosition:"bottom-center",text:jsxRuntimeExports.jsxs("div",{className:"full-stack text-headingHalf",children:[jsxRuntimeExports.jsx("span",{children:"what's the purpose"}),jsxRuntimeExports.jsx("span",{children:"of this website?"})]}),inner:jsxRuntimeExports.jsxs("div",{className:"full-stack bg-red text-black justify-center items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"experiment"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"this website is the result of me"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"playing around with my creativity"})]}),effect:shootEffect},{type:"fun",color:MatterTone.White,bg:"white",page:BalloonPage,flowerPosition:"bottom-right"},{type:"slate",color:MatterColor.Yellow,bg:"yellow",page:SlatePage,flowerPosition:"bottom-center",text:jsxRuntimeExports.jsxs("div",{className:"full-stack text-headingHalf",children:[jsxRuntimeExports.jsx("span",{children:"what's the inspiration"}),jsxRuntimeExports.jsx("span",{children:"behind the website?"})]}),inner:jsxRuntimeExports.jsxs("div",{className:"full-stack bg-yellow text-black justify-center items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"me"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"i took my personality and found creative"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"and interactive ways to express it"})]}),effect:paintEffect},{type:"fun",color:MatterTone.Black,bg:"black",page:KineticPage,flowerPosition:"bottom-right"},{type:"slate",color:MatterColor.Green,bg:"green",page:SlatePage,flowerPosition:"bottom-center",text:jsxRuntimeExports.jsxs("div",{className:"full-stack text-headingHalf",children:[jsxRuntimeExports.jsx("span",{children:"How did you make"}),jsxRuntimeExports.jsx("span",{children:"the website?"})]}),inner:jsxRuntimeExports.jsxs("div",{className:"full-stack bg-green text-black justify-center items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"with passion"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"...and a lot of time"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"...and a lot of effort"})]}),effect:sunflowerEffect},{type:"fun",color:MatterTone.Black,bg:"black",page:LetterPage,flowerPosition:"bottom-right"},{type:"slate",color:MatterColor.Blue,bg:"blue",page:SlatePage,flowerPosition:"bottom-center",text:jsxRuntimeExports.jsxs("div",{className:"full-stack text-headingHalf",children:[jsxRuntimeExports.jsx("span",{children:"How long did it take"}),jsxRuntimeExports.jsx("span",{children:"for you to make it?"})]}),inner:jsxRuntimeExports.jsxs("div",{className:"full-stack bg-blue text-white justify-center items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"4 months"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"from the concept to design and to"}),jsxRuntimeExports.jsx("span",{className:"text-text",children:"self-learning everything involved"})]}),effect:crossEffect},{type:"fun",color:MatterTone.Black,bg:"black",page:PaintPage,flowerPosition:"bottom-right"},{type:"slate",color:MatterTone.White,bg:"black",page:SlatePage,flowerPosition:"bottom-right",empty:!0,effect:punchEffect}],petalCount=12;let targetPosition={x:0,y:0},mousePosition={x:0,y:0},currentPosition={x:0,y:0},speed=.06,followMouse=!0,curActive=0;const flowerPosition=pages.map(et=>et.flowerPosition);let prevPosition=flowerPosition[0];function Flower({squareEffect:et,active:_,ready:_e}){const tt=localStorage.getItem("lapped");tt===null&&localStorage.setItem("lapped","false");const[nt,rt]=reactExports.useState(tt?tt==="true":!1),it=reactExports.useRef(null),st=reactExports.useRef(null),ot=reactExports.useRef(null),at=reactExports.useRef(null),lt=reactExports.useRef([]),ct=bt=>{et(bt.clientX,bt.clientY,"next")&&(ot.current.classList.remove(prevPosition),prevPosition=flowerPosition[(curActive+1)%flowerPosition.length],ot.current.classList.add(prevPosition))},ht=(bt,Et)=>{et(bt.clientX,bt.clientY,Et)&&(ot.current.classList.remove(prevPosition),prevPosition=flowerPosition[Et],ot.current.classList.add(prevPosition))};reactExports.useEffect(()=>{curActive=_},[_]);const ut=reactExports.useMemo(()=>createTimer({frameRate:30,onUpdate:()=>{const bt=ot.current.getBoundingClientRect();targetPosition.x=bt.x+bt.width/2,targetPosition.y=bt.y+bt.height/2},autoplay:!1}),[]),ft=reactExports.useMemo(()=>hasMouse?createTimer({frameRate:60,onUpdate:()=>{currentPosition.x=currentPosition.x+(targetPosition.x-currentPosition.x)*speed,currentPosition.y=currentPosition.y+(targetPosition.y-currentPosition.y)*speed,it.current.style.transform="translate("+currentPosition.x+"px, "+currentPosition.y+"px)"},autoplay:!1}):null,[]),dt=()=>{hasMouse&&(followMouse=!1,ut.play(),st.current.classList.add("expanded"),st.current.classList.remove("contracted"))},pt=()=>{hasMouse&&(followMouse=!0,ut.pause(),st.current.classList.remove("expanded"),st.current.classList.add("contracted"),targetPosition.x=mousePosition.x,targetPosition.y=mousePosition.y)},mt=bt=>{hasMouse&&(mousePosition.x=bt.clientX,mousePosition.y=bt.clientY,followMouse&&(targetPosition.x=mousePosition.x,targetPosition.y=mousePosition.y))};reactExports.useEffect(()=>(hasMouse&&(it.current.style.transform="translate(0px, 0px)",window.addEventListener("mousemove",mt),ft==null||ft.play()),()=>{hasMouse&&(window.removeEventListener("mousemove",mt),ft==null||ft.pause())}),[]);const vt=reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{ref:ot,className:`absolute top-0 left-0 flower z-[200] flex justify-center items-center ${prevPosition}`,children:[jsxRuntimeExports.jsx("svg",{className:"w-[100%] h-[100%] pointer-events-auto relative z-10 fill-[#ffffff]",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128",onMouseEnter:dt,onMouseLeave:pt,onClick:ct,children:jsxRuntimeExports.jsx("path",{ref:at,d:"m68.4 33.5-3.8 3.8L89.2 62H24.1v5.3h64.3l-23.8 24 3.8 3.8 30.7-30.8-.1-.1.1-.1-30.7-30.6zM64.1 0C28.8 0 .2 28.7.2 64s28.6 64 63.9 64S128 99.3 128 64c-.1-35.3-28.7-64-63.9-64zm0 122.7C31.7 122.7 5.5 96.4 5.5 64c0-32.4 26.2-58.7 58.6-58.7 32.3 0 58.6 26.3 58.6 58.7-.1 32.4-26.3 58.7-58.6 58.7z",id:"icon_36_"})}),jsxRuntimeExports.jsx("div",{className:"w-[300%] h-[300%] max-w-[20000px] max-h-[20000px] absolute",onMouseEnter:dt,onMouseLeave:pt})]}),[]),yt=reactExports.useMemo(()=>Array.from({length:pages.length},(bt,Et)=>jsxRuntimeExports.jsx("button",{ref:Mt=>lt.current.push(Mt),className:"border-none outline-none text-nav font-mono w-[1.5em] inline-flex justify-center items-center h-max text-[#ffffff] mix-blend-difference",onClick:Mt=>ht(Mt,Et),style:{transform:"translateY(-5em)"},children:Et+1},Et)),[]),_t=reactExports.useRef(null),St=reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{ref:_t,className:"absolute bottom-0 left-0 text-nav bg-white w-[1.5em] h-full nav-ball",style:{transform:"translateY(-5em)"}}),[]);return reactExports.useEffect(()=>{if(_>=0&&nt){if(animate(lt.current,{translateY:0,duration:600,delay:stagger(50),ease:"outBack(2)"}),!_t.current)return;animate(_t.current,{translateY:0,duration:600,ease:"outBack(2)"})}!nt&&_===pages.length-1&&(rt(!0),localStorage.setItem("lapped","true"))},[_,nt]),reactExports.useEffect(()=>{_e<0||animate(_t.current,{translateX:`${_e*1.5}em`,ease:spring(1,100,11)})},[_e]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[vt,jsxRuntimeExports.jsxs("div",{className:`absolute top-[5svh] right-1/2 translate-x-1/2 max-w-[20000px] 
      w-max h-max z-[1000] mix-blend-difference`,children:[St,yt]}),hasMouse&&jsxRuntimeExports.jsx("div",{ref:it,className:"absolute petal-container pointer-events-none select-none z-[1000]",children:jsxRuntimeExports.jsx("div",{className:"w-full h-full relative -translate-x-1/2 -translate-y-1/2",children:jsxRuntimeExports.jsx("div",{ref:st,className:"rotate-full w-full h-full contracted",children:Array.from({length:petalCount},(bt,Et)=>jsxRuntimeExports.jsx(Petal,{index:Et,active:_},Et))})})})]})}function Petal({index:et,active:_}){const _e=reactExports.useRef(null);return reactExports.useEffect(()=>{_e.current.innerText=""+(_+1)},[_]),reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{className:"petal",children:jsxRuntimeExports.jsx("div",{ref:_e,className:"petal-text",style:{rotate:`${et*360/petalCount}deg`},children:"0"})}),[])}const signature="/assets/Signature-BrrRUrXT.webp";function RevealPage({active:et,ready:_,pageNumber:_e,immediateEffect:tt}){const nt=reactExports.useRef(null),rt=reactExports.useRef(null),it=reactExports.useRef([]),st=reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{className:"jawline w-full h-full absolute top-0",children:jsxRuntimeExports.jsxs("svg",{height:"100svh",strokeMiterlimit:"10",version:"1.1",viewBox:"0 0 841.995 595.35",width:"max(100svw,40rem)",xmlns:"http://www.w3.org/2000/svg",className:"max-w-[20000px] absolute top-1/2 left-1/2 -translate-x-[max(50svw,20rem)] -translate-y-1/2",children:[jsxRuntimeExports.jsx("g",{id:"jawline-main-1",className:"translate-x-[0.75%]",children:jsxRuntimeExports.jsx("path",{d:"M155.429 608.277C155.159 610.911 155.882 603.856 156.007 602.631C156.489 597.926 157.745 593.088 158.224 588.404C159.593 575.033 163.271 561.871 166.074 548.89C169.83 531.499 178.016 515.106 181.594 497.609C186.252 474.828 194.284 443.729 210.903 426.821C246.237 390.872 339.258 396.196 354.502 346.814C361.901 322.848 334.167 295.369 328.093 274.124C321.387 250.667 316.478 229.849 314.174 205.756C312.792 191.313 322.837 175.931 329.483 163.963C347.298 131.882 365.516 111.543 404.307 107.832C421.445 106.193 439.773 111.514 454.918 116.189C508.469 132.721 503.351 141.653 519.073 185.617C528.761 212.708 521.68 266.84 512.365 290.14C508.785 299.094 498.263 355.694 492.096 359.403C480.679 366.269 465.293 357.166 452.961 353.79C438.42 349.81 437.269 346.608 413.938 343.045C380.625 337.958 385.097 286.249 380.623 255.16C379.564 247.809 377.401 233.829 372.404 227.693C369.319 223.904 369.246 222.491 364.401 219.952C351.998 213.455 341.266 223.172 342.004 234.85C342.867 248.514 350.557 267.107 361.449 275.258C366.815 279.274 378.443 276.938 381.65 282.271C390.411 296.837 381.322 320.27 395.595 333.449C407.572 344.507 436.906 348.064 452.6 352.909C459.075 354.908 450.719 385.656 455.918 390.455C465.822 399.6 473.444 398.616 489.696 407.129C510.911 418.243 512.614 416.794 536.098 423.222C543.637 425.286 553.616 427.964 559.755 433.632C568.716 441.906 571.008 457.395 574.431 468.606C580.57 488.712 580.57 511.256 587.999 531.783C591.867 542.47 592.464 550.549 596.465 561.127C601.637 574.801 603.535 591.793 606.749 606.182",ref:lt=>it.current.push(lt),className:"jawline-main-1-animation",stroke:MatterColor.Red})}),jsxRuntimeExports.jsx("g",{id:"jawline-main-2",className:"translate-x-[0.25%]",children:jsxRuntimeExports.jsx("path",{d:"M155.429 608.277C155.159 610.911 155.882 603.856 156.007 602.631C156.489 597.926 157.745 593.088 158.224 588.404C159.593 575.033 163.271 561.871 166.074 548.89C169.83 531.499 178.016 515.106 181.594 497.609C186.252 474.828 194.284 443.729 210.903 426.821C246.237 390.872 339.258 396.196 354.502 346.814C361.901 322.848 334.167 295.369 328.093 274.124C321.387 250.667 316.478 229.849 314.174 205.756C312.792 191.313 322.837 175.931 329.483 163.963C347.298 131.882 365.516 111.543 404.307 107.832C421.445 106.193 439.773 111.514 454.918 116.189C508.469 132.721 503.351 141.653 519.073 185.617C528.761 212.708 521.68 266.84 512.365 290.14C508.785 299.094 498.263 355.694 492.096 359.403C480.679 366.269 465.293 357.166 452.961 353.79C438.42 349.81 437.269 346.608 413.938 343.045C380.625 337.958 385.097 286.249 380.623 255.16C379.564 247.809 377.401 233.829 372.404 227.693C369.319 223.904 369.246 222.491 364.401 219.952C351.998 213.455 341.266 223.172 342.004 234.85C342.867 248.514 350.557 267.107 361.449 275.258C366.815 279.274 378.443 276.938 381.65 282.271C390.411 296.837 381.322 320.27 395.595 333.449C407.572 344.507 436.906 348.064 452.6 352.909C459.075 354.908 450.719 385.656 455.918 390.455C465.822 399.6 473.444 398.616 489.696 407.129C510.911 418.243 512.614 416.794 536.098 423.222C543.637 425.286 553.616 427.964 559.755 433.632C568.716 441.906 571.008 457.395 574.431 468.606C580.57 488.712 580.57 511.256 587.999 531.783C591.867 542.47 592.464 550.549 596.465 561.127C601.637 574.801 603.535 591.793 606.749 606.182",ref:lt=>it.current.push(lt),className:"jawline-main-2-animation",stroke:MatterColor.Yellow})}),jsxRuntimeExports.jsx("g",{id:"jawline-main-3",className:"translate-x-[-0.25%]",children:jsxRuntimeExports.jsx("path",{d:"M155.429 608.277C155.159 610.911 155.882 603.856 156.007 602.631C156.489 597.926 157.745 593.088 158.224 588.404C159.593 575.033 163.271 561.871 166.074 548.89C169.83 531.499 178.016 515.106 181.594 497.609C186.252 474.828 194.284 443.729 210.903 426.821C246.237 390.872 339.258 396.196 354.502 346.814C361.901 322.848 334.167 295.369 328.093 274.124C321.387 250.667 316.478 229.849 314.174 205.756C312.792 191.313 322.837 175.931 329.483 163.963C347.298 131.882 365.516 111.543 404.307 107.832C421.445 106.193 439.773 111.514 454.918 116.189C508.469 132.721 503.351 141.653 519.073 185.617C528.761 212.708 521.68 266.84 512.365 290.14C508.785 299.094 498.263 355.694 492.096 359.403C480.679 366.269 465.293 357.166 452.961 353.79C438.42 349.81 437.269 346.608 413.938 343.045C380.625 337.958 385.097 286.249 380.623 255.16C379.564 247.809 377.401 233.829 372.404 227.693C369.319 223.904 369.246 222.491 364.401 219.952C351.998 213.455 341.266 223.172 342.004 234.85C342.867 248.514 350.557 267.107 361.449 275.258C366.815 279.274 378.443 276.938 381.65 282.271C390.411 296.837 381.322 320.27 395.595 333.449C407.572 344.507 436.906 348.064 452.6 352.909C459.075 354.908 450.719 385.656 455.918 390.455C465.822 399.6 473.444 398.616 489.696 407.129C510.911 418.243 512.614 416.794 536.098 423.222C543.637 425.286 553.616 427.964 559.755 433.632C568.716 441.906 571.008 457.395 574.431 468.606C580.57 488.712 580.57 511.256 587.999 531.783C591.867 542.47 592.464 550.549 596.465 561.127C601.637 574.801 603.535 591.793 606.749 606.182",ref:lt=>it.current.push(lt),className:"jawline-main-3-animation",stroke:MatterColor.Green})}),jsxRuntimeExports.jsx("g",{id:"jawline-main-4",className:"translate-x-[-0.75%]",children:jsxRuntimeExports.jsx("path",{d:"M155.429 608.277C155.159 610.911 155.882 603.856 156.007 602.631C156.489 597.926 157.745 593.088 158.224 588.404C159.593 575.033 163.271 561.871 166.074 548.89C169.83 531.499 178.016 515.106 181.594 497.609C186.252 474.828 194.284 443.729 210.903 426.821C246.237 390.872 339.258 396.196 354.502 346.814C361.901 322.848 334.167 295.369 328.093 274.124C321.387 250.667 316.478 229.849 314.174 205.756C312.792 191.313 322.837 175.931 329.483 163.963C347.298 131.882 365.516 111.543 404.307 107.832C421.445 106.193 439.773 111.514 454.918 116.189C508.469 132.721 503.351 141.653 519.073 185.617C528.761 212.708 521.68 266.84 512.365 290.14C508.785 299.094 498.263 355.694 492.096 359.403C480.679 366.269 465.293 357.166 452.961 353.79C438.42 349.81 437.269 346.608 413.938 343.045C380.625 337.958 385.097 286.249 380.623 255.16C379.564 247.809 377.401 233.829 372.404 227.693C369.319 223.904 369.246 222.491 364.401 219.952C351.998 213.455 341.266 223.172 342.004 234.85C342.867 248.514 350.557 267.107 361.449 275.258C366.815 279.274 378.443 276.938 381.65 282.271C390.411 296.837 381.322 320.27 395.595 333.449C407.572 344.507 436.906 348.064 452.6 352.909C459.075 354.908 450.719 385.656 455.918 390.455C465.822 399.6 473.444 398.616 489.696 407.129C510.911 418.243 512.614 416.794 536.098 423.222C543.637 425.286 553.616 427.964 559.755 433.632C568.716 441.906 571.008 457.395 574.431 468.606C580.57 488.712 580.57 511.256 587.999 531.783C591.867 542.47 592.464 550.549 596.465 561.127C601.637 574.801 603.535 591.793 606.749 606.182",ref:lt=>it.current.push(lt),className:"jawline-main-4-animation",stroke:MatterColor.Blue})}),jsxRuntimeExports.jsx("g",{id:"jawline-glasses",children:jsxRuntimeExports.jsx("path",{d:"M368.669 223.228C365.602 222.517 374.939 222.366 377.934 221.398C384.571 219.253 390.69 219.402 397.464 218.19C412.935 215.421 430.086 212.338 445.786 212.816C448.04 212.884 459.241 212.649 460.535 214.024C461.22 214.752 460.13 220.078 460.189 221.238C460.869 234.697 457.686 265.645 479.139 266.298C496.315 266.82 492.205 240.745 495.998 238.38C497.241 237.604 500.752 239.652 501.984 240.209C508.054 242.958 504.037 254.648 503.885 259.657C503.687 266.154 507.953 272.799 511.145 277.917C512.892 280.718 514.751 289.842 520.738 286.108C533.417 278.202 529.762 250.619 520.444 241.615C512.516 233.956 510.248 243.868 505.045 245.118C504.951 245.141 503.528 241.113 502.984 240.662C500.306 238.445 496.878 239.557 494.901 238.346C494.544 238.127 494.747 236.452 494.758 236.103C494.937 230.218 491.74 223.784 488.772 219.023C481.041 206.626 463.755 210.577 452.063 213.387",className:"jawline-glasses",stroke:MatterColor.Yellow})}),jsxRuntimeExports.jsx("g",{id:"jawline-rest",children:jsxRuntimeExports.jsx("path",{d:"M494.633 240.45C488.796 252.123 514.037 268.381 512.277 278.945C511.394 284.24 503.24 284.139 501.419 288.692C500.664 290.58 501.572 300.723 500.802 301.031C498.18 302.08 481.702 307.202 481.184 309.791C480.657 312.428 502.491 310.957 504.627 321.636C505.483 325.916 480.275 317.421 481.307 312.259C483.147 303.063 513.652 328.467 504.997 306.83C503.946 304.203 500.833 302.729 499.938 300.044",className:"jawline-rest",stroke:MatterColor.Yellow})})]})}),[]),ot=reactExports.useMemo(()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"w-full h-full absolute top-0 flex justify-center items-center",children:jsxRuntimeExports.jsx("img",{className:"relative w-[min(100%,70rem)] opacity-30",src:signature})}),jsxRuntimeExports.jsx("div",{className:"w-full h-full flex relative justify-center items-center font-mono text-white text-text",children:jsxRuntimeExports.jsxs("div",{className:"w-full h-[20%] flex justify-evenly items-start",children:[jsxRuntimeExports.jsxs("div",{ref:nt,className:"text-left flex flex-col",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"Made with"}),jsxRuntimeExports.jsx("span",{children:"React"}),jsxRuntimeExports.jsx("span",{children:"Anime.js"}),jsxRuntimeExports.jsx("span",{children:"Three.js"}),jsxRuntimeExports.jsx("span",{children:"Matter.js"}),jsxRuntimeExports.jsx("span",{children:"PixiJS"})]}),jsxRuntimeExports.jsxs("div",{ref:rt,className:"text-right flex flex-col",children:[jsxRuntimeExports.jsx("span",{className:"text-headingHalf",children:"Made By"}),jsxRuntimeExports.jsx("span",{children:"ikjun im"}),jsxRuntimeExports.jsx("span",{children:"playground"}),jsxRuntimeExports.jsx("span",{children:"no socials"}),jsxRuntimeExports.jsx("span",{children:"based in Sydney"}),jsxRuntimeExports.jsx("span",{children:"ikjunim@gmail.com"})]})]})})]}),[]),at=reactExports.useMemo(()=>isMobileOnly_1||isSafari_1?null:jsxRuntimeExports.jsx("div",{className:"absolute top-0 w-full h-full flex justify-start items-end font-mono text-white text-tiny",children:jsxRuntimeExports.jsxs("div",{className:"w-max h-max",children:["would you believe me ",jsxRuntimeExports.jsx("br",{}),"if i told you that ",jsxRuntimeExports.jsx("br",{}),"this is my second website ",jsxRuntimeExports.jsx("br",{}),"that i've ever made?"]})}),[]);return reactExports.useEffect(()=>{if(et===_e){if(!nt.current||!rt.current||isMobileOnly_1||isSafari_1)return;const lt=nt.current.getBoundingClientRect(),ct=rt.current.getBoundingClientRect();tt([indexOf(lt.left+lt.width/2,lt.top+lt.height/2),indexOf(window.innerWidth/2,window.innerHeight/2),indexOf(ct.left+ct.width/2,ct.top+ct.height/2)],[0,8,4])}},[et]),jsxRuntimeExports.jsxs("div",{className:`w-svw h-svh absolute top-0 overflow-hidden no-select bg-black ${(isMobileOnly_1||isSafari_1)&&(_===_e||et===_e)||et===_e?"":"hidden"}`,children:[st,ot,at]})}const optimizedDevice=isMobileOnly_1||isSafari_1,maxRadius={value:0};var rippleAnime=null,rippleTimer=null;const mobileRippleDuration=500,maskPosition={x:0,y:0,xPercent:0,yPercent:0};var needMaskResize=!1;function PageManager(){const[et,_]=useState(!1),[_e,tt,nt]=useState(-1),[rt,it]=useState(-1),st=reactExports.useRef(null),ot=reactExports.useRef(null),at=reactExports.useRef([]),lt=reactExports.useRef([]),ct=reactExports.useRef([]),ht=reactExports.useRef([]),ut=reactExports.useCallback((vt,yt,_t)=>{const St=_t==="next"?(nt.current+1)%pages.length:_t;if(St===nt.current)return!1;const bt=ht.current[nt.current],Et=ct.current[St];if(isSafari_1)return randomSlide(at.current[nt.current],at.current[St],St===6||nt.current===6?randomElement(["left","right"]):"random",mobileRippleDuration*2,()=>{it(St),ot.current.style.pointerEvents="all"},()=>{ot.current.style.pointerEvents="none",tt(St),needMaskResize&&(needMaskResize=!1,ft())})!==null;if(isMobileOnly_1){maskPosition.x=vt,maskPosition.y=yt,maskPosition.xPercent=vt/window.innerWidth,maskPosition.yPercent=yt/window.innerHeight;const Mt=furthestCorner(maskPosition.x,maskPosition.y,window.innerWidth,window.innerHeight);return rippleTimer=timerEffect(mobileRippleDuration,()=>{it(St),bt==null||bt.setAttribute("cx",`${maskPosition.x}`),bt==null||bt.setAttribute("cy",`${maskPosition.y}`),Et==null||Et.setAttribute("cx",`${maskPosition.x}`),Et==null||Et.setAttribute("cy",`${maskPosition.y}`),ot.current.style.pointerEvents="all"},Tt=>{const wt=Tt.currentTime/mobileRippleDuration;bt==null||bt.setAttribute("r",`${Mt*wt}`),Et==null||Et.setAttribute("r",`${Mt*wt}`)},()=>{var Tt;bt==null||bt.setAttribute("r","0"),Et==null||Et.setAttribute("r",`${Mt}`),(Tt=ct.current[nt.current])==null||Tt.setAttribute("r","0"),tt(St),ot.current.style.pointerEvents="none",needMaskResize&&(needMaskResize=!1,ft()),rippleTimer=null}),rippleTimer!==null}else{const Mt=indexOf(vt,yt),Tt=lt.current[Mt].getBoundingClientRect();maskPosition.x=Tt.left+Tt.width/2,maskPosition.y=Tt.top+Tt.height/2,maskPosition.xPercent=maskPosition.x/window.innerWidth,maskPosition.yPercent=maskPosition.y/window.innerHeight;const wt=furthestCorner(maskPosition.x,maskPosition.y,window.innerWidth,window.innerHeight);return rippleAnime=rippleEffect(lt.current,Mt,pages[St].color,()=>{it(St),bt==null||bt.setAttribute("cx",`${maskPosition.x}`),bt==null||bt.setAttribute("cy",`${maskPosition.y}`),Et==null||Et.setAttribute("cx",`${maskPosition.x}`),Et==null||Et.setAttribute("cy",`${maskPosition.y}`),ot.current.style.pointerEvents="all"},Ct=>{bt==null||bt.setAttribute("r",`${wt*Ct.progress}`),Et==null||Et.setAttribute("r",`${wt*Ct.progress}`)},()=>{var Ct;bt==null||bt.setAttribute("r","0"),Et==null||Et.setAttribute("r",`${wt}`),(Ct=ct.current[nt.current])==null||Ct.setAttribute("r","0"),tt(St),ot.current.style.pointerEvents="none",needMaskResize&&(needMaskResize=!1,ft()),rippleAnime=null}),rippleAnime!==null}},[]),ft=()=>{maxRadius.value=Math.sqrt(window.innerWidth**2+window.innerHeight**2);const vt=ct.current[nt.current];optimizedDevice&&(!rippleTimer||rippleTimer.currentTime===mobileRippleDuration)?vt==null||vt.setAttribute("r",`${maxRadius.value}`):!rippleAnime||rippleAnime.completed?vt==null||vt.setAttribute("r",`${maxRadius.value}`):needMaskResize=!0,vt==null||vt.setAttribute("cx",`${maskPosition.xPercent*window.innerWidth}`),vt==null||vt.setAttribute("cy",`${maskPosition.yPercent*window.innerHeight}`),lt.current&&lt.current.length&&setLength(lt.current[0].clientWidth)},dt=reactExports.useMemo(()=>optimizedDevice?null:jsxRuntimeExports.jsx("div",{className:"absolute max-h-[20000px] page-grid w-full h-full",children:Array.from({length:squareCount*squareCount},(vt,yt)=>jsxRuntimeExports.jsx("div",{ref:_t=>{_t&&lt.current.push(_t)},id:`${yt}-square`,className:"page-square",style:{transform:"translateX(100svw)"}},yt))}),[]),pt=reactExports.useMemo(()=>Array.from({length:pages.length},(vt,yt)=>jsxRuntimeExports.jsx("svg",{className:"absolute",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("mask",{id:`page-clip-${yt+1}`,children:[jsxRuntimeExports.jsx("circle",{ref:_t=>ct.current.push(_t),cx:"0",cy:"0",r:"0",fill:"white"}),jsxRuntimeExports.jsx("circle",{ref:_t=>ht.current.push(_t),cx:"0",cy:"0",r:"0",fill:"black"})]})})},yt)),[]);reactExports.useEffect(()=>{if(ft(),ct.current.forEach((vt,yt)=>vt==null?void 0:vt.setAttribute("r",yt===0?`${maxRadius.value}`:"0")),ht.current.forEach(vt=>vt==null?void 0:vt.setAttribute("r","0")),!!ot.current){if(ot.current.style.pointerEvents="all",optimizedDevice)createTimer({duration:2e3,onComplete:()=>{ut(0,0,0),st.current.style.display="none"}});else{if(!lt.current.length)return;const vt=chunk(lt.current,squareCount);for(let yt=0;yt<vt.length;yt++){const _t=oneRandomArray(squareCount).map(St=>St*3e3);vt[yt].forEach((St,bt,Et)=>{animate(St,{translateX:"0svw",easing:"inOutQuad",duration:1e3,delay:1e3+_t[bt],onComplete:()=>{yt===vt.length-1&&bt===Et.length-1&&(lt.current.forEach(Mt=>Mt.style.transform="translateX(0) rotate(0)"),ut(0,0,0),st.current.style.display="none")}})})}}return window.addEventListener("resize",ft),()=>window.removeEventListener("resize",ft)}},[]);const mt=reactExports.useMemo(()=>jsxRuntimeExports.jsxs("div",{ref:st,className:`absolute top-0 left-0 w-full h-full 
      flex flex-col justify-center items-end bg-black font-mono 
      text-heading text-white select-none pointer-events-none`,children:[jsxRuntimeExports.jsx("span",{children:"Building"}),jsxRuntimeExports.jsx("span",{className:"text-headingHalf text-red",children:"(loading)"}),jsxRuntimeExports.jsx("span",{children:"Blocks..."})]}),[]);return jsxRuntimeExports.jsxs("div",{className:"w-svw h-svh relative overflow-hidden",children:[jsxRuntimeExports.jsx("div",{ref:ot,className:"absolute top-0 w-full h-full bg-transparent z-[9999]"}),jsxRuntimeExports.jsx(RevealPage,{active:_e,ready:rt,pageNumber:pages.length-1,immediateEffect:(vt,yt)=>holeEffect(lt.current,vt,yt)}),mt,dt,jsxRuntimeExports.jsx(PageContext.Provider,{value:{active:_e,ready:rt},children:pages.map((vt,yt)=>{const _t=reactExports.useRef(null);var St=null;return vt.type==="fun"?St=jsxRuntimeExports.jsxs("div",{ref:_t,className:`page ${isSafari_1?"":`page-mask-${yt+1}`} ${optimizedDevice?"fake-grid bg-"+pages[yt].bg:"bg-transparent"}`,children:[jsxRuntimeExports.jsx(vt.page,{containerRef:(at.current[yt]=_t.current,_t),pageNumber:yt+1}),pt[yt]]},yt):vt.type==="slate"&&(St=jsxRuntimeExports.jsxs("div",{ref:_t,className:`page ${isSafari_1?"":`page-mask-${yt+1}`} ${optimizedDevice&&yt!==pages.length-1?"fake-grid bg-"+pages[yt].bg:"bg-transparent"}`,children:[jsxRuntimeExports.jsx(vt.page,{text:vt.text?vt.text:"",inner:vt.inner?vt.inner:"",tutorial:vt.tutorial?vt.tutorial:!1,empty:vt.empty?vt.empty:!1,containerRef:(at.current[yt]=_t.current,_t),pageNumber:yt+1,squareEffect:vt.effect&&!optimizedDevice?(bt,Et)=>vt.effect&&vt.effect(lt.current,bt,Et):()=>{}}),pt[yt]]},yt)),yt===pages.length-1&&!et&&setTimeout(()=>{_(!0)},0),St})}),jsxRuntimeExports.jsx(Flower,{squareEffect:ut,active:_e,ready:rt})]})}function App(){return jsxRuntimeExports.jsx(PageManager,{})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));export{boundsPool as $,AbstractRenderer as A,BufferUsage as B,Container as C,DOMAdapter as D,ExtensionType as E,FilterEffect as F,UPDATE_BLEND as G,UPDATE_VISIBLE as H,Color as I,getLocalBounds as J,deprecation as K,v8_0_0 as L,Matrix$4 as M,RendererInitHook as N,Geometry as O,Point as P,FillPattern as Q,Rectangle as R,STENCIL_MODES as S,Ticker as T,UPDATE_PRIORITY as U,FillGradient as V,TextStyle as W,fontStringFromTextStyle as X,CanvasTextMetrics as Y,ImageSource as Z,Cache as _,EventEmitter as a,ViewContainer as a0,GraphicsContext as a1,generateTextStyleKey as a2,BatchableGraphics as a3,getAdjustedBlendModeBlend as a4,updateQuadBounds as a5,GraphicsContextSystem as a6,getTextureBatchBindGroup as b,Buffer$1 as c,BindGroup as d,extensions as e,fastCopy as f,getMaxTexturesPerBatch as g,CLEAR as h,CanvasSource as i,TextureSource as j,Texture as k,getTestContext as l,TextureMatrix as m,nextPow2 as n,Batcher as o,BatchGeometry as p,BigPool as q,removeItems as r,getGlobalBounds as s,Bounds as t,uid as u,Sprite as v,warn as w,unsafeEvalSupported as x,SystemRunner as y,UPDATE_COLOR as z};
